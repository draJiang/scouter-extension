/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./node_modules/bent/src/browser.js":
/*!******************************************!*\
  !*** ./node_modules/bent/src/browser.js ***!
  \******************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";

/* global fetch, btoa, Headers */
const core = __webpack_require__(/*! ./core */ "./node_modules/bent/src/core.js")

class StatusError extends Error {
  constructor (res, ...params) {
    super(...params)

    if (Error.captureStackTrace) {
      Error.captureStackTrace(this, StatusError)
    }

    this.name = 'StatusError'
    this.message = res.statusMessage
    this.statusCode = res.status
    this.res = res
    this.json = res.json.bind(res)
    this.text = res.text.bind(res)
    this.arrayBuffer = res.arrayBuffer.bind(res)
    let buffer
    const get = () => {
      if (!buffer) buffer = this.arrayBuffer()
      return buffer
    }
    Object.defineProperty(this, 'responseBody', { get })
    // match Node.js headers object
    this.headers = {}
    for (const [key, value] of res.headers.entries()) {
      this.headers[key.toLowerCase()] = value
    }
  }
}

const mkrequest = (statusCodes, method, encoding, headers, baseurl) => async (_url, body, _headers = {}) => {
  _url = baseurl + (_url || '')
  let parsed = new URL(_url)

  if (!headers) headers = {}
  if (parsed.username) {
    headers.Authorization = 'Basic ' + btoa(parsed.username + ':' + parsed.password)
    parsed = new URL(parsed.protocol + '//' + parsed.host + parsed.pathname + parsed.search)
  }
  if (parsed.protocol !== 'https:' && parsed.protocol !== 'http:') {
    throw new Error(`Unknown protocol, ${parsed.protocol}`)
  }

  if (body) {
    if (body instanceof ArrayBuffer ||
      ArrayBuffer.isView(body) ||
      typeof body === 'string'
    ) {
      // noop
    } else if (typeof body === 'object') {
      body = JSON.stringify(body)
      headers['Content-Type'] = 'application/json'
    } else {
      throw new Error('Unknown body type.')
    }
  }

  _headers = new Headers({ ...(headers || {}), ..._headers })

  const resp = await fetch(parsed, { method, headers: _headers, body })
  resp.statusCode = resp.status

  if (!statusCodes.has(resp.status)) {
    throw new StatusError(resp)
  }

  if (encoding === 'json') return resp.json()
  else if (encoding === 'buffer') return resp.arrayBuffer()
  else if (encoding === 'string') return resp.text()
  else return resp
}

module.exports = core(mkrequest)


/***/ }),

/***/ "./node_modules/bent/src/core.js":
/*!***************************************!*\
  !*** ./node_modules/bent/src/core.js ***!
  \***************************************/
/***/ ((module) => {

"use strict";

const encodings = new Set(['json', 'buffer', 'string'])

module.exports = mkrequest => (...args) => {
  const statusCodes = new Set()
  let method
  let encoding
  let headers
  let baseurl = ''

  args.forEach(arg => {
    if (typeof arg === 'string') {
      if (arg.toUpperCase() === arg) {
        if (method) {
          const msg = `Can't set method to ${arg}, already set to ${method}.`
          throw new Error(msg)
        } else {
          method = arg
        }
      } else if (arg.startsWith('http:') || arg.startsWith('https:')) {
        baseurl = arg
      } else {
        if (encodings.has(arg)) {
          encoding = arg
        } else {
          throw new Error(`Unknown encoding, ${arg}`)
        }
      }
    } else if (typeof arg === 'number') {
      statusCodes.add(arg)
    } else if (typeof arg === 'object') {
      if (Array.isArray(arg) || arg instanceof Set) {
        arg.forEach(code => statusCodes.add(code))
      } else {
        if (headers) {
          throw new Error('Cannot set headers twice.')
        }
        headers = arg
      }
    } else {
      throw new Error(`Unknown type: ${typeof arg}`)
    }
  })

  if (!method) method = 'GET'
  if (statusCodes.size === 0) {
    statusCodes.add(200)
  }

  return mkrequest(statusCodes, method, encoding, headers, baseurl)
}


/***/ }),

/***/ "./node_modules/content-type/index.js":
/*!********************************************!*\
  !*** ./node_modules/content-type/index.js ***!
  \********************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";
/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */



/**
 * RegExp to match *( ";" parameter ) in RFC 7231 sec 3.1.1.1
 *
 * parameter     = token "=" ( token / quoted-string )
 * token         = 1*tchar
 * tchar         = "!" / "#" / "$" / "%" / "&" / "'" / "*"
 *               / "+" / "-" / "." / "^" / "_" / "`" / "|" / "~"
 *               / DIGIT / ALPHA
 *               ; any VCHAR, except delimiters
 * quoted-string = DQUOTE *( qdtext / quoted-pair ) DQUOTE
 * qdtext        = HTAB / SP / %x21 / %x23-5B / %x5D-7E / obs-text
 * obs-text      = %x80-FF
 * quoted-pair   = "\" ( HTAB / SP / VCHAR / obs-text )
 */
var PARAM_REGEXP = /; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g // eslint-disable-line no-control-regex
var TEXT_REGEXP = /^[\u000b\u0020-\u007e\u0080-\u00ff]+$/ // eslint-disable-line no-control-regex
var TOKEN_REGEXP = /^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/

/**
 * RegExp to match quoted-pair in RFC 7230 sec 3.2.6
 *
 * quoted-pair = "\" ( HTAB / SP / VCHAR / obs-text )
 * obs-text    = %x80-FF
 */
var QESC_REGEXP = /\\([\u000b\u0020-\u00ff])/g // eslint-disable-line no-control-regex

/**
 * RegExp to match chars that must be quoted-pair in RFC 7230 sec 3.2.6
 */
var QUOTE_REGEXP = /([\\"])/g

/**
 * RegExp to match type in RFC 7231 sec 3.1.1.1
 *
 * media-type = type "/" subtype
 * type       = token
 * subtype    = token
 */
var TYPE_REGEXP = /^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/

/**
 * Module exports.
 * @public
 */

exports.format = format
exports.parse = parse

/**
 * Format object to media type.
 *
 * @param {object} obj
 * @return {string}
 * @public
 */

function format (obj) {
  if (!obj || typeof obj !== 'object') {
    throw new TypeError('argument obj is required')
  }

  var parameters = obj.parameters
  var type = obj.type

  if (!type || !TYPE_REGEXP.test(type)) {
    throw new TypeError('invalid type')
  }

  var string = type

  // append parameters
  if (parameters && typeof parameters === 'object') {
    var param
    var params = Object.keys(parameters).sort()

    for (var i = 0; i < params.length; i++) {
      param = params[i]

      if (!TOKEN_REGEXP.test(param)) {
        throw new TypeError('invalid parameter name')
      }

      string += '; ' + param + '=' + qstring(parameters[param])
    }
  }

  return string
}

/**
 * Parse media type to object.
 *
 * @param {string|object} string
 * @return {Object}
 * @public
 */

function parse (string) {
  if (!string) {
    throw new TypeError('argument string is required')
  }

  // support req/res-like objects as argument
  var header = typeof string === 'object'
    ? getcontenttype(string)
    : string

  if (typeof header !== 'string') {
    throw new TypeError('argument string is required to be a string')
  }

  var index = header.indexOf(';')
  var type = index !== -1
    ? header.slice(0, index).trim()
    : header.trim()

  if (!TYPE_REGEXP.test(type)) {
    throw new TypeError('invalid media type')
  }

  var obj = new ContentType(type.toLowerCase())

  // parse parameters
  if (index !== -1) {
    var key
    var match
    var value

    PARAM_REGEXP.lastIndex = index

    while ((match = PARAM_REGEXP.exec(header))) {
      if (match.index !== index) {
        throw new TypeError('invalid parameter format')
      }

      index += match[0].length
      key = match[1].toLowerCase()
      value = match[2]

      if (value.charCodeAt(0) === 0x22 /* " */) {
        // remove quotes
        value = value.slice(1, -1)

        // remove escapes
        if (value.indexOf('\\') !== -1) {
          value = value.replace(QESC_REGEXP, '$1')
        }
      }

      obj.parameters[key] = value
    }

    if (index !== header.length) {
      throw new TypeError('invalid parameter format')
    }
  }

  return obj
}

/**
 * Get content-type from req/res objects.
 *
 * @param {object}
 * @return {Object}
 * @private
 */

function getcontenttype (obj) {
  var header

  if (typeof obj.getHeader === 'function') {
    // res-like
    header = obj.getHeader('content-type')
  } else if (typeof obj.headers === 'object') {
    // req-like
    header = obj.headers && obj.headers['content-type']
  }

  if (typeof header !== 'string') {
    throw new TypeError('content-type header is missing from object')
  }

  return header
}

/**
 * Quote a string if necessary.
 *
 * @param {string} val
 * @return {string}
 * @private
 */

function qstring (val) {
  var str = String(val)

  // no need to quote tokens
  if (TOKEN_REGEXP.test(str)) {
    return str
  }

  if (str.length > 0 && !TEXT_REGEXP.test(str)) {
    throw new TypeError('invalid parameter value')
  }

  return '"' + str.replace(QUOTE_REGEXP, '\\$1') + '"'
}

/**
 * Class to represent a content type.
 * @private
 */
function ContentType (type) {
  this.parameters = Object.create(null)
  this.type = type
}


/***/ }),

/***/ "./node_modules/eventsource-parser/dist/index.js":
/*!*******************************************************!*\
  !*** ./node_modules/eventsource-parser/dist/index.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
function createParser(onParse) {
  let isFirstChunk;
  let buffer;
  let startingPosition;
  let startingFieldLength;
  let eventId;
  let eventName;
  let data;
  reset();
  return {
    feed,
    reset
  };
  function reset() {
    isFirstChunk = true;
    buffer = "";
    startingPosition = 0;
    startingFieldLength = -1;
    eventId = void 0;
    eventName = void 0;
    data = "";
  }
  function feed(chunk) {
    buffer = buffer ? buffer + chunk : chunk;
    if (isFirstChunk && hasBom(buffer)) {
      buffer = buffer.slice(BOM.length);
    }
    isFirstChunk = false;
    const length = buffer.length;
    let position = 0;
    let discardTrailingNewline = false;
    while (position < length) {
      if (discardTrailingNewline) {
        if (buffer[position] === "\n") {
          ++position;
        }
        discardTrailingNewline = false;
      }
      let lineLength = -1;
      let fieldLength = startingFieldLength;
      let character;
      for (let index = startingPosition; lineLength < 0 && index < length; ++index) {
        character = buffer[index];
        if (character === ":" && fieldLength < 0) {
          fieldLength = index - position;
        } else if (character === "\r") {
          discardTrailingNewline = true;
          lineLength = index - position;
        } else if (character === "\n") {
          lineLength = index - position;
        }
      }
      if (lineLength < 0) {
        startingPosition = length - position;
        startingFieldLength = fieldLength;
        break;
      } else {
        startingPosition = 0;
        startingFieldLength = -1;
      }
      parseEventStreamLine(buffer, position, fieldLength, lineLength);
      position += lineLength + 1;
    }
    if (position === length) {
      buffer = "";
    } else if (position > 0) {
      buffer = buffer.slice(position);
    }
  }
  function parseEventStreamLine(lineBuffer, index, fieldLength, lineLength) {
    if (lineLength === 0) {
      if (data.length > 0) {
        onParse({
          type: "event",
          id: eventId,
          event: eventName || void 0,
          data: data.slice(0, -1)
          // remove trailing newline
        });

        data = "";
        eventId = void 0;
      }
      eventName = void 0;
      return;
    }
    const noValue = fieldLength < 0;
    const field = lineBuffer.slice(index, index + (noValue ? lineLength : fieldLength));
    let step = 0;
    if (noValue) {
      step = lineLength;
    } else if (lineBuffer[index + fieldLength + 1] === " ") {
      step = fieldLength + 2;
    } else {
      step = fieldLength + 1;
    }
    const position = index + step;
    const valueLength = lineLength - step;
    const value = lineBuffer.slice(position, position + valueLength).toString();
    if (field === "data") {
      data += value ? "".concat(value, "\n") : "\n";
    } else if (field === "event") {
      eventName = value;
    } else if (field === "id" && !value.includes("\0")) {
      eventId = value;
    } else if (field === "retry") {
      const retry = parseInt(value, 10);
      if (!Number.isNaN(retry)) {
        onParse({
          type: "reconnect-interval",
          value: retry
        });
      }
    }
  }
}
const BOM = [239, 187, 191];
function hasBom(buffer) {
  return BOM.every((charCode, index) => buffer.charCodeAt(index) === charCode);
}
exports.createParser = createParser;
//# sourceMappingURL=index.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/microsoft.cognitiveservices.speech.sdk.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/microsoft.cognitiveservices.speech.sdk.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ActivityReceivedEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ActivityReceivedEventArgs),
/* harmony export */   "AudioConfig": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioConfig),
/* harmony export */   "AudioFormatTag": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioFormatTag),
/* harmony export */   "AudioInputStream": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioInputStream),
/* harmony export */   "AudioOutputStream": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioOutputStream),
/* harmony export */   "AudioStreamFormat": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioStreamFormat),
/* harmony export */   "AutoDetectSourceLanguageConfig": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.AutoDetectSourceLanguageConfig),
/* harmony export */   "AutoDetectSourceLanguageResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.AutoDetectSourceLanguageResult),
/* harmony export */   "BaseAudioPlayer": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.BaseAudioPlayer),
/* harmony export */   "BotFrameworkConfig": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.BotFrameworkConfig),
/* harmony export */   "CancellationDetails": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationDetails),
/* harmony export */   "CancellationDetailsBase": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationDetailsBase),
/* harmony export */   "CancellationErrorCode": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationErrorCode),
/* harmony export */   "CancellationReason": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationReason),
/* harmony export */   "Connection": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.Connection),
/* harmony export */   "ConnectionEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConnectionEventArgs),
/* harmony export */   "ConnectionMessage": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConnectionMessage),
/* harmony export */   "ConnectionMessageEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConnectionMessageEventArgs),
/* harmony export */   "Conversation": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.Conversation),
/* harmony export */   "ConversationExpirationEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationExpirationEventArgs),
/* harmony export */   "ConversationParticipantsChangedEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationParticipantsChangedEventArgs),
/* harmony export */   "ConversationTranscriber": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationTranscriber),
/* harmony export */   "ConversationTranscriptionCanceledEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationTranscriptionCanceledEventArgs),
/* harmony export */   "ConversationTranscriptionEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationTranscriptionEventArgs),
/* harmony export */   "ConversationTranslationCanceledEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationTranslationCanceledEventArgs),
/* harmony export */   "ConversationTranslationEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationTranslationEventArgs),
/* harmony export */   "ConversationTranslationResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationTranslationResult),
/* harmony export */   "ConversationTranslator": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationTranslator),
/* harmony export */   "CustomCommandsConfig": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.CustomCommandsConfig),
/* harmony export */   "Diagnostics": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.Diagnostics),
/* harmony export */   "DialogServiceConfig": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.DialogServiceConfig),
/* harmony export */   "DialogServiceConnector": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.DialogServiceConnector),
/* harmony export */   "IntentRecognitionCanceledEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.IntentRecognitionCanceledEventArgs),
/* harmony export */   "IntentRecognitionEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.IntentRecognitionEventArgs),
/* harmony export */   "IntentRecognitionResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.IntentRecognitionResult),
/* harmony export */   "IntentRecognizer": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.IntentRecognizer),
/* harmony export */   "KeywordRecognitionModel": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.KeywordRecognitionModel),
/* harmony export */   "LanguageIdMode": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.LanguageIdMode),
/* harmony export */   "LanguageUnderstandingModel": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.LanguageUnderstandingModel),
/* harmony export */   "LogLevel": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.LogLevel),
/* harmony export */   "NoMatchDetails": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.NoMatchDetails),
/* harmony export */   "NoMatchReason": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.NoMatchReason),
/* harmony export */   "OutputFormat": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.OutputFormat),
/* harmony export */   "Participant": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.Participant),
/* harmony export */   "ParticipantChangedReason": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ParticipantChangedReason),
/* harmony export */   "PhraseListGrammar": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PhraseListGrammar),
/* harmony export */   "ProfanityOption": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ProfanityOption),
/* harmony export */   "PronunciationAssessmentConfig": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PronunciationAssessmentConfig),
/* harmony export */   "PronunciationAssessmentGradingSystem": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PronunciationAssessmentGradingSystem),
/* harmony export */   "PronunciationAssessmentGranularity": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PronunciationAssessmentGranularity),
/* harmony export */   "PronunciationAssessmentResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PronunciationAssessmentResult),
/* harmony export */   "PropertyCollection": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyCollection),
/* harmony export */   "PropertyId": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId),
/* harmony export */   "PullAudioInputStream": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PullAudioInputStream),
/* harmony export */   "PullAudioInputStreamCallback": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PullAudioInputStreamCallback),
/* harmony export */   "PullAudioOutputStream": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PullAudioOutputStream),
/* harmony export */   "PushAudioInputStream": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PushAudioInputStream),
/* harmony export */   "PushAudioOutputStream": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PushAudioOutputStream),
/* harmony export */   "PushAudioOutputStreamCallback": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PushAudioOutputStreamCallback),
/* harmony export */   "RecognitionEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.RecognitionEventArgs),
/* harmony export */   "RecognitionResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.RecognitionResult),
/* harmony export */   "Recognizer": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.Recognizer),
/* harmony export */   "ResultReason": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ResultReason),
/* harmony export */   "ServiceEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ServiceEventArgs),
/* harmony export */   "ServicePropertyChannel": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ServicePropertyChannel),
/* harmony export */   "SessionEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SessionEventArgs),
/* harmony export */   "SourceLanguageConfig": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SourceLanguageConfig),
/* harmony export */   "SpeakerAudioDestination": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeakerAudioDestination),
/* harmony export */   "SpeakerIdentificationModel": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeakerIdentificationModel),
/* harmony export */   "SpeakerRecognitionCancellationDetails": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeakerRecognitionCancellationDetails),
/* harmony export */   "SpeakerRecognitionResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeakerRecognitionResult),
/* harmony export */   "SpeakerRecognitionResultType": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeakerRecognitionResultType),
/* harmony export */   "SpeakerRecognizer": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeakerRecognizer),
/* harmony export */   "SpeakerVerificationModel": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeakerVerificationModel),
/* harmony export */   "SpeechConfig": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechConfig),
/* harmony export */   "SpeechConfigImpl": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechConfigImpl),
/* harmony export */   "SpeechRecognitionCanceledEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechRecognitionCanceledEventArgs),
/* harmony export */   "SpeechRecognitionEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechRecognitionEventArgs),
/* harmony export */   "SpeechRecognitionResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechRecognitionResult),
/* harmony export */   "SpeechRecognizer": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechRecognizer),
/* harmony export */   "SpeechSynthesisBookmarkEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechSynthesisBookmarkEventArgs),
/* harmony export */   "SpeechSynthesisBoundaryType": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechSynthesisBoundaryType),
/* harmony export */   "SpeechSynthesisEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechSynthesisEventArgs),
/* harmony export */   "SpeechSynthesisOutputFormat": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechSynthesisOutputFormat),
/* harmony export */   "SpeechSynthesisResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechSynthesisResult),
/* harmony export */   "SpeechSynthesisVisemeEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechSynthesisVisemeEventArgs),
/* harmony export */   "SpeechSynthesisWordBoundaryEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechSynthesisWordBoundaryEventArgs),
/* harmony export */   "SpeechSynthesizer": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechSynthesizer),
/* harmony export */   "SpeechTranslationConfig": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechTranslationConfig),
/* harmony export */   "SpeechTranslationConfigImpl": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechTranslationConfigImpl),
/* harmony export */   "SynthesisResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SynthesisResult),
/* harmony export */   "SynthesisVoicesResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SynthesisVoicesResult),
/* harmony export */   "TranslationRecognitionCanceledEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.TranslationRecognitionCanceledEventArgs),
/* harmony export */   "TranslationRecognitionEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.TranslationRecognitionEventArgs),
/* harmony export */   "TranslationRecognitionResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.TranslationRecognitionResult),
/* harmony export */   "TranslationRecognizer": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.TranslationRecognizer),
/* harmony export */   "TranslationSynthesisEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.TranslationSynthesisEventArgs),
/* harmony export */   "TranslationSynthesisResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.TranslationSynthesisResult),
/* harmony export */   "Translations": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.Translations),
/* harmony export */   "TurnStatusReceivedEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.TurnStatusReceivedEventArgs),
/* harmony export */   "User": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.User),
/* harmony export */   "VoiceInfo": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.VoiceInfo),
/* harmony export */   "VoiceProfile": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.VoiceProfile),
/* harmony export */   "VoiceProfileCancellationDetails": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.VoiceProfileCancellationDetails),
/* harmony export */   "VoiceProfileClient": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.VoiceProfileClient),
/* harmony export */   "VoiceProfileEnrollmentCancellationDetails": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.VoiceProfileEnrollmentCancellationDetails),
/* harmony export */   "VoiceProfileEnrollmentResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.VoiceProfileEnrollmentResult),
/* harmony export */   "VoiceProfilePhraseResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.VoiceProfilePhraseResult),
/* harmony export */   "VoiceProfileResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.VoiceProfileResult),
/* harmony export */   "VoiceProfileType": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.VoiceProfileType)
/* harmony export */ });
/* harmony import */ var _src_common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./src/common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ConsoleLoggingListener.js");
/* harmony import */ var _src_common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./src/common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./src/sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Exports.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


// Common.Storage.SetLocalStorage(new Common.Browser.LocalStorage());
// Common.Storage.SetSessionStorage(new Common.Browser.SessionStorage());
_src_common_Exports__WEBPACK_IMPORTED_MODULE_0__.Events.instance.attachConsoleListener(new _src_common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__.ConsoleLoggingListener());
// Speech SDK API


//# sourceMappingURL=microsoft.cognitiveservices.speech.sdk.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ConsoleLoggingListener.js":
/*!*************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ConsoleLoggingListener.js ***!
  \*************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConsoleLoggingListener": () => (/* binding */ ConsoleLoggingListener)
/* harmony export */ });
/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ "?0825");
/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _sdk_LogLevel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/LogLevel */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js");
/* harmony import */ var _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../sdk/Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* eslint-disable @typescript-eslint/no-unsafe-assignment */
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



class ConsoleLoggingListener {
    constructor(logLevelFilter = _sdk_LogLevel__WEBPACK_IMPORTED_MODULE_1__.EventType.None) {
        this.privLogPath = undefined;
        this.privEnableConsoleOutput = true;
        this.privLogLevelFilter = logLevelFilter;
    }
    set logPath(path) {
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrUndefined(fs__WEBPACK_IMPORTED_MODULE_0__.openSync, "\nFile System access not available");
        this.privLogPath = path;
    }
    set enableConsoleOutput(enableOutput) {
        this.privEnableConsoleOutput = enableOutput;
    }
    onEvent(event) {
        if (event.eventType >= this.privLogLevelFilter) {
            const log = this.toString(event);
            if (!!this.privLogPath) {
                fs__WEBPACK_IMPORTED_MODULE_0__.writeFileSync(this.privLogPath, log + "\n", { flag: "a+" });
            }
            if (this.privEnableConsoleOutput) {
                switch (event.eventType) {
                    case _sdk_LogLevel__WEBPACK_IMPORTED_MODULE_1__.EventType.Debug:
                        // eslint-disable-next-line no-console
                        console.debug(log);
                        break;
                    case _sdk_LogLevel__WEBPACK_IMPORTED_MODULE_1__.EventType.Info:
                        // eslint-disable-next-line no-console
                        console.info(log);
                        break;
                    case _sdk_LogLevel__WEBPACK_IMPORTED_MODULE_1__.EventType.Warning:
                        // eslint-disable-next-line no-console
                        console.warn(log);
                        break;
                    case _sdk_LogLevel__WEBPACK_IMPORTED_MODULE_1__.EventType.Error:
                        // eslint-disable-next-line no-console
                        console.error(log);
                        break;
                    default:
                        // eslint-disable-next-line no-console
                        console.log(log);
                        break;
                }
            }
        }
    }
    toString(event) {
        const logFragments = [
            `${event.eventTime}`,
            `${event.name}`,
        ];
        const e = event;
        for (const prop in e) {
            if (prop && event.hasOwnProperty(prop) &&
                prop !== "eventTime" && prop !== "eventType" &&
                prop !== "eventId" && prop !== "name" &&
                prop !== "constructor") {
                // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access
                const value = e[prop];
                let valueToLog = "<NULL>";
                if (value !== undefined && value !== null) {
                    if (typeof (value) === "number" || typeof (value) === "string") {
                        valueToLog = value.toString();
                    }
                    else {
                        valueToLog = JSON.stringify(value);
                    }
                }
                logFragments.push(`${prop}: ${valueToLog}`);
            }
        }
        return logFragments.join(" | ");
    }
}

//# sourceMappingURL=ConsoleLoggingListener.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/FileAudioSource.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/FileAudioSource.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "FileAudioSource": () => (/* binding */ FileAudioSource)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/AudioSourceEvents.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ChunkedArrayBufferStream.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _sdk_Audio_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Audio/AudioStreamFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioStreamFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



class FileAudioSource {
    constructor(file, filename, audioSourceId) {
        this.privStreams = {};
        this.privHeaderEnd = 44;
        this.privId = audioSourceId ? audioSourceId : (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.EventSource();
        this.privSource = file;
        if (typeof window !== "undefined" && typeof Blob !== "undefined" && this.privSource instanceof Blob) {
            this.privFilename = file.name;
        }
        else {
            this.privFilename = filename || "unknown.wav";
        }
        // Read the header.
        this.privAudioFormatPromise = this.readHeader();
    }
    get format() {
        return this.privAudioFormatPromise;
    }
    turnOn() {
        if (this.privFilename.lastIndexOf(".wav") !== this.privFilename.length - 4) {
            const errorMsg = this.privFilename + " is not supported. Only WAVE files are allowed at the moment.";
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioSourceErrorEvent(errorMsg, ""));
            return Promise.reject(errorMsg);
        }
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioSourceInitializingEvent(this.privId)); // no stream id
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioSourceReadyEvent(this.privId));
        return;
    }
    id() {
        return this.privId;
    }
    attach(audioNodeId) {
        return __awaiter(this, void 0, void 0, function* () {
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioStreamNodeAttachingEvent(this.privId, audioNodeId));
            const stream = yield this.upload(audioNodeId);
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioStreamNodeAttachedEvent(this.privId, audioNodeId));
            return Promise.resolve({
                detach: () => __awaiter(this, void 0, void 0, function* () {
                    stream.readEnded();
                    delete this.privStreams[audioNodeId];
                    this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioStreamNodeDetachedEvent(this.privId, audioNodeId));
                    yield this.turnOff();
                }),
                id: () => audioNodeId,
                read: () => stream.read(),
            });
        });
    }
    detach(audioNodeId) {
        if (audioNodeId && this.privStreams[audioNodeId]) {
            this.privStreams[audioNodeId].close();
            delete this.privStreams[audioNodeId];
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioStreamNodeDetachedEvent(this.privId, audioNodeId));
        }
    }
    turnOff() {
        for (const streamId in this.privStreams) {
            if (streamId) {
                const stream = this.privStreams[streamId];
                if (stream && !stream.isClosed) {
                    stream.close();
                }
            }
        }
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioSourceOffEvent(this.privId)); // no stream now
        return Promise.resolve();
    }
    get events() {
        return this.privEvents;
    }
    get deviceInfo() {
        return this.privAudioFormatPromise.then((result) => (Promise.resolve({
            bitspersample: result.bitsPerSample,
            channelcount: result.channels,
            connectivity: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.connectivity.Unknown,
            manufacturer: "Speech SDK",
            model: "File",
            samplerate: result.samplesPerSec,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.type.File,
        })));
    }
    readHeader() {
        // Read the wave header.
        const maxHeaderSize = 4296;
        const header = this.privSource.slice(0, maxHeaderSize);
        const headerResult = new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.Deferred();
        const processHeader = (header) => {
            const view = new DataView(header);
            const getWord = (index) => String.fromCharCode(view.getUint8(index), view.getUint8(index + 1), view.getUint8(index + 2), view.getUint8(index + 3));
            // RIFF 4 bytes.
            if ("RIFF" !== getWord(0)) {
                headerResult.reject("Invalid WAV header in file, RIFF was not found");
                return;
            }
            // length, 4 bytes
            // RIFF Type & fmt 8 bytes
            if ("WAVE" !== getWord(8) || "fmt " !== getWord(12)) {
                headerResult.reject("Invalid WAV header in file, WAVEfmt was not found");
                return;
            }
            const formatSize = view.getInt32(16, true);
            const channelCount = view.getUint16(22, true);
            const sampleRate = view.getUint32(24, true);
            const bitsPerSample = view.getUint16(34, true);
            // Confirm if header is 44 bytes long.
            let pos = 36 + Math.max(formatSize - 16, 0);
            for (; getWord(pos) !== "data"; pos += 2) {
                if (pos > maxHeaderSize - 8) {
                    headerResult.reject("Invalid WAV header in file, data block was not found");
                    return;
                }
            }
            this.privHeaderEnd = pos + 8;
            headerResult.resolve(_sdk_Audio_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_5__.AudioStreamFormat.getWaveFormatPCM(sampleRate, bitsPerSample, channelCount));
        };
        if (typeof window !== "undefined" && typeof Blob !== "undefined" && header instanceof Blob) {
            const reader = new FileReader();
            reader.onload = (event) => {
                const header = event.target.result;
                processHeader(header);
            };
            reader.readAsArrayBuffer(header);
        }
        else {
            const h = header;
            processHeader(h.buffer.slice(h.byteOffset, h.byteOffset + h.byteLength));
        }
        return headerResult.promise;
    }
    upload(audioNodeId) {
        return __awaiter(this, void 0, void 0, function* () {
            const onerror = (error) => {
                const errorMsg = `Error occurred while processing '${this.privFilename}'. ${error}`;
                this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioStreamNodeErrorEvent(this.privId, audioNodeId, errorMsg));
                throw new Error(errorMsg);
            };
            try {
                yield this.turnOn();
                const format = yield this.privAudioFormatPromise;
                const stream = new _common_Exports__WEBPACK_IMPORTED_MODULE_6__.ChunkedArrayBufferStream(format.avgBytesPerSec / 10, audioNodeId);
                this.privStreams[audioNodeId] = stream;
                const chunk = this.privSource.slice(this.privHeaderEnd);
                const processFile = (buff) => {
                    if (stream.isClosed) {
                        return; // output stream was closed (somebody called TurnOff). We're done here.
                    }
                    stream.writeStreamChunk({
                        buffer: buff,
                        isEnd: false,
                        timeReceived: Date.now(),
                    });
                    stream.close();
                };
                if (typeof window !== "undefined" && typeof Blob !== "undefined" && chunk instanceof Blob) {
                    const reader = new FileReader();
                    reader.onerror = (ev) => onerror(ev.toString());
                    reader.onload = (event) => {
                        const fileBuffer = event.target.result;
                        processFile(fileBuffer);
                    };
                    reader.readAsArrayBuffer(chunk);
                }
                else {
                    const c = chunk;
                    processFile(c.buffer.slice(c.byteOffset, c.byteOffset + c.byteLength));
                }
                return stream;
            }
            catch (e) {
                onerror(e);
            }
        });
    }
    onEvent(event) {
        this.privEvents.onEvent(event);
        _common_Exports__WEBPACK_IMPORTED_MODULE_7__.Events.instance.onEvent(event);
    }
}

//# sourceMappingURL=FileAudioSource.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/MicAudioSource.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/MicAudioSource.js ***!
  \*****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioWorkletSourceURLPropertyName": () => (/* binding */ AudioWorkletSourceURLPropertyName),
/* harmony export */   "MicAudioSource": () => (/* binding */ MicAudioSource)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/AudioSourceEvents.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ChunkedArrayBufferStream.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _sdk_Audio_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../sdk/Audio/AudioStreamFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioStreamFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



const AudioWorkletSourceURLPropertyName = "MICROPHONE-WorkletSourceUrl";
class MicAudioSource {
    constructor(privRecorder, deviceId, audioSourceId, mediaStream) {
        this.privRecorder = privRecorder;
        this.deviceId = deviceId;
        this.privStreams = {};
        this.privOutputChunkSize = MicAudioSource.AUDIOFORMAT.avgBytesPerSec / 10;
        this.privId = audioSourceId ? audioSourceId : (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.EventSource();
        this.privMediaStream = mediaStream || null;
        this.privIsClosing = false;
    }
    get format() {
        return Promise.resolve(MicAudioSource.AUDIOFORMAT);
    }
    turnOn() {
        if (this.privInitializeDeferral) {
            return this.privInitializeDeferral.promise;
        }
        this.privInitializeDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.Deferred();
        try {
            this.createAudioContext();
        }
        catch (error) {
            if (error instanceof Error) {
                const typedError = error;
                this.privInitializeDeferral.reject(typedError.name + ": " + typedError.message);
            }
            else {
                this.privInitializeDeferral.reject(error);
            }
            return this.privInitializeDeferral.promise;
        }
        const nav = window.navigator;
        let getUserMedia = (
        // eslint-disable-next-line
        nav.getUserMedia ||
            nav.webkitGetUserMedia ||
            nav.mozGetUserMedia ||
            nav.msGetUserMedia);
        if (!!nav.mediaDevices) {
            getUserMedia = (constraints, successCallback, errorCallback) => {
                nav.mediaDevices
                    .getUserMedia(constraints)
                    .then(successCallback)
                    .catch(errorCallback);
            };
        }
        if (!getUserMedia) {
            const errorMsg = "Browser does not support getUserMedia.";
            this.privInitializeDeferral.reject(errorMsg);
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioSourceErrorEvent(errorMsg, "")); // mic initialized error - no streamid at this point
        }
        else {
            const next = () => {
                this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioSourceInitializingEvent(this.privId)); // no stream id
                if (this.privMediaStream && this.privMediaStream.active) {
                    this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioSourceReadyEvent(this.privId));
                    this.privInitializeDeferral.resolve();
                }
                else {
                    getUserMedia({ audio: this.deviceId ? { deviceId: this.deviceId } : true, video: false }, (mediaStream) => {
                        this.privMediaStream = mediaStream;
                        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioSourceReadyEvent(this.privId));
                        this.privInitializeDeferral.resolve();
                    }, (error) => {
                        const errorMsg = `Error occurred during microphone initialization: ${error}`;
                        this.privInitializeDeferral.reject(errorMsg);
                        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioSourceErrorEvent(this.privId, errorMsg));
                    });
                }
            };
            if (this.privContext.state === "suspended") {
                // NOTE: On iOS, the Web Audio API requires sounds to be triggered from an explicit user action.
                // https://github.com/WebAudio/web-audio-api/issues/790
                this.privContext.resume()
                    .then(next)
                    .catch((reason) => {
                    this.privInitializeDeferral.reject(`Failed to initialize audio context: ${reason}`);
                });
            }
            else {
                next();
            }
        }
        return this.privInitializeDeferral.promise;
    }
    id() {
        return this.privId;
    }
    attach(audioNodeId) {
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioStreamNodeAttachingEvent(this.privId, audioNodeId));
        return this.listen(audioNodeId).then((stream) => {
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioStreamNodeAttachedEvent(this.privId, audioNodeId));
            return {
                detach: () => __awaiter(this, void 0, void 0, function* () {
                    stream.readEnded();
                    delete this.privStreams[audioNodeId];
                    this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioStreamNodeDetachedEvent(this.privId, audioNodeId));
                    return this.turnOff();
                }),
                id: () => audioNodeId,
                read: () => stream.read(),
            };
        });
    }
    detach(audioNodeId) {
        if (audioNodeId && this.privStreams[audioNodeId]) {
            this.privStreams[audioNodeId].close();
            delete this.privStreams[audioNodeId];
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioStreamNodeDetachedEvent(this.privId, audioNodeId));
        }
    }
    turnOff() {
        return __awaiter(this, void 0, void 0, function* () {
            for (const streamId in this.privStreams) {
                if (streamId) {
                    const stream = this.privStreams[streamId];
                    if (stream) {
                        stream.close();
                    }
                }
            }
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioSourceOffEvent(this.privId)); // no stream now
            if (this.privInitializeDeferral) {
                // Correctly handle when browser forces mic off before turnOn() completes
                // eslint-disable-next-line @typescript-eslint/await-thenable
                yield this.privInitializeDeferral;
                this.privInitializeDeferral = null;
            }
            yield this.destroyAudioContext();
            return;
        });
    }
    get events() {
        return this.privEvents;
    }
    get deviceInfo() {
        return this.getMicrophoneLabel().then((label) => ({
            bitspersample: MicAudioSource.AUDIOFORMAT.bitsPerSample,
            channelcount: MicAudioSource.AUDIOFORMAT.channels,
            connectivity: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.connectivity.Unknown,
            manufacturer: "Speech SDK",
            model: label,
            samplerate: MicAudioSource.AUDIOFORMAT.samplesPerSec,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.type.Microphones,
        }));
    }
    setProperty(name, value) {
        if (name === AudioWorkletSourceURLPropertyName) {
            this.privRecorder.setWorkletUrl(value);
        }
        else {
            throw new Error("Property '" + name + "' is not supported on Microphone.");
        }
    }
    getMicrophoneLabel() {
        const defaultMicrophoneName = "microphone";
        // If we did this already, return the value.
        if (this.privMicrophoneLabel !== undefined) {
            return Promise.resolve(this.privMicrophoneLabel);
        }
        // If the stream isn't currently running, we can't query devices because security.
        if (this.privMediaStream === undefined || !this.privMediaStream.active) {
            return Promise.resolve(defaultMicrophoneName);
        }
        // Setup a default
        this.privMicrophoneLabel = defaultMicrophoneName;
        // Get the id of the device running the audio track.
        const microphoneDeviceId = this.privMediaStream.getTracks()[0].getSettings().deviceId;
        // If the browser doesn't support getting the device ID, set a default and return.
        if (undefined === microphoneDeviceId) {
            return Promise.resolve(this.privMicrophoneLabel);
        }
        const deferred = new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.Deferred();
        // Enumerate the media devices.
        navigator.mediaDevices.enumerateDevices().then((devices) => {
            for (const device of devices) {
                if (device.deviceId === microphoneDeviceId) {
                    // Found the device
                    this.privMicrophoneLabel = device.label;
                    break;
                }
            }
            deferred.resolve(this.privMicrophoneLabel);
        }, () => deferred.resolve(this.privMicrophoneLabel));
        return deferred.promise;
    }
    listen(audioNodeId) {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.turnOn();
            const stream = new _common_Exports__WEBPACK_IMPORTED_MODULE_5__.ChunkedArrayBufferStream(this.privOutputChunkSize, audioNodeId);
            this.privStreams[audioNodeId] = stream;
            try {
                this.privRecorder.record(this.privContext, this.privMediaStream, stream);
            }
            catch (error) {
                this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioStreamNodeErrorEvent(this.privId, audioNodeId, error));
                throw error;
            }
            const result = stream;
            return result;
        });
    }
    onEvent(event) {
        this.privEvents.onEvent(event);
        _common_Exports__WEBPACK_IMPORTED_MODULE_6__.Events.instance.onEvent(event);
    }
    createAudioContext() {
        if (!!this.privContext) {
            return;
        }
        this.privContext = _sdk_Audio_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_7__.AudioStreamFormatImpl.getAudioContext(MicAudioSource.AUDIOFORMAT.samplesPerSec);
    }
    destroyAudioContext() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.privContext) {
                return;
            }
            this.privRecorder.releaseMediaResources(this.privContext);
            // This pattern brought to you by a bug in the TypeScript compiler where it
            // confuses the ("close" in this.privContext) with this.privContext always being null as the alternate.
            // https://github.com/Microsoft/TypeScript/issues/11498
            let hasClose = false;
            if ("close" in this.privContext) {
                hasClose = true;
            }
            if (hasClose) {
                if (!this.privIsClosing) {
                    // The audio context close may take enough time that the close is called twice
                    this.privIsClosing = true;
                    yield this.privContext.close();
                    this.privContext = null;
                    this.privIsClosing = false;
                }
            }
            else if (null !== this.privContext && this.privContext.state === "running") {
                // Suspend actually takes a callback, but analogous to the
                // resume method, it'll be only fired if suspend is called
                // in a direct response to a user action. The later is not always
                // the case, as TurnOff is also called, when we receive an
                // end-of-speech message from the service. So, doing a best effort
                // fire-and-forget here.
                yield this.privContext.suspend();
            }
        });
    }
}
MicAudioSource.AUDIOFORMAT = _sdk_Audio_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_7__.AudioStreamFormat.getDefaultInputFormat();

//# sourceMappingURL=MicAudioSource.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/PCMRecorder.js":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/PCMRecorder.js ***!
  \**************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PcmRecorder": () => (/* binding */ PcmRecorder)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/RiffPcmEncoder.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class PcmRecorder {
    constructor(stopInputOnRelease) {
        this.privStopInputOnRelease = stopInputOnRelease;
    }
    record(context, mediaStream, outputStream) {
        const desiredSampleRate = 16000;
        const waveStreamEncoder = new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.RiffPcmEncoder(context.sampleRate, desiredSampleRate);
        const micInput = context.createMediaStreamSource(mediaStream);
        const attachScriptProcessor = () => {
            // eslint-disable-next-line @typescript-eslint/explicit-function-return-type
            const scriptNode = (() => {
                let bufferSize = 0;
                try {
                    return context.createScriptProcessor(bufferSize, 1, 1);
                }
                catch (error) {
                    // Webkit (<= version 31) requires a valid bufferSize.
                    bufferSize = 2048;
                    let audioSampleRate = context.sampleRate;
                    while (bufferSize < 16384 && audioSampleRate >= (2 * desiredSampleRate)) {
                        bufferSize <<= 1;
                        audioSampleRate >>= 1;
                    }
                    return context.createScriptProcessor(bufferSize, 1, 1);
                }
            })();
            scriptNode.onaudioprocess = (event) => {
                const inputFrame = event.inputBuffer.getChannelData(0);
                if (outputStream && !outputStream.isClosed) {
                    const waveFrame = waveStreamEncoder.encode(inputFrame);
                    if (!!waveFrame) {
                        outputStream.writeStreamChunk({
                            buffer: waveFrame,
                            isEnd: false,
                            timeReceived: Date.now(),
                        });
                    }
                }
            };
            micInput.connect(scriptNode);
            scriptNode.connect(context.destination);
            this.privMediaResources = {
                scriptProcessorNode: scriptNode,
                source: micInput,
                stream: mediaStream,
            };
        };
        // https://webaudio.github.io/web-audio-api/#audioworklet
        // Using AudioWorklet to improve audio quality and avoid audio glitches due to blocking the UI thread
        if (!!context.audioWorklet) {
            if (!this.privSpeechProcessorScript) {
                const workletScript = `class SP extends AudioWorkletProcessor {
                    constructor(options) {
                      super(options);
                    }
                    process(inputs, outputs) {
                      const input = inputs[0];
                      const output = [];
                      for (let channel = 0; channel < input.length; channel += 1) {
                        output[channel] = input[channel];
                      }
                      this.port.postMessage(output[0]);
                      return true;
                    }
                  }
                  registerProcessor('speech-processor', SP);`;
                const blob = new Blob([workletScript], { type: "application/javascript; charset=utf-8" });
                this.privSpeechProcessorScript = URL.createObjectURL(blob);
            }
            context.audioWorklet
                .addModule(this.privSpeechProcessorScript)
                .then(() => {
                const workletNode = new AudioWorkletNode(context, "speech-processor");
                workletNode.port.onmessage = (ev) => {
                    const inputFrame = ev.data;
                    if (outputStream && !outputStream.isClosed) {
                        const waveFrame = waveStreamEncoder.encode(inputFrame);
                        if (!!waveFrame) {
                            outputStream.writeStreamChunk({
                                buffer: waveFrame,
                                isEnd: false,
                                timeReceived: Date.now(),
                            });
                        }
                    }
                };
                micInput.connect(workletNode);
                workletNode.connect(context.destination);
                this.privMediaResources = {
                    scriptProcessorNode: workletNode,
                    source: micInput,
                    stream: mediaStream,
                };
            })
                .catch(() => {
                attachScriptProcessor();
            });
        }
        else {
            try {
                attachScriptProcessor();
            }
            catch (err) {
                throw new Error(`Unable to start audio worklet node for PCMRecorder: ${err}`);
            }
        }
    }
    releaseMediaResources(context) {
        if (this.privMediaResources) {
            if (this.privMediaResources.scriptProcessorNode) {
                this.privMediaResources.scriptProcessorNode.disconnect(context.destination);
                this.privMediaResources.scriptProcessorNode = null;
            }
            if (this.privMediaResources.source) {
                this.privMediaResources.source.disconnect();
                if (this.privStopInputOnRelease) {
                    this.privMediaResources.stream.getTracks().forEach((track) => track.stop());
                }
                this.privMediaResources.source = null;
            }
        }
    }
    setWorkletUrl(url) {
        this.privSpeechProcessorScript = url;
    }
}

//# sourceMappingURL=PCMRecorder.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js":
/*!************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ProxyInfo": () => (/* binding */ ProxyInfo)
/* harmony export */ });
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class ProxyInfo {
    constructor(proxyHostName, proxyPort, proxyUserName, proxyPassword) {
        this.privProxyHostName = proxyHostName;
        this.privProxyPort = proxyPort;
        this.privProxyUserName = proxyUserName;
        this.privProxyPassword = proxyPassword;
    }
    static fromParameters(parameters) {
        return new ProxyInfo(parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_ProxyHostName), parseInt(parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_ProxyPort), 10), parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_ProxyUserName), parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_ProxyPassword));
    }
    static fromRecognizerConfig(config) {
        return this.fromParameters(config.parameters);
    }
    get HostName() {
        return this.privProxyHostName;
    }
    get Port() {
        return this.privProxyPort;
    }
    get UserName() {
        return this.privProxyUserName;
    }
    get Password() {
        return this.privProxyPassword;
    }
}

//# sourceMappingURL=ProxyInfo.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ReplayableAudioNode.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ReplayableAudioNode.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ReplayableAudioNode": () => (/* binding */ ReplayableAudioNode)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class ReplayableAudioNode {
    constructor(audioSource, bytesPerSecond) {
        this.privBuffers = [];
        this.privReplayOffset = 0;
        this.privLastShrinkOffset = 0;
        this.privBufferStartOffset = 0;
        this.privBufferSerial = 0;
        this.privBufferedBytes = 0;
        this.privReplay = false;
        this.privLastChunkAcquiredTime = 0;
        this.privAudioNode = audioSource;
        this.privBytesPerSecond = bytesPerSecond;
    }
    id() {
        return this.privAudioNode.id();
    }
    // Reads and returns the next chunk of audio buffer.
    // If replay of existing buffers are needed, read() will first seek and replay
    // existing content, and upoin completion it will read new content from the underlying
    // audio node, saving that content into the replayable buffers.
    read() {
        // if there is a replay request to honor.
        if (!!this.privReplay && this.privBuffers.length !== 0) {
            // Find the start point in the buffers.
            // Offsets are in 100ns increments.
            // So how many bytes do we need to seek to get the right offset?
            const offsetToSeek = this.privReplayOffset - this.privBufferStartOffset;
            let bytesToSeek = Math.round(offsetToSeek * this.privBytesPerSecond * 1e-7);
            if (0 !== (bytesToSeek % 2)) {
                bytesToSeek++;
            }
            let i = 0;
            while (i < this.privBuffers.length && bytesToSeek >= this.privBuffers[i].chunk.buffer.byteLength) {
                bytesToSeek -= this.privBuffers[i++].chunk.buffer.byteLength;
            }
            if (i < this.privBuffers.length) {
                const retVal = this.privBuffers[i].chunk.buffer.slice(bytesToSeek);
                this.privReplayOffset += (retVal.byteLength / this.privBytesPerSecond) * 1e+7;
                // If we've reached the end of the buffers, stop replaying.
                if (i === this.privBuffers.length - 1) {
                    this.privReplay = false;
                }
                return Promise.resolve({
                    buffer: retVal,
                    isEnd: false,
                    timeReceived: this.privBuffers[i].chunk.timeReceived,
                });
            }
        }
        return this.privAudioNode.read()
            .then((result) => {
            if (result && result.buffer) {
                this.privBuffers.push(new BufferEntry(result, this.privBufferSerial++, this.privBufferedBytes));
                this.privBufferedBytes += result.buffer.byteLength;
            }
            return result;
        });
    }
    detach() {
        this.privBuffers = undefined;
        return this.privAudioNode.detach();
    }
    replay() {
        if (this.privBuffers && 0 !== this.privBuffers.length) {
            this.privReplay = true;
            this.privReplayOffset = this.privLastShrinkOffset;
        }
    }
    // Shrinks the existing audio buffers to start at the new offset, or at the
    // beginning of the buffer closest to the requested offset.
    // A replay request will start from the last shrink point.
    shrinkBuffers(offset) {
        if (this.privBuffers === undefined || this.privBuffers.length === 0) {
            return;
        }
        this.privLastShrinkOffset = offset;
        // Find the start point in the buffers.
        // Offsets are in 100ns increments.
        // So how many bytes do we need to seek to get the right offset?
        const offsetToSeek = offset - this.privBufferStartOffset;
        let bytesToSeek = Math.round(offsetToSeek * this.privBytesPerSecond * 1e-7);
        let i = 0;
        while (i < this.privBuffers.length && bytesToSeek >= this.privBuffers[i].chunk.buffer.byteLength) {
            bytesToSeek -= this.privBuffers[i++].chunk.buffer.byteLength;
        }
        this.privBufferStartOffset = Math.round(offset - ((bytesToSeek / this.privBytesPerSecond) * 1e+7));
        this.privBuffers = this.privBuffers.slice(i);
    }
    // Finds the time a buffer of audio was first seen by offset.
    findTimeAtOffset(offset) {
        if (offset < this.privBufferStartOffset || this.privBuffers === undefined) {
            return 0;
        }
        for (const value of this.privBuffers) {
            const startOffset = (value.byteOffset / this.privBytesPerSecond) * 1e7;
            const endOffset = startOffset + ((value.chunk.buffer.byteLength / this.privBytesPerSecond) * 1e7);
            if (offset >= startOffset && offset <= endOffset) {
                return value.chunk.timeReceived;
            }
        }
        return 0;
    }
}
// Primary use of this class is to help debugging problems with the replay
// code. If the memory cost of alloc / dealloc gets too much, drop it and just use
// the ArrayBuffer directly.
class BufferEntry {
    constructor(chunk, serial, byteOffset) {
        this.chunk = chunk;
        this.serial = serial;
        this.byteOffset = byteOffset;
    }
}

//# sourceMappingURL=ReplayableAudioNode.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/RestConfigBase.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/RestConfigBase.js ***!
  \*****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RestConfigBase": () => (/* binding */ RestConfigBase)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class RestConfigBase {
    static get requestOptions() {
        return RestConfigBase.privDefaultRequestOptions;
    }
    static get configParams() {
        return RestConfigBase.privDefaultParams;
    }
    static get restErrors() {
        return RestConfigBase.privRestErrors;
    }
}
RestConfigBase.privDefaultRequestOptions = {
    headers: {
        Accept: "application/json",
    },
    ignoreCache: false,
    timeout: 10000,
};
RestConfigBase.privRestErrors = {
    authInvalidSubscriptionKey: "You must specify either an authentication token to use, or a Cognitive Speech subscription key.",
    authInvalidSubscriptionRegion: "You must specify the Cognitive Speech region to use.",
    invalidArgs: "Required input not found: {arg}.",
    invalidCreateJoinConversationResponse: "Creating/Joining conversation failed with HTTP {status}.",
    invalidParticipantRequest: "The requested participant was not found.",
    permissionDeniedConnect: "Required credentials not found.",
    permissionDeniedConversation: "Invalid operation: only the host can {command} the conversation.",
    permissionDeniedParticipant: "Invalid operation: only the host can {command} a participant.",
    permissionDeniedSend: "Invalid operation: the conversation is not in a connected state.",
    permissionDeniedStart: "Invalid operation: there is already an active conversation.",
};
RestConfigBase.privDefaultParams = {
    apiVersion: "api-version",
    authorization: "Authorization",
    clientAppId: "X-ClientAppId",
    contentTypeKey: "Content-Type",
    correlationId: "X-CorrelationId",
    languageCode: "language",
    nickname: "nickname",
    profanity: "profanity",
    requestId: "X-RequestId",
    roomId: "roomid",
    sessionToken: "token",
    subscriptionKey: "Ocp-Apim-Subscription-Key",
    subscriptionRegion: "Ocp-Apim-Subscription-Region",
    token: "X-CapitoToken",
};

//# sourceMappingURL=RestConfigBase.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/RestMessageAdapter.js":
/*!*********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/RestMessageAdapter.js ***!
  \*********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RestMessageAdapter": () => (/* binding */ RestMessageAdapter),
/* harmony export */   "RestRequestType": () => (/* binding */ RestRequestType)
/* harmony export */ });
/* harmony import */ var bent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bent */ "./node_modules/bent/src/browser.js");
/* harmony import */ var bent__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(bent__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


var RestRequestType;
(function (RestRequestType) {
    RestRequestType["Get"] = "GET";
    RestRequestType["Post"] = "POST";
    RestRequestType["Delete"] = "DELETE";
    RestRequestType["File"] = "file";
})(RestRequestType || (RestRequestType = {}));
// accept rest operations via request method and return abstracted objects from server response
class RestMessageAdapter {
    constructor(configParams) {
        if (!configParams) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.ArgumentNullError("configParams");
        }
        this.privHeaders = configParams.headers;
        this.privIgnoreCache = configParams.ignoreCache;
    }
    static extractHeaderValue(headerKey, headers) {
        let headerValue = "";
        try {
            const arr = headers.trim().split(/[\r\n]+/);
            const headerMap = {};
            arr.forEach((line) => {
                const parts = line.split(": ");
                const header = parts.shift().toLowerCase();
                const value = parts.join(": ");
                headerMap[header] = value;
            });
            headerValue = headerMap[headerKey.toLowerCase()];
        }
        catch (e) {
            // ignore the error
        }
        return headerValue;
    }
    set options(configParams) {
        this.privHeaders = configParams.headers;
        this.privIgnoreCache = configParams.ignoreCache;
    }
    setHeaders(key, value) {
        this.privHeaders[key] = value;
    }
    request(method, uri, queryParams = {}, body = null) {
        const responseReceivedDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.Deferred();
        const requestCommand = method === RestRequestType.File ? "POST" : method;
        const handleRestResponse = (data, j = {}) => {
            const d = data;
            return {
                data: JSON.stringify(j),
                headers: JSON.stringify(data.headers),
                json: j,
                ok: data.statusCode >= 200 && data.statusCode < 300,
                status: data.statusCode,
                statusText: j.error ? j.error.message : d.statusText ? d.statusText : d.statusMessage
            };
        };
        const send = (postData) => {
            const sendRequest = bent__WEBPACK_IMPORTED_MODULE_0___default()(uri, requestCommand, this.privHeaders, 200, 201, 202, 204, 400, 401, 402, 403, 404);
            const params = this.queryParams(queryParams) === "" ? "" : `?${this.queryParams(queryParams)}`;
            sendRequest(params, postData).then((data) => __awaiter(this, void 0, void 0, function* () {
                if (method === RestRequestType.Delete || data.statusCode === 204) {
                    // No JSON from Delete and reset (204) operations
                    responseReceivedDeferral.resolve(handleRestResponse(data));
                }
                else {
                    try {
                        const j = yield data.json();
                        responseReceivedDeferral.resolve(handleRestResponse(data, j));
                    }
                    catch (_a) {
                        responseReceivedDeferral.resolve(handleRestResponse(data));
                    }
                }
            })).catch((error) => {
                responseReceivedDeferral.reject(error);
            });
        };
        if (this.privIgnoreCache) {
            this.privHeaders["Cache-Control"] = "no-cache";
        }
        if (method === RestRequestType.Post && body) {
            this.privHeaders["content-type"] = "application/json";
            this.privHeaders["Content-Type"] = "application/json";
        }
        send(body);
        return responseReceivedDeferral.promise;
    }
    queryParams(params = {}) {
        return Object.keys(params)
            .map((k) => encodeURIComponent(k) + "=" + encodeURIComponent(params[k]))
            .join("&");
    }
}

//# sourceMappingURL=RestMessageAdapter.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "WebsocketConnection": () => (/* binding */ WebsocketConnection)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _WebsocketMessageAdapter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./WebsocketMessageAdapter */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketMessageAdapter.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


class WebsocketConnection {
    constructor(uri, queryParameters, headers, messageFormatter, proxyInfo, enableCompression = false, connectionId) {
        this.privIsDisposed = false;
        if (!uri) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("uri");
        }
        if (!messageFormatter) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("messageFormatter");
        }
        this.privMessageFormatter = messageFormatter;
        let queryParams = "";
        let i = 0;
        if (queryParameters) {
            for (const paramName in queryParameters) {
                if (paramName) {
                    queryParams += ((i === 0) && (uri.indexOf("?") === -1)) ? "?" : "&";
                    const key = encodeURIComponent(paramName);
                    queryParams += key;
                    let val = queryParameters[paramName];
                    if (val) {
                        val = encodeURIComponent(val);
                        queryParams += `=${val}`;
                    }
                    i++;
                }
            }
        }
        if (headers) {
            for (const headerName in headers) {
                if (headerName) {
                    queryParams += ((i === 0) && (uri.indexOf("?") === -1)) ? "?" : "&";
                    const val = encodeURIComponent(headers[headerName]);
                    queryParams += `${headerName}=${val}`;
                    i++;
                }
            }
        }
        this.privUri = uri + queryParams;
        this.privId = connectionId ? connectionId : (0,_common_Exports__WEBPACK_IMPORTED_MODULE_1__.createNoDashGuid)();
        this.privConnectionMessageAdapter = new _WebsocketMessageAdapter__WEBPACK_IMPORTED_MODULE_2__.WebsocketMessageAdapter(this.privUri, this.id, this.privMessageFormatter, proxyInfo, headers, enableCompression);
    }
    dispose() {
        return __awaiter(this, void 0, void 0, function* () {
            this.privIsDisposed = true;
            if (this.privConnectionMessageAdapter) {
                yield this.privConnectionMessageAdapter.close();
            }
        });
    }
    isDisposed() {
        return this.privIsDisposed;
    }
    get id() {
        return this.privId;
    }
    get uri() {
        return this.privUri;
    }
    state() {
        return this.privConnectionMessageAdapter.state;
    }
    open() {
        return this.privConnectionMessageAdapter.open();
    }
    send(message) {
        return this.privConnectionMessageAdapter.send(message);
    }
    read() {
        return this.privConnectionMessageAdapter.read();
    }
    get events() {
        return this.privConnectionMessageAdapter.events;
    }
}

//# sourceMappingURL=WebsocketConnection.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketMessageAdapter.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketMessageAdapter.js ***!
  \**************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "WebsocketMessageAdapter": () => (/* binding */ WebsocketMessageAdapter)
/* harmony export */ });
/* harmony import */ var net__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net */ "?a1bf");
/* harmony import */ var net__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var tls__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tls */ "?14d6");
/* harmony import */ var tls__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(tls__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var agent_base__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! agent-base */ "?6483");
/* harmony import */ var agent_base__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(agent_base__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var https_proxy_agent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! https-proxy-agent */ "?72ad");
/* harmony import */ var https_proxy_agent__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(https_proxy_agent__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var ws__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ws */ "?e42a");
/* harmony import */ var ws__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(ws__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _common_speech_HeaderNames__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../common.speech/HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/IConnection.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Queue.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/BackgroundError.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionOpenResponse.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionEvents.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/RawWebsocketMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};







class WebsocketMessageAdapter {
    constructor(uri, connectionId, messageFormatter, proxyInfo, headers, enableCompression) {
        if (!uri) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_5__.ArgumentNullError("uri");
        }
        if (!messageFormatter) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_5__.ArgumentNullError("messageFormatter");
        }
        this.proxyInfo = proxyInfo;
        this.privConnectionEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_6__.EventSource();
        this.privConnectionId = connectionId;
        this.privMessageFormatter = messageFormatter;
        this.privConnectionState = _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.None;
        this.privUri = uri;
        this.privHeaders = headers;
        this.privEnableCompression = enableCompression;
        // Add the connection ID to the headers
        this.privHeaders[_common_speech_HeaderNames__WEBPACK_IMPORTED_MODULE_8__.HeaderNames.ConnectionId] = this.privConnectionId;
        this.privLastErrorReceived = "";
    }
    get state() {
        return this.privConnectionState;
    }
    open() {
        if (this.privConnectionState === _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Disconnected) {
            return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);
        }
        if (this.privConnectionEstablishDeferral) {
            return this.privConnectionEstablishDeferral.promise;
        }
        this.privConnectionEstablishDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_9__.Deferred();
        this.privCertificateValidatedDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_9__.Deferred();
        this.privConnectionState = _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Connecting;
        try {
            if (typeof WebSocket !== "undefined" && !WebsocketMessageAdapter.forceNpmWebSocket) {
                // Browser handles cert checks.
                this.privCertificateValidatedDeferral.resolve();
                this.privWebsocketClient = new WebSocket(this.privUri);
            }
            else {
                const options = { headers: this.privHeaders, perMessageDeflate: this.privEnableCompression };
                // The ocsp library will handle validation for us and fail the connection if needed.
                this.privCertificateValidatedDeferral.resolve();
                options.agent = this.getAgent();
                // Workaround for https://github.com/microsoft/cognitive-services-speech-sdk-js/issues/465
                // Which is root caused by https://github.com/TooTallNate/node-agent-base/issues/61
                const uri = new URL(this.privUri);
                let protocol = uri.protocol;
                if ((protocol === null || protocol === void 0 ? void 0 : protocol.toLocaleLowerCase()) === "wss:") {
                    protocol = "https:";
                }
                else if ((protocol === null || protocol === void 0 ? void 0 : protocol.toLocaleLowerCase()) === "ws:") {
                    protocol = "http:";
                }
                // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access
                options.agent.protocol = protocol;
                this.privWebsocketClient = new (ws__WEBPACK_IMPORTED_MODULE_4___default())(this.privUri, options);
            }
            this.privWebsocketClient.binaryType = "arraybuffer";
            this.privReceivingMessageQueue = new _common_Exports__WEBPACK_IMPORTED_MODULE_10__.Queue();
            this.privDisconnectDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_9__.Deferred();
            this.privSendMessageQueue = new _common_Exports__WEBPACK_IMPORTED_MODULE_10__.Queue();
            this.processSendQueue().catch((reason) => {
                _common_Exports__WEBPACK_IMPORTED_MODULE_11__.Events.instance.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_12__.BackgroundEvent(reason));
            });
        }
        catch (error) {
            this.privConnectionEstablishDeferral.resolve(new _common_Exports__WEBPACK_IMPORTED_MODULE_13__.ConnectionOpenResponse(500, error));
            return this.privConnectionEstablishDeferral.promise;
        }
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_14__.ConnectionStartEvent(this.privConnectionId, this.privUri));
        this.privWebsocketClient.onopen = () => {
            this.privCertificateValidatedDeferral.promise.then(() => {
                this.privConnectionState = _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Connected;
                this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_14__.ConnectionEstablishedEvent(this.privConnectionId));
                this.privConnectionEstablishDeferral.resolve(new _common_Exports__WEBPACK_IMPORTED_MODULE_13__.ConnectionOpenResponse(200, ""));
            }, (error) => {
                this.privConnectionEstablishDeferral.reject(error);
            });
        };
        this.privWebsocketClient.onerror = (e) => {
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_14__.ConnectionErrorEvent(this.privConnectionId, e.message, e.type));
            this.privLastErrorReceived = e.message;
        };
        this.privWebsocketClient.onclose = (e) => {
            if (this.privConnectionState === _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Connecting) {
                this.privConnectionState = _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Disconnected;
                // this.onEvent(new ConnectionEstablishErrorEvent(this.connectionId, e.code, e.reason));
                this.privConnectionEstablishDeferral.resolve(new _common_Exports__WEBPACK_IMPORTED_MODULE_13__.ConnectionOpenResponse(e.code, e.reason + " " + this.privLastErrorReceived));
            }
            else {
                this.privConnectionState = _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Disconnected;
                this.privWebsocketClient = null;
                this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_14__.ConnectionClosedEvent(this.privConnectionId, e.code, e.reason));
            }
            this.onClose(e.code, e.reason).catch((reason) => {
                _common_Exports__WEBPACK_IMPORTED_MODULE_11__.Events.instance.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_12__.BackgroundEvent(reason));
            });
        };
        this.privWebsocketClient.onmessage = (e) => {
            const networkReceivedTime = new Date().toISOString();
            if (this.privConnectionState === _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Connected) {
                const deferred = new _common_Exports__WEBPACK_IMPORTED_MODULE_9__.Deferred();
                // let id = ++this.idCounter;
                this.privReceivingMessageQueue.enqueueFromPromise(deferred.promise);
                if (e.data instanceof ArrayBuffer) {
                    const rawMessage = new _common_Exports__WEBPACK_IMPORTED_MODULE_15__.RawWebsocketMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_16__.MessageType.Binary, e.data);
                    this.privMessageFormatter
                        .toConnectionMessage(rawMessage)
                        .then((connectionMessage) => {
                        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_14__.ConnectionMessageReceivedEvent(this.privConnectionId, networkReceivedTime, connectionMessage));
                        deferred.resolve(connectionMessage);
                    }, (error) => {
                        // TODO: Events for these ?
                        deferred.reject(`Invalid binary message format. Error: ${error}`);
                    });
                }
                else {
                    const rawMessage = new _common_Exports__WEBPACK_IMPORTED_MODULE_15__.RawWebsocketMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_16__.MessageType.Text, e.data);
                    this.privMessageFormatter
                        .toConnectionMessage(rawMessage)
                        .then((connectionMessage) => {
                        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_14__.ConnectionMessageReceivedEvent(this.privConnectionId, networkReceivedTime, connectionMessage));
                        deferred.resolve(connectionMessage);
                    }, (error) => {
                        // TODO: Events for these ?
                        deferred.reject(`Invalid text message format. Error: ${error}`);
                    });
                }
            }
        };
        return this.privConnectionEstablishDeferral.promise;
    }
    send(message) {
        if (this.privConnectionState !== _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Connected) {
            return Promise.reject(`Cannot send on connection that is in ${_common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState[this.privConnectionState]} state`);
        }
        const messageSendStatusDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_9__.Deferred();
        const messageSendDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_9__.Deferred();
        this.privSendMessageQueue.enqueueFromPromise(messageSendDeferral.promise);
        this.privMessageFormatter
            .fromConnectionMessage(message)
            .then((rawMessage) => {
            messageSendDeferral.resolve({
                Message: message,
                RawWebsocketMessage: rawMessage,
                sendStatusDeferral: messageSendStatusDeferral,
            });
        }, (error) => {
            messageSendDeferral.reject(`Error formatting the message. ${error}`);
        });
        return messageSendStatusDeferral.promise;
    }
    read() {
        if (this.privConnectionState !== _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Connected) {
            return Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`);
        }
        return this.privReceivingMessageQueue.dequeue();
    }
    close(reason) {
        if (this.privWebsocketClient) {
            if (this.privConnectionState !== _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Disconnected) {
                this.privWebsocketClient.close(1000, reason ? reason : "Normal closure by client");
            }
        }
        else {
            return Promise.resolve();
        }
        return this.privDisconnectDeferral.promise;
    }
    get events() {
        return this.privConnectionEvents;
    }
    sendRawMessage(sendItem) {
        try {
            // indicates we are draining the queue and it came with no message;
            if (!sendItem) {
                return Promise.resolve();
            }
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_14__.ConnectionMessageSentEvent(this.privConnectionId, new Date().toISOString(), sendItem.Message));
            // add a check for the ws readystate in order to stop the red console error 'WebSocket is already in CLOSING or CLOSED state' appearing
            if (this.isWebsocketOpen) {
                // eslint-disable-next-line @typescript-eslint/no-unsafe-argument
                this.privWebsocketClient.send(sendItem.RawWebsocketMessage.payload);
            }
            else {
                return Promise.reject("websocket send error: Websocket not ready " + this.privConnectionId + " " + sendItem.Message.id + " " + new Error().stack);
            }
            return Promise.resolve();
        }
        catch (e) {
            return Promise.reject(`websocket send error: ${e}`);
        }
    }
    onClose(code, reason) {
        return __awaiter(this, void 0, void 0, function* () {
            const closeReason = `Connection closed. ${code}: ${reason}`;
            this.privConnectionState = _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Disconnected;
            this.privDisconnectDeferral.resolve();
            yield this.privReceivingMessageQueue.drainAndDispose(() => {
                // TODO: Events for these ?
                // Logger.instance.onEvent(new LoggingEvent(LogType.Warning, null, `Failed to process received message. Reason: ${closeReason}, Message: ${JSON.stringify(pendingReceiveItem)}`));
            }, closeReason);
            yield this.privSendMessageQueue.drainAndDispose((pendingSendItem) => {
                pendingSendItem.sendStatusDeferral.reject(closeReason);
            }, closeReason);
        });
    }
    processSendQueue() {
        return __awaiter(this, void 0, void 0, function* () {
            while (true) {
                const itemToSend = this.privSendMessageQueue.dequeue();
                const sendItem = yield itemToSend;
                // indicates we are draining the queue and it came with no message;
                if (!sendItem) {
                    return;
                }
                try {
                    yield this.sendRawMessage(sendItem);
                    sendItem.sendStatusDeferral.resolve();
                }
                catch (sendError) {
                    sendItem.sendStatusDeferral.reject(sendError);
                }
            }
        });
    }
    onEvent(event) {
        this.privConnectionEvents.onEvent(event);
        _common_Exports__WEBPACK_IMPORTED_MODULE_11__.Events.instance.onEvent(event);
    }
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    getAgent() {
        // eslint-disable-next-line @typescript-eslint/unbound-method
        const agent = new (agent_base__WEBPACK_IMPORTED_MODULE_2___default().Agent)(this.createConnection);
        if (this.proxyInfo !== undefined &&
            this.proxyInfo.HostName !== undefined &&
            this.proxyInfo.Port > 0) {
            agent.proxyInfo = this.proxyInfo;
        }
        return agent;
    }
    static GetProxyAgent(proxyInfo) {
        const httpProxyOptions = {
            host: proxyInfo.HostName,
            port: proxyInfo.Port,
        };
        if (!!proxyInfo.UserName) {
            httpProxyOptions.headers = {
                "Proxy-Authentication": "Basic " + new Buffer(`${proxyInfo.UserName}:${(proxyInfo.Password === undefined) ? "" : proxyInfo.Password}`).toString("base64"),
            };
        }
        else {
            httpProxyOptions.headers = {};
        }
        httpProxyOptions.headers.requestOCSP = "true";
        const httpProxyAgent = new (https_proxy_agent__WEBPACK_IMPORTED_MODULE_3___default())(httpProxyOptions);
        return httpProxyAgent;
    }
    createConnection(request, options) {
        let socketPromise;
        options = Object.assign(Object.assign({}, options), {
            requestOCSP: true,
            servername: options.host
        });
        if (!!this.proxyInfo) {
            const httpProxyAgent = WebsocketMessageAdapter.GetProxyAgent(this.proxyInfo);
            const baseAgent = httpProxyAgent;
            socketPromise = new Promise((resolve, reject) => {
                baseAgent.callback(request, options, (error, socket) => {
                    if (!!error) {
                        reject(error);
                    }
                    else {
                        resolve(socket);
                    }
                });
            });
        }
        else {
            if (!!options.secureEndpoint) {
                socketPromise = Promise.resolve(tls__WEBPACK_IMPORTED_MODULE_1__.connect(options));
            }
            else {
                socketPromise = Promise.resolve(net__WEBPACK_IMPORTED_MODULE_0__.connect(options));
            }
        }
        return socketPromise;
    }
    get isWebsocketOpen() {
        return this.privWebsocketClient && this.privWebsocketClient.readyState === this.privWebsocketClient.OPEN;
    }
}
WebsocketMessageAdapter.forceNpmWebSocket = false;

//# sourceMappingURL=WebsocketMessageAdapter.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/AddedLmIntent.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/AddedLmIntent.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AddedLmIntent": () => (/* binding */ AddedLmIntent)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * @class AddedLmIntent
 */
// eslint-disable-next-line max-classes-per-file
class AddedLmIntent {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param modelImpl - The model.
     * @param intentName - The intent name.
     */
    constructor(modelImpl, intentName) {
        this.modelImpl = modelImpl;
        this.intentName = intentName;
    }
}

//# sourceMappingURL=AddedLmIntent.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/AgentConfig.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/AgentConfig.js ***!
  \*************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AgentConfig": () => (/* binding */ AgentConfig)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Represents the JSON used in the agent.config message sent to the speech service.
 */
class AgentConfig {
    toJsonString() {
        return JSON.stringify(this.iPrivConfig);
    }
    get() {
        return this.iPrivConfig;
    }
    /**
     * Setter for the agent.config object.
     * @param value a JSON serializable object.
     */
    set(value) {
        this.iPrivConfig = value;
    }
}

//# sourceMappingURL=AgentConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveSubscriptionKeyAuthentication.js":
/*!****************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveSubscriptionKeyAuthentication.js ***!
  \****************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CognitiveSubscriptionKeyAuthentication": () => (/* binding */ CognitiveSubscriptionKeyAuthentication)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
/* harmony import */ var _IAuthentication__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./IAuthentication */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IAuthentication.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



/**
 * @class
 */
class CognitiveSubscriptionKeyAuthentication {
    /**
     * Creates and initializes an instance of the CognitiveSubscriptionKeyAuthentication class.
     * @constructor
     * @param {string} subscriptionKey - The subscription key
     */
    constructor(subscriptionKey) {
        if (!subscriptionKey) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("subscriptionKey");
        }
        this.privAuthInfo = new _IAuthentication__WEBPACK_IMPORTED_MODULE_1__.AuthInfo(_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.AuthKey, subscriptionKey);
    }
    /**
     * Fetches the subscription key.
     * @member
     * @function
     * @public
     * @param {string} authFetchEventId - The id to fetch.
     */
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    fetch(authFetchEventId) {
        return Promise.resolve(this.privAuthInfo);
    }
    /**
     * Fetches the subscription key.
     * @member
     * @function
     * @public
     * @param {string} authFetchEventId - The id to fetch.
     */
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    fetchOnExpiry(authFetchEventId) {
        return Promise.resolve(this.privAuthInfo);
    }
}

//# sourceMappingURL=CognitiveSubscriptionKeyAuthentication.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveTokenAuthentication.js":
/*!******************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveTokenAuthentication.js ***!
  \******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CognitiveTokenAuthentication": () => (/* binding */ CognitiveTokenAuthentication)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _IAuthentication__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./IAuthentication */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IAuthentication.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



class CognitiveTokenAuthentication {
    constructor(fetchCallback, fetchOnExpiryCallback) {
        if (!fetchCallback) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("fetchCallback");
        }
        if (!fetchOnExpiryCallback) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("fetchOnExpiryCallback");
        }
        this.privFetchCallback = fetchCallback;
        this.privFetchOnExpiryCallback = fetchOnExpiryCallback;
    }
    fetch(authFetchEventId) {
        return this.privFetchCallback(authFetchEventId).then((token) => new _IAuthentication__WEBPACK_IMPORTED_MODULE_1__.AuthInfo(_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.Authorization, token === undefined ? undefined : CognitiveTokenAuthentication.privTokenPrefix + token));
    }
    fetchOnExpiry(authFetchEventId) {
        return this.privFetchOnExpiryCallback(authFetchEventId).then((token) => new _IAuthentication__WEBPACK_IMPORTED_MODULE_1__.AuthInfo(_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.Authorization, token === undefined ? undefined : CognitiveTokenAuthentication.privTokenPrefix + token));
    }
}
CognitiveTokenAuthentication.privTokenPrefix = "bearer ";

//# sourceMappingURL=CognitiveTokenAuthentication.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js ***!
  \***********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectionFactoryBase": () => (/* binding */ ConnectionFactoryBase)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./QueryParameterNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/QueryParameterNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



class ConnectionFactoryBase {
    static getHostSuffix(region) {
        if (!!region) {
            if (region.toLowerCase().startsWith("china")) {
                return ".azure.cn";
            }
            if (region.toLowerCase().startsWith("usgov")) {
                return ".azure.us";
            }
        }
        return ".microsoft.com";
    }
    setCommonUrlParams(config, queryParams, endpoint) {
        const propertyIdToParameterMap = new Map([
            [_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.Speech_SegmentationSilenceTimeoutMs, _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.SegmentationSilenceTimeoutMs],
            [_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_EnableAudioLogging, _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.EnableAudioLogging],
            [_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs, _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.EndSilenceTimeoutMs],
            [_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs, _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.InitialSilenceTimeoutMs],
            [_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceResponse_PostProcessingOption, _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.Postprocessing],
            [_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceResponse_ProfanityOption, _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.Profanity],
            [_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps, _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.EnableWordLevelTimestamps],
            [_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceResponse_StablePartialResultThreshold, _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.StableIntermediateThreshold],
        ]);
        propertyIdToParameterMap.forEach((parameterName, propertyId) => {
            this.setUrlParameter(propertyId, parameterName, config, queryParams, endpoint);
        });
        const serviceProperties = JSON.parse(config.parameters.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.ServicePropertiesPropertyName, "{}"));
        Object.keys(serviceProperties).forEach((value) => {
            queryParams[value] = serviceProperties[value];
        });
    }
    setUrlParameter(propId, parameterName, config, queryParams, endpoint) {
        const value = config.parameters.getProperty(propId, undefined);
        // FIXME: The .search() check will incorrectly match parameter name anywhere in the string
        //        including e.g. the path portion, or even as a substring of other query parameters
        if (value && (!endpoint || endpoint.search(parameterName) === -1)) {
            queryParams[parameterName] = value.toLocaleLowerCase();
        }
    }
}

//# sourceMappingURL=ConnectionFactoryBase.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConversationServiceRecognizer.js":
/*!*******************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConversationServiceRecognizer.js ***!
  \*******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationServiceRecognizer": () => (/* binding */ ConversationServiceRecognizer)
/* harmony export */ });
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionResult.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SimpleSpeechPhrase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/EnumTranslation.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/DetailedSpeechPhrase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechHypothesis.js");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


class ConversationServiceRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.ServiceRecognizerBase {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, recognizer) {
        super(authentication, connectionFactory, audioSource, recognizerConfig, recognizer);
        this.handleSpeechPhraseMessage = (textBody) => __awaiter(this, void 0, void 0, function* () { return this.handleSpeechPhrase(textBody); });
        this.handleSpeechHypothesisMessage = (textBody) => this.handleSpeechHypothesis(textBody);
    }
    processTypeSpecificMessages(connectionMessage) {
        void connectionMessage;
        return;
    }
    handleRecognizedCallback(result, offset, sessionId) {
        void result;
        void offset;
        void sessionId;
        return;
    }
    handleRecognizingCallback(result, duration, sessionId) {
        void result;
        void duration;
        void sessionId;
        return;
    }
    processSpeechMessages(connectionMessage) {
        return __awaiter(this, void 0, void 0, function* () {
            let processed = false;
            switch (connectionMessage.path.toLowerCase()) {
                case "speech.hypothesis":
                case "speech.fragment":
                    if (!!this.handleSpeechHypothesisMessage) {
                        this.handleSpeechHypothesisMessage(connectionMessage.textBody);
                    }
                    processed = true;
                    break;
                case "speech.phrase":
                    if (!!this.handleSpeechPhraseMessage) {
                        yield this.handleSpeechPhraseMessage(connectionMessage.textBody);
                    }
                    processed = true;
                    break;
                default:
                    break;
            }
            return processed;
        });
    }
    cancelRecognition(sessionId, requestId, cancellationReason, errorCode, error) {
        // Implementing to allow inheritance
        void sessionId;
        void requestId;
        void cancellationReason;
        void errorCode;
        void error;
    }
    handleSpeechPhrase(textBody) {
        return __awaiter(this, void 0, void 0, function* () {
            const simple = _Exports__WEBPACK_IMPORTED_MODULE_1__.SimpleSpeechPhrase.fromJSON(textBody);
            const resultReason = _Exports__WEBPACK_IMPORTED_MODULE_2__.EnumTranslation.implTranslateRecognitionResult(simple.RecognitionStatus);
            let result;
            const resultProps = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyCollection();
            resultProps.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceResponse_JsonResult, textBody);
            const simpleOffset = simple.Offset + this.privRequestSession.currentTurnAudioOffset;
            let offset = simpleOffset;
            this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset + simple.Offset + simple.Duration);
            if (_sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.Canceled === resultReason) {
                const cancelReason = _Exports__WEBPACK_IMPORTED_MODULE_2__.EnumTranslation.implTranslateCancelResult(simple.RecognitionStatus);
                const cancellationErrorCode = _Exports__WEBPACK_IMPORTED_MODULE_2__.EnumTranslation.implTranslateCancelErrorCode(simple.RecognitionStatus);
                yield this.cancelRecognitionLocal(cancelReason, cancellationErrorCode, _Exports__WEBPACK_IMPORTED_MODULE_2__.EnumTranslation.implTranslateErrorDetails(cancellationErrorCode));
            }
            else {
                if (!(this.privRequestSession.isSpeechEnded && resultReason === _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.NoMatch && simple.RecognitionStatus !== _Exports__WEBPACK_IMPORTED_MODULE_6__.RecognitionStatus.InitialSilenceTimeout)) {
                    if (this.privRecognizerConfig.parameters.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_7__.OutputFormatPropertyName) === _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.OutputFormat[_sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.OutputFormat.Simple]) {
                        result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.SpeechRecognitionResult(this.privRequestSession.requestId, resultReason, simple.DisplayText, simple.Duration, simpleOffset, simple.Language, simple.LanguageDetectionConfidence, simple.SpeakerId, undefined, textBody, resultProps);
                    }
                    else {
                        const detailed = _Exports__WEBPACK_IMPORTED_MODULE_10__.DetailedSpeechPhrase.fromJSON(textBody);
                        const totalOffset = detailed.Offset + this.privRequestSession.currentTurnAudioOffset;
                        const offsetCorrectedJson = detailed.getJsonWithCorrectedOffsets(totalOffset);
                        result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.SpeechRecognitionResult(this.privRequestSession.requestId, resultReason, detailed.Text, detailed.Duration, totalOffset, detailed.Language, detailed.LanguageDetectionConfidence, detailed.SpeakerId, undefined, offsetCorrectedJson, resultProps);
                        offset = result.offset;
                    }
                    this.handleRecognizedCallback(result, offset, this.privRequestSession.sessionId);
                }
            }
        });
    }
    handleSpeechHypothesis(textBody) {
        const hypothesis = _Exports__WEBPACK_IMPORTED_MODULE_11__.SpeechHypothesis.fromJSON(textBody);
        const offset = hypothesis.Offset + this.privRequestSession.currentTurnAudioOffset;
        const resultProps = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyCollection();
        resultProps.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceResponse_JsonResult, textBody);
        const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.SpeechRecognitionResult(this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.RecognizingSpeech, hypothesis.Text, hypothesis.Duration, offset, hypothesis.Language, hypothesis.LanguageDetectionConfidence, hypothesis.SpeakerId, undefined, textBody, resultProps);
        this.privRequestSession.onHypothesis(offset);
        this.handleRecognizingCallback(result, hypothesis.Duration, this.privRequestSession.sessionId);
    }
}

//# sourceMappingURL=ConversationServiceRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogConnectorFactory.js":
/*!************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogConnectorFactory.js ***!
  \************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DialogConnectionFactory": () => (/* binding */ DialogConnectionFactory)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConfig.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
/* harmony import */ var _QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./QueryParameterNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/QueryParameterNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */







class DialogConnectionFactory extends _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase {
    create(config, authInfo, connectionId) {
        const applicationId = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.Conversation_ApplicationId, "");
        const dialogType = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.Conversation_DialogType);
        const region = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Region);
        const language = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_RecoLanguage, "en-US");
        const requestTurnStatus = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.Conversation_Request_Bot_Status_Messages, "true");
        const queryParams = {};
        queryParams[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.ConnectionId] = connectionId;
        queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.Format] = config.parameters.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.OutputFormatPropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormat[_sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormat.Simple]).toLowerCase();
        queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.Language] = language;
        queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.RequestBotStatusMessages] = requestTurnStatus;
        if (applicationId) {
            queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.BotId] = applicationId;
            if (dialogType === _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.DialogServiceConfig.DialogTypes.CustomCommands) {
                queryParams[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.CustomCommandsAppId] = applicationId;
            }
        }
        const resourceInfix = dialogType === _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.DialogServiceConfig.DialogTypes.CustomCommands ? "commands/"
            : "";
        const version = dialogType === _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.DialogServiceConfig.DialogTypes.CustomCommands ? "v1"
            : dialogType === _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.DialogServiceConfig.DialogTypes.BotFramework ? "v3"
                : "v0";
        const headers = {};
        if (authInfo.token != null && authInfo.token !== "") {
            headers[authInfo.headerName] = authInfo.token;
        }
        // The URL used for connection is chosen in a priority order of specification:
        //  1. If a custom endpoint is provided, that URL is used verbatim.
        //  2. If a custom host is provided (e.g. "wss://my.custom.endpoint.com:1123"), a URL is constructed from it.
        //  3. If no custom connection details are provided, a URL is constructed from default values.
        let endpoint = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Endpoint, "");
        if (!endpoint) {
            const hostSuffix = _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase.getHostSuffix(region);
            const host = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Host, `wss://${region}.${DialogConnectionFactory.BaseUrl}${hostSuffix}`);
            const standardizedHost = host.endsWith("/") ? host : host + "/";
            endpoint = `${standardizedHost}${resourceInfix}${DialogConnectionFactory.ApiKey}/${version}`;
        }
        this.setCommonUrlParams(config, queryParams, endpoint);
        const enableCompression = config.parameters.getProperty("SPEECH-EnableWebsocketCompression", "false") === "true";
        return new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_7__.WebsocketConnection(endpoint, queryParams, headers, new _Exports__WEBPACK_IMPORTED_MODULE_8__.WebsocketMessageFormatter(), _common_browser_Exports__WEBPACK_IMPORTED_MODULE_9__.ProxyInfo.fromRecognizerConfig(config), enableCompression, connectionId);
    }
}
DialogConnectionFactory.ApiKey = "api";
DialogConnectionFactory.BaseUrl = "convai.speech";

//# sourceMappingURL=DialogConnectorFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceAdapter.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceAdapter.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DialogServiceAdapter": () => (/* binding */ DialogServiceAdapter)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ReplayableAudioNode.js");
/* harmony import */ var _common_DialogEvents__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../common/DialogEvents */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/DialogEvents.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionEvents.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/BackgroundError.js");
/* harmony import */ var _sdk_Audio_AudioOutputFormat__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ../sdk/Audio/AudioOutputFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputFormat.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionCanceledEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConfig.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ActivityReceivedEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TurnStatusReceivedEventArgs.js");
/* harmony import */ var _DialogServiceTurnStateManager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./DialogServiceTurnStateManager */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceTurnStateManager.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SimpleSpeechPhrase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechHypothesis.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechKeyword.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechDetected.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/EnumTranslation.js");
/* harmony import */ var _ServiceMessages_ActivityResponsePayload__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./ServiceMessages/ActivityResponsePayload */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/ActivityResponsePayload.js");
/* harmony import */ var _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./SpeechConnectionMessage.Internal */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionMessage.Internal.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};









class DialogServiceAdapter extends _Exports__WEBPACK_IMPORTED_MODULE_0__.ServiceRecognizerBase {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, dialogServiceConnector) {
        super(authentication, connectionFactory, audioSource, recognizerConfig, dialogServiceConnector);
        this.privEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.EventSource();
        this.privDialogServiceConnector = dialogServiceConnector;
        this.receiveMessageOverride = () => this.receiveDialogMessageOverride();
        this.privTurnStateManager = new _DialogServiceTurnStateManager__WEBPACK_IMPORTED_MODULE_2__.DialogServiceTurnStateManager();
        this.recognizeOverride =
            (recoMode, successCallback, errorCallback) => this.listenOnce(recoMode, successCallback, errorCallback);
        this.postConnectImplOverride = (connection) => this.dialogConnectImpl(connection);
        this.configConnectionOverride = (connection) => this.configConnection(connection);
        this.disconnectOverride = () => this.privDisconnect();
        this.privDialogAudioSource = audioSource;
        this.agentConfigSent = false;
        this.privLastResult = null;
        this.connectionEvents.attach((connectionEvent) => {
            if (connectionEvent.name === "ConnectionClosedEvent") {
                this.terminateMessageLoop = true;
            }
        });
    }
    sendMessage(message) {
        return __awaiter(this, void 0, void 0, function* () {
            const interactionGuid = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.createGuid)();
            const requestId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.createNoDashGuid)();
            const agentMessage = {
                context: {
                    interactionId: interactionGuid
                },
                // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
                messagePayload: JSON.parse(message),
                version: 0.5
            };
            const agentMessageJson = JSON.stringify(agentMessage);
            const connection = yield this.fetchConnection();
            yield connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_4__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_5__.MessageType.Text, "agent", requestId, "application/json", agentMessageJson));
        });
    }
    privDisconnect() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.cancelRecognition(this.privRequestSession.sessionId, this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationErrorCode.NoError, "Disconnecting");
            this.terminateMessageLoop = true;
            this.agentConfigSent = false;
            return;
        });
    }
    processTypeSpecificMessages(connectionMessage) {
        const resultProps = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.PropertyCollection();
        if (connectionMessage.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_5__.MessageType.Text) {
            resultProps.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.SpeechServiceResponse_JsonResult, connectionMessage.textBody);
        }
        let result;
        let processed;
        switch (connectionMessage.path.toLowerCase()) {
            case "speech.phrase":
                const speechPhrase = _Exports__WEBPACK_IMPORTED_MODULE_10__.SimpleSpeechPhrase.fromJSON(connectionMessage.textBody);
                this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset + speechPhrase.Offset + speechPhrase.Duration);
                if (speechPhrase.RecognitionStatus !== _Exports__WEBPACK_IMPORTED_MODULE_11__.RecognitionStatus.TooManyRequests && speechPhrase.RecognitionStatus !== _Exports__WEBPACK_IMPORTED_MODULE_11__.RecognitionStatus.Error) {
                    const args = this.fireEventForResult(speechPhrase, resultProps);
                    this.privLastResult = args.result;
                    if (!!this.privDialogServiceConnector.recognized) {
                        try {
                            this.privDialogServiceConnector.recognized(this.privDialogServiceConnector, args);
                            /* eslint-disable no-empty */
                        }
                        catch (error) {
                            // Not going to let errors in the event handler
                            // trip things up.
                        }
                    }
                }
                processed = true;
                break;
            case "speech.hypothesis":
                const hypothesis = _Exports__WEBPACK_IMPORTED_MODULE_12__.SpeechHypothesis.fromJSON(connectionMessage.textBody);
                const offset = hypothesis.Offset + this.privRequestSession.currentTurnAudioOffset;
                result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__.SpeechRecognitionResult(this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.ResultReason.RecognizingSpeech, hypothesis.Text, hypothesis.Duration, offset, hypothesis.Language, hypothesis.LanguageDetectionConfidence, undefined, undefined, connectionMessage.textBody, resultProps);
                this.privRequestSession.onHypothesis(offset);
                const ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__.SpeechRecognitionEventArgs(result, hypothesis.Duration, this.privRequestSession.sessionId);
                if (!!this.privDialogServiceConnector.recognizing) {
                    try {
                        this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector, ev);
                        /* eslint-disable no-empty */
                    }
                    catch (error) {
                        // Not going to let errors in the event handler
                        // trip things up.
                    }
                }
                processed = true;
                break;
            case "speech.keyword":
                const keyword = _Exports__WEBPACK_IMPORTED_MODULE_16__.SpeechKeyword.fromJSON(connectionMessage.textBody);
                result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__.SpeechRecognitionResult(this.privRequestSession.requestId, keyword.Status === "Accepted" ? _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.ResultReason.RecognizedKeyword : _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.ResultReason.NoMatch, keyword.Text, keyword.Duration, keyword.Offset, undefined, undefined, undefined, undefined, connectionMessage.textBody, resultProps);
                if (keyword.Status !== "Accepted") {
                    this.privLastResult = result;
                }
                const event = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__.SpeechRecognitionEventArgs(result, result.duration, result.resultId);
                if (!!this.privDialogServiceConnector.recognized) {
                    try {
                        this.privDialogServiceConnector.recognized(this.privDialogServiceConnector, event);
                        /* eslint-disable no-empty */
                    }
                    catch (error) {
                        // Not going to let errors in the event handler
                        // trip things up.
                    }
                }
                processed = true;
                break;
            case "audio":
                {
                    const audioRequestId = connectionMessage.requestId.toUpperCase();
                    const turn = this.privTurnStateManager.GetTurn(audioRequestId);
                    try {
                        // Empty binary message signals end of stream.
                        if (!connectionMessage.binaryBody) {
                            turn.endAudioStream();
                        }
                        else {
                            turn.audioStream.write(connectionMessage.binaryBody);
                        }
                    }
                    catch (error) {
                        // Not going to let errors in the event handler
                        // trip things up.
                    }
                }
                processed = true;
                break;
            case "response":
                {
                    this.handleResponseMessage(connectionMessage);
                }
                processed = true;
                break;
            default:
                break;
        }
        const defferal = new _common_Exports__WEBPACK_IMPORTED_MODULE_17__.Deferred();
        defferal.resolve(processed);
        return defferal.promise;
    }
    // Cancels recognition.
    cancelRecognition(sessionId, requestId, cancellationReason, errorCode, error) {
        return __awaiter(this, void 0, void 0, function* () {
            this.terminateMessageLoop = true;
            if (!!this.privRequestSession.isRecognizing) {
                yield this.privRequestSession.onStopRecognizing();
            }
            if (!!this.privDialogServiceConnector.canceled) {
                const properties = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.PropertyCollection();
                properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_18__.CancellationErrorCodePropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationErrorCode[errorCode]);
                const cancelEvent = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_19__.SpeechRecognitionCanceledEventArgs(cancellationReason, error, errorCode, undefined, sessionId);
                try {
                    this.privDialogServiceConnector.canceled(this.privDialogServiceConnector, cancelEvent);
                    /* eslint-disable no-empty */
                }
                catch (_a) { }
                if (!!this.privSuccessCallback) {
                    const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__.SpeechRecognitionResult(undefined, // ResultId
                    _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.ResultReason.Canceled, undefined, // Text
                    undefined, // Duration
                    undefined, // Offset
                    undefined, // Language
                    undefined, // Language Detection Confidence
                    undefined, // Speaker Id
                    error, undefined, // Json
                    properties);
                    try {
                        this.privSuccessCallback(result);
                        this.privSuccessCallback = undefined;
                        /* eslint-disable no-empty */
                    }
                    catch (_b) { }
                }
            }
        });
    }
    listenOnce(recoMode, successCallback, errorCallback) {
        return __awaiter(this, void 0, void 0, function* () {
            this.privRecognizerConfig.recognitionMode = recoMode;
            this.privSuccessCallback = successCallback;
            this.privErrorCallback = errorCallback;
            this.privRequestSession.startNewRecognition();
            this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events);
            this.privRecognizerConfig.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.Speech_SessionId, this.privRequestSession.sessionId);
            // Start the connection to the service. The promise this will create is stored and will be used by configureConnection().
            const conPromise = this.connectImpl();
            const preAudioPromise = this.sendPreAudioMessages();
            const node = yield this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId);
            const format = yield this.privDialogAudioSource.format;
            const deviceInfo = yield this.privDialogAudioSource.deviceInfo;
            const audioNode = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_20__.ReplayableAudioNode(node, format.avgBytesPerSec);
            yield this.privRequestSession.onAudioSourceAttachCompleted(audioNode, false);
            this.privRecognizerConfig.SpeechServiceConfig.Context.audio = { source: deviceInfo };
            try {
                yield conPromise;
                yield preAudioPromise;
            }
            catch (error) {
                yield this.cancelRecognition(this.privRequestSession.sessionId, this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationErrorCode.ConnectionFailure, error);
                return Promise.resolve();
            }
            const sessionStartEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_21__.SessionEventArgs(this.privRequestSession.sessionId);
            if (!!this.privRecognizer.sessionStarted) {
                this.privRecognizer.sessionStarted(this.privRecognizer, sessionStartEventArgs);
            }
            const audioSendPromise = this.sendAudio(audioNode);
            // /* eslint-disable no-empty */
            audioSendPromise.then(() => { }, (error) => __awaiter(this, void 0, void 0, function* () {
                yield this.cancelRecognition(this.privRequestSession.sessionId, this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationErrorCode.RuntimeError, error);
            }));
        });
    }
    // Establishes a websocket connection to the end point.
    dialogConnectImpl(connection) {
        this.privConnectionLoop = this.startMessageLoop();
        return connection;
    }
    receiveDialogMessageOverride() {
        // we won't rely on the cascading promises of the connection since we want to continually be available to receive messages
        const communicationCustodian = new _common_Exports__WEBPACK_IMPORTED_MODULE_17__.Deferred();
        const loop = () => __awaiter(this, void 0, void 0, function* () {
            try {
                const isDisposed = this.isDisposed();
                const terminateMessageLoop = (!this.isDisposed() && this.terminateMessageLoop);
                if (isDisposed || terminateMessageLoop) {
                    // We're done.
                    communicationCustodian.resolve(undefined);
                    return;
                }
                const connection = yield this.fetchConnection();
                const message = yield connection.read();
                if (!message) {
                    return loop();
                }
                const connectionMessage = _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_4__.SpeechConnectionMessage.fromConnectionMessage(message);
                switch (connectionMessage.path.toLowerCase()) {
                    case "turn.start":
                        {
                            const turnRequestId = connectionMessage.requestId.toUpperCase();
                            const audioSessionReqId = this.privRequestSession.requestId.toUpperCase();
                            // turn started by the service
                            if (turnRequestId !== audioSessionReqId) {
                                this.privTurnStateManager.StartTurn(turnRequestId);
                            }
                            else {
                                this.privRequestSession.onServiceTurnStartResponse();
                            }
                        }
                        break;
                    case "speech.startdetected":
                        const speechStartDetected = _Exports__WEBPACK_IMPORTED_MODULE_22__.SpeechDetected.fromJSON(connectionMessage.textBody);
                        const speechStartEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_23__.RecognitionEventArgs(speechStartDetected.Offset, this.privRequestSession.sessionId);
                        if (!!this.privRecognizer.speechStartDetected) {
                            this.privRecognizer.speechStartDetected(this.privRecognizer, speechStartEventArgs);
                        }
                        break;
                    case "speech.enddetected":
                        let json;
                        if (connectionMessage.textBody.length > 0) {
                            json = connectionMessage.textBody;
                        }
                        else {
                            // If the request was empty, the JSON returned is empty.
                            json = "{ Offset: 0 }";
                        }
                        const speechStopDetected = _Exports__WEBPACK_IMPORTED_MODULE_22__.SpeechDetected.fromJSON(json);
                        this.privRequestSession.onServiceRecognized(speechStopDetected.Offset + this.privRequestSession.currentTurnAudioOffset);
                        const speechStopEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_23__.RecognitionEventArgs(speechStopDetected.Offset + this.privRequestSession.currentTurnAudioOffset, this.privRequestSession.sessionId);
                        if (!!this.privRecognizer.speechEndDetected) {
                            this.privRecognizer.speechEndDetected(this.privRecognizer, speechStopEventArgs);
                        }
                        break;
                    case "turn.end":
                        {
                            const turnEndRequestId = connectionMessage.requestId.toUpperCase();
                            const audioSessionReqId = this.privRequestSession.requestId.toUpperCase();
                            // turn started by the service
                            if (turnEndRequestId !== audioSessionReqId) {
                                this.privTurnStateManager.CompleteTurn(turnEndRequestId);
                            }
                            else {
                                // Audio session turn
                                const sessionStopEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_21__.SessionEventArgs(this.privRequestSession.sessionId);
                                yield this.privRequestSession.onServiceTurnEndResponse(false);
                                if (!this.privRecognizerConfig.isContinuousRecognition || this.privRequestSession.isSpeechEnded || !this.privRequestSession.isRecognizing) {
                                    if (!!this.privRecognizer.sessionStopped) {
                                        this.privRecognizer.sessionStopped(this.privRecognizer, sessionStopEventArgs);
                                    }
                                }
                                // report result to promise.
                                if (!!this.privSuccessCallback && this.privLastResult) {
                                    try {
                                        this.privSuccessCallback(this.privLastResult);
                                        this.privLastResult = null;
                                    }
                                    catch (e) {
                                        if (!!this.privErrorCallback) {
                                            this.privErrorCallback(e);
                                        }
                                    }
                                    // Only invoke the call back once.
                                    // and if it's successful don't invoke the
                                    // error after that.
                                    this.privSuccessCallback = undefined;
                                    this.privErrorCallback = undefined;
                                }
                            }
                        }
                        break;
                    default:
                        try {
                            const processed = yield this.processTypeSpecificMessages(connectionMessage);
                            if (!processed) {
                                if (!!this.serviceEvents) {
                                    this.serviceEvents.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_24__.ServiceEvent(connectionMessage.path.toLowerCase(), connectionMessage.textBody));
                                }
                            }
                        }
                        catch (e) {
                            //
                        }
                }
                const ret = loop();
                return ret;
            }
            catch (error) {
                this.terminateMessageLoop = true;
                communicationCustodian.resolve();
            }
        });
        loop().catch((reason) => {
            _common_Exports__WEBPACK_IMPORTED_MODULE_25__.Events.instance.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_26__.BackgroundEvent(reason));
        });
        return communicationCustodian.promise;
    }
    startMessageLoop() {
        return __awaiter(this, void 0, void 0, function* () {
            this.terminateMessageLoop = false;
            try {
                yield this.receiveDialogMessageOverride();
            }
            catch (error) {
                yield this.cancelRecognition(this.privRequestSession.sessionId, this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationErrorCode.RuntimeError, error);
            }
            return Promise.resolve();
        });
    }
    // Takes an established websocket connection to the endpoint and sends speech configuration information.
    configConnection(connection) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.terminateMessageLoop) {
                this.terminateMessageLoop = false;
                return Promise.reject("Connection to service terminated.");
            }
            yield this.sendSpeechServiceConfig(connection, this.privRequestSession, this.privRecognizerConfig.SpeechServiceConfig.serialize());
            yield this.sendAgentConfig(connection);
            return connection;
        });
    }
    sendPreAudioMessages() {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.fetchConnection();
            this.addKeywordContextData();
            yield this.sendSpeechContext(connection, true);
            yield this.sendAgentContext(connection);
            yield this.sendWaveHeader(connection);
        });
    }
    sendAgentConfig(connection) {
        if (this.agentConfig && !this.agentConfigSent) {
            if (this.privRecognizerConfig
                .parameters
                .getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.Conversation_DialogType) === _sdk_Exports__WEBPACK_IMPORTED_MODULE_27__.DialogServiceConfig.DialogTypes.CustomCommands) {
                const config = this.agentConfig.get();
                config.botInfo.commandsCulture = this.privRecognizerConfig.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.SpeechServiceConnection_RecoLanguage, "en-us");
                this.agentConfig.set(config);
            }
            this.onEvent(new _common_DialogEvents__WEBPACK_IMPORTED_MODULE_28__.SendingAgentContextMessageEvent(this.agentConfig));
            const agentConfigJson = this.agentConfig.toJsonString();
            // guard against sending this multiple times on one connection
            this.agentConfigSent = true;
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_4__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_5__.MessageType.Text, "agent.config", this.privRequestSession.requestId, "application/json", agentConfigJson));
        }
        return;
    }
    sendAgentContext(connection) {
        const guid = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.createGuid)();
        const speechActivityTemplate = this.privDialogServiceConnector.properties.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.Conversation_Speech_Activity_Template);
        const agentContext = {
            channelData: "",
            context: {
                interactionId: guid
            },
            messagePayload: typeof speechActivityTemplate === undefined ? undefined : speechActivityTemplate,
            version: 0.5
        };
        const agentContextJson = JSON.stringify(agentContext);
        return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_4__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_5__.MessageType.Text, "speech.agent.context", this.privRequestSession.requestId, "application/json", agentContextJson));
    }
    fireEventForResult(serviceResult, properties) {
        const resultReason = _Exports__WEBPACK_IMPORTED_MODULE_29__.EnumTranslation.implTranslateRecognitionResult(serviceResult.RecognitionStatus);
        const offset = serviceResult.Offset + this.privRequestSession.currentTurnAudioOffset;
        const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__.SpeechRecognitionResult(this.privRequestSession.requestId, resultReason, serviceResult.DisplayText, serviceResult.Duration, offset, serviceResult.Language, serviceResult.LanguageDetectionConfidence, undefined, undefined, JSON.stringify(serviceResult), properties);
        const ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__.SpeechRecognitionEventArgs(result, offset, this.privRequestSession.sessionId);
        return ev;
    }
    handleResponseMessage(responseMessage) {
        // "response" messages can contain either "message" (activity) or "MessageStatus" data. Fire the appropriate
        // event according to the message type that's specified.
        const responsePayload = JSON.parse(responseMessage.textBody);
        switch (responsePayload.messageType.toLowerCase()) {
            case "message":
                const responseRequestId = responseMessage.requestId.toUpperCase();
                const activityPayload = _ServiceMessages_ActivityResponsePayload__WEBPACK_IMPORTED_MODULE_30__.ActivityPayloadResponse.fromJSON(responseMessage.textBody);
                const turn = this.privTurnStateManager.GetTurn(responseRequestId);
                // update the conversation Id
                if (activityPayload.conversationId) {
                    const updateAgentConfig = this.agentConfig.get();
                    updateAgentConfig.botInfo.conversationId = activityPayload.conversationId;
                    this.agentConfig.set(updateAgentConfig);
                }
                const pullAudioOutputStream = turn.processActivityPayload(activityPayload, _sdk_Audio_AudioOutputFormat__WEBPACK_IMPORTED_MODULE_31__.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.SpeechServiceConnection_SynthOutputFormat, undefined)));
                const activity = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_32__.ActivityReceivedEventArgs(activityPayload.messagePayload, pullAudioOutputStream);
                if (!!this.privDialogServiceConnector.activityReceived) {
                    try {
                        this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector, activity);
                        /* eslint-disable-next-line no-empty */
                    }
                    catch (error) {
                        // Not going to let errors in the event handler
                        // trip things up.
                    }
                }
                break;
            case "messagestatus":
                if (!!this.privDialogServiceConnector.turnStatusReceived) {
                    try {
                        this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector, new _sdk_Exports__WEBPACK_IMPORTED_MODULE_33__.TurnStatusReceivedEventArgs(responseMessage.textBody));
                        /* eslint-disable-next-line no-empty */
                    }
                    catch (error) {
                        // Not going to let errors in the event handler
                        // trip things up.
                    }
                }
                break;
            default:
                _common_Exports__WEBPACK_IMPORTED_MODULE_25__.Events.instance.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_26__.BackgroundEvent(`Unexpected response of type ${responsePayload.messageType}. Ignoring.`));
                break;
        }
    }
    onEvent(event) {
        this.privEvents.onEvent(event);
        _common_Exports__WEBPACK_IMPORTED_MODULE_25__.Events.instance.onEvent(event);
    }
    addKeywordContextData() {
        const keywordPropertyValue = this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");
        if (keywordPropertyValue === undefined) {
            return;
        }
        const keywordOffsetPropertyValue = this.privRecognizerConfig.parameters
            .getProperty("SPEECH-KeywordsToDetect-Offsets");
        const keywordDurationPropertyValue = this.privRecognizerConfig.parameters
            .getProperty("SPEECH-KeywordsToDetect-Durations");
        const keywords = keywordPropertyValue.split(";");
        const keywordOffsets = keywordOffsetPropertyValue === undefined ? [] : keywordOffsetPropertyValue.split(";");
        const keywordDurations = keywordDurationPropertyValue === undefined ? [] : keywordDurationPropertyValue.split(";");
        const keywordDefinitionArray = [];
        for (let i = 0; i < keywords.length; i++) {
            const definition = {};
            definition.text = keywords[i];
            if (i < keywordOffsets.length) {
                definition.offset = Number(keywordOffsets[i]);
            }
            if (i < keywordDurations.length) {
                definition.duration = Number(keywordDurations[i]);
            }
            keywordDefinitionArray.push(definition);
        }
        this.speechContext.setSection("invocationSource", "VoiceActivationWithKeyword");
        this.speechContext.setSection("keywordDetection", [{
                clientDetectedKeywords: keywordDefinitionArray,
                onReject: { action: "EndOfTurn" },
                type: "startTrigger"
            }]);
    }
}

//# sourceMappingURL=DialogServiceAdapter.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceTurnState.js":
/*!************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceTurnState.js ***!
  \************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DialogServiceTurnState": () => (/* binding */ DialogServiceTurnState)
/* harmony export */ });
/* harmony import */ var _sdk_Audio_AudioOutputFormat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../sdk/Audio/AudioOutputFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputFormat.js");
/* harmony import */ var _sdk_Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Audio/AudioOutputStream */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputStream.js");
/* harmony import */ var _ServiceMessages_ActivityResponsePayload__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ServiceMessages/ActivityResponsePayload */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/ActivityResponsePayload.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



class DialogServiceTurnState {
    constructor(manager, requestId) {
        this.privRequestId = requestId;
        this.privIsCompleted = false;
        this.privAudioStream = null;
        this.privTurnManager = manager;
        this.resetTurnEndTimeout();
    }
    get audioStream() {
        // Called when is needed to stream.
        this.resetTurnEndTimeout();
        return this.privAudioStream;
    }
    processActivityPayload(payload, audioFormat) {
        if (payload.messageDataStreamType === _ServiceMessages_ActivityResponsePayload__WEBPACK_IMPORTED_MODULE_0__.MessageDataStreamType.TextToSpeechAudio) {
            this.privAudioStream = _sdk_Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_1__.AudioOutputStream.createPullStream();
            this.privAudioStream.format = (audioFormat !== undefined) ? audioFormat : _sdk_Audio_AudioOutputFormat__WEBPACK_IMPORTED_MODULE_2__.AudioOutputFormatImpl.getDefaultOutputFormat();
        }
        return this.privAudioStream;
    }
    endAudioStream() {
        if (this.privAudioStream !== null && !this.privAudioStream.isClosed) {
            this.privAudioStream.close();
        }
    }
    complete() {
        if (this.privTimeoutToken !== undefined) {
            // eslint-disable-next-line @typescript-eslint/no-unsafe-argument
            clearTimeout(this.privTimeoutToken);
        }
        this.endAudioStream();
    }
    resetTurnEndTimeout() {
        if (this.privTimeoutToken !== undefined) {
            // eslint-disable-next-line @typescript-eslint/no-unsafe-argument
            clearTimeout(this.privTimeoutToken);
        }
        this.privTimeoutToken = setTimeout(() => {
            this.privTurnManager.CompleteTurn(this.privRequestId);
            return;
        }, 2000);
    }
}

//# sourceMappingURL=DialogServiceTurnState.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceTurnStateManager.js":
/*!*******************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceTurnStateManager.js ***!
  \*******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DialogServiceTurnStateManager": () => (/* binding */ DialogServiceTurnStateManager)
/* harmony export */ });
/* harmony import */ var _common_Error__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Error */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _DialogServiceTurnState__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./DialogServiceTurnState */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceTurnState.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


class DialogServiceTurnStateManager {
    constructor() {
        this.privTurnMap = new Map();
        return;
    }
    StartTurn(id) {
        if (this.privTurnMap.has(id)) {
            throw new _common_Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Service error: There is already a turn with id:" + id);
        }
        const turnState = new _DialogServiceTurnState__WEBPACK_IMPORTED_MODULE_1__.DialogServiceTurnState(this, id);
        this.privTurnMap.set(id, turnState);
        return this.privTurnMap.get(id);
    }
    GetTurn(id) {
        return this.privTurnMap.get(id);
    }
    CompleteTurn(id) {
        if (!this.privTurnMap.has(id)) {
            throw new _common_Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Service error: Received turn end for an unknown turn id:" + id);
        }
        const turnState = this.privTurnMap.get(id);
        turnState.complete();
        this.privTurnMap.delete(id);
        return turnState;
    }
}

//# sourceMappingURL=DialogServiceTurnStateManager.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DynamicGrammarBuilder.js":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DynamicGrammarBuilder.js ***!
  \***********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DynamicGrammarBuilder": () => (/* binding */ DynamicGrammarBuilder)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Responsible for building the object to be sent to the speech service to support dynamic grammars.
 * @class DynamicGrammarBuilder
 */
class DynamicGrammarBuilder {
    // Adds one more reference phrases to the dynamic grammar to send.
    // All added phrases are generic phrases.
    addPhrase(phrase) {
        if (!this.privPhrases) {
            this.privPhrases = [];
        }
        if (phrase instanceof Array) {
            this.privPhrases = this.privPhrases.concat(phrase);
        }
        else {
            this.privPhrases.push(phrase);
        }
    }
    // Clears all phrases stored in the current object.
    clearPhrases() {
        this.privPhrases = undefined;
    }
    // Adds one or more reference grammars to the current grammar.
    addReferenceGrammar(grammar) {
        if (!this.privGrammars) {
            this.privGrammars = [];
        }
        if (grammar instanceof Array) {
            this.privGrammars = this.privGrammars.concat(grammar);
        }
        else {
            this.privGrammars.push(grammar);
        }
    }
    // clears all grammars stored on the recognizer.
    clearGrammars() {
        this.privGrammars = undefined;
    }
    // Generates an object that represents the dynamic grammar used by the Speech Service.
    // This is done by building an object with the correct layout based on the phrases and reference grammars added to this instance
    // of a DynamicGrammarBuilder
    generateGrammarObject() {
        if (this.privGrammars === undefined && this.privPhrases === undefined) {
            return undefined;
        }
        const retObj = {};
        retObj.ReferenceGrammars = this.privGrammars;
        if (undefined !== this.privPhrases && 0 !== this.privPhrases.length) {
            const retPhrases = [];
            this.privPhrases.forEach((value) => {
                retPhrases.push({
                    Text: value,
                });
            });
            retObj.Groups = [{ Type: "Generic", Items: retPhrases }];
        }
        return retObj;
    }
}

//# sourceMappingURL=DynamicGrammarBuilder.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DynamicGrammarInterfaces.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DynamicGrammarInterfaces.js ***!
  \**************************************************************************************************************************/
/***/ (() => {

// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

//# sourceMappingURL=DynamicGrammarInterfaces.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/EnumTranslation.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/EnumTranslation.js ***!
  \*****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "EnumTranslation": () => (/* binding */ EnumTranslation)
/* harmony export */ });
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


class EnumTranslation {
    static implTranslateRecognitionResult(recognitionStatus) {
        let reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.ResultReason.Canceled;
        switch (recognitionStatus) {
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.Success:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.ResultReason.RecognizedSpeech;
                break;
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.NoMatch:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.InitialSilenceTimeout:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.BabbleTimeout:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.EndOfDictation:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.ResultReason.NoMatch;
                break;
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.Error:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.BadRequest:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.Forbidden:
            default:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.ResultReason.Canceled;
                break;
        }
        return reason;
    }
    static implTranslateCancelResult(recognitionStatus) {
        let reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationReason.EndOfStream;
        switch (recognitionStatus) {
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.Success:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.EndOfDictation:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.NoMatch:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationReason.EndOfStream;
                break;
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.InitialSilenceTimeout:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.BabbleTimeout:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.Error:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.BadRequest:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.Forbidden:
            default:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationReason.Error;
                break;
        }
        return reason;
    }
    static implTranslateCancelErrorCode(recognitionStatus) {
        let reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.NoError;
        switch (recognitionStatus) {
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.Error:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.ServiceError;
                break;
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.TooManyRequests:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.TooManyRequests;
                break;
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.BadRequest:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.BadRequestParameters;
                break;
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.Forbidden:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.Forbidden;
                break;
            default:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.NoError;
                break;
        }
        return reason;
    }
    static implTranslateErrorDetails(cancellationErrorCode) {
        let errorDetails = "The speech service encountered an internal error and could not continue.";
        switch (cancellationErrorCode) {
            case _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.Forbidden:
                errorDetails = "The recognizer is using a free subscription that ran out of quota.";
                break;
            case _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.BadRequestParameters:
                errorDetails = "Invalid parameter or unsupported audio format in the request.";
                break;
            case _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.TooManyRequests:
                errorDetails = "The number of parallel requests exceeded the number of allowed concurrent transcriptions.";
                break;
            default:
                break;
        }
        return errorDetails;
    }
}

//# sourceMappingURL=EnumTranslation.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AddedLmIntent": () => (/* reexport safe */ _AddedLmIntent__WEBPACK_IMPORTED_MODULE_30__.AddedLmIntent),
/* harmony export */   "AgentConfig": () => (/* reexport safe */ _AgentConfig__WEBPACK_IMPORTED_MODULE_39__.AgentConfig),
/* harmony export */   "AuthInfo": () => (/* reexport safe */ _IAuthentication__WEBPACK_IMPORTED_MODULE_2__.AuthInfo),
/* harmony export */   "AutoDetectSourceLanguagesOpenRangeOptionName": () => (/* binding */ AutoDetectSourceLanguagesOpenRangeOptionName),
/* harmony export */   "CancellationErrorCodePropertyName": () => (/* binding */ CancellationErrorCodePropertyName),
/* harmony export */   "CognitiveSubscriptionKeyAuthentication": () => (/* reexport safe */ _CognitiveSubscriptionKeyAuthentication__WEBPACK_IMPORTED_MODULE_0__.CognitiveSubscriptionKeyAuthentication),
/* harmony export */   "CognitiveTokenAuthentication": () => (/* reexport safe */ _CognitiveTokenAuthentication__WEBPACK_IMPORTED_MODULE_1__.CognitiveTokenAuthentication),
/* harmony export */   "ConnectingToServiceEvent": () => (/* reexport safe */ _RecognitionEvents__WEBPACK_IMPORTED_MODULE_7__.ConnectingToServiceEvent),
/* harmony export */   "Context": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.Context),
/* harmony export */   "ConversationConnectionConfig": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.ConversationConnectionConfig),
/* harmony export */   "ConversationManager": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.ConversationManager),
/* harmony export */   "ConversationReceivedTranslationEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.ConversationReceivedTranslationEventArgs),
/* harmony export */   "ConversationRecognizerFactory": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.ConversationRecognizerFactory),
/* harmony export */   "ConversationServiceRecognizer": () => (/* reexport safe */ _ConversationServiceRecognizer__WEBPACK_IMPORTED_MODULE_9__.ConversationServiceRecognizer),
/* harmony export */   "ConversationTranslatorCommandTypes": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.ConversationTranslatorCommandTypes),
/* harmony export */   "ConversationTranslatorMessageTypes": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.ConversationTranslatorMessageTypes),
/* harmony export */   "DetailedSpeechPhrase": () => (/* reexport safe */ _ServiceMessages_DetailedSpeechPhrase__WEBPACK_IMPORTED_MODULE_28__.DetailedSpeechPhrase),
/* harmony export */   "Device": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.Device),
/* harmony export */   "DialogServiceAdapter": () => (/* reexport safe */ _DialogServiceAdapter__WEBPACK_IMPORTED_MODULE_38__.DialogServiceAdapter),
/* harmony export */   "DynamicGrammarBuilder": () => (/* reexport safe */ _DynamicGrammarBuilder__WEBPACK_IMPORTED_MODULE_36__.DynamicGrammarBuilder),
/* harmony export */   "EnumTranslation": () => (/* reexport safe */ _EnumTranslation__WEBPACK_IMPORTED_MODULE_17__.EnumTranslation),
/* harmony export */   "ForceDictationPropertyName": () => (/* binding */ ForceDictationPropertyName),
/* harmony export */   "IntentConnectionFactory": () => (/* reexport safe */ _IntentConnectionFactory__WEBPACK_IMPORTED_MODULE_5__.IntentConnectionFactory),
/* harmony export */   "IntentResponse": () => (/* reexport safe */ _ServiceMessages_IntentResponse__WEBPACK_IMPORTED_MODULE_32__.IntentResponse),
/* harmony export */   "IntentServiceRecognizer": () => (/* reexport safe */ _IntentServiceRecognizer__WEBPACK_IMPORTED_MODULE_31__.IntentServiceRecognizer),
/* harmony export */   "InternalParticipants": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.InternalParticipants),
/* harmony export */   "ListeningStartedEvent": () => (/* reexport safe */ _RecognitionEvents__WEBPACK_IMPORTED_MODULE_7__.ListeningStartedEvent),
/* harmony export */   "LockRoomEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.LockRoomEventArgs),
/* harmony export */   "MetadataType": () => (/* reexport safe */ _ServiceMessages_SynthesisAudioMetadata__WEBPACK_IMPORTED_MODULE_41__.MetadataType),
/* harmony export */   "MuteAllEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.MuteAllEventArgs),
/* harmony export */   "OS": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.OS),
/* harmony export */   "OutputFormatPropertyName": () => (/* binding */ OutputFormatPropertyName),
/* harmony export */   "ParticipantAttributeEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.ParticipantAttributeEventArgs),
/* harmony export */   "ParticipantEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.ParticipantEventArgs),
/* harmony export */   "ParticipantsListEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.ParticipantsListEventArgs),
/* harmony export */   "RecognitionCompletionStatus": () => (/* reexport safe */ _RecognitionEvents__WEBPACK_IMPORTED_MODULE_7__.RecognitionCompletionStatus),
/* harmony export */   "RecognitionEndedEvent": () => (/* reexport safe */ _RecognitionEvents__WEBPACK_IMPORTED_MODULE_7__.RecognitionEndedEvent),
/* harmony export */   "RecognitionMode": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.RecognitionMode),
/* harmony export */   "RecognitionStartedEvent": () => (/* reexport safe */ _RecognitionEvents__WEBPACK_IMPORTED_MODULE_7__.RecognitionStartedEvent),
/* harmony export */   "RecognitionStatus": () => (/* reexport safe */ _ServiceMessages_Enums__WEBPACK_IMPORTED_MODULE_18__.RecognitionStatus),
/* harmony export */   "RecognitionTriggeredEvent": () => (/* reexport safe */ _RecognitionEvents__WEBPACK_IMPORTED_MODULE_7__.RecognitionTriggeredEvent),
/* harmony export */   "RecognizerConfig": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.RecognizerConfig),
/* harmony export */   "RequestSession": () => (/* reexport safe */ _RequestSession__WEBPACK_IMPORTED_MODULE_34__.RequestSession),
/* harmony export */   "ServicePropertiesPropertyName": () => (/* binding */ ServicePropertiesPropertyName),
/* harmony export */   "ServiceRecognizerBase": () => (/* reexport safe */ _ServiceRecognizerBase__WEBPACK_IMPORTED_MODULE_8__.ServiceRecognizerBase),
/* harmony export */   "SimpleSpeechPhrase": () => (/* reexport safe */ _ServiceMessages_SimpleSpeechPhrase__WEBPACK_IMPORTED_MODULE_29__.SimpleSpeechPhrase),
/* harmony export */   "SpeakerRecognitionConfig": () => (/* reexport safe */ _SpeakerRecognitionConfig__WEBPACK_IMPORTED_MODULE_47__.SpeakerRecognitionConfig),
/* harmony export */   "SpeakerRecognitionConnectionFactory": () => (/* reexport safe */ _SpeakerRecognitionConnectionFactory__WEBPACK_IMPORTED_MODULE_6__.SpeakerRecognitionConnectionFactory),
/* harmony export */   "SpeakerServiceRecognizer": () => (/* reexport safe */ _SpeakerServiceRecognizer__WEBPACK_IMPORTED_MODULE_48__.SpeakerServiceRecognizer),
/* harmony export */   "SpeechConnectionFactory": () => (/* reexport safe */ _SpeechConnectionFactory__WEBPACK_IMPORTED_MODULE_13__.SpeechConnectionFactory),
/* harmony export */   "SpeechContext": () => (/* reexport safe */ _SpeechContext__WEBPACK_IMPORTED_MODULE_35__.SpeechContext),
/* harmony export */   "SpeechDetected": () => (/* reexport safe */ _ServiceMessages_SpeechDetected__WEBPACK_IMPORTED_MODULE_23__.SpeechDetected),
/* harmony export */   "SpeechHypothesis": () => (/* reexport safe */ _ServiceMessages_SpeechHypothesis__WEBPACK_IMPORTED_MODULE_24__.SpeechHypothesis),
/* harmony export */   "SpeechKeyword": () => (/* reexport safe */ _ServiceMessages_SpeechKeyword__WEBPACK_IMPORTED_MODULE_25__.SpeechKeyword),
/* harmony export */   "SpeechRecognitionEvent": () => (/* reexport safe */ _RecognitionEvents__WEBPACK_IMPORTED_MODULE_7__.SpeechRecognitionEvent),
/* harmony export */   "SpeechResultFormat": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.SpeechResultFormat),
/* harmony export */   "SpeechServiceConfig": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.SpeechServiceConfig),
/* harmony export */   "SpeechServiceRecognizer": () => (/* reexport safe */ _SpeechServiceRecognizer__WEBPACK_IMPORTED_MODULE_26__.SpeechServiceRecognizer),
/* harmony export */   "SpeechSynthesisConnectionFactory": () => (/* reexport safe */ _SpeechSynthesisConnectionFactory__WEBPACK_IMPORTED_MODULE_16__.SpeechSynthesisConnectionFactory),
/* harmony export */   "SynthesisAdapterBase": () => (/* reexport safe */ _SynthesisAdapterBase__WEBPACK_IMPORTED_MODULE_43__.SynthesisAdapterBase),
/* harmony export */   "SynthesisAudioMetadata": () => (/* reexport safe */ _ServiceMessages_SynthesisAudioMetadata__WEBPACK_IMPORTED_MODULE_41__.SynthesisAudioMetadata),
/* harmony export */   "SynthesisContext": () => (/* reexport safe */ _SynthesisContext__WEBPACK_IMPORTED_MODULE_46__.SynthesisContext),
/* harmony export */   "SynthesisRestAdapter": () => (/* reexport safe */ _SynthesisRestAdapter__WEBPACK_IMPORTED_MODULE_44__.SynthesisRestAdapter),
/* harmony export */   "SynthesisServiceType": () => (/* reexport safe */ _SynthesizerConfig__WEBPACK_IMPORTED_MODULE_45__.SynthesisServiceType),
/* harmony export */   "SynthesisStatus": () => (/* reexport safe */ _ServiceMessages_Enums__WEBPACK_IMPORTED_MODULE_18__.SynthesisStatus),
/* harmony export */   "SynthesisTurn": () => (/* reexport safe */ _SynthesisTurn__WEBPACK_IMPORTED_MODULE_42__.SynthesisTurn),
/* harmony export */   "SynthesizerConfig": () => (/* reexport safe */ _SynthesizerConfig__WEBPACK_IMPORTED_MODULE_45__.SynthesizerConfig),
/* harmony export */   "System": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.System),
/* harmony export */   "TranscriberConnectionFactory": () => (/* reexport safe */ _TranscriberConnectionFactory__WEBPACK_IMPORTED_MODULE_14__.TranscriberConnectionFactory),
/* harmony export */   "TranscriberRecognizer": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.TranscriberRecognizer),
/* harmony export */   "TranscriptionServiceRecognizer": () => (/* reexport safe */ _TranscriptionServiceRecognizer__WEBPACK_IMPORTED_MODULE_27__.TranscriptionServiceRecognizer),
/* harmony export */   "TranslationConnectionFactory": () => (/* reexport safe */ _TranslationConnectionFactory__WEBPACK_IMPORTED_MODULE_15__.TranslationConnectionFactory),
/* harmony export */   "TranslationHypothesis": () => (/* reexport safe */ _ServiceMessages_TranslationHypothesis__WEBPACK_IMPORTED_MODULE_20__.TranslationHypothesis),
/* harmony export */   "TranslationPhrase": () => (/* reexport safe */ _ServiceMessages_TranslationPhrase__WEBPACK_IMPORTED_MODULE_21__.TranslationPhrase),
/* harmony export */   "TranslationServiceRecognizer": () => (/* reexport safe */ _TranslationServiceRecognizer__WEBPACK_IMPORTED_MODULE_22__.TranslationServiceRecognizer),
/* harmony export */   "TranslationSynthesisEnd": () => (/* reexport safe */ _ServiceMessages_TranslationSynthesisEnd__WEBPACK_IMPORTED_MODULE_19__.TranslationSynthesisEnd),
/* harmony export */   "VoiceProfileConnectionFactory": () => (/* reexport safe */ _SpeakerRecognitionConnectionFactory__WEBPACK_IMPORTED_MODULE_6__.VoiceProfileConnectionFactory),
/* harmony export */   "VoiceServiceRecognizer": () => (/* reexport safe */ _VoiceServiceRecognizer__WEBPACK_IMPORTED_MODULE_49__.VoiceServiceRecognizer),
/* harmony export */   "WebsocketMessageFormatter": () => (/* reexport safe */ _WebsocketMessageFormatter__WEBPACK_IMPORTED_MODULE_12__.WebsocketMessageFormatter),
/* harmony export */   "connectivity": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.connectivity),
/* harmony export */   "type": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.type)
/* harmony export */ });
/* harmony import */ var _CognitiveSubscriptionKeyAuthentication__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CognitiveSubscriptionKeyAuthentication */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveSubscriptionKeyAuthentication.js");
/* harmony import */ var _CognitiveTokenAuthentication__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CognitiveTokenAuthentication */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveTokenAuthentication.js");
/* harmony import */ var _IAuthentication__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./IAuthentication */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IAuthentication.js");
/* harmony import */ var _IConnectionFactory__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./IConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IConnectionFactory.js");
/* harmony import */ var _IConnectionFactory__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_IConnectionFactory__WEBPACK_IMPORTED_MODULE_3__);
/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};
/* harmony reexport (unknown) */ for(const __WEBPACK_IMPORT_KEY__ in _IConnectionFactory__WEBPACK_IMPORTED_MODULE_3__) if(["default","OutputFormatPropertyName","CancellationErrorCodePropertyName","ServicePropertiesPropertyName","ForceDictationPropertyName","AutoDetectSourceLanguagesOpenRangeOptionName","CognitiveSubscriptionKeyAuthentication","CognitiveTokenAuthentication","AuthInfo"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = () => _IConnectionFactory__WEBPACK_IMPORTED_MODULE_3__[__WEBPACK_IMPORT_KEY__]
/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);
/* harmony import */ var _ISynthesisConnectionFactory__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ISynthesisConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ISynthesisConnectionFactory.js");
/* harmony import */ var _ISynthesisConnectionFactory__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_ISynthesisConnectionFactory__WEBPACK_IMPORTED_MODULE_4__);
/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};
/* harmony reexport (unknown) */ for(const __WEBPACK_IMPORT_KEY__ in _ISynthesisConnectionFactory__WEBPACK_IMPORTED_MODULE_4__) if(["default","OutputFormatPropertyName","CancellationErrorCodePropertyName","ServicePropertiesPropertyName","ForceDictationPropertyName","AutoDetectSourceLanguagesOpenRangeOptionName","CognitiveSubscriptionKeyAuthentication","CognitiveTokenAuthentication","AuthInfo"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = () => _ISynthesisConnectionFactory__WEBPACK_IMPORTED_MODULE_4__[__WEBPACK_IMPORT_KEY__]
/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);
/* harmony import */ var _IntentConnectionFactory__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./IntentConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IntentConnectionFactory.js");
/* harmony import */ var _SpeakerRecognitionConnectionFactory__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./SpeakerRecognitionConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerRecognitionConnectionFactory.js");
/* harmony import */ var _RecognitionEvents__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./RecognitionEvents */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognitionEvents.js");
/* harmony import */ var _ServiceRecognizerBase__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./ServiceRecognizerBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _ConversationServiceRecognizer__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ConversationServiceRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConversationServiceRecognizer.js");
/* harmony import */ var _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./RecognizerConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _SpeechServiceInterfaces__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./SpeechServiceInterfaces */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechServiceInterfaces.js");
/* harmony import */ var _SpeechServiceInterfaces__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(_SpeechServiceInterfaces__WEBPACK_IMPORTED_MODULE_11__);
/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};
/* harmony reexport (unknown) */ for(const __WEBPACK_IMPORT_KEY__ in _SpeechServiceInterfaces__WEBPACK_IMPORTED_MODULE_11__) if(["default","OutputFormatPropertyName","CancellationErrorCodePropertyName","ServicePropertiesPropertyName","ForceDictationPropertyName","AutoDetectSourceLanguagesOpenRangeOptionName","CognitiveSubscriptionKeyAuthentication","CognitiveTokenAuthentication","AuthInfo","IntentConnectionFactory","SpeakerRecognitionConnectionFactory","VoiceProfileConnectionFactory","ConnectingToServiceEvent","ListeningStartedEvent","RecognitionCompletionStatus","RecognitionEndedEvent","RecognitionStartedEvent","RecognitionTriggeredEvent","SpeechRecognitionEvent","ServiceRecognizerBase","ConversationServiceRecognizer","Context","Device","OS","RecognitionMode","RecognizerConfig","SpeechResultFormat","SpeechServiceConfig","System","connectivity","type"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = () => _SpeechServiceInterfaces__WEBPACK_IMPORTED_MODULE_11__[__WEBPACK_IMPORT_KEY__]
/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);
/* harmony import */ var _WebsocketMessageFormatter__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./WebsocketMessageFormatter */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js");
/* harmony import */ var _SpeechConnectionFactory__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./SpeechConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionFactory.js");
/* harmony import */ var _TranscriberConnectionFactory__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./TranscriberConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranscriberConnectionFactory.js");
/* harmony import */ var _TranslationConnectionFactory__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./TranslationConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationConnectionFactory.js");
/* harmony import */ var _SpeechSynthesisConnectionFactory__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./SpeechSynthesisConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechSynthesisConnectionFactory.js");
/* harmony import */ var _EnumTranslation__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./EnumTranslation */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/EnumTranslation.js");
/* harmony import */ var _ServiceMessages_Enums__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./ServiceMessages/Enums */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
/* harmony import */ var _ServiceMessages_TranslationSynthesisEnd__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./ServiceMessages/TranslationSynthesisEnd */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationSynthesisEnd.js");
/* harmony import */ var _ServiceMessages_TranslationHypothesis__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./ServiceMessages/TranslationHypothesis */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationHypothesis.js");
/* harmony import */ var _ServiceMessages_TranslationPhrase__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./ServiceMessages/TranslationPhrase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationPhrase.js");
/* harmony import */ var _TranslationServiceRecognizer__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./TranslationServiceRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationServiceRecognizer.js");
/* harmony import */ var _ServiceMessages_SpeechDetected__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./ServiceMessages/SpeechDetected */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechDetected.js");
/* harmony import */ var _ServiceMessages_SpeechHypothesis__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./ServiceMessages/SpeechHypothesis */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechHypothesis.js");
/* harmony import */ var _ServiceMessages_SpeechKeyword__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./ServiceMessages/SpeechKeyword */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechKeyword.js");
/* harmony import */ var _SpeechServiceRecognizer__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./SpeechServiceRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechServiceRecognizer.js");
/* harmony import */ var _TranscriptionServiceRecognizer__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./TranscriptionServiceRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranscriptionServiceRecognizer.js");
/* harmony import */ var _ServiceMessages_DetailedSpeechPhrase__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./ServiceMessages/DetailedSpeechPhrase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/DetailedSpeechPhrase.js");
/* harmony import */ var _ServiceMessages_SimpleSpeechPhrase__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./ServiceMessages/SimpleSpeechPhrase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SimpleSpeechPhrase.js");
/* harmony import */ var _AddedLmIntent__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./AddedLmIntent */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/AddedLmIntent.js");
/* harmony import */ var _IntentServiceRecognizer__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./IntentServiceRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IntentServiceRecognizer.js");
/* harmony import */ var _ServiceMessages_IntentResponse__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./ServiceMessages/IntentResponse */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/IntentResponse.js");
/* harmony import */ var _ServiceMessages_SpeakerResponse__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./ServiceMessages/SpeakerResponse */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeakerResponse.js");
/* harmony import */ var _ServiceMessages_SpeakerResponse__WEBPACK_IMPORTED_MODULE_33___default = /*#__PURE__*/__webpack_require__.n(_ServiceMessages_SpeakerResponse__WEBPACK_IMPORTED_MODULE_33__);
/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};
/* harmony reexport (unknown) */ for(const __WEBPACK_IMPORT_KEY__ in _ServiceMessages_SpeakerResponse__WEBPACK_IMPORTED_MODULE_33__) if(["default","OutputFormatPropertyName","CancellationErrorCodePropertyName","ServicePropertiesPropertyName","ForceDictationPropertyName","AutoDetectSourceLanguagesOpenRangeOptionName","CognitiveSubscriptionKeyAuthentication","CognitiveTokenAuthentication","AuthInfo","IntentConnectionFactory","SpeakerRecognitionConnectionFactory","VoiceProfileConnectionFactory","ConnectingToServiceEvent","ListeningStartedEvent","RecognitionCompletionStatus","RecognitionEndedEvent","RecognitionStartedEvent","RecognitionTriggeredEvent","SpeechRecognitionEvent","ServiceRecognizerBase","ConversationServiceRecognizer","Context","Device","OS","RecognitionMode","RecognizerConfig","SpeechResultFormat","SpeechServiceConfig","System","connectivity","type","WebsocketMessageFormatter","SpeechConnectionFactory","TranscriberConnectionFactory","TranslationConnectionFactory","SpeechSynthesisConnectionFactory","EnumTranslation","RecognitionStatus","SynthesisStatus","TranslationSynthesisEnd","TranslationHypothesis","TranslationPhrase","TranslationServiceRecognizer","SpeechDetected","SpeechHypothesis","SpeechKeyword","SpeechServiceRecognizer","TranscriptionServiceRecognizer","DetailedSpeechPhrase","SimpleSpeechPhrase","AddedLmIntent","IntentServiceRecognizer","IntentResponse"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = () => _ServiceMessages_SpeakerResponse__WEBPACK_IMPORTED_MODULE_33__[__WEBPACK_IMPORT_KEY__]
/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);
/* harmony import */ var _RequestSession__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./RequestSession */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RequestSession.js");
/* harmony import */ var _SpeechContext__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./SpeechContext */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechContext.js");
/* harmony import */ var _DynamicGrammarBuilder__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ./DynamicGrammarBuilder */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DynamicGrammarBuilder.js");
/* harmony import */ var _DynamicGrammarInterfaces__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ./DynamicGrammarInterfaces */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DynamicGrammarInterfaces.js");
/* harmony import */ var _DynamicGrammarInterfaces__WEBPACK_IMPORTED_MODULE_37___default = /*#__PURE__*/__webpack_require__.n(_DynamicGrammarInterfaces__WEBPACK_IMPORTED_MODULE_37__);
/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};
/* harmony reexport (unknown) */ for(const __WEBPACK_IMPORT_KEY__ in _DynamicGrammarInterfaces__WEBPACK_IMPORTED_MODULE_37__) if(["default","OutputFormatPropertyName","CancellationErrorCodePropertyName","ServicePropertiesPropertyName","ForceDictationPropertyName","AutoDetectSourceLanguagesOpenRangeOptionName","CognitiveSubscriptionKeyAuthentication","CognitiveTokenAuthentication","AuthInfo","IntentConnectionFactory","SpeakerRecognitionConnectionFactory","VoiceProfileConnectionFactory","ConnectingToServiceEvent","ListeningStartedEvent","RecognitionCompletionStatus","RecognitionEndedEvent","RecognitionStartedEvent","RecognitionTriggeredEvent","SpeechRecognitionEvent","ServiceRecognizerBase","ConversationServiceRecognizer","Context","Device","OS","RecognitionMode","RecognizerConfig","SpeechResultFormat","SpeechServiceConfig","System","connectivity","type","WebsocketMessageFormatter","SpeechConnectionFactory","TranscriberConnectionFactory","TranslationConnectionFactory","SpeechSynthesisConnectionFactory","EnumTranslation","RecognitionStatus","SynthesisStatus","TranslationSynthesisEnd","TranslationHypothesis","TranslationPhrase","TranslationServiceRecognizer","SpeechDetected","SpeechHypothesis","SpeechKeyword","SpeechServiceRecognizer","TranscriptionServiceRecognizer","DetailedSpeechPhrase","SimpleSpeechPhrase","AddedLmIntent","IntentServiceRecognizer","IntentResponse","RequestSession","SpeechContext","DynamicGrammarBuilder"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = () => _DynamicGrammarInterfaces__WEBPACK_IMPORTED_MODULE_37__[__WEBPACK_IMPORT_KEY__]
/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);
/* harmony import */ var _DialogServiceAdapter__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ./DialogServiceAdapter */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceAdapter.js");
/* harmony import */ var _AgentConfig__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ./AgentConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/AgentConfig.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/Exports.js");
/* harmony import */ var _ServiceMessages_SynthesisAudioMetadata__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! ./ServiceMessages/SynthesisAudioMetadata */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SynthesisAudioMetadata.js");
/* harmony import */ var _SynthesisTurn__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! ./SynthesisTurn */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisTurn.js");
/* harmony import */ var _SynthesisAdapterBase__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! ./SynthesisAdapterBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisAdapterBase.js");
/* harmony import */ var _SynthesisRestAdapter__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! ./SynthesisRestAdapter */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisRestAdapter.js");
/* harmony import */ var _SynthesizerConfig__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(/*! ./SynthesizerConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesizerConfig.js");
/* harmony import */ var _SynthesisContext__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(/*! ./SynthesisContext */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisContext.js");
/* harmony import */ var _SpeakerRecognitionConfig__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(/*! ./SpeakerRecognitionConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerRecognitionConfig.js");
/* harmony import */ var _SpeakerServiceRecognizer__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(/*! ./SpeakerServiceRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerServiceRecognizer.js");
/* harmony import */ var _VoiceServiceRecognizer__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(/*! ./VoiceServiceRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/VoiceServiceRecognizer.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Make sure not to export internal modules.
//


















































const OutputFormatPropertyName = "OutputFormat";
const CancellationErrorCodePropertyName = "CancellationErrorCode";
const ServicePropertiesPropertyName = "ServiceProperties";
const ForceDictationPropertyName = "ForceDictation";
const AutoDetectSourceLanguagesOpenRangeOptionName = "OpenRange";

//# sourceMappingURL=Exports.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js ***!
  \*************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "HeaderNames": () => (/* binding */ HeaderNames)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class HeaderNames {
}
HeaderNames.AuthKey = "Ocp-Apim-Subscription-Key";
HeaderNames.Authorization = "Authorization";
HeaderNames.SpIDAuthKey = "Apim-Subscription-Id";
HeaderNames.ConnectionId = "X-ConnectionId";
HeaderNames.ContentType = "Content-Type";
HeaderNames.CustomCommandsAppId = "X-CommandsAppId";
HeaderNames.Path = "Path";
HeaderNames.RequestId = "X-RequestId";
HeaderNames.RequestStreamId = "X-StreamId";
HeaderNames.RequestTimestamp = "X-Timestamp";

//# sourceMappingURL=HeaderNames.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IAuthentication.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IAuthentication.js ***!
  \*****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AuthInfo": () => (/* binding */ AuthInfo)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class AuthInfo {
    constructor(headerName, token) {
        this.privHeaderName = headerName;
        this.privToken = token;
    }
    get headerName() {
        return this.privHeaderName;
    }
    get token() {
        return this.privToken;
    }
}

//# sourceMappingURL=IAuthentication.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IConnectionFactory.js":
/*!********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IConnectionFactory.js ***!
  \********************************************************************************************************************/
/***/ (() => {

// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

//# sourceMappingURL=IConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ISynthesisConnectionFactory.js":
/*!*****************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ISynthesisConnectionFactory.js ***!
  \*****************************************************************************************************************************/
/***/ (() => {

// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

//# sourceMappingURL=ISynthesisConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IntentConnectionFactory.js":
/*!*************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IntentConnectionFactory.js ***!
  \*************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IntentConnectionFactory": () => (/* binding */ IntentConnectionFactory)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.





class IntentConnectionFactory extends _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase {
    create(config, authInfo, connectionId) {
        let endpoint = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Endpoint);
        if (!endpoint) {
            const region = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_IntentRegion);
            const hostSuffix = _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase.getHostSuffix(region);
            const host = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Host, "wss://" + region + ".sr.speech" + hostSuffix);
            endpoint = host + "/speech/recognition/interactive/cognitiveservices/v1";
        }
        const queryParams = {
            format: "simple",
            language: config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_RecoLanguage),
        };
        this.setCommonUrlParams(config, queryParams, endpoint);
        const headers = {};
        if (authInfo.token !== undefined && authInfo.token !== "") {
            headers[authInfo.headerName] = authInfo.token;
        }
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.ConnectionId] = connectionId;
        config.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Url, endpoint);
        const enableCompression = config.parameters.getProperty("SPEECH-EnableWebsocketCompression", "false") === "true";
        return new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_3__.WebsocketConnection(endpoint, queryParams, headers, new _Exports__WEBPACK_IMPORTED_MODULE_4__.WebsocketMessageFormatter(), _common_browser_Exports__WEBPACK_IMPORTED_MODULE_5__.ProxyInfo.fromRecognizerConfig(config), enableCompression, connectionId);
    }
    getSpeechRegionFromIntentRegion(intentRegion) {
        switch (intentRegion) {
            case "West US":
            case "US West":
            case "westus":
                return "uswest";
            case "West US 2":
            case "US West 2":
            case "westus2":
                return "uswest2";
            case "South Central US":
            case "US South Central":
            case "southcentralus":
                return "ussouthcentral";
            case "West Central US":
            case "US West Central":
            case "westcentralus":
                return "uswestcentral";
            case "East US":
            case "US East":
            case "eastus":
                return "useast";
            case "East US 2":
            case "US East 2":
            case "eastus2":
                return "useast2";
            case "West Europe":
            case "Europe West":
            case "westeurope":
                return "europewest";
            case "North Europe":
            case "Europe North":
            case "northeurope":
                return "europenorth";
            case "Brazil South":
            case "South Brazil":
            case "southbrazil":
                return "brazilsouth";
            case "Australia East":
            case "East Australia":
            case "eastaustralia":
                return "australiaeast";
            case "Southeast Asia":
            case "Asia Southeast":
            case "southeastasia":
                return "asiasoutheast";
            case "East Asia":
            case "Asia East":
            case "eastasia":
                return "asiaeast";
            default:
                return intentRegion;
        }
    }
}

//# sourceMappingURL=IntentConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IntentServiceRecognizer.js":
/*!*************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IntentServiceRecognizer.js ***!
  \*************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IntentServiceRecognizer": () => (/* binding */ IntentServiceRecognizer)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionCanceledEventArgs.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechHypothesis.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SimpleSpeechPhrase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/EnumTranslation.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/IntentResponse.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



// eslint-disable-next-line max-classes-per-file
class IntentServiceRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.ServiceRecognizerBase {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, recognizer) {
        super(authentication, connectionFactory, audioSource, recognizerConfig, recognizer);
        this.privIntentRecognizer = recognizer;
        this.privIntentDataSent = false;
    }
    setIntents(addedIntents, umbrellaIntent) {
        this.privAddedLmIntents = addedIntents;
        this.privUmbrellaIntent = umbrellaIntent;
        this.privIntentDataSent = true;
    }
    processTypeSpecificMessages(connectionMessage) {
        let result;
        let ev;
        let processed = false;
        const resultProps = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyCollection();
        if (connectionMessage.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_2__.MessageType.Text) {
            resultProps.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceResponse_JsonResult, connectionMessage.textBody);
        }
        switch (connectionMessage.path.toLowerCase()) {
            case "speech.hypothesis":
                const speechHypothesis = _Exports__WEBPACK_IMPORTED_MODULE_4__.SpeechHypothesis.fromJSON(connectionMessage.textBody);
                result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.IntentRecognitionResult(undefined, this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.ResultReason.RecognizingIntent, speechHypothesis.Text, speechHypothesis.Duration, speechHypothesis.Offset + this.privRequestSession.currentTurnAudioOffset, speechHypothesis.Language, speechHypothesis.LanguageDetectionConfidence, undefined, connectionMessage.textBody, resultProps);
                this.privRequestSession.onHypothesis(result.offset);
                ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.IntentRecognitionEventArgs(result, speechHypothesis.Offset + this.privRequestSession.currentTurnAudioOffset, this.privRequestSession.sessionId);
                if (!!this.privIntentRecognizer.recognizing) {
                    try {
                        this.privIntentRecognizer.recognizing(this.privIntentRecognizer, ev);
                        /* eslint-disable no-empty */
                    }
                    catch (error) {
                        // Not going to let errors in the event handler
                        // trip things up.
                    }
                }
                processed = true;
                break;
            case "speech.phrase":
                const simple = _Exports__WEBPACK_IMPORTED_MODULE_8__.SimpleSpeechPhrase.fromJSON(connectionMessage.textBody);
                result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.IntentRecognitionResult(undefined, this.privRequestSession.requestId, _Exports__WEBPACK_IMPORTED_MODULE_9__.EnumTranslation.implTranslateRecognitionResult(simple.RecognitionStatus), simple.DisplayText, simple.Duration, simple.Offset + this.privRequestSession.currentTurnAudioOffset, simple.Language, simple.LanguageDetectionConfidence, undefined, connectionMessage.textBody, resultProps);
                ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.IntentRecognitionEventArgs(result, result.offset, this.privRequestSession.sessionId);
                const sendEvent = () => {
                    if (!!this.privIntentRecognizer.recognized) {
                        try {
                            this.privIntentRecognizer.recognized(this.privIntentRecognizer, ev);
                            /* eslint-disable no-empty */
                        }
                        catch (error) {
                            // Not going to let errors in the event handler
                            // trip things up.
                        }
                    }
                    // report result to promise.
                    if (!!this.privSuccessCallback) {
                        try {
                            this.privSuccessCallback(result);
                        }
                        catch (e) {
                            if (!!this.privErrorCallback) {
                                this.privErrorCallback(e);
                            }
                        }
                        // Only invoke the call back once.
                        // and if it's successful don't invoke the
                        // error after that.
                        this.privSuccessCallback = undefined;
                        this.privErrorCallback = undefined;
                    }
                };
                // If intent data was sent, the terminal result for this recognizer is an intent being found.
                // If no intent data was sent, the terminal event is speech recognition being successful.
                if (false === this.privIntentDataSent || _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.ResultReason.NoMatch === ev.result.reason) {
                    // Advance the buffers.
                    this.privRequestSession.onPhraseRecognized(ev.offset + ev.result.duration);
                    sendEvent();
                }
                else {
                    // Squirrel away the args, when the response event arrives it will build upon them
                    // and then return
                    this.privPendingIntentArgs = ev;
                }
                processed = true;
                break;
            case "response":
                // Response from LUIS
                ev = this.privPendingIntentArgs;
                this.privPendingIntentArgs = undefined;
                if (undefined === ev) {
                    if ("" === connectionMessage.textBody) {
                        // This condition happens if there is nothing but silence in the
                        // audio sent to the service.
                        return;
                    }
                    // Odd... Not sure this can happen
                    ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.IntentRecognitionEventArgs(new _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.IntentRecognitionResult(), 0, this.privRequestSession.sessionId);
                }
                const intentResponse = _Exports__WEBPACK_IMPORTED_MODULE_10__.IntentResponse.fromJSON(connectionMessage.textBody);
                // If LUIS didn't return anything, send the existing event, else
                // modify it to show the match.
                // See if the intent found is in the list of intents asked for.
                if (null !== intentResponse && !!intentResponse.topScoringIntent && !!intentResponse.topScoringIntent.intent) {
                    let addedIntent = this.privAddedLmIntents[intentResponse.topScoringIntent.intent];
                    if (this.privUmbrellaIntent !== undefined) {
                        addedIntent = this.privUmbrellaIntent;
                    }
                    if (!!addedIntent) {
                        const intentId = addedIntent === undefined || addedIntent.intentName === undefined ? intentResponse.topScoringIntent.intent : addedIntent.intentName;
                        let reason = ev.result.reason;
                        if (undefined !== intentId) {
                            reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.ResultReason.RecognizedIntent;
                        }
                        // make sure, properties is set.
                        const properties = (undefined !== ev.result.properties) ?
                            ev.result.properties : new _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyCollection();
                        properties.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.LanguageUnderstandingServiceResponse_JsonResult, connectionMessage.textBody);
                        ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.IntentRecognitionEventArgs(new _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.IntentRecognitionResult(intentId, ev.result.resultId, reason, ev.result.text, ev.result.duration, ev.result.offset, undefined, undefined, ev.result.errorDetails, ev.result.json, properties), ev.offset, ev.sessionId);
                    }
                }
                this.privRequestSession.onPhraseRecognized(ev.offset + ev.result.duration);
                if (!!this.privIntentRecognizer.recognized) {
                    try {
                        this.privIntentRecognizer.recognized(this.privIntentRecognizer, ev);
                        /* eslint-disable no-empty */
                    }
                    catch (error) {
                        // Not going to let errors in the event handler
                        // trip things up.
                    }
                }
                // report result to promise.
                if (!!this.privSuccessCallback) {
                    try {
                        this.privSuccessCallback(ev.result);
                    }
                    catch (e) {
                        if (!!this.privErrorCallback) {
                            this.privErrorCallback(e);
                        }
                    }
                    // Only invoke the call back once.
                    // and if it's successful don't invoke the
                    // error after that.
                    this.privSuccessCallback = undefined;
                    this.privErrorCallback = undefined;
                }
                processed = true;
                break;
            default:
                break;
        }
        const defferal = new _common_Exports__WEBPACK_IMPORTED_MODULE_11__.Deferred();
        defferal.resolve(processed);
        return defferal.promise;
    }
    // Cancels recognition.
    cancelRecognition(sessionId, requestId, cancellationReason, errorCode, error) {
        const properties = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyCollection();
        properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_12__.CancellationErrorCodePropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__.CancellationErrorCode[errorCode]);
        if (!!this.privIntentRecognizer.canceled) {
            const cancelEvent = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.IntentRecognitionCanceledEventArgs(cancellationReason, error, errorCode, undefined, undefined, sessionId);
            try {
                this.privIntentRecognizer.canceled(this.privIntentRecognizer, cancelEvent);
                /* eslint-disable no-empty */
            }
            catch (_a) { }
        }
        if (!!this.privSuccessCallback) {
            const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.IntentRecognitionResult(undefined, // Intent Id
            requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.ResultReason.Canceled, undefined, // Text
            undefined, // Duration
            undefined, // Offset
            undefined, // Language
            undefined, // LanguageDetectionConfidence
            error, undefined, // Json
            properties);
            try {
                this.privSuccessCallback(result);
                this.privSuccessCallback = undefined;
                /* eslint-disable no-empty */
            }
            catch (_b) { }
        }
    }
}

//# sourceMappingURL=IntentServiceRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/QueryParameterNames.js":
/*!*********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/QueryParameterNames.js ***!
  \*********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "QueryParameterNames": () => (/* binding */ QueryParameterNames)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class QueryParameterNames {
}
QueryParameterNames.BotId = "botid";
QueryParameterNames.CustomSpeechDeploymentId = "cid";
QueryParameterNames.CustomVoiceDeploymentId = "deploymentId";
QueryParameterNames.EnableAudioLogging = "storeAudio";
QueryParameterNames.EnableLanguageId = "lidEnabled";
QueryParameterNames.EnableWordLevelTimestamps = "wordLevelTimestamps";
QueryParameterNames.EndSilenceTimeoutMs = "endSilenceTimeoutMs";
QueryParameterNames.SegmentationSilenceTimeoutMs = "segmentationSilenceTimeoutMs";
QueryParameterNames.Format = "format";
QueryParameterNames.InitialSilenceTimeoutMs = "initialSilenceTimeoutMs";
QueryParameterNames.Language = "language";
QueryParameterNames.Profanity = "profanity";
QueryParameterNames.RequestBotStatusMessages = "enableBotMessageStatus";
QueryParameterNames.StableIntermediateThreshold = "stableIntermediateThreshold";
QueryParameterNames.StableTranslation = "stableTranslation";
QueryParameterNames.TestHooks = "testhooks";
QueryParameterNames.Postprocessing = "postprocessing";
QueryParameterNames.CtsMeetingId = "meetingId";
QueryParameterNames.CtsDeviceId = "deviceId";
QueryParameterNames.CtsIsParticipant = "isParticipant";

//# sourceMappingURL=QueryParameterNames.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognitionEvents.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognitionEvents.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectingToServiceEvent": () => (/* binding */ ConnectingToServiceEvent),
/* harmony export */   "ListeningStartedEvent": () => (/* binding */ ListeningStartedEvent),
/* harmony export */   "RecognitionCompletionStatus": () => (/* binding */ RecognitionCompletionStatus),
/* harmony export */   "RecognitionEndedEvent": () => (/* binding */ RecognitionEndedEvent),
/* harmony export */   "RecognitionStartedEvent": () => (/* binding */ RecognitionStartedEvent),
/* harmony export */   "RecognitionTriggeredEvent": () => (/* binding */ RecognitionTriggeredEvent),
/* harmony export */   "SpeechRecognitionEvent": () => (/* binding */ SpeechRecognitionEvent)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */

class SpeechRecognitionEvent extends _common_Exports__WEBPACK_IMPORTED_MODULE_0__.PlatformEvent {
    constructor(eventName, requestId, sessionId, eventType = _common_Exports__WEBPACK_IMPORTED_MODULE_0__.EventType.Info) {
        super(eventName, eventType);
        this.privRequestId = requestId;
        this.privSessionId = sessionId;
    }
    get requestId() {
        return this.privRequestId;
    }
    get sessionId() {
        return this.privSessionId;
    }
}
class RecognitionTriggeredEvent extends SpeechRecognitionEvent {
    constructor(requestId, sessionId, audioSourceId, audioNodeId) {
        super("RecognitionTriggeredEvent", requestId, sessionId);
        this.privAudioSourceId = audioSourceId;
        this.privAudioNodeId = audioNodeId;
    }
    get audioSourceId() {
        return this.privAudioSourceId;
    }
    get audioNodeId() {
        return this.privAudioNodeId;
    }
}
class ListeningStartedEvent extends SpeechRecognitionEvent {
    constructor(requestId, sessionId, audioSourceId, audioNodeId) {
        super("ListeningStartedEvent", requestId, sessionId);
        this.privAudioSourceId = audioSourceId;
        this.privAudioNodeId = audioNodeId;
    }
    get audioSourceId() {
        return this.privAudioSourceId;
    }
    get audioNodeId() {
        return this.privAudioNodeId;
    }
}
class ConnectingToServiceEvent extends SpeechRecognitionEvent {
    constructor(requestId, authFetchEventid, sessionId) {
        super("ConnectingToServiceEvent", requestId, sessionId);
        this.privAuthFetchEventid = authFetchEventid;
    }
    get authFetchEventid() {
        return this.privAuthFetchEventid;
    }
}
class RecognitionStartedEvent extends SpeechRecognitionEvent {
    constructor(requestId, audioSourceId, audioNodeId, authFetchEventId, sessionId) {
        super("RecognitionStartedEvent", requestId, sessionId);
        this.privAudioSourceId = audioSourceId;
        this.privAudioNodeId = audioNodeId;
        this.privAuthFetchEventId = authFetchEventId;
    }
    get audioSourceId() {
        return this.privAudioSourceId;
    }
    get audioNodeId() {
        return this.privAudioNodeId;
    }
    get authFetchEventId() {
        return this.privAuthFetchEventId;
    }
}
var RecognitionCompletionStatus;
(function (RecognitionCompletionStatus) {
    RecognitionCompletionStatus[RecognitionCompletionStatus["Success"] = 0] = "Success";
    RecognitionCompletionStatus[RecognitionCompletionStatus["AudioSourceError"] = 1] = "AudioSourceError";
    RecognitionCompletionStatus[RecognitionCompletionStatus["AudioSourceTimeout"] = 2] = "AudioSourceTimeout";
    RecognitionCompletionStatus[RecognitionCompletionStatus["AuthTokenFetchError"] = 3] = "AuthTokenFetchError";
    RecognitionCompletionStatus[RecognitionCompletionStatus["AuthTokenFetchTimeout"] = 4] = "AuthTokenFetchTimeout";
    RecognitionCompletionStatus[RecognitionCompletionStatus["UnAuthorized"] = 5] = "UnAuthorized";
    RecognitionCompletionStatus[RecognitionCompletionStatus["ConnectTimeout"] = 6] = "ConnectTimeout";
    RecognitionCompletionStatus[RecognitionCompletionStatus["ConnectError"] = 7] = "ConnectError";
    RecognitionCompletionStatus[RecognitionCompletionStatus["ClientRecognitionActivityTimeout"] = 8] = "ClientRecognitionActivityTimeout";
    RecognitionCompletionStatus[RecognitionCompletionStatus["UnknownError"] = 9] = "UnknownError";
})(RecognitionCompletionStatus || (RecognitionCompletionStatus = {}));
class RecognitionEndedEvent extends SpeechRecognitionEvent {
    constructor(requestId, audioSourceId, audioNodeId, authFetchEventId, sessionId, serviceTag, status, error) {
        super("RecognitionEndedEvent", requestId, sessionId, status === RecognitionCompletionStatus.Success ? _common_Exports__WEBPACK_IMPORTED_MODULE_0__.EventType.Info : _common_Exports__WEBPACK_IMPORTED_MODULE_0__.EventType.Error);
        this.privAudioSourceId = audioSourceId;
        this.privAudioNodeId = audioNodeId;
        this.privAuthFetchEventId = authFetchEventId;
        this.privStatus = status;
        this.privError = error;
        this.privServiceTag = serviceTag;
    }
    get audioSourceId() {
        return this.privAudioSourceId;
    }
    get audioNodeId() {
        return this.privAudioNodeId;
    }
    get authFetchEventId() {
        return this.privAuthFetchEventId;
    }
    get serviceTag() {
        return this.privServiceTag;
    }
    get status() {
        return this.privStatus;
    }
    get error() {
        return this.privError;
    }
}

//# sourceMappingURL=RecognitionEvents.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Context": () => (/* binding */ Context),
/* harmony export */   "Device": () => (/* binding */ Device),
/* harmony export */   "OS": () => (/* binding */ OS),
/* harmony export */   "RecognitionMode": () => (/* binding */ RecognitionMode),
/* harmony export */   "RecognizerConfig": () => (/* binding */ RecognizerConfig),
/* harmony export */   "SpeechResultFormat": () => (/* binding */ SpeechResultFormat),
/* harmony export */   "SpeechServiceConfig": () => (/* binding */ SpeechServiceConfig),
/* harmony export */   "System": () => (/* binding */ System),
/* harmony export */   "connectivity": () => (/* binding */ connectivity),
/* harmony export */   "type": () => (/* binding */ type)
/* harmony export */ });
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */

var RecognitionMode;
(function (RecognitionMode) {
    RecognitionMode[RecognitionMode["Interactive"] = 0] = "Interactive";
    RecognitionMode[RecognitionMode["Conversation"] = 1] = "Conversation";
    RecognitionMode[RecognitionMode["Dictation"] = 2] = "Dictation";
})(RecognitionMode || (RecognitionMode = {}));
var SpeechResultFormat;
(function (SpeechResultFormat) {
    SpeechResultFormat[SpeechResultFormat["Simple"] = 0] = "Simple";
    SpeechResultFormat[SpeechResultFormat["Detailed"] = 1] = "Detailed";
})(SpeechResultFormat || (SpeechResultFormat = {}));
class RecognizerConfig {
    constructor(speechServiceConfig, parameters) {
        this.privSpeechServiceConfig = speechServiceConfig ? speechServiceConfig : new SpeechServiceConfig(new Context(null));
        this.privParameters = parameters;
        this.privMaxRetryCount = parseInt(parameters.getProperty("SPEECH-Error-MaxRetryCount", "4"), 10);
        this.privLanguageIdMode = parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_LanguageIdMode, undefined);
    }
    get parameters() {
        return this.privParameters;
    }
    get recognitionMode() {
        return this.privRecognitionMode;
    }
    set recognitionMode(value) {
        this.privRecognitionMode = value;
        this.privRecognitionActivityTimeout = value === RecognitionMode.Interactive ? 8000 : 25000;
        this.privSpeechServiceConfig.Recognition = RecognitionMode[value];
    }
    get SpeechServiceConfig() {
        return this.privSpeechServiceConfig;
    }
    get recognitionActivityTimeout() {
        return this.privRecognitionActivityTimeout;
    }
    get isContinuousRecognition() {
        return this.privRecognitionMode !== RecognitionMode.Interactive;
    }
    get languageIdMode() {
        return this.privLanguageIdMode;
    }
    get autoDetectSourceLanguages() {
        return this.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages, undefined);
    }
    get recognitionEndpointVersion() {
        return this.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion, undefined);
    }
    get sourceLanguageModels() {
        const models = [];
        let modelsExist = false;
        if (this.autoDetectSourceLanguages !== undefined) {
            for (const language of this.autoDetectSourceLanguages.split(",")) {
                const customProperty = language + _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_EndpointId.toString();
                const modelId = this.parameters.getProperty(customProperty, undefined);
                if (modelId !== undefined) {
                    models.push({ language, endpoint: modelId });
                    modelsExist = true;
                }
                else {
                    models.push({ language, endpoint: "" });
                }
            }
        }
        return modelsExist ? models : undefined;
    }
    get maxRetryCount() {
        return this.privMaxRetryCount;
    }
}
// The config is serialized and sent as the Speech.Config
class SpeechServiceConfig {
    constructor(context) {
        this.context = context;
    }
    serialize() {
        return JSON.stringify(this, (key, value) => {
            if (value && typeof value === "object") {
                const replacement = {};
                for (const k in value) {
                    if (Object.hasOwnProperty.call(value, k)) {
                        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
                        replacement[k && k.charAt(0).toLowerCase() + k.substring(1)] = value[k];
                    }
                }
                return replacement;
            }
            return value;
        });
    }
    get Context() {
        return this.context;
    }
    get Recognition() {
        return this.recognition;
    }
    set Recognition(value) {
        this.recognition = value.toLowerCase();
    }
}
class Context {
    constructor(os) {
        this.system = new System();
        this.os = os;
    }
}
class System {
    constructor() {
        // Note: below will be patched for official builds.
        const SPEECHSDK_CLIENTSDK_VERSION = "1.30.1";
        this.name = "SpeechSDK";
        this.version = SPEECHSDK_CLIENTSDK_VERSION;
        this.build = "JavaScript";
        this.lang = "JavaScript";
    }
}
class OS {
    constructor(platform, name, version) {
        this.platform = platform;
        this.name = name;
        this.version = version;
    }
}
class Device {
    constructor(manufacturer, model, version) {
        this.manufacturer = manufacturer;
        this.model = model;
        this.version = version;
    }
}
var connectivity;
(function (connectivity) {
    connectivity["Bluetooth"] = "Bluetooth";
    connectivity["Wired"] = "Wired";
    connectivity["WiFi"] = "WiFi";
    connectivity["Cellular"] = "Cellular";
    connectivity["InBuilt"] = "InBuilt";
    connectivity["Unknown"] = "Unknown";
})(connectivity || (connectivity = {}));
var type;
(function (type) {
    type["Phone"] = "Phone";
    type["Speaker"] = "Speaker";
    type["Car"] = "Car";
    type["Headset"] = "Headset";
    type["Thermostat"] = "Thermostat";
    type["Microphones"] = "Microphones";
    type["Deskphone"] = "Deskphone";
    type["RemoteControl"] = "RemoteControl";
    type["Unknown"] = "Unknown";
    type["File"] = "File";
    type["Stream"] = "Stream";
})(type || (type = {}));

//# sourceMappingURL=RecognizerConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RequestSession.js":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RequestSession.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RequestSession": () => (/* binding */ RequestSession)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _RecognitionEvents__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./RecognitionEvents */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognitionEvents.js");
/* harmony import */ var _ServiceTelemetryListener_Internal__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ServiceTelemetryListener.Internal */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceTelemetryListener.Internal.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



class RequestSession {
    constructor(audioSourceId) {
        this.privIsDisposed = false;
        this.privDetachables = new Array();
        this.privIsAudioNodeDetached = false;
        this.privIsRecognizing = false;
        this.privIsSpeechEnded = false;
        this.privTurnStartAudioOffset = 0;
        this.privLastRecoOffset = 0;
        this.privHypothesisReceived = false;
        this.privBytesSent = 0;
        this.privRecogNumber = 0;
        this.privInTurn = false;
        this.privConnectionAttempts = 0;
        this.privAudioSourceId = audioSourceId;
        this.privRequestId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privAudioNodeId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privTurnDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.Deferred();
        // We're not in a turn, so resolve.
        this.privTurnDeferral.resolve();
    }
    get sessionId() {
        return this.privSessionId;
    }
    get requestId() {
        return this.privRequestId;
    }
    get audioNodeId() {
        return this.privAudioNodeId;
    }
    get turnCompletionPromise() {
        return this.privTurnDeferral.promise;
    }
    get isSpeechEnded() {
        return this.privIsSpeechEnded;
    }
    get isRecognizing() {
        return this.privIsRecognizing;
    }
    get currentTurnAudioOffset() {
        return this.privTurnStartAudioOffset;
    }
    get recogNumber() {
        return this.privRecogNumber;
    }
    get numConnectionAttempts() {
        return this.privConnectionAttempts;
    }
    // The number of bytes sent for the current connection.
    // Counter is reset to 0 each time a connection is established.
    get bytesSent() {
        return this.privBytesSent;
    }
    listenForServiceTelemetry(eventSource) {
        if (!!this.privServiceTelemetryListener) {
            this.privDetachables.push(eventSource.attachListener(this.privServiceTelemetryListener));
        }
    }
    startNewRecognition() {
        this.privIsSpeechEnded = false;
        this.privIsRecognizing = true;
        this.privTurnStartAudioOffset = 0;
        this.privLastRecoOffset = 0;
        this.privRecogNumber++;
        this.privServiceTelemetryListener = new _ServiceTelemetryListener_Internal__WEBPACK_IMPORTED_MODULE_2__.ServiceTelemetryListener(this.privRequestId, this.privAudioSourceId, this.privAudioNodeId);
        this.onEvent(new _RecognitionEvents__WEBPACK_IMPORTED_MODULE_3__.RecognitionTriggeredEvent(this.requestId, this.privSessionId, this.privAudioSourceId, this.privAudioNodeId));
    }
    onAudioSourceAttachCompleted(audioNode, isError) {
        return __awaiter(this, void 0, void 0, function* () {
            this.privAudioNode = audioNode;
            this.privIsAudioNodeDetached = false;
            if (isError) {
                yield this.onComplete();
            }
            else {
                this.onEvent(new _RecognitionEvents__WEBPACK_IMPORTED_MODULE_3__.ListeningStartedEvent(this.privRequestId, this.privSessionId, this.privAudioSourceId, this.privAudioNodeId));
            }
        });
    }
    onPreConnectionStart(authFetchEventId, connectionId) {
        this.privAuthFetchEventId = authFetchEventId;
        this.privSessionId = connectionId;
        this.onEvent(new _RecognitionEvents__WEBPACK_IMPORTED_MODULE_3__.ConnectingToServiceEvent(this.privRequestId, this.privAuthFetchEventId, this.privSessionId));
    }
    onAuthCompleted(isError) {
        return __awaiter(this, void 0, void 0, function* () {
            if (isError) {
                yield this.onComplete();
            }
        });
    }
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    onConnectionEstablishCompleted(statusCode, reason) {
        return __awaiter(this, void 0, void 0, function* () {
            if (statusCode === 200) {
                this.onEvent(new _RecognitionEvents__WEBPACK_IMPORTED_MODULE_3__.RecognitionStartedEvent(this.requestId, this.privAudioSourceId, this.privAudioNodeId, this.privAuthFetchEventId, this.privSessionId));
                if (!!this.privAudioNode) {
                    this.privAudioNode.replay();
                }
                this.privTurnStartAudioOffset = this.privLastRecoOffset;
                this.privBytesSent = 0;
                return;
            }
            else if (statusCode === 403) {
                yield this.onComplete();
            }
        });
    }
    onServiceTurnEndResponse(continuousRecognition) {
        return __awaiter(this, void 0, void 0, function* () {
            this.privTurnDeferral.resolve();
            if (!continuousRecognition || this.isSpeechEnded) {
                yield this.onComplete();
                this.privInTurn = false;
            }
            else {
                // Start a new request set.
                this.privTurnStartAudioOffset = this.privLastRecoOffset;
                this.privAudioNode.replay();
            }
        });
    }
    onSpeechContext() {
        this.privRequestId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
    }
    onServiceTurnStartResponse() {
        if (!!this.privTurnDeferral && !!this.privInTurn) {
            // What? How are we starting a turn with another not done?
            this.privTurnDeferral.reject("Another turn started before current completed.");
            // Avoid UnhandledPromiseRejection if privTurnDeferral is not being awaited
            // eslint-disable-next-line @typescript-eslint/no-empty-function
            this.privTurnDeferral.promise.then().catch(() => { });
        }
        this.privInTurn = true;
        this.privTurnDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.Deferred();
    }
    onHypothesis(offset) {
        if (!this.privHypothesisReceived) {
            this.privHypothesisReceived = true;
            this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(offset));
        }
    }
    onPhraseRecognized(offset) {
        this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(offset));
        this.onServiceRecognized(offset);
    }
    onServiceRecognized(offset) {
        this.privLastRecoOffset = offset;
        this.privHypothesisReceived = false;
        this.privAudioNode.shrinkBuffers(offset);
        this.privConnectionAttempts = 0;
    }
    onAudioSent(bytesSent) {
        this.privBytesSent += bytesSent;
    }
    onRetryConnection() {
        this.privConnectionAttempts++;
    }
    dispose() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.privIsDisposed) {
                // we should have completed by now. If we did not its an unknown error.
                this.privIsDisposed = true;
                for (const detachable of this.privDetachables) {
                    yield detachable.detach();
                }
                if (!!this.privServiceTelemetryListener) {
                    this.privServiceTelemetryListener.dispose();
                }
                this.privIsRecognizing = false;
            }
        });
    }
    getTelemetry() {
        if (this.privServiceTelemetryListener.hasTelemetry) {
            return this.privServiceTelemetryListener.getTelemetry();
        }
        else {
            return null;
        }
    }
    onStopRecognizing() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.onComplete();
        });
    }
    // Should be called with the audioNode for this session has indicated that it is out of speech.
    onSpeechEnded() {
        this.privIsSpeechEnded = true;
    }
    onEvent(event) {
        if (!!this.privServiceTelemetryListener) {
            this.privServiceTelemetryListener.onEvent(event);
        }
        _common_Exports__WEBPACK_IMPORTED_MODULE_4__.Events.instance.onEvent(event);
    }
    onComplete() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!!this.privIsRecognizing) {
                this.privIsRecognizing = false;
                yield this.detachAudioNode();
            }
        });
    }
    detachAudioNode() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.privIsAudioNodeDetached) {
                this.privIsAudioNodeDetached = true;
                if (this.privAudioNode) {
                    yield this.privAudioNode.detach();
                }
            }
        });
    }
}

//# sourceMappingURL=RequestSession.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/ActivityResponsePayload.js":
/*!*****************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/ActivityResponsePayload.js ***!
  \*****************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ActivityPayloadResponse": () => (/* binding */ ActivityPayloadResponse),
/* harmony export */   "MessageDataStreamType": () => (/* binding */ MessageDataStreamType)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// response
class ActivityPayloadResponse {
    constructor(json) {
        this.privActivityResponse = JSON.parse(json);
    }
    static fromJSON(json) {
        return new ActivityPayloadResponse(json);
    }
    get conversationId() {
        return this.privActivityResponse.conversationId;
    }
    get messageDataStreamType() {
        return this.privActivityResponse.messageDataStreamType;
    }
    get messagePayload() {
        return this.privActivityResponse.messagePayload;
    }
    get version() {
        return this.privActivityResponse.version;
    }
}
var MessageDataStreamType;
(function (MessageDataStreamType) {
    MessageDataStreamType[MessageDataStreamType["None"] = 0] = "None";
    MessageDataStreamType[MessageDataStreamType["TextToSpeechAudio"] = 1] = "TextToSpeechAudio";
})(MessageDataStreamType || (MessageDataStreamType = {}));

//# sourceMappingURL=ActivityResponsePayload.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/DetailedSpeechPhrase.js":
/*!**************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/DetailedSpeechPhrase.js ***!
  \**************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DetailedSpeechPhrase": () => (/* binding */ DetailedSpeechPhrase)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class DetailedSpeechPhrase {
    constructor(json) {
        this.privDetailedSpeechPhrase = JSON.parse(json);
        this.privDetailedSpeechPhrase.RecognitionStatus = _Exports__WEBPACK_IMPORTED_MODULE_0__.RecognitionStatus[this.privDetailedSpeechPhrase.RecognitionStatus];
    }
    static fromJSON(json) {
        return new DetailedSpeechPhrase(json);
    }
    getJsonWithCorrectedOffsets(baseOffset) {
        if (!!this.privDetailedSpeechPhrase.NBest) {
            let firstWordOffset;
            for (const phrase of this.privDetailedSpeechPhrase.NBest) {
                if (!!phrase.Words && !!phrase.Words[0]) {
                    firstWordOffset = phrase.Words[0].Offset;
                    break;
                }
            }
            if (!!firstWordOffset && firstWordOffset < baseOffset) {
                const offset = baseOffset - firstWordOffset;
                for (const details of this.privDetailedSpeechPhrase.NBest) {
                    if (!!details.Words) {
                        for (const word of details.Words) {
                            word.Offset += offset;
                        }
                    }
                    if (!!details.DisplayWords) {
                        for (const word of details.DisplayWords) {
                            word.Offset += offset;
                        }
                    }
                }
            }
        }
        return JSON.stringify(this.privDetailedSpeechPhrase);
    }
    get RecognitionStatus() {
        return this.privDetailedSpeechPhrase.RecognitionStatus;
    }
    get NBest() {
        return this.privDetailedSpeechPhrase.NBest;
    }
    get Duration() {
        return this.privDetailedSpeechPhrase.Duration;
    }
    get Offset() {
        return this.privDetailedSpeechPhrase.Offset;
    }
    get Language() {
        return this.privDetailedSpeechPhrase.PrimaryLanguage === undefined ? undefined : this.privDetailedSpeechPhrase.PrimaryLanguage.Language;
    }
    get LanguageDetectionConfidence() {
        return this.privDetailedSpeechPhrase.PrimaryLanguage === undefined ? undefined : this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence;
    }
    get Text() {
        if (!!this.privDetailedSpeechPhrase.NBest && this.privDetailedSpeechPhrase.NBest[0]) {
            return this.privDetailedSpeechPhrase.NBest[0].Display || this.privDetailedSpeechPhrase.NBest[0].DisplayText;
        }
        return this.privDetailedSpeechPhrase.DisplayText;
    }
    get SpeakerId() {
        return this.privDetailedSpeechPhrase.SpeakerId;
    }
}

//# sourceMappingURL=DetailedSpeechPhrase.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js ***!
  \***********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RecognitionStatus": () => (/* binding */ RecognitionStatus),
/* harmony export */   "SynthesisStatus": () => (/* binding */ SynthesisStatus)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * @class SynthesisStatus
 * @private
 */
var SynthesisStatus;
(function (SynthesisStatus) {
    /**
     * The response contains valid audio data.
     * @member SynthesisStatus.Success
     */
    SynthesisStatus[SynthesisStatus["Success"] = 0] = "Success";
    /**
     * Indicates the end of audio data. No valid audio data is included in the message.
     * @member SynthesisStatus.SynthesisEnd
     */
    SynthesisStatus[SynthesisStatus["SynthesisEnd"] = 1] = "SynthesisEnd";
    /**
     * Indicates an error occurred during synthesis data processing.
     * @member SynthesisStatus.Error
     */
    SynthesisStatus[SynthesisStatus["Error"] = 2] = "Error";
})(SynthesisStatus || (SynthesisStatus = {}));
var RecognitionStatus;
(function (RecognitionStatus) {
    RecognitionStatus[RecognitionStatus["Success"] = 0] = "Success";
    RecognitionStatus[RecognitionStatus["NoMatch"] = 1] = "NoMatch";
    RecognitionStatus[RecognitionStatus["InitialSilenceTimeout"] = 2] = "InitialSilenceTimeout";
    RecognitionStatus[RecognitionStatus["BabbleTimeout"] = 3] = "BabbleTimeout";
    RecognitionStatus[RecognitionStatus["Error"] = 4] = "Error";
    RecognitionStatus[RecognitionStatus["EndOfDictation"] = 5] = "EndOfDictation";
    RecognitionStatus[RecognitionStatus["TooManyRequests"] = 6] = "TooManyRequests";
    RecognitionStatus[RecognitionStatus["BadRequest"] = 7] = "BadRequest";
    RecognitionStatus[RecognitionStatus["Forbidden"] = 8] = "Forbidden";
})(RecognitionStatus || (RecognitionStatus = {}));

//# sourceMappingURL=Enums.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/IntentResponse.js":
/*!********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/IntentResponse.js ***!
  \********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IntentResponse": () => (/* binding */ IntentResponse)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// response
class IntentResponse {
    constructor(json) {
        if (json === "") {
            this.privIntentResponse = {};
        }
        else {
            this.privIntentResponse = JSON.parse(json);
        }
    }
    static fromJSON(json) {
        return new IntentResponse(json);
    }
    get query() {
        return this.privIntentResponse.query;
    }
    get topScoringIntent() {
        return this.privIntentResponse.topScoringIntent;
    }
    get entities() {
        return this.privIntentResponse.entities;
    }
}

//# sourceMappingURL=IntentResponse.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SimpleSpeechPhrase.js":
/*!************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SimpleSpeechPhrase.js ***!
  \************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SimpleSpeechPhrase": () => (/* binding */ SimpleSpeechPhrase)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class SimpleSpeechPhrase {
    constructor(json) {
        this.privSimpleSpeechPhrase = JSON.parse(json);
        this.privSimpleSpeechPhrase.RecognitionStatus = _Exports__WEBPACK_IMPORTED_MODULE_0__.RecognitionStatus[this.privSimpleSpeechPhrase.RecognitionStatus];
    }
    static fromJSON(json) {
        return new SimpleSpeechPhrase(json);
    }
    get RecognitionStatus() {
        return this.privSimpleSpeechPhrase.RecognitionStatus;
    }
    get DisplayText() {
        return this.privSimpleSpeechPhrase.DisplayText;
    }
    get Offset() {
        return this.privSimpleSpeechPhrase.Offset;
    }
    get Duration() {
        return this.privSimpleSpeechPhrase.Duration;
    }
    get Language() {
        return this.privSimpleSpeechPhrase.PrimaryLanguage === undefined ? undefined : this.privSimpleSpeechPhrase.PrimaryLanguage.Language;
    }
    get LanguageDetectionConfidence() {
        return this.privSimpleSpeechPhrase.PrimaryLanguage === undefined ? undefined : this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence;
    }
    get SpeakerId() {
        return this.privSimpleSpeechPhrase.SpeakerId;
    }
}

//# sourceMappingURL=SimpleSpeechPhrase.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeakerResponse.js":
/*!*********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeakerResponse.js ***!
  \*********************************************************************************************************************************/
/***/ (() => {

// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */

//# sourceMappingURL=SpeakerResponse.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechDetected.js":
/*!********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechDetected.js ***!
  \********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechDetected": () => (/* binding */ SpeechDetected)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class SpeechDetected {
    constructor(json) {
        this.privSpeechStartDetected = JSON.parse(json);
    }
    static fromJSON(json) {
        return new SpeechDetected(json);
    }
    get Offset() {
        return this.privSpeechStartDetected.Offset;
    }
}

//# sourceMappingURL=SpeechDetected.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechHypothesis.js":
/*!**********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechHypothesis.js ***!
  \**********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechHypothesis": () => (/* binding */ SpeechHypothesis)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class SpeechHypothesis {
    constructor(json) {
        this.privSpeechHypothesis = JSON.parse(json);
    }
    static fromJSON(json) {
        return new SpeechHypothesis(json);
    }
    get Text() {
        return this.privSpeechHypothesis.Text;
    }
    get Offset() {
        return this.privSpeechHypothesis.Offset;
    }
    get Duration() {
        return this.privSpeechHypothesis.Duration;
    }
    get Language() {
        return this.privSpeechHypothesis.PrimaryLanguage === undefined ? undefined : this.privSpeechHypothesis.PrimaryLanguage.Language;
    }
    get LanguageDetectionConfidence() {
        return this.privSpeechHypothesis.PrimaryLanguage === undefined ? undefined : this.privSpeechHypothesis.PrimaryLanguage.Confidence;
    }
    get SpeakerId() {
        return this.privSpeechHypothesis.SpeakerId;
    }
}

//# sourceMappingURL=SpeechHypothesis.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechKeyword.js":
/*!*******************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechKeyword.js ***!
  \*******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechKeyword": () => (/* binding */ SpeechKeyword)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class SpeechKeyword {
    constructor(json) {
        this.privSpeechKeyword = JSON.parse(json);
    }
    static fromJSON(json) {
        return new SpeechKeyword(json);
    }
    get Status() {
        return this.privSpeechKeyword.Status;
    }
    get Text() {
        return this.privSpeechKeyword.Text;
    }
    get Offset() {
        return this.privSpeechKeyword.Offset;
    }
    get Duration() {
        return this.privSpeechKeyword.Duration;
    }
}

//# sourceMappingURL=SpeechKeyword.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SynthesisAudioMetadata.js":
/*!****************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SynthesisAudioMetadata.js ***!
  \****************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "MetadataType": () => (/* binding */ MetadataType),
/* harmony export */   "SynthesisAudioMetadata": () => (/* binding */ SynthesisAudioMetadata)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var MetadataType;
(function (MetadataType) {
    MetadataType["WordBoundary"] = "WordBoundary";
    MetadataType["Bookmark"] = "Bookmark";
    MetadataType["Viseme"] = "Viseme";
    MetadataType["SentenceBoundary"] = "SentenceBoundary";
    MetadataType["SessionEnd"] = "SessionEnd";
})(MetadataType || (MetadataType = {}));
class SynthesisAudioMetadata {
    constructor(json) {
        this.privSynthesisAudioMetadata = JSON.parse(json);
    }
    static fromJSON(json) {
        return new SynthesisAudioMetadata(json);
    }
    get Metadata() {
        return this.privSynthesisAudioMetadata.Metadata;
    }
}

//# sourceMappingURL=SynthesisAudioMetadata.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationHypothesis.js":
/*!***************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationHypothesis.js ***!
  \***************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationHypothesis": () => (/* binding */ TranslationHypothesis)
/* harmony export */ });
/* harmony import */ var _TranslationStatus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../TranslationStatus */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationStatus.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class TranslationHypothesis {
    constructor(json) {
        this.privTranslationHypothesis = JSON.parse(json);
        this.privTranslationHypothesis.Translation.TranslationStatus = _TranslationStatus__WEBPACK_IMPORTED_MODULE_0__.TranslationStatus[this.privTranslationHypothesis.Translation.TranslationStatus];
    }
    static fromJSON(json) {
        return new TranslationHypothesis(json);
    }
    get Duration() {
        return this.privTranslationHypothesis.Duration;
    }
    get Offset() {
        return this.privTranslationHypothesis.Offset;
    }
    get Text() {
        return this.privTranslationHypothesis.Text;
    }
    get Translation() {
        return this.privTranslationHypothesis.Translation;
    }
}

//# sourceMappingURL=TranslationHypothesis.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationPhrase.js":
/*!***********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationPhrase.js ***!
  \***********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationPhrase": () => (/* binding */ TranslationPhrase)
/* harmony export */ });
/* harmony import */ var _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../sdk/Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
/* harmony import */ var _TranslationStatus__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../TranslationStatus */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationStatus.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



class TranslationPhrase {
    constructor(phrase) {
        this.privTranslationPhrase = phrase;
        this.privTranslationPhrase.RecognitionStatus = _Exports__WEBPACK_IMPORTED_MODULE_0__.RecognitionStatus[this.privTranslationPhrase.RecognitionStatus];
        if (this.privTranslationPhrase.Translation !== undefined) {
            this.privTranslationPhrase.Translation.TranslationStatus = _TranslationStatus__WEBPACK_IMPORTED_MODULE_1__.TranslationStatus[this.privTranslationPhrase.Translation.TranslationStatus];
        }
    }
    static fromJSON(json) {
        return new TranslationPhrase(JSON.parse(json));
    }
    static fromTranslationResponse(translationResponse) {
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrUndefined(translationResponse, "translationResponse");
        const phrase = translationResponse.SpeechPhrase;
        translationResponse.SpeechPhrase = undefined;
        phrase.Translation = translationResponse;
        phrase.Text = phrase.DisplayText;
        return new TranslationPhrase(phrase);
    }
    get RecognitionStatus() {
        return this.privTranslationPhrase.RecognitionStatus;
    }
    get Offset() {
        return this.privTranslationPhrase.Offset;
    }
    get Duration() {
        return this.privTranslationPhrase.Duration;
    }
    get Text() {
        return this.privTranslationPhrase.Text;
    }
    get Language() {
        var _a;
        return (_a = this.privTranslationPhrase.PrimaryLanguage) === null || _a === void 0 ? void 0 : _a.Language;
    }
    get Confidence() {
        var _a;
        return (_a = this.privTranslationPhrase.PrimaryLanguage) === null || _a === void 0 ? void 0 : _a.Confidence;
    }
    get Translation() {
        return this.privTranslationPhrase.Translation;
    }
}

//# sourceMappingURL=TranslationPhrase.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationSynthesisEnd.js":
/*!*****************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationSynthesisEnd.js ***!
  \*****************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationSynthesisEnd": () => (/* binding */ TranslationSynthesisEnd)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class TranslationSynthesisEnd {
    constructor(json) {
        this.privSynthesisEnd = JSON.parse(json);
        if (!!this.privSynthesisEnd.SynthesisStatus) {
            this.privSynthesisEnd.SynthesisStatus = _Exports__WEBPACK_IMPORTED_MODULE_0__.SynthesisStatus[this.privSynthesisEnd.SynthesisStatus];
        }
        if (!!this.privSynthesisEnd.Status) {
            this.privSynthesisEnd.SynthesisStatus = _Exports__WEBPACK_IMPORTED_MODULE_0__.SynthesisStatus[this.privSynthesisEnd.Status];
        }
    }
    static fromJSON(json) {
        return new TranslationSynthesisEnd(json);
    }
    get SynthesisStatus() {
        return this.privSynthesisEnd.SynthesisStatus;
    }
    get FailureReason() {
        return this.privSynthesisEnd.FailureReason;
    }
}

//# sourceMappingURL=TranslationSynthesisEnd.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TurnStatusPayload.js":
/*!***********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TurnStatusPayload.js ***!
  \***********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TurnStatusResponsePayload": () => (/* binding */ TurnStatusResponsePayload)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class TurnStatusResponsePayload {
    constructor(json) {
        this.privMessageStatusResponse = JSON.parse(json);
    }
    static fromJSON(json) {
        return new TurnStatusResponsePayload(json);
    }
    get interactionId() {
        return this.privMessageStatusResponse.interactionId;
    }
    get conversationId() {
        return this.privMessageStatusResponse.conversationId;
    }
    get statusCode() {
        // Payloads may contain a limited set of textual representations or a numeric status
        // code. The textual values are here converted into numeric ones.
        switch (this.privMessageStatusResponse.statusCode) {
            case "Success":
                return 200;
            case "Failed":
                return 400;
            case "TimedOut":
                return 429;
            default:
                // eslint-disable-next-line @typescript-eslint/no-unsafe-return
                return this.privMessageStatusResponse.statusCode;
        }
    }
}

//# sourceMappingURL=TurnStatusPayload.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js ***!
  \***********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ServiceRecognizerBase": () => (/* binding */ ServiceRecognizerBase)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ReplayableAudioNode.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Timeout.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionEvents.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/IConnection.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RequestSession.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DynamicGrammarBuilder.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechContext.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/AgentConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechDetected.js");
/* harmony import */ var _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./SpeechConnectionMessage.Internal */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionMessage.Internal.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





class ServiceRecognizerBase {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, recognizer) {
        // A promise for a configured connection.
        // Do not consume directly, call fetchConnection instead.
        this.privConnectionConfigurationPromise = undefined;
        // A promise for a connection, but one that has not had the speech context sent yet.
        // Do not consume directly, call fetchConnection instead.
        this.privConnectionPromise = undefined;
        this.privSetTimeout = setTimeout;
        this.privIsLiveAudio = false;
        this.recognizeOverride = undefined;
        this.recognizeSpeaker = undefined;
        this.disconnectOverride = undefined;
        this.receiveMessageOverride = undefined;
        this.sendPrePayloadJSONOverride = undefined;
        this.postConnectImplOverride = undefined;
        this.configConnectionOverride = undefined;
        this.handleSpeechPhraseMessage = undefined;
        this.handleSpeechHypothesisMessage = undefined;
        if (!authentication) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("authentication");
        }
        if (!connectionFactory) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("connectionFactory");
        }
        if (!audioSource) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("audioSource");
        }
        if (!recognizerConfig) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("recognizerConfig");
        }
        this.privMustReportEndOfStream = false;
        this.privAuthentication = authentication;
        this.privConnectionFactory = connectionFactory;
        this.privAudioSource = audioSource;
        this.privRecognizerConfig = recognizerConfig;
        this.privIsDisposed = false;
        this.privRecognizer = recognizer;
        this.privRequestSession = new _Exports__WEBPACK_IMPORTED_MODULE_1__.RequestSession(this.privAudioSource.id());
        this.privConnectionEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.EventSource();
        this.privServiceEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.EventSource();
        this.privDynamicGrammar = new _Exports__WEBPACK_IMPORTED_MODULE_3__.DynamicGrammarBuilder();
        this.privSpeechContext = new _Exports__WEBPACK_IMPORTED_MODULE_4__.SpeechContext(this.privDynamicGrammar);
        this.privAgentConfig = new _Exports__WEBPACK_IMPORTED_MODULE_5__.AgentConfig();
        if (typeof (Blob) !== "undefined" && typeof (Worker) !== "undefined") {
            this.privSetTimeout = _common_Exports__WEBPACK_IMPORTED_MODULE_6__.Timeout.setTimeout;
        }
        this.connectionEvents.attach((connectionEvent) => {
            if (connectionEvent.name === "ConnectionClosedEvent") {
                const connectionClosedEvent = connectionEvent;
                if (connectionClosedEvent.statusCode === 1003 ||
                    connectionClosedEvent.statusCode === 1007 ||
                    connectionClosedEvent.statusCode === 1002 ||
                    connectionClosedEvent.statusCode === 4000 ||
                    this.privRequestSession.numConnectionAttempts > this.privRecognizerConfig.maxRetryCount) {
                    void this.cancelRecognitionLocal(_sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationReason.Error, connectionClosedEvent.statusCode === 1007 ? _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCode.BadRequestParameters : _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCode.ConnectionFailure, `${connectionClosedEvent.reason} websocket error code: ${connectionClosedEvent.statusCode}`);
                }
            }
        });
        const phraseDetection = {};
        if (recognizerConfig.autoDetectSourceLanguages !== undefined) {
            const sourceLanguages = recognizerConfig.autoDetectSourceLanguages.split(",");
            let speechContextLidMode;
            if (recognizerConfig.languageIdMode === "Continuous") {
                speechContextLidMode = "DetectContinuous";
            }
            else { // recognizerConfig.languageIdMode === "AtStart"
                speechContextLidMode = "DetectAtAudioStart";
            }
            this.privSpeechContext.setSection("languageId", {
                Priority: "PrioritizeLatency",
                languages: sourceLanguages,
                mode: speechContextLidMode,
                onSuccess: { action: "Recognize" },
                onUnknown: { action: "None" }
            });
            this.privSpeechContext.setSection("phraseOutput", {
                interimResults: {
                    resultType: "Auto"
                },
                phraseResults: {
                    resultType: "Always"
                }
            });
            const customModels = recognizerConfig.sourceLanguageModels;
            if (customModels !== undefined) {
                phraseDetection.customModels = customModels;
                phraseDetection.onInterim = { action: "None" };
                phraseDetection.onSuccess = { action: "None" };
            }
        }
        const isEmpty = (obj) => {
            // eslint-disable-next-line guard-for-in, brace-style
            for (const x in obj) {
                return false;
            }
            return true;
        };
        if (!isEmpty(phraseDetection)) {
            this.privSpeechContext.setSection("phraseDetection", phraseDetection);
        }
    }
    setSpeechSegmentationTimeout() {
        const speechSegmentationTimeout = this.privRecognizerConfig.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.Speech_SegmentationSilenceTimeoutMs, undefined);
        if (speechSegmentationTimeout !== undefined) {
            const mode = this.recognitionMode === _Exports__WEBPACK_IMPORTED_MODULE_10__.RecognitionMode.Conversation ? "CONVERSATION" :
                this.recognitionMode === _Exports__WEBPACK_IMPORTED_MODULE_10__.RecognitionMode.Dictation ? "DICTATION" : "INTERACTIVE";
            const segmentationSilenceTimeoutMs = parseInt(speechSegmentationTimeout, 10);
            const phraseDetection = this.privSpeechContext.getSection("phraseDetection");
            phraseDetection.mode = mode;
            phraseDetection[mode] = {
                segmentation: {
                    mode: "Custom",
                    segmentationSilenceTimeoutMs
                }
            };
            this.privSpeechContext.setSection("phraseDetection", phraseDetection);
        }
    }
    get audioSource() {
        return this.privAudioSource;
    }
    get speechContext() {
        return this.privSpeechContext;
    }
    get dynamicGrammar() {
        return this.privDynamicGrammar;
    }
    get agentConfig() {
        return this.privAgentConfig;
    }
    set conversationTranslatorToken(token) {
        this.privRecognizerConfig.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.ConversationTranslator_Token, token);
    }
    set voiceProfileType(type) {
        this.privRecognizerConfig.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.SpeechServiceConnection_SpeakerIdMode, type);
    }
    set authentication(auth) {
        this.privAuthentication = this.authentication;
    }
    isDisposed() {
        return this.privIsDisposed;
    }
    dispose(reason) {
        return __awaiter(this, void 0, void 0, function* () {
            this.privIsDisposed = true;
            if (this.privConnectionConfigurationPromise !== undefined) {
                try {
                    const connection = yield this.privConnectionConfigurationPromise;
                    yield connection.dispose(reason);
                }
                catch (error) {
                    // The connection is in a bad state. But we're trying to kill it, so...
                    return;
                }
            }
        });
    }
    get connectionEvents() {
        return this.privConnectionEvents;
    }
    get serviceEvents() {
        return this.privServiceEvents;
    }
    get recognitionMode() {
        return this.privRecognizerConfig.recognitionMode;
    }
    recognize(recoMode, successCallback, errorCallBack) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.recognizeOverride !== undefined) {
                yield this.recognizeOverride(recoMode, successCallback, errorCallBack);
                return;
            }
            // Clear the existing configuration promise to force a re-transmission of config and context.
            this.privConnectionConfigurationPromise = undefined;
            this.privRecognizerConfig.recognitionMode = recoMode;
            this.setSpeechSegmentationTimeout();
            this.privSuccessCallback = successCallback;
            this.privErrorCallback = errorCallBack;
            this.privRequestSession.startNewRecognition();
            this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);
            // Start the connection to the service. The promise this will create is stored and will be used by configureConnection().
            const conPromise = this.connectImpl();
            let audioNode;
            try {
                const audioStreamNode = yield this.audioSource.attach(this.privRequestSession.audioNodeId);
                const format = yield this.audioSource.format;
                const deviceInfo = yield this.audioSource.deviceInfo;
                this.privIsLiveAudio = deviceInfo.type && deviceInfo.type === _Exports__WEBPACK_IMPORTED_MODULE_10__.type.Microphones;
                audioNode = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_11__.ReplayableAudioNode(audioStreamNode, format.avgBytesPerSec);
                yield this.privRequestSession.onAudioSourceAttachCompleted(audioNode, false);
                this.privRecognizerConfig.SpeechServiceConfig.Context.audio = { source: deviceInfo };
            }
            catch (error) {
                yield this.privRequestSession.onStopRecognizing();
                throw error;
            }
            try {
                yield conPromise;
            }
            catch (error) {
                yield this.cancelRecognitionLocal(_sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCode.ConnectionFailure, error);
                return;
            }
            const sessionStartEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__.SessionEventArgs(this.privRequestSession.sessionId);
            if (!!this.privRecognizer.sessionStarted) {
                this.privRecognizer.sessionStarted(this.privRecognizer, sessionStartEventArgs);
            }
            void this.receiveMessage();
            const audioSendPromise = this.sendAudio(audioNode);
            audioSendPromise.catch((error) => __awaiter(this, void 0, void 0, function* () {
                yield this.cancelRecognitionLocal(_sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCode.RuntimeError, error);
            }));
            return;
        });
    }
    stopRecognizing() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privRequestSession.isRecognizing) {
                try {
                    yield this.audioSource.turnOff();
                    yield this.sendFinalAudio();
                    yield this.privRequestSession.onStopRecognizing();
                    yield this.privRequestSession.turnCompletionPromise;
                }
                finally {
                    yield this.privRequestSession.dispose();
                }
            }
            return;
        });
    }
    connect() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.connectImpl();
            return Promise.resolve();
        });
    }
    connectAsync(cb, err) {
        this.connectImpl().then(() => {
            try {
                if (!!cb) {
                    cb();
                }
            }
            catch (e) {
                if (!!err) {
                    err(e);
                }
            }
        }, (reason) => {
            try {
                if (!!err) {
                    err(reason);
                }
                /* eslint-disable no-empty */
            }
            catch (error) {
            }
        });
    }
    disconnect() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.cancelRecognitionLocal(_sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCode.NoError, "Disconnecting");
            if (this.disconnectOverride !== undefined) {
                yield this.disconnectOverride();
            }
            if (this.privConnectionPromise !== undefined) {
                try {
                    yield (yield this.privConnectionPromise).dispose();
                }
                catch (error) {
                }
            }
            this.privConnectionPromise = undefined;
        });
    }
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    sendMessage(message) {
        return;
    }
    sendNetworkMessage(path, payload) {
        return __awaiter(this, void 0, void 0, function* () {
            const type = typeof payload === "string" ? _common_Exports__WEBPACK_IMPORTED_MODULE_13__.MessageType.Text : _common_Exports__WEBPACK_IMPORTED_MODULE_13__.MessageType.Binary;
            const contentType = typeof payload === "string" ? "application/json" : "";
            const connection = yield this.fetchConnection();
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_14__.SpeechConnectionMessage(type, path, this.privRequestSession.requestId, contentType, payload));
        });
    }
    set activityTemplate(messagePayload) {
        this.privActivityTemplate = messagePayload;
    }
    get activityTemplate() {
        return this.privActivityTemplate;
    }
    sendTelemetryData() {
        return __awaiter(this, void 0, void 0, function* () {
            const telemetryData = this.privRequestSession.getTelemetry();
            if (ServiceRecognizerBase.telemetryDataEnabled !== true ||
                this.privIsDisposed ||
                null === telemetryData) {
                return;
            }
            if (!!ServiceRecognizerBase.telemetryData) {
                try {
                    ServiceRecognizerBase.telemetryData(telemetryData);
                    /* eslint-disable no-empty */
                }
                catch (_a) { }
            }
            const connection = yield this.fetchConnection();
            yield connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_14__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_13__.MessageType.Text, "telemetry", this.privRequestSession.requestId, "application/json", telemetryData));
        });
    }
    // Cancels recognition.
    cancelRecognitionLocal(cancellationReason, errorCode, error) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!!this.privRequestSession.isRecognizing) {
                yield this.privRequestSession.onStopRecognizing();
                this.cancelRecognition(this.privRequestSession.sessionId, this.privRequestSession.requestId, cancellationReason, errorCode, error);
            }
        });
    }
    receiveMessage() {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                if (this.privIsDisposed) {
                    // We're done.
                    return;
                }
                let connection = yield this.fetchConnection();
                const message = yield connection.read();
                if (this.receiveMessageOverride !== undefined) {
                    return this.receiveMessageOverride();
                }
                // indicates we are draining the queue and it came with no message;
                if (!message) {
                    if (!this.privRequestSession.isRecognizing) {
                        return;
                    }
                    else {
                        return this.receiveMessage();
                    }
                }
                this.privServiceHasSentMessage = true;
                const connectionMessage = _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_14__.SpeechConnectionMessage.fromConnectionMessage(message);
                if (connectionMessage.requestId.toLowerCase() === this.privRequestSession.requestId.toLowerCase()) {
                    switch (connectionMessage.path.toLowerCase()) {
                        case "turn.start":
                            this.privMustReportEndOfStream = true;
                            this.privRequestSession.onServiceTurnStartResponse();
                            break;
                        case "speech.startdetected":
                            const speechStartDetected = _Exports__WEBPACK_IMPORTED_MODULE_15__.SpeechDetected.fromJSON(connectionMessage.textBody);
                            const speechStartEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__.RecognitionEventArgs(speechStartDetected.Offset, this.privRequestSession.sessionId);
                            if (!!this.privRecognizer.speechStartDetected) {
                                this.privRecognizer.speechStartDetected(this.privRecognizer, speechStartEventArgs);
                            }
                            break;
                        case "speech.enddetected":
                            let json;
                            if (connectionMessage.textBody.length > 0) {
                                json = connectionMessage.textBody;
                            }
                            else {
                                // If the request was empty, the JSON returned is empty.
                                json = "{ Offset: 0 }";
                            }
                            const speechStopDetected = _Exports__WEBPACK_IMPORTED_MODULE_15__.SpeechDetected.fromJSON(json);
                            const speechStopEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__.RecognitionEventArgs(speechStopDetected.Offset + this.privRequestSession.currentTurnAudioOffset, this.privRequestSession.sessionId);
                            if (!!this.privRecognizer.speechEndDetected) {
                                this.privRecognizer.speechEndDetected(this.privRecognizer, speechStopEventArgs);
                            }
                            break;
                        case "turn.end":
                            yield this.sendTelemetryData();
                            if (this.privRequestSession.isSpeechEnded && this.privMustReportEndOfStream) {
                                this.privMustReportEndOfStream = false;
                                yield this.cancelRecognitionLocal(_sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationReason.EndOfStream, _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCode.NoError, undefined);
                            }
                            const sessionStopEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__.SessionEventArgs(this.privRequestSession.sessionId);
                            yield this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition);
                            if (!this.privRecognizerConfig.isContinuousRecognition || this.privRequestSession.isSpeechEnded || !this.privRequestSession.isRecognizing) {
                                if (!!this.privRecognizer.sessionStopped) {
                                    this.privRecognizer.sessionStopped(this.privRecognizer, sessionStopEventArgs);
                                }
                                return;
                            }
                            else {
                                connection = yield this.fetchConnection();
                                yield this.sendPrePayloadJSON(connection);
                            }
                            break;
                        default:
                            if (!(yield this.processTypeSpecificMessages(connectionMessage))) {
                                // here are some messages that the derived class has not processed, dispatch them to connect class
                                if (!!this.privServiceEvents) {
                                    this.serviceEvents.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_17__.ServiceEvent(connectionMessage.path.toLowerCase(), connectionMessage.textBody));
                                }
                            }
                    }
                }
                return this.receiveMessage();
            }
            catch (error) {
                return null;
            }
        });
    }
    sendSpeechContext(connection, generateNewRequestId) {
        const speechContextJson = this.speechContext.toJSON();
        if (generateNewRequestId) {
            this.privRequestSession.onSpeechContext();
        }
        if (speechContextJson) {
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_14__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_13__.MessageType.Text, "speech.context", this.privRequestSession.requestId, "application/json", speechContextJson));
        }
        return;
    }
    noOp() {
        // operation not supported
        return;
    }
    // Encapsulated for derived service recognizers that need to send additional JSON
    sendPrePayloadJSON(connection, generateNewRequestId = true) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.sendPrePayloadJSONOverride !== undefined) {
                return this.sendPrePayloadJSONOverride(connection);
            }
            yield this.sendSpeechContext(connection, generateNewRequestId);
            yield this.sendWaveHeader(connection);
            return;
        });
    }
    sendWaveHeader(connection) {
        return __awaiter(this, void 0, void 0, function* () {
            const format = yield this.audioSource.format;
            // this.writeBufferToConsole(format.header);
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_14__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_13__.MessageType.Binary, "audio", this.privRequestSession.requestId, "audio/x-wav", format.header));
        });
    }
    // Establishes a websocket connection to the end point.
    connectImpl() {
        if (this.privConnectionPromise !== undefined) {
            return this.privConnectionPromise.then((connection) => {
                if (connection.state() === _common_Exports__WEBPACK_IMPORTED_MODULE_18__.ConnectionState.Disconnected) {
                    this.privConnectionId = null;
                    this.privConnectionPromise = undefined;
                    this.privServiceHasSentMessage = false;
                    return this.connectImpl();
                }
                return this.privConnectionPromise;
            }, () => {
                this.privConnectionId = null;
                this.privConnectionPromise = undefined;
                this.privServiceHasSentMessage = false;
                return this.connectImpl();
            });
        }
        this.privConnectionPromise = this.retryableConnect();
        // Attach an empty handler to allow the promise to run in the background while
        // other startup events happen. It'll eventually be awaited on.
        // eslint-disable-next-line @typescript-eslint/no-empty-function
        this.privConnectionPromise.catch(() => { });
        if (this.postConnectImplOverride !== undefined) {
            return this.postConnectImplOverride(this.privConnectionPromise);
        }
        return this.privConnectionPromise;
    }
    sendSpeechServiceConfig(connection, requestSession, SpeechServiceConfigJson) {
        requestSession.onSpeechContext();
        // filter out anything that is not required for the service to work.
        if (ServiceRecognizerBase.telemetryDataEnabled !== true) {
            const withTelemetry = JSON.parse(SpeechServiceConfigJson);
            const replacement = {
                context: {
                    system: withTelemetry.context.system,
                },
            };
            SpeechServiceConfigJson = JSON.stringify(replacement);
        }
        if (this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2", "false").toLowerCase() === "true") {
            const json = JSON.parse(SpeechServiceConfigJson);
            json.context.DisableReferenceChannel = "True";
            json.context.MicSpec = "1_0_0";
            SpeechServiceConfigJson = JSON.stringify(json);
        }
        if (SpeechServiceConfigJson) {
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_14__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_13__.MessageType.Text, "speech.config", requestSession.requestId, "application/json", SpeechServiceConfigJson));
        }
        return;
    }
    fetchConnection() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privConnectionConfigurationPromise !== undefined) {
                return this.privConnectionConfigurationPromise.then((connection) => {
                    if (connection.state() === _common_Exports__WEBPACK_IMPORTED_MODULE_18__.ConnectionState.Disconnected) {
                        this.privConnectionId = null;
                        this.privConnectionConfigurationPromise = undefined;
                        this.privServiceHasSentMessage = false;
                        return this.fetchConnection();
                    }
                    return this.privConnectionConfigurationPromise;
                }, () => {
                    this.privConnectionId = null;
                    this.privConnectionConfigurationPromise = undefined;
                    this.privServiceHasSentMessage = false;
                    return this.fetchConnection();
                });
            }
            this.privConnectionConfigurationPromise = this.configureConnection();
            return yield this.privConnectionConfigurationPromise;
        });
    }
    sendAudio(audioStreamNode) {
        return __awaiter(this, void 0, void 0, function* () {
            const audioFormat = yield this.audioSource.format;
            // The time we last sent data to the service.
            let nextSendTime = Date.now();
            // Max amount to send before we start to throttle
            const fastLaneSizeMs = this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs", "5000");
            const maxSendUnthrottledBytes = audioFormat.avgBytesPerSec / 1000 * parseInt(fastLaneSizeMs, 10);
            const startRecogNumber = this.privRequestSession.recogNumber;
            const readAndUploadCycle = () => __awaiter(this, void 0, void 0, function* () {
                // If speech is done, stop sending audio.
                if (!this.privIsDisposed &&
                    !this.privRequestSession.isSpeechEnded &&
                    this.privRequestSession.isRecognizing &&
                    this.privRequestSession.recogNumber === startRecogNumber) {
                    const connection = yield this.fetchConnection();
                    const audioStreamChunk = yield audioStreamNode.read();
                    // we have a new audio chunk to upload.
                    if (this.privRequestSession.isSpeechEnded) {
                        // If service already recognized audio end then don't send any more audio
                        return;
                    }
                    let payload;
                    let sendDelay;
                    if (!audioStreamChunk || audioStreamChunk.isEnd) {
                        payload = null;
                        sendDelay = 0;
                    }
                    else {
                        payload = audioStreamChunk.buffer;
                        this.privRequestSession.onAudioSent(payload.byteLength);
                        if (maxSendUnthrottledBytes >= this.privRequestSession.bytesSent) {
                            sendDelay = 0;
                        }
                        else {
                            sendDelay = Math.max(0, nextSendTime - Date.now());
                        }
                    }
                    if (0 !== sendDelay) {
                        yield this.delay(sendDelay);
                    }
                    if (payload !== null) {
                        nextSendTime = Date.now() + (payload.byteLength * 1000 / (audioFormat.avgBytesPerSec * 2));
                    }
                    // Are we still alive?
                    if (!this.privIsDisposed &&
                        !this.privRequestSession.isSpeechEnded &&
                        this.privRequestSession.isRecognizing &&
                        this.privRequestSession.recogNumber === startRecogNumber) {
                        connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_14__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_13__.MessageType.Binary, "audio", this.privRequestSession.requestId, null, payload)).catch(() => {
                            // eslint-disable-next-line @typescript-eslint/no-empty-function
                            this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch(() => { });
                        });
                        if (!(audioStreamChunk === null || audioStreamChunk === void 0 ? void 0 : audioStreamChunk.isEnd)) {
                            // this.writeBufferToConsole(payload);
                            // Regardless of success or failure, schedule the next upload.
                            // If the underlying connection was broken, the next cycle will
                            // get a new connection and re-transmit missing audio automatically.
                            return readAndUploadCycle();
                        }
                        else {
                            // the audio stream has been closed, no need to schedule next
                            // read-upload cycle.
                            if (!this.privIsLiveAudio) {
                                this.privRequestSession.onSpeechEnded();
                            }
                        }
                    }
                }
            });
            return readAndUploadCycle();
        });
    }
    retryableConnect() {
        return __awaiter(this, void 0, void 0, function* () {
            let isUnAuthorized = false;
            this.privAuthFetchEventId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_19__.createNoDashGuid)();
            const sessionId = this.privRequestSession.sessionId;
            this.privConnectionId = (sessionId !== undefined) ? sessionId : (0,_common_Exports__WEBPACK_IMPORTED_MODULE_19__.createNoDashGuid)();
            this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId, this.privConnectionId);
            let lastStatusCode = 0;
            let lastReason = "";
            while (this.privRequestSession.numConnectionAttempts <= this.privRecognizerConfig.maxRetryCount) {
                // Get the auth information for the connection. This is a bit of overkill for the current API surface, but leaving the plumbing in place to be able to raise a developer-customer
                // facing event when a connection fails to let them try and provide new auth information.
                const authPromise = isUnAuthorized ? this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId) : this.privAuthentication.fetch(this.privAuthFetchEventId);
                const auth = yield authPromise;
                yield this.privRequestSession.onAuthCompleted(false);
                // Create the connection
                const connection = this.privConnectionFactory.create(this.privRecognizerConfig, auth, this.privConnectionId);
                // Attach the telemetry handlers.
                this.privRequestSession.listenForServiceTelemetry(connection.events);
                // Attach to the underlying event. No need to hold onto the detach pointers as in the event the connection goes away,
                // it'll stop sending events.
                connection.events.attach((event) => {
                    this.connectionEvents.onEvent(event);
                });
                const response = yield connection.open();
                // 200 == everything is fine.
                if (response.statusCode === 200) {
                    yield this.privRequestSession.onConnectionEstablishCompleted(response.statusCode);
                    return Promise.resolve(connection);
                }
                else if (response.statusCode === 1006) {
                    isUnAuthorized = true;
                }
                lastStatusCode = response.statusCode;
                lastReason = response.reason;
                this.privRequestSession.onRetryConnection();
            }
            yield this.privRequestSession.onConnectionEstablishCompleted(lastStatusCode, lastReason);
            return Promise.reject(`Unable to contact server. StatusCode: ${lastStatusCode}, ${this.privRecognizerConfig.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.SpeechServiceConnection_Endpoint)} Reason: ${lastReason}`);
        });
    }
    delay(delayMs) {
        return new Promise((resolve) => this.privSetTimeout(resolve, delayMs));
    }
    writeBufferToConsole(buffer) {
        let out = "Buffer Size: ";
        if (null === buffer) {
            out += "null";
        }
        else {
            const readView = new Uint8Array(buffer);
            out += `${buffer.byteLength}\r\n`;
            for (let i = 0; i < buffer.byteLength; i++) {
                out += readView[i].toString(16).padStart(2, "0") + " ";
                if (((i + 1) % 16) === 0) {
                    // eslint-disable-next-line no-console
                    console.info(out);
                    out = "";
                }
            }
        }
        // eslint-disable-next-line no-console
        console.info(out);
    }
    sendFinalAudio() {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.fetchConnection();
            yield connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_14__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_13__.MessageType.Binary, "audio", this.privRequestSession.requestId, null, null));
            return;
        });
    }
    // Takes an established websocket connection to the endpoint and sends speech configuration information.
    configureConnection() {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.connectImpl();
            if (this.configConnectionOverride !== undefined) {
                return this.configConnectionOverride(connection);
            }
            yield this.sendSpeechServiceConfig(connection, this.privRequestSession, this.privRecognizerConfig.SpeechServiceConfig.serialize());
            yield this.sendPrePayloadJSON(connection, false);
            return connection;
        });
    }
}
ServiceRecognizerBase.telemetryDataEnabled = true;

//# sourceMappingURL=ServiceRecognizerBase.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceTelemetryListener.Internal.js":
/*!***********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceTelemetryListener.Internal.js ***!
  \***********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ServiceTelemetryListener": () => (/* binding */ ServiceTelemetryListener)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/AudioSourceEvents.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionEvents.js");
/* harmony import */ var _RecognitionEvents__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./RecognitionEvents */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognitionEvents.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */


class ServiceTelemetryListener {
    constructor(requestId, audioSourceId, audioNodeId) {
        this.privIsDisposed = false;
        this.privListeningTriggerMetric = null;
        this.privMicMetric = null;
        this.privConnectionEstablishMetric = null;
        this.privRequestId = requestId;
        this.privAudioSourceId = audioSourceId;
        this.privAudioNodeId = audioNodeId;
        this.privReceivedMessages = {};
        this.privPhraseLatencies = [];
        this.privHypothesisLatencies = [];
    }
    phraseReceived(audioReceivedTime) {
        if (audioReceivedTime > 0) { // 0 indicates the time is unknown. Drop it.
            this.privPhraseLatencies.push(Date.now() - audioReceivedTime);
        }
    }
    hypothesisReceived(audioReceivedTime) {
        if (audioReceivedTime > 0) { // 0 indicates the time is unknown. Drop it.
            this.privHypothesisLatencies.push(Date.now() - audioReceivedTime);
        }
    }
    onEvent(e) {
        if (this.privIsDisposed) {
            return;
        }
        if (e instanceof _RecognitionEvents__WEBPACK_IMPORTED_MODULE_0__.RecognitionTriggeredEvent && e.requestId === this.privRequestId) {
            this.privListeningTriggerMetric = {
                End: e.eventTime,
                Name: "ListeningTrigger",
                Start: e.eventTime,
            };
        }
        if (e instanceof _common_Exports__WEBPACK_IMPORTED_MODULE_1__.AudioStreamNodeAttachingEvent && e.audioSourceId === this.privAudioSourceId && e.audioNodeId === this.privAudioNodeId) {
            this.privMicStartTime = e.eventTime;
        }
        if (e instanceof _common_Exports__WEBPACK_IMPORTED_MODULE_1__.AudioStreamNodeAttachedEvent && e.audioSourceId === this.privAudioSourceId && e.audioNodeId === this.privAudioNodeId) {
            this.privMicStartTime = e.eventTime;
        }
        if (e instanceof _common_Exports__WEBPACK_IMPORTED_MODULE_1__.AudioSourceErrorEvent && e.audioSourceId === this.privAudioSourceId) {
            if (!this.privMicMetric) {
                this.privMicMetric = {
                    End: e.eventTime,
                    Error: e.error,
                    Name: "Microphone",
                    Start: this.privMicStartTime,
                };
            }
        }
        if (e instanceof _common_Exports__WEBPACK_IMPORTED_MODULE_1__.AudioStreamNodeErrorEvent && e.audioSourceId === this.privAudioSourceId && e.audioNodeId === this.privAudioNodeId) {
            if (!this.privMicMetric) {
                this.privMicMetric = {
                    End: e.eventTime,
                    Error: e.error,
                    Name: "Microphone",
                    Start: this.privMicStartTime,
                };
            }
        }
        if (e instanceof _common_Exports__WEBPACK_IMPORTED_MODULE_1__.AudioStreamNodeDetachedEvent && e.audioSourceId === this.privAudioSourceId && e.audioNodeId === this.privAudioNodeId) {
            if (!this.privMicMetric) {
                this.privMicMetric = {
                    End: e.eventTime,
                    Name: "Microphone",
                    Start: this.privMicStartTime,
                };
            }
        }
        if (e instanceof _RecognitionEvents__WEBPACK_IMPORTED_MODULE_0__.ConnectingToServiceEvent && e.requestId === this.privRequestId) {
            this.privConnectionId = e.sessionId;
        }
        if (e instanceof _common_Exports__WEBPACK_IMPORTED_MODULE_2__.ConnectionStartEvent && e.connectionId === this.privConnectionId) {
            this.privConnectionStartTime = e.eventTime;
        }
        if (e instanceof _common_Exports__WEBPACK_IMPORTED_MODULE_2__.ConnectionEstablishedEvent && e.connectionId === this.privConnectionId) {
            if (!this.privConnectionEstablishMetric) {
                this.privConnectionEstablishMetric = {
                    End: e.eventTime,
                    Id: this.privConnectionId,
                    Name: "Connection",
                    Start: this.privConnectionStartTime,
                };
            }
        }
        if (e instanceof _common_Exports__WEBPACK_IMPORTED_MODULE_2__.ConnectionEstablishErrorEvent && e.connectionId === this.privConnectionId) {
            if (!this.privConnectionEstablishMetric) {
                this.privConnectionEstablishMetric = {
                    End: e.eventTime,
                    Error: this.getConnectionError(e.statusCode),
                    Id: this.privConnectionId,
                    Name: "Connection",
                    Start: this.privConnectionStartTime,
                };
            }
        }
        if (e instanceof _common_Exports__WEBPACK_IMPORTED_MODULE_2__.ConnectionMessageReceivedEvent && e.connectionId === this.privConnectionId) {
            if (e.message && e.message.headers && e.message.headers.path) {
                if (!this.privReceivedMessages[e.message.headers.path]) {
                    this.privReceivedMessages[e.message.headers.path] = new Array();
                }
                const maxMessagesToSend = 50;
                if (this.privReceivedMessages[e.message.headers.path].length < maxMessagesToSend) {
                    this.privReceivedMessages[e.message.headers.path].push(e.networkReceivedTime);
                }
            }
        }
    }
    getTelemetry() {
        const metrics = new Array();
        if (this.privListeningTriggerMetric) {
            metrics.push(this.privListeningTriggerMetric);
        }
        if (this.privMicMetric) {
            metrics.push(this.privMicMetric);
        }
        if (this.privConnectionEstablishMetric) {
            metrics.push(this.privConnectionEstablishMetric);
        }
        if (this.privPhraseLatencies.length > 0) {
            metrics.push({
                PhraseLatencyMs: this.privPhraseLatencies,
            });
        }
        if (this.privHypothesisLatencies.length > 0) {
            metrics.push({
                FirstHypothesisLatencyMs: this.privHypothesisLatencies,
            });
        }
        const telemetry = {
            Metrics: metrics,
            ReceivedMessages: this.privReceivedMessages,
        };
        const json = JSON.stringify(telemetry);
        // We dont want to send the same telemetry again. So clean those out.
        this.privReceivedMessages = {};
        this.privListeningTriggerMetric = null;
        this.privMicMetric = null;
        this.privConnectionEstablishMetric = null;
        this.privPhraseLatencies = [];
        this.privHypothesisLatencies = [];
        return json;
    }
    // Determines if there are any telemetry events to send to the service.
    get hasTelemetry() {
        return (Object.keys(this.privReceivedMessages).length !== 0 ||
            this.privListeningTriggerMetric !== null ||
            this.privMicMetric !== null ||
            this.privConnectionEstablishMetric !== null ||
            this.privPhraseLatencies.length !== 0 ||
            this.privHypothesisLatencies.length !== 0);
    }
    dispose() {
        this.privIsDisposed = true;
    }
    getConnectionError(statusCode) {
        /*
        -- Websocket status codes --
        NormalClosure = 1000,
        EndpointUnavailable = 1001,
        ProtocolError = 1002,
        InvalidMessageType = 1003,
        Empty = 1005,
        InvalidPayloadData = 1007,
        PolicyViolation = 1008,
        MessageTooBig = 1009,
        MandatoryExtension = 1010,
        InternalServerError = 1011
        */
        switch (statusCode) {
            case 400:
            case 1002:
            case 1003:
            case 1005:
            case 1007:
            case 1008:
            case 1009: return "BadRequest";
            case 401: return "Unauthorized";
            case 403: return "Forbidden";
            case 503:
            case 1001: return "ServerUnavailable";
            case 500:
            case 1011: return "ServerError";
            case 408:
            case 504: return "Timeout";
            default: return "statuscode:" + statusCode.toString();
        }
    }
}

//# sourceMappingURL=ServiceTelemetryListener.Internal.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerRecognitionConfig.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerRecognitionConfig.js ***!
  \**************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeakerRecognitionConfig": () => (/* binding */ SpeakerRecognitionConfig)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class SpeakerRecognitionConfig {
    constructor(context, parameters) {
        this.privContext = context ? context : new _Exports__WEBPACK_IMPORTED_MODULE_0__.Context(null);
        this.privParameters = parameters;
    }
    get parameters() {
        return this.privParameters;
    }
    get Context() {
        return this.privContext;
    }
}

//# sourceMappingURL=SpeakerRecognitionConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerRecognitionConnectionFactory.js":
/*!*************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerRecognitionConnectionFactory.js ***!
  \*************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeakerRecognitionConnectionFactory": () => (/* binding */ SpeakerRecognitionConnectionFactory),
/* harmony export */   "VoiceProfileConnectionFactory": () => (/* binding */ VoiceProfileConnectionFactory)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */





class SpeakerRecognitionConnectionFactoryBase extends _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase {
    create(config, authInfo, endpointPath, connectionId) {
        let endpoint = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Endpoint);
        if (!endpoint) {
            const region = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Region);
            const hostSuffix = _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase.getHostSuffix(region);
            const host = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Host, `wss://${region}.spr-frontend.speech${hostSuffix}`);
            const scenario = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_SpeakerIdMode, "TextIndependentIdentification");
            endpoint = `${host}/speaker/ws/${this.scenarioToPath(scenario)}/${endpointPath}`;
        }
        const queryParams = {
            format: "simple",
            language: config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_RecoLanguage),
        };
        this.setCommonUrlParams(config, queryParams, endpoint);
        const headers = {};
        if (authInfo.token !== undefined && authInfo.token !== "") {
            headers[authInfo.headerName] = authInfo.token;
        }
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.ConnectionId] = connectionId;
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.SpIDAuthKey] = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Key);
        config.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Url, endpoint);
        const enableCompression = config.parameters.getProperty("SPEECH-EnableWebsocketCompression", "false") === "true";
        return new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_3__.WebsocketConnection(endpoint, queryParams, headers, new _Exports__WEBPACK_IMPORTED_MODULE_4__.WebsocketMessageFormatter(), _common_browser_Exports__WEBPACK_IMPORTED_MODULE_5__.ProxyInfo.fromRecognizerConfig(config), enableCompression, connectionId);
    }
    scenarioToPath(mode) {
        switch (mode) {
            case "TextIndependentVerification":
            case "2":
                return "verification/text-independent";
            case "TextDependentVerification":
            case "1":
                return "verification/text-dependent";
            default:
                return "identification/text-independent";
        }
    }
}
class SpeakerRecognitionConnectionFactory extends SpeakerRecognitionConnectionFactoryBase {
    create(config, authInfo, connectionId) {
        return super.create(config, authInfo, "recognition", connectionId);
    }
}
class VoiceProfileConnectionFactory extends SpeakerRecognitionConnectionFactoryBase {
    create(config, authInfo, connectionId) {
        return super.create(config, authInfo, "profile", connectionId);
    }
}

//# sourceMappingURL=SpeakerRecognitionConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerServiceRecognizer.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerServiceRecognizer.js ***!
  \**************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeakerServiceRecognizer": () => (/* binding */ SpeakerServiceRecognizer)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ReplayableAudioNode.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerRecognitionResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./SpeechConnectionMessage.Internal */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionMessage.Internal.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





// eslint-disable-next-line max-classes-per-file
class SpeakerServiceRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.ServiceRecognizerBase {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, recognizer) {
        super(authentication, connectionFactory, audioSource, recognizerConfig, recognizer);
        this.privSpeakerRecognizer = recognizer;
        this.privSpeakerAudioSource = audioSource;
        this.recognizeSpeaker = (model) => this.recognizeSpeakerOnce(model);
        this.sendPrePayloadJSONOverride = () => this.noOp();
    }
    processTypeSpecificMessages(connectionMessage) {
        let processed = false;
        const resultProps = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyCollection();
        if (connectionMessage.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_2__.MessageType.Text) {
            resultProps.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceResponse_JsonResult, connectionMessage.textBody);
        }
        switch (connectionMessage.path.toLowerCase()) {
            case "speaker.response":
                const response = JSON.parse(connectionMessage.textBody);
                let result;
                if (response.status.statusCode.toLowerCase() !== "success") {
                    result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.SpeakerRecognitionResult(response, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.Canceled, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode.ServiceError, response.status.reason);
                }
                else {
                    result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.SpeakerRecognitionResult(response, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.RecognizedSpeaker);
                }
                if (!!this.privResultDeferral) {
                    this.privResultDeferral.resolve(result);
                }
                processed = true;
                break;
            default:
                break;
        }
        const defferal = new _common_Exports__WEBPACK_IMPORTED_MODULE_7__.Deferred();
        defferal.resolve(processed);
        return defferal.promise;
    }
    // Cancels recognition.
    cancelRecognition(sessionId, requestId, cancellationReason, errorCode, error) {
        const properties = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyCollection();
        properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCodePropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode[errorCode]);
        if (!!this.privResultDeferral) {
            const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.SpeakerRecognitionResult({
                scenario: this.privSpeakerModel.scenario,
                status: { statusCode: error, reason: error }
            }, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.Canceled, errorCode, error);
            try {
                this.privResultDeferral.resolve(result);
            }
            catch (error) {
                this.privResultDeferral.reject(error);
            }
        }
    }
    recognizeSpeakerOnce(model) {
        return __awaiter(this, void 0, void 0, function* () {
            this.privSpeakerModel = model;
            this.voiceProfileType = model.scenario;
            if (!this.privResultDeferral) {
                this.privResultDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_7__.Deferred();
            }
            this.privRequestSession.startNewRecognition();
            this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events);
            this.privRecognizerConfig.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.Speech_SessionId, this.privRequestSession.sessionId);
            // Start the connection to the service. The promise this will create is stored and will be used by configureConnection().
            const conPromise = this.connectImpl();
            const preAudioPromise = this.sendPreAudioMessages(this.extractSpeakerContext(model));
            const node = yield this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId);
            const format = yield this.privSpeakerAudioSource.format;
            const deviceInfo = yield this.privSpeakerAudioSource.deviceInfo;
            const audioNode = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_9__.ReplayableAudioNode(node, format.avgBytesPerSec);
            yield this.privRequestSession.onAudioSourceAttachCompleted(audioNode, false);
            this.privRecognizerConfig.SpeechServiceConfig.Context.audio = { source: deviceInfo };
            try {
                yield conPromise;
                yield preAudioPromise;
            }
            catch (err) {
                this.cancelRecognition(this.privRequestSession.sessionId, this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_10__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode.ConnectionFailure, err);
            }
            const sessionStartEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__.SessionEventArgs(this.privRequestSession.sessionId);
            if (!!this.privRecognizer.sessionStarted) {
                this.privRecognizer.sessionStarted(this.privRecognizer, sessionStartEventArgs);
            }
            void this.receiveMessage();
            const audioSendPromise = this.sendAudio(audioNode);
            // /* eslint-disable no-empty */
            audioSendPromise.then(() => { }, (error) => {
                this.cancelRecognition(this.privRequestSession.sessionId, this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_10__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode.RuntimeError, error);
            });
            return this.privResultDeferral.promise;
        });
    }
    sendPreAudioMessages(context) {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.fetchConnection();
            yield this.sendSpeakerRecognition(connection, context);
            // await this.sendWaveHeader(connection);
        });
    }
    sendSpeakerRecognition(connection, context) {
        return __awaiter(this, void 0, void 0, function* () {
            const speakerContextJson = JSON.stringify(context);
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_12__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_2__.MessageType.Text, "speaker.context", this.privRequestSession.requestId, "application/json; charset=utf-8", speakerContextJson));
        });
    }
    extractSpeakerContext(model) {
        return {
            features: {
                interimResult: "enabled",
                progressiveDetection: "disabled",
            },
            profileIds: model.profileIds,
            scenario: model.scenario,
        };
    }
}

//# sourceMappingURL=SpeakerServiceRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionFactory.js":
/*!*************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionFactory.js ***!
  \*************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechConnectionFactory": () => (/* binding */ SpeechConnectionFactory)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
/* harmony import */ var _QueryParameterNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./QueryParameterNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/QueryParameterNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.







class SpeechConnectionFactory extends _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase {
    constructor() {
        super(...arguments);
        this.interactiveRelativeUri = "/speech/recognition/interactive/cognitiveservices/v1";
        this.conversationRelativeUri = "/speech/recognition/conversation/cognitiveservices/v1";
        this.dictationRelativeUri = "/speech/recognition/dictation/cognitiveservices/v1";
        this.universalUri = "/speech/universal/v";
    }
    create(config, authInfo, connectionId) {
        let endpoint = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Endpoint, undefined);
        const region = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Region, undefined);
        const hostSuffix = _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase.getHostSuffix(region);
        const host = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Host, "wss://" + region + ".stt.speech" + hostSuffix);
        const queryParams = {};
        const endpointId = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_EndpointId, undefined);
        const language = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_RecoLanguage, undefined);
        if (endpointId) {
            if (!endpoint || endpoint.search(_QueryParameterNames__WEBPACK_IMPORTED_MODULE_2__.QueryParameterNames.CustomSpeechDeploymentId) === -1) {
                queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_2__.QueryParameterNames.CustomSpeechDeploymentId] = endpointId;
            }
        }
        else if (language) {
            if (!endpoint || endpoint.search(_QueryParameterNames__WEBPACK_IMPORTED_MODULE_2__.QueryParameterNames.Language) === -1) {
                queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_2__.QueryParameterNames.Language] = language;
            }
        }
        if (!endpoint || endpoint.search(_QueryParameterNames__WEBPACK_IMPORTED_MODULE_2__.QueryParameterNames.Format) === -1) {
            queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_2__.QueryParameterNames.Format] = config.parameters.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.OutputFormatPropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.OutputFormat[_sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.OutputFormat.Simple]).toLowerCase();
        }
        if (config.autoDetectSourceLanguages !== undefined) {
            queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_2__.QueryParameterNames.EnableLanguageId] = "true";
        }
        this.setCommonUrlParams(config, queryParams, endpoint);
        if (!endpoint) {
            switch (config.recognitionMode) {
                case _Exports__WEBPACK_IMPORTED_MODULE_5__.RecognitionMode.Conversation:
                    if (config.parameters.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.ForceDictationPropertyName, "false") === "true") {
                        endpoint = host + this.dictationRelativeUri;
                    }
                    else {
                        if (config.recognitionEndpointVersion !== undefined && parseInt(config.recognitionEndpointVersion, 10) > 1) {
                            endpoint = `${host}${this.universalUri}${config.recognitionEndpointVersion}`;
                        }
                        else {
                            endpoint = host + this.conversationRelativeUri;
                        }
                    }
                    break;
                case _Exports__WEBPACK_IMPORTED_MODULE_5__.RecognitionMode.Dictation:
                    endpoint = host + this.dictationRelativeUri;
                    break;
                default:
                    if (config.recognitionEndpointVersion !== undefined && parseInt(config.recognitionEndpointVersion, 10) > 1) {
                        endpoint = `${host}${this.universalUri}${config.recognitionEndpointVersion}`;
                    }
                    else {
                        endpoint = host + this.interactiveRelativeUri; // default is interactive
                    }
                    break;
            }
        }
        const headers = {};
        if (authInfo.token !== undefined && authInfo.token !== "") {
            headers[authInfo.headerName] = authInfo.token;
        }
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_6__.HeaderNames.ConnectionId] = connectionId;
        const enableCompression = config.parameters.getProperty("SPEECH-EnableWebsocketCompression", "false") === "true";
        const webSocketConnection = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_7__.WebsocketConnection(endpoint, queryParams, headers, new _Exports__WEBPACK_IMPORTED_MODULE_8__.WebsocketMessageFormatter(), _common_browser_Exports__WEBPACK_IMPORTED_MODULE_9__.ProxyInfo.fromRecognizerConfig(config), enableCompression, connectionId);
        // Set the value of SpeechServiceConnection_Url to webSocketConnection.uri (and not to `endpoint`), since this value is the final
        // URI that was used to make the connection (including query parameters).
        const uri = webSocketConnection.uri;
        config.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Url, uri);
        return webSocketConnection;
    }
}

//# sourceMappingURL=SpeechConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionMessage.Internal.js":
/*!**********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionMessage.Internal.js ***!
  \**********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechConnectionMessage": () => (/* binding */ SpeechConnectionMessage)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


class SpeechConnectionMessage extends _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ConnectionMessage {
    constructor(messageType, path, requestId, contentType, body, streamId, additionalHeaders, id) {
        if (!path) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.ArgumentNullError("path");
        }
        if (!requestId) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.ArgumentNullError("requestId");
        }
        const headers = {};
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.Path] = path;
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.RequestId] = requestId;
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.RequestTimestamp] = new Date().toISOString();
        if (contentType) {
            headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.ContentType] = contentType;
        }
        if (streamId) {
            headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.RequestStreamId] = streamId;
        }
        if (additionalHeaders) {
            for (const headerName in additionalHeaders) {
                if (headerName) {
                    headers[headerName] = additionalHeaders[headerName];
                }
            }
        }
        if (id) {
            super(messageType, body, headers, id);
        }
        else {
            super(messageType, body, headers);
        }
        this.privPath = path;
        this.privRequestId = requestId;
        this.privContentType = contentType;
        this.privStreamId = streamId;
        this.privAdditionalHeaders = additionalHeaders;
    }
    get path() {
        return this.privPath;
    }
    get requestId() {
        return this.privRequestId;
    }
    get contentType() {
        return this.privContentType;
    }
    get streamId() {
        return this.privStreamId;
    }
    get additionalHeaders() {
        return this.privAdditionalHeaders;
    }
    static fromConnectionMessage(message) {
        let path = null;
        let requestId = null;
        let contentType = null;
        // let requestTimestamp = null;
        let streamId = null;
        const additionalHeaders = {};
        if (message.headers) {
            for (const headerName in message.headers) {
                if (headerName) {
                    if (headerName.toLowerCase() === _HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.Path.toLowerCase()) {
                        path = message.headers[headerName];
                    }
                    else if (headerName.toLowerCase() === _HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.RequestId.toLowerCase()) {
                        requestId = message.headers[headerName];
                        // } else if (headerName.toLowerCase() === HeaderNames.RequestTimestamp.toLowerCase()) {
                        //  requestTimestamp = message.headers[headerName];
                    }
                    else if (headerName.toLowerCase() === _HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.ContentType.toLowerCase()) {
                        contentType = message.headers[headerName];
                    }
                    else if (headerName.toLowerCase() === _HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.RequestStreamId.toLowerCase()) {
                        streamId = message.headers[headerName];
                    }
                    else {
                        additionalHeaders[headerName] = message.headers[headerName];
                    }
                }
            }
        }
        return new SpeechConnectionMessage(message.messageType, path, requestId, contentType, message.body, streamId, additionalHeaders, message.id);
    }
}

//# sourceMappingURL=SpeechConnectionMessage.Internal.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechContext.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechContext.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechContext": () => (/* binding */ SpeechContext)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Represents the JSON used in the speech.context message sent to the speech service.
 * The dynamic grammar is always refreshed from the encapsulated dynamic grammar object.
 */
class SpeechContext {
    constructor(dynamicGrammar) {
        this.privContext = {};
        this.privDynamicGrammar = dynamicGrammar;
    }
    /**
     * Gets a section of the speech.context object.
     * @param sectionName Name of the section to get.
     * @return string or Context JSON serializable object that represents the value.
     */
    getSection(sectionName) {
        return (this.privContext[sectionName] || {});
    }
    /**
     * Adds a section to the speech.context object.
     * @param sectionName Name of the section to add.
     * @param value JSON serializable object that represents the value.
     */
    setSection(sectionName, value) {
        this.privContext[sectionName] = value;
    }
    /**
     * @Internal
     * This is only used by pronunciation assessment config.
     * Do not use externally, object returned will change without warning or notice.
     */
    setPronunciationAssessmentParams(params) {
        if (this.privContext.phraseDetection === undefined) {
            this.privContext.phraseDetection = {
                enrichment: {
                    pronunciationAssessment: {}
                }
            };
        }
        this.privContext.phraseDetection.enrichment.pronunciationAssessment = JSON.parse(params);
        this.setWordLevelTimings();
        this.privContext.phraseOutput.detailed.options.push("PronunciationAssessment");
        if (this.privContext.phraseOutput.detailed.options.indexOf("SNR") === -1) {
            this.privContext.phraseOutput.detailed.options.push("SNR");
        }
    }
    setWordLevelTimings() {
        if (this.privContext.phraseOutput === undefined) {
            this.privContext.phraseOutput = {
                detailed: {
                    options: []
                },
                format: {}
            };
        }
        if (this.privContext.phraseOutput.detailed === undefined) {
            this.privContext.phraseOutput.detailed = {
                options: []
            };
        }
        this.privContext.phraseOutput.format = "Detailed";
        if (this.privContext.phraseOutput.detailed.options.indexOf("WordTimings") === -1) {
            this.privContext.phraseOutput.detailed.options.push("WordTimings");
        }
    }
    toJSON() {
        const dgi = this.privDynamicGrammar.generateGrammarObject();
        this.setSection("dgi", dgi);
        const ret = JSON.stringify(this.privContext);
        return ret;
    }
}

//# sourceMappingURL=SpeechContext.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechServiceInterfaces.js":
/*!*************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechServiceInterfaces.js ***!
  \*************************************************************************************************************************/
/***/ (() => {

// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

//# sourceMappingURL=SpeechServiceInterfaces.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechServiceRecognizer.js":
/*!*************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechServiceRecognizer.js ***!
  \*************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechServiceRecognizer": () => (/* binding */ SpeechServiceRecognizer)
/* harmony export */ });
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionCanceledEventArgs.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechHypothesis.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SimpleSpeechPhrase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/EnumTranslation.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/DetailedSpeechPhrase.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


// eslint-disable-next-line max-classes-per-file
class SpeechServiceRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.ServiceRecognizerBase {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, speechRecognizer) {
        super(authentication, connectionFactory, audioSource, recognizerConfig, speechRecognizer);
        this.privSpeechRecognizer = speechRecognizer;
    }
    processTypeSpecificMessages(connectionMessage) {
        return __awaiter(this, void 0, void 0, function* () {
            let result;
            const resultProps = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyCollection();
            resultProps.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceResponse_JsonResult, connectionMessage.textBody);
            let processed = false;
            switch (connectionMessage.path.toLowerCase()) {
                case "speech.hypothesis":
                case "speech.fragment":
                    const hypothesis = _Exports__WEBPACK_IMPORTED_MODULE_3__.SpeechHypothesis.fromJSON(connectionMessage.textBody);
                    const offset = hypothesis.Offset + this.privRequestSession.currentTurnAudioOffset;
                    result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.SpeechRecognitionResult(this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.RecognizingSpeech, hypothesis.Text, hypothesis.Duration, offset, hypothesis.Language, hypothesis.LanguageDetectionConfidence, undefined, // Speaker Id
                    undefined, connectionMessage.textBody, resultProps);
                    this.privRequestSession.onHypothesis(offset);
                    const ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.SpeechRecognitionEventArgs(result, hypothesis.Duration, this.privRequestSession.sessionId);
                    if (!!this.privSpeechRecognizer.recognizing) {
                        try {
                            this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer, ev);
                            /* eslint-disable no-empty */
                        }
                        catch (error) {
                            // Not going to let errors in the event handler
                            // trip things up.
                        }
                    }
                    processed = true;
                    break;
                case "speech.phrase":
                    const simple = _Exports__WEBPACK_IMPORTED_MODULE_7__.SimpleSpeechPhrase.fromJSON(connectionMessage.textBody);
                    const resultReason = _Exports__WEBPACK_IMPORTED_MODULE_8__.EnumTranslation.implTranslateRecognitionResult(simple.RecognitionStatus);
                    this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset + simple.Offset + simple.Duration);
                    if (_sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.Canceled === resultReason) {
                        const cancelReason = _Exports__WEBPACK_IMPORTED_MODULE_8__.EnumTranslation.implTranslateCancelResult(simple.RecognitionStatus);
                        const cancellationErrorCode = _Exports__WEBPACK_IMPORTED_MODULE_8__.EnumTranslation.implTranslateCancelErrorCode(simple.RecognitionStatus);
                        yield this.cancelRecognitionLocal(cancelReason, cancellationErrorCode, _Exports__WEBPACK_IMPORTED_MODULE_8__.EnumTranslation.implTranslateErrorDetails(cancellationErrorCode));
                    }
                    else {
                        if (!(this.privRequestSession.isSpeechEnded && resultReason === _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.NoMatch && simple.RecognitionStatus !== _Exports__WEBPACK_IMPORTED_MODULE_9__.RecognitionStatus.InitialSilenceTimeout)) {
                            if (this.privRecognizerConfig.parameters.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_10__.OutputFormatPropertyName) === _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__.OutputFormat[_sdk_Exports__WEBPACK_IMPORTED_MODULE_11__.OutputFormat.Simple]) {
                                result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.SpeechRecognitionResult(this.privRequestSession.requestId, resultReason, simple.DisplayText, simple.Duration, simple.Offset + this.privRequestSession.currentTurnAudioOffset, simple.Language, simple.LanguageDetectionConfidence, undefined, // Speaker Id
                                undefined, connectionMessage.textBody, resultProps);
                            }
                            else {
                                const detailed = _Exports__WEBPACK_IMPORTED_MODULE_12__.DetailedSpeechPhrase.fromJSON(connectionMessage.textBody);
                                const totalOffset = detailed.Offset + this.privRequestSession.currentTurnAudioOffset;
                                const offsetCorrectedJson = detailed.getJsonWithCorrectedOffsets(totalOffset);
                                result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.SpeechRecognitionResult(this.privRequestSession.requestId, resultReason, detailed.RecognitionStatus === _Exports__WEBPACK_IMPORTED_MODULE_9__.RecognitionStatus.Success ? detailed.NBest[0].Display : undefined, detailed.Duration, totalOffset, detailed.Language, detailed.LanguageDetectionConfidence, undefined, // Speaker Id
                                undefined, offsetCorrectedJson, resultProps);
                            }
                            const event = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.SpeechRecognitionEventArgs(result, result.offset, this.privRequestSession.sessionId);
                            if (!!this.privSpeechRecognizer.recognized) {
                                try {
                                    this.privSpeechRecognizer.recognized(this.privSpeechRecognizer, event);
                                    /* eslint-disable no-empty */
                                }
                                catch (error) {
                                    // Not going to let errors in the event handler
                                    // trip things up.
                                }
                            }
                        }
                        if (!!this.privSuccessCallback) {
                            try {
                                this.privSuccessCallback(result);
                            }
                            catch (e) {
                                if (!!this.privErrorCallback) {
                                    this.privErrorCallback(e);
                                }
                            }
                            // Only invoke the call back once.
                            // and if it's successful don't invoke the
                            // error after that.
                            this.privSuccessCallback = undefined;
                            this.privErrorCallback = undefined;
                        }
                    }
                    processed = true;
                    break;
                default:
                    break;
            }
            return processed;
        });
    }
    // Cancels recognition.
    cancelRecognition(sessionId, requestId, cancellationReason, errorCode, error) {
        const properties = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyCollection();
        properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_10__.CancellationErrorCodePropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__.CancellationErrorCode[errorCode]);
        if (!!this.privSpeechRecognizer.canceled) {
            const cancelEvent = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.SpeechRecognitionCanceledEventArgs(cancellationReason, error, errorCode, undefined, sessionId);
            try {
                this.privSpeechRecognizer.canceled(this.privSpeechRecognizer, cancelEvent);
                /* eslint-disable no-empty */
            }
            catch (_a) { }
        }
        if (!!this.privSuccessCallback) {
            const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.SpeechRecognitionResult(requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.Canceled, undefined, // Text
            undefined, // Duration
            undefined, // Offset
            undefined, // Language
            undefined, // Language Detection Confidence
            undefined, // Speaker Id
            error, undefined, // Json
            properties);
            try {
                this.privSuccessCallback(result);
                this.privSuccessCallback = undefined;
                /* eslint-disable no-empty */
            }
            catch (_b) { }
        }
    }
}

//# sourceMappingURL=SpeechServiceRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechSynthesisConnectionFactory.js":
/*!**********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechSynthesisConnectionFactory.js ***!
  \**********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechSynthesisConnectionFactory": () => (/* binding */ SpeechSynthesisConnectionFactory)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
/* harmony import */ var _QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./QueryParameterNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/QueryParameterNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.






class SpeechSynthesisConnectionFactory {
    constructor() {
        this.synthesisUri = "/cognitiveservices/websocket/v1";
    }
    create(config, authInfo, connectionId) {
        let endpoint = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_Endpoint, undefined);
        const region = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_Region, undefined);
        const hostSuffix = _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_1__.ConnectionFactoryBase.getHostSuffix(region);
        const endpointId = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_EndpointId, undefined);
        const hostPrefix = (endpointId === undefined) ? "tts" : "voice";
        const host = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_Host, "wss://" + region + "." + hostPrefix + ".speech" + hostSuffix);
        const queryParams = {};
        if (!endpoint) {
            endpoint = host + this.synthesisUri;
        }
        const headers = {};
        if (authInfo.token !== undefined && authInfo.token !== "") {
            headers[authInfo.headerName] = authInfo.token;
        }
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.ConnectionId] = connectionId;
        if (endpointId !== undefined) {
            headers[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CustomVoiceDeploymentId] = endpointId;
        }
        config.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_Url, endpoint);
        const enableCompression = config.parameters.getProperty("SPEECH-EnableWebsocketCompression", "false") === "true";
        return new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_4__.WebsocketConnection(endpoint, queryParams, headers, new _Exports__WEBPACK_IMPORTED_MODULE_5__.WebsocketMessageFormatter(), _common_browser_Exports__WEBPACK_IMPORTED_MODULE_6__.ProxyInfo.fromParameters(config.parameters), enableCompression, connectionId);
    }
}

//# sourceMappingURL=SpeechSynthesisConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisAdapterBase.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisAdapterBase.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SynthesisAdapterBase": () => (/* binding */ SynthesisAdapterBase)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionEvents.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/IConnection.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisWordBoundaryEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisBookmarkEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisVisemeEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisTurn.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisContext.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/AgentConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SynthesisAudioMetadata.js");
/* harmony import */ var _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./SpeechConnectionMessage.Internal */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionMessage.Internal.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




class SynthesisAdapterBase {
    constructor(authentication, connectionFactory, synthesizerConfig, speechSynthesizer, audioDestination) {
        this.speakOverride = undefined;
        this.receiveMessageOverride = undefined;
        this.connectImplOverride = undefined;
        this.configConnectionOverride = undefined;
        // A promise for a configured connection.
        // Do not consume directly, call fetchConnection instead.
        this.privConnectionConfigurationPromise = undefined;
        if (!authentication) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("authentication");
        }
        if (!connectionFactory) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("connectionFactory");
        }
        if (!synthesizerConfig) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("synthesizerConfig");
        }
        this.privAuthentication = authentication;
        this.privConnectionFactory = connectionFactory;
        this.privSynthesizerConfig = synthesizerConfig;
        this.privIsDisposed = false;
        this.privSpeechSynthesizer = speechSynthesizer;
        this.privSessionAudioDestination = audioDestination;
        this.privSynthesisTurn = new _Exports__WEBPACK_IMPORTED_MODULE_1__.SynthesisTurn();
        this.privConnectionEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.EventSource();
        this.privServiceEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.EventSource();
        this.privSynthesisContext = new _Exports__WEBPACK_IMPORTED_MODULE_3__.SynthesisContext(this.privSpeechSynthesizer);
        this.privAgentConfig = new _Exports__WEBPACK_IMPORTED_MODULE_4__.AgentConfig();
        this.connectionEvents.attach((connectionEvent) => {
            if (connectionEvent.name === "ConnectionClosedEvent") {
                const connectionClosedEvent = connectionEvent;
                if (connectionClosedEvent.statusCode !== 1000) {
                    this.cancelSynthesisLocal(_sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.CancellationReason.Error, connectionClosedEvent.statusCode === 1007 ? _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode.BadRequestParameters : _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode.ConnectionFailure, `${connectionClosedEvent.reason} websocket error code: ${connectionClosedEvent.statusCode}`);
                }
            }
        });
    }
    get synthesisContext() {
        return this.privSynthesisContext;
    }
    get agentConfig() {
        return this.privAgentConfig;
    }
    get connectionEvents() {
        return this.privConnectionEvents;
    }
    get serviceEvents() {
        return this.privServiceEvents;
    }
    set activityTemplate(messagePayload) {
        this.privActivityTemplate = messagePayload;
    }
    get activityTemplate() {
        return this.privActivityTemplate;
    }
    set audioOutputFormat(format) {
        this.privAudioOutputFormat = format;
        this.privSynthesisTurn.audioOutputFormat = format;
        if (this.privSessionAudioDestination !== undefined) {
            this.privSessionAudioDestination.format = format;
        }
        if (this.synthesisContext !== undefined) {
            this.synthesisContext.audioOutputFormat = format;
        }
    }
    static addHeader(audio, format) {
        if (!format.hasHeader) {
            return audio;
        }
        format.updateHeader(audio.byteLength);
        const tmp = new Uint8Array(audio.byteLength + format.header.byteLength);
        tmp.set(new Uint8Array(format.header), 0);
        tmp.set(new Uint8Array(audio), format.header.byteLength);
        return tmp.buffer;
    }
    isDisposed() {
        return this.privIsDisposed;
    }
    dispose(reason) {
        return __awaiter(this, void 0, void 0, function* () {
            this.privIsDisposed = true;
            if (this.privSessionAudioDestination !== undefined) {
                this.privSessionAudioDestination.close();
            }
            if (this.privConnectionConfigurationPromise !== undefined) {
                const connection = yield this.privConnectionConfigurationPromise;
                yield connection.dispose(reason);
            }
        });
    }
    connect() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.connectImpl();
        });
    }
    sendNetworkMessage(path, payload) {
        return __awaiter(this, void 0, void 0, function* () {
            const type = typeof payload === "string" ? _common_Exports__WEBPACK_IMPORTED_MODULE_7__.MessageType.Text : _common_Exports__WEBPACK_IMPORTED_MODULE_7__.MessageType.Binary;
            const contentType = typeof payload === "string" ? "application/json" : "";
            const connection = yield this.fetchConnection();
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_8__.SpeechConnectionMessage(type, path, this.privSynthesisTurn.requestId, contentType, payload));
        });
    }
    Speak(text, isSSML, requestId, successCallback, errorCallBack, audioDestination) {
        return __awaiter(this, void 0, void 0, function* () {
            let ssml;
            if (isSSML) {
                ssml = text;
            }
            else {
                ssml = this.privSpeechSynthesizer.buildSsml(text);
            }
            if (this.speakOverride !== undefined) {
                return this.speakOverride(ssml, requestId, successCallback, errorCallBack);
            }
            this.privSuccessCallback = successCallback;
            this.privErrorCallback = errorCallBack;
            this.privSynthesisTurn.startNewSynthesis(requestId, text, isSSML, audioDestination);
            try {
                yield this.connectImpl();
                const connection = yield this.fetchConnection();
                yield this.sendSynthesisContext(connection);
                yield this.sendSsmlMessage(connection, ssml, requestId);
                const synthesisStartEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.SpeechSynthesisEventArgs(new _sdk_Exports__WEBPACK_IMPORTED_MODULE_10__.SpeechSynthesisResult(requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__.ResultReason.SynthesizingAudioStarted));
                if (!!this.privSpeechSynthesizer.synthesisStarted) {
                    this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer, synthesisStartEventArgs);
                }
                void this.receiveMessage();
            }
            catch (e) {
                this.cancelSynthesisLocal(_sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode.ConnectionFailure, e);
                return Promise.reject(e);
            }
        });
    }
    // Cancels synthesis.
    cancelSynthesis(requestId, cancellationReason, errorCode, error) {
        const properties = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyCollection();
        properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_13__.CancellationErrorCodePropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode[errorCode]);
        const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_10__.SpeechSynthesisResult(requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__.ResultReason.Canceled, undefined, error, properties);
        if (!!this.privSpeechSynthesizer.SynthesisCanceled) {
            const cancelEvent = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.SpeechSynthesisEventArgs(result);
            try {
                this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer, cancelEvent);
                /* eslint-disable no-empty */
            }
            catch (_a) { }
        }
        if (!!this.privSuccessCallback) {
            try {
                this.privSuccessCallback(result);
                /* eslint-disable no-empty */
            }
            catch (_b) { }
        }
    }
    // Cancels synthesis.
    cancelSynthesisLocal(cancellationReason, errorCode, error) {
        if (!!this.privSynthesisTurn.isSynthesizing) {
            this.privSynthesisTurn.onStopSynthesizing();
            this.cancelSynthesis(this.privSynthesisTurn.requestId, cancellationReason, errorCode, error);
        }
    }
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    processTypeSpecificMessages(connectionMessage) {
        return true;
    }
    receiveMessage() {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                const connection = yield this.fetchConnection();
                const message = yield connection.read();
                if (this.receiveMessageOverride !== undefined) {
                    return this.receiveMessageOverride();
                }
                if (this.privIsDisposed) {
                    // We're done.
                    return;
                }
                // indicates we are draining the queue and it came with no message;
                if (!message) {
                    if (!this.privSynthesisTurn.isSynthesizing) {
                        return;
                    }
                    else {
                        return this.receiveMessage();
                    }
                }
                const connectionMessage = _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_8__.SpeechConnectionMessage.fromConnectionMessage(message);
                if (connectionMessage.requestId.toLowerCase() === this.privSynthesisTurn.requestId.toLowerCase()) {
                    switch (connectionMessage.path.toLowerCase()) {
                        case "turn.start":
                            this.privSynthesisTurn.onServiceTurnStartResponse();
                            break;
                        case "response":
                            this.privSynthesisTurn.onServiceResponseMessage(connectionMessage.textBody);
                            break;
                        case "audio":
                            if (this.privSynthesisTurn.streamId.toLowerCase() === connectionMessage.streamId.toLowerCase()
                                && !!connectionMessage.binaryBody) {
                                this.privSynthesisTurn.onAudioChunkReceived(connectionMessage.binaryBody);
                                if (!!this.privSpeechSynthesizer.synthesizing) {
                                    try {
                                        const audioWithHeader = SynthesisAdapterBase.addHeader(connectionMessage.binaryBody, this.privSynthesisTurn.audioOutputFormat);
                                        const ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.SpeechSynthesisEventArgs(new _sdk_Exports__WEBPACK_IMPORTED_MODULE_10__.SpeechSynthesisResult(this.privSynthesisTurn.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__.ResultReason.SynthesizingAudio, audioWithHeader));
                                        this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer, ev);
                                    }
                                    catch (error) {
                                        // Not going to let errors in the event handler
                                        // trip things up.
                                    }
                                }
                                if (this.privSessionAudioDestination !== undefined) {
                                    this.privSessionAudioDestination.write(connectionMessage.binaryBody);
                                }
                            }
                            break;
                        case "audio.metadata":
                            const metadataList = _Exports__WEBPACK_IMPORTED_MODULE_14__.SynthesisAudioMetadata.fromJSON(connectionMessage.textBody).Metadata;
                            for (const metadata of metadataList) {
                                switch (metadata.Type) {
                                    case _Exports__WEBPACK_IMPORTED_MODULE_14__.MetadataType.WordBoundary:
                                    case _Exports__WEBPACK_IMPORTED_MODULE_14__.MetadataType.SentenceBoundary:
                                        this.privSynthesisTurn.onTextBoundaryEvent(metadata);
                                        const wordBoundaryEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__.SpeechSynthesisWordBoundaryEventArgs(metadata.Data.Offset, metadata.Data.Duration, metadata.Data.text.Text, metadata.Data.text.Length, metadata.Type === _Exports__WEBPACK_IMPORTED_MODULE_14__.MetadataType.WordBoundary
                                            ? this.privSynthesisTurn.currentTextOffset : this.privSynthesisTurn.currentSentenceOffset, metadata.Data.text.BoundaryType);
                                        if (!!this.privSpeechSynthesizer.wordBoundary) {
                                            try {
                                                this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer, wordBoundaryEventArgs);
                                            }
                                            catch (error) {
                                                // Not going to let errors in the event handler
                                                // trip things up.
                                            }
                                        }
                                        break;
                                    case _Exports__WEBPACK_IMPORTED_MODULE_14__.MetadataType.Bookmark:
                                        const bookmarkEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__.SpeechSynthesisBookmarkEventArgs(metadata.Data.Offset, metadata.Data.Bookmark);
                                        if (!!this.privSpeechSynthesizer.bookmarkReached) {
                                            try {
                                                this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer, bookmarkEventArgs);
                                            }
                                            catch (error) {
                                                // Not going to let errors in the event handler
                                                // trip things up.
                                            }
                                        }
                                        break;
                                    case _Exports__WEBPACK_IMPORTED_MODULE_14__.MetadataType.Viseme:
                                        this.privSynthesisTurn.onVisemeMetadataReceived(metadata);
                                        if (metadata.Data.IsLastAnimation) {
                                            const visemeEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_17__.SpeechSynthesisVisemeEventArgs(metadata.Data.Offset, metadata.Data.VisemeId, this.privSynthesisTurn.getAndClearVisemeAnimation());
                                            if (!!this.privSpeechSynthesizer.visemeReceived) {
                                                try {
                                                    this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer, visemeEventArgs);
                                                }
                                                catch (error) {
                                                    // Not going to let errors in the event handler
                                                    // trip things up.
                                                }
                                            }
                                        }
                                        break;
                                    case _Exports__WEBPACK_IMPORTED_MODULE_14__.MetadataType.SessionEnd:
                                        this.privSynthesisTurn.onSessionEnd(metadata);
                                        break;
                                }
                            }
                            break;
                        case "turn.end":
                            this.privSynthesisTurn.onServiceTurnEndResponse();
                            let result;
                            try {
                                const audioBuffer = yield this.privSynthesisTurn.getAllReceivedAudioWithHeader();
                                result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_10__.SpeechSynthesisResult(this.privSynthesisTurn.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__.ResultReason.SynthesizingAudioCompleted, audioBuffer, undefined, undefined, this.privSynthesisTurn.audioDuration);
                                if (!!this.privSuccessCallback) {
                                    this.privSuccessCallback(result);
                                }
                            }
                            catch (error) {
                                if (!!this.privErrorCallback) {
                                    this.privErrorCallback(error);
                                }
                            }
                            if (this.privSpeechSynthesizer.synthesisCompleted) {
                                try {
                                    this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer, new _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.SpeechSynthesisEventArgs(result));
                                }
                                catch (e) {
                                    // Not going to let errors in the event handler
                                    // trip things up.
                                }
                            }
                            break;
                        default:
                            if (!this.processTypeSpecificMessages(connectionMessage)) {
                                // here are some messages that the derived class has not processed, dispatch them to connect class
                                if (!!this.privServiceEvents) {
                                    this.serviceEvents.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_18__.ServiceEvent(connectionMessage.path.toLowerCase(), connectionMessage.textBody));
                                }
                            }
                    }
                }
                return this.receiveMessage();
            }
            catch (e) {
                // TODO: What goes here?
            }
        });
    }
    sendSynthesisContext(connection) {
        const synthesisContextJson = this.synthesisContext.toJSON();
        if (synthesisContextJson) {
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_8__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_7__.MessageType.Text, "synthesis.context", this.privSynthesisTurn.requestId, "application/json", synthesisContextJson));
        }
        return;
    }
    connectImpl(isUnAuthorized = false) {
        if (this.privConnectionPromise != null) {
            return this.privConnectionPromise.then((connection) => {
                if (connection.state() === _common_Exports__WEBPACK_IMPORTED_MODULE_19__.ConnectionState.Disconnected) {
                    this.privConnectionId = null;
                    this.privConnectionPromise = null;
                    return this.connectImpl();
                }
                return this.privConnectionPromise;
            }, () => {
                this.privConnectionId = null;
                this.privConnectionPromise = null;
                return this.connectImpl();
            });
        }
        this.privAuthFetchEventId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_20__.createNoDashGuid)();
        this.privConnectionId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_20__.createNoDashGuid)();
        this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);
        const authPromise = isUnAuthorized ? this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId) : this.privAuthentication.fetch(this.privAuthFetchEventId);
        this.privConnectionPromise = authPromise.then((result) => __awaiter(this, void 0, void 0, function* () {
            this.privSynthesisTurn.onAuthCompleted(false);
            const connection = this.privConnectionFactory.create(this.privSynthesizerConfig, result, this.privConnectionId);
            // Attach to the underlying event. No need to hold onto the detach pointers as in the event the connection goes away,
            // it'll stop sending events.
            connection.events.attach((event) => {
                this.connectionEvents.onEvent(event);
            });
            const response = yield connection.open();
            if (response.statusCode === 200) {
                this.privSynthesisTurn.onConnectionEstablishCompleted(response.statusCode);
                return Promise.resolve(connection);
            }
            else if (response.statusCode === 403 && !isUnAuthorized) {
                return this.connectImpl(true);
            }
            else {
                this.privSynthesisTurn.onConnectionEstablishCompleted(response.statusCode);
                return Promise.reject(`Unable to contact server. StatusCode: ${response.statusCode}, ${this.privSynthesizerConfig.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_21__.PropertyId.SpeechServiceConnection_Endpoint)} Reason: ${response.reason}`);
            }
        }), (error) => {
            this.privSynthesisTurn.onAuthCompleted(true);
            throw new Error(error);
        });
        // Attach an empty handler to allow the promise to run in the background while
        // other startup events happen. It'll eventually be awaited on.
        // eslint-disable-next-line @typescript-eslint/no-empty-function
        this.privConnectionPromise.catch(() => { });
        return this.privConnectionPromise;
    }
    sendSpeechServiceConfig(connection, SpeechServiceConfigJson) {
        if (SpeechServiceConfigJson) {
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_8__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_7__.MessageType.Text, "speech.config", this.privSynthesisTurn.requestId, "application/json", SpeechServiceConfigJson));
        }
    }
    sendSsmlMessage(connection, ssml, requestId) {
        return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_8__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_7__.MessageType.Text, "ssml", requestId, "application/ssml+xml", ssml));
    }
    fetchConnection() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privConnectionConfigurationPromise !== undefined) {
                return this.privConnectionConfigurationPromise.then((connection) => {
                    if (connection.state() === _common_Exports__WEBPACK_IMPORTED_MODULE_19__.ConnectionState.Disconnected) {
                        this.privConnectionId = null;
                        this.privConnectionConfigurationPromise = undefined;
                        return this.fetchConnection();
                    }
                    return this.privConnectionConfigurationPromise;
                }, () => {
                    this.privConnectionId = null;
                    this.privConnectionConfigurationPromise = undefined;
                    return this.fetchConnection();
                });
            }
            this.privConnectionConfigurationPromise = this.configureConnection();
            return yield this.privConnectionConfigurationPromise;
        });
    }
    // Takes an established websocket connection to the endpoint and sends speech configuration information.
    configureConnection() {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.connectImpl();
            if (this.configConnectionOverride !== undefined) {
                return this.configConnectionOverride(connection);
            }
            yield this.sendSpeechServiceConfig(connection, this.privSynthesizerConfig.SpeechServiceConfig.serialize());
            return connection;
        });
    }
}
SynthesisAdapterBase.telemetryDataEnabled = true;

//# sourceMappingURL=SynthesisAdapterBase.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisContext.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisContext.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SynthesisContext": () => (/* binding */ SynthesisContext)
/* harmony export */ });
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Represents the JSON used in the synthesis.context message sent to the speech service.
 * The dynamic grammar is always refreshed from the encapsulated dynamic grammar object.
 */
class SynthesisContext {
    constructor(speechSynthesizer) {
        this.privContext = {};
        this.privSpeechSynthesizer = speechSynthesizer;
    }
    /**
     * Adds a section to the synthesis.context object.
     * @param sectionName Name of the section to add.
     * @param value JSON serializable object that represents the value.
     */
    setSection(sectionName, value) {
        this.privContext[sectionName] = value;
    }
    /**
     * Sets the audio output format for synthesis context generation.
     * @param format {AudioOutputFormatImpl} the output format
     */
    set audioOutputFormat(format) {
        this.privAudioOutputFormat = format;
    }
    toJSON() {
        const synthesisSection = this.buildSynthesisContext();
        this.setSection("synthesis", synthesisSection);
        return JSON.stringify(this.privContext);
    }
    buildSynthesisContext() {
        return {
            audio: {
                metadataOptions: {
                    bookmarkEnabled: (!!this.privSpeechSynthesizer.bookmarkReached),
                    punctuationBoundaryEnabled: this.privSpeechSynthesizer.properties.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceResponse_RequestPunctuationBoundary, (!!this.privSpeechSynthesizer.wordBoundary)),
                    sentenceBoundaryEnabled: this.privSpeechSynthesizer.properties.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceResponse_RequestSentenceBoundary, false),
                    sessionEndEnabled: true,
                    visemeEnabled: (!!this.privSpeechSynthesizer.visemeReceived),
                    wordBoundaryEnabled: this.privSpeechSynthesizer.properties.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceResponse_RequestWordBoundary, (!!this.privSpeechSynthesizer.wordBoundary)),
                },
                outputFormat: this.privAudioOutputFormat.requestAudioFormatString,
            },
            language: {
                autoDetection: this.privSpeechSynthesizer.autoDetectSourceLanguage
            }
        };
    }
}

//# sourceMappingURL=SynthesisContext.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisEvents.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisEvents.js ***!
  \*****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectingToSynthesisServiceEvent": () => (/* binding */ ConnectingToSynthesisServiceEvent),
/* harmony export */   "SpeechSynthesisEvent": () => (/* binding */ SpeechSynthesisEvent),
/* harmony export */   "SynthesisStartedEvent": () => (/* binding */ SynthesisStartedEvent),
/* harmony export */   "SynthesisTriggeredEvent": () => (/* binding */ SynthesisTriggeredEvent)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */

class SpeechSynthesisEvent extends _common_Exports__WEBPACK_IMPORTED_MODULE_0__.PlatformEvent {
    constructor(eventName, requestId, eventType = _common_Exports__WEBPACK_IMPORTED_MODULE_0__.EventType.Info) {
        super(eventName, eventType);
        this.privRequestId = requestId;
    }
    get requestId() {
        return this.privRequestId;
    }
}
class SynthesisTriggeredEvent extends SpeechSynthesisEvent {
    constructor(requestId, sessionAudioDestinationId, turnAudioDestinationId) {
        super("SynthesisTriggeredEvent", requestId);
        this.privSessionAudioDestinationId = sessionAudioDestinationId;
        this.privTurnAudioDestinationId = turnAudioDestinationId;
    }
    get audioSessionDestinationId() {
        return this.privSessionAudioDestinationId;
    }
    get audioTurnDestinationId() {
        return this.privTurnAudioDestinationId;
    }
}
class ConnectingToSynthesisServiceEvent extends SpeechSynthesisEvent {
    constructor(requestId, authFetchEventId) {
        super("ConnectingToSynthesisServiceEvent", requestId);
        this.privAuthFetchEventId = authFetchEventId;
    }
    get authFetchEventId() {
        return this.privAuthFetchEventId;
    }
}
class SynthesisStartedEvent extends SpeechSynthesisEvent {
    constructor(requestId, authFetchEventId) {
        super("SynthesisStartedEvent", requestId);
        this.privAuthFetchEventId = authFetchEventId;
    }
    get authFetchEventId() {
        return this.privAuthFetchEventId;
    }
}

//# sourceMappingURL=SynthesisEvents.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisRestAdapter.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisRestAdapter.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SynthesisRestAdapter": () => (/* binding */ SynthesisRestAdapter)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/RestConfigBase.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/RestMessageAdapter.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");




/**
 * Implements methods for speaker recognition classes, sending requests to endpoint
 * and parsing response into expected format
 * @class SynthesisRestAdapter
 */
class SynthesisRestAdapter {
    constructor(config, authentication) {
        let endpoint = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_Endpoint, undefined);
        if (!endpoint) {
            const region = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_Region, "westus");
            const hostSuffix = _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_1__.ConnectionFactoryBase.getHostSuffix(region);
            endpoint = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_Host, `https://${region}.tts.speech${hostSuffix}`);
        }
        this.privUri = `${endpoint}/cognitiveservices/voices/list`;
        const options = _common_browser_Exports__WEBPACK_IMPORTED_MODULE_2__.RestConfigBase.requestOptions;
        this.privRestAdapter = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_3__.RestMessageAdapter(options);
        this.privAuthentication = authentication;
    }
    /**
     * Sends list voices request to endpoint.
     * @function
     * @public
     * @param connectionId - guid for connectionId
     * @returns {Promise<IRestResponse>} rest response to status request
     */
    getVoicesList(connectionId) {
        this.privRestAdapter.setHeaders(_HeaderNames__WEBPACK_IMPORTED_MODULE_4__.HeaderNames.ConnectionId, connectionId);
        return this.privAuthentication.fetch(connectionId).then((authInfo) => {
            this.privRestAdapter.setHeaders(authInfo.headerName, authInfo.token);
            return this.privRestAdapter.request(_common_browser_Exports__WEBPACK_IMPORTED_MODULE_3__.RestRequestType.Get, this.privUri);
        });
    }
}

//# sourceMappingURL=SynthesisRestAdapter.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisTurn.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisTurn.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SynthesisTurn": () => (/* binding */ SynthesisTurn)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _sdk_Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sdk/Audio/AudioOutputStream */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputStream.js");
/* harmony import */ var _ServiceMessages_SynthesisAudioMetadata__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ServiceMessages/SynthesisAudioMetadata */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SynthesisAudioMetadata.js");
/* harmony import */ var _SynthesisAdapterBase__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./SynthesisAdapterBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisAdapterBase.js");
/* harmony import */ var _SynthesisEvents__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./SynthesisEvents */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisEvents.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





class SynthesisTurn {
    constructor() {
        this.privIsDisposed = false;
        this.privIsSynthesizing = false;
        this.privIsSynthesisEnded = false;
        this.privBytesReceived = 0;
        this.privInTurn = false;
        this.privTextOffset = 0;
        this.privNextSearchTextIndex = 0;
        this.privSentenceOffset = 0;
        this.privNextSearchSentenceIndex = 0;
        this.privRequestId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privTurnDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.Deferred();
        // We're not in a turn, so resolve.
        this.privTurnDeferral.resolve();
    }
    get requestId() {
        return this.privRequestId;
    }
    get streamId() {
        return this.privStreamId;
    }
    set streamId(value) {
        this.privStreamId = value;
    }
    get audioOutputFormat() {
        return this.privAudioOutputFormat;
    }
    set audioOutputFormat(format) {
        this.privAudioOutputFormat = format;
    }
    get turnCompletionPromise() {
        return this.privTurnDeferral.promise;
    }
    get isSynthesisEnded() {
        return this.privIsSynthesisEnded;
    }
    get isSynthesizing() {
        return this.privIsSynthesizing;
    }
    get currentTextOffset() {
        return this.privTextOffset;
    }
    get currentSentenceOffset() {
        return this.privSentenceOffset;
    }
    // The number of bytes received for current turn
    get bytesReceived() {
        return this.privBytesReceived;
    }
    get audioDuration() {
        return this.privAudioDuration;
    }
    getAllReceivedAudio() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!!this.privReceivedAudio) {
                return Promise.resolve(this.privReceivedAudio);
            }
            if (!this.privIsSynthesisEnded) {
                return null;
            }
            yield this.readAllAudioFromStream();
            return Promise.resolve(this.privReceivedAudio);
        });
    }
    getAllReceivedAudioWithHeader() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!!this.privReceivedAudioWithHeader) {
                return this.privReceivedAudioWithHeader;
            }
            if (!this.privIsSynthesisEnded) {
                return null;
            }
            if (this.audioOutputFormat.hasHeader) {
                const audio = yield this.getAllReceivedAudio();
                this.privReceivedAudioWithHeader = _SynthesisAdapterBase__WEBPACK_IMPORTED_MODULE_2__.SynthesisAdapterBase.addHeader(audio, this.audioOutputFormat);
                return this.privReceivedAudioWithHeader;
            }
            else {
                return this.getAllReceivedAudio();
            }
        });
    }
    startNewSynthesis(requestId, rawText, isSSML, audioDestination) {
        this.privIsSynthesisEnded = false;
        this.privIsSynthesizing = true;
        this.privRequestId = requestId;
        this.privRawText = rawText;
        this.privIsSSML = isSSML;
        this.privAudioOutputStream = new _sdk_Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_3__.PullAudioOutputStreamImpl();
        this.privAudioOutputStream.format = this.privAudioOutputFormat;
        this.privReceivedAudio = null;
        this.privReceivedAudioWithHeader = null;
        this.privBytesReceived = 0;
        this.privTextOffset = 0;
        this.privNextSearchTextIndex = 0;
        this.privSentenceOffset = 0;
        this.privNextSearchSentenceIndex = 0;
        this.privPartialVisemeAnimation = "";
        if (audioDestination !== undefined) {
            this.privTurnAudioDestination = audioDestination;
            this.privTurnAudioDestination.format = this.privAudioOutputFormat;
        }
        this.onEvent(new _SynthesisEvents__WEBPACK_IMPORTED_MODULE_4__.SynthesisTriggeredEvent(this.requestId, undefined, audioDestination === undefined ? undefined : audioDestination.id()));
    }
    onPreConnectionStart(authFetchEventId) {
        this.privAuthFetchEventId = authFetchEventId;
        this.onEvent(new _SynthesisEvents__WEBPACK_IMPORTED_MODULE_4__.ConnectingToSynthesisServiceEvent(this.privRequestId, this.privAuthFetchEventId));
    }
    onAuthCompleted(isError) {
        if (isError) {
            this.onComplete();
        }
    }
    onConnectionEstablishCompleted(statusCode) {
        if (statusCode === 200) {
            this.onEvent(new _SynthesisEvents__WEBPACK_IMPORTED_MODULE_4__.SynthesisStartedEvent(this.requestId, this.privAuthFetchEventId));
            this.privBytesReceived = 0;
            return;
        }
        else if (statusCode === 403) {
            this.onComplete();
        }
    }
    onServiceResponseMessage(responseJson) {
        const response = JSON.parse(responseJson);
        this.streamId = response.audio.streamId;
    }
    onServiceTurnEndResponse() {
        this.privInTurn = false;
        this.privTurnDeferral.resolve();
        this.onComplete();
    }
    onServiceTurnStartResponse() {
        if (!!this.privTurnDeferral && !!this.privInTurn) {
            // What? How are we starting a turn with another not done?
            this.privTurnDeferral.reject("Another turn started before current completed.");
            // Avoid UnhandledPromiseRejection if privTurnDeferral is not being awaited
            // eslint-disable-next-line @typescript-eslint/no-empty-function
            this.privTurnDeferral.promise.then().catch(() => { });
        }
        this.privInTurn = true;
        this.privTurnDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.Deferred();
    }
    onAudioChunkReceived(data) {
        if (this.isSynthesizing) {
            this.privAudioOutputStream.write(data);
            this.privBytesReceived += data.byteLength;
            if (this.privTurnAudioDestination !== undefined) {
                this.privTurnAudioDestination.write(data);
            }
        }
    }
    onTextBoundaryEvent(metadata) {
        this.updateTextOffset(metadata.Data.text.Text, metadata.Type);
    }
    onVisemeMetadataReceived(metadata) {
        if (metadata.Data.AnimationChunk !== undefined) {
            this.privPartialVisemeAnimation += metadata.Data.AnimationChunk;
        }
    }
    onSessionEnd(metadata) {
        this.privAudioDuration = metadata.Data.Offset;
    }
    dispose() {
        if (!this.privIsDisposed) {
            // we should have completed by now. If we did not its an unknown error.
            this.privIsDisposed = true;
        }
    }
    onStopSynthesizing() {
        this.onComplete();
    }
    /**
     * Gets the viseme animation string (merged from animation chunk), and clears the internal
     * partial animation.
     */
    getAndClearVisemeAnimation() {
        const animation = this.privPartialVisemeAnimation;
        this.privPartialVisemeAnimation = "";
        return animation;
    }
    onEvent(event) {
        _common_Exports__WEBPACK_IMPORTED_MODULE_5__.Events.instance.onEvent(event);
    }
    /**
     * Check if the text is an XML(SSML) tag
     * @param text
     * @private
     */
    static isXmlTag(text) {
        return text.length >= 2 && text[0] === "<" && text[text.length - 1] === ">";
    }
    updateTextOffset(text, type) {
        if (type === _ServiceMessages_SynthesisAudioMetadata__WEBPACK_IMPORTED_MODULE_6__.MetadataType.WordBoundary) {
            this.privTextOffset = this.privRawText.indexOf(text, this.privNextSearchTextIndex);
            if (this.privTextOffset >= 0) {
                this.privNextSearchTextIndex = this.privTextOffset + text.length;
                if (this.privIsSSML) {
                    if (this.withinXmlTag(this.privTextOffset) && !SynthesisTurn.isXmlTag(text)) {
                        this.updateTextOffset(text, type);
                    }
                }
            }
        }
        else {
            this.privSentenceOffset = this.privRawText.indexOf(text, this.privNextSearchSentenceIndex);
            if (this.privSentenceOffset >= 0) {
                this.privNextSearchSentenceIndex = this.privSentenceOffset + text.length;
                if (this.privIsSSML) {
                    if (this.withinXmlTag(this.privSentenceOffset) && !SynthesisTurn.isXmlTag(text)) {
                        this.updateTextOffset(text, type);
                    }
                }
            }
        }
    }
    onComplete() {
        if (this.privIsSynthesizing) {
            this.privIsSynthesizing = false;
            this.privIsSynthesisEnded = true;
            this.privAudioOutputStream.close();
            this.privInTurn = false;
            if (this.privTurnAudioDestination !== undefined) {
                this.privTurnAudioDestination.close();
                this.privTurnAudioDestination = undefined;
            }
        }
    }
    readAllAudioFromStream() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privIsSynthesisEnded) {
                this.privReceivedAudio = new ArrayBuffer(this.bytesReceived);
                try {
                    yield this.privAudioOutputStream.read(this.privReceivedAudio);
                }
                catch (e) {
                    this.privReceivedAudio = new ArrayBuffer(0);
                }
            }
        });
    }
    /**
     * Check if current idx is in XML(SSML) tag
     * @param idx
     * @private
     */
    withinXmlTag(idx) {
        return this.privRawText.indexOf("<", idx + 1) > this.privRawText.indexOf(">", idx + 1);
    }
}

//# sourceMappingURL=SynthesisTurn.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesizerConfig.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesizerConfig.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SynthesisServiceType": () => (/* binding */ SynthesisServiceType),
/* harmony export */   "SynthesizerConfig": () => (/* binding */ SynthesizerConfig)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

var SynthesisServiceType;
(function (SynthesisServiceType) {
    SynthesisServiceType[SynthesisServiceType["Standard"] = 0] = "Standard";
    SynthesisServiceType[SynthesisServiceType["Custom"] = 1] = "Custom";
})(SynthesisServiceType || (SynthesisServiceType = {}));
class SynthesizerConfig {
    constructor(speechServiceConfig, parameters) {
        this.privSynthesisServiceType = SynthesisServiceType.Standard;
        this.privSpeechServiceConfig = speechServiceConfig ? speechServiceConfig : new _Exports__WEBPACK_IMPORTED_MODULE_0__.SpeechServiceConfig(new _Exports__WEBPACK_IMPORTED_MODULE_0__.Context(null));
        this.privParameters = parameters;
    }
    get parameters() {
        return this.privParameters;
    }
    get synthesisServiceType() {
        return this.privSynthesisServiceType;
    }
    set synthesisServiceType(value) {
        this.privSynthesisServiceType = value;
    }
    get SpeechServiceConfig() {
        return this.privSpeechServiceConfig;
    }
}

//# sourceMappingURL=SynthesizerConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranscriberConnectionFactory.js":
/*!******************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranscriberConnectionFactory.js ***!
  \******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranscriberConnectionFactory": () => (/* binding */ TranscriberConnectionFactory)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
/* harmony import */ var _QueryParameterNames__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./QueryParameterNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/QueryParameterNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.






class TranscriberConnectionFactory extends _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase {
    constructor() {
        super(...arguments);
        this.multiaudioRelativeUri = "/speech/recognition/multiaudio";
    }
    create(config, authInfo, connectionId) {
        let endpoint = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Endpoint, undefined);
        const region = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Region, "centralus");
        const hostSuffix = _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase.getHostSuffix(region);
        const hostDefault = "wss://transcribe." + region + ".cts.speech" + hostSuffix + this.multiaudioRelativeUri;
        const host = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Host, hostDefault);
        const queryParams = {};
        this.setQueryParams(queryParams, config, endpoint);
        if (!endpoint) {
            endpoint = host;
        }
        const headers = {};
        if (authInfo.token !== undefined && authInfo.token !== "") {
            headers[authInfo.headerName] = authInfo.token;
        }
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.ConnectionId] = connectionId;
        config.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Url, endpoint);
        const enableCompression = config.parameters.getProperty("SPEECH-EnableWebsocketCompression", "false") === "true";
        return new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_3__.WebsocketConnection(endpoint, queryParams, headers, new _Exports__WEBPACK_IMPORTED_MODULE_4__.WebsocketMessageFormatter(), _common_browser_Exports__WEBPACK_IMPORTED_MODULE_5__.ProxyInfo.fromRecognizerConfig(config), enableCompression, connectionId);
    }
    setQueryParams(queryParams, config, endpointUrl) {
        const endpointId = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_EndpointId, undefined);
        const language = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_RecoLanguage, undefined);
        if (endpointId && !(_QueryParameterNames__WEBPACK_IMPORTED_MODULE_6__.QueryParameterNames.CustomSpeechDeploymentId in queryParams)) {
            queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_6__.QueryParameterNames.CustomSpeechDeploymentId] = endpointId;
        }
        if (language && !(_QueryParameterNames__WEBPACK_IMPORTED_MODULE_6__.QueryParameterNames.Language in queryParams)) {
            queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_6__.QueryParameterNames.Language] = language;
        }
        const wordLevelTimings = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps, "false").toLowerCase() === "true";
        const detailed = config.parameters.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_7__.OutputFormatPropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.OutputFormat[_sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.OutputFormat.Simple]) !== _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.OutputFormat[_sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.OutputFormat.Simple];
        if (wordLevelTimings || detailed) {
            queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_6__.QueryParameterNames.Format] = _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.OutputFormat[_sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.OutputFormat.Detailed].toLowerCase();
        }
        this.setCommonUrlParams(config, queryParams, endpointUrl);
    }
}

//# sourceMappingURL=TranscriberConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionConfig.js":
/*!********************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionConfig.js ***!
  \********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationConnectionConfig": () => (/* binding */ ConversationConnectionConfig)
/* harmony export */ });
/* harmony import */ var _common_browser_RestConfigBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../common.browser/RestConfigBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/RestConfigBase.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class ConversationConnectionConfig extends _common_browser_RestConfigBase__WEBPACK_IMPORTED_MODULE_0__.RestConfigBase {
    static get host() {
        return ConversationConnectionConfig.privHost;
    }
    static get apiVersion() {
        return ConversationConnectionConfig.privApiVersion;
    }
    static get clientAppId() {
        return ConversationConnectionConfig.privClientAppId;
    }
    static get defaultLanguageCode() {
        return ConversationConnectionConfig.privDefaultLanguageCode;
    }
    static get restPath() {
        return ConversationConnectionConfig.privRestPath;
    }
    static get webSocketPath() {
        return ConversationConnectionConfig.privWebSocketPath;
    }
    static get transcriptionEventKeys() {
        return ConversationConnectionConfig.privTranscriptionEventKeys;
    }
}
ConversationConnectionConfig.privHost = "dev.microsofttranslator.com";
ConversationConnectionConfig.privRestPath = "/capito/room";
ConversationConnectionConfig.privApiVersion = "2.0";
ConversationConnectionConfig.privDefaultLanguageCode = "en-US";
ConversationConnectionConfig.privClientAppId = "FC539C22-1767-4F1F-84BC-B4D811114F15";
ConversationConnectionConfig.privWebSocketPath = "/capito/translate";
ConversationConnectionConfig.privTranscriptionEventKeys = ["iCalUid", "callId", "organizer", "FLAC", "MTUri", "DifferentiateGuestSpeakers", "audiorecording", "Threadid", "OrganizerMri", "OrganizerTenantId", "UserToken"];

//# sourceMappingURL=ConversationConnectionConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionFactory.js":
/*!*********************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionFactory.js ***!
  \*********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationConnectionFactory": () => (/* binding */ ConversationConnectionFactory)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _sdk_Contracts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../sdk/Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ConversationConnectionConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionConfig.js");
/* harmony import */ var _ConversationWebsocketMessageFormatter__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ConversationWebsocketMessageFormatter */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationWebsocketMessageFormatter.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.







/**
 * Create a connection to the Conversation Translator websocket for sending instant messages and commands, and for receiving translated messages.
 * The conversation must already have been started or joined.
 */
class ConversationConnectionFactory extends _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase {
    create(config, authInfo, connectionId) {
        const endpointHost = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.ConversationTranslator_Host, _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_2__.ConversationConnectionConfig.host);
        const correlationId = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.ConversationTranslator_CorrelationId, (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.createGuid)());
        const endpoint = `wss://${endpointHost}${_ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_2__.ConversationConnectionConfig.webSocketPath}`;
        const token = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.ConversationTranslator_Token, undefined);
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_4__.Contracts.throwIfNullOrUndefined(token, "token");
        const queryParams = {};
        queryParams[_ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_2__.ConversationConnectionConfig.configParams.apiVersion] = _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_2__.ConversationConnectionConfig.apiVersion;
        queryParams[_ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_2__.ConversationConnectionConfig.configParams.token] = token;
        queryParams[_ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_2__.ConversationConnectionConfig.configParams.correlationId] = correlationId;
        const enableCompression = config.parameters.getProperty("SPEECH-EnableWebsocketCompression", "false") === "true";
        return new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_5__.WebsocketConnection(endpoint, queryParams, {}, new _ConversationWebsocketMessageFormatter__WEBPACK_IMPORTED_MODULE_6__.ConversationWebsocketMessageFormatter(), _common_browser_Exports__WEBPACK_IMPORTED_MODULE_7__.ProxyInfo.fromRecognizerConfig(config), enableCompression, connectionId);
    }
}

//# sourceMappingURL=ConversationConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionMessage.js":
/*!*********************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionMessage.js ***!
  \*********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationConnectionMessage": () => (/* binding */ ConversationConnectionMessage)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class ConversationConnectionMessage extends _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ConnectionMessage {
    constructor(messageType, body, headers, id) {
        super(messageType, body, headers, id);
        const json = JSON.parse(this.textBody);
        if (json.type !== undefined) {
            this.privConversationMessageType = json.type;
        }
    }
    get conversationMessageType() {
        return this.privConversationMessageType;
    }
}

//# sourceMappingURL=ConversationConnectionMessage.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationManager.js":
/*!***********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationManager.js ***!
  \***********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationManager": () => (/* binding */ ConversationManager)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/RestMessageAdapter.js");
/* harmony import */ var _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../sdk/Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ConversationConnectionConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionConfig.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.




class ConversationManager {
    constructor() {
        //
        this.privRequestParams = _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_0__.ConversationConnectionConfig.configParams;
        this.privErrors = _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_0__.ConversationConnectionConfig.restErrors;
        this.privHost = _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_0__.ConversationConnectionConfig.host;
        this.privApiVersion = _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_0__.ConversationConnectionConfig.apiVersion;
        this.privRestPath = _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_0__.ConversationConnectionConfig.restPath;
        this.privRestAdapter = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__.RestMessageAdapter({});
    }
    /**
     * Make a POST request to the Conversation Manager service endpoint to create or join a conversation.
     * @param args
     * @param conversationCode
     * @param callback
     * @param errorCallback
     */
    createOrJoin(args, conversationCode, cb, err) {
        try {
            _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrUndefined(args, "args");
            const languageCode = args.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_RecoLanguage, _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_0__.ConversationConnectionConfig.defaultLanguageCode);
            const nickname = args.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.ConversationTranslator_Name, "conversation_host");
            const endpointHost = args.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.ConversationTranslator_Host, this.privHost);
            const correlationId = args.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.ConversationTranslator_CorrelationId);
            const subscriptionKey = args.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_Key);
            const subscriptionRegion = args.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_Region);
            const authToken = args.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceAuthorization_Token);
            _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrWhitespace(languageCode, "languageCode");
            _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrWhitespace(nickname, "nickname");
            _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrWhitespace(endpointHost, "endpointHost");
            const queryParams = {};
            queryParams[this.privRequestParams.apiVersion] = this.privApiVersion;
            queryParams[this.privRequestParams.languageCode] = languageCode;
            queryParams[this.privRequestParams.nickname] = nickname;
            const headers = {};
            if (correlationId) {
                headers[this.privRequestParams.correlationId] = correlationId;
            }
            headers[this.privRequestParams.clientAppId] = _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_0__.ConversationConnectionConfig.clientAppId;
            if (conversationCode !== undefined) {
                queryParams[this.privRequestParams.roomId] = conversationCode;
            }
            else {
                _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrUndefined(subscriptionRegion, this.privErrors.authInvalidSubscriptionRegion);
                headers[this.privRequestParams.subscriptionRegion] = subscriptionRegion;
                if (subscriptionKey) {
                    headers[this.privRequestParams.subscriptionKey] = subscriptionKey;
                }
                else if (authToken) {
                    headers[this.privRequestParams.authorization] = `Bearer ${authToken}`;
                }
                else {
                    _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrUndefined(subscriptionKey, this.privErrors.authInvalidSubscriptionKey);
                }
            }
            const config = {};
            config.headers = headers;
            this.privRestAdapter.options = config;
            const endpoint = `https://${endpointHost}${this.privRestPath}`;
            // TODO: support a proxy and certificate validation
            this.privRestAdapter.request(_common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__.RestRequestType.Post, endpoint, queryParams, null).then((response) => {
                const requestId = _common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__.RestMessageAdapter.extractHeaderValue(this.privRequestParams.requestId, response.headers);
                if (!response.ok) {
                    if (!!err) {
                        // get the error
                        let errorMessage = this.privErrors.invalidCreateJoinConversationResponse.replace("{status}", response.status.toString());
                        let errMessageRaw;
                        try {
                            errMessageRaw = JSON.parse(response.data);
                            errorMessage += ` [${errMessageRaw.error.code}: ${errMessageRaw.error.message}]`;
                        }
                        catch (e) {
                            errorMessage += ` [${response.data}]`;
                        }
                        if (requestId) {
                            errorMessage += ` ${requestId}`;
                        }
                        err(errorMessage);
                    }
                    return;
                }
                const conversation = JSON.parse(response.data);
                if (conversation) {
                    conversation.requestId = requestId;
                }
                if (!!cb) {
                    try {
                        cb(conversation);
                    }
                    catch (e) {
                        if (!!err) {
                            err(e);
                        }
                    }
                    cb = undefined;
                }
                // eslint-disable-next-line @typescript-eslint/no-empty-function
            }).catch(() => { });
        }
        catch (error) {
            if (!!err) {
                if (error instanceof Error) {
                    const typedError = error;
                    err(typedError.name + ": " + typedError.message);
                }
                else {
                    err(error);
                }
            }
        }
    }
    /**
     * Make a DELETE request to the Conversation Manager service endpoint to leave the conversation.
     * @param args
     * @param sessionToken
     * @param callback
     */
    leave(args, sessionToken) {
        return new Promise((resolve, reject) => {
            try {
                _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrUndefined(args, this.privErrors.invalidArgs.replace("{arg}", "config"));
                _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrWhitespace(sessionToken, this.privErrors.invalidArgs.replace("{arg}", "token"));
                const endpointHost = args.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.ConversationTranslator_Host, this.privHost);
                const correlationId = args.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.ConversationTranslator_CorrelationId);
                const queryParams = {};
                queryParams[this.privRequestParams.apiVersion] = this.privApiVersion;
                queryParams[this.privRequestParams.sessionToken] = sessionToken;
                const headers = {};
                if (correlationId) {
                    headers[this.privRequestParams.correlationId] = correlationId;
                }
                const config = {};
                config.headers = headers;
                this.privRestAdapter.options = config;
                const endpoint = `https://${endpointHost}${this.privRestPath}`;
                // TODO: support a proxy and certificate validation
                this.privRestAdapter.request(_common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__.RestRequestType.Delete, endpoint, queryParams, null).then((response) => {
                    if (!response.ok) {
                        // ignore errors on delete
                    }
                    resolve();
                    // eslint-disable-next-line @typescript-eslint/no-empty-function
                }).catch(() => { });
            }
            catch (error) {
                if (error instanceof Error) {
                    const typedError = error;
                    reject(typedError.name + ": " + typedError.message);
                }
                else {
                    reject(error);
                }
            }
        });
    }
}

//# sourceMappingURL=ConversationManager.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationRequestSession.js":
/*!******************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationRequestSession.js ***!
  \******************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationRequestSession": () => (/* binding */ ConversationRequestSession)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};

/**
 * Placeholder class for the Conversation Request Session. Based off RequestSession.
 * TODO: define what telemetry is required.
 */
class ConversationRequestSession {
    constructor(sessionId) {
        this.privIsDisposed = false;
        this.privDetachables = new Array();
        this.privSessionId = sessionId;
        this.privRequestId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privRequestCompletionDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.Deferred();
    }
    get sessionId() {
        return this.privSessionId;
    }
    get requestId() {
        return this.privRequestId;
    }
    get completionPromise() {
        return this.privRequestCompletionDeferral.promise;
    }
    onPreConnectionStart(authFetchEventId, connectionId) {
        this.privSessionId = connectionId;
    }
    onAuthCompleted(isError) {
        if (isError) {
            this.onComplete();
        }
    }
    onConnectionEstablishCompleted(statusCode) {
        if (statusCode === 200) {
            return;
        }
        else if (statusCode === 403) {
            this.onComplete();
        }
    }
    onServiceTurnEndResponse(continuousRecognition) {
        if (!continuousRecognition) {
            this.onComplete();
        }
        else {
            this.privRequestId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        }
    }
    dispose() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.privIsDisposed) {
                // we should have completed by now. If we did not its an unknown error.
                this.privIsDisposed = true;
                for (const detachable of this.privDetachables) {
                    yield detachable.detach();
                }
            }
        });
    }
    onComplete() {
        //
    }
}

//# sourceMappingURL=ConversationRequestSession.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationServiceAdapter.js":
/*!******************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationServiceAdapter.js ***!
  \******************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationServiceAdapter": () => (/* binding */ ConversationServiceAdapter)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/IConnection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationCanceledEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationExpirationEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Translations.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveTokenAuthentication.js");
/* harmony import */ var _ConversationConnectionMessage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ConversationConnectionMessage */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionMessage.js");
/* harmony import */ var _ConversationRequestSession__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ConversationRequestSession */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationRequestSession.js");
/* harmony import */ var _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./ConversationTranslatorEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorEventArgs.js");
/* harmony import */ var _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./ConversationTranslatorInterfaces */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorInterfaces.js");
/* harmony import */ var _ServiceMessages_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ServiceMessages/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ServiceMessages/CommandResponsePayload.js");
/* harmony import */ var _ServiceMessages_Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./ServiceMessages/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ServiceMessages/ParticipantResponsePayload.js");
/* harmony import */ var _ServiceMessages_Exports__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./ServiceMessages/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ServiceMessages/TranslationResponsePayload.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};








/**
 * The service adapter handles sending and receiving messages to the Conversation Translator websocket.
 */
class ConversationServiceAdapter extends _Exports__WEBPACK_IMPORTED_MODULE_0__.ServiceRecognizerBase {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, conversationServiceConnector) {
        super(authentication, connectionFactory, audioSource, recognizerConfig, conversationServiceConnector);
        this.privConnectionConfigPromise = undefined;
        this.privLastPartialUtteranceId = "";
        this.privConversationServiceConnector = conversationServiceConnector;
        this.privConversationAuthentication = authentication;
        this.receiveMessageOverride = () => this.receiveConversationMessageOverride();
        this.recognizeOverride = () => this.noOp();
        this.postConnectImplOverride = (connection) => this.conversationConnectImpl(connection);
        this.configConnectionOverride = () => this.configConnection();
        this.disconnectOverride = () => this.privDisconnect();
        this.privConversationRequestSession = new _ConversationRequestSession__WEBPACK_IMPORTED_MODULE_1__.ConversationRequestSession((0,_common_Exports__WEBPACK_IMPORTED_MODULE_2__.createNoDashGuid)());
        this.privConversationConnectionFactory = connectionFactory;
        this.privConversationIsDisposed = false;
    }
    isDisposed() {
        return super.isDisposed() || this.privConversationIsDisposed;
    }
    dispose(reason) {
        const _super = Object.create(null, {
            dispose: { get: () => super.dispose }
        });
        return __awaiter(this, void 0, void 0, function* () {
            this.privConversationIsDisposed = true;
            if (this.privConnectionConfigPromise !== undefined) {
                const connection = yield this.privConnectionConfigPromise;
                yield connection.dispose(reason);
            }
            yield _super.dispose.call(this, reason);
        });
    }
    sendMessage(message) {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.fetchConnection();
            return connection.send(new _ConversationConnectionMessage__WEBPACK_IMPORTED_MODULE_3__.ConversationConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_4__.MessageType.Text, message));
        });
    }
    sendMessageAsync(message) {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.fetchConnection();
            yield connection.send(new _ConversationConnectionMessage__WEBPACK_IMPORTED_MODULE_3__.ConversationConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_4__.MessageType.Text, message));
        });
    }
    privDisconnect() {
        if (this.terminateMessageLoop) {
            return;
        }
        this.cancelRecognition(this.privConversationRequestSession.sessionId, this.privConversationRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode.NoError, "Disconnecting");
        this.terminateMessageLoop = true;
        return Promise.resolve();
    }
    // eslint-disable-next-line @typescript-eslint/require-await
    processTypeSpecificMessages() {
        return __awaiter(this, void 0, void 0, function* () {
            return true;
        });
    }
    // Cancels recognition.
    cancelRecognition(sessionId, requestId, cancellationReason, errorCode, error) {
        this.terminateMessageLoop = true;
        const cancelEvent = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.ConversationTranslationCanceledEventArgs(cancellationReason, error, errorCode, undefined, sessionId);
        try {
            if (!!this.privConversationServiceConnector.canceled) {
                this.privConversationServiceConnector.canceled(this.privConversationServiceConnector, cancelEvent);
            }
        }
        catch (_a) {
            // continue on error
        }
    }
    /**
     * Establishes a websocket connection to the end point.
     */
    conversationConnectImpl(connection) {
        return __awaiter(this, void 0, void 0, function* () {
            this.privConnectionLoop = this.startMessageLoop();
            return connection;
        });
    }
    /**
     * Process incoming websocket messages
     */
    receiveConversationMessageOverride() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.isDisposed() || this.terminateMessageLoop) {
                return Promise.resolve();
            }
            // we won't rely on the cascading promises of the connection since we want to continually be available to receive messages
            const communicationCustodian = new _common_Exports__WEBPACK_IMPORTED_MODULE_8__.Deferred();
            try {
                const connection = yield this.fetchConnection();
                const message = yield connection.read();
                if (this.isDisposed() || this.terminateMessageLoop) {
                    // We're done.
                    communicationCustodian.resolve();
                    return Promise.resolve();
                }
                if (!message) {
                    return this.receiveConversationMessageOverride();
                }
                const sessionId = this.privConversationRequestSession.sessionId;
                const conversationMessageType = message.conversationMessageType.toLowerCase();
                let sendFinal = false;
                try {
                    switch (conversationMessageType) {
                        case "info":
                        case "participant_command":
                        case "command":
                            const commandPayload = _ServiceMessages_Exports__WEBPACK_IMPORTED_MODULE_9__.CommandResponsePayload.fromJSON(message.textBody);
                            switch (commandPayload.command.toLowerCase()) {
                                /**
                                 * 'ParticpantList' is the first message sent to the user after the websocket connection has opened.
                                 * The consuming client must wait for this message to arrive
                                 * before starting to send their own data.
                                 */
                                case "participantlist":
                                    const participantsPayload = _ServiceMessages_Exports__WEBPACK_IMPORTED_MODULE_10__.ParticipantsListPayloadResponse.fromJSON(message.textBody);
                                    const participantsResult = participantsPayload.participants.map((p) => {
                                        const participant = {
                                            avatar: p.avatar,
                                            displayName: p.nickname,
                                            id: p.participantId,
                                            isHost: p.ishost,
                                            isMuted: p.ismuted,
                                            isUsingTts: p.usetts,
                                            preferredLanguage: p.locale
                                        };
                                        return participant;
                                    });
                                    if (!!this.privConversationServiceConnector.participantsListReceived) {
                                        this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ParticipantsListEventArgs(participantsPayload.roomid, participantsPayload.token, participantsPayload.translateTo, participantsPayload.profanityFilter, participantsPayload.roomProfanityFilter, participantsPayload.roomLocked, participantsPayload.muteAll, participantsResult, sessionId));
                                    }
                                    break;
                                /**
                                 * 'SetTranslateToLanguages' represents the list of languages being used in the Conversation by all users(?).
                                 * This is sent at the start of the Conversation
                                 */
                                case "settranslatetolanguages":
                                    if (!!this.privConversationServiceConnector.participantUpdateCommandReceived) {
                                        this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ParticipantAttributeEventArgs(commandPayload.participantId, _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_12__.ConversationTranslatorCommandTypes.setTranslateToLanguages, commandPayload.value, sessionId));
                                    }
                                    break;
                                /**
                                 * 'SetProfanityFiltering' lets the client set the level of profanity filtering.
                                 * If sent by the participant the setting will effect only their own profanity level.
                                 * If sent by the host, the setting will effect all participants including the host.
                                 * Note: the profanity filters differ from Speech Service (?): 'marked', 'raw', 'removed', 'tagged'
                                 */
                                case "setprofanityfiltering":
                                    if (!!this.privConversationServiceConnector.participantUpdateCommandReceived) {
                                        this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ParticipantAttributeEventArgs(commandPayload.participantId, _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_12__.ConversationTranslatorCommandTypes.setProfanityFiltering, commandPayload.value, sessionId));
                                    }
                                    break;
                                /**
                                 * 'SetMute' is sent if the participant has been muted by the host.
                                 * Check the 'participantId' to determine if the current user has been muted.
                                 */
                                case "setmute":
                                    if (!!this.privConversationServiceConnector.participantUpdateCommandReceived) {
                                        this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ParticipantAttributeEventArgs(commandPayload.participantId, _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_12__.ConversationTranslatorCommandTypes.setMute, commandPayload.value, sessionId));
                                    }
                                    break;
                                /**
                                 * 'SetMuteAll' is sent if the Conversation has been muted by the host.
                                 */
                                case "setmuteall":
                                    if (!!this.privConversationServiceConnector.muteAllCommandReceived) {
                                        this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.MuteAllEventArgs(commandPayload.value, sessionId));
                                    }
                                    break;
                                /**
                                 * 'RoomExpirationWarning' is sent towards the end of the Conversation session to give a timeout warning.
                                 */
                                case "roomexpirationwarning":
                                    if (!!this.privConversationServiceConnector.conversationExpiration) {
                                        this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector, new _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__.ConversationExpirationEventArgs(commandPayload.value, this.privConversationRequestSession.sessionId));
                                    }
                                    break;
                                /**
                                 * 'SetUseTts' is sent as a confirmation if the user requests TTS to be turned on or off.
                                 */
                                case "setusetts":
                                    if (!!this.privConversationServiceConnector.participantUpdateCommandReceived) {
                                        this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ParticipantAttributeEventArgs(commandPayload.participantId, _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_12__.ConversationTranslatorCommandTypes.setUseTTS, commandPayload.value, sessionId));
                                    }
                                    break;
                                /**
                                 * 'SetLockState' is set if the host has locked or unlocked the Conversation.
                                 */
                                case "setlockstate":
                                    if (!!this.privConversationServiceConnector.lockRoomCommandReceived) {
                                        this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.LockRoomEventArgs(commandPayload.value, sessionId));
                                    }
                                    break;
                                /**
                                 * 'ChangeNickname' is received if a user changes their display name.
                                 * Any cached particpiants list should be updated to reflect the display name.
                                 */
                                case "changenickname":
                                    if (!!this.privConversationServiceConnector.participantUpdateCommandReceived) {
                                        this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ParticipantAttributeEventArgs(commandPayload.participantId, _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_12__.ConversationTranslatorCommandTypes.changeNickname, commandPayload.nickname, sessionId));
                                    }
                                    break;
                                /**
                                 * 'JoinSession' is sent when a user joins the Conversation.
                                 */
                                case "joinsession":
                                    const joinParticipantPayload = _ServiceMessages_Exports__WEBPACK_IMPORTED_MODULE_10__.ParticipantPayloadResponse.fromJSON(message.textBody);
                                    const joiningParticipant = {
                                        avatar: joinParticipantPayload.avatar,
                                        displayName: joinParticipantPayload.nickname,
                                        id: joinParticipantPayload.participantId,
                                        isHost: joinParticipantPayload.ishost,
                                        isMuted: joinParticipantPayload.ismuted,
                                        isUsingTts: joinParticipantPayload.usetts,
                                        preferredLanguage: joinParticipantPayload.locale,
                                    };
                                    if (!!this.privConversationServiceConnector.participantJoinCommandReceived) {
                                        this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ParticipantEventArgs(joiningParticipant, sessionId));
                                    }
                                    break;
                                /**
                                 * 'LeaveSession' is sent when a user leaves the Conversation'.
                                 */
                                case "leavesession":
                                    const leavingParticipant = {
                                        id: commandPayload.participantId
                                    };
                                    if (!!this.privConversationServiceConnector.participantLeaveCommandReceived) {
                                        this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ParticipantEventArgs(leavingParticipant, sessionId));
                                    }
                                    break;
                                /**
                                 * 'DisconnectSession' is sent when a user is disconnected from the session (e.g. network problem).
                                 * Check the 'ParticipantId' to check whether the message is for the current user.
                                 */
                                case "disconnectsession":
                                    // eslint-disable-next-line @typescript-eslint/no-unused-vars
                                    const disconnectParticipant = {
                                        id: commandPayload.participantId
                                    };
                                    break;
                                case "token":
                                    const token = new _Exports__WEBPACK_IMPORTED_MODULE_14__.CognitiveTokenAuthentication(() => {
                                        const authorizationToken = commandPayload.token;
                                        return Promise.resolve(authorizationToken);
                                    }, () => {
                                        const authorizationToken = commandPayload.token;
                                        return Promise.resolve(authorizationToken);
                                    });
                                    this.authentication = token;
                                    break;
                                /**
                                 * Message not recognized.
                                 */
                                default:
                                    break;
                            }
                            break;
                        /**
                         * 'partial' (or 'hypothesis') represents a unfinalized speech message.
                         */
                        case "partial":
                        /**
                         * 'final' (or 'phrase') represents a finalized speech message.
                         */
                        case "final":
                            const speechPayload = _ServiceMessages_Exports__WEBPACK_IMPORTED_MODULE_15__.SpeechResponsePayload.fromJSON(message.textBody);
                            const conversationResultReason = (conversationMessageType === "final") ? _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__.ResultReason.TranslatedParticipantSpeech : _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__.ResultReason.TranslatingParticipantSpeech;
                            const speechResult = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_17__.ConversationTranslationResult(speechPayload.participantId, this.getTranslations(speechPayload.translations), speechPayload.language, speechPayload.id, conversationResultReason, speechPayload.recognition, undefined, undefined, message.textBody, undefined);
                            if (speechPayload.isFinal) {
                                // check the length, sometimes empty finals are returned
                                if (speechResult.text !== undefined && speechResult.text.length > 0) {
                                    sendFinal = true;
                                }
                                else if (speechPayload.id === this.privLastPartialUtteranceId) {
                                    // send final as normal. We had a non-empty partial for this same utterance
                                    // so sending the empty final is important
                                    sendFinal = true;
                                }
                                else {
                                    // suppress unneeded final
                                }
                                if (sendFinal) {
                                    if (!!this.privConversationServiceConnector.translationReceived) {
                                        this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ConversationReceivedTranslationEventArgs(_ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_12__.ConversationTranslatorMessageTypes.final, speechResult, sessionId));
                                    }
                                }
                            }
                            else if (speechResult.text !== undefined) {
                                this.privLastPartialUtteranceId = speechPayload.id;
                                if (!!this.privConversationServiceConnector.translationReceived) {
                                    this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ConversationReceivedTranslationEventArgs(_ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_12__.ConversationTranslatorMessageTypes.partial, speechResult, sessionId));
                                }
                            }
                            break;
                        /**
                         * "translated_message" is a text message or instant message (IM).
                         */
                        case "translated_message":
                            const textPayload = _ServiceMessages_Exports__WEBPACK_IMPORTED_MODULE_15__.TextResponsePayload.fromJSON(message.textBody);
                            // TODO: (Native parity) a result reason should be set based whether the participantId is ours or not
                            const textResult = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_17__.ConversationTranslationResult(textPayload.participantId, this.getTranslations(textPayload.translations), textPayload.language, undefined, undefined, textPayload.originalText, undefined, undefined, undefined, message.textBody, undefined);
                            if (!!this.privConversationServiceConnector.translationReceived) {
                                this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ConversationReceivedTranslationEventArgs(_ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_12__.ConversationTranslatorMessageTypes.instantMessage, textResult, sessionId));
                            }
                            break;
                        default:
                            // ignore any unsupported message types
                            break;
                    }
                }
                catch (e) {
                    // continue
                }
                return this.receiveConversationMessageOverride();
            }
            catch (e) {
                this.terminateMessageLoop = true;
            }
            return communicationCustodian.promise;
        });
    }
    startMessageLoop() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.isDisposed()) {
                return Promise.resolve();
            }
            this.terminateMessageLoop = false;
            const messageRetrievalPromise = this.receiveConversationMessageOverride();
            try {
                const r = yield messageRetrievalPromise;
                return r;
            }
            catch (error) {
                this.cancelRecognition(this.privRequestSession ? this.privRequestSession.sessionId : "", this.privRequestSession ? this.privRequestSession.requestId : "", _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode.RuntimeError, error);
                return null;
            }
        });
    }
    // Takes an established websocket connection to the endpoint
    configConnection() {
        if (this.isDisposed()) {
            return Promise.resolve(undefined);
        }
        if (this.privConnectionConfigPromise !== undefined) {
            return this.privConnectionConfigPromise.then((connection) => {
                if (connection.state() === _common_Exports__WEBPACK_IMPORTED_MODULE_18__.ConnectionState.Disconnected) {
                    this.privConnectionId = null;
                    this.privConnectionConfigPromise = undefined;
                    return this.configConnection();
                }
                return this.privConnectionConfigPromise;
            }, () => {
                this.privConnectionId = null;
                this.privConnectionConfigPromise = undefined;
                return this.configConnection();
            });
        }
        if (this.terminateMessageLoop) {
            return Promise.resolve(undefined);
        }
        this.privConnectionConfigPromise = this.connectImpl().then((connection) => connection);
        return this.privConnectionConfigPromise;
    }
    getTranslations(serviceResultTranslations) {
        let translations;
        if (undefined !== serviceResultTranslations) {
            translations = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_19__.Translations();
            for (const translation of serviceResultTranslations) {
                translations.set(translation.lang, translation.translation);
            }
        }
        return translations;
    }
}

//# sourceMappingURL=ConversationServiceAdapter.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorConnectionFactory.js":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorConnectionFactory.js ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationTranslatorConnectionFactory": () => (/* binding */ ConversationTranslatorConnectionFactory)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/RestConfigBase.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js");
/* harmony import */ var _common_StringUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/StringUtils */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/StringUtils.js");
/* harmony import */ var _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../sdk/Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
/* harmony import */ var _QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../QueryParameterNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/QueryParameterNames.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./../ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranscriberConnectionFactory.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationConnectionFactory.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.








/**
 * Connection factory for the conversation translator. Handles connecting to the regular translator endpoint,
 * as well as the virtual microphone array transcription endpoint
 */
class ConversationTranslatorConnectionFactory extends _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase {
    constructor(convGetter) {
        super();
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(convGetter, "convGetter");
        this.privConvGetter = convGetter;
    }
    create(config, authInfo, connectionId) {
        const isVirtMicArrayEndpoint = config.parameters.getProperty("ConversationTranslator_MultiChannelAudio", "").toUpperCase() === "TRUE";
        const convInfo = this.privConvGetter().room;
        const region = convInfo.cognitiveSpeechRegion || config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Region, "");
        const replacementValues = {
            hostSuffix: _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase.getHostSuffix(region),
            path: ConversationTranslatorConnectionFactory.CTS_VIRT_MIC_PATH,
            region: encodeURIComponent(region)
        };
        replacementValues[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.Language] = encodeURIComponent(config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage, ""));
        replacementValues[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CtsMeetingId] = encodeURIComponent(convInfo.roomId);
        replacementValues[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CtsDeviceId] = encodeURIComponent(convInfo.participantId);
        replacementValues[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CtsIsParticipant] = convInfo.isHost ? "" : ("&" + _QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CtsIsParticipant);
        let endpointUrl = "";
        const queryParams = {};
        const headers = {};
        if (isVirtMicArrayEndpoint) {
            // connecting to the conversation transcription virtual microphone array endpoint
            endpointUrl = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Endpoint);
            if (!endpointUrl) {
                const hostName = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Host, "transcribe.{region}.cts.speech{hostSuffix}");
                endpointUrl = "wss://" + hostName + "{path}";
            }
            // because the region can change during a session, we support being passed a format string which we can then
            // replace with the correct information.
            endpointUrl = _common_StringUtils__WEBPACK_IMPORTED_MODULE_4__.StringUtils.formatString(endpointUrl, replacementValues);
            const parsedUrl = new URL(endpointUrl);
            parsedUrl.searchParams.forEach((val, key) => {
                queryParams[key] = val;
            });
            const connFactory = new _Exports__WEBPACK_IMPORTED_MODULE_5__.TranscriberConnectionFactory();
            connFactory.setQueryParams(queryParams, config, endpointUrl);
            // Some query parameters are required for the CTS endpoint, let's explicity set them here
            queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CtsMeetingId] = replacementValues[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CtsMeetingId];
            queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CtsDeviceId] = replacementValues[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CtsDeviceId];
            if (!convInfo.isHost) {
                queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CtsIsParticipant] = ""; // this doesn't have a value so set to an empty string
            }
            if (!(_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.Format in queryParams)) {
                queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.Format] = "simple";
            }
            parsedUrl.searchParams.forEach((val, key) => {
                parsedUrl.searchParams.set(key, queryParams[key]);
                delete queryParams[key];
            });
            endpointUrl = parsedUrl.toString();
        }
        else {
            // connecting to regular translation endpoint
            const connFactory = new _Exports__WEBPACK_IMPORTED_MODULE_6__.TranslationConnectionFactory();
            endpointUrl = connFactory.getEndpointUrl(config, true);
            endpointUrl = _common_StringUtils__WEBPACK_IMPORTED_MODULE_4__.StringUtils.formatString(endpointUrl, replacementValues);
            connFactory.setQueryParams(queryParams, config, endpointUrl);
        }
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_7__.HeaderNames.ConnectionId] = connectionId;
        headers[_common_browser_Exports__WEBPACK_IMPORTED_MODULE_8__.RestConfigBase.configParams.token] = convInfo.token;
        if (authInfo.token) {
            headers[authInfo.headerName] = authInfo.token;
        }
        const enableCompression = config.parameters.getProperty("SPEECH-EnableWebsocketCompression", "").toUpperCase() === "TRUE";
        return new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_9__.WebsocketConnection(endpointUrl, queryParams, headers, new _Exports__WEBPACK_IMPORTED_MODULE_10__.WebsocketMessageFormatter(), _common_browser_Exports__WEBPACK_IMPORTED_MODULE_11__.ProxyInfo.fromRecognizerConfig(config), enableCompression, connectionId);
    }
}
ConversationTranslatorConnectionFactory.CTS_VIRT_MIC_PATH = "/speech/recognition/dynamicaudio";

//# sourceMappingURL=ConversationTranslatorConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorEventArgs.js":
/*!***********************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorEventArgs.js ***!
  \***********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationReceivedTranslationEventArgs": () => (/* binding */ ConversationReceivedTranslationEventArgs),
/* harmony export */   "LockRoomEventArgs": () => (/* binding */ LockRoomEventArgs),
/* harmony export */   "MuteAllEventArgs": () => (/* binding */ MuteAllEventArgs),
/* harmony export */   "ParticipantAttributeEventArgs": () => (/* binding */ ParticipantAttributeEventArgs),
/* harmony export */   "ParticipantEventArgs": () => (/* binding */ ParticipantEventArgs),
/* harmony export */   "ParticipantsListEventArgs": () => (/* binding */ ParticipantsListEventArgs)
/* harmony export */ });
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */

class MuteAllEventArgs extends _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    constructor(isMuted, sessionId) {
        super(sessionId);
        this.privIsMuted = isMuted;
    }
    get isMuted() {
        return this.privIsMuted;
    }
}
class LockRoomEventArgs extends _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    constructor(isLocked, sessionId) {
        super(sessionId);
        this.privIsLocked = isLocked;
    }
    get isMuted() {
        return this.privIsLocked;
    }
}
class ParticipantEventArgs extends _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    constructor(participant, sessionId) {
        super(sessionId);
        this.privParticipant = participant;
    }
    get participant() {
        return this.privParticipant;
    }
}
class ParticipantAttributeEventArgs extends _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    constructor(participantId, key, value, sessionId) {
        super(sessionId);
        this.privKey = key;
        this.privValue = value;
        this.privParticipantId = participantId;
    }
    get value() {
        return this.privValue;
    }
    get key() {
        return this.privKey;
    }
    get id() {
        return this.privParticipantId;
    }
}
class ParticipantsListEventArgs extends _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    constructor(conversationId, token, translateTo, profanityFilter, roomProfanityFilter, isRoomLocked, isMuteAll, participants, sessionId) {
        super(sessionId);
        this.privRoomId = conversationId;
        this.privSessionToken = token;
        this.privTranslateTo = translateTo;
        this.privProfanityFilter = profanityFilter;
        this.privRoomProfanityFilter = roomProfanityFilter;
        this.privIsRoomLocked = isRoomLocked;
        this.privIsRoomLocked = isMuteAll;
        this.privParticipants = participants;
    }
    get sessionToken() {
        return this.privSessionToken;
    }
    get conversationId() {
        return this.privRoomId;
    }
    get translateTo() {
        return this.privTranslateTo;
    }
    get profanityFilter() {
        return this.privProfanityFilter;
    }
    get roomProfanityFilter() {
        return this.privRoomProfanityFilter;
    }
    get isRoomLocked() {
        return this.privIsRoomLocked;
    }
    get isMuteAll() {
        return this.privIsMuteAll;
    }
    get participants() {
        return this.privParticipants;
    }
}
class ConversationReceivedTranslationEventArgs {
    constructor(command, payload, sessionId) {
        this.privPayload = payload;
        this.privCommand = command;
        this.privSessionId = sessionId;
    }
    get payload() {
        return this.privPayload;
    }
    get command() {
        return this.privCommand;
    }
    get sessionId() {
        return this.privSessionId;
    }
}

//# sourceMappingURL=ConversationTranslatorEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorInterfaces.js":
/*!************************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorInterfaces.js ***!
  \************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationTranslatorCommandTypes": () => (/* binding */ ConversationTranslatorCommandTypes),
/* harmony export */   "ConversationTranslatorMessageTypes": () => (/* binding */ ConversationTranslatorMessageTypes),
/* harmony export */   "InternalParticipants": () => (/* binding */ InternalParticipants)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/** Users participating in the conversation */
class InternalParticipants {
    constructor(participants = [], meId) {
        this.participants = participants;
        this.meId = meId;
    }
    /**
     * Add or update a participant
     * @param value
     */
    addOrUpdateParticipant(value) {
        if (value === undefined) {
            return;
        }
        const exists = this.getParticipantIndex(value.id);
        if (exists > -1) {
            this.participants.splice(exists, 1, value);
        }
        else {
            this.participants.push(value);
        }
        // ensure it was added ok
        return this.getParticipant(value.id);
    }
    /**
     * Find the participant's position in the participants list.
     * @param id
     */
    getParticipantIndex(id) {
        return this.participants.findIndex((p) => p.id === id);
    }
    /**
     * Find the participant by id.
     * @param id
     */
    getParticipant(id) {
        return this.participants.find((p) => p.id === id);
    }
    /**
     * Remove a participant from the participants list.
     */
    deleteParticipant(id) {
        this.participants = this.participants.filter((p) => p.id !== id);
    }
    /**
     * Helper to return the conversation host.
     */
    get host() {
        return this.participants.find((p) => p.isHost === true);
    }
    /**
     * Helper to return the current user.
     */
    get me() {
        return this.getParticipant(this.meId);
    }
}
/**
 * List of command message types
 */
const ConversationTranslatorMessageTypes = {
    command: "command",
    final: "final",
    info: "info",
    instantMessage: "instant_message",
    keepAlive: "keep_alive",
    partial: "partial",
    participantCommand: "participant_command",
    translatedMessage: "translated_message"
};
/**
 * List of command types
 */
const ConversationTranslatorCommandTypes = {
    changeNickname: "ChangeNickname",
    disconnectSession: "DisconnectSession",
    ejectParticipant: "EjectParticipant",
    instant_message: "instant_message",
    joinSession: "JoinSession",
    leaveSession: "LeaveSession",
    participantList: "ParticipantList",
    roomExpirationWarning: "RoomExpirationWarning",
    setLockState: "SetLockState",
    setMute: "SetMute",
    setMuteAll: "SetMuteAll",
    setProfanityFiltering: "SetProfanityFiltering",
    setTranslateToLanguages: "SetTranslateToLanguages",
    setUseTTS: "SetUseTTS"
};

//# sourceMappingURL=ConversationTranslatorInterfaces.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorRecognizer.js":
/*!************************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorRecognizer.js ***!
  \************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationRecognizerFactory": () => (/* binding */ ConversationRecognizerFactory),
/* harmony export */   "ConversationTranslatorRecognizer": () => (/* binding */ ConversationTranslatorRecognizer)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Timeout.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/BackgroundError.js");
/* harmony import */ var _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../sdk/Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Connection.js");
/* harmony import */ var _ConversationConnectionFactory__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ConversationConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionFactory.js");
/* harmony import */ var _ConversationServiceAdapter__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./ConversationServiceAdapter */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationServiceAdapter.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
// eslint-disable-next-line max-classes-per-file






class ConversationRecognizerFactory {
    static fromConfig(conversation, speechConfig, audioConfig) {
        return new ConversationTranslatorRecognizer(conversation, speechConfig, audioConfig);
    }
}
/**
 * Sends messages to the Conversation Translator websocket and listens for incoming events containing websocket messages.
 * Based off the recognizers in the SDK folder.
 */
class ConversationTranslatorRecognizer extends _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.Recognizer {
    constructor(conversation, speechConfig, audioConfig) {
        const serviceConfigImpl = speechConfig;
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(serviceConfigImpl, "speechConfig");
        const conversationImpl = conversation;
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(conversationImpl, "conversationImpl");
        super(audioConfig, serviceConfigImpl.properties, new _ConversationConnectionFactory__WEBPACK_IMPORTED_MODULE_2__.ConversationConnectionFactory());
        this.privConversation = conversationImpl;
        this.privIsDisposed = false;
        this.privProperties = serviceConfigImpl.properties.clone();
        this.privConnection = _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.Connection.fromRecognizer(this);
        this.privSetTimeout = (typeof (Blob) !== "undefined" && typeof (Worker) !== "undefined") ? _common_Exports__WEBPACK_IMPORTED_MODULE_4__.Timeout.setTimeout : setTimeout;
        this.privClearTimeout = (typeof (Blob) !== "undefined" && typeof (Worker) !== "undefined") ? _common_Exports__WEBPACK_IMPORTED_MODULE_4__.Timeout.clearTimeout : clearTimeout;
    }
    set connected(cb) {
        this.privConnection.connected = cb;
    }
    set disconnected(cb) {
        this.privConnection.disconnected = cb;
    }
    /**
     * Return the speech language used by the recognizer
     */
    get speechRecognitionLanguage() {
        return this.privSpeechRecognitionLanguage;
    }
    /**
     * Return the properties for the recognizer
     */
    get properties() {
        return this.privProperties;
    }
    isDisposed() {
        return this.privIsDisposed;
    }
    /**
     * Connect to the recognizer
     * @param token
     */
    connect(token, cb, err) {
        try {
            _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privIsDisposed);
            _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(token, "token");
            this.privReco.conversationTranslatorToken = token;
            this.resetConversationTimeout();
            this.privReco.connectAsync(cb, err);
        }
        catch (error) {
            if (!!err) {
                if (error instanceof Error) {
                    const typedError = error;
                    err(typedError.name + ": " + typedError.message);
                }
                else {
                    err(error);
                }
            }
        }
    }
    /**
     * Disconnect from the recognizer
     */
    disconnect(cb, err) {
        try {
            _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privIsDisposed);
            if (this.privTimeoutToken !== undefined) {
                // eslint-disable-next-line @typescript-eslint/no-unsafe-argument
                this.privClearTimeout(this.privTimeoutToken);
            }
            this.privReco.disconnect().then(() => {
                if (!!cb) {
                    cb();
                }
            }, (error) => {
                if (!!err) {
                    err(error);
                }
            });
        }
        catch (error) {
            if (!!err) {
                if (error instanceof Error) {
                    const typedError = error;
                    err(typedError.name + ": " + typedError.message);
                }
                else {
                    err(error);
                }
            }
            // Destroy the recognizer.
            this.dispose(true).catch((reason) => {
                _common_Exports__WEBPACK_IMPORTED_MODULE_5__.Events.instance.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_6__.BackgroundEvent(reason));
            });
        }
    }
    /**
     * Send the mute all participants command to the websocket
     * @param conversationId
     * @param participantId
     * @param isMuted
     */
    sendRequest(command, cb, err) {
        try {
            _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privIsDisposed);
            this.sendMessage(command, cb, err);
        }
        catch (error) {
            if (!!err) {
                if (error instanceof Error) {
                    const typedError = error;
                    err(typedError.name + ": " + typedError.message);
                }
                else {
                    err(error);
                }
            }
            // Destroy the recognizer.
            this.dispose(true).catch((reason) => {
                _common_Exports__WEBPACK_IMPORTED_MODULE_5__.Events.instance.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_6__.BackgroundEvent(reason));
            });
        }
    }
    /**
     * Close and dispose the recognizer
     */
    close() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.privIsDisposed) {
                if (!!this.privConnection) {
                    this.privConnection.closeConnection();
                    this.privConnection.close();
                }
                this.privConnection = undefined;
                yield this.dispose(true);
            }
        });
    }
    /**
     * Dispose the recognizer
     * @param disposing
     */
    dispose(disposing) {
        const _super = Object.create(null, {
            dispose: { get: () => super.dispose }
        });
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privIsDisposed) {
                return;
            }
            if (disposing) {
                if (this.privTimeoutToken !== undefined) {
                    // eslint-disable-next-line @typescript-eslint/no-unsafe-argument
                    this.privClearTimeout(this.privTimeoutToken);
                }
                this.privIsDisposed = true;
                if (!!this.privConnection) {
                    this.privConnection.closeConnection();
                    this.privConnection.close();
                    this.privConnection = undefined;
                }
                yield _super.dispose.call(this, disposing);
            }
        });
    }
    /**
     * Create the config for the recognizer
     * @param speechConfig
     */
    createRecognizerConfig(speechConfig) {
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__.RecognizerConfig(speechConfig, this.privProperties);
    }
    /**
     * Create the service recognizer.
     * The audio source is redundnant here but is required by the implementation.
     * @param authentication
     * @param connectionFactory
     * @param audioConfig
     * @param recognizerConfig
     */
    createServiceRecognizer(authentication, connectionFactory, audioConfig, recognizerConfig) {
        const audioSource = audioConfig;
        return new _ConversationServiceAdapter__WEBPACK_IMPORTED_MODULE_8__.ConversationServiceAdapter(authentication, connectionFactory, audioSource, recognizerConfig, this);
    }
    sendMessage(msg, cb, err) {
        const withAsync = this.privReco;
        const PromiseToEmptyCallback = (promise, cb, err) => {
            if (promise !== undefined) {
                promise.then(() => {
                    try {
                        if (!!cb) {
                            cb();
                        }
                    }
                    catch (e) {
                        if (!!err) {
                            err(`'Unhandled error on promise callback: ${e}'`);
                        }
                    }
                }, (reason) => {
                    try {
                        if (!!err) {
                            err(reason);
                        }
                        // eslint-disable-next-line no-empty
                    }
                    catch (error) { }
                });
            }
            else {
                if (!!err) {
                    err("Null promise");
                }
            }
        };
        PromiseToEmptyCallback(withAsync.sendMessageAsync(msg), cb, err);
        this.resetConversationTimeout();
    }
    resetConversationTimeout() {
        if (this.privTimeoutToken !== undefined) {
            // eslint-disable-next-line @typescript-eslint/no-unsafe-argument
            this.privClearTimeout(this.privTimeoutToken);
        }
        this.privTimeoutToken = this.privSetTimeout(() => {
            this.sendRequest(this.privConversation.getKeepAlive());
        }, 60000);
    }
}

//# sourceMappingURL=ConversationTranslatorRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationWebsocketMessageFormatter.js":
/*!*****************************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationWebsocketMessageFormatter.js ***!
  \*****************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationWebsocketMessageFormatter": () => (/* binding */ ConversationWebsocketMessageFormatter)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/RawWebsocketMessage.js");
/* harmony import */ var _ConversationConnectionMessage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ConversationConnectionMessage */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionMessage.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


/**
 * Based off WebsocketMessageFormatter. The messages for Conversation Translator have some variations from the Speech messages.
 */
class ConversationWebsocketMessageFormatter {
    /**
     * Format incoming messages: text (speech partial/final, IM) or binary (tts)
     */
    toConnectionMessage(message) {
        const deferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.Deferred();
        try {
            if (message.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Text) {
                const incomingMessage = new _ConversationConnectionMessage__WEBPACK_IMPORTED_MODULE_2__.ConversationConnectionMessage(message.messageType, message.textContent, {}, message.id);
                deferral.resolve(incomingMessage);
            }
            else if (message.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Binary) {
                deferral.resolve(new _ConversationConnectionMessage__WEBPACK_IMPORTED_MODULE_2__.ConversationConnectionMessage(message.messageType, message.binaryContent, undefined, message.id));
            }
        }
        catch (e) {
            deferral.reject(`Error formatting the message. Error: ${e}`);
        }
        return deferral.promise;
    }
    /**
     * Format outgoing messages: text (commands or IM)
     */
    fromConnectionMessage(message) {
        const deferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.Deferred();
        try {
            if (message.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Text) {
                const payload = `${message.textBody ? message.textBody : ""}`;
                deferral.resolve(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.RawWebsocketMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Text, payload, message.id));
            }
        }
        catch (e) {
            deferral.reject(`Error formatting the message. ${e}`);
        }
        return deferral.promise;
    }
}

//# sourceMappingURL=ConversationWebsocketMessageFormatter.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/Exports.js":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/Exports.js ***!
  \***********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationConnectionConfig": () => (/* reexport safe */ _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_1__.ConversationConnectionConfig),
/* harmony export */   "ConversationManager": () => (/* reexport safe */ _ConversationManager__WEBPACK_IMPORTED_MODULE_0__.ConversationManager),
/* harmony export */   "ConversationReceivedTranslationEventArgs": () => (/* reexport safe */ _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_4__.ConversationReceivedTranslationEventArgs),
/* harmony export */   "ConversationRecognizerFactory": () => (/* reexport safe */ _ConversationTranslatorRecognizer__WEBPACK_IMPORTED_MODULE_2__.ConversationRecognizerFactory),
/* harmony export */   "ConversationTranslatorCommandTypes": () => (/* reexport safe */ _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_5__.ConversationTranslatorCommandTypes),
/* harmony export */   "ConversationTranslatorMessageTypes": () => (/* reexport safe */ _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_5__.ConversationTranslatorMessageTypes),
/* harmony export */   "InternalParticipants": () => (/* reexport safe */ _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_5__.InternalParticipants),
/* harmony export */   "LockRoomEventArgs": () => (/* reexport safe */ _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_4__.LockRoomEventArgs),
/* harmony export */   "MuteAllEventArgs": () => (/* reexport safe */ _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_4__.MuteAllEventArgs),
/* harmony export */   "ParticipantAttributeEventArgs": () => (/* reexport safe */ _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_4__.ParticipantAttributeEventArgs),
/* harmony export */   "ParticipantEventArgs": () => (/* reexport safe */ _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_4__.ParticipantEventArgs),
/* harmony export */   "ParticipantsListEventArgs": () => (/* reexport safe */ _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_4__.ParticipantsListEventArgs),
/* harmony export */   "TranscriberRecognizer": () => (/* reexport safe */ _TranscriberRecognizer__WEBPACK_IMPORTED_MODULE_3__.TranscriberRecognizer)
/* harmony export */ });
/* harmony import */ var _ConversationManager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ConversationManager */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationManager.js");
/* harmony import */ var _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ConversationConnectionConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionConfig.js");
/* harmony import */ var _ConversationTranslatorRecognizer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ConversationTranslatorRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorRecognizer.js");
/* harmony import */ var _TranscriberRecognizer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TranscriberRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/TranscriberRecognizer.js");
/* harmony import */ var _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ConversationTranslatorEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorEventArgs.js");
/* harmony import */ var _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ConversationTranslatorInterfaces */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorInterfaces.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.







//# sourceMappingURL=Exports.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ServiceMessages/CommandResponsePayload.js":
/*!******************************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ServiceMessages/CommandResponsePayload.js ***!
  \******************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CommandResponsePayload": () => (/* binding */ CommandResponsePayload)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
const parseCommandResponse = (json) => JSON.parse(json);
class CommandResponsePayload {
    constructor(json) {
        this.privCommandResponse = parseCommandResponse(json);
    }
    get type() {
        return this.privCommandResponse.type;
    }
    get command() {
        return this.privCommandResponse.command;
    }
    get id() {
        return this.privCommandResponse.id;
    }
    get nickname() {
        return this.privCommandResponse.nickname;
    }
    get participantId() {
        return this.privCommandResponse.participantId;
    }
    get roomid() {
        return this.privCommandResponse.roomid;
    }
    get value() {
        return this.privCommandResponse.value;
    }
    get token() {
        return this.privCommandResponse.token;
    }
    static fromJSON(json) {
        return new CommandResponsePayload(json);
    }
}

//# sourceMappingURL=CommandResponsePayload.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ServiceMessages/ParticipantResponsePayload.js":
/*!**********************************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ServiceMessages/ParticipantResponsePayload.js ***!
  \**********************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ParticipantPayloadResponse": () => (/* binding */ ParticipantPayloadResponse),
/* harmony export */   "ParticipantsListPayloadResponse": () => (/* binding */ ParticipantsListPayloadResponse)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
const parseListResponse = (json) => JSON.parse(json);
const parseParticipantResponse = (json) => JSON.parse(json);
class ParticipantsListPayloadResponse {
    constructor(json) {
        this.privParticipantsPayloadResponse = parseListResponse(json);
    }
    get roomid() {
        return this.privParticipantsPayloadResponse.roomid;
    }
    get id() {
        return this.privParticipantsPayloadResponse.id;
    }
    get command() {
        return this.privParticipantsPayloadResponse.command;
    }
    get participants() {
        return this.privParticipantsPayloadResponse.participants;
    }
    get token() {
        return this.privParticipantsPayloadResponse.token;
    }
    get translateTo() {
        return this.privParticipantsPayloadResponse.translateTo;
    }
    get profanityFilter() {
        return this.privParticipantsPayloadResponse.profanityFilter;
    }
    get roomProfanityFilter() {
        return this.privParticipantsPayloadResponse.roomProfanityFilter;
    }
    get roomLocked() {
        return this.privParticipantsPayloadResponse.roomLocked;
    }
    get muteAll() {
        return this.privParticipantsPayloadResponse.muteAll;
    }
    get type() {
        return this.privParticipantsPayloadResponse.type;
    }
    static fromJSON(json) {
        return new ParticipantsListPayloadResponse(json);
    }
}
class ParticipantPayloadResponse {
    constructor(json) {
        this.privParticipantPayloadResponse = parseParticipantResponse(json);
    }
    get nickname() {
        return this.privParticipantPayloadResponse.nickname;
    }
    get locale() {
        return this.privParticipantPayloadResponse.locale;
    }
    get usetts() {
        return this.privParticipantPayloadResponse.usetts;
    }
    get ismuted() {
        return this.privParticipantPayloadResponse.ismuted;
    }
    get ishost() {
        return this.privParticipantPayloadResponse.ishost;
    }
    get participantId() {
        return this.privParticipantPayloadResponse.participantId;
    }
    get avatar() {
        return this.privParticipantPayloadResponse.avatar;
    }
    static fromJSON(json) {
        return new ParticipantPayloadResponse(json);
    }
}

//# sourceMappingURL=ParticipantResponsePayload.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ServiceMessages/TranslationResponsePayload.js":
/*!**********************************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ServiceMessages/TranslationResponsePayload.js ***!
  \**********************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechResponsePayload": () => (/* binding */ SpeechResponsePayload),
/* harmony export */   "TextResponsePayload": () => (/* binding */ TextResponsePayload)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
const parseSpeechResponse = (json) => JSON.parse(json);
const parseTextResponse = (json) => JSON.parse(json);
class SpeechResponsePayload {
    constructor(json) {
        this.privSpeechResponse = parseSpeechResponse(json);
    }
    get recognition() {
        return this.privSpeechResponse.recognition;
    }
    get translations() {
        return this.privSpeechResponse.translations;
    }
    get id() {
        return this.privSpeechResponse.id;
    }
    get language() {
        return this.privSpeechResponse.language;
    }
    get nickname() {
        return this.privSpeechResponse.nickname;
    }
    get participantId() {
        return this.privSpeechResponse.participantId;
    }
    get roomid() {
        return this.privSpeechResponse.roomid;
    }
    get timestamp() {
        return this.privSpeechResponse.timestamp;
    }
    get type() {
        return this.privSpeechResponse.type;
    }
    get isFinal() {
        return this.privSpeechResponse.type === "final";
    }
    static fromJSON(json) {
        return new SpeechResponsePayload(json);
    }
}
class TextResponsePayload {
    constructor(json) {
        this.privTextResponse = parseTextResponse(json);
    }
    get originalText() {
        return this.privTextResponse.originalText;
    }
    get translations() {
        return this.privTextResponse.translations;
    }
    get id() {
        return this.privTextResponse.id;
    }
    get language() {
        return this.privTextResponse.language;
    }
    get nickname() {
        return this.privTextResponse.nickname;
    }
    get participantId() {
        return this.privTextResponse.participantId;
    }
    get roomid() {
        return this.privTextResponse.roomid;
    }
    get timestamp() {
        return this.privTextResponse.timestamp;
    }
    get type() {
        return this.privTextResponse.type;
    }
    static fromJSON(json) {
        return new TextResponsePayload(json);
    }
}

//# sourceMappingURL=TranslationResponsePayload.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/TranscriberRecognizer.js":
/*!*************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/TranscriberRecognizer.js ***!
  \*************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranscriberRecognizer": () => (/* binding */ TranscriberRecognizer)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../sdk/Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranscriberConnectionFactory.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranscriptionServiceRecognizer.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




class TranscriberRecognizer extends _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.Recognizer {
    /**
     * TranscriberRecognizer constructor.
     * @constructor
     * @param {SpeechTranslationConfig} speechTranslationConfig - Non-audio configuration associated with the recognizer
     * @param {AudioConfig} audioConfig - An audio configuration associated with the recognizer
     */
    constructor(speechTranslationConfig, audioConfig) {
        const speechTranslationConfigImpl = speechTranslationConfig;
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(speechTranslationConfigImpl, "speechTranslationConfig");
        const audioConfigImpl = audioConfig;
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(audioConfigImpl, "audioConfigImpl");
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(speechTranslationConfigImpl.speechRecognitionLanguage, _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage]);
        super(audioConfig, speechTranslationConfigImpl.properties, new _Exports__WEBPACK_IMPORTED_MODULE_3__.TranscriberConnectionFactory());
        this.privDisposedRecognizer = false;
    }
    get speechRecognitionLanguage() {
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedRecognizer);
        return this.properties.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage);
    }
    get properties() {
        return this.privProperties;
    }
    get authorizationToken() {
        return this.properties.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token);
    }
    set authorizationToken(token) {
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(token, "token");
        this.properties.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token, token);
    }
    set conversation(c) {
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(c, "Conversation");
        this.privConversation = c;
    }
    getConversationInfo() {
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(this.privConversation, "Conversation");
        return this.privConversation.conversationInfo;
    }
    startContinuousRecognitionAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(_Exports__WEBPACK_IMPORTED_MODULE_5__.RecognitionMode.Conversation), cb, err);
    }
    stopContinuousRecognitionAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(), cb, err);
    }
    close() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.privDisposedRecognizer) {
                yield this.dispose(true);
            }
        });
    }
    // Push async join/leave conversation message via serviceRecognizer
    pushConversationEvent(conversationInfo, command) {
        return __awaiter(this, void 0, void 0, function* () {
            const reco = (this.privReco);
            _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(reco, "serviceRecognizer");
            yield reco.sendSpeechEventAsync(conversationInfo, command);
        });
    }
    enforceAudioGating() {
        return __awaiter(this, void 0, void 0, function* () {
            const audioConfigImpl = this.audioConfig;
            const format = yield audioConfigImpl.format;
            const channels = format.channels;
            if (channels === 1) {
                if (this.properties.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2", "false").toLowerCase() !== "true") {
                    throw new Error("Single channel audio configuration for ConversationTranscriber is currently under private preview, please contact diarizationrequest@microsoft.com for more details");
                }
            }
            else if (channels !== 8) {
                throw new Error(`Unsupported audio configuration: Detected ${channels}-channel audio`);
            }
            return;
        });
    }
    connectCallbacks(transcriber) {
        this.canceled = (s, e) => {
            if (!!transcriber.canceled) {
                transcriber.canceled(transcriber, e);
            }
        };
        this.recognizing = (s, e) => {
            if (!!transcriber.transcribing) {
                transcriber.transcribing(transcriber, e);
            }
        };
        this.recognized = (s, e) => {
            if (!!transcriber.transcribed) {
                transcriber.transcribed(transcriber, e);
            }
        };
        this.sessionStarted = (s, e) => {
            if (!!transcriber.sessionStarted) {
                transcriber.sessionStarted(transcriber, e);
            }
        };
        this.sessionStopped = (s, e) => {
            if (!!transcriber.sessionStopped) {
                transcriber.sessionStopped(transcriber, e);
            }
        };
    }
    disconnectCallbacks() {
        this.canceled = undefined;
        this.recognizing = undefined;
        this.recognized = undefined;
        this.sessionStarted = undefined;
        this.sessionStopped = undefined;
    }
    /**
     * Disposes any resources held by the object.
     * @member ConversationTranscriber.prototype.dispose
     * @function
     * @public
     * @param {boolean} disposing - true if disposing the object.
     */
    dispose(disposing) {
        const _super = Object.create(null, {
            dispose: { get: () => super.dispose }
        });
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privDisposedRecognizer) {
                return;
            }
            if (disposing) {
                this.privDisposedRecognizer = true;
                yield this.implRecognizerStop();
            }
            yield _super.dispose.call(this, disposing);
        });
    }
    createRecognizerConfig(speechConfig) {
        return new _Exports__WEBPACK_IMPORTED_MODULE_5__.RecognizerConfig(speechConfig, this.properties);
    }
    createServiceRecognizer(authentication, connectionFactory, audioConfig, recognizerConfig) {
        const configImpl = audioConfig;
        return new _Exports__WEBPACK_IMPORTED_MODULE_6__.TranscriptionServiceRecognizer(authentication, connectionFactory, configImpl, recognizerConfig, this);
    }
}

//# sourceMappingURL=TranscriberRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranscriptionServiceRecognizer.js":
/*!********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranscriptionServiceRecognizer.js ***!
  \********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranscriptionServiceRecognizer": () => (/* binding */ TranscriptionServiceRecognizer)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConversationTranscriptionCanceledEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConversationServiceRecognizer.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./SpeechConnectionMessage.Internal */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionMessage.Internal.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




// eslint-disable-next-line max-classes-per-file
class TranscriptionServiceRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.ConversationServiceRecognizer {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, transcriber) {
        super(authentication, connectionFactory, audioSource, recognizerConfig, transcriber);
        this.privTranscriberRecognizer = transcriber;
        this.sendPrePayloadJSONOverride = (connection) => this.sendTranscriptionStartJSON(connection);
        if (this.privRecognizerConfig.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps) === "true") {
            this.privSpeechContext.setWordLevelTimings();
        }
    }
    sendSpeechEventAsync(info, command) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!!this.privRequestSession.isRecognizing) {
                const connection = yield this.fetchConnection();
                yield this.sendSpeechEvent(connection, this.createSpeechEventPayload(info, command));
            }
        });
    }
    processTypeSpecificMessages(connectionMessage) {
        return this.processSpeechMessages(connectionMessage);
    }
    handleRecognizedCallback(result, offset, sessionId) {
        try {
            const event = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechRecognitionEventArgs(result, offset, sessionId);
            this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer, event);
            if (!!this.privSuccessCallback) {
                try {
                    this.privSuccessCallback(result);
                }
                catch (e) {
                    if (!!this.privErrorCallback) {
                        this.privErrorCallback(e);
                    }
                }
                // Only invoke the call back once.
                // and if it's successful don't invoke the
                // error after that.
                this.privSuccessCallback = undefined;
                this.privErrorCallback = undefined;
            }
            /* eslint-disable no-empty */
        }
        catch (error) {
            // Not going to let errors in the event handler
            // trip things up.
        }
    }
    handleRecognizingCallback(result, duration, sessionId) {
        try {
            const ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechRecognitionEventArgs(result, duration, sessionId);
            this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer, ev);
            /* eslint-disable no-empty */
        }
        catch (error) {
            // Not going to let errors in the event handler
            // trip things up.
        }
    }
    // Cancels recognition.
    cancelRecognition(sessionId, requestId, cancellationReason, errorCode, error) {
        const properties = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyCollection();
        properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.CancellationErrorCodePropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.CancellationErrorCode[errorCode]);
        if (!!this.privTranscriberRecognizer.canceled) {
            const cancelEvent = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.ConversationTranscriptionCanceledEventArgs(cancellationReason, error, errorCode, undefined, sessionId);
            try {
                this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer, cancelEvent);
                /* eslint-disable no-empty */
            }
            catch (_a) { }
        }
        if (!!this.privSuccessCallback) {
            const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.SpeechRecognitionResult(requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.ResultReason.Canceled, undefined, // Text
            undefined, // Duration
            undefined, // Offset
            undefined, // Language
            undefined, // Language Detection Confidence
            undefined, // Speaker Id
            error, undefined, // Json
            properties);
            try {
                this.privSuccessCallback(result);
                this.privSuccessCallback = undefined;
                /* eslint-disable no-empty */
            }
            catch (_b) { }
        }
    }
    // Encapsulated for derived service recognizers that need to send additional JSON
    sendTranscriptionStartJSON(connection) {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.sendSpeechContext(connection, true);
            const info = this.privTranscriberRecognizer.getConversationInfo();
            const payload = this.createSpeechEventPayload(info, "start");
            yield this.sendSpeechEvent(connection, payload);
            yield this.sendWaveHeader(connection);
            return;
        });
    }
    sendSpeechEvent(connection, payload) {
        const speechEventJson = JSON.stringify(payload);
        if (speechEventJson) {
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_9__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_10__.MessageType.Text, "speech.event", this.privRequestSession.requestId, "application/json", speechEventJson));
        }
        return;
    }
    createSpeechEventPayload(info, command) {
        const eventDict = { id: "meeting", name: command, meeting: info.conversationProperties };
        eventDict.meeting.id = info.id;
        eventDict.meeting.attendees = info.participants;
        eventDict.meeting.record = info.conversationProperties.audiorecording === "on" ? "true" : "false";
        return eventDict;
    }
}

//# sourceMappingURL=TranscriptionServiceRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationConnectionFactory.js":
/*!******************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationConnectionFactory.js ***!
  \******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationConnectionFactory": () => (/* binding */ TranslationConnectionFactory)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js");
/* harmony import */ var _common_StringUtils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/StringUtils */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/StringUtils.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
/* harmony import */ var _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./QueryParameterNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/QueryParameterNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.







class TranslationConnectionFactory extends _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase {
    create(config, authInfo, connectionId) {
        const endpoint = this.getEndpointUrl(config);
        const queryParams = {};
        if (config.autoDetectSourceLanguages !== undefined) {
            queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.EnableLanguageId] = "true";
        }
        this.setQueryParams(queryParams, config, endpoint);
        const headers = {};
        if (authInfo.token !== undefined && authInfo.token !== "") {
            headers[authInfo.headerName] = authInfo.token;
        }
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.ConnectionId] = connectionId;
        config.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_Url, endpoint);
        const enableCompression = config.parameters.getProperty("SPEECH-EnableWebsocketCompression", "false") === "true";
        return new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_4__.WebsocketConnection(endpoint, queryParams, headers, new _Exports__WEBPACK_IMPORTED_MODULE_5__.WebsocketMessageFormatter(), _common_browser_Exports__WEBPACK_IMPORTED_MODULE_6__.ProxyInfo.fromRecognizerConfig(config), enableCompression, connectionId);
    }
    getEndpointUrl(config, returnRegionPlaceholder) {
        const region = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_Region);
        const hostSuffix = _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase.getHostSuffix(region);
        let endpointUrl = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_Endpoint, undefined);
        if (!endpointUrl) {
            if (config.autoDetectSourceLanguages !== undefined) {
                const host = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_Host, "wss://{region}.stt.speech" + hostSuffix);
                endpointUrl = host + "/speech/universal/v2";
            }
            else {
                const host = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_Host, "wss://{region}.s2s.speech" + hostSuffix);
                endpointUrl = host + "/speech/translation/cognitiveservices/v1";
            }
        }
        if (returnRegionPlaceholder === true) {
            return endpointUrl;
        }
        return _common_StringUtils__WEBPACK_IMPORTED_MODULE_7__.StringUtils.formatString(endpointUrl, { region });
    }
    setQueryParams(queryParams, config, endpointUrl) {
        queryParams.from = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_RecoLanguage);
        queryParams.to = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages);
        this.setCommonUrlParams(config, queryParams, endpointUrl);
        this.setUrlParameter(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceResponse_TranslationRequestStablePartialResult, _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.StableTranslation, config, queryParams, endpointUrl);
        const translationVoice = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationVoice, undefined);
        if (translationVoice !== undefined) {
            queryParams.voice = translationVoice;
            queryParams.features = "texttospeech";
        }
    }
}

//# sourceMappingURL=TranslationConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationServiceRecognizer.js":
/*!******************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationServiceRecognizer.js ***!
  \******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationServiceRecognizer": () => (/* binding */ TranslationServiceRecognizer)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationStatus.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationSynthesisResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationSynthesisEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionCanceledEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Translations.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConversationServiceRecognizer.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/EnumTranslation.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationHypothesis.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationPhrase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationSynthesisEnd.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



// eslint-disable-next-line max-classes-per-file
class TranslationServiceRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.ConversationServiceRecognizer {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, translationRecognizer) {
        super(authentication, connectionFactory, audioSource, recognizerConfig, translationRecognizer);
        this.privTranslationRecognizer = translationRecognizer;
        this.connectionEvents.attach((connectionEvent) => {
            if (connectionEvent.name === "ConnectionEstablishedEvent") {
                this.privTranslationRecognizer.onConnection();
            }
            else if (connectionEvent.name === "ConnectionClosedEvent") {
                void this.privTranslationRecognizer.onDisconnection();
            }
        });
    }
    processTypeSpecificMessages(connectionMessage) {
        return __awaiter(this, void 0, void 0, function* () {
            const resultProps = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyCollection();
            let processed = yield this.processSpeechMessages(connectionMessage);
            if (processed) {
                return true;
            }
            const handleTranslationPhrase = (translatedPhrase) => __awaiter(this, void 0, void 0, function* () {
                this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset + translatedPhrase.Offset + translatedPhrase.Duration);
                if (translatedPhrase.RecognitionStatus === _Exports__WEBPACK_IMPORTED_MODULE_2__.RecognitionStatus.Success) {
                    // OK, the recognition was successful. How'd the translation do?
                    const result = this.fireEventForResult(translatedPhrase, resultProps);
                    if (!!this.privTranslationRecognizer.recognized) {
                        try {
                            this.privTranslationRecognizer.recognized(this.privTranslationRecognizer, result);
                            /* eslint-disable no-empty */
                        }
                        catch (error) {
                            // Not going to let errors in the event handler
                            // trip things up.
                        }
                    }
                    // report result to promise.
                    if (!!this.privSuccessCallback) {
                        try {
                            this.privSuccessCallback(result.result);
                        }
                        catch (e) {
                            if (!!this.privErrorCallback) {
                                this.privErrorCallback(e);
                            }
                        }
                        // Only invoke the call back once.
                        // and if it's successful don't invoke the
                        // error after that.
                        this.privSuccessCallback = undefined;
                        this.privErrorCallback = undefined;
                    }
                }
                else {
                    const reason = _Exports__WEBPACK_IMPORTED_MODULE_3__.EnumTranslation.implTranslateRecognitionResult(translatedPhrase.RecognitionStatus);
                    const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.TranslationRecognitionResult(undefined, this.privRequestSession.requestId, reason, translatedPhrase.Text, translatedPhrase.Duration, this.privRequestSession.currentTurnAudioOffset + translatedPhrase.Offset, translatedPhrase.Language, translatedPhrase.Confidence, undefined, connectionMessage.textBody, resultProps);
                    if (reason === _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.Canceled) {
                        const cancelReason = _Exports__WEBPACK_IMPORTED_MODULE_3__.EnumTranslation.implTranslateCancelResult(translatedPhrase.RecognitionStatus);
                        const cancellationErrorCode = _Exports__WEBPACK_IMPORTED_MODULE_3__.EnumTranslation.implTranslateCancelErrorCode(translatedPhrase.RecognitionStatus);
                        yield this.cancelRecognitionLocal(cancelReason, cancellationErrorCode, _Exports__WEBPACK_IMPORTED_MODULE_3__.EnumTranslation.implTranslateErrorDetails(cancellationErrorCode));
                    }
                    else {
                        if (!(this.privRequestSession.isSpeechEnded && reason === _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.NoMatch && translatedPhrase.RecognitionStatus !== _Exports__WEBPACK_IMPORTED_MODULE_2__.RecognitionStatus.InitialSilenceTimeout)) {
                            const ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.TranslationRecognitionEventArgs(result, result.offset, this.privRequestSession.sessionId);
                            if (!!this.privTranslationRecognizer.recognized) {
                                try {
                                    this.privTranslationRecognizer.recognized(this.privTranslationRecognizer, ev);
                                    /* eslint-disable no-empty */
                                }
                                catch (error) {
                                    // Not going to let errors in the event handler
                                    // trip things up.
                                }
                            }
                        }
                        // report result to promise.
                        if (!!this.privSuccessCallback) {
                            try {
                                this.privSuccessCallback(result);
                            }
                            catch (e) {
                                if (!!this.privErrorCallback) {
                                    this.privErrorCallback(e);
                                }
                            }
                            // Only invoke the call back once.
                            // and if it's successful don't invoke the
                            // error after that.
                            this.privSuccessCallback = undefined;
                            this.privErrorCallback = undefined;
                        }
                    }
                    processed = true;
                }
            });
            if (connectionMessage.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_7__.MessageType.Text) {
                resultProps.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.PropertyId.SpeechServiceResponse_JsonResult, connectionMessage.textBody);
            }
            switch (connectionMessage.path.toLowerCase()) {
                case "translation.hypothesis":
                    const result = this.fireEventForResult(_Exports__WEBPACK_IMPORTED_MODULE_9__.TranslationHypothesis.fromJSON(connectionMessage.textBody), resultProps);
                    this.privRequestSession.onHypothesis(this.privRequestSession.currentTurnAudioOffset + result.offset);
                    if (!!this.privTranslationRecognizer.recognizing) {
                        try {
                            this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer, result);
                            /* eslint-disable no-empty */
                        }
                        catch (error) {
                            // Not going to let errors in the event handler
                            // trip things up.
                        }
                    }
                    processed = true;
                    break;
                case "translation.response":
                    const phrase = JSON.parse(connectionMessage.textBody);
                    if (!!phrase.SpeechPhrase) {
                        yield handleTranslationPhrase(_Exports__WEBPACK_IMPORTED_MODULE_10__.TranslationPhrase.fromTranslationResponse(phrase));
                    }
                    break;
                case "translation.phrase":
                    yield handleTranslationPhrase(_Exports__WEBPACK_IMPORTED_MODULE_10__.TranslationPhrase.fromJSON(connectionMessage.textBody));
                    break;
                case "translation.synthesis":
                    this.sendSynthesisAudio(connectionMessage.binaryBody, this.privRequestSession.sessionId);
                    processed = true;
                    break;
                case "audio.end":
                case "translation.synthesis.end":
                    const synthEnd = _Exports__WEBPACK_IMPORTED_MODULE_11__.TranslationSynthesisEnd.fromJSON(connectionMessage.textBody);
                    switch (synthEnd.SynthesisStatus) {
                        case _Exports__WEBPACK_IMPORTED_MODULE_2__.SynthesisStatus.Error:
                            if (!!this.privTranslationRecognizer.synthesizing) {
                                const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__.TranslationSynthesisResult(_sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.Canceled, undefined);
                                const retEvent = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__.TranslationSynthesisEventArgs(result, this.privRequestSession.sessionId);
                                try {
                                    this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer, retEvent);
                                    /* eslint-disable no-empty */
                                }
                                catch (error) {
                                    // Not going to let errors in the event handler
                                    // trip things up.
                                }
                            }
                            if (!!this.privTranslationRecognizer.canceled) {
                                // And raise a canceled event to send the rich(er) error message back.
                                const canceledResult = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__.CancellationReason.Error, synthEnd.FailureReason, _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__.CancellationErrorCode.ServiceError, null);
                                try {
                                    this.privTranslationRecognizer.canceled(this.privTranslationRecognizer, canceledResult);
                                    /* eslint-disable no-empty */
                                }
                                catch (error) {
                                    // Not going to let errors in the event handler
                                    // trip things up.
                                }
                            }
                            break;
                        case _Exports__WEBPACK_IMPORTED_MODULE_2__.SynthesisStatus.Success:
                            this.sendSynthesisAudio(undefined, this.privRequestSession.sessionId);
                            break;
                        default:
                            break;
                    }
                    processed = true;
                    break;
                default:
                    break;
            }
            return processed;
        });
    }
    // Cancels recognition.
    cancelRecognition(sessionId, requestId, cancellationReason, errorCode, error) {
        const properties = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyCollection();
        properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_17__.CancellationErrorCodePropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__.CancellationErrorCode[errorCode]);
        if (!!this.privTranslationRecognizer.canceled) {
            const cancelEvent = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.TranslationRecognitionCanceledEventArgs(sessionId, cancellationReason, error, errorCode, undefined);
            try {
                this.privTranslationRecognizer.canceled(this.privTranslationRecognizer, cancelEvent);
                /* eslint-disable no-empty */
            }
            catch (_a) { }
        }
        if (!!this.privSuccessCallback) {
            const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.TranslationRecognitionResult(undefined, // Translations
            requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.Canceled, undefined, // Text
            undefined, // Druation
            undefined, // Offset
            undefined, // Language
            undefined, // LanguageDetectionConfidence
            error, undefined, // Json
            properties);
            try {
                this.privSuccessCallback(result);
                /* eslint-disable no-empty */
                this.privSuccessCallback = undefined;
            }
            catch (_b) { }
        }
    }
    handleRecognizingCallback(result, duration, sessionId) {
        try {
            const ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.TranslationRecognitionEventArgs(_sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.TranslationRecognitionResult.fromSpeechRecognitionResult(result), duration, sessionId);
            this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer, ev);
            /* eslint-disable no-empty */
        }
        catch (error) {
            // Not going to let errors in the event handler
            // trip things up.
        }
    }
    handleRecognizedCallback(result, offset, sessionId) {
        try {
            const ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.TranslationRecognitionEventArgs(_sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.TranslationRecognitionResult.fromSpeechRecognitionResult(result), offset, sessionId);
            this.privTranslationRecognizer.recognized(this.privTranslationRecognizer, ev);
        }
        catch (error) {
            // Not going to let errors in the event handler
            // trip things up.
        }
    }
    fireEventForResult(serviceResult, properties) {
        let translations;
        if (undefined !== serviceResult.Translation.Translations) {
            translations = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_18__.Translations();
            for (const translation of serviceResult.Translation.Translations) {
                translations.set(translation.Language, translation.Text || translation.DisplayText);
            }
        }
        let resultReason;
        let language;
        let confidence;
        if (serviceResult instanceof _Exports__WEBPACK_IMPORTED_MODULE_10__.TranslationPhrase) {
            if (!!serviceResult.Translation && serviceResult.Translation.TranslationStatus === _common_Exports__WEBPACK_IMPORTED_MODULE_19__.TranslationStatus.Success) {
                resultReason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.TranslatedSpeech;
            }
            else {
                resultReason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.RecognizedSpeech;
            }
            language = serviceResult.Language;
            confidence = serviceResult.Confidence;
        }
        else {
            resultReason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.TranslatingSpeech;
        }
        const offset = serviceResult.Offset + this.privRequestSession.currentTurnAudioOffset;
        const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.TranslationRecognitionResult(translations, this.privRequestSession.requestId, resultReason, serviceResult.Text, serviceResult.Duration, offset, language, confidence, serviceResult.Translation.FailureReason, JSON.stringify(serviceResult), properties);
        const ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.TranslationRecognitionEventArgs(result, offset, this.privRequestSession.sessionId);
        return ev;
    }
    sendSynthesisAudio(audio, sessionId) {
        const reason = (undefined === audio) ? _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.SynthesizingAudioCompleted : _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.SynthesizingAudio;
        const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__.TranslationSynthesisResult(reason, audio);
        const retEvent = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__.TranslationSynthesisEventArgs(result, sessionId);
        if (!!this.privTranslationRecognizer.synthesizing) {
            try {
                this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer, retEvent);
                /* eslint-disable no-empty */
            }
            catch (error) {
                // Not going to let errors in the event handler
                // trip things up.
            }
        }
    }
}

//# sourceMappingURL=TranslationServiceRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationStatus.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationStatus.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationStatus": () => (/* binding */ TranslationStatus)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines translation status.
 * @class TranslationStatus
 */
var TranslationStatus;
(function (TranslationStatus) {
    /**
     * @member TranslationStatus.Success
     */
    TranslationStatus[TranslationStatus["Success"] = 0] = "Success";
    /**
     * @member TranslationStatus.Error
     */
    TranslationStatus[TranslationStatus["Error"] = 1] = "Error";
})(TranslationStatus || (TranslationStatus = {}));

//# sourceMappingURL=TranslationStatus.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/VoiceServiceRecognizer.js":
/*!************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/VoiceServiceRecognizer.js ***!
  \************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "VoiceServiceRecognizer": () => (/* binding */ VoiceServiceRecognizer)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ReplayableAudioNode.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/DeferralMap.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileEnrollmentResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileType.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfilePhraseResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileResult.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./SpeechConnectionMessage.Internal */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionMessage.Internal.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





// eslint-disable-next-line max-classes-per-file
class VoiceServiceRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.ServiceRecognizerBase {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, recognizer) {
        super(authentication, connectionFactory, audioSource, recognizerConfig, recognizer);
        this.privDeferralMap = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.DeferralMap();
        this.privSpeakerAudioSource = audioSource;
        this.sendPrePayloadJSONOverride = () => this.noOp();
    }
    set SpeakerAudioSource(audioSource) {
        this.privSpeakerAudioSource = audioSource;
    }
    processTypeSpecificMessages(connectionMessage) {
        let processed = false;
        const resultProps = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyCollection();
        if (connectionMessage.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_3__.MessageType.Text) {
            resultProps.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceResponse_JsonResult, connectionMessage.textBody);
        }
        switch (connectionMessage.path.toLowerCase()) {
            // Profile management response for create, fetch, delete, reset
            case "speaker.profiles":
                const response = JSON.parse(connectionMessage.textBody);
                switch (response.operation.toLowerCase()) {
                    case "create":
                        this.handleCreateResponse(response, connectionMessage.requestId);
                        break;
                    case "delete":
                    case "reset":
                        this.handleResultResponse(response, connectionMessage.requestId);
                        break;
                    case "fetch":
                        const enrollmentResponse = JSON.parse(connectionMessage.textBody);
                        this.handleFetchResponse(enrollmentResponse, connectionMessage.requestId);
                        break;
                    default:
                        break;
                }
                processed = true;
                break;
            // Activation and authorization phrase response
            case "speaker.phrases":
                const phraseResponse = JSON.parse(connectionMessage.textBody);
                this.handlePhrasesResponse(phraseResponse, connectionMessage.requestId);
                processed = true;
                break;
            // Enrollment response
            case "speaker.profile.enrollment":
                const enrollmentResponse = JSON.parse(connectionMessage.textBody);
                const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(!!enrollmentResponse.enrollment ? enrollmentResponse.enrollment.enrollmentStatus : enrollmentResponse.status.statusCode), !!enrollmentResponse.enrollment ? JSON.stringify(enrollmentResponse.enrollment) : undefined, enrollmentResponse.status.reason);
                if (!!this.privDeferralMap.getId(connectionMessage.requestId)) {
                    this.privDeferralMap.complete(connectionMessage.requestId, result);
                }
                this.privRequestSession.onSpeechEnded();
                processed = true;
                break;
            default:
                break;
        }
        const defferal = new _common_Exports__WEBPACK_IMPORTED_MODULE_6__.Deferred();
        defferal.resolve(processed);
        return defferal.promise;
    }
    // Cancels recognition.
    cancelRecognition(sessionId, requestId, cancellationReason, errorCode, error) {
        const properties = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyCollection();
        // const enrollmentResponse: EnrollmentResponse = JSON.parse(connectionMessage.textBody) as EnrollmentResponse;
        properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationErrorCodePropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCode[errorCode]);
        const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.VoiceProfileEnrollmentResult(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.ResultReason.Canceled, error, error);
        if (!!this.privDeferralMap.getId(requestId)) {
            this.privDeferralMap.complete(requestId, result);
        }
    }
    createProfile(profileType, locale) {
        return __awaiter(this, void 0, void 0, function* () {
            // Start the connection to the service. The promise this will create is stored and will be used by configureConnection().
            this.voiceProfileType = profileType.toString();
            const conPromise = this.connectImpl();
            try {
                const createProfileDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_6__.Deferred();
                yield conPromise;
                yield this.sendCreateProfile(createProfileDeferral, profileType, locale);
                void this.receiveMessage();
                return createProfileDeferral.promise;
            }
            catch (err) {
                throw err;
            }
        });
    }
    resetProfile(profile) {
        return __awaiter(this, void 0, void 0, function* () {
            this.voiceProfileType = profile.profileType.toString();
            return this.sendCommonRequest("reset", profile.profileType, profile);
        });
    }
    deleteProfile(profile) {
        return __awaiter(this, void 0, void 0, function* () {
            this.voiceProfileType = profile.profileType.toString();
            return this.sendCommonRequest("delete", profile.profileType, profile);
        });
    }
    retrieveEnrollmentResult(profile) {
        return __awaiter(this, void 0, void 0, function* () {
            this.voiceProfileType = profile.profileType.toString();
            this.privExpectedProfileId = profile.profileId;
            return this.sendCommonRequest("fetch", profile.profileType, profile);
        });
    }
    getAllProfiles(profileType) {
        return __awaiter(this, void 0, void 0, function* () {
            this.voiceProfileType = profileType.toString();
            return this.sendCommonRequest("fetch", profileType);
        });
    }
    getActivationPhrases(profileType, lang) {
        return __awaiter(this, void 0, void 0, function* () {
            this.voiceProfileType = profileType.toString();
            // Start the connection to the service. The promise this will create is stored and will be used by configureConnection().
            const conPromise = this.connectImpl();
            try {
                const getPhrasesDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_6__.Deferred();
                yield conPromise;
                yield this.sendPhrasesRequest(getPhrasesDeferral, profileType, lang);
                void this.receiveMessage();
                return getPhrasesDeferral.promise;
            }
            catch (err) {
                throw err;
            }
        });
    }
    enrollProfile(profile) {
        return __awaiter(this, void 0, void 0, function* () {
            this.voiceProfileType = profile.profileType.toString();
            const enrollmentDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_6__.Deferred();
            this.privRequestSession.startNewRecognition();
            this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events);
            this.privRecognizerConfig.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.Speech_SessionId, this.privRequestSession.sessionId);
            // Start the connection to the service. The promise this will create is stored and will be used by configureConnection().
            const conPromise = this.connectImpl();
            const preAudioPromise = this.sendPreAudioMessages(profile, enrollmentDeferral);
            const node = yield this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId);
            const format = yield this.privSpeakerAudioSource.format;
            const deviceInfo = yield this.privSpeakerAudioSource.deviceInfo;
            const audioNode = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_10__.ReplayableAudioNode(node, format.avgBytesPerSec);
            yield this.privRequestSession.onAudioSourceAttachCompleted(audioNode, false);
            this.privRecognizerConfig.SpeechServiceConfig.Context.audio = { source: deviceInfo };
            try {
                yield conPromise;
                yield preAudioPromise;
            }
            catch (err) {
                this.cancelRecognition(this.privRequestSession.sessionId, this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCode.ConnectionFailure, err);
            }
            const sessionStartEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__.SessionEventArgs(this.privRequestSession.sessionId);
            if (!!this.privRecognizer.sessionStarted) {
                this.privRecognizer.sessionStarted(this.privRecognizer, sessionStartEventArgs);
            }
            void this.receiveMessage();
            const audioSendPromise = this.sendAudio(audioNode);
            // /* eslint-disable no-empty */
            audioSendPromise.then(() => { }, (error) => {
                this.cancelRecognition(this.privRequestSession.sessionId, this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCode.RuntimeError, error);
            });
            return enrollmentDeferral.promise;
        });
    }
    sendPreAudioMessages(profile, enrollmentDeferral) {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.fetchConnection();
            this.privRequestSession.onSpeechContext();
            this.privDeferralMap.add(this.privRequestSession.requestId, enrollmentDeferral);
            yield this.sendBaseRequest(connection, "enroll", this.scenarioFrom(profile.profileType), profile);
        });
    }
    sendPhrasesRequest(getPhrasesDeferral, profileType, locale) {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.fetchConnection();
            this.privRequestSession.onSpeechContext();
            this.privDeferralMap.add(this.privRequestSession.requestId, getPhrasesDeferral);
            const scenario = this.scenarioFrom(profileType);
            const profileCreateRequest = {
                locale,
                scenario,
            };
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_13__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_3__.MessageType.Text, "speaker.profile.phrases", this.privRequestSession.requestId, "application/json; charset=utf-8", JSON.stringify(profileCreateRequest)));
        });
    }
    sendCreateProfile(createProfileDeferral, profileType, locale) {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.fetchConnection();
            this.privRequestSession.onSpeechContext();
            this.privDeferralMap.add(this.privRequestSession.requestId, createProfileDeferral);
            const scenario = profileType === _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.VoiceProfileType.TextIndependentIdentification ? "TextIndependentIdentification" :
                profileType === _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.VoiceProfileType.TextIndependentVerification ? "TextIndependentVerification" : "TextDependentVerification";
            const profileCreateRequest = {
                locale,
                number: "1",
                scenario,
            };
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_13__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_3__.MessageType.Text, "speaker.profile.create", this.privRequestSession.requestId, "application/json; charset=utf-8", JSON.stringify(profileCreateRequest)));
        });
    }
    sendCommonRequest(operation, profileType, profile = undefined) {
        return __awaiter(this, void 0, void 0, function* () {
            // Start the connection to the service. The promise this will create is stored and will be used by configureConnection().
            const conPromise = this.connectImpl();
            try {
                const deferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_6__.Deferred();
                this.privRequestSession.onSpeechContext();
                yield conPromise;
                const connection = yield this.fetchConnection();
                this.privDeferralMap.add(this.privRequestSession.requestId, deferral);
                yield this.sendBaseRequest(connection, operation, this.scenarioFrom(profileType), profile);
                void this.receiveMessage();
                return deferral.promise;
            }
            catch (err) {
                throw err;
            }
        });
    }
    sendBaseRequest(connection, operation, scenario, profile) {
        return __awaiter(this, void 0, void 0, function* () {
            const profileRequest = {
                scenario
            };
            if (!!profile) {
                profileRequest.profileIds = [profile.profileId];
            }
            else {
                profileRequest.maxPageSize = -1;
            }
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_13__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_3__.MessageType.Text, `speaker.profile.${operation}`, this.privRequestSession.requestId, "application/json; charset=utf-8", JSON.stringify(profileRequest)));
        });
    }
    extractSpeakerContext(model) {
        return {
            features: {
                interimResult: "enabled",
                progressiveDetection: "disabled",
            },
            profileIds: model.profileIds,
            scenario: model.scenario,
        };
    }
    handlePhrasesResponse(response, requestId) {
        if (!!this.privDeferralMap.getId(requestId)) {
            if (response.status.statusCode.toLowerCase() !== "success") {
                const reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.ResultReason.Canceled;
                const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__.VoiceProfilePhraseResult(reason, response.status.statusCode, response.passPhraseType, []);
                this.privDeferralMap.complete(requestId, result);
            }
            else if (!!response.phrases && response.phrases.length > 0) {
                const reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.ResultReason.EnrollingVoiceProfile;
                const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__.VoiceProfilePhraseResult(reason, response.status.statusCode, response.passPhraseType, response.phrases);
                this.privDeferralMap.complete(requestId, result);
            }
            else {
                throw new Error("Voice Profile get activation phrases failed, no phrases received");
            }
        }
        else {
            throw new Error(`Voice Profile get activation phrases request for requestID ${requestId} not found`);
        }
    }
    handleCreateResponse(response, requestId) {
        if (!!response.profiles && response.profiles.length > 0) {
            if (!!this.privDeferralMap.getId(requestId)) {
                const profileIds = response.profiles.map((profile) => profile.profileId);
                this.privDeferralMap.complete(requestId, profileIds);
            }
            else {
                throw new Error(`Voice Profile create request for requestID ${requestId} not found`);
            }
        }
        else {
            throw new Error("Voice Profile create failed, no profile id received");
        }
    }
    handleResultResponse(response, requestId) {
        if (!!this.privDeferralMap.getId(requestId)) {
            const successReason = response.operation.toLowerCase() === "delete" ? _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.ResultReason.DeletedVoiceProfile : _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.ResultReason.ResetVoiceProfile;
            const reason = response.status.statusCode.toLowerCase() === "success" ? successReason : _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.ResultReason.Canceled;
            const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__.VoiceProfileResult(reason, `statusCode: ${response.status.statusCode}, errorDetails: ${response.status.reason}`);
            this.privDeferralMap.complete(requestId, result);
        }
        else {
            throw new Error(`Voice Profile create request for requestID ${requestId} not found`);
        }
    }
    handleFetchResponse(enrollmentResponse, requestId) {
        if (!!this.privDeferralMap.getId(requestId) && !!enrollmentResponse.profiles[0]) {
            if (!!this.privExpectedProfileId && enrollmentResponse.profiles.length === 1 && enrollmentResponse.profiles[0].profileId === this.privExpectedProfileId) {
                this.privExpectedProfileId = undefined;
                const profileInfo = enrollmentResponse.profiles[0];
                const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(profileInfo.enrollmentStatus), JSON.stringify(profileInfo), enrollmentResponse.status.reason);
                this.privDeferralMap.complete(requestId, result);
            }
            else if (enrollmentResponse.profiles.length > 0) {
                const iProfiles = enrollmentResponse.profiles;
                const profileResults = [];
                for (const profile of iProfiles) {
                    profileResults.push(new _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(profile.enrollmentStatus), JSON.stringify(profile), enrollmentResponse.status.reason));
                }
                this.privDeferralMap.complete(requestId, profileResults);
            }
        }
        else {
            throw new Error(`Voice Profile fetch request for requestID ${requestId} not found`);
        }
    }
    enrollmentReasonFrom(statusCode) {
        switch (statusCode.toLowerCase()) {
            case "enrolled":
                return _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.ResultReason.EnrolledVoiceProfile;
            case "invalidlocale":
            case "invalidphrase":
            case "invalidaudioformat":
            case "invalidscenario":
            case "invalidprofilecount":
            case "invalidoperation":
            case "audiotooshort":
            case "audiotoolong":
            case "toomanyenrollments":
            case "storageconflict":
            case "profilenotfound":
            case "incompatibleprofiles":
            case "incompleteenrollment":
                return _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.ResultReason.Canceled;
            default:
                return _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.ResultReason.EnrollingVoiceProfile;
        }
    }
    scenarioFrom(profileType) {
        return profileType === _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.VoiceProfileType.TextIndependentIdentification ? "TextIndependentIdentification" :
            profileType === _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.VoiceProfileType.TextIndependentVerification ? "TextIndependentVerification" : "TextDependentVerification";
    }
}

//# sourceMappingURL=VoiceServiceRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js":
/*!***************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js ***!
  \***************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "WebsocketMessageFormatter": () => (/* binding */ WebsocketMessageFormatter)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/RawWebsocketMessage.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

const CRLF = "\r\n";
class WebsocketMessageFormatter {
    toConnectionMessage(message) {
        const deferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.Deferred();
        try {
            if (message.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Text) {
                const textMessage = message.textContent;
                let headers = {};
                let body = null;
                if (textMessage) {
                    const headerBodySplit = textMessage.split("\r\n\r\n");
                    if (headerBodySplit && headerBodySplit.length > 0) {
                        headers = this.parseHeaders(headerBodySplit[0]);
                        if (headerBodySplit.length > 1) {
                            body = headerBodySplit[1];
                        }
                    }
                }
                deferral.resolve(new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.ConnectionMessage(message.messageType, body, headers, message.id));
            }
            else if (message.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Binary) {
                const binaryMessage = message.binaryContent;
                let headers = {};
                let body = null;
                if (!binaryMessage || binaryMessage.byteLength < 2) {
                    throw new Error("Invalid binary message format. Header length missing.");
                }
                const dataView = new DataView(binaryMessage);
                const headerLength = dataView.getInt16(0);
                if (binaryMessage.byteLength < headerLength + 2) {
                    throw new Error("Invalid binary message format. Header content missing.");
                }
                let headersString = "";
                for (let i = 0; i < headerLength; i++) {
                    headersString += String.fromCharCode((dataView).getInt8(i + 2));
                }
                headers = this.parseHeaders(headersString);
                if (binaryMessage.byteLength > headerLength + 2) {
                    body = binaryMessage.slice(2 + headerLength);
                }
                deferral.resolve(new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.ConnectionMessage(message.messageType, body, headers, message.id));
            }
        }
        catch (e) {
            deferral.reject(`Error formatting the message. Error: ${e}`);
        }
        return deferral.promise;
    }
    fromConnectionMessage(message) {
        const deferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.Deferred();
        try {
            if (message.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Text) {
                const payload = `${this.makeHeaders(message)}${CRLF}${message.textBody ? message.textBody : ""}`;
                deferral.resolve(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.RawWebsocketMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Text, payload, message.id));
            }
            else if (message.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Binary) {
                const headersString = this.makeHeaders(message);
                const content = message.binaryBody;
                const headerBuffer = this.stringToArrayBuffer(headersString);
                const headerInt8Array = new Int8Array(headerBuffer);
                const headerLength = headerInt8Array.byteLength;
                const payloadInt8Array = new Int8Array(2 + headerLength + (content ? content.byteLength : 0));
                payloadInt8Array[0] = ((headerLength >> 8) & 0xff);
                payloadInt8Array[1] = headerLength & 0xff;
                payloadInt8Array.set(headerInt8Array, 2);
                if (content) {
                    const bodyInt8Array = new Int8Array(content);
                    payloadInt8Array.set(bodyInt8Array, 2 + headerLength);
                }
                const payload = payloadInt8Array.buffer;
                deferral.resolve(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.RawWebsocketMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Binary, payload, message.id));
            }
        }
        catch (e) {
            deferral.reject(`Error formatting the message. ${e}`);
        }
        return deferral.promise;
    }
    makeHeaders(message) {
        let headersString = "";
        if (message.headers) {
            for (const header in message.headers) {
                if (header) {
                    headersString += `${header}: ${message.headers[header]}${CRLF}`;
                }
            }
        }
        return headersString;
    }
    parseHeaders(headersString) {
        const headers = {};
        if (headersString) {
            const headerMatches = headersString.match(/[^\r\n]+/g);
            if (headers) {
                for (const header of headerMatches) {
                    if (header) {
                        const separatorIndex = header.indexOf(":");
                        const headerName = separatorIndex > 0 ? header.substr(0, separatorIndex).trim().toLowerCase() : header;
                        const headerValue = separatorIndex > 0 && header.length > (separatorIndex + 1) ?
                            header.substr(separatorIndex + 1).trim() :
                            "";
                        headers[headerName] = headerValue;
                    }
                }
            }
        }
        return headers;
    }
    stringToArrayBuffer(str) {
        const buffer = new ArrayBuffer(str.length);
        const view = new DataView(buffer);
        for (let i = 0; i < str.length; i++) {
            view.setUint8(i, str.charCodeAt(i));
        }
        return buffer;
    }
}

//# sourceMappingURL=WebsocketMessageFormatter.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/AudioSourceEvents.js":
/*!************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/AudioSourceEvents.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioSourceErrorEvent": () => (/* binding */ AudioSourceErrorEvent),
/* harmony export */   "AudioSourceEvent": () => (/* binding */ AudioSourceEvent),
/* harmony export */   "AudioSourceInitializingEvent": () => (/* binding */ AudioSourceInitializingEvent),
/* harmony export */   "AudioSourceOffEvent": () => (/* binding */ AudioSourceOffEvent),
/* harmony export */   "AudioSourceReadyEvent": () => (/* binding */ AudioSourceReadyEvent),
/* harmony export */   "AudioStreamNodeAttachedEvent": () => (/* binding */ AudioStreamNodeAttachedEvent),
/* harmony export */   "AudioStreamNodeAttachingEvent": () => (/* binding */ AudioStreamNodeAttachingEvent),
/* harmony export */   "AudioStreamNodeDetachedEvent": () => (/* binding */ AudioStreamNodeDetachedEvent),
/* harmony export */   "AudioStreamNodeErrorEvent": () => (/* binding */ AudioStreamNodeErrorEvent),
/* harmony export */   "AudioStreamNodeEvent": () => (/* binding */ AudioStreamNodeEvent)
/* harmony export */ });
/* harmony import */ var _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PlatformEvent */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */

class AudioSourceEvent extends _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.PlatformEvent {
    constructor(eventName, audioSourceId, eventType = _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.EventType.Info) {
        super(eventName, eventType);
        this.privAudioSourceId = audioSourceId;
    }
    get audioSourceId() {
        return this.privAudioSourceId;
    }
}
class AudioSourceInitializingEvent extends AudioSourceEvent {
    constructor(audioSourceId) {
        super("AudioSourceInitializingEvent", audioSourceId);
    }
}
class AudioSourceReadyEvent extends AudioSourceEvent {
    constructor(audioSourceId) {
        super("AudioSourceReadyEvent", audioSourceId);
    }
}
class AudioSourceOffEvent extends AudioSourceEvent {
    constructor(audioSourceId) {
        super("AudioSourceOffEvent", audioSourceId);
    }
}
class AudioSourceErrorEvent extends AudioSourceEvent {
    constructor(audioSourceId, error) {
        super("AudioSourceErrorEvent", audioSourceId, _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.EventType.Error);
        this.privError = error;
    }
    get error() {
        return this.privError;
    }
}
class AudioStreamNodeEvent extends AudioSourceEvent {
    constructor(eventName, audioSourceId, audioNodeId) {
        super(eventName, audioSourceId);
        this.privAudioNodeId = audioNodeId;
    }
    get audioNodeId() {
        return this.privAudioNodeId;
    }
}
class AudioStreamNodeAttachingEvent extends AudioStreamNodeEvent {
    constructor(audioSourceId, audioNodeId) {
        super("AudioStreamNodeAttachingEvent", audioSourceId, audioNodeId);
    }
}
class AudioStreamNodeAttachedEvent extends AudioStreamNodeEvent {
    constructor(audioSourceId, audioNodeId) {
        super("AudioStreamNodeAttachedEvent", audioSourceId, audioNodeId);
    }
}
class AudioStreamNodeDetachedEvent extends AudioStreamNodeEvent {
    constructor(audioSourceId, audioNodeId) {
        super("AudioStreamNodeDetachedEvent", audioSourceId, audioNodeId);
    }
}
class AudioStreamNodeErrorEvent extends AudioStreamNodeEvent {
    constructor(audioSourceId, audioNodeId, error) {
        super("AudioStreamNodeErrorEvent", audioSourceId, audioNodeId);
        this.privError = error;
    }
    get error() {
        return this.privError;
    }
}

//# sourceMappingURL=AudioSourceEvents.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/BackgroundError.js":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/BackgroundError.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BackgroundEvent": () => (/* binding */ BackgroundEvent)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class BackgroundEvent extends _Exports__WEBPACK_IMPORTED_MODULE_0__.PlatformEvent {
    constructor(error) {
        super("BackgroundEvent", _Exports__WEBPACK_IMPORTED_MODULE_0__.EventType.Error);
        this.privError = error;
    }
    get error() {
        return this.privError;
    }
}

//# sourceMappingURL=BackgroundError.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ChunkedArrayBufferStream.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ChunkedArrayBufferStream.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ChunkedArrayBufferStream": () => (/* binding */ ChunkedArrayBufferStream)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Stream.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class ChunkedArrayBufferStream extends _Exports__WEBPACK_IMPORTED_MODULE_0__.Stream {
    constructor(targetChunkSize, streamId) {
        super(streamId);
        this.privTargetChunkSize = targetChunkSize;
        this.privNextBufferReadyBytes = 0;
    }
    writeStreamChunk(chunk) {
        // No pending write, and the buffer is the right size so write it.
        if (chunk.isEnd ||
            (0 === this.privNextBufferReadyBytes && chunk.buffer.byteLength === this.privTargetChunkSize)) {
            super.writeStreamChunk(chunk);
            return;
        }
        let bytesCopiedFromBuffer = 0;
        while (bytesCopiedFromBuffer < chunk.buffer.byteLength) {
            // Fill the next buffer.
            if (undefined === this.privNextBufferToWrite) {
                this.privNextBufferToWrite = new ArrayBuffer(this.privTargetChunkSize);
                this.privNextBufferStartTime = chunk.timeReceived;
            }
            // Find out how many bytes we can copy into the read buffer.
            const bytesToCopy = Math.min(chunk.buffer.byteLength - bytesCopiedFromBuffer, this.privTargetChunkSize - this.privNextBufferReadyBytes);
            const targetView = new Uint8Array(this.privNextBufferToWrite);
            const sourceView = new Uint8Array(chunk.buffer.slice(bytesCopiedFromBuffer, bytesToCopy + bytesCopiedFromBuffer));
            targetView.set(sourceView, this.privNextBufferReadyBytes);
            this.privNextBufferReadyBytes += bytesToCopy;
            bytesCopiedFromBuffer += bytesToCopy;
            // Are we ready to write?
            if (this.privNextBufferReadyBytes === this.privTargetChunkSize) {
                super.writeStreamChunk({
                    buffer: this.privNextBufferToWrite,
                    isEnd: false,
                    timeReceived: this.privNextBufferStartTime,
                });
                this.privNextBufferReadyBytes = 0;
                this.privNextBufferToWrite = undefined;
            }
        }
    }
    close() {
        // Send whatever is pending, then close the base class.
        if (0 !== this.privNextBufferReadyBytes && !this.isClosed) {
            super.writeStreamChunk({
                buffer: this.privNextBufferToWrite.slice(0, this.privNextBufferReadyBytes),
                isEnd: false,
                timeReceived: this.privNextBufferStartTime,
            });
        }
        super.close();
    }
}

//# sourceMappingURL=ChunkedArrayBufferStream.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionEvents.js":
/*!***********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionEvents.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectionClosedEvent": () => (/* binding */ ConnectionClosedEvent),
/* harmony export */   "ConnectionErrorEvent": () => (/* binding */ ConnectionErrorEvent),
/* harmony export */   "ConnectionEstablishErrorEvent": () => (/* binding */ ConnectionEstablishErrorEvent),
/* harmony export */   "ConnectionEstablishedEvent": () => (/* binding */ ConnectionEstablishedEvent),
/* harmony export */   "ConnectionEvent": () => (/* binding */ ConnectionEvent),
/* harmony export */   "ConnectionMessageReceivedEvent": () => (/* binding */ ConnectionMessageReceivedEvent),
/* harmony export */   "ConnectionMessageSentEvent": () => (/* binding */ ConnectionMessageSentEvent),
/* harmony export */   "ConnectionStartEvent": () => (/* binding */ ConnectionStartEvent),
/* harmony export */   "ServiceEvent": () => (/* binding */ ServiceEvent)
/* harmony export */ });
/* harmony import */ var _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PlatformEvent */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class ServiceEvent extends _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.PlatformEvent {
    constructor(eventName, jsonstring, eventType = _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.EventType.Info) {
        super(eventName, eventType);
        this.privJsonResult = jsonstring;
    }
    get jsonString() {
        return this.privJsonResult;
    }
}
class ConnectionEvent extends _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.PlatformEvent {
    constructor(eventName, connectionId, eventType = _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.EventType.Info) {
        super(eventName, eventType);
        this.privConnectionId = connectionId;
    }
    get connectionId() {
        return this.privConnectionId;
    }
}
class ConnectionStartEvent extends ConnectionEvent {
    constructor(connectionId, uri, headers) {
        super("ConnectionStartEvent", connectionId);
        this.privUri = uri;
        this.privHeaders = headers;
    }
    get uri() {
        return this.privUri;
    }
    get headers() {
        return this.privHeaders;
    }
}
class ConnectionEstablishedEvent extends ConnectionEvent {
    constructor(connectionId) {
        super("ConnectionEstablishedEvent", connectionId);
    }
}
class ConnectionClosedEvent extends ConnectionEvent {
    constructor(connectionId, statusCode, reason) {
        super("ConnectionClosedEvent", connectionId, _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.EventType.Debug);
        this.privReason = reason;
        this.privStatusCode = statusCode;
    }
    get reason() {
        return this.privReason;
    }
    get statusCode() {
        return this.privStatusCode;
    }
}
class ConnectionErrorEvent extends ConnectionEvent {
    constructor(connectionId, message, type) {
        super("ConnectionErrorEvent", connectionId, _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.EventType.Debug);
        this.privMessage = message;
        this.privType = type;
    }
    get message() {
        return this.privMessage;
    }
    get type() {
        return this.privType;
    }
}
class ConnectionEstablishErrorEvent extends ConnectionEvent {
    constructor(connectionId, statuscode, reason) {
        super("ConnectionEstablishErrorEvent", connectionId, _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.EventType.Error);
        this.privStatusCode = statuscode;
        this.privReason = reason;
    }
    get reason() {
        return this.privReason;
    }
    get statusCode() {
        return this.privStatusCode;
    }
}
class ConnectionMessageReceivedEvent extends ConnectionEvent {
    constructor(connectionId, networkReceivedTimeISO, message) {
        super("ConnectionMessageReceivedEvent", connectionId);
        this.privNetworkReceivedTime = networkReceivedTimeISO;
        this.privMessage = message;
    }
    get networkReceivedTime() {
        return this.privNetworkReceivedTime;
    }
    get message() {
        return this.privMessage;
    }
}
class ConnectionMessageSentEvent extends ConnectionEvent {
    constructor(connectionId, networkSentTimeISO, message) {
        super("ConnectionMessageSentEvent", connectionId);
        this.privNetworkSentTime = networkSentTimeISO;
        this.privMessage = message;
    }
    get networkSentTime() {
        return this.privNetworkSentTime;
    }
    get message() {
        return this.privMessage;
    }
}

//# sourceMappingURL=ConnectionEvents.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js":
/*!************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectionMessage": () => (/* binding */ ConnectionMessage),
/* harmony export */   "MessageType": () => (/* binding */ MessageType)
/* harmony export */ });
/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Error */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _Guid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Guid */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* eslint-disable @typescript-eslint/no-unsafe-return */
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


var MessageType;
(function (MessageType) {
    MessageType[MessageType["Text"] = 0] = "Text";
    MessageType[MessageType["Binary"] = 1] = "Binary";
})(MessageType || (MessageType = {}));
class ConnectionMessage {
    constructor(messageType, body, headers, id) {
        this.privBody = null;
        if (messageType === MessageType.Text && body && !(typeof (body) === "string")) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Payload must be a string");
        }
        if (messageType === MessageType.Binary && body && !(body instanceof ArrayBuffer)) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Payload must be ArrayBuffer");
        }
        this.privMessageType = messageType;
        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
        this.privBody = body;
        this.privHeaders = headers ? headers : {};
        this.privId = id ? id : (0,_Guid__WEBPACK_IMPORTED_MODULE_1__.createNoDashGuid)();
        switch (this.messageType) {
            case MessageType.Binary:
                this.privSize = this.binaryBody !== null ? this.binaryBody.byteLength : 0;
                break;
            case MessageType.Text:
                this.privSize = this.textBody.length;
        }
    }
    get messageType() {
        return this.privMessageType;
    }
    get headers() {
        return this.privHeaders;
    }
    get body() {
        return this.privBody;
    }
    get textBody() {
        if (this.privMessageType === MessageType.Binary) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Not supported for binary message");
        }
        return this.privBody;
    }
    get binaryBody() {
        if (this.privMessageType === MessageType.Text) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Not supported for text message");
        }
        return this.privBody;
    }
    get id() {
        return this.privId;
    }
}

//# sourceMappingURL=ConnectionMessage.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionOpenResponse.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionOpenResponse.js ***!
  \*****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectionOpenResponse": () => (/* binding */ ConnectionOpenResponse)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class ConnectionOpenResponse {
    constructor(statusCode, reason) {
        this.privStatusCode = statusCode;
        this.privReason = reason;
    }
    get statusCode() {
        return this.privStatusCode;
    }
    get reason() {
        return this.privReason;
    }
}

//# sourceMappingURL=ConnectionOpenResponse.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/DeferralMap.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/DeferralMap.js ***!
  \******************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DeferralMap": () => (/* binding */ DeferralMap)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * The error that is thrown when an argument passed in is null.
 *
 * @export
 * @class DefferalMap
 */
class DeferralMap {
    constructor() {
        this.privMap = {};
    }
    add(id, deferral) {
        this.privMap[id] = deferral;
    }
    getId(id) {
        return this.privMap[id];
    }
    complete(id, result) {
        try {
            this.privMap[id].resolve(result);
        }
        catch (error) {
            this.privMap[id].reject(error);
        }
        finally {
            this.privMap[id] = undefined;
        }
    }
}

//# sourceMappingURL=DeferralMap.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/DialogEvents.js":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/DialogEvents.js ***!
  \*******************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DialogEvent": () => (/* binding */ DialogEvent),
/* harmony export */   "SendingAgentContextMessageEvent": () => (/* binding */ SendingAgentContextMessageEvent)
/* harmony export */ });
/* harmony import */ var _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PlatformEvent */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class DialogEvent extends _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.PlatformEvent {
    constructor(eventName, eventType = _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.EventType.Info) {
        super(eventName, eventType);
    }
}
class SendingAgentContextMessageEvent extends DialogEvent {
    constructor(agentConfig) {
        super("SendingAgentContextMessageEvent");
        this.privAgentConfig = agentConfig;
    }
    get agentConfig() {
        return this.privAgentConfig;
    }
}

//# sourceMappingURL=DialogEvents.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js":
/*!************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js ***!
  \************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ArgumentNullError": () => (/* binding */ ArgumentNullError),
/* harmony export */   "InvalidOperationError": () => (/* binding */ InvalidOperationError),
/* harmony export */   "ObjectDisposedError": () => (/* binding */ ObjectDisposedError)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */
/**
 * The error that is thrown when an argument passed in is null.
 *
 * @export
 * @class ArgumentNullError
 * @extends {Error}
 */
class ArgumentNullError extends Error {
    /**
     * Creates an instance of ArgumentNullError.
     *
     * @param {string} argumentName - Name of the argument that is null
     *
     * @memberOf ArgumentNullError
     */
    constructor(argumentName) {
        super(argumentName);
        this.name = "ArgumentNull";
        this.message = argumentName;
    }
}
/**
 * The error that is thrown when an invalid operation is performed in the code.
 *
 * @export
 * @class InvalidOperationError
 * @extends {Error}
 */
class InvalidOperationError extends Error {
    /**
     * Creates an instance of InvalidOperationError.
     *
     * @param {string} error - The error
     *
     * @memberOf InvalidOperationError
     */
    constructor(error) {
        super(error);
        this.name = "InvalidOperation";
        this.message = error;
    }
}
/**
 * The error that is thrown when an object is disposed.
 *
 * @export
 * @class ObjectDisposedError
 * @extends {Error}
 */
class ObjectDisposedError extends Error {
    /**
     * Creates an instance of ObjectDisposedError.
     *
     * @param {string} objectName - The object that is disposed
     * @param {string} error - The error
     *
     * @memberOf ObjectDisposedError
     */
    constructor(objectName, error) {
        super(error);
        this.name = objectName + "ObjectDisposed";
        this.message = error;
    }
}

//# sourceMappingURL=Error.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js ***!
  \******************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "EventSource": () => (/* binding */ EventSource)
/* harmony export */ });
/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Error */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _Guid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Guid */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


class EventSource {
    constructor(metadata) {
        this.privEventListeners = {};
        this.privIsDisposed = false;
        this.privConsoleListener = undefined;
        this.privMetadata = metadata;
    }
    onEvent(event) {
        if (this.isDisposed()) {
            throw (new _Error__WEBPACK_IMPORTED_MODULE_0__.ObjectDisposedError("EventSource"));
        }
        if (this.metadata) {
            for (const paramName in this.metadata) {
                if (paramName) {
                    if (event.metadata) {
                        if (!event.metadata[paramName]) {
                            event.metadata[paramName] = this.metadata[paramName];
                        }
                    }
                }
            }
        }
        for (const eventId in this.privEventListeners) {
            if (eventId && this.privEventListeners[eventId]) {
                this.privEventListeners[eventId](event);
            }
        }
    }
    attach(onEventCallback) {
        const id = (0,_Guid__WEBPACK_IMPORTED_MODULE_1__.createNoDashGuid)();
        this.privEventListeners[id] = onEventCallback;
        return {
            detach: () => {
                delete this.privEventListeners[id];
                return Promise.resolve();
            },
        };
    }
    attachListener(listener) {
        return this.attach((e) => listener.onEvent(e));
    }
    attachConsoleListener(listener) {
        if (!!this.privConsoleListener) {
            void this.privConsoleListener.detach(); // Detach implementation for eventListeners is synchronous
        }
        this.privConsoleListener = this.attach((e) => listener.onEvent(e));
        return this.privConsoleListener;
    }
    isDisposed() {
        return this.privIsDisposed;
    }
    dispose() {
        this.privEventListeners = null;
        this.privIsDisposed = true;
    }
    get metadata() {
        return this.privMetadata;
    }
}

//# sourceMappingURL=EventSource.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Events": () => (/* binding */ Events)
/* harmony export */ });
/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Error */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _EventSource__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./EventSource */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


class Events {
    static setEventSource(eventSource) {
        if (!eventSource) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("eventSource");
        }
        Events.privInstance = eventSource;
    }
    static get instance() {
        return Events.privInstance;
    }
}
Events.privInstance = new _EventSource__WEBPACK_IMPORTED_MODULE_1__.EventSource();

//# sourceMappingURL=Events.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "createGuid": () => (/* binding */ createGuid),
/* harmony export */   "createNoDashGuid": () => (/* binding */ createNoDashGuid)
/* harmony export */ });
/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! uuid */ "./node_modules/uuid/dist/esm-browser/v4.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

const createGuid = () => (0,uuid__WEBPACK_IMPORTED_MODULE_0__["default"])();
const createNoDashGuid = () => createGuid().replace(new RegExp("-", "g"), "").toUpperCase();


//# sourceMappingURL=Guid.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/IConnection.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/IConnection.js ***!
  \******************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectionState": () => (/* binding */ ConnectionState)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var ConnectionState;
(function (ConnectionState) {
    ConnectionState[ConnectionState["None"] = 0] = "None";
    ConnectionState[ConnectionState["Connected"] = 1] = "Connected";
    ConnectionState[ConnectionState["Connecting"] = 2] = "Connecting";
    ConnectionState[ConnectionState["Disconnected"] = 3] = "Disconnected";
})(ConnectionState || (ConnectionState = {}));

//# sourceMappingURL=IConnection.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/List.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/List.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "List": () => (/* binding */ List)
/* harmony export */ });
/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Error */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class List {
    constructor(list) {
        this.privSubscriptionIdCounter = 0;
        this.privAddSubscriptions = {};
        this.privRemoveSubscriptions = {};
        this.privDisposedSubscriptions = {};
        this.privDisposeReason = null;
        this.privList = [];
        // copy the list rather than taking as is.
        if (list) {
            for (const item of list) {
                this.privList.push(item);
            }
        }
    }
    get(itemIndex) {
        this.throwIfDisposed();
        return this.privList[itemIndex];
    }
    first() {
        return this.get(0);
    }
    last() {
        return this.get(this.length() - 1);
    }
    add(item) {
        this.throwIfDisposed();
        this.insertAt(this.privList.length, item);
    }
    insertAt(index, item) {
        this.throwIfDisposed();
        if (index === 0) {
            this.privList.unshift(item);
        }
        else if (index === this.privList.length) {
            this.privList.push(item);
        }
        else {
            this.privList.splice(index, 0, item);
        }
        this.triggerSubscriptions(this.privAddSubscriptions);
    }
    removeFirst() {
        this.throwIfDisposed();
        return this.removeAt(0);
    }
    removeLast() {
        this.throwIfDisposed();
        return this.removeAt(this.length() - 1);
    }
    removeAt(index) {
        this.throwIfDisposed();
        return this.remove(index, 1)[0];
    }
    remove(index, count) {
        this.throwIfDisposed();
        const removedElements = this.privList.splice(index, count);
        this.triggerSubscriptions(this.privRemoveSubscriptions);
        return removedElements;
    }
    clear() {
        this.throwIfDisposed();
        this.remove(0, this.length());
    }
    length() {
        this.throwIfDisposed();
        return this.privList.length;
    }
    onAdded(addedCallback) {
        this.throwIfDisposed();
        const subscriptionId = this.privSubscriptionIdCounter++;
        this.privAddSubscriptions[subscriptionId] = addedCallback;
        return {
            detach: () => {
                delete this.privAddSubscriptions[subscriptionId];
                return Promise.resolve();
            },
        };
    }
    onRemoved(removedCallback) {
        this.throwIfDisposed();
        const subscriptionId = this.privSubscriptionIdCounter++;
        this.privRemoveSubscriptions[subscriptionId] = removedCallback;
        return {
            detach: () => {
                delete this.privRemoveSubscriptions[subscriptionId];
                return Promise.resolve();
            },
        };
    }
    onDisposed(disposedCallback) {
        this.throwIfDisposed();
        const subscriptionId = this.privSubscriptionIdCounter++;
        this.privDisposedSubscriptions[subscriptionId] = disposedCallback;
        return {
            detach: () => {
                delete this.privDisposedSubscriptions[subscriptionId];
                return Promise.resolve();
            },
        };
    }
    join(seperator) {
        this.throwIfDisposed();
        return this.privList.join(seperator);
    }
    toArray() {
        const cloneCopy = Array();
        this.privList.forEach((val) => {
            cloneCopy.push(val);
        });
        return cloneCopy;
    }
    any(callback) {
        this.throwIfDisposed();
        if (callback) {
            return this.where(callback).length() > 0;
        }
        else {
            return this.length() > 0;
        }
    }
    all(callback) {
        this.throwIfDisposed();
        return this.where(callback).length() === this.length();
    }
    forEach(callback) {
        this.throwIfDisposed();
        for (let i = 0; i < this.length(); i++) {
            callback(this.privList[i], i);
        }
    }
    select(callback) {
        this.throwIfDisposed();
        const selectList = [];
        for (let i = 0; i < this.privList.length; i++) {
            selectList.push(callback(this.privList[i], i));
        }
        return new List(selectList);
    }
    where(callback) {
        this.throwIfDisposed();
        const filteredList = new List();
        for (let i = 0; i < this.privList.length; i++) {
            if (callback(this.privList[i], i)) {
                filteredList.add(this.privList[i]);
            }
        }
        return filteredList;
    }
    orderBy(compareFn) {
        this.throwIfDisposed();
        const clonedArray = this.toArray();
        const orderedArray = clonedArray.sort(compareFn);
        return new List(orderedArray);
    }
    orderByDesc(compareFn) {
        this.throwIfDisposed();
        return this.orderBy((a, b) => compareFn(b, a));
    }
    clone() {
        this.throwIfDisposed();
        return new List(this.toArray());
    }
    concat(list) {
        this.throwIfDisposed();
        return new List(this.privList.concat(list.toArray()));
    }
    concatArray(array) {
        this.throwIfDisposed();
        return new List(this.privList.concat(array));
    }
    isDisposed() {
        return this.privList == null;
    }
    dispose(reason) {
        if (!this.isDisposed()) {
            this.privDisposeReason = reason;
            this.privList = null;
            this.privAddSubscriptions = null;
            this.privRemoveSubscriptions = null;
            this.triggerSubscriptions(this.privDisposedSubscriptions);
        }
    }
    throwIfDisposed() {
        if (this.isDisposed()) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.ObjectDisposedError("List", this.privDisposeReason);
        }
    }
    triggerSubscriptions(subscriptions) {
        if (subscriptions) {
            for (const subscriptionId in subscriptions) {
                if (subscriptionId) {
                    subscriptions[subscriptionId]();
                }
            }
        }
    }
}

//# sourceMappingURL=List.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "EventType": () => (/* binding */ EventType),
/* harmony export */   "PlatformEvent": () => (/* binding */ PlatformEvent)
/* harmony export */ });
/* harmony import */ var _Guid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Guid */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

var EventType;
(function (EventType) {
    EventType[EventType["Debug"] = 0] = "Debug";
    EventType[EventType["Info"] = 1] = "Info";
    EventType[EventType["Warning"] = 2] = "Warning";
    EventType[EventType["Error"] = 3] = "Error";
    EventType[EventType["None"] = 4] = "None";
})(EventType || (EventType = {}));
class PlatformEvent {
    constructor(eventName, eventType) {
        this.privName = eventName;
        this.privEventId = (0,_Guid__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privEventTime = new Date().toISOString();
        this.privEventType = eventType;
        this.privMetadata = {};
    }
    get name() {
        return this.privName;
    }
    get eventId() {
        return this.privEventId;
    }
    get eventTime() {
        return this.privEventTime;
    }
    get eventType() {
        return this.privEventType;
    }
    get metadata() {
        return this.privMetadata;
    }
}

//# sourceMappingURL=PlatformEvent.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js ***!
  \**************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Deferred": () => (/* binding */ Deferred),
/* harmony export */   "PromiseResult": () => (/* binding */ PromiseResult),
/* harmony export */   "PromiseResultEventSource": () => (/* binding */ PromiseResultEventSource),
/* harmony export */   "PromiseState": () => (/* binding */ PromiseState),
/* harmony export */   "Sink": () => (/* binding */ Sink),
/* harmony export */   "marshalPromiseToCallbacks": () => (/* binding */ marshalPromiseToCallbacks)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file, @typescript-eslint/typedef */
var PromiseState;
(function (PromiseState) {
    PromiseState[PromiseState["None"] = 0] = "None";
    PromiseState[PromiseState["Resolved"] = 1] = "Resolved";
    PromiseState[PromiseState["Rejected"] = 2] = "Rejected";
})(PromiseState || (PromiseState = {}));
class PromiseResult {
    constructor(promiseResultEventSource) {
        this.throwIfError = () => {
            if (this.isError) {
                throw this.error;
            }
        };
        promiseResultEventSource.on((result) => {
            if (!this.privIsCompleted) {
                this.privIsCompleted = true;
                this.privIsError = false;
                this.privResult = result;
            }
        }, (error) => {
            if (!this.privIsCompleted) {
                this.privIsCompleted = true;
                this.privIsError = true;
                this.privError = error;
            }
        });
    }
    get isCompleted() {
        return this.privIsCompleted;
    }
    get isError() {
        return this.privIsError;
    }
    get error() {
        return this.privError;
    }
    get result() {
        return this.privResult;
    }
}
class PromiseResultEventSource {
    constructor() {
        this.setResult = (result) => {
            this.privOnSetResult(result);
        };
        this.setError = (error) => {
            this.privOnSetError(error);
        };
        this.on = (onSetResult, onSetError) => {
            this.privOnSetResult = onSetResult;
            this.privOnSetError = onSetError;
        };
    }
}
class Deferred {
    constructor() {
        this.resolve = (result) => {
            this.privResolve(result);
            return this;
        };
        this.reject = (error) => {
            this.privReject(error);
            return this;
        };
        // eslint-disable-next-line @typescript-eslint/explicit-function-return-type
        this.privPromise = new Promise((resolve, reject) => {
            this.privResolve = resolve;
            this.privReject = reject;
        });
    }
    get promise() {
        return this.privPromise;
    }
}
class Sink {
    constructor() {
        this.privState = PromiseState.None;
        this.privPromiseResult = null;
        this.privPromiseResultEvents = null;
        this.privSuccessHandlers = [];
        this.privErrorHandlers = [];
        this.privPromiseResultEvents = new PromiseResultEventSource();
        this.privPromiseResult = new PromiseResult(this.privPromiseResultEvents);
    }
    get state() {
        return this.privState;
    }
    get result() {
        return this.privPromiseResult;
    }
    resolve(result) {
        if (this.privState !== PromiseState.None) {
            throw new Error("'Cannot resolve a completed promise'");
        }
        this.privState = PromiseState.Resolved;
        this.privPromiseResultEvents.setResult(result);
        for (let i = 0; i < this.privSuccessHandlers.length; i++) {
            this.executeSuccessCallback(result, this.privSuccessHandlers[i], this.privErrorHandlers[i]);
        }
        this.detachHandlers();
    }
    reject(error) {
        if (this.privState !== PromiseState.None) {
            throw new Error("'Cannot reject a completed promise'");
        }
        this.privState = PromiseState.Rejected;
        this.privPromiseResultEvents.setError(error);
        for (const errorHandler of this.privErrorHandlers) {
            this.executeErrorCallback(error, errorHandler);
        }
        this.detachHandlers();
    }
    on(successCallback, errorCallback) {
        if (successCallback == null) {
            // eslint-disable-next-line @typescript-eslint/no-empty-function
            successCallback = () => { };
        }
        if (this.privState === PromiseState.None) {
            this.privSuccessHandlers.push(successCallback);
            this.privErrorHandlers.push(errorCallback);
        }
        else {
            if (this.privState === PromiseState.Resolved) {
                this.executeSuccessCallback(this.privPromiseResult.result, successCallback, errorCallback);
            }
            else if (this.privState === PromiseState.Rejected) {
                this.executeErrorCallback(this.privPromiseResult.error, errorCallback);
            }
            this.detachHandlers();
        }
    }
    executeSuccessCallback(result, successCallback, errorCallback) {
        try {
            successCallback(result);
        }
        catch (e) {
            this.executeErrorCallback(`'Unhandled callback error: ${e}'`, errorCallback);
        }
    }
    executeErrorCallback(error, errorCallback) {
        if (errorCallback) {
            try {
                errorCallback(error);
            }
            catch (e) {
                throw new Error(`'Unhandled callback error: ${e}. InnerError: ${error}'`);
            }
        }
        else {
            throw new Error(`'Unhandled error: ${error}'`);
        }
    }
    detachHandlers() {
        this.privErrorHandlers = [];
        this.privSuccessHandlers = [];
    }
}
// eslint-disable-next-line prefer-arrow/prefer-arrow-functions
function marshalPromiseToCallbacks(promise, cb, err) {
    promise.then((val) => {
        try {
            if (!!cb) {
                cb(val);
            }
        }
        catch (error) {
            if (!!err) {
                try {
                    if (error instanceof Error) {
                        const typedError = error;
                        err(typedError.name + ": " + typedError.message);
                    }
                    else {
                        err(error);
                    }
                    // eslint-disable-next-line no-empty
                }
                catch (error) { }
            }
        }
    }, (error) => {
        if (!!err) {
            try {
                if (error instanceof Error) {
                    const typedError = error;
                    err(typedError.name + ": " + typedError.message);
                }
                else {
                    err(error);
                }
                // eslint-disable-next-line no-empty
            }
            catch (error) { }
        }
    });
}

//# sourceMappingURL=Promise.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Queue.js":
/*!************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Queue.js ***!
  \************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Queue": () => (/* binding */ Queue)
/* harmony export */ });
/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Error */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _List__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./List */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/List.js");
/* harmony import */ var _Promise__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Promise */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



var SubscriberType;
(function (SubscriberType) {
    SubscriberType[SubscriberType["Dequeue"] = 0] = "Dequeue";
    SubscriberType[SubscriberType["Peek"] = 1] = "Peek";
})(SubscriberType || (SubscriberType = {}));
class Queue {
    constructor(list) {
        this.privPromiseStore = new _List__WEBPACK_IMPORTED_MODULE_0__.List();
        this.privIsDrainInProgress = false;
        this.privIsDisposing = false;
        this.privDisposeReason = null;
        this.privList = list ? list : new _List__WEBPACK_IMPORTED_MODULE_0__.List();
        this.privDetachables = [];
        this.privSubscribers = new _List__WEBPACK_IMPORTED_MODULE_0__.List();
        this.privDetachables.push(this.privList.onAdded(() => this.drain()));
    }
    enqueue(item) {
        this.throwIfDispose();
        this.enqueueFromPromise(new Promise((resolve) => resolve(item)));
    }
    enqueueFromPromise(promise) {
        this.throwIfDispose();
        promise.then((val) => {
            this.privList.add(val);
            // eslint-disable-next-line @typescript-eslint/no-empty-function
        }, () => { });
    }
    dequeue() {
        this.throwIfDispose();
        const deferredSubscriber = new _Promise__WEBPACK_IMPORTED_MODULE_1__.Deferred();
        if (this.privSubscribers) {
            this.privSubscribers.add({ deferral: deferredSubscriber, type: SubscriberType.Dequeue });
            this.drain();
        }
        return deferredSubscriber.promise;
    }
    peek() {
        this.throwIfDispose();
        const deferredSubscriber = new _Promise__WEBPACK_IMPORTED_MODULE_1__.Deferred();
        const subs = this.privSubscribers;
        if (subs) {
            this.privSubscribers.add({ deferral: deferredSubscriber, type: SubscriberType.Peek });
            this.drain();
        }
        return deferredSubscriber.promise;
    }
    length() {
        this.throwIfDispose();
        return this.privList.length();
    }
    isDisposed() {
        return this.privSubscribers == null;
    }
    drainAndDispose(pendingItemProcessor, reason) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.isDisposed() && !this.privIsDisposing) {
                this.privDisposeReason = reason;
                this.privIsDisposing = true;
                const subs = this.privSubscribers;
                if (subs) {
                    while (subs.length() > 0) {
                        const subscriber = subs.removeFirst();
                        // TODO: this needs work (Resolve(null) instead?).
                        subscriber.deferral.resolve(undefined);
                        // subscriber.deferral.reject("Disposed");
                    }
                    // note: this block assumes cooperative multitasking, i.e.,
                    // between the if-statement and the assignment there are no
                    // thread switches.
                    // Reason is that between the initial const = this.; and this
                    // point there is the derral.resolve() operation that might have
                    // caused recursive calls to the Queue, especially, calling
                    // Dispose() on the queue alredy (which would reset the var
                    // here to null!).
                    // That should generally hold true for javascript...
                    if (this.privSubscribers === subs) {
                        this.privSubscribers = subs;
                    }
                }
                for (const detachable of this.privDetachables) {
                    yield detachable.detach();
                }
                if (this.privPromiseStore.length() > 0 && pendingItemProcessor) {
                    const promiseArray = [];
                    this.privPromiseStore.toArray().forEach((wrapper) => {
                        promiseArray.push(wrapper);
                    });
                    return Promise.all(promiseArray).finally(() => {
                        this.privSubscribers = null;
                        this.privList.forEach((item) => {
                            pendingItemProcessor(item);
                        });
                        this.privList = null;
                        return;
                    }).then();
                }
                else {
                    this.privSubscribers = null;
                    this.privList = null;
                }
            }
        });
    }
    dispose(reason) {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.drainAndDispose(null, reason);
        });
    }
    drain() {
        if (!this.privIsDrainInProgress && !this.privIsDisposing) {
            this.privIsDrainInProgress = true;
            const subs = this.privSubscribers;
            const lists = this.privList;
            if (subs && lists) {
                while (lists.length() > 0 && subs.length() > 0 && !this.privIsDisposing) {
                    const subscriber = subs.removeFirst();
                    if (subscriber.type === SubscriberType.Peek) {
                        subscriber.deferral.resolve(lists.first());
                    }
                    else {
                        const dequeuedItem = lists.removeFirst();
                        subscriber.deferral.resolve(dequeuedItem);
                    }
                }
                // note: this block assumes cooperative multitasking, i.e.,
                // between the if-statement and the assignment there are no
                // thread switches.
                // Reason is that between the initial const = this.; and this
                // point there is the derral.resolve() operation that might have
                // caused recursive calls to the Queue, especially, calling
                // Dispose() on the queue alredy (which would reset the var
                // here to null!).
                // That should generally hold true for javascript...
                if (this.privSubscribers === subs) {
                    this.privSubscribers = subs;
                }
                // note: this block assumes cooperative multitasking, i.e.,
                // between the if-statement and the assignment there are no
                // thread switches.
                // Reason is that between the initial const = this.; and this
                // point there is the derral.resolve() operation that might have
                // caused recursive calls to the Queue, especially, calling
                // Dispose() on the queue alredy (which would reset the var
                // here to null!).
                // That should generally hold true for javascript...
                if (this.privList === lists) {
                    this.privList = lists;
                }
            }
            this.privIsDrainInProgress = false;
        }
    }
    throwIfDispose() {
        if (this.isDisposed()) {
            if (this.privDisposeReason) {
                throw new _Error__WEBPACK_IMPORTED_MODULE_2__.InvalidOperationError(this.privDisposeReason);
            }
            throw new _Error__WEBPACK_IMPORTED_MODULE_2__.ObjectDisposedError("Queue");
        }
        else if (this.privIsDisposing) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_2__.InvalidOperationError("Queue disposing");
        }
    }
}

//# sourceMappingURL=Queue.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/RawWebsocketMessage.js":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/RawWebsocketMessage.js ***!
  \**************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RawWebsocketMessage": () => (/* binding */ RawWebsocketMessage)
/* harmony export */ });
/* harmony import */ var _ConnectionMessage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ConnectionMessage */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Error */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _Guid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Guid */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* eslint-disable @typescript-eslint/no-unsafe-assignment */
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



class RawWebsocketMessage {
    constructor(messageType, payload, id) {
        this.privPayload = null;
        if (!payload) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("payload");
        }
        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access
        if (messageType === _ConnectionMessage__WEBPACK_IMPORTED_MODULE_1__.MessageType.Binary && payload.__proto__.constructor.name !== "ArrayBuffer") {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Payload must be ArrayBuffer");
        }
        if (messageType === _ConnectionMessage__WEBPACK_IMPORTED_MODULE_1__.MessageType.Text && !(typeof (payload) === "string")) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Payload must be a string");
        }
        this.privMessageType = messageType;
        this.privPayload = payload;
        this.privId = id ? id : (0,_Guid__WEBPACK_IMPORTED_MODULE_2__.createNoDashGuid)();
    }
    get messageType() {
        return this.privMessageType;
    }
    get payload() {
        // eslint-disable-next-line @typescript-eslint/no-unsafe-return
        return this.privPayload;
    }
    get textContent() {
        if (this.privMessageType === _ConnectionMessage__WEBPACK_IMPORTED_MODULE_1__.MessageType.Binary) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Not supported for binary message");
        }
        return this.privPayload;
    }
    get binaryContent() {
        if (this.privMessageType === _ConnectionMessage__WEBPACK_IMPORTED_MODULE_1__.MessageType.Text) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Not supported for text message");
        }
        return this.privPayload;
    }
    get id() {
        return this.privId;
    }
}

//# sourceMappingURL=RawWebsocketMessage.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/RiffPcmEncoder.js":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/RiffPcmEncoder.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RiffPcmEncoder": () => (/* binding */ RiffPcmEncoder)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class RiffPcmEncoder {
    constructor(actualSampleRate, desiredSampleRate) {
        this.privActualSampleRate = actualSampleRate;
        this.privDesiredSampleRate = desiredSampleRate;
    }
    encode(actualAudioFrame) {
        const audioFrame = this.downSampleAudioFrame(actualAudioFrame, this.privActualSampleRate, this.privDesiredSampleRate);
        if (!audioFrame) {
            return null;
        }
        const audioLength = audioFrame.length * 2;
        const buffer = new ArrayBuffer(audioLength);
        const view = new DataView(buffer);
        this.floatTo16BitPCM(view, 0, audioFrame);
        return buffer;
    }
    setString(view, offset, str) {
        for (let i = 0; i < str.length; i++) {
            view.setUint8(offset + i, str.charCodeAt(i));
        }
    }
    floatTo16BitPCM(view, offset, input) {
        for (let i = 0; i < input.length; i++, offset += 2) {
            const s = Math.max(-1, Math.min(1, input[i]));
            view.setInt16(offset, s < 0 ? s * 0x8000 : s * 0x7FFF, true);
        }
    }
    downSampleAudioFrame(srcFrame, srcRate, dstRate) {
        if (!srcFrame) {
            return null;
        }
        if (dstRate === srcRate || dstRate > srcRate) {
            return srcFrame;
        }
        const ratio = srcRate / dstRate;
        const dstLength = Math.round(srcFrame.length / ratio);
        const dstFrame = new Float32Array(dstLength);
        let srcOffset = 0;
        let dstOffset = 0;
        while (dstOffset < dstLength) {
            const nextSrcOffset = Math.round((dstOffset + 1) * ratio);
            let accum = 0;
            let count = 0;
            while (srcOffset < nextSrcOffset && srcOffset < srcFrame.length) {
                accum += srcFrame[srcOffset++];
                count++;
            }
            dstFrame[dstOffset++] = accum / count;
        }
        return dstFrame;
    }
}

//# sourceMappingURL=RiffPcmEncoder.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Stream.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Stream.js ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Stream": () => (/* binding */ Stream)
/* harmony export */ });
/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Error */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _Guid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Guid */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _Queue__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Queue */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Queue.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



class Stream {
    constructor(streamId) {
        this.privIsWriteEnded = false;
        this.privIsReadEnded = false;
        this.privId = streamId ? streamId : (0,_Guid__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privReaderQueue = new _Queue__WEBPACK_IMPORTED_MODULE_1__.Queue();
    }
    get isClosed() {
        return this.privIsWriteEnded;
    }
    get isReadEnded() {
        return this.privIsReadEnded;
    }
    get id() {
        return this.privId;
    }
    close() {
        if (!this.privIsWriteEnded) {
            this.writeStreamChunk({
                buffer: null,
                isEnd: true,
                timeReceived: Date.now(),
            });
            this.privIsWriteEnded = true;
        }
    }
    writeStreamChunk(streamChunk) {
        this.throwIfClosed();
        if (!this.privReaderQueue.isDisposed()) {
            try {
                this.privReaderQueue.enqueue(streamChunk);
            }
            catch (e) {
                // Do nothing
            }
        }
    }
    read() {
        if (this.privIsReadEnded) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_2__.InvalidOperationError("Stream read has already finished");
        }
        return this.privReaderQueue
            .dequeue()
            .then((streamChunk) => __awaiter(this, void 0, void 0, function* () {
            if (streamChunk === undefined || streamChunk.isEnd) {
                yield this.privReaderQueue.dispose("End of stream reached");
            }
            return streamChunk;
        }));
    }
    readEnded() {
        if (!this.privIsReadEnded) {
            this.privIsReadEnded = true;
            this.privReaderQueue = new _Queue__WEBPACK_IMPORTED_MODULE_1__.Queue();
        }
    }
    throwIfClosed() {
        if (this.privIsWriteEnded) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_2__.InvalidOperationError("Stream closed");
        }
    }
}

//# sourceMappingURL=Stream.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/StringUtils.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/StringUtils.js ***!
  \******************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "StringUtils": () => (/* binding */ StringUtils)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * String helper functions
 */
class StringUtils {
    /**
     * Formats a string by replacing the named {keys} in the string with the values contained in the replacement dictionary.
     * @param format The format string that contains the parts to replace surrounded by {}. For example: "wss://{region}.cts.speech.microsoft.com".
     * If your string needs to contain a { or } you can use the {{ and }} escape sequences respectively.
     * @param replacements The dictionary of replacements. If a replacement is not found, it is replaced with an empty string
     * @returns The formatted string. If you pass in a null or undefined format string, an empty string will be returned
     */
    static formatString(format, replacements) {
        if (!format) {
            return "";
        }
        if (!replacements) {
            return format;
        }
        let formatted = "";
        let key = "";
        const appendToFormatted = (str) => {
            formatted += str;
        };
        const appendToKey = (str) => {
            key += str;
        };
        let appendFunc = appendToFormatted;
        for (let i = 0; i < format.length; i++) {
            const c = format[i];
            const next = i + 1 < format.length ? format[i + 1] : "";
            switch (c) {
                case "{":
                    if (next === "{") {
                        appendFunc("{");
                        i++;
                    }
                    else {
                        appendFunc = appendToKey;
                    }
                    break;
                case "}":
                    if (next === "}") {
                        appendFunc("}");
                        i++;
                    }
                    else {
                        if (replacements.hasOwnProperty(key)) {
                            formatted += replacements[key];
                        }
                        appendFunc = appendToFormatted;
                        key = "";
                    }
                    break;
                default:
                    appendFunc(c);
                    break;
            }
        }
        return formatted;
    }
}

//# sourceMappingURL=StringUtils.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Timeout.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Timeout.js ***!
  \**************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Timeout": () => (/* binding */ Timeout)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class Timeout {
    static load() {
        // Prefilling the Maps with a function indexed by zero is necessary to be compliant with the specification.
        const scheduledTimeoutFunctions = new Map([[0, () => { }]]); // eslint-disable-line @typescript-eslint/no-empty-function
        const unhandledRequests = new Map();
        // eslint-disable-next-line
        const workerScript = `!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error('There is no interval scheduled with the given id "'.concat(e,'".'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error('The given method "'.concat(e.method,'" is not supported'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);`;
        const workerUrl = "data:text/javascript;base64," + btoa(workerScript);
        const worker = new Worker(workerUrl);
        worker.addEventListener("message", ({ data }) => {
            if (Timeout.isCallNotification(data)) {
                const { params: { timerId } } = data;
                const idOrFunc = scheduledTimeoutFunctions.get(timerId);
                if (typeof idOrFunc === "number") {
                    const unhandledTimerId = unhandledRequests.get(idOrFunc);
                    if (unhandledTimerId === undefined ||
                        unhandledTimerId !== timerId) {
                        throw new Error("The timer is in an undefined state.");
                    }
                }
                else if (typeof idOrFunc !== "undefined") {
                    idOrFunc();
                    // A timeout can be safely deleted because it is only called once.
                    scheduledTimeoutFunctions.delete(timerId);
                }
                else {
                    throw new Error("The timer is in an undefined state.");
                }
            }
            else if (Timeout.isClearResponse(data)) {
                const { id } = data;
                const unhandledTimerId = unhandledRequests.get(id);
                if (unhandledTimerId === undefined) {
                    throw new Error("The timer is in an undefined state.");
                }
                unhandledRequests.delete(id);
                scheduledTimeoutFunctions.delete(unhandledTimerId);
            }
            else {
                const { error: { message } } = data;
                throw new Error(message);
            }
        });
        const clearTimeout = (timerId) => {
            const id = Math.random();
            unhandledRequests.set(id, timerId);
            scheduledTimeoutFunctions.set(timerId, id);
            worker.postMessage({
                id,
                method: "clear",
                params: { timerId }
            });
        };
        const setTimeout = (func, delay) => {
            const timerId = Math.random();
            scheduledTimeoutFunctions.set(timerId, func);
            worker.postMessage({
                id: null,
                method: "set",
                params: {
                    delay,
                    now: performance.now(),
                    timerId
                }
            });
            return timerId;
        };
        return {
            clearTimeout,
            setTimeout
        };
    }
    static loadWorkerTimers() {
        return () => {
            if (Timeout.workerTimers !== null) {
                return Timeout.workerTimers;
            }
            Timeout.workerTimers = Timeout.load();
            return Timeout.workerTimers;
        };
    }
    static isCallNotification(message) {
        return message.method !== undefined && message.method === "call";
    }
    static isClearResponse(message) {
        return message.error === null && typeof message.id === "number";
    }
}
Timeout.workerTimers = null;
Timeout.clearTimeout = (timerId) => Timeout.timers().clearTimeout(timerId);
Timeout.setTimeout = (func, delay) => Timeout.timers().setTimeout(func, delay);
Timeout.timers = Timeout.loadWorkerTimers();

//# sourceMappingURL=Timeout.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ActivityReceivedEventArgs.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ActivityReceivedEventArgs.js ***!
  \*****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ActivityReceivedEventArgs": () => (/* binding */ ActivityReceivedEventArgs)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines contents of received message/events.
 * @class ActivityReceivedEventArgs
 */
class ActivityReceivedEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {any} activity - The activity..
     */
    constructor(activity, audioStream) {
        this.privActivity = activity;
        this.privAudioStream = audioStream;
    }
    /**
     * Gets the received activity
     * @member ActivityReceivedEventArgs.prototype.activity
     * @function
     * @public
     * @returns {any} the received activity.
     */
    get activity() {
        return this.privActivity;
    }
    get audioStream() {
        return this.privAudioStream;
    }
}

//# sourceMappingURL=ActivityReceivedEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioConfig.js":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioConfig.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioConfig": () => (/* binding */ AudioConfig),
/* harmony export */   "AudioConfigImpl": () => (/* binding */ AudioConfigImpl),
/* harmony export */   "AudioOutputConfigImpl": () => (/* binding */ AudioOutputConfigImpl)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/PCMRecorder.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/MicAudioSource.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/FileAudioSource.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/PullAudioInputStreamCallback.js");
/* harmony import */ var _AudioInputStream__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./AudioInputStream */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioInputStream.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/SpeakerAudioDestination.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/PushAudioOutputStreamCallback.js");
/* harmony import */ var _AudioOutputStream__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./AudioOutputStream */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputStream.js");
/* harmony import */ var _AudioFileWriter__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./AudioFileWriter */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioFileWriter.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.






/**
 * Represents audio input configuration used for specifying what type of input to use (microphone, file, stream).
 * @class AudioConfig
 * Updated in version 1.11.0
 */
class AudioConfig {
    /**
     * Creates an AudioConfig object representing the default microphone on the system.
     * @member AudioConfig.fromDefaultMicrophoneInput
     * @function
     * @public
     * @returns {AudioConfig} The audio input configuration being created.
     */
    static fromDefaultMicrophoneInput() {
        const pcmRecorder = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_0__.PcmRecorder(true);
        return new AudioConfigImpl(new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__.MicAudioSource(pcmRecorder));
    }
    /**
     * Creates an AudioConfig object representing a microphone with the specified device ID.
     * @member AudioConfig.fromMicrophoneInput
     * @function
     * @public
     * @param {string | undefined} deviceId - Specifies the device ID of the microphone to be used.
     * Default microphone is used the value is omitted.
     * @returns {AudioConfig} The audio input configuration being created.
     */
    static fromMicrophoneInput(deviceId) {
        const pcmRecorder = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_0__.PcmRecorder(true);
        return new AudioConfigImpl(new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__.MicAudioSource(pcmRecorder, deviceId));
    }
    /**
     * Creates an AudioConfig object representing the specified file.
     * @member AudioConfig.fromWavFileInput
     * @function
     * @public
     * @param {File} fileName - Specifies the audio input file. Currently, only WAV / PCM is supported.
     * @returns {AudioConfig} The audio input configuration being created.
     */
    static fromWavFileInput(file, name = "unnamedBuffer.wav") {
        return new AudioConfigImpl(new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_2__.FileAudioSource(file, name));
    }
    /**
     * Creates an AudioConfig object representing the specified stream.
     * @member AudioConfig.fromStreamInput
     * @function
     * @public
     * @param {AudioInputStream | PullAudioInputStreamCallback | MediaStream} audioStream - Specifies the custom audio input
     * stream. Currently, only WAV / PCM is supported.
     * @returns {AudioConfig} The audio input configuration being created.
     */
    static fromStreamInput(audioStream) {
        if (audioStream instanceof _Exports__WEBPACK_IMPORTED_MODULE_3__.PullAudioInputStreamCallback) {
            return new AudioConfigImpl(new _AudioInputStream__WEBPACK_IMPORTED_MODULE_4__.PullAudioInputStreamImpl(audioStream));
        }
        if (audioStream instanceof _AudioInputStream__WEBPACK_IMPORTED_MODULE_4__.AudioInputStream) {
            return new AudioConfigImpl(audioStream);
        }
        if (typeof MediaStream !== "undefined" && audioStream instanceof MediaStream) {
            const pcmRecorder = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_0__.PcmRecorder(false);
            return new AudioConfigImpl(new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__.MicAudioSource(pcmRecorder, null, null, audioStream));
        }
        throw new Error("Not Supported Type");
    }
    /**
     * Creates an AudioConfig object representing the default speaker.
     * @member AudioConfig.fromDefaultSpeakerOutput
     * @function
     * @public
     * @returns {AudioConfig} The audio output configuration being created.
     * Added in version 1.11.0
     */
    static fromDefaultSpeakerOutput() {
        return new AudioOutputConfigImpl(new _Exports__WEBPACK_IMPORTED_MODULE_5__.SpeakerAudioDestination());
    }
    /**
     * Creates an AudioConfig object representing the custom IPlayer object.
     * You can use the IPlayer object to control pause, resume, etc.
     * @member AudioConfig.fromSpeakerOutput
     * @function
     * @public
     * @param {IPlayer} player - the IPlayer object for playback.
     * @returns {AudioConfig} The audio output configuration being created.
     * Added in version 1.12.0
     */
    static fromSpeakerOutput(player) {
        if (player === undefined) {
            return AudioConfig.fromDefaultSpeakerOutput();
        }
        if (player instanceof _Exports__WEBPACK_IMPORTED_MODULE_5__.SpeakerAudioDestination) {
            return new AudioOutputConfigImpl(player);
        }
        throw new Error("Not Supported Type");
    }
    /**
     * Creates an AudioConfig object representing a specified output audio file
     * @member AudioConfig.fromAudioFileOutput
     * @function
     * @public
     * @param {PathLike} filename - the filename of the output audio file
     * @returns {AudioConfig} The audio output configuration being created.
     * Added in version 1.11.0
     */
    static fromAudioFileOutput(filename) {
        return new AudioOutputConfigImpl(new _AudioFileWriter__WEBPACK_IMPORTED_MODULE_6__.AudioFileWriter(filename));
    }
    /**
     * Creates an AudioConfig object representing a specified audio output stream
     * @member AudioConfig.fromStreamOutput
     * @function
     * @public
     * @param {AudioOutputStream | PushAudioOutputStreamCallback} audioStream - Specifies the custom audio output
     * stream.
     * @returns {AudioConfig} The audio output configuration being created.
     * Added in version 1.11.0
     */
    static fromStreamOutput(audioStream) {
        if (audioStream instanceof _Exports__WEBPACK_IMPORTED_MODULE_7__.PushAudioOutputStreamCallback) {
            return new AudioOutputConfigImpl(new _AudioOutputStream__WEBPACK_IMPORTED_MODULE_8__.PushAudioOutputStreamImpl(audioStream));
        }
        if (audioStream instanceof _AudioOutputStream__WEBPACK_IMPORTED_MODULE_8__.PushAudioOutputStream) {
            return new AudioOutputConfigImpl(audioStream);
        }
        if (audioStream instanceof _AudioOutputStream__WEBPACK_IMPORTED_MODULE_8__.PullAudioOutputStream) {
            return new AudioOutputConfigImpl(audioStream);
        }
        throw new Error("Not Supported Type");
    }
}
/**
 * Represents audio input stream used for custom audio input configurations.
 * @private
 * @class AudioConfigImpl
 */
class AudioConfigImpl extends AudioConfig {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {IAudioSource} source - An audio source.
     */
    constructor(source) {
        super();
        this.privSource = source;
    }
    /**
     * Format information for the audio
     */
    get format() {
        return this.privSource.format;
    }
    /**
     * @member AudioConfigImpl.prototype.close
     * @function
     * @public
     */
    close(cb, err) {
        this.privSource.turnOff().then(() => {
            if (!!cb) {
                cb();
            }
        }, (error) => {
            if (!!err) {
                err(error);
            }
        });
    }
    /**
     * @member AudioConfigImpl.prototype.id
     * @function
     * @public
     */
    id() {
        return this.privSource.id();
    }
    /**
     * @member AudioConfigImpl.prototype.turnOn
     * @function
     * @public
     * @returns {Promise<void>} A promise.
     */
    turnOn() {
        return this.privSource.turnOn();
    }
    /**
     * @member AudioConfigImpl.prototype.attach
     * @function
     * @public
     * @param {string} audioNodeId - The audio node id.
     * @returns {Promise<IAudioStreamNode>} A promise.
     */
    attach(audioNodeId) {
        return this.privSource.attach(audioNodeId);
    }
    /**
     * @member AudioConfigImpl.prototype.detach
     * @function
     * @public
     * @param {string} audioNodeId - The audio node id.
     */
    detach(audioNodeId) {
        return this.privSource.detach(audioNodeId);
    }
    /**
     * @member AudioConfigImpl.prototype.turnOff
     * @function
     * @public
     * @returns {Promise<void>} A promise.
     */
    turnOff() {
        return this.privSource.turnOff();
    }
    /**
     * @member AudioConfigImpl.prototype.events
     * @function
     * @public
     * @returns {EventSource<AudioSourceEvent>} An event source for audio events.
     */
    get events() {
        return this.privSource.events;
    }
    setProperty(name, value) {
        _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNull(value, "value");
        if (undefined !== this.privSource.setProperty) {
            this.privSource.setProperty(name, value);
        }
        else {
            throw new Error("This AudioConfig instance does not support setting properties.");
        }
    }
    getProperty(name, def) {
        if (undefined !== this.privSource.getProperty) {
            return this.privSource.getProperty(name, def);
        }
        else {
            throw new Error("This AudioConfig instance does not support getting properties.");
        }
        return def;
    }
    get deviceInfo() {
        return this.privSource.deviceInfo;
    }
}
class AudioOutputConfigImpl extends AudioConfig {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {IAudioDestination} destination - An audio destination.
     */
    constructor(destination) {
        super();
        this.privDestination = destination;
    }
    set format(format) {
        this.privDestination.format = format;
    }
    write(buffer) {
        this.privDestination.write(buffer);
    }
    close() {
        this.privDestination.close();
    }
    id() {
        return this.privDestination.id();
    }
    setProperty() {
        throw new Error("This AudioConfig instance does not support setting properties.");
    }
    getProperty() {
        throw new Error("This AudioConfig instance does not support getting properties.");
    }
}

//# sourceMappingURL=AudioConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioFileWriter.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioFileWriter.js ***!
  \*************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioFileWriter": () => (/* binding */ AudioFileWriter)
/* harmony export */ });
/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ "?9463");
/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


class AudioFileWriter {
    constructor(filename) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(fs__WEBPACK_IMPORTED_MODULE_0__.openSync, "\nFile System access not available, please use Push or PullAudioOutputStream");
        this.privFd = fs__WEBPACK_IMPORTED_MODULE_0__.openSync(filename, "w");
    }
    set format(format) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNotUndefined(this.privAudioFormat, "format is already set");
        this.privAudioFormat = format;
        let headerOffset = 0;
        if (this.privAudioFormat.hasHeader) {
            headerOffset = this.privAudioFormat.header.byteLength;
        }
        if (this.privFd !== undefined) {
            this.privWriteStream = fs__WEBPACK_IMPORTED_MODULE_0__.createWriteStream("", { fd: this.privFd, start: headerOffset, autoClose: false });
        }
    }
    write(buffer) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(this.privAudioFormat, "must set format before writing.");
        if (this.privWriteStream !== undefined) {
            this.privWriteStream.write(new Uint8Array(buffer.slice(0)));
        }
    }
    close() {
        if (this.privFd !== undefined) {
            this.privWriteStream.on("finish", () => {
                if (this.privAudioFormat.hasHeader) {
                    this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten);
                    fs__WEBPACK_IMPORTED_MODULE_0__.writeSync(this.privFd, new Int8Array(this.privAudioFormat.header), 0, this.privAudioFormat.header.byteLength, 0);
                }
                fs__WEBPACK_IMPORTED_MODULE_0__.closeSync(this.privFd);
                this.privFd = undefined;
            });
            this.privWriteStream.end();
        }
    }
    id() {
        return this.privId;
    }
}

//# sourceMappingURL=AudioFileWriter.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioInputStream.js":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioInputStream.js ***!
  \**************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioInputStream": () => (/* binding */ AudioInputStream),
/* harmony export */   "PullAudioInputStream": () => (/* binding */ PullAudioInputStream),
/* harmony export */   "PullAudioInputStreamImpl": () => (/* binding */ PullAudioInputStreamImpl),
/* harmony export */   "PushAudioInputStream": () => (/* binding */ PushAudioInputStream),
/* harmony export */   "PushAudioInputStreamImpl": () => (/* binding */ PushAudioInputStreamImpl)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ChunkedArrayBufferStream.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/AudioSourceEvents.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _common_Guid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../common/Guid */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AudioStreamFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioStreamFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
/* eslint-disable max-classes-per-file */





/**
 * Represents audio input stream used for custom audio input configurations.
 * @class AudioInputStream
 */
class AudioInputStream {
    /**
     * Creates and initializes an instance.
     * @constructor
     */
    constructor() {
        return;
    }
    /**
     * Creates a memory backed PushAudioInputStream with the specified audio format.
     * @member AudioInputStream.createPushStream
     * @function
     * @public
     * @param {AudioStreamFormat} format - The audio data format in which audio will be
     * written to the push audio stream's write() method (Required if format is not 16 kHz 16bit mono PCM).
     * @returns {PushAudioInputStream} The audio input stream being created.
     */
    static createPushStream(format) {
        return PushAudioInputStream.create(format);
    }
    /**
     * Creates a PullAudioInputStream that delegates to the specified callback interface for read()
     * and close() methods.
     * @member AudioInputStream.createPullStream
     * @function
     * @public
     * @param {PullAudioInputStreamCallback} callback - The custom audio input object, derived from
     * PullAudioInputStreamCallback
     * @param {AudioStreamFormat} format - The audio data format in which audio will be returned from
     * the callback's read() method (Required if format is not 16 kHz 16bit mono PCM).
     * @returns {PullAudioInputStream} The audio input stream being created.
     */
    static createPullStream(callback, format) {
        return PullAudioInputStream.create(callback, format);
        // throw new Error("Oops");
    }
}
/**
 * Represents memory backed push audio input stream used for custom audio input configurations.
 * @class PushAudioInputStream
 */
class PushAudioInputStream extends AudioInputStream {
    /**
     * Creates a memory backed PushAudioInputStream with the specified audio format.
     * @member PushAudioInputStream.create
     * @function
     * @public
     * @param {AudioStreamFormat} format - The audio data format in which audio will be written to the
     * push audio stream's write() method (Required if format is not 16 kHz 16bit mono PCM).
     * @returns {PushAudioInputStream} The push audio input stream being created.
     */
    static create(format) {
        return new PushAudioInputStreamImpl(format);
    }
}
/**
 * Represents memory backed push audio input stream used for custom audio input configurations.
 * @private
 * @class PushAudioInputStreamImpl
 */
class PushAudioInputStreamImpl extends PushAudioInputStream {
    /**
     * Creates and initalizes an instance with the given values.
     * @constructor
     * @param {AudioStreamFormat} format - The audio stream format.
     */
    constructor(format) {
        super();
        if (format === undefined) {
            this.privFormat = _AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioStreamFormatImpl.getDefaultInputFormat();
        }
        else {
            this.privFormat = format;
        }
        this.privEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.EventSource();
        this.privId = (0,_common_Guid__WEBPACK_IMPORTED_MODULE_2__.createNoDashGuid)();
        this.privStream = new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.ChunkedArrayBufferStream(this.privFormat.avgBytesPerSec / 10);
    }
    /**
     * Format information for the audio
     */
    get format() {
        return Promise.resolve(this.privFormat);
    }
    /**
     * Writes the audio data specified by making an internal copy of the data.
     * @member PushAudioInputStreamImpl.prototype.write
     * @function
     * @public
     * @param {ArrayBuffer} dataBuffer - The audio buffer of which this function will make a copy.
     */
    write(dataBuffer) {
        this.privStream.writeStreamChunk({
            buffer: dataBuffer,
            isEnd: false,
            timeReceived: Date.now()
        });
    }
    /**
     * Closes the stream.
     * @member PushAudioInputStreamImpl.prototype.close
     * @function
     * @public
     */
    close() {
        this.privStream.close();
    }
    id() {
        return this.privId;
    }
    turnOn() {
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioSourceInitializingEvent(this.privId)); // no stream id
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioSourceReadyEvent(this.privId));
        return;
    }
    attach(audioNodeId) {
        return __awaiter(this, void 0, void 0, function* () {
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioStreamNodeAttachingEvent(this.privId, audioNodeId));
            yield this.turnOn();
            const stream = this.privStream;
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioStreamNodeAttachedEvent(this.privId, audioNodeId));
            return {
                detach: () => __awaiter(this, void 0, void 0, function* () {
                    this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioStreamNodeDetachedEvent(this.privId, audioNodeId));
                    return this.turnOff();
                }),
                id: () => audioNodeId,
                read: () => stream.read(),
            };
        });
    }
    detach(audioNodeId) {
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioStreamNodeDetachedEvent(this.privId, audioNodeId));
    }
    turnOff() {
        return;
    }
    get events() {
        return this.privEvents;
    }
    get deviceInfo() {
        return Promise.resolve({
            bitspersample: this.privFormat.bitsPerSample,
            channelcount: this.privFormat.channels,
            connectivity: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.connectivity.Unknown,
            manufacturer: "Speech SDK",
            model: "PushStream",
            samplerate: this.privFormat.samplesPerSec,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.type.Stream,
        });
    }
    onEvent(event) {
        this.privEvents.onEvent(event);
        _common_Exports__WEBPACK_IMPORTED_MODULE_6__.Events.instance.onEvent(event);
    }
    toBuffer(arrayBuffer) {
        const buf = Buffer.alloc(arrayBuffer.byteLength);
        const view = new Uint8Array(arrayBuffer);
        for (let i = 0; i < buf.length; ++i) {
            buf[i] = view[i];
        }
        return buf;
    }
}
/*
 * Represents audio input stream used for custom audio input configurations.
 * @class PullAudioInputStream
 */
class PullAudioInputStream extends AudioInputStream {
    /**
     * Creates and initializes and instance.
     * @constructor
     */
    constructor() {
        super();
    }
    /**
     * Creates a PullAudioInputStream that delegates to the specified callback interface for
     * read() and close() methods, using the default format (16 kHz 16bit mono PCM).
     * @member PullAudioInputStream.create
     * @function
     * @public
     * @param {PullAudioInputStreamCallback} callback - The custom audio input object,
     * derived from PullAudioInputStreamCustomCallback
     * @param {AudioStreamFormat} format - The audio data format in which audio will be
     * returned from the callback's read() method (Required if format is not 16 kHz 16bit mono PCM).
     * @returns {PullAudioInputStream} The push audio input stream being created.
     */
    static create(callback, format) {
        return new PullAudioInputStreamImpl(callback, format);
    }
}
/**
 * Represents audio input stream used for custom audio input configurations.
 * @private
 * @class PullAudioInputStreamImpl
 */
class PullAudioInputStreamImpl extends PullAudioInputStream {
    /**
     * Creates a PullAudioInputStream that delegates to the specified callback interface for
     * read() and close() methods, using the default format (16 kHz 16bit mono PCM).
     * @constructor
     * @param {PullAudioInputStreamCallback} callback - The custom audio input object,
     * derived from PullAudioInputStreamCustomCallback
     * @param {AudioStreamFormat} format - The audio data format in which audio will be
     * returned from the callback's read() method (Required if format is not 16 kHz 16bit mono PCM).
     */
    constructor(callback, format) {
        super();
        if (undefined === format) {
            this.privFormat = _AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioStreamFormat.getDefaultInputFormat();
        }
        else {
            this.privFormat = format;
        }
        this.privEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.EventSource();
        this.privId = (0,_common_Guid__WEBPACK_IMPORTED_MODULE_2__.createNoDashGuid)();
        this.privCallback = callback;
        this.privIsClosed = false;
        this.privBufferSize = this.privFormat.avgBytesPerSec / 10;
    }
    /**
     * Format information for the audio
     */
    get format() {
        return Promise.resolve(this.privFormat);
    }
    /**
     * Closes the stream.
     * @member PullAudioInputStreamImpl.prototype.close
     * @function
     * @public
     */
    close() {
        this.privIsClosed = true;
        this.privCallback.close();
    }
    id() {
        return this.privId;
    }
    turnOn() {
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioSourceInitializingEvent(this.privId)); // no stream id
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioSourceReadyEvent(this.privId));
        return;
    }
    attach(audioNodeId) {
        return __awaiter(this, void 0, void 0, function* () {
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioStreamNodeAttachingEvent(this.privId, audioNodeId));
            yield this.turnOn();
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioStreamNodeAttachedEvent(this.privId, audioNodeId));
            return {
                detach: () => {
                    this.privCallback.close();
                    this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioStreamNodeDetachedEvent(this.privId, audioNodeId));
                    return this.turnOff();
                },
                id: () => audioNodeId,
                read: () => {
                    let totalBytes = 0;
                    let transmitBuff;
                    // Until we have the minimum number of bytes to send in a transmission, keep asking for more.
                    while (totalBytes < this.privBufferSize) {
                        // Sizing the read buffer to the delta between the perfect size and what's left means we won't ever get too much
                        // data back.
                        const readBuff = new ArrayBuffer(this.privBufferSize - totalBytes);
                        const pulledBytes = this.privCallback.read(readBuff);
                        // If there is no return buffer yet defined, set the return buffer to the that was just populated.
                        // This was, if we have enough data there's no copy penalty, but if we don't we have a buffer that's the
                        // preferred size allocated.
                        if (undefined === transmitBuff) {
                            transmitBuff = readBuff;
                        }
                        else {
                            // Not the first bite at the apple, so fill the return buffer with the data we got back.
                            const intView = new Int8Array(transmitBuff);
                            intView.set(new Int8Array(readBuff), totalBytes);
                        }
                        // If there are no bytes to read, just break out and be done.
                        if (0 === pulledBytes) {
                            break;
                        }
                        totalBytes += pulledBytes;
                    }
                    return Promise.resolve({
                        buffer: transmitBuff.slice(0, totalBytes),
                        isEnd: this.privIsClosed || totalBytes === 0,
                        timeReceived: Date.now(),
                    });
                },
            };
        });
    }
    detach(audioNodeId) {
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioStreamNodeDetachedEvent(this.privId, audioNodeId));
    }
    turnOff() {
        return;
    }
    get events() {
        return this.privEvents;
    }
    get deviceInfo() {
        return Promise.resolve({
            bitspersample: this.privFormat.bitsPerSample,
            channelcount: this.privFormat.channels,
            connectivity: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.connectivity.Unknown,
            manufacturer: "Speech SDK",
            model: "PullStream",
            samplerate: this.privFormat.samplesPerSec,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.type.Stream,
        });
    }
    onEvent(event) {
        this.privEvents.onEvent(event);
        _common_Exports__WEBPACK_IMPORTED_MODULE_6__.Events.instance.onEvent(event);
    }
}

//# sourceMappingURL=AudioInputStream.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputFormat.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputFormat.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioOutputFormatImpl": () => (/* binding */ AudioOutputFormatImpl)
/* harmony export */ });
/* harmony import */ var _SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../SpeechSynthesisOutputFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisOutputFormat.js");
/* harmony import */ var _AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AudioStreamFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioStreamFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


/**
 * @private
 * @class AudioOutputFormatImpl
 * Updated in version 1.17.0
 */
// eslint-disable-next-line max-classes-per-file
class AudioOutputFormatImpl extends _AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioStreamFormatImpl {
    /**
     * Creates an instance with the given values.
     * @constructor
     * @param formatTag
     * @param {number} channels - Number of channels.
     * @param {number} samplesPerSec - Samples per second.
     * @param {number} avgBytesPerSec - Average bytes per second.
     * @param {number} blockAlign - Block alignment.
     * @param {number} bitsPerSample - Bits per sample.
     * @param {string} audioFormatString - Audio format string
     * @param {string} requestAudioFormatString - Audio format string sent to service.
     * @param {boolean} hasHeader - If the format has header or not.
     */
    constructor(formatTag, channels, samplesPerSec, avgBytesPerSec, blockAlign, bitsPerSample, audioFormatString, requestAudioFormatString, hasHeader) {
        super(samplesPerSec, bitsPerSample, channels, formatTag);
        this.formatTag = formatTag;
        this.avgBytesPerSec = avgBytesPerSec;
        this.blockAlign = blockAlign;
        this.priAudioFormatString = audioFormatString;
        this.priRequestAudioFormatString = requestAudioFormatString;
        this.priHasHeader = hasHeader;
    }
    static fromSpeechSynthesisOutputFormat(speechSynthesisOutputFormat) {
        if (speechSynthesisOutputFormat === undefined) {
            return AudioOutputFormatImpl.getDefaultOutputFormat();
        }
        return AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(AudioOutputFormatImpl.SpeechSynthesisOutputFormatToString[speechSynthesisOutputFormat]);
    }
    static fromSpeechSynthesisOutputFormatString(speechSynthesisOutputFormatString) {
        switch (speechSynthesisOutputFormatString) {
            case "raw-8khz-8bit-mono-mulaw":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MuLaw, 1, 8000, 8000, 1, 8, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "riff-16khz-16kbps-mono-siren":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.Siren, 1, 16000, 2000, 40, 0, speechSynthesisOutputFormatString, "audio-16khz-16kbps-mono-siren", true);
            case "audio-16khz-16kbps-mono-siren":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.Siren, 1, 16000, 2000, 40, 0, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-16khz-32kbitrate-mono-mp3":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MP3, 1, 16000, 32 << 7, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-16khz-128kbitrate-mono-mp3":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MP3, 1, 16000, 128 << 7, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-16khz-64kbitrate-mono-mp3":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MP3, 1, 16000, 64 << 7, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-24khz-48kbitrate-mono-mp3":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MP3, 1, 24000, 48 << 7, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-24khz-96kbitrate-mono-mp3":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MP3, 1, 24000, 96 << 7, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-24khz-160kbitrate-mono-mp3":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MP3, 1, 24000, 160 << 7, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "raw-16khz-16bit-mono-truesilk":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.SILKSkype, 1, 16000, 32000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "riff-8khz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 8000, 16000, 2, 16, speechSynthesisOutputFormatString, "raw-8khz-16bit-mono-pcm", true);
            case "riff-24khz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 24000, 48000, 2, 16, speechSynthesisOutputFormatString, "raw-24khz-16bit-mono-pcm", true);
            case "riff-8khz-8bit-mono-mulaw":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MuLaw, 1, 8000, 8000, 1, 8, speechSynthesisOutputFormatString, "raw-8khz-8bit-mono-mulaw", true);
            case "raw-16khz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 16000, 32000, 2, 16, speechSynthesisOutputFormatString, "raw-16khz-16bit-mono-pcm", false);
            case "raw-24khz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 24000, 48000, 2, 16, speechSynthesisOutputFormatString, "raw-24khz-16bit-mono-pcm", false);
            case "raw-8khz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 8000, 16000, 2, 16, speechSynthesisOutputFormatString, "raw-8khz-16bit-mono-pcm", false);
            case "ogg-16khz-16bit-mono-opus":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.OGG_OPUS, 1, 16000, 8192, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "ogg-24khz-16bit-mono-opus":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.OGG_OPUS, 1, 24000, 8192, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "raw-48khz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 48000, 96000, 2, 16, speechSynthesisOutputFormatString, "raw-48khz-16bit-mono-pcm", false);
            case "riff-48khz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 48000, 96000, 2, 16, speechSynthesisOutputFormatString, "raw-48khz-16bit-mono-pcm", true);
            case "audio-48khz-96kbitrate-mono-mp3":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MP3, 1, 48000, 96 << 7, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-48khz-192kbitrate-mono-mp3":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MP3, 1, 48000, 192 << 7, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "ogg-48khz-16bit-mono-opus":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.OGG_OPUS, 1, 48000, 12000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "webm-16khz-16bit-mono-opus":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.WEBM_OPUS, 1, 16000, 4000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "webm-24khz-16bit-mono-opus":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.WEBM_OPUS, 1, 24000, 6000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "webm-24khz-16bit-24kbps-mono-opus":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.WEBM_OPUS, 1, 24000, 3000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-16khz-16bit-32kbps-mono-opus":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.OPUS, 1, 16000, 4000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-24khz-16bit-48kbps-mono-opus":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.OPUS, 1, 24000, 6000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-24khz-16bit-24kbps-mono-opus":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.OPUS, 1, 24000, 3000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-24khz-16bit-mono-flac":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.FLAC, 1, 24000, 24000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-48khz-16bit-mono-flac":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.FLAC, 1, 48000, 30000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "raw-24khz-16bit-mono-truesilk":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.SILKSkype, 1, 24000, 48000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "raw-8khz-8bit-mono-alaw":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.ALaw, 1, 8000, 8000, 1, 8, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "riff-8khz-8bit-mono-alaw":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.ALaw, 1, 8000, 8000, 1, 8, speechSynthesisOutputFormatString, "raw-8khz-8bit-mono-alaw", true);
            case "raw-22050hz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 22050, 44100, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "riff-22050hz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 22050, 44100, 2, 16, speechSynthesisOutputFormatString, "raw-22050hz-16bit-mono-pcm", true);
            case "raw-44100hz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 44100, 88200, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "riff-44100hz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 44100, 88200, 2, 16, speechSynthesisOutputFormatString, "raw-44100hz-16bit-mono-pcm", true);
            case "riff-16khz-16bit-mono-pcm":
            default:
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 16000, 32000, 2, 16, "riff-16khz-16bit-mono-pcm", "raw-16khz-16bit-mono-pcm", true);
        }
    }
    static getDefaultOutputFormat() {
        return AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString((typeof window !== "undefined") ? "audio-24khz-48kbitrate-mono-mp3" : "riff-16khz-16bit-mono-pcm");
    }
    /**
     * Specifies if this audio output format has a header
     * @boolean AudioOutputFormatImpl.prototype.hasHeader
     * @function
     * @public
     */
    get hasHeader() {
        return this.priHasHeader;
    }
    /**
     * Specifies the header of this format
     * @ArrayBuffer AudioOutputFormatImpl.prototype.header
     * @function
     * @public
     */
    get header() {
        if (this.hasHeader) {
            return this.privHeader;
        }
        return undefined;
    }
    /**
     * Updates the header based on the audio length
     * @member AudioOutputFormatImpl.updateHeader
     * @function
     * @public
     * @param {number} audioLength - the audio length
     */
    updateHeader(audioLength) {
        if (this.priHasHeader) {
            const view = new DataView(this.privHeader);
            view.setUint32(4, audioLength + this.privHeader.byteLength - 8, true);
            view.setUint32(40, audioLength, true);
        }
    }
    /**
     * Specifies the audio format string to be sent to the service
     * @string AudioOutputFormatImpl.prototype.requestAudioFormatString
     * @function
     * @public
     */
    get requestAudioFormatString() {
        return this.priRequestAudioFormatString;
    }
}
AudioOutputFormatImpl.SpeechSynthesisOutputFormatToString = {
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw]: "raw-8khz-8bit-mono-mulaw",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren]: "riff-16khz-16kbps-mono-siren",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren]: "audio-16khz-16kbps-mono-siren",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3]: "audio-16khz-32kbitrate-mono-mp3",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3]: "audio-16khz-128kbitrate-mono-mp3",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3]: "audio-16khz-64kbitrate-mono-mp3",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3]: "audio-24khz-48kbitrate-mono-mp3",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3]: "audio-24khz-96kbitrate-mono-mp3",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3]: "audio-24khz-160kbitrate-mono-mp3",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk]: "raw-16khz-16bit-mono-truesilk",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm]: "riff-16khz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm]: "riff-8khz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm]: "riff-24khz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw]: "riff-8khz-8bit-mono-mulaw",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm]: "raw-16khz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm]: "raw-24khz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm]: "raw-8khz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus]: "ogg-16khz-16bit-mono-opus",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus]: "ogg-24khz-16bit-mono-opus",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm]: "raw-48khz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm]: "riff-48khz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3]: "audio-48khz-96kbitrate-mono-mp3",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3]: "audio-48khz-192kbitrate-mono-mp3",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Ogg48Khz16BitMonoOpus]: "ogg-48khz-16bit-mono-opus",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus]: "webm-16khz-16bit-mono-opus",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus]: "webm-24khz-16bit-mono-opus",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Webm24Khz16Bit24KbpsMonoOpus]: "webm-24khz-16bit-24kbps-mono-opus",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoTrueSilk]: "raw-24khz-16bit-mono-truesilk",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoALaw]: "raw-8khz-8bit-mono-alaw",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoALaw]: "riff-8khz-8bit-mono-alaw",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio16Khz16Bit32KbpsMonoOpus]: "audio-16khz-16bit-32kbps-mono-opus",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio24Khz16Bit48KbpsMonoOpus]: "audio-24khz-16bit-48kbps-mono-opus",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio24Khz16Bit24KbpsMonoOpus]: "audio-24khz-16bit-24kbps-mono-opus",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw22050Hz16BitMonoPcm]: "raw-22050hz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Riff22050Hz16BitMonoPcm]: "riff-22050hz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw44100Hz16BitMonoPcm]: "raw-44100hz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Riff44100Hz16BitMonoPcm]: "riff-44100hz-16bit-mono-pcm",
};

//# sourceMappingURL=AudioOutputFormat.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputStream.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputStream.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioOutputStream": () => (/* binding */ AudioOutputStream),
/* harmony export */   "PullAudioOutputStream": () => (/* binding */ PullAudioOutputStream),
/* harmony export */   "PullAudioOutputStreamImpl": () => (/* binding */ PullAudioOutputStreamImpl),
/* harmony export */   "PushAudioOutputStream": () => (/* binding */ PushAudioOutputStream),
/* harmony export */   "PushAudioOutputStreamImpl": () => (/* binding */ PushAudioOutputStreamImpl)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Stream.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _AudioOutputFormat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./AudioOutputFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
/* eslint-disable max-classes-per-file */



/**
 * Represents audio output stream used for custom audio output configurations.
 * @class AudioOutputStream
 */
class AudioOutputStream {
    /**
     * Creates and initializes an instance.
     * @constructor
     */
    constructor() {
        return;
    }
    /**
     * Creates a memory backed PullAudioOutputStream with the specified audio format.
     * @member AudioOutputStream.createPullStream
     * @function
     * @public
     * @returns {PullAudioOutputStream} The audio output stream being created.
     */
    static createPullStream() {
        return PullAudioOutputStream.create();
    }
}
/**
 * Represents memory backed push audio output stream used for custom audio output configurations.
 * @class PullAudioOutputStream
 */
class PullAudioOutputStream extends AudioOutputStream {
    /**
     * Creates a memory backed PullAudioOutputStream with the specified audio format.
     * @member PullAudioOutputStream.create
     * @function
     * @public
     * @returns {PullAudioOutputStream} The push audio output stream being created.
     */
    static create() {
        return new PullAudioOutputStreamImpl();
    }
}
/**
 * Represents memory backed push audio output stream used for custom audio output configurations.
 * @private
 * @class PullAudioOutputStreamImpl
 */
class PullAudioOutputStreamImpl extends PullAudioOutputStream {
    /**
     * Creates and initializes an instance with the given values.
     * @constructor
     */
    constructor() {
        super();
        this.privId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privStream = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.Stream();
    }
    /**
     * Sets the format information to the stream. For internal use only.
     * @param {AudioStreamFormat} format - the format to be set.
     */
    set format(format) {
        if (format === undefined || format === null) {
            this.privFormat = _AudioOutputFormat__WEBPACK_IMPORTED_MODULE_2__.AudioOutputFormatImpl.getDefaultOutputFormat();
        }
        this.privFormat = format;
    }
    /**
     * Format information for the audio
     */
    get format() {
        return this.privFormat;
    }
    /**
     * Checks if the stream is closed
     * @member PullAudioOutputStreamImpl.prototype.isClosed
     * @property
     * @public
     */
    get isClosed() {
        return this.privStream.isClosed;
    }
    /**
     * Gets the id of the stream
     * @member PullAudioOutputStreamImpl.prototype.id
     * @property
     * @public
     */
    id() {
        return this.privId;
    }
    /**
     * Reads audio data from the internal buffer.
     * @member PullAudioOutputStreamImpl.prototype.read
     * @function
     * @public
     * @param {ArrayBuffer} dataBuffer - An ArrayBuffer to store the read data.
     * @returns {Promise<number>} - Audio buffer length has been read.
     */
    read(dataBuffer) {
        return __awaiter(this, void 0, void 0, function* () {
            const intView = new Int8Array(dataBuffer);
            let totalBytes = 0;
            if (this.privLastChunkView !== undefined) {
                if (this.privLastChunkView.length > dataBuffer.byteLength) {
                    intView.set(this.privLastChunkView.slice(0, dataBuffer.byteLength));
                    this.privLastChunkView = this.privLastChunkView.slice(dataBuffer.byteLength);
                    return Promise.resolve(dataBuffer.byteLength);
                }
                intView.set(this.privLastChunkView);
                totalBytes = this.privLastChunkView.length;
                this.privLastChunkView = undefined;
            }
            // Until we have the minimum number of bytes to send in a transmission, keep asking for more.
            while (totalBytes < dataBuffer.byteLength && !this.privStream.isReadEnded) {
                const chunk = yield this.privStream.read();
                if (chunk !== undefined && !chunk.isEnd) {
                    let tmpBuffer;
                    if (chunk.buffer.byteLength > dataBuffer.byteLength - totalBytes) {
                        tmpBuffer = chunk.buffer.slice(0, dataBuffer.byteLength - totalBytes);
                        this.privLastChunkView = new Int8Array(chunk.buffer.slice(dataBuffer.byteLength - totalBytes));
                    }
                    else {
                        tmpBuffer = chunk.buffer;
                    }
                    intView.set(new Int8Array(tmpBuffer), totalBytes);
                    totalBytes += tmpBuffer.byteLength;
                }
                else {
                    this.privStream.readEnded();
                }
            }
            return totalBytes;
        });
    }
    /**
     * Writes the audio data specified by making an internal copy of the data.
     * @member PullAudioOutputStreamImpl.prototype.write
     * @function
     * @public
     * @param {ArrayBuffer} dataBuffer - The audio buffer of which this function will make a copy.
     */
    write(dataBuffer) {
        _Contracts__WEBPACK_IMPORTED_MODULE_3__.Contracts.throwIfNullOrUndefined(this.privStream, "must set format before writing");
        this.privStream.writeStreamChunk({
            buffer: dataBuffer,
            isEnd: false,
            timeReceived: Date.now()
        });
    }
    /**
     * Closes the stream.
     * @member PullAudioOutputStreamImpl.prototype.close
     * @function
     * @public
     */
    close() {
        this.privStream.close();
    }
}
/*
 * Represents audio output stream used for custom audio output configurations.
 * @class PushAudioOutputStream
 */
class PushAudioOutputStream extends AudioOutputStream {
    /**
     * Creates and initializes and instance.
     * @constructor
     */
    constructor() {
        super();
    }
    /**
     * Creates a PushAudioOutputStream that delegates to the specified callback interface for
     * write() and close() methods.
     * @member PushAudioOutputStream.create
     * @function
     * @public
     * @param {PushAudioOutputStreamCallback} callback - The custom audio output object,
     * derived from PushAudioOutputStreamCallback
     * @returns {PushAudioOutputStream} The push audio output stream being created.
     */
    static create(callback) {
        return new PushAudioOutputStreamImpl(callback);
    }
}
/**
 * Represents audio output stream used for custom audio output configurations.
 * @private
 * @class PushAudioOutputStreamImpl
 */
class PushAudioOutputStreamImpl extends PushAudioOutputStream {
    /**
     * Creates a PushAudioOutputStream that delegates to the specified callback interface for
     * read() and close() methods.
     * @constructor
     * @param {PushAudioOutputStreamCallback} callback - The custom audio output object,
     * derived from PushAudioOutputStreamCallback
     */
    constructor(callback) {
        super();
        this.privId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privCallback = callback;
    }
    // eslint-disable-next-line @typescript-eslint/no-empty-function
    set format(format) { }
    write(buffer) {
        if (!!this.privCallback.write) {
            this.privCallback.write(buffer);
        }
    }
    close() {
        if (!!this.privCallback.close) {
            this.privCallback.close();
        }
    }
    id() {
        return this.privId;
    }
}

//# sourceMappingURL=AudioOutputStream.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioStreamFormat.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioStreamFormat.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioFormatTag": () => (/* binding */ AudioFormatTag),
/* harmony export */   "AudioStreamFormat": () => (/* binding */ AudioStreamFormat),
/* harmony export */   "AudioStreamFormatImpl": () => (/* binding */ AudioStreamFormatImpl)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// eslint-disable-next-line max-classes-per-file
var AudioFormatTag;
(function (AudioFormatTag) {
    AudioFormatTag[AudioFormatTag["PCM"] = 1] = "PCM";
    AudioFormatTag[AudioFormatTag["MuLaw"] = 2] = "MuLaw";
    AudioFormatTag[AudioFormatTag["Siren"] = 3] = "Siren";
    AudioFormatTag[AudioFormatTag["MP3"] = 4] = "MP3";
    AudioFormatTag[AudioFormatTag["SILKSkype"] = 5] = "SILKSkype";
    AudioFormatTag[AudioFormatTag["OGG_OPUS"] = 6] = "OGG_OPUS";
    AudioFormatTag[AudioFormatTag["WEBM_OPUS"] = 7] = "WEBM_OPUS";
    AudioFormatTag[AudioFormatTag["ALaw"] = 8] = "ALaw";
    AudioFormatTag[AudioFormatTag["FLAC"] = 9] = "FLAC";
    AudioFormatTag[AudioFormatTag["OPUS"] = 10] = "OPUS";
})(AudioFormatTag || (AudioFormatTag = {}));
/**
 * Represents audio stream format used for custom audio input configurations.
 * @class AudioStreamFormat
 */
class AudioStreamFormat {
    /**
     * Creates an audio stream format object representing the default audio stream
     * format (16KHz 16bit mono PCM).
     * @member AudioStreamFormat.getDefaultInputFormat
     * @function
     * @public
     * @returns {AudioStreamFormat} The audio stream format being created.
     */
    static getDefaultInputFormat() {
        return AudioStreamFormatImpl.getDefaultInputFormat();
    }
    /**
     * Creates an audio stream format object with the specified format characteristics.
     * @member AudioStreamFormat.getWaveFormat
     * @function
     * @public
     * @param {number} samplesPerSecond - Sample rate, in samples per second (Hertz).
     * @param {number} bitsPerSample - Bits per sample, typically 16.
     * @param {number} channels - Number of channels in the waveform-audio data. Monaural data
     * uses one channel and stereo data uses two channels.
     * @param {AudioFormatTag} format - Audio format (PCM, alaw or mulaw).
     * @returns {AudioStreamFormat} The audio stream format being created.
     */
    static getWaveFormat(samplesPerSecond, bitsPerSample, channels, format) {
        return new AudioStreamFormatImpl(samplesPerSecond, bitsPerSample, channels, format);
    }
    /**
     * Creates an audio stream format object with the specified pcm waveformat characteristics.
     * @member AudioStreamFormat.getWaveFormatPCM
     * @function
     * @public
     * @param {number} samplesPerSecond - Sample rate, in samples per second (Hertz).
     * @param {number} bitsPerSample - Bits per sample, typically 16.
     * @param {number} channels - Number of channels in the waveform-audio data. Monaural data
     * uses one channel and stereo data uses two channels.
     * @returns {AudioStreamFormat} The audio stream format being created.
     */
    static getWaveFormatPCM(samplesPerSecond, bitsPerSample, channels) {
        return new AudioStreamFormatImpl(samplesPerSecond, bitsPerSample, channels);
    }
}
/**
 * @private
 * @class AudioStreamFormatImpl
 */
class AudioStreamFormatImpl extends AudioStreamFormat {
    /**
     * Creates an instance with the given values.
     * @constructor
     * @param {number} samplesPerSec - Samples per second.
     * @param {number} bitsPerSample - Bits per sample.
     * @param {number} channels - Number of channels.
     * @param {AudioFormatTag} format - Audio format (PCM, alaw or mulaw).
     */
    constructor(samplesPerSec = 16000, bitsPerSample = 16, channels = 1, format = AudioFormatTag.PCM) {
        super();
        let isWavFormat = true;
        /* 1 for PCM; 6 for alaw; 7 for mulaw */
        switch (format) {
            case AudioFormatTag.PCM:
                this.formatTag = 1;
                break;
            case AudioFormatTag.ALaw:
                this.formatTag = 6;
                break;
            case AudioFormatTag.MuLaw:
                this.formatTag = 7;
                break;
            default:
                isWavFormat = false;
        }
        this.bitsPerSample = bitsPerSample;
        this.samplesPerSec = samplesPerSec;
        this.channels = channels;
        this.avgBytesPerSec = this.samplesPerSec * this.channels * (this.bitsPerSample / 8);
        this.blockAlign = this.channels * Math.max(this.bitsPerSample, 8);
        if (isWavFormat) {
            this.privHeader = new ArrayBuffer(44);
            // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView
            const view = new DataView(this.privHeader);
            /* RIFF identifier */
            this.setString(view, 0, "RIFF");
            /* file length */
            view.setUint32(4, 0, true);
            /* RIFF type & Format */
            this.setString(view, 8, "WAVEfmt ");
            /* format chunk length */
            view.setUint32(16, 16, true);
            /* audio format */
            view.setUint16(20, this.formatTag, true);
            /* channel count */
            view.setUint16(22, this.channels, true);
            /* sample rate */
            view.setUint32(24, this.samplesPerSec, true);
            /* byte rate (sample rate * block align) */
            view.setUint32(28, this.avgBytesPerSec, true);
            /* block align (channel count * bytes per sample) */
            view.setUint16(32, this.channels * (this.bitsPerSample / 8), true);
            /* bits per sample */
            view.setUint16(34, this.bitsPerSample, true);
            /* data chunk identifier */
            this.setString(view, 36, "data");
            /* data chunk length */
            view.setUint32(40, 0, true);
        }
    }
    /**
     * Retrieves the default input format.
     * @member AudioStreamFormatImpl.getDefaultInputFormat
     * @function
     * @public
     * @returns {AudioStreamFormatImpl} The default input format.
     */
    static getDefaultInputFormat() {
        return new AudioStreamFormatImpl();
    }
    /**
     * Creates an audio context appropriate to current browser
     * @member AudioStreamFormatImpl.getAudioContext
     * @function
     * @public
     * @returns {AudioContext} An audio context instance
     */
    /* eslint-disable */
    static getAudioContext(sampleRate) {
        // Workaround for Speech SDK bug in Safari.
        const AudioContext = window.AudioContext // our preferred impl
            || window.webkitAudioContext // fallback, mostly when on Safari
            || false; // could not find.
        // https://developer.mozilla.org/en-US/docs/Web/API/AudioContext
        if (!!AudioContext) {
            if (sampleRate !== undefined && navigator.mediaDevices.getSupportedConstraints().sampleRate) {
                return new AudioContext({ sampleRate });
            }
            else {
                return new AudioContext();
            }
        }
        else {
            throw new Error("Browser does not support Web Audio API (AudioContext is not available).");
        }
    }
    /* eslint-enable */
    /**
     * Closes the configuration object.
     * @member AudioStreamFormatImpl.prototype.close
     * @function
     * @public
     */
    close() {
        return;
    }
    get header() {
        return this.privHeader;
    }
    setString(view, offset, str) {
        for (let i = 0; i < str.length; i++) {
            view.setUint8(offset + i, str.charCodeAt(i));
        }
    }
}

//# sourceMappingURL=AudioStreamFormat.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/BaseAudioPlayer.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/BaseAudioPlayer.js ***!
  \*************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BaseAudioPlayer": () => (/* binding */ BaseAudioPlayer)
/* harmony export */ });
/* harmony import */ var _common_Error__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common/Error */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AudioStreamFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioStreamFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



/**
 * Base audio player class
 * TODO: Plays only PCM for now.
 * @class
 */
class BaseAudioPlayer {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {AudioStreamFormat} audioFormat audio stream format recognized by the player.
     */
    constructor(audioFormat) {
        this.audioContext = null;
        this.gainNode = null;
        this.autoUpdateBufferTimer = 0;
        if (audioFormat === undefined) {
            audioFormat = _Exports__WEBPACK_IMPORTED_MODULE_0__.AudioStreamFormat.getDefaultInputFormat();
        }
        this.init(audioFormat);
    }
    /**
     * play Audio sample
     * @param newAudioData audio data to be played.
     */
    playAudioSample(newAudioData, cb, err) {
        try {
            this.ensureInitializedContext();
            const audioData = this.formatAudioData(newAudioData);
            const newSamplesData = new Float32Array(this.samples.length + audioData.length);
            newSamplesData.set(this.samples, 0);
            newSamplesData.set(audioData, this.samples.length);
            this.samples = newSamplesData;
            if (!!cb) {
                cb();
            }
        }
        catch (e) {
            if (!!err) {
                err(e);
            }
        }
    }
    /**
     * stops audio and clears the buffers
     */
    stopAudio(cb, err) {
        if (this.audioContext !== null) {
            this.samples = new Float32Array();
            // eslint-disable-next-line @typescript-eslint/no-unsafe-argument
            clearInterval(this.autoUpdateBufferTimer);
            this.audioContext.close().then(() => {
                if (!!cb) {
                    cb();
                }
            }, (error) => {
                if (!!err) {
                    err(error);
                }
            });
            this.audioContext = null;
        }
    }
    init(audioFormat) {
        this.audioFormat = audioFormat;
        this.samples = new Float32Array();
    }
    ensureInitializedContext() {
        if (this.audioContext === null) {
            this.createAudioContext();
            const timerPeriod = 200;
            this.autoUpdateBufferTimer = setInterval(() => {
                this.updateAudioBuffer();
            }, timerPeriod);
        }
    }
    createAudioContext() {
        // new ((window as any).AudioContext || (window as any).webkitAudioContext)();
        this.audioContext = _Exports__WEBPACK_IMPORTED_MODULE_0__.AudioStreamFormatImpl.getAudioContext();
        // TODO: Various examples shows this gain node, it does not seem to be needed unless we plan
        // to control the volume, not likely
        this.gainNode = this.audioContext.createGain();
        this.gainNode.gain.value = 1;
        this.gainNode.connect(this.audioContext.destination);
        this.startTime = this.audioContext.currentTime;
    }
    formatAudioData(audioData) {
        switch (this.audioFormat.bitsPerSample) {
            case 8:
                return this.formatArrayBuffer(new Int8Array(audioData), 128);
            case 16:
                return this.formatArrayBuffer(new Int16Array(audioData), 32768);
            case 32:
                return this.formatArrayBuffer(new Int32Array(audioData), 2147483648);
            default:
                throw new _common_Error__WEBPACK_IMPORTED_MODULE_1__.InvalidOperationError("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time");
        }
    }
    formatArrayBuffer(audioData, maxValue) {
        const float32Data = new Float32Array(audioData.length);
        for (let i = 0; i < audioData.length; i++) {
            float32Data[i] = audioData[i] / maxValue;
        }
        return float32Data;
    }
    updateAudioBuffer() {
        if (this.samples.length === 0) {
            return;
        }
        const channelCount = this.audioFormat.channels;
        const bufferSource = this.audioContext.createBufferSource();
        const frameCount = this.samples.length / channelCount;
        const audioBuffer = this.audioContext.createBuffer(channelCount, frameCount, this.audioFormat.samplesPerSec);
        // TODO: Should we do the conversion in the pushAudioSample instead?
        for (let channel = 0; channel < channelCount; channel++) {
            // Fill in individual channel data
            let channelOffset = channel;
            const audioData = audioBuffer.getChannelData(channel);
            for (let i = 0; i < this.samples.length; i++, channelOffset += channelCount) {
                audioData[i] = this.samples[channelOffset];
            }
        }
        if (this.startTime < this.audioContext.currentTime) {
            this.startTime = this.audioContext.currentTime;
        }
        bufferSource.buffer = audioBuffer;
        bufferSource.connect(this.gainNode);
        bufferSource.start(this.startTime);
        // Make sure we play the next sample after the current one.
        this.startTime += audioBuffer.duration;
        // Clear the samples for the next pushed data.
        this.samples = new Float32Array();
    }
    playAudio(audioData) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.audioContext === null) {
                this.createAudioContext();
            }
            const source = this.audioContext.createBufferSource();
            const destination = this.audioContext.destination;
            yield this.audioContext.decodeAudioData(audioData, (newBuffer) => {
                source.buffer = newBuffer;
                source.connect(destination);
                source.start(0);
            });
        });
    }
}

//# sourceMappingURL=BaseAudioPlayer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/PullAudioInputStreamCallback.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/PullAudioInputStreamCallback.js ***!
  \**************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PullAudioInputStreamCallback": () => (/* binding */ PullAudioInputStreamCallback)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * An abstract base class that defines callback methods (read() and close()) for
 * custom audio input streams).
 * @class PullAudioInputStreamCallback
 */
class PullAudioInputStreamCallback {
}

//# sourceMappingURL=PullAudioInputStreamCallback.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/PushAudioOutputStreamCallback.js":
/*!***************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/PushAudioOutputStreamCallback.js ***!
  \***************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PushAudioOutputStreamCallback": () => (/* binding */ PushAudioOutputStreamCallback)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * An abstract base class that defines callback methods (write() and close()) for
 * custom audio output streams).
 * @class PushAudioOutputStreamCallback
 */
class PushAudioOutputStreamCallback {
}

//# sourceMappingURL=PushAudioOutputStreamCallback.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/SpeakerAudioDestination.js":
/*!*********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/SpeakerAudioDestination.js ***!
  \*********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeakerAudioDestination": () => (/* binding */ SpeakerAudioDestination)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisAdapterBase.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/BackgroundError.js");
/* harmony import */ var _AudioOutputStream__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./AudioOutputStream */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputStream.js");
/* harmony import */ var _AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AudioStreamFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioStreamFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




const MediaDurationPlaceholderSeconds = 60 * 30;
const AudioFormatToMimeType = {
    [_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM]: "audio/wav",
    [_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MuLaw]: "audio/x-wav",
    [_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MP3]: "audio/mpeg",
    [_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.OGG_OPUS]: "audio/ogg",
    [_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.WEBM_OPUS]: "audio/webm; codecs=opus",
    [_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.ALaw]: "audio/x-wav",
    [_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.FLAC]: "audio/flac",
};
/**
 * Represents the speaker playback audio destination, which only works in browser.
 * Note: the SDK will try to use <a href="https://www.w3.org/TR/media-source/">Media Source Extensions</a> to play audio.
 * Mp3 format has better supports on Microsoft Edge, Chrome and Safari (desktop), so, it's better to specify mp3 format for playback.
 * @class SpeakerAudioDestination
 * Updated in version 1.17.0
 */
class SpeakerAudioDestination {
    constructor(audioDestinationId) {
        this.privPlaybackStarted = false;
        this.privAppendingToBuffer = false;
        this.privMediaSourceOpened = false;
        this.privBytesReceived = 0;
        this.privId = audioDestinationId ? audioDestinationId : (0,_common_Exports__WEBPACK_IMPORTED_MODULE_1__.createNoDashGuid)();
        this.privIsPaused = false;
        this.privIsClosed = false;
    }
    id() {
        return this.privId;
    }
    write(buffer, cb, err) {
        if (this.privAudioBuffer !== undefined) {
            this.privAudioBuffer.push(buffer);
            this.updateSourceBuffer().then(() => {
                if (!!cb) {
                    cb();
                }
            }, (error) => {
                if (!!err) {
                    err(error);
                }
            });
        }
        else if (this.privAudioOutputStream !== undefined) {
            this.privAudioOutputStream.write(buffer);
            this.privBytesReceived += buffer.byteLength;
        }
    }
    close(cb, err) {
        this.privIsClosed = true;
        if (this.privSourceBuffer !== undefined) {
            this.handleSourceBufferUpdateEnd().then(() => {
                if (!!cb) {
                    cb();
                }
            }, (error) => {
                if (!!err) {
                    err(error);
                }
            });
        }
        else if (this.privAudioOutputStream !== undefined && typeof window !== "undefined") {
            if ((this.privFormat.formatTag === _AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM || this.privFormat.formatTag === _AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MuLaw
                || this.privFormat.formatTag === _AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.ALaw) && this.privFormat.hasHeader === false) {
                // eslint-disable-next-line no-console
                console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header.");
                if (!!this.onAudioEnd) {
                    this.onAudioEnd(this);
                }
            }
            else {
                let receivedAudio = new ArrayBuffer(this.privBytesReceived);
                this.privAudioOutputStream.read(receivedAudio).then(() => {
                    receivedAudio = _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.SynthesisAdapterBase.addHeader(receivedAudio, this.privFormat);
                    const audioBlob = new Blob([receivedAudio], { type: AudioFormatToMimeType[this.privFormat.formatTag] });
                    this.privAudio.src = window.URL.createObjectURL(audioBlob);
                    this.notifyPlayback().then(() => {
                        if (!!cb) {
                            cb();
                        }
                    }, (error) => {
                        if (!!err) {
                            err(error);
                        }
                    });
                }, (error) => {
                    if (!!err) {
                        err(error);
                    }
                });
            }
        }
        else {
            // unsupported format, call onAudioEnd directly.
            if (!!this.onAudioEnd) {
                this.onAudioEnd(this);
            }
        }
    }
    set format(format) {
        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access
        if (typeof (AudioContext) !== "undefined" || (typeof (window) !== "undefined" && typeof (window.webkitAudioContext) !== "undefined")) {
            this.privFormat = format;
            const mimeType = AudioFormatToMimeType[this.privFormat.formatTag];
            if (mimeType === undefined) {
                // eslint-disable-next-line no-console
                console.warn(`Unknown mimeType for format ${_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag[this.privFormat.formatTag]}; playback is not supported.`);
            }
            else if (typeof (MediaSource) !== "undefined" && MediaSource.isTypeSupported(mimeType)) {
                this.privAudio = new Audio();
                this.privAudioBuffer = [];
                this.privMediaSource = new MediaSource();
                this.privAudio.src = URL.createObjectURL(this.privMediaSource);
                this.privAudio.load();
                this.privMediaSource.onsourceopen = () => {
                    this.privMediaSourceOpened = true;
                    this.privMediaSource.duration = MediaDurationPlaceholderSeconds;
                    this.privSourceBuffer = this.privMediaSource.addSourceBuffer(mimeType);
                    this.privSourceBuffer.onupdate = () => {
                        this.updateSourceBuffer().catch((reason) => {
                            _common_Exports__WEBPACK_IMPORTED_MODULE_3__.Events.instance.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.BackgroundEvent(reason));
                        });
                    };
                    this.privSourceBuffer.onupdateend = () => {
                        this.handleSourceBufferUpdateEnd().catch((reason) => {
                            _common_Exports__WEBPACK_IMPORTED_MODULE_3__.Events.instance.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.BackgroundEvent(reason));
                        });
                    };
                    this.privSourceBuffer.onupdatestart = () => {
                        this.privAppendingToBuffer = false;
                    };
                };
                this.updateSourceBuffer().catch((reason) => {
                    _common_Exports__WEBPACK_IMPORTED_MODULE_3__.Events.instance.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.BackgroundEvent(reason));
                });
            }
            else {
                // eslint-disable-next-line no-console
                console.warn(`Format ${_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`);
                this.privAudioOutputStream = new _AudioOutputStream__WEBPACK_IMPORTED_MODULE_5__.PullAudioOutputStreamImpl();
                this.privAudioOutputStream.format = this.privFormat;
                this.privAudio = new Audio();
            }
        }
    }
    get volume() {
        var _a, _b;
        return (_b = (_a = this.privAudio) === null || _a === void 0 ? void 0 : _a.volume) !== null && _b !== void 0 ? _b : -1;
    }
    set volume(volume) {
        if (!!this.privAudio) {
            this.privAudio.volume = volume;
        }
    }
    mute() {
        if (!!this.privAudio) {
            this.privAudio.muted = true;
        }
    }
    unmute() {
        if (!!this.privAudio) {
            this.privAudio.muted = false;
        }
    }
    get isClosed() {
        return this.privIsClosed;
    }
    get currentTime() {
        if (this.privAudio !== undefined) {
            return this.privAudio.currentTime;
        }
        return -1;
    }
    pause() {
        if (!this.privIsPaused && this.privAudio !== undefined) {
            this.privAudio.pause();
            this.privIsPaused = true;
        }
    }
    resume(cb, err) {
        if (this.privIsPaused && this.privAudio !== undefined) {
            this.privAudio.play().then(() => {
                if (!!cb) {
                    cb();
                }
            }, (error) => {
                if (!!err) {
                    err(error);
                }
            });
            this.privIsPaused = false;
        }
    }
    get internalAudio() {
        return this.privAudio;
    }
    updateSourceBuffer() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privAudioBuffer !== undefined && (this.privAudioBuffer.length > 0) && this.sourceBufferAvailable()) {
                this.privAppendingToBuffer = true;
                const binary = this.privAudioBuffer.shift();
                try {
                    this.privSourceBuffer.appendBuffer(binary);
                }
                catch (error) {
                    this.privAudioBuffer.unshift(binary);
                    // eslint-disable-next-line no-console
                    console.log("buffer filled, pausing addition of binaries until space is made");
                    return;
                }
                yield this.notifyPlayback();
            }
            else if (this.canEndStream()) {
                yield this.handleSourceBufferUpdateEnd();
            }
        });
    }
    handleSourceBufferUpdateEnd() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.canEndStream() && this.sourceBufferAvailable()) {
                this.privMediaSource.endOfStream();
                yield this.notifyPlayback();
            }
        });
    }
    notifyPlayback() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.privPlaybackStarted && this.privAudio !== undefined) {
                this.privPlaybackStarted = true;
                if (!!this.onAudioStart) {
                    this.onAudioStart(this);
                }
                this.privAudio.onended = () => {
                    if (!!this.onAudioEnd) {
                        this.onAudioEnd(this);
                    }
                };
                if (!this.privIsPaused) {
                    yield this.privAudio.play();
                }
            }
        });
    }
    canEndStream() {
        return (this.isClosed && this.privSourceBuffer !== undefined && (this.privAudioBuffer.length === 0)
            && this.privMediaSourceOpened && !this.privAppendingToBuffer && this.privMediaSource.readyState === "open");
    }
    sourceBufferAvailable() {
        return (this.privSourceBuffer !== undefined && !this.privSourceBuffer.updating);
    }
}

//# sourceMappingURL=SpeakerAudioDestination.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/AutoDetectSourceLanguageConfig.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/AutoDetectSourceLanguageConfig.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AutoDetectSourceLanguageConfig": () => (/* binding */ AutoDetectSourceLanguageConfig)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _LanguageIdMode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./LanguageIdMode */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/LanguageIdMode.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.




/**
 * Language auto detect configuration.
 * @class AutoDetectSourceLanguageConfig
 * Added in version 1.13.0.
 */
class AutoDetectSourceLanguageConfig {
    constructor() {
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyCollection();
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_LanguageIdMode, "AtStart");
        this.privLanguageIdMode = _LanguageIdMode__WEBPACK_IMPORTED_MODULE_2__.LanguageIdMode.AtStart;
    }
    /**
     * @member AutoDetectSourceLanguageConfig.fromOpenRange
     * @function
     * @public
     * Only [[SpeechSynthesizer]] supports source language auto detection from open range,
     * for [[Recognizer]], please use AutoDetectSourceLanguageConfig with specific source languages.
     * @return {AutoDetectSourceLanguageConfig} Instance of AutoDetectSourceLanguageConfig
     * @summary Creates an instance of the AutoDetectSourceLanguageConfig with open range.
     */
    static fromOpenRange() {
        const config = new AutoDetectSourceLanguageConfig();
        config.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages, _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.AutoDetectSourceLanguagesOpenRangeOptionName);
        return config;
    }
    /**
     * @member AutoDetectSourceLanguageConfig.fromLanguages
     * @function
     * @public
     * @param {string[]} languages Comma-separated string of languages (eg. "en-US,fr-FR") to populate properties of config.
     * @return {AutoDetectSourceLanguageConfig} Instance of AutoDetectSourceLanguageConfig
     * @summary Creates an instance of the AutoDetectSourceLanguageConfig with given languages.
     */
    static fromLanguages(languages) {
        _Contracts__WEBPACK_IMPORTED_MODULE_4__.Contracts.throwIfArrayEmptyOrWhitespace(languages, "languages");
        const config = new AutoDetectSourceLanguageConfig();
        config.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages, languages.join());
        return config;
    }
    /**
     * @member AutoDetectSourceLanguageConfig.fromSourceLanguageConfigs
     * @function
     * @public
     * @param {SourceLanguageConfig[]} configs SourceLanguageConfigs to populate properties of config.
     * @return {AutoDetectSourceLanguageConfig} Instance of AutoDetectSourceLanguageConfig
     * @summary Creates an instance of the AutoDetectSourceLanguageConfig with given SourceLanguageConfigs.
     */
    static fromSourceLanguageConfigs(configs) {
        if (configs.length < 1) {
            throw new Error("Expected non-empty SourceLanguageConfig array.");
        }
        const autoConfig = new AutoDetectSourceLanguageConfig();
        const langs = [];
        configs.forEach((config) => {
            langs.push(config.language);
            if (config.endpointId !== undefined && config.endpointId !== "") {
                const customProperty = config.language + _Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_EndpointId.toString();
                autoConfig.properties.setProperty(customProperty, config.endpointId);
            }
        });
        autoConfig.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages, langs.join());
        return autoConfig;
    }
    /**
     * @member AutoDetectSourceLanguageConfig.prototype.properties
     * @function
     * @public
     * @return {PropertyCollection} Properties of the config.
     * @summary Gets an auto detected language config properties
     */
    get properties() {
        return this.privProperties;
    }
    /**
     * @member AutoDetectSourceLanguageConfig.prototype.mode
     * @function
     * @public
     * @param {LanguageIdMode} mode LID mode desired.
     * @summary Sets LID operation to desired mode
     */
    set mode(mode) {
        if (mode === _LanguageIdMode__WEBPACK_IMPORTED_MODULE_2__.LanguageIdMode.Continuous) {
            this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion, "2");
            this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_LanguageIdMode, "Continuous");
        }
        else { // LanguageIdMode.AtStart
            this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion, "1");
            this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_LanguageIdMode, "AtStart");
        }
        this.privLanguageIdMode = mode;
    }
}

//# sourceMappingURL=AutoDetectSourceLanguageConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/AutoDetectSourceLanguageResult.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/AutoDetectSourceLanguageResult.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AutoDetectSourceLanguageResult": () => (/* binding */ AutoDetectSourceLanguageResult)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Output format
 * @class AutoDetectSourceLanguageResult
 */
class AutoDetectSourceLanguageResult {
    constructor(language, languageDetectionConfidence) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(language, "language");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(languageDetectionConfidence, "languageDetectionConfidence");
        this.privLanguage = language;
        this.privLanguageDetectionConfidence = languageDetectionConfidence;
    }
    /**
     * Creates an instance of AutoDetectSourceLanguageResult object from a SpeechRecognitionResult instance.
     * @member AutoDetectSourceLanguageResult.fromResult
     * @function
     * @public
     * @param {SpeechRecognitionResult} result - The recognition result.
     * @returns {AutoDetectSourceLanguageResult} AutoDetectSourceLanguageResult object being created.
     */
    static fromResult(result) {
        return new AutoDetectSourceLanguageResult(result.language, result.languageDetectionConfidence);
    }
    get language() {
        return this.privLanguage;
    }
    get languageDetectionConfidence() {
        return this.privLanguageDetectionConfidence;
    }
}

//# sourceMappingURL=AutoDetectSourceLanguageResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/BotFrameworkConfig.js":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/BotFrameworkConfig.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BotFrameworkConfig": () => (/* binding */ BotFrameworkConfig)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./DialogServiceConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



/**
 * Class that defines configurations for the dialog service connector object for using a Bot Framework backend.
 * @class BotFrameworkConfig
 */
class BotFrameworkConfig extends _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfigImpl {
    /**
     * Creates an instance of BotFrameworkConfig.
     */
    constructor() {
        super();
    }
    /**
     * Creates a bot framework configuration instance with the provided subscription information.
     * @member BotFrameworkConfig.fromSubscription
     * @function
     * @public
     * @param subscription Subscription key associated with the bot
     * @param region The region name (see the <a href="https://aka.ms/csspeech/region">region page</a>).
     * @param botId Optional. Identifier for using a specific bot within an Azure resource group. Equivalent to the
     * resource name.
     * @returns {BotFrameworkConfig} A new bot framework configuration instance.
     */
    static fromSubscription(subscription, region, botId) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(subscription, "subscription");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(region, "region");
        const botFrameworkConfig = new _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfigImpl();
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_DialogType, _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfig.DialogTypes.BotFramework);
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Key, subscription);
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Region, region);
        if (botId) {
            botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_ApplicationId, botId);
        }
        return botFrameworkConfig;
    }
    /**
     * Creates a bot framework configuration instance for the specified authorization token and region.
     * Note: The caller must ensure that an authorization token is valid. Before an authorization token expires, the
     * caller must refresh it by setting the authorizationToken property on the corresponding
     * DialogServiceConnector instance created with this config. The contents of configuration objects are copied
     * when connectors are created, so setting authorizationToken on a DialogServiceConnector will not update the
     * original configuration's authorization token. Create a new configuration instance or set the
     * SpeechServiceAuthorization_Token property to update an existing instance if it will be used to create
     * further DialogServiceConnectors.
     * @member BotFrameworkConfig.fromAuthorizationToken
     * @function
     * @public
     * @param authorizationToken The authorization token associated with the bot
     * @param region The region name (see the <a href="https://aka.ms/csspeech/region">region page</a>).
     * @param botId Optional. Identifier for using a specific bot within an Azure resource group. Equivalent to the
     * resource name.
     * @returns {BotFrameworkConfig} A new bot framework configuration instance.
     */
    static fromAuthorizationToken(authorizationToken, region, botId) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(authorizationToken, "authorizationToken");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(region, "region");
        const botFrameworkConfig = new _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfigImpl();
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_DialogType, _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfig.DialogTypes.BotFramework);
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token, authorizationToken);
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Region, region);
        if (botId) {
            botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_ApplicationId, botId);
        }
        return botFrameworkConfig;
    }
    /**
     * Creates an instance of a BotFrameworkConfig.
     * This method is intended only for users who use a non-default service host. The standard resource path will be
     * assumed. For services with a non-standard resource path or no path at all, use fromEndpoint instead.
     * Note: Query parameters are not allowed in the host URI and must be set by other APIs.
     * Note: To use an authorization token with fromHost, use fromHost(URL) and then set the AuthorizationToken
     * property on the created BotFrameworkConfig instance.
     * Note: Added in version 1.15.0.
     * @member BotFrameworkConfig.fromHost
     * @function
     * @public
     * @param {URL | string} host - If a URL is provided, the fully-qualified host with protocol (e.g.
     * wss://your.host.com:1234) will be used. If a string is provided, it will be embedded in
     * wss://{host}.convai.speech.azure.us.
     * @param {string} subscriptionKey - The subscription key. If a subscription key is not specified, an authorization
     * token must be set.
     * @param botId Optional. Identifier for using a specific bot within an Azure resource group. Equivalent to the
     * resource name.
     * @returns {BotFrameworkConfig} A new bot framework configuration instance.
     */
    static fromHost(host, subscriptionKey, botId) {
        void botId;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(host, "host");
        const resolvedHost = host instanceof URL ? host : new URL(`wss://${host}.convai.speech.azure.us`);
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(resolvedHost, "resolvedHost");
        const botFrameworkConfig = new _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfigImpl();
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_DialogType, _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfig.DialogTypes.BotFramework);
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Host, resolvedHost.toString());
        if (undefined !== subscriptionKey) {
            botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Key, subscriptionKey);
        }
        return botFrameworkConfig;
    }
    /**
     * Creates an instance of a BotFrameworkConfig.
     * This method is intended only for users who use a non-standard service endpoint or parameters.
     * Note: The query parameters specified in the endpoint URL are not changed, even if they are set by any other APIs.
     * Note: To use authorization token with fromEndpoint, pass an empty string to the subscriptionKey in the
     * fromEndpoint method, and then set authorizationToken="token" on the created BotFrameworkConfig instance to
     * use the authorization token.
     * Note: Added in version 1.15.0.
     * @member BotFrameworkConfig.fromEndpoint
     * @function
     * @public
     * @param {URL} endpoint - The service endpoint to connect to.
     * @param {string} subscriptionKey - The subscription key. If a subscription key is not specified, an authorization
     * token must be set.
     * @returns {BotFrameworkConfig} - A new bot framework configuration instance using the provided endpoint.
     */
    static fromEndpoint(endpoint, subscriptionKey) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(endpoint, "endpoint");
        const botFrameworkConfig = new _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfigImpl();
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_DialogType, _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfig.DialogTypes.BotFramework);
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Endpoint, endpoint.toString());
        if (undefined !== subscriptionKey) {
            botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Key, subscriptionKey);
        }
        return botFrameworkConfig;
    }
}

//# sourceMappingURL=BotFrameworkConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetails.js":
/*!***********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetails.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CancellationDetails": () => (/* binding */ CancellationDetails)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SimpleSpeechPhrase.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/EnumTranslation.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _CancellationDetailsBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CancellationDetailsBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetailsBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionResult.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



/**
 * Contains detailed information about why a result was canceled.
 * @class CancellationDetails
 */
class CancellationDetails extends _CancellationDetailsBase__WEBPACK_IMPORTED_MODULE_0__.CancellationDetailsBase {
    constructor(reason, errorDetails, errorCode) {
        super(reason, errorDetails, errorCode);
    }
    /**
     * Creates an instance of CancellationDetails object for the canceled RecognitionResult.
     * @member CancellationDetails.fromResult
     * @function
     * @public
     * @param {RecognitionResult | SpeechSynthesisResult} result - The result that was canceled.
     * @returns {CancellationDetails} The cancellation details object being created.
     */
    static fromResult(result) {
        let reason = _Exports__WEBPACK_IMPORTED_MODULE_1__.CancellationReason.Error;
        let errorCode = _Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationErrorCode.NoError;
        if (result instanceof _Exports__WEBPACK_IMPORTED_MODULE_3__.RecognitionResult && !!result.json) {
            const simpleSpeech = _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.SimpleSpeechPhrase.fromJSON(result.json);
            reason = _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.EnumTranslation.implTranslateCancelResult(simpleSpeech.RecognitionStatus);
        }
        if (!!result.properties) {
            errorCode = _Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationErrorCode[result.properties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCodePropertyName, _Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationErrorCode[_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationErrorCode.NoError])];
        }
        return new CancellationDetails(reason, result.errorDetails || _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.EnumTranslation.implTranslateErrorDetails(errorCode), errorCode);
    }
}

//# sourceMappingURL=CancellationDetails.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetailsBase.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetailsBase.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CancellationDetailsBase": () => (/* binding */ CancellationDetailsBase)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Contains detailed information about why a result was canceled.
 * @class CancellationDetailsBase
 */
class CancellationDetailsBase {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {CancellationReason} reason - The cancellation reason.
     * @param {string} errorDetails - The error details, if provided.
     */
    constructor(reason, errorDetails, errorCode) {
        this.privReason = reason;
        this.privErrorDetails = errorDetails;
        this.privErrorCode = errorCode;
    }
    /**
     * The reason the recognition was canceled.
     * @member CancellationDetailsBase.prototype.reason
     * @function
     * @public
     * @returns {CancellationReason} Specifies the reason canceled.
     */
    get reason() {
        return this.privReason;
    }
    /**
     * In case of an unsuccessful recognition, provides details of the occurred error.
     * @member CancellationDetailsBase.prototype.errorDetails
     * @function
     * @public
     * @returns {string} A String that represents the error details.
     */
    get errorDetails() {
        return this.privErrorDetails;
    }
    /**
     * The error code in case of an unsuccessful recognition.
     * Added in version 1.1.0.
     * @return An error code that represents the error reason.
     */
    get ErrorCode() {
        return this.privErrorCode;
    }
}

//# sourceMappingURL=CancellationDetailsBase.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js ***!
  \**************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CancellationErrorCode": () => (/* binding */ CancellationErrorCode)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines error code in case that CancellationReason is Error.
 * Added in version 1.1.0.
 */
var CancellationErrorCode;
(function (CancellationErrorCode) {
    /**
     * Indicates that no error occurred during speech recognition.
     */
    CancellationErrorCode[CancellationErrorCode["NoError"] = 0] = "NoError";
    /**
     * Indicates an authentication error.
     */
    CancellationErrorCode[CancellationErrorCode["AuthenticationFailure"] = 1] = "AuthenticationFailure";
    /**
     * Indicates that one or more recognition parameters are invalid.
     */
    CancellationErrorCode[CancellationErrorCode["BadRequestParameters"] = 2] = "BadRequestParameters";
    /**
     * Indicates that the number of parallel requests exceeded the number of allowed
     * concurrent transcriptions for the subscription.
     */
    CancellationErrorCode[CancellationErrorCode["TooManyRequests"] = 3] = "TooManyRequests";
    /**
     * Indicates a connection error.
     */
    CancellationErrorCode[CancellationErrorCode["ConnectionFailure"] = 4] = "ConnectionFailure";
    /**
     * Indicates a time-out error when waiting for response from service.
     */
    CancellationErrorCode[CancellationErrorCode["ServiceTimeout"] = 5] = "ServiceTimeout";
    /**
     * Indicates that an error is returned by the service.
     */
    CancellationErrorCode[CancellationErrorCode["ServiceError"] = 6] = "ServiceError";
    /**
     * Indicates an unexpected runtime error.
     */
    CancellationErrorCode[CancellationErrorCode["RuntimeError"] = 7] = "RuntimeError";
    /**
     * Indicates an quota overrun on existing key.
     */
    CancellationErrorCode[CancellationErrorCode["Forbidden"] = 8] = "Forbidden";
})(CancellationErrorCode || (CancellationErrorCode = {}));

//# sourceMappingURL=CancellationErrorCodes.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationEventArgsBase.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationEventArgsBase.js ***!
  \*****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CancellationEventArgsBase": () => (/* binding */ CancellationEventArgsBase)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Defines content of a CancellationEvent.
 * @class CancellationEventArgsBase
 */
class CancellationEventArgsBase extends _Exports__WEBPACK_IMPORTED_MODULE_0__.RecognitionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {CancellationReason} reason - The cancellation reason.
     * @param {string} errorDetails - Error details, if provided.
     * @param {number} offset - The offset.
     * @param {string} sessionId - The session id.
     */
    constructor(reason, errorDetails, errorCode, offset, sessionId) {
        super(offset, sessionId);
        this.privReason = reason;
        this.privErrorDetails = errorDetails;
        this.privErrorCode = errorCode;
    }
    /**
     * The reason the recognition was canceled.
     * @member CancellationEventArgsBase.prototype.reason
     * @function
     * @public
     * @returns {CancellationReason} Specifies the reason canceled.
     */
    get reason() {
        return this.privReason;
    }
    /**
     * The error code in case of an unsuccessful operation.
     * @return An error code that represents the error reason.
     */
    get errorCode() {
        return this.privErrorCode;
    }
    /**
     * In case of an unsuccessful operation, provides details of the occurred error.
     * @member CancellationEventArgsBase.prototype.errorDetails
     * @function
     * @public
     * @returns {string} A String that represents the error details.
     */
    get errorDetails() {
        return this.privErrorDetails;
    }
}

//# sourceMappingURL=CancellationEventArgsBase.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CancellationReason": () => (/* binding */ CancellationReason)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines the possible reasons a recognition result might be canceled.
 * @class CancellationReason
 */
var CancellationReason;
(function (CancellationReason) {
    /**
     * Indicates that an error occurred during speech recognition.
     * @member CancellationReason.Error
     */
    CancellationReason[CancellationReason["Error"] = 0] = "Error";
    /**
     * Indicates that the end of the audio stream was reached.
     * @member CancellationReason.EndOfStream
     */
    CancellationReason[CancellationReason["EndOfStream"] = 1] = "EndOfStream";
})(CancellationReason || (CancellationReason = {}));

//# sourceMappingURL=CancellationReason.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Connection.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Connection.js ***!
  \**************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Connection": () => (/* binding */ Connection)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisAdapterBase.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _ConnectionMessage__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ConnectionMessage */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionMessage.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionEventArgs.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionMessageEventArgs.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ServiceEventArgs.js");
//
// Copyright (c) Microsoft. All rights reserved.
// Licensed under the MIT license. See LICENSE.md file in the project root for full license information.
//





/**
 * Connection is a proxy class for managing connection to the speech service of the specified Recognizer.
 * By default, a Recognizer autonomously manages connection to service when needed.
 * The Connection class provides additional methods for users to explicitly open or close a connection and
 * to subscribe to connection status changes.
 * The use of Connection is optional, and mainly for scenarios where fine tuning of application
 * behavior based on connection status is needed. Users can optionally call Open() to manually set up a connection
 * in advance before starting recognition on the Recognizer associated with this Connection.
 * If the Recognizer needs to connect or disconnect to service, it will
 * setup or shutdown the connection independently. In this case the Connection will be notified by change of connection
 * status via Connected/Disconnected events.
 * Added in version 1.2.1.
 */
class Connection {
    /**
     * Gets the Connection instance from the specified recognizer.
     * @param recognizer The recognizer associated with the connection.
     * @return The Connection instance of the recognizer.
     */
    static fromRecognizer(recognizer) {
        const recoBase = recognizer.internalData;
        const ret = new Connection();
        ret.privInternalData = recoBase;
        ret.setupEvents();
        return ret;
    }
    /**
     * Gets the Connection instance from the specified synthesizer.
     * @param synthesizer The synthesizer associated with the connection.
     * @return The Connection instance of the synthesizer.
     */
    static fromSynthesizer(synthesizer) {
        const synthBase = synthesizer.internalData;
        const ret = new Connection();
        ret.privInternalData = synthBase;
        ret.setupEvents();
        return ret;
    }
    /**
     * Starts to set up connection to the service.
     * Users can optionally call openConnection() to manually set up a connection in advance before starting recognition on the
     * Recognizer associated with this Connection. After starting recognition, calling Open() will have no effect
     *
     * Note: On return, the connection might not be ready yet. Please subscribe to the Connected event to
     * be notified when the connection is established.
     */
    openConnection(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.marshalPromiseToCallbacks)(this.privInternalData.connect(), cb, err);
    }
    /**
     * Closes the connection the service.
     * Users can optionally call closeConnection() to manually shutdown the connection of the associated Recognizer.
     *
     * If closeConnection() is called during recognition, recognition will fail and cancel with an error.
     */
    closeConnection(cb, err) {
        if (this.privInternalData instanceof _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__.SynthesisAdapterBase) {
            throw new Error("Disconnecting a synthesizer's connection is currently not supported");
        }
        else {
            (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.marshalPromiseToCallbacks)(this.privInternalData.disconnect(), cb, err);
        }
    }
    /**
     * Appends a parameter in a message to service.
     * Added in version 1.12.1.
     * @param path The path of the network message.
     * @param propertyName Name of the property
     * @param propertyValue Value of the property. This is a json string.
     */
    setMessageProperty(path, propertyName, propertyValue) {
        _Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrWhitespace(propertyName, "propertyName");
        if (this.privInternalData instanceof _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.ServiceRecognizerBase) {
            if (path.toLowerCase() !== "speech.context") {
                throw new Error("Only speech.context message property sets are currently supported for recognizer");
            }
            else {
                this.privInternalData.speechContext.setSection(propertyName, propertyValue);
            }
        }
        else if (this.privInternalData instanceof _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__.SynthesisAdapterBase) {
            if (path.toLowerCase() !== "synthesis.context") {
                throw new Error("Only synthesis.context message property sets are currently supported for synthesizer");
            }
            else {
                this.privInternalData.synthesisContext.setSection(propertyName, propertyValue);
            }
        }
    }
    /**
     * Sends a message to the speech service.
     * Added in version 1.13.0.
     * @param path The WebSocket path of the message
     * @param payload The payload of the message. This is a json string or a ArrayBuffer.
     * @param success A callback to indicate success.
     * @param error A callback to indicate an error.
     */
    sendMessageAsync(path, payload, success, error) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.marshalPromiseToCallbacks)(this.privInternalData.sendNetworkMessage(path, payload), success, error);
    }
    /**
     * Dispose of associated resources.
     */
    close() {
        /* eslint-disable no-empty */
    }
    setupEvents() {
        this.privEventListener = this.privInternalData.connectionEvents.attach((connectionEvent) => {
            if (connectionEvent.name === "ConnectionEstablishedEvent") {
                if (!!this.connected) {
                    this.connected(new _Exports__WEBPACK_IMPORTED_MODULE_4__.ConnectionEventArgs(connectionEvent.connectionId));
                }
            }
            else if (connectionEvent.name === "ConnectionClosedEvent") {
                if (!!this.disconnected) {
                    this.disconnected(new _Exports__WEBPACK_IMPORTED_MODULE_4__.ConnectionEventArgs(connectionEvent.connectionId));
                }
            }
            else if (connectionEvent.name === "ConnectionMessageSentEvent") {
                if (!!this.messageSent) {
                    this.messageSent(new _Exports__WEBPACK_IMPORTED_MODULE_5__.ConnectionMessageEventArgs(new _ConnectionMessage__WEBPACK_IMPORTED_MODULE_6__.ConnectionMessageImpl(connectionEvent.message)));
                }
            }
            else if (connectionEvent.name === "ConnectionMessageReceivedEvent") {
                if (!!this.messageReceived) {
                    this.messageReceived(new _Exports__WEBPACK_IMPORTED_MODULE_5__.ConnectionMessageEventArgs(new _ConnectionMessage__WEBPACK_IMPORTED_MODULE_6__.ConnectionMessageImpl(connectionEvent.message)));
                }
            }
        });
        this.privServiceEventListener = this.privInternalData.serviceEvents.attach((e) => {
            if (!!this.receivedServiceMessage) {
                this.receivedServiceMessage(new _Exports__WEBPACK_IMPORTED_MODULE_7__.ServiceEventArgs(e.jsonString, e.name));
            }
        });
    }
}

//# sourceMappingURL=Connection.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionEventArgs.js":
/*!***********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionEventArgs.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectionEventArgs": () => (/* binding */ ConnectionEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
//
// Copyright (c) Microsoft. All rights reserved.
// Licensed under the MIT license. See LICENSE.md file in the project root for full license information.
//

/**
 * Defines payload for connection events like Connected/Disconnected.
 * Added in version 1.2.0
 */
class ConnectionEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
}

//# sourceMappingURL=ConnectionEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionMessage.js":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionMessage.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectionMessage": () => (/* binding */ ConnectionMessage),
/* harmony export */   "ConnectionMessageImpl": () => (/* binding */ ConnectionMessageImpl)
/* harmony export */ });
/* harmony import */ var _common_speech_HeaderNames__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common.speech/HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _PropertyCollection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PropertyCollection */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _PropertyId__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./PropertyId */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
//
// Copyright (c) Microsoft. All rights reserved.
// Licensed under the MIT license. See LICENSE.md file in the project root for full license information.
//
// eslint-disable-next-line max-classes-per-file




/**
 * ConnectionMessage represents implementation specific messages sent to and received from
 * the speech service. These messages are provided for debugging purposes and should not
 * be used for production use cases with the Azure Cognitive Services Speech Service.
 * Messages sent to and received from the Speech Service are subject to change without
 * notice. This includes message contents, headers, payloads, ordering, etc.
 * Added in version 1.11.0.
 */
class ConnectionMessage {
}
class ConnectionMessageImpl {
    constructor(message) {
        this.privConnectionMessage = message;
        this.privProperties = new _PropertyCollection__WEBPACK_IMPORTED_MODULE_0__.PropertyCollection();
        if (!!this.privConnectionMessage.headers[_common_speech_HeaderNames__WEBPACK_IMPORTED_MODULE_1__.HeaderNames.ConnectionId]) {
            this.privProperties.setProperty(_PropertyId__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Speech_SessionId, this.privConnectionMessage.headers[_common_speech_HeaderNames__WEBPACK_IMPORTED_MODULE_1__.HeaderNames.ConnectionId]);
        }
        Object.keys(this.privConnectionMessage.headers).forEach((header) => {
            this.privProperties.setProperty(header, this.privConnectionMessage.headers[header]);
        });
    }
    /**
     * The message path.
     */
    get path() {
        return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find((key) => key.toLowerCase() === "path".toLowerCase())];
    }
    /**
     * Checks to see if the ConnectionMessage is a text message.
     * See also IsBinaryMessage().
     */
    get isTextMessage() {
        return this.privConnectionMessage.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_3__.MessageType.Text;
    }
    /**
     * Checks to see if the ConnectionMessage is a binary message.
     * See also GetBinaryMessage().
     */
    get isBinaryMessage() {
        return this.privConnectionMessage.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_3__.MessageType.Binary;
    }
    /**
     * Gets the text message payload. Typically the text message content-type is
     * application/json. To determine other content-types use
     * Properties.GetProperty("Content-Type").
     */
    get TextMessage() {
        return this.privConnectionMessage.textBody;
    }
    /**
     * Gets the binary message payload.
     */
    get binaryMessage() {
        return this.privConnectionMessage.binaryBody;
    }
    /**
     * A collection of properties and their values defined for this <see cref="ConnectionMessage"/>.
     * Message headers can be accessed via this collection (e.g. "Content-Type").
     */
    get properties() {
        return this.privProperties;
    }
    /**
     * Returns a string that represents the connection message.
     */
    toString() {
        return "";
    }
}

//# sourceMappingURL=ConnectionMessage.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionMessageEventArgs.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionMessageEventArgs.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectionMessageEventArgs": () => (/* binding */ ConnectionMessageEventArgs)
/* harmony export */ });
//
// Copyright (c) Microsoft. All rights reserved.
// Licensed under the MIT license. See LICENSE.md file in the project root for full license information.
//
class ConnectionMessageEventArgs {
    constructor(message) {
        this.privConnectionMessage = message;
    }
    /**
     * Gets the <see cref="ConnectionMessage"/> associated with this <see cref="ConnectionMessageEventArgs"/>.
     */
    get message() {
        return this.privConnectionMessage;
    }
    /**
     * Returns a string that represents the connection message event.
     */
    toString() {
        return "Message: " + this.privConnectionMessage.toString();
    }
}

//# sourceMappingURL=ConnectionMessageEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Contracts": () => (/* binding */ Contracts)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * @class Contracts
 * @private
 */
class Contracts {
    static throwIfNullOrUndefined(param, name) {
        if (param === undefined || param === null) {
            throw new Error("throwIfNullOrUndefined:" + name);
        }
    }
    static throwIfNull(param, name) {
        if (param === null) {
            throw new Error("throwIfNull:" + name);
        }
    }
    static throwIfNullOrWhitespace(param, name) {
        Contracts.throwIfNullOrUndefined(param, name);
        if (("" + param).trim().length < 1) {
            throw new Error("throwIfNullOrWhitespace:" + name);
        }
    }
    static throwIfNullOrTooLong(param, name, maxLength) {
        Contracts.throwIfNullOrUndefined(param, name);
        if (("" + param).length > maxLength) {
            throw new Error("throwIfNullOrTooLong:" + name + " (more than " + maxLength.toString() + " characters)");
        }
    }
    static throwIfNullOrTooShort(param, name, minLength) {
        Contracts.throwIfNullOrUndefined(param, name);
        if (("" + param).length < minLength) {
            throw new Error("throwIfNullOrTooShort:" + name + " (less than " + minLength.toString() + " characters)");
        }
    }
    static throwIfDisposed(isDisposed) {
        if (isDisposed) {
            throw new Error("the object is already disposed");
        }
    }
    static throwIfArrayEmptyOrWhitespace(array, name) {
        Contracts.throwIfNullOrUndefined(array, name);
        if (array.length === 0) {
            throw new Error("throwIfArrayEmptyOrWhitespace:" + name);
        }
        for (const item of array) {
            Contracts.throwIfNullOrWhitespace(item, name);
        }
    }
    static throwIfFileDoesNotExist(param, name) {
        Contracts.throwIfNullOrWhitespace(param, name);
        // TODO check for file existence.
    }
    static throwIfNotUndefined(param, name) {
        if (param !== undefined) {
            throw new Error("throwIfNotUndefined:" + name);
        }
    }
}

//# sourceMappingURL=Contracts.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConversationTranscriptionCanceledEventArgs.js":
/*!**********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConversationTranscriptionCanceledEventArgs.js ***!
  \**********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationTranscriptionCanceledEventArgs": () => (/* binding */ ConversationTranscriptionCanceledEventArgs)
/* harmony export */ });
/* harmony import */ var _CancellationEventArgsBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CancellationEventArgsBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationEventArgsBase.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Defines content of a RecognitionErrorEvent.
 * @class ConversationTranscriptionCanceledEventArgs
 */
class ConversationTranscriptionCanceledEventArgs extends _CancellationEventArgsBase__WEBPACK_IMPORTED_MODULE_0__.CancellationEventArgsBase {
}

//# sourceMappingURL=ConversationTranscriptionCanceledEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CustomCommandsConfig.js":
/*!************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CustomCommandsConfig.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CustomCommandsConfig": () => (/* binding */ CustomCommandsConfig)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./DialogServiceConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



/**
 * Class that defines configurations for the dialog service connector object for using a CustomCommands backend.
 * @class CustomCommandsConfig
 */
class CustomCommandsConfig extends _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfigImpl {
    /**
     * Creates an instance of CustomCommandsConfig.
     */
    constructor() {
        super();
    }
    /**
     * Creates an instance of the bot framework config with the specified subscription and region.
     * @member CustomCommandsConfig.fromSubscription
     * @function
     * @public
     * @param applicationId Speech Commands application id.
     * @param subscription Subscription key associated with the bot
     * @param region The region name (see the <a href="https://aka.ms/csspeech/region">region page</a>).
     * @returns {CustomCommandsConfig} A new bot framework config.
     */
    static fromSubscription(applicationId, subscription, region) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(applicationId, "applicationId");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(subscription, "subscription");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(region, "region");
        const customCommandsConfig = new _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfigImpl();
        customCommandsConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_DialogType, _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfig.DialogTypes.CustomCommands);
        customCommandsConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_ApplicationId, applicationId);
        customCommandsConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Key, subscription);
        customCommandsConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Region, region);
        return customCommandsConfig;
    }
    /**
     * Creates an instance of the bot framework config with the specified Speech Commands application id, authorization token and region.
     * Note: The caller needs to ensure that the authorization token is valid. Before the authorization token
     * expires, the caller needs to refresh it by calling this setter with a new valid token.
     * As configuration values are copied when creating a new recognizer, the new token value will not apply to recognizers that have already been created.
     * For recognizers that have been created before, you need to set authorization token of the corresponding recognizer
     * to refresh the token. Otherwise, the recognizers will encounter errors during recognition.
     * @member CustomCommandsConfig.fromAuthorizationToken
     * @function
     * @public
     * @param applicationId Speech Commands application id.
     * @param authorizationToken The authorization token associated with the application.
     * @param region The region name (see the <a href="https://aka.ms/csspeech/region">region page</a>).
     * @returns {CustomCommandsConfig} A new speech commands config.
     */
    static fromAuthorizationToken(applicationId, authorizationToken, region) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(applicationId, "applicationId");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(authorizationToken, "authorizationToken");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(region, "region");
        const customCommandsConfig = new _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfigImpl();
        customCommandsConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_DialogType, _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfig.DialogTypes.CustomCommands);
        customCommandsConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_ApplicationId, applicationId);
        customCommandsConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token, authorizationToken);
        customCommandsConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Region, region);
        return customCommandsConfig;
    }
    /**
     * Sets the corresponding backend application identifier.
     * @member CustomCommandsConfig.prototype.Conversation_ApplicationId
     * @function
     * @public
     * @param {string} value - The application identifier to set.
     */
    set applicationId(value) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(value, "value");
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_ApplicationId, value);
    }
    /**
     * Gets the corresponding backend application identifier.
     * @member CustomCommandsConfig.prototype.Conversation_ApplicationId
     * @function
     * @public
     * @param {string} value - The application identifier to get.
     */
    get applicationId() {
        return this.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_ApplicationId);
    }
}

//# sourceMappingURL=CustomCommandsConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Diagnostics.js":
/*!***************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Diagnostics.js ***!
  \***************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Diagnostics": () => (/* binding */ Diagnostics)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ConsoleLoggingListener.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
//
// Copyright (c) Microsoft. All rights reserved.
// Licensed under the MIT license. See LICENSE.md file in the project root for full license information.
//


/**
 * Defines diagnostics API for managing console output
 * Added in version 1.21.0
 */
class Diagnostics {
    static SetLoggingLevel(logLevel) {
        this.privListener = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_0__.ConsoleLoggingListener(logLevel);
        _common_Exports__WEBPACK_IMPORTED_MODULE_1__.Events.instance.attachConsoleListener(this.privListener);
    }
    static StartConsoleOutput() {
        if (!!this.privListener) {
            this.privListener.enableConsoleOutput = true;
        }
    }
    static StopConsoleOutput() {
        if (!!this.privListener) {
            this.privListener.enableConsoleOutput = false;
        }
    }
    static SetLogOutputPath(path) {
        if (typeof window === "undefined") {
            if (!!this.privListener) {
                this.privListener.logPath = path;
            }
        }
        else {
            throw new Error("File system logging not available in browser.");
        }
    }
}
Diagnostics.privListener = undefined;

//# sourceMappingURL=Diagnostics.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConfig.js":
/*!***********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConfig.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DialogServiceConfig": () => (/* binding */ DialogServiceConfig),
/* harmony export */   "DialogServiceConfigImpl": () => (/* binding */ DialogServiceConfigImpl)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */


/**
 * Class that defines base configurations for dialog service connector
 * @class DialogServiceConfig
 */
class DialogServiceConfig {
    /**
     * Creates an instance of DialogService config.
     * @constructor
     */
    constructor() {
        return;
    }
    /**
     * Sets the corresponding backend application identifier.
     * @member DialogServiceConfig.prototype.Conversation_ApplicationId
     * @function
     * @public
     * @param {string} value - The application identifier to set.
     */
    // eslint-disable-next-line @typescript-eslint/no-empty-function
    set applicationId(value) { }
    static get DialogTypes() {
        return {
            BotFramework: "bot_framework",
            CustomCommands: "custom_commands"
        };
    }
}
/**
 * Dialog Service configuration.
 * @class DialogServiceConfigImpl
 */
class DialogServiceConfigImpl extends DialogServiceConfig {
    /**
     * Creates an instance of dialogService config.
     */
    constructor() {
        super();
        this.privSpeechConfig = new _Exports__WEBPACK_IMPORTED_MODULE_0__.SpeechConfigImpl();
    }
    /**
     * Provides access to custom properties.
     * @member DialogServiceConfigImpl.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The properties.
     */
    get properties() {
        return this.privSpeechConfig.properties;
    }
    /**
     * Gets the speech recognition language.
     * @member DialogServiceConfigImpl.prototype.speechRecognitionLanguage
     * @function
     * @public
     */
    get speechRecognitionLanguage() {
        return this.privSpeechConfig.speechRecognitionLanguage;
    }
    /**
     * Sets the speech recognition language.
     * @member DialogServiceConfigImpl.prototype.speechRecognitionLanguage
     * @function
     * @public
     * @param {string} value - The language to set.
     */
    set speechRecognitionLanguage(value) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(value, "value");
        this.privSpeechConfig.speechRecognitionLanguage = value;
    }
    get outputFormat() {
        return this.privSpeechConfig.outputFormat;
    }
    set outputFormat(value) {
        this.privSpeechConfig.outputFormat = value;
    }
    /**
     * Sets a named property as value
     * @member DialogServiceConfigImpl.prototype.setProperty
     * @function
     * @public
     * @param {PropertyId | string} name - The property to set.
     * @param {string} value - The value.
     */
    setProperty(name, value) {
        this.privSpeechConfig.setProperty(name, value);
    }
    /**
     * Sets a named property as value
     * @member DialogServiceConfigImpl.prototype.getProperty
     * @function
     * @public
     * @param {PropertyId | string} name - The property to get.
     * @param {string} def - The default value to return in case the property is not known.
     * @returns {string} The current value, or provided default, of the given property.
     */
    getProperty(name, def) {
        void def;
        return this.privSpeechConfig.getProperty(name);
    }
    /**
     * Sets the proxy configuration.
     * Only relevant in Node.js environments.
     * Added in version 1.4.0.
     * @param proxyHostName The host name of the proxy server, without the protocol scheme (http://)
     * @param proxyPort The port number of the proxy server.
     * @param proxyUserName The user name of the proxy server.
     * @param proxyPassword The password of the proxy server.
     */
    setProxy(proxyHostName, proxyPort, proxyUserName, proxyPassword) {
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_ProxyHostName, proxyHostName);
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_ProxyPort, `${proxyPort}`);
        if (proxyUserName) {
            this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_ProxyUserName, proxyUserName);
        }
        if (proxyPassword) {
            this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_ProxyPassword, proxyPassword);
        }
    }
    setServiceProperty(name, value, channel) {
        void channel;
        this.privSpeechConfig.setServiceProperty(name, value);
    }
    /**
     * Dispose of associated resources.
     * @member DialogServiceConfigImpl.prototype.close
     * @function
     * @public
     */
    close() {
        return;
    }
}

//# sourceMappingURL=DialogServiceConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConnector.js":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConnector.js ***!
  \**************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DialogServiceConnector": () => (/* binding */ DialogServiceConnector)
/* harmony export */ });
/* harmony import */ var _common_speech_DialogConnectorFactory__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common.speech/DialogConnectorFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogConnectorFactory.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceAdapter.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js");
/* harmony import */ var _PropertyId__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./PropertyId */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};






/**
 * Dialog Service Connector
 * @class DialogServiceConnector
 */
class DialogServiceConnector extends _Exports__WEBPACK_IMPORTED_MODULE_0__.Recognizer {
    /**
     * Initializes an instance of the DialogServiceConnector.
     * @constructor
     * @param {DialogServiceConfig} dialogConfig - Set of properties to configure this recognizer.
     * @param {AudioConfig} audioConfig - An optional audio config associated with the recognizer
     */
    constructor(dialogConfig, audioConfig) {
        const dialogServiceConfigImpl = dialogConfig;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(dialogConfig, "dialogConfig");
        super(audioConfig, dialogServiceConfigImpl.properties, new _common_speech_DialogConnectorFactory__WEBPACK_IMPORTED_MODULE_2__.DialogConnectionFactory());
        this.isTurnComplete = true;
        this.privIsDisposed = false;
        this.privProperties = dialogServiceConfigImpl.properties.clone();
        const agentConfig = this.buildAgentConfig();
        this.privReco.agentConfig.set(agentConfig);
    }
    /**
     * Starts a connection to the service.
     * Users can optionally call connect() to manually set up a connection in advance, before starting interactions.
     *
     * Note: On return, the connection might not be ready yet. Please subscribe to the Connected event to
     * be notified when the connection is established.
     * @member DialogServiceConnector.prototype.connect
     * @function
     * @public
     */
    connect(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)(this.privReco.connect(), cb, err);
    }
    /**
     * Closes the connection the service.
     * Users can optionally call disconnect() to manually shutdown the connection of the associated DialogServiceConnector.
     *
     * If disconnect() is called during a recognition, recognition will fail and cancel with an error.
     */
    disconnect(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)(this.privReco.disconnect(), cb, err);
    }
    /**
     * Gets the authorization token used to communicate with the service.
     * @member DialogServiceConnector.prototype.authorizationToken
     * @function
     * @public
     * @returns {string} Authorization token.
     */
    get authorizationToken() {
        return this.properties.getProperty(_PropertyId__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceAuthorization_Token);
    }
    /**
     * Sets the authorization token used to communicate with the service.
     * @member DialogServiceConnector.prototype.authorizationToken
     * @function
     * @public
     * @param {string} token - Authorization token.
     */
    set authorizationToken(token) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(token, "token");
        this.properties.setProperty(_PropertyId__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceAuthorization_Token, token);
    }
    /**
     * The collection of properties and their values defined for this DialogServiceConnector.
     * @member DialogServiceConnector.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The collection of properties and their values defined for this DialogServiceConnector.
     */
    get properties() {
        return this.privProperties;
    }
    /** Gets the template for the activity generated by service from speech.
     * Properties from the template will be stamped on the generated activity.
     * It can be empty
     */
    get speechActivityTemplate() {
        return this.properties.getProperty(_PropertyId__WEBPACK_IMPORTED_MODULE_4__.PropertyId.Conversation_Speech_Activity_Template);
    }
    /** Sets the template for the activity generated by service from speech.
     * Properties from the template will be stamped on the generated activity.
     * It can be null or empty.
     * Note: it has to be a valid Json object.
     */
    set speechActivityTemplate(speechActivityTemplate) {
        this.properties.setProperty(_PropertyId__WEBPACK_IMPORTED_MODULE_4__.PropertyId.Conversation_Speech_Activity_Template, speechActivityTemplate);
    }
    /**
     * Starts recognition and stops after the first utterance is recognized.
     * @member DialogServiceConnector.prototype.listenOnceAsync
     * @function
     * @public
     * @param cb - Callback that received the result when the reco has completed.
     * @param err - Callback invoked in case of an error.
     */
    listenOnceAsync(cb, err) {
        if (this.isTurnComplete) {
            _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privIsDisposed);
            const callbackHolder = () => __awaiter(this, void 0, void 0, function* () {
                yield this.privReco.connect();
                yield this.implRecognizerStop();
                this.isTurnComplete = false;
                const ret = new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.Deferred();
                yield this.privReco.recognize(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.RecognitionMode.Conversation, ret.resolve, ret.reject);
                const e = yield ret.promise;
                yield this.implRecognizerStop();
                return e;
            });
            const retPromise = callbackHolder();
            retPromise.catch(() => {
                // Destroy the recognizer.
                // We've done all we can here.
                // eslint-disable-next-line @typescript-eslint/no-empty-function
                this.dispose(true).catch(() => { });
            });
            (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)(retPromise.finally(() => {
                this.isTurnComplete = true;
            }), cb, err);
        }
    }
    sendActivityAsync(activity, cb, errCb) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)(this.privReco.sendMessage(activity), cb, errCb);
    }
    /**
     * closes all external resources held by an instance of this class.
     * @member DialogServiceConnector.prototype.close
     * @function
     * @public
     */
    close(cb, err) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privIsDisposed);
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)(this.dispose(true), cb, err);
    }
    dispose(disposing) {
        const _super = Object.create(null, {
            dispose: { get: () => super.dispose }
        });
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privIsDisposed) {
                return;
            }
            if (disposing) {
                this.privIsDisposed = true;
                yield this.implRecognizerStop();
                yield _super.dispose.call(this, disposing);
            }
        });
    }
    createRecognizerConfig(speechConfig) {
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.RecognizerConfig(speechConfig, this.privProperties);
    }
    createServiceRecognizer(authentication, connectionFactory, audioConfig, recognizerConfig) {
        const audioSource = audioConfig;
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__.DialogServiceAdapter(authentication, connectionFactory, audioSource, recognizerConfig, this);
    }
    buildAgentConfig() {
        const communicationType = this.properties.getProperty("Conversation_Communication_Type", "Default");
        return {
            botInfo: {
                commType: communicationType,
                commandsCulture: undefined,
                connectionId: this.properties.getProperty(_PropertyId__WEBPACK_IMPORTED_MODULE_4__.PropertyId.Conversation_Agent_Connection_Id),
                conversationId: this.properties.getProperty(_PropertyId__WEBPACK_IMPORTED_MODULE_4__.PropertyId.Conversation_Conversation_Id, undefined),
                fromId: this.properties.getProperty(_PropertyId__WEBPACK_IMPORTED_MODULE_4__.PropertyId.Conversation_From_Id, undefined),
                ttsAudioFormat: this.properties.getProperty(_PropertyId__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceConnection_SynthOutputFormat, undefined)
            },
            version: 0.2
        };
    }
}

//# sourceMappingURL=DialogServiceConnector.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Exports.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Exports.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ActivityReceivedEventArgs": () => (/* reexport safe */ _ActivityReceivedEventArgs__WEBPACK_IMPORTED_MODULE_48__.ActivityReceivedEventArgs),
/* harmony export */   "AudioConfig": () => (/* reexport safe */ _Audio_AudioConfig__WEBPACK_IMPORTED_MODULE_0__.AudioConfig),
/* harmony export */   "AudioFormatTag": () => (/* reexport safe */ _Audio_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_1__.AudioFormatTag),
/* harmony export */   "AudioInputStream": () => (/* reexport safe */ _Audio_AudioInputStream__WEBPACK_IMPORTED_MODULE_2__.AudioInputStream),
/* harmony export */   "AudioOutputStream": () => (/* reexport safe */ _Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_3__.AudioOutputStream),
/* harmony export */   "AudioStreamFormat": () => (/* reexport safe */ _Audio_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_1__.AudioStreamFormat),
/* harmony export */   "AutoDetectSourceLanguageConfig": () => (/* reexport safe */ _AutoDetectSourceLanguageConfig__WEBPACK_IMPORTED_MODULE_63__.AutoDetectSourceLanguageConfig),
/* harmony export */   "AutoDetectSourceLanguageResult": () => (/* reexport safe */ _AutoDetectSourceLanguageResult__WEBPACK_IMPORTED_MODULE_64__.AutoDetectSourceLanguageResult),
/* harmony export */   "BaseAudioPlayer": () => (/* reexport safe */ _Audio_BaseAudioPlayer__WEBPACK_IMPORTED_MODULE_52__.BaseAudioPlayer),
/* harmony export */   "BotFrameworkConfig": () => (/* reexport safe */ _BotFrameworkConfig__WEBPACK_IMPORTED_MODULE_45__.BotFrameworkConfig),
/* harmony export */   "CancellationDetails": () => (/* reexport safe */ _CancellationDetails__WEBPACK_IMPORTED_MODULE_38__.CancellationDetails),
/* harmony export */   "CancellationDetailsBase": () => (/* reexport safe */ _CancellationDetailsBase__WEBPACK_IMPORTED_MODULE_37__.CancellationDetailsBase),
/* harmony export */   "CancellationErrorCode": () => (/* reexport safe */ _CancellationErrorCodes__WEBPACK_IMPORTED_MODULE_39__.CancellationErrorCode),
/* harmony export */   "CancellationReason": () => (/* reexport safe */ _CancellationReason__WEBPACK_IMPORTED_MODULE_4__.CancellationReason),
/* harmony export */   "Connection": () => (/* reexport safe */ _Connection__WEBPACK_IMPORTED_MODULE_42__.Connection),
/* harmony export */   "ConnectionEventArgs": () => (/* reexport safe */ _ConnectionEventArgs__WEBPACK_IMPORTED_MODULE_40__.ConnectionEventArgs),
/* harmony export */   "ConnectionMessage": () => (/* reexport safe */ _ConnectionMessage__WEBPACK_IMPORTED_MODULE_54__.ConnectionMessage),
/* harmony export */   "ConnectionMessageEventArgs": () => (/* reexport safe */ _ConnectionMessageEventArgs__WEBPACK_IMPORTED_MODULE_53__.ConnectionMessageEventArgs),
/* harmony export */   "Conversation": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_67__.Conversation),
/* harmony export */   "ConversationExpirationEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_68__.ConversationExpirationEventArgs),
/* harmony export */   "ConversationParticipantsChangedEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_69__.ConversationParticipantsChangedEventArgs),
/* harmony export */   "ConversationTranscriber": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_74__.ConversationTranscriber),
/* harmony export */   "ConversationTranscriptionCanceledEventArgs": () => (/* reexport safe */ _ConversationTranscriptionCanceledEventArgs__WEBPACK_IMPORTED_MODULE_89__.ConversationTranscriptionCanceledEventArgs),
/* harmony export */   "ConversationTranscriptionEventArgs": () => (/* reexport safe */ _SpeechRecognitionEventArgs__WEBPACK_IMPORTED_MODULE_16__.ConversationTranscriptionEventArgs),
/* harmony export */   "ConversationTranslationCanceledEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_70__.ConversationTranslationCanceledEventArgs),
/* harmony export */   "ConversationTranslationEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_71__.ConversationTranslationEventArgs),
/* harmony export */   "ConversationTranslationResult": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_72__.ConversationTranslationResult),
/* harmony export */   "ConversationTranslator": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_73__.ConversationTranslator),
/* harmony export */   "CustomCommandsConfig": () => (/* reexport safe */ _CustomCommandsConfig__WEBPACK_IMPORTED_MODULE_46__.CustomCommandsConfig),
/* harmony export */   "Diagnostics": () => (/* reexport safe */ _Diagnostics__WEBPACK_IMPORTED_MODULE_95__.Diagnostics),
/* harmony export */   "DialogServiceConfig": () => (/* reexport safe */ _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_44__.DialogServiceConfig),
/* harmony export */   "DialogServiceConnector": () => (/* reexport safe */ _DialogServiceConnector__WEBPACK_IMPORTED_MODULE_47__.DialogServiceConnector),
/* harmony export */   "IntentRecognitionCanceledEventArgs": () => (/* reexport safe */ _IntentRecognitionCanceledEventArgs__WEBPACK_IMPORTED_MODULE_36__.IntentRecognitionCanceledEventArgs),
/* harmony export */   "IntentRecognitionEventArgs": () => (/* reexport safe */ _IntentRecognitionEventArgs__WEBPACK_IMPORTED_MODULE_11__.IntentRecognitionEventArgs),
/* harmony export */   "IntentRecognitionResult": () => (/* reexport safe */ _IntentRecognitionResult__WEBPACK_IMPORTED_MODULE_14__.IntentRecognitionResult),
/* harmony export */   "IntentRecognizer": () => (/* reexport safe */ _IntentRecognizer__WEBPACK_IMPORTED_MODULE_29__.IntentRecognizer),
/* harmony export */   "KeywordRecognitionModel": () => (/* reexport safe */ _KeywordRecognitionModel__WEBPACK_IMPORTED_MODULE_7__.KeywordRecognitionModel),
/* harmony export */   "LanguageIdMode": () => (/* reexport safe */ _LanguageIdMode__WEBPACK_IMPORTED_MODULE_94__.LanguageIdMode),
/* harmony export */   "LanguageUnderstandingModel": () => (/* reexport safe */ _LanguageUnderstandingModel__WEBPACK_IMPORTED_MODULE_15__.LanguageUnderstandingModel),
/* harmony export */   "LogLevel": () => (/* reexport safe */ _LogLevel__WEBPACK_IMPORTED_MODULE_96__.EventType),
/* harmony export */   "NoMatchDetails": () => (/* reexport safe */ _NoMatchDetails__WEBPACK_IMPORTED_MODULE_34__.NoMatchDetails),
/* harmony export */   "NoMatchReason": () => (/* reexport safe */ _NoMatchReason__WEBPACK_IMPORTED_MODULE_33__.NoMatchReason),
/* harmony export */   "OutputFormat": () => (/* reexport safe */ _OutputFormat__WEBPACK_IMPORTED_MODULE_10__.OutputFormat),
/* harmony export */   "Participant": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_75__.Participant),
/* harmony export */   "ParticipantChangedReason": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_76__.ParticipantChangedReason),
/* harmony export */   "PhraseListGrammar": () => (/* reexport safe */ _PhraseListGrammar__WEBPACK_IMPORTED_MODULE_43__.PhraseListGrammar),
/* harmony export */   "ProfanityOption": () => (/* reexport safe */ _ProfanityOption__WEBPACK_IMPORTED_MODULE_51__.ProfanityOption),
/* harmony export */   "PronunciationAssessmentConfig": () => (/* reexport safe */ _PronunciationAssessmentConfig__WEBPACK_IMPORTED_MODULE_92__.PronunciationAssessmentConfig),
/* harmony export */   "PronunciationAssessmentGradingSystem": () => (/* reexport safe */ _PronunciationAssessmentGradingSystem__WEBPACK_IMPORTED_MODULE_90__.PronunciationAssessmentGradingSystem),
/* harmony export */   "PronunciationAssessmentGranularity": () => (/* reexport safe */ _PronunciationAssessmentGranularity__WEBPACK_IMPORTED_MODULE_91__.PronunciationAssessmentGranularity),
/* harmony export */   "PronunciationAssessmentResult": () => (/* reexport safe */ _PronunciationAssessmentResult__WEBPACK_IMPORTED_MODULE_93__.PronunciationAssessmentResult),
/* harmony export */   "PropertyCollection": () => (/* reexport safe */ _PropertyCollection__WEBPACK_IMPORTED_MODULE_25__.PropertyCollection),
/* harmony export */   "PropertyId": () => (/* reexport safe */ _PropertyId__WEBPACK_IMPORTED_MODULE_26__.PropertyId),
/* harmony export */   "PullAudioInputStream": () => (/* reexport safe */ _Audio_AudioInputStream__WEBPACK_IMPORTED_MODULE_2__.PullAudioInputStream),
/* harmony export */   "PullAudioInputStreamCallback": () => (/* reexport safe */ _Audio_PullAudioInputStreamCallback__WEBPACK_IMPORTED_MODULE_5__.PullAudioInputStreamCallback),
/* harmony export */   "PullAudioOutputStream": () => (/* reexport safe */ _Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_3__.PullAudioOutputStream),
/* harmony export */   "PushAudioInputStream": () => (/* reexport safe */ _Audio_AudioInputStream__WEBPACK_IMPORTED_MODULE_2__.PushAudioInputStream),
/* harmony export */   "PushAudioOutputStream": () => (/* reexport safe */ _Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_3__.PushAudioOutputStream),
/* harmony export */   "PushAudioOutputStreamCallback": () => (/* reexport safe */ _Audio_PushAudioOutputStreamCallback__WEBPACK_IMPORTED_MODULE_6__.PushAudioOutputStreamCallback),
/* harmony export */   "RecognitionEventArgs": () => (/* reexport safe */ _RecognitionEventArgs__WEBPACK_IMPORTED_MODULE_9__.RecognitionEventArgs),
/* harmony export */   "RecognitionResult": () => (/* reexport safe */ _RecognitionResult__WEBPACK_IMPORTED_MODULE_12__.RecognitionResult),
/* harmony export */   "Recognizer": () => (/* reexport safe */ _Recognizer__WEBPACK_IMPORTED_MODULE_27__.Recognizer),
/* harmony export */   "ResultReason": () => (/* reexport safe */ _ResultReason__WEBPACK_IMPORTED_MODULE_22__.ResultReason),
/* harmony export */   "ServiceEventArgs": () => (/* reexport safe */ _ServiceEventArgs__WEBPACK_IMPORTED_MODULE_41__.ServiceEventArgs),
/* harmony export */   "ServicePropertyChannel": () => (/* reexport safe */ _ServicePropertyChannel__WEBPACK_IMPORTED_MODULE_50__.ServicePropertyChannel),
/* harmony export */   "SessionEventArgs": () => (/* reexport safe */ _SessionEventArgs__WEBPACK_IMPORTED_MODULE_8__.SessionEventArgs),
/* harmony export */   "SourceLanguageConfig": () => (/* reexport safe */ _SourceLanguageConfig__WEBPACK_IMPORTED_MODULE_65__.SourceLanguageConfig),
/* harmony export */   "SpeakerAudioDestination": () => (/* reexport safe */ _Audio_SpeakerAudioDestination__WEBPACK_IMPORTED_MODULE_88__.SpeakerAudioDestination),
/* harmony export */   "SpeakerIdentificationModel": () => (/* reexport safe */ _SpeakerIdentificationModel__WEBPACK_IMPORTED_MODULE_61__.SpeakerIdentificationModel),
/* harmony export */   "SpeakerRecognitionCancellationDetails": () => (/* reexport safe */ _SpeakerRecognitionResult__WEBPACK_IMPORTED_MODULE_66__.SpeakerRecognitionCancellationDetails),
/* harmony export */   "SpeakerRecognitionResult": () => (/* reexport safe */ _SpeakerRecognitionResult__WEBPACK_IMPORTED_MODULE_66__.SpeakerRecognitionResult),
/* harmony export */   "SpeakerRecognitionResultType": () => (/* reexport safe */ _SpeakerRecognitionResult__WEBPACK_IMPORTED_MODULE_66__.SpeakerRecognitionResultType),
/* harmony export */   "SpeakerRecognizer": () => (/* reexport safe */ _SpeakerRecognizer__WEBPACK_IMPORTED_MODULE_60__.SpeakerRecognizer),
/* harmony export */   "SpeakerVerificationModel": () => (/* reexport safe */ _SpeakerVerificationModel__WEBPACK_IMPORTED_MODULE_62__.SpeakerVerificationModel),
/* harmony export */   "SpeechConfig": () => (/* reexport safe */ _SpeechConfig__WEBPACK_IMPORTED_MODULE_23__.SpeechConfig),
/* harmony export */   "SpeechConfigImpl": () => (/* reexport safe */ _SpeechConfig__WEBPACK_IMPORTED_MODULE_23__.SpeechConfigImpl),
/* harmony export */   "SpeechRecognitionCanceledEventArgs": () => (/* reexport safe */ _SpeechRecognitionCanceledEventArgs__WEBPACK_IMPORTED_MODULE_17__.SpeechRecognitionCanceledEventArgs),
/* harmony export */   "SpeechRecognitionEventArgs": () => (/* reexport safe */ _SpeechRecognitionEventArgs__WEBPACK_IMPORTED_MODULE_16__.SpeechRecognitionEventArgs),
/* harmony export */   "SpeechRecognitionResult": () => (/* reexport safe */ _SpeechRecognitionResult__WEBPACK_IMPORTED_MODULE_13__.SpeechRecognitionResult),
/* harmony export */   "SpeechRecognizer": () => (/* reexport safe */ _SpeechRecognizer__WEBPACK_IMPORTED_MODULE_28__.SpeechRecognizer),
/* harmony export */   "SpeechSynthesisBookmarkEventArgs": () => (/* reexport safe */ _SpeechSynthesisBookmarkEventArgs__WEBPACK_IMPORTED_MODULE_83__.SpeechSynthesisBookmarkEventArgs),
/* harmony export */   "SpeechSynthesisBoundaryType": () => (/* reexport safe */ _SpeechSynthesisBoundaryType__WEBPACK_IMPORTED_MODULE_85__.SpeechSynthesisBoundaryType),
/* harmony export */   "SpeechSynthesisEventArgs": () => (/* reexport safe */ _SpeechSynthesisEventArgs__WEBPACK_IMPORTED_MODULE_81__.SpeechSynthesisEventArgs),
/* harmony export */   "SpeechSynthesisOutputFormat": () => (/* reexport safe */ _SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_77__.SpeechSynthesisOutputFormat),
/* harmony export */   "SpeechSynthesisResult": () => (/* reexport safe */ _SpeechSynthesisResult__WEBPACK_IMPORTED_MODULE_80__.SpeechSynthesisResult),
/* harmony export */   "SpeechSynthesisVisemeEventArgs": () => (/* reexport safe */ _SpeechSynthesisVisemeEventArgs__WEBPACK_IMPORTED_MODULE_84__.SpeechSynthesisVisemeEventArgs),
/* harmony export */   "SpeechSynthesisWordBoundaryEventArgs": () => (/* reexport safe */ _SpeechSynthesisWordBoundaryEventArgs__WEBPACK_IMPORTED_MODULE_82__.SpeechSynthesisWordBoundaryEventArgs),
/* harmony export */   "SpeechSynthesizer": () => (/* reexport safe */ _SpeechSynthesizer__WEBPACK_IMPORTED_MODULE_78__.SpeechSynthesizer),
/* harmony export */   "SpeechTranslationConfig": () => (/* reexport safe */ _SpeechTranslationConfig__WEBPACK_IMPORTED_MODULE_24__.SpeechTranslationConfig),
/* harmony export */   "SpeechTranslationConfigImpl": () => (/* reexport safe */ _SpeechTranslationConfig__WEBPACK_IMPORTED_MODULE_24__.SpeechTranslationConfigImpl),
/* harmony export */   "SynthesisResult": () => (/* reexport safe */ _SynthesisResult__WEBPACK_IMPORTED_MODULE_79__.SynthesisResult),
/* harmony export */   "SynthesisVoicesResult": () => (/* reexport safe */ _SynthesisVoicesResult__WEBPACK_IMPORTED_MODULE_86__.SynthesisVoicesResult),
/* harmony export */   "TranslationRecognitionCanceledEventArgs": () => (/* reexport safe */ _TranslationRecognitionCanceledEventArgs__WEBPACK_IMPORTED_MODULE_35__.TranslationRecognitionCanceledEventArgs),
/* harmony export */   "TranslationRecognitionEventArgs": () => (/* reexport safe */ _TranslationRecognitionEventArgs__WEBPACK_IMPORTED_MODULE_18__.TranslationRecognitionEventArgs),
/* harmony export */   "TranslationRecognitionResult": () => (/* reexport safe */ _TranslationRecognitionResult__WEBPACK_IMPORTED_MODULE_20__.TranslationRecognitionResult),
/* harmony export */   "TranslationRecognizer": () => (/* reexport safe */ _TranslationRecognizer__WEBPACK_IMPORTED_MODULE_31__.TranslationRecognizer),
/* harmony export */   "TranslationSynthesisEventArgs": () => (/* reexport safe */ _TranslationSynthesisEventArgs__WEBPACK_IMPORTED_MODULE_19__.TranslationSynthesisEventArgs),
/* harmony export */   "TranslationSynthesisResult": () => (/* reexport safe */ _TranslationSynthesisResult__WEBPACK_IMPORTED_MODULE_21__.TranslationSynthesisResult),
/* harmony export */   "Translations": () => (/* reexport safe */ _Translations__WEBPACK_IMPORTED_MODULE_32__.Translations),
/* harmony export */   "TurnStatusReceivedEventArgs": () => (/* reexport safe */ _TurnStatusReceivedEventArgs__WEBPACK_IMPORTED_MODULE_49__.TurnStatusReceivedEventArgs),
/* harmony export */   "User": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_75__.User),
/* harmony export */   "VoiceInfo": () => (/* reexport safe */ _VoiceInfo__WEBPACK_IMPORTED_MODULE_87__.VoiceInfo),
/* harmony export */   "VoiceProfile": () => (/* reexport safe */ _VoiceProfile__WEBPACK_IMPORTED_MODULE_55__.VoiceProfile),
/* harmony export */   "VoiceProfileCancellationDetails": () => (/* reexport safe */ _VoiceProfileResult__WEBPACK_IMPORTED_MODULE_57__.VoiceProfileCancellationDetails),
/* harmony export */   "VoiceProfileClient": () => (/* reexport safe */ _VoiceProfileClient__WEBPACK_IMPORTED_MODULE_59__.VoiceProfileClient),
/* harmony export */   "VoiceProfileEnrollmentCancellationDetails": () => (/* reexport safe */ _VoiceProfileEnrollmentResult__WEBPACK_IMPORTED_MODULE_56__.VoiceProfileEnrollmentCancellationDetails),
/* harmony export */   "VoiceProfileEnrollmentResult": () => (/* reexport safe */ _VoiceProfileEnrollmentResult__WEBPACK_IMPORTED_MODULE_56__.VoiceProfileEnrollmentResult),
/* harmony export */   "VoiceProfilePhraseResult": () => (/* reexport safe */ _VoiceProfilePhraseResult__WEBPACK_IMPORTED_MODULE_58__.VoiceProfilePhraseResult),
/* harmony export */   "VoiceProfileResult": () => (/* reexport safe */ _VoiceProfileResult__WEBPACK_IMPORTED_MODULE_57__.VoiceProfileResult),
/* harmony export */   "VoiceProfileType": () => (/* reexport safe */ _VoiceProfileType__WEBPACK_IMPORTED_MODULE_30__.VoiceProfileType)
/* harmony export */ });
/* harmony import */ var _Audio_AudioConfig__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Audio/AudioConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioConfig.js");
/* harmony import */ var _Audio_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Audio/AudioStreamFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioStreamFormat.js");
/* harmony import */ var _Audio_AudioInputStream__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Audio/AudioInputStream */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioInputStream.js");
/* harmony import */ var _Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Audio/AudioOutputStream */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputStream.js");
/* harmony import */ var _CancellationReason__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./CancellationReason */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _Audio_PullAudioInputStreamCallback__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Audio/PullAudioInputStreamCallback */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/PullAudioInputStreamCallback.js");
/* harmony import */ var _Audio_PushAudioOutputStreamCallback__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Audio/PushAudioOutputStreamCallback */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/PushAudioOutputStreamCallback.js");
/* harmony import */ var _KeywordRecognitionModel__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./KeywordRecognitionModel */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/KeywordRecognitionModel.js");
/* harmony import */ var _SessionEventArgs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./SessionEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
/* harmony import */ var _RecognitionEventArgs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./RecognitionEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js");
/* harmony import */ var _OutputFormat__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./OutputFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js");
/* harmony import */ var _IntentRecognitionEventArgs__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./IntentRecognitionEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionEventArgs.js");
/* harmony import */ var _RecognitionResult__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./RecognitionResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionResult.js");
/* harmony import */ var _SpeechRecognitionResult__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./SpeechRecognitionResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionResult.js");
/* harmony import */ var _IntentRecognitionResult__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./IntentRecognitionResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionResult.js");
/* harmony import */ var _LanguageUnderstandingModel__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./LanguageUnderstandingModel */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/LanguageUnderstandingModel.js");
/* harmony import */ var _SpeechRecognitionEventArgs__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./SpeechRecognitionEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionEventArgs.js");
/* harmony import */ var _SpeechRecognitionCanceledEventArgs__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./SpeechRecognitionCanceledEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionCanceledEventArgs.js");
/* harmony import */ var _TranslationRecognitionEventArgs__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./TranslationRecognitionEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionEventArgs.js");
/* harmony import */ var _TranslationSynthesisEventArgs__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./TranslationSynthesisEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationSynthesisEventArgs.js");
/* harmony import */ var _TranslationRecognitionResult__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./TranslationRecognitionResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionResult.js");
/* harmony import */ var _TranslationSynthesisResult__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./TranslationSynthesisResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationSynthesisResult.js");
/* harmony import */ var _ResultReason__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./ResultReason */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _SpeechConfig__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./SpeechConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechConfig.js");
/* harmony import */ var _SpeechTranslationConfig__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./SpeechTranslationConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechTranslationConfig.js");
/* harmony import */ var _PropertyCollection__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./PropertyCollection */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _PropertyId__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./PropertyId */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Recognizer__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./Recognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js");
/* harmony import */ var _SpeechRecognizer__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./SpeechRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognizer.js");
/* harmony import */ var _IntentRecognizer__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./IntentRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognizer.js");
/* harmony import */ var _VoiceProfileType__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./VoiceProfileType */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileType.js");
/* harmony import */ var _TranslationRecognizer__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./TranslationRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognizer.js");
/* harmony import */ var _Translations__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./Translations */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Translations.js");
/* harmony import */ var _NoMatchReason__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./NoMatchReason */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/NoMatchReason.js");
/* harmony import */ var _NoMatchDetails__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./NoMatchDetails */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/NoMatchDetails.js");
/* harmony import */ var _TranslationRecognitionCanceledEventArgs__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./TranslationRecognitionCanceledEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionCanceledEventArgs.js");
/* harmony import */ var _IntentRecognitionCanceledEventArgs__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ./IntentRecognitionCanceledEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionCanceledEventArgs.js");
/* harmony import */ var _CancellationDetailsBase__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ./CancellationDetailsBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetailsBase.js");
/* harmony import */ var _CancellationDetails__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ./CancellationDetails */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetails.js");
/* harmony import */ var _CancellationErrorCodes__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ./CancellationErrorCodes */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _ConnectionEventArgs__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ./ConnectionEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionEventArgs.js");
/* harmony import */ var _ServiceEventArgs__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! ./ServiceEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ServiceEventArgs.js");
/* harmony import */ var _Connection__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! ./Connection */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Connection.js");
/* harmony import */ var _PhraseListGrammar__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! ./PhraseListGrammar */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PhraseListGrammar.js");
/* harmony import */ var _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! ./DialogServiceConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConfig.js");
/* harmony import */ var _BotFrameworkConfig__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(/*! ./BotFrameworkConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/BotFrameworkConfig.js");
/* harmony import */ var _CustomCommandsConfig__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(/*! ./CustomCommandsConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CustomCommandsConfig.js");
/* harmony import */ var _DialogServiceConnector__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(/*! ./DialogServiceConnector */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConnector.js");
/* harmony import */ var _ActivityReceivedEventArgs__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(/*! ./ActivityReceivedEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ActivityReceivedEventArgs.js");
/* harmony import */ var _TurnStatusReceivedEventArgs__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(/*! ./TurnStatusReceivedEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TurnStatusReceivedEventArgs.js");
/* harmony import */ var _ServicePropertyChannel__WEBPACK_IMPORTED_MODULE_50__ = __webpack_require__(/*! ./ServicePropertyChannel */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ServicePropertyChannel.js");
/* harmony import */ var _ProfanityOption__WEBPACK_IMPORTED_MODULE_51__ = __webpack_require__(/*! ./ProfanityOption */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ProfanityOption.js");
/* harmony import */ var _Audio_BaseAudioPlayer__WEBPACK_IMPORTED_MODULE_52__ = __webpack_require__(/*! ./Audio/BaseAudioPlayer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/BaseAudioPlayer.js");
/* harmony import */ var _ConnectionMessageEventArgs__WEBPACK_IMPORTED_MODULE_53__ = __webpack_require__(/*! ./ConnectionMessageEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionMessageEventArgs.js");
/* harmony import */ var _ConnectionMessage__WEBPACK_IMPORTED_MODULE_54__ = __webpack_require__(/*! ./ConnectionMessage */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionMessage.js");
/* harmony import */ var _VoiceProfile__WEBPACK_IMPORTED_MODULE_55__ = __webpack_require__(/*! ./VoiceProfile */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfile.js");
/* harmony import */ var _VoiceProfileEnrollmentResult__WEBPACK_IMPORTED_MODULE_56__ = __webpack_require__(/*! ./VoiceProfileEnrollmentResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileEnrollmentResult.js");
/* harmony import */ var _VoiceProfileResult__WEBPACK_IMPORTED_MODULE_57__ = __webpack_require__(/*! ./VoiceProfileResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileResult.js");
/* harmony import */ var _VoiceProfilePhraseResult__WEBPACK_IMPORTED_MODULE_58__ = __webpack_require__(/*! ./VoiceProfilePhraseResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfilePhraseResult.js");
/* harmony import */ var _VoiceProfileClient__WEBPACK_IMPORTED_MODULE_59__ = __webpack_require__(/*! ./VoiceProfileClient */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileClient.js");
/* harmony import */ var _SpeakerRecognizer__WEBPACK_IMPORTED_MODULE_60__ = __webpack_require__(/*! ./SpeakerRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerRecognizer.js");
/* harmony import */ var _SpeakerIdentificationModel__WEBPACK_IMPORTED_MODULE_61__ = __webpack_require__(/*! ./SpeakerIdentificationModel */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerIdentificationModel.js");
/* harmony import */ var _SpeakerVerificationModel__WEBPACK_IMPORTED_MODULE_62__ = __webpack_require__(/*! ./SpeakerVerificationModel */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerVerificationModel.js");
/* harmony import */ var _AutoDetectSourceLanguageConfig__WEBPACK_IMPORTED_MODULE_63__ = __webpack_require__(/*! ./AutoDetectSourceLanguageConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/AutoDetectSourceLanguageConfig.js");
/* harmony import */ var _AutoDetectSourceLanguageResult__WEBPACK_IMPORTED_MODULE_64__ = __webpack_require__(/*! ./AutoDetectSourceLanguageResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/AutoDetectSourceLanguageResult.js");
/* harmony import */ var _SourceLanguageConfig__WEBPACK_IMPORTED_MODULE_65__ = __webpack_require__(/*! ./SourceLanguageConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SourceLanguageConfig.js");
/* harmony import */ var _SpeakerRecognitionResult__WEBPACK_IMPORTED_MODULE_66__ = __webpack_require__(/*! ./SpeakerRecognitionResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerRecognitionResult.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_67__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/Conversation.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_68__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationExpirationEventArgs.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_69__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationParticipantsChangedEventArgs.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_70__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationCanceledEventArgs.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_71__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationEventArgs.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_72__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationResult.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_73__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslator.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_74__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranscriber.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_75__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/IParticipant.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_76__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ParticipantChangedReason.js");
/* harmony import */ var _SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_77__ = __webpack_require__(/*! ./SpeechSynthesisOutputFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisOutputFormat.js");
/* harmony import */ var _SpeechSynthesizer__WEBPACK_IMPORTED_MODULE_78__ = __webpack_require__(/*! ./SpeechSynthesizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesizer.js");
/* harmony import */ var _SynthesisResult__WEBPACK_IMPORTED_MODULE_79__ = __webpack_require__(/*! ./SynthesisResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SynthesisResult.js");
/* harmony import */ var _SpeechSynthesisResult__WEBPACK_IMPORTED_MODULE_80__ = __webpack_require__(/*! ./SpeechSynthesisResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisResult.js");
/* harmony import */ var _SpeechSynthesisEventArgs__WEBPACK_IMPORTED_MODULE_81__ = __webpack_require__(/*! ./SpeechSynthesisEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisEventArgs.js");
/* harmony import */ var _SpeechSynthesisWordBoundaryEventArgs__WEBPACK_IMPORTED_MODULE_82__ = __webpack_require__(/*! ./SpeechSynthesisWordBoundaryEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisWordBoundaryEventArgs.js");
/* harmony import */ var _SpeechSynthesisBookmarkEventArgs__WEBPACK_IMPORTED_MODULE_83__ = __webpack_require__(/*! ./SpeechSynthesisBookmarkEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisBookmarkEventArgs.js");
/* harmony import */ var _SpeechSynthesisVisemeEventArgs__WEBPACK_IMPORTED_MODULE_84__ = __webpack_require__(/*! ./SpeechSynthesisVisemeEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisVisemeEventArgs.js");
/* harmony import */ var _SpeechSynthesisBoundaryType__WEBPACK_IMPORTED_MODULE_85__ = __webpack_require__(/*! ./SpeechSynthesisBoundaryType */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisBoundaryType.js");
/* harmony import */ var _SynthesisVoicesResult__WEBPACK_IMPORTED_MODULE_86__ = __webpack_require__(/*! ./SynthesisVoicesResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SynthesisVoicesResult.js");
/* harmony import */ var _VoiceInfo__WEBPACK_IMPORTED_MODULE_87__ = __webpack_require__(/*! ./VoiceInfo */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceInfo.js");
/* harmony import */ var _Audio_SpeakerAudioDestination__WEBPACK_IMPORTED_MODULE_88__ = __webpack_require__(/*! ./Audio/SpeakerAudioDestination */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/SpeakerAudioDestination.js");
/* harmony import */ var _ConversationTranscriptionCanceledEventArgs__WEBPACK_IMPORTED_MODULE_89__ = __webpack_require__(/*! ./ConversationTranscriptionCanceledEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConversationTranscriptionCanceledEventArgs.js");
/* harmony import */ var _PronunciationAssessmentGradingSystem__WEBPACK_IMPORTED_MODULE_90__ = __webpack_require__(/*! ./PronunciationAssessmentGradingSystem */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentGradingSystem.js");
/* harmony import */ var _PronunciationAssessmentGranularity__WEBPACK_IMPORTED_MODULE_91__ = __webpack_require__(/*! ./PronunciationAssessmentGranularity */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentGranularity.js");
/* harmony import */ var _PronunciationAssessmentConfig__WEBPACK_IMPORTED_MODULE_92__ = __webpack_require__(/*! ./PronunciationAssessmentConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentConfig.js");
/* harmony import */ var _PronunciationAssessmentResult__WEBPACK_IMPORTED_MODULE_93__ = __webpack_require__(/*! ./PronunciationAssessmentResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentResult.js");
/* harmony import */ var _LanguageIdMode__WEBPACK_IMPORTED_MODULE_94__ = __webpack_require__(/*! ./LanguageIdMode */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/LanguageIdMode.js");
/* harmony import */ var _Diagnostics__WEBPACK_IMPORTED_MODULE_95__ = __webpack_require__(/*! ./Diagnostics */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Diagnostics.js");
/* harmony import */ var _LogLevel__WEBPACK_IMPORTED_MODULE_96__ = __webpack_require__(/*! ./LogLevel */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

























































































//# sourceMappingURL=Exports.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionCanceledEventArgs.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionCanceledEventArgs.js ***!
  \**************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IntentRecognitionCanceledEventArgs": () => (/* binding */ IntentRecognitionCanceledEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Define payload of intent recognition canceled result events.
 * @class IntentRecognitionCanceledEventArgs
 */
class IntentRecognitionCanceledEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.IntentRecognitionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {CancellationReason} result - The result of the intent recognition.
     * @param {string} offset - The offset.
     * @param {IntentRecognitionResult} sessionId - The session id.
     */
    constructor(reason, errorDetails, errorCode, result, offset, sessionId) {
        super(result, offset, sessionId);
        this.privReason = reason;
        this.privErrorDetails = errorDetails;
        this.privErrorCode = errorCode;
    }
    /**
     * The reason the recognition was canceled.
     * @member IntentRecognitionCanceledEventArgs.prototype.reason
     * @function
     * @public
     * @returns {CancellationReason} Specifies the reason canceled.
     */
    get reason() {
        return this.privReason;
    }
    /**
     * The error code in case of an unsuccessful recognition.
     * Added in version 1.1.0.
     * @return An error code that represents the error reason.
     */
    get errorCode() {
        return this.privErrorCode;
    }
    /**
     * In case of an unsuccessful recognition, provides details of the occurred error.
     * @member IntentRecognitionCanceledEventArgs.prototype.errorDetails
     * @function
     * @public
     * @returns {string} A String that represents the error details.
     */
    get errorDetails() {
        return this.privErrorDetails;
    }
}

//# sourceMappingURL=IntentRecognitionCanceledEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionEventArgs.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionEventArgs.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IntentRecognitionEventArgs": () => (/* binding */ IntentRecognitionEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Intent recognition result event arguments.
 * @class
 */
class IntentRecognitionEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.RecognitionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param result - The result of the intent recognition.
     * @param offset - The offset.
     * @param sessionId - The session id.
     */
    constructor(result, offset, sessionId) {
        super(offset, sessionId);
        this.privResult = result;
    }
    /**
     * Represents the intent recognition result.
     * @member IntentRecognitionEventArgs.prototype.result
     * @function
     * @public
     * @returns {IntentRecognitionResult} Represents the intent recognition result.
     */
    get result() {
        return this.privResult;
    }
}

//# sourceMappingURL=IntentRecognitionEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionResult.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionResult.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IntentRecognitionResult": () => (/* binding */ IntentRecognitionResult)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionResult.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Intent recognition result.
 * @class
 */
class IntentRecognitionResult extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SpeechRecognitionResult {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param intentId - The intent id.
     * @param resultId - The result id.
     * @param reason - The reason.
     * @param text - The recognized text.
     * @param duration - The duration.
     * @param offset - The offset into the stream.
     * @param language - Primary Language detected, if provided.
     * @param languageDetectionConfidence - Primary Language confidence ("Unknown," "Low," "Medium," "High"...), if provided.
     * @param errorDetails - Error details, if provided.
     * @param json - Additional Json, if provided.
     * @param properties - Additional properties, if provided.
     */
    constructor(intentId, resultId, reason, text, duration, offset, language, languageDetectionConfidence, errorDetails, json, properties) {
        super(resultId, reason, text, duration, offset, language, languageDetectionConfidence, undefined, errorDetails, json, properties);
        this.privIntentId = intentId;
    }
    /**
     * A String that represents the intent identifier being recognized.
     * @member IntentRecognitionResult.prototype.intentId
     * @function
     * @public
     * @returns {string} A String that represents the intent identifier being recognized.
     */
    get intentId() {
        return this.privIntentId;
    }
}

//# sourceMappingURL=IntentRecognitionResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognizer.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognizer.js ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IntentRecognizer": () => (/* binding */ IntentRecognizer)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IntentConnectionFactory.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/AddedLmIntent.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IntentServiceRecognizer.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




/**
 * Intent recognizer.
 * @class
 */
class IntentRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.Recognizer {
    /**
     * Initializes an instance of the IntentRecognizer.
     * @constructor
     * @param {SpeechConfig} speechConfig - The set of configuration properties.
     * @param {AudioConfig} audioConfig - An optional audio input config associated with the recognizer
     */
    constructor(speechConfig, audioConfig) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(speechConfig, "speechConfig");
        const configImpl = speechConfig;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(configImpl, "speechConfig");
        super(audioConfig, configImpl.properties, new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.IntentConnectionFactory());
        this.privAddedIntents = [];
        this.privAddedLmIntents = {};
        this.privDisposedIntentRecognizer = false;
        this.privProperties = configImpl.properties;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_RecoLanguage), _Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_RecoLanguage]);
    }
    /**
     * Gets the spoken language of recognition.
     * @member IntentRecognizer.prototype.speechRecognitionLanguage
     * @function
     * @public
     * @returns {string} the spoken language of recognition.
     */
    get speechRecognitionLanguage() {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer);
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_RecoLanguage);
    }
    /**
     * Gets the authorization token used to communicate with the service.
     * @member IntentRecognizer.prototype.authorizationToken
     * @function
     * @public
     * @returns {string} Authorization token.
     */
    get authorizationToken() {
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceAuthorization_Token);
    }
    /**
     * Gets/Sets the authorization token used to communicate with the service.
     * Note: Please use a token derived from your LanguageUnderstanding subscription key for the Intent recognizer.
     * @member IntentRecognizer.prototype.authorizationToken
     * @function
     * @public
     * @param {string} value - Authorization token.
     */
    set authorizationToken(value) {
        this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceAuthorization_Token, value);
    }
    /**
     * The collection of properties and their values defined for this IntentRecognizer.
     * @member IntentRecognizer.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The collection of properties and their
     * values defined for this IntentRecognizer.
     */
    get properties() {
        return this.privProperties;
    }
    /**
     * Starts intent recognition, and stops after the first utterance is recognized.
     * The task returns the recognition text and intent as result.
     * Note: RecognizeOnceAsync() returns when the first utterance has been recognized,
     * so it is suitable only for single shot recognition like command or query.
     * For long-running recognition, use StartContinuousRecognitionAsync() instead.
     * @member IntentRecognizer.prototype.recognizeOnceAsync
     * @function
     * @public
     * @param cb - Callback that received the recognition has finished with an IntentRecognitionResult.
     * @param err - Callback invoked in case of an error.
     */
    recognizeOnceAsync(cb, err) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer);
        if (Object.keys(this.privAddedLmIntents).length !== 0 || undefined !== this.privUmbrellaIntent) {
            const context = this.buildSpeechContext();
            this.privReco.speechContext.setSection("intent", context.Intent);
            this.privReco.dynamicGrammar.addReferenceGrammar(context.ReferenceGrammars);
            const intentReco = this.privReco;
            intentReco.setIntents(this.privAddedLmIntents, this.privUmbrellaIntent);
        }
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.RecognitionMode.Interactive), cb, err);
    }
    /**
     * Starts speech recognition, until stopContinuousRecognitionAsync() is called.
     * User must subscribe to events to receive recognition results.
     * @member IntentRecognizer.prototype.startContinuousRecognitionAsync
     * @function
     * @public
     * @param cb - Callback invoked once the recognition has started.
     * @param err - Callback invoked in case of an error.
     */
    startContinuousRecognitionAsync(cb, err) {
        if (Object.keys(this.privAddedLmIntents).length !== 0 || undefined !== this.privUmbrellaIntent) {
            const context = this.buildSpeechContext();
            this.privReco.speechContext.setSection("intent", context.Intent);
            this.privReco.dynamicGrammar.addReferenceGrammar(context.ReferenceGrammars);
            const intentReco = this.privReco;
            intentReco.setIntents(this.privAddedLmIntents, this.privUmbrellaIntent);
        }
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.RecognitionMode.Conversation), cb, err);
    }
    /**
     * Stops continuous intent recognition.
     * @member IntentRecognizer.prototype.stopContinuousRecognitionAsync
     * @function
     * @public
     * @param cb - Callback invoked once the recognition has stopped.
     * @param err - Callback invoked in case of an error.
     */
    stopContinuousRecognitionAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(), cb, err);
    }
    /**
     * Starts speech recognition with keyword spotting, until stopKeywordRecognitionAsync() is called.
     * User must subscribe to events to receive recognition results.
     * Note: Key word spotting functionality is only available on the Speech Devices SDK.
     * This functionality is currently not included in the SDK itself.
     * @member IntentRecognizer.prototype.startKeywordRecognitionAsync
     * @function
     * @public
     * @param {KeywordRecognitionModel} model - The keyword recognition model that specifies the keyword to be recognized.
     * @param cb - Callback invoked once the recognition has started.
     * @param err - Callback invoked in case of an error.
     */
    startKeywordRecognitionAsync(model, cb, err) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(model, "model");
        if (!!err) {
            err("Not yet implemented.");
        }
    }
    /**
     * Stops continuous speech recognition.
     * Note: Key word spotting functionality is only available on the Speech Devices SDK.
     * This functionality is currently not included in the SDK itself.
     * @member IntentRecognizer.prototype.stopKeywordRecognitionAsync
     * @function
     * @public
     * @param cb - Callback invoked once the recognition has stopped.
     * @param err - Callback invoked in case of an error.
     */
    stopKeywordRecognitionAsync(cb, err) {
        if (!!cb) {
            try {
                cb();
            }
            catch (e) {
                if (!!err) {
                    err(e);
                }
            }
        }
    }
    /**
     * Adds a phrase that should be recognized as intent.
     * @member IntentRecognizer.prototype.addIntent
     * @function
     * @public
     * @param {string} intentId - A String that represents the identifier of the intent to be recognized.
     * @param {string} phrase - A String that specifies the phrase representing the intent.
     */
    addIntent(simplePhrase, intentId) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer);
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(intentId, "intentId");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(simplePhrase, "simplePhrase");
        this.privAddedIntents.push([intentId, simplePhrase]);
    }
    /**
     * Adds an intent from Language Understanding service for recognition.
     * @member IntentRecognizer.prototype.addIntentWithLanguageModel
     * @function
     * @public
     * @param {string} intentId - A String that represents the identifier of the intent
     * to be recognized. Ignored if intentName is empty.
     * @param {string} model - The intent model from Language Understanding service.
     * @param {string} intentName - The intent name defined in the intent model. If it
     * is empty, all intent names defined in the model will be added.
     */
    addIntentWithLanguageModel(intentId, model, intentName) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer);
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(intentId, "intentId");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(model, "model");
        const modelImpl = model;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(modelImpl.appId, "model.appId");
        this.privAddedLmIntents[intentId] = new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__.AddedLmIntent(modelImpl, intentName);
    }
    /**
     * @summary Adds all intents from the specified Language Understanding Model.
     * @member IntentRecognizer.prototype.addAllIntents
     * @function
     * @public
     * @function
     * @public
     * @param {LanguageUnderstandingModel} model - The language understanding model containing the intents.
     * @param {string} intentId - A custom id String to be returned in the IntentRecognitionResult's getIntentId() method.
     */
    addAllIntents(model, intentId) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(model, "model");
        const modelImpl = model;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(modelImpl.appId, "model.appId");
        this.privUmbrellaIntent = new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__.AddedLmIntent(modelImpl, intentId);
    }
    /**
     * closes all external resources held by an instance of this class.
     * @member IntentRecognizer.prototype.close
     * @function
     * @public
     */
    close(cb, errorCb) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer);
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.dispose(true), cb, errorCb);
    }
    createRecognizerConfig(speechConfig) {
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.RecognizerConfig(speechConfig, this.privProperties);
    }
    createServiceRecognizer(authentication, connectionFactory, audioConfig, recognizerConfig) {
        const audioImpl = audioConfig;
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__.IntentServiceRecognizer(authentication, connectionFactory, audioImpl, recognizerConfig, this);
    }
    dispose(disposing) {
        const _super = Object.create(null, {
            dispose: { get: () => super.dispose }
        });
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privDisposedIntentRecognizer) {
                return;
            }
            if (disposing) {
                this.privDisposedIntentRecognizer = true;
                yield _super.dispose.call(this, disposing);
            }
        });
    }
    buildSpeechContext() {
        let appId;
        let region;
        let subscriptionKey;
        const refGrammers = [];
        if (undefined !== this.privUmbrellaIntent) {
            appId = this.privUmbrellaIntent.modelImpl.appId;
            region = this.privUmbrellaIntent.modelImpl.region;
            subscriptionKey = this.privUmbrellaIntent.modelImpl.subscriptionKey;
        }
        // Build the reference grammer array.
        for (const intentId of Object.keys(this.privAddedLmIntents)) {
            const addedLmIntent = this.privAddedLmIntents[intentId];
            // validate all the same model, region, and key...
            if (appId === undefined) {
                appId = addedLmIntent.modelImpl.appId;
            }
            else {
                if (appId !== addedLmIntent.modelImpl.appId) {
                    throw new Error("Intents must all be from the same LUIS model");
                }
            }
            if (region === undefined) {
                region = addedLmIntent.modelImpl.region;
            }
            else {
                if (region !== addedLmIntent.modelImpl.region) {
                    throw new Error("Intents must all be from the same LUIS model in a single region");
                }
            }
            if (subscriptionKey === undefined) {
                subscriptionKey = addedLmIntent.modelImpl.subscriptionKey;
            }
            else {
                if (subscriptionKey !== addedLmIntent.modelImpl.subscriptionKey) {
                    throw new Error("Intents must all use the same subscription key");
                }
            }
            const grammer = "luis/" + appId + "-PRODUCTION#" + intentId;
            refGrammers.push(grammer);
        }
        return {
            Intent: {
                id: appId,
                key: (subscriptionKey === undefined) ? this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_Key]) : subscriptionKey,
                provider: "LUIS",
            },
            ReferenceGrammars: (undefined === this.privUmbrellaIntent) ? refGrammers : ["luis/" + appId + "-PRODUCTION"],
        };
    }
}

//# sourceMappingURL=IntentRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/KeywordRecognitionModel.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/KeywordRecognitionModel.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "KeywordRecognitionModel": () => (/* binding */ KeywordRecognitionModel)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Represents a keyword recognition model for recognizing when
 * the user says a keyword to initiate further speech recognition.
 * @class KeywordRecognitionModel
 */
class KeywordRecognitionModel {
    /**
     * Create and initializes a new instance.
     * @constructor
     */
    constructor() {
        this.privDisposed = false;
        return;
    }
    /**
     * Creates a keyword recognition model using the specified filename.
     * @member KeywordRecognitionModel.fromFile
     * @function
     * @public
     * @param {string} fileName - A string that represents file name for the keyword recognition model.
     * Note, the file can point to a zip file in which case the model
     * will be extracted from the zip.
     * @returns {KeywordRecognitionModel} The keyword recognition model being created.
     */
    static fromFile(fileName) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfFileDoesNotExist(fileName, "fileName");
        throw new Error("Not yet implemented.");
    }
    /**
     * Creates a keyword recognition model using the specified filename.
     * @member KeywordRecognitionModel.fromStream
     * @function
     * @public
     * @param {string} file - A File that represents file for the keyword recognition model.
     * Note, the file can point to a zip file in which case the model will be extracted from the zip.
     * @returns {KeywordRecognitionModel} The keyword recognition model being created.
     */
    static fromStream(file) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNull(file, "file");
        throw new Error("Not yet implemented.");
    }
    /**
     * Dispose of associated resources.
     * @member KeywordRecognitionModel.prototype.close
     * @function
     * @public
     */
    close() {
        if (this.privDisposed) {
            return;
        }
        this.privDisposed = true;
    }
}

//# sourceMappingURL=KeywordRecognitionModel.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/LanguageIdMode.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/LanguageIdMode.js ***!
  \******************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "LanguageIdMode": () => (/* binding */ LanguageIdMode)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Language Identification mode
 * @class LanguageIdMode
 */
var LanguageIdMode;
(function (LanguageIdMode) {
    /**
     * Detect language at audio start
     * @member LanguageIdMode.AtStart
     */
    LanguageIdMode[LanguageIdMode["AtStart"] = 0] = "AtStart";
    /**
     * Continuously detect language
     * @member LanguageIdMode.Continuous
     */
    LanguageIdMode[LanguageIdMode["Continuous"] = 1] = "Continuous";
})(LanguageIdMode || (LanguageIdMode = {}));

//# sourceMappingURL=LanguageIdMode.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/LanguageUnderstandingModel.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/LanguageUnderstandingModel.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "LanguageUnderstandingModel": () => (/* binding */ LanguageUnderstandingModel),
/* harmony export */   "LanguageUnderstandingModelImpl": () => (/* binding */ LanguageUnderstandingModelImpl)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// eslint-disable-next-line max-classes-per-file

/**
 * Language understanding model
 * @class LanguageUnderstandingModel
 */
class LanguageUnderstandingModel {
    /**
     * Creates and initializes a new instance
     * @constructor
     */
    constructor() {
        return;
    }
    /**
     * Creates an language understanding model using the specified endpoint.
     * @member LanguageUnderstandingModel.fromEndpoint
     * @function
     * @public
     * @param {URL} uri - A String that represents the endpoint of the language understanding model.
     * @returns {LanguageUnderstandingModel} The language understanding model being created.
     */
    static fromEndpoint(uri) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNull(uri, "uri");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(uri.hostname, "uri");
        const langModelImp = new LanguageUnderstandingModelImpl();
        // Need to extract the app ID from the URL.
        // URL is in the format: https://<region>.api.cognitive.microsoft.com/luis/v2.0/apps/<Guid>?subscription-key=<key>&timezoneOffset=-360
        // Start tearing the string apart.
        // region can be extracted from the host name.
        const firstDot = uri.host.indexOf(".");
        if (-1 === firstDot) {
            throw new Error("Could not determine region from endpoint");
        }
        langModelImp.region = uri.host.substr(0, firstDot);
        // Now the app ID.
        const lastSegment = uri.pathname.lastIndexOf("/") + 1;
        if (-1 === lastSegment) {
            throw new Error("Could not determine appId from endpoint");
        }
        langModelImp.appId = uri.pathname.substr(lastSegment);
        // And finally the key.
        langModelImp.subscriptionKey = uri.searchParams.get("subscription-key");
        if (undefined === langModelImp.subscriptionKey) {
            throw new Error("Could not determine subscription key from endpoint");
        }
        return langModelImp;
    }
    /**
     * Creates an language understanding model using the application id of Language Understanding service.
     * @member LanguageUnderstandingModel.fromAppId
     * @function
     * @public
     * @param {string} appId - A String that represents the application id of Language Understanding service.
     * @returns {LanguageUnderstandingModel} The language understanding model being created.
     */
    static fromAppId(appId) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(appId, "appId");
        const langModelImp = new LanguageUnderstandingModelImpl();
        langModelImp.appId = appId;
        return langModelImp;
    }
    /**
     * Creates a language understanding model using hostname, subscription key and application
     * id of Language Understanding service.
     * @member LanguageUnderstandingModel.fromSubscription
     * @function
     * @public
     * @param {string} subscriptionKey - A String that represents the subscription key of
     * Language Understanding service.
     * @param {string} appId - A String that represents the application id of Language
     * Understanding service.
     * @param {LanguageUnderstandingModel} region - A String that represents the region
     * of the Language Understanding service (see the <a href="https://aka.ms/csspeech/region">region page</a>).
     * @returns {LanguageUnderstandingModel} The language understanding model being created.
     */
    static fromSubscription(subscriptionKey, appId, region) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(subscriptionKey, "subscriptionKey");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(appId, "appId");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(region, "region");
        const langModelImp = new LanguageUnderstandingModelImpl();
        langModelImp.appId = appId;
        langModelImp.region = region;
        langModelImp.subscriptionKey = subscriptionKey;
        return langModelImp;
    }
}
/**
 * @private
 * @class LanguageUnderstandingModelImpl
 */
class LanguageUnderstandingModelImpl extends LanguageUnderstandingModel {
}

//# sourceMappingURL=LanguageUnderstandingModel.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/NoMatchDetails.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/NoMatchDetails.js ***!
  \******************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "NoMatchDetails": () => (/* binding */ NoMatchDetails)
/* harmony export */ });
/* harmony import */ var _src_common_speech_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../src/common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SimpleSpeechPhrase.js");
/* harmony import */ var _src_common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../src/common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/NoMatchReason.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


/**
 * Contains detailed information for NoMatch recognition results.
 * @class NoMatchDetails
 */
class NoMatchDetails {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {NoMatchReason} reason - The no-match reason.
     */
    constructor(reason) {
        this.privReason = reason;
    }
    /**
     * Creates an instance of NoMatchDetails object for the NoMatch SpeechRecognitionResults.
     * @member NoMatchDetails.fromResult
     * @function
     * @public
     * @param {SpeechRecognitionResult | IntentRecognitionResult | TranslationRecognitionResult}
     * result - The recognition result that was not recognized.
     * @returns {NoMatchDetails} The no match details object being created.
     */
    static fromResult(result) {
        const simpleSpeech = _src_common_speech_Exports__WEBPACK_IMPORTED_MODULE_0__.SimpleSpeechPhrase.fromJSON(result.json);
        let reason = _Exports__WEBPACK_IMPORTED_MODULE_1__.NoMatchReason.NotRecognized;
        switch (simpleSpeech.RecognitionStatus) {
            case _src_common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.RecognitionStatus.BabbleTimeout:
                reason = _Exports__WEBPACK_IMPORTED_MODULE_1__.NoMatchReason.InitialBabbleTimeout;
                break;
            case _src_common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.RecognitionStatus.InitialSilenceTimeout:
                reason = _Exports__WEBPACK_IMPORTED_MODULE_1__.NoMatchReason.InitialSilenceTimeout;
                break;
            default:
                reason = _Exports__WEBPACK_IMPORTED_MODULE_1__.NoMatchReason.NotRecognized;
                break;
        }
        return new NoMatchDetails(reason);
    }
    /**
     * The reason the recognition was canceled.
     * @member NoMatchDetails.prototype.reason
     * @function
     * @public
     * @returns {NoMatchReason} Specifies the reason canceled.
     */
    get reason() {
        return this.privReason;
    }
}

//# sourceMappingURL=NoMatchDetails.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/NoMatchReason.js":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/NoMatchReason.js ***!
  \*****************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "NoMatchReason": () => (/* binding */ NoMatchReason)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines the possible reasons a recognition result might not be recognized.
 * @class NoMatchReason
 */
var NoMatchReason;
(function (NoMatchReason) {
    /**
     * Indicates that speech was detected, but not recognized.
     * @member NoMatchReason.NotRecognized
     */
    NoMatchReason[NoMatchReason["NotRecognized"] = 0] = "NotRecognized";
    /**
     * Indicates that the start of the audio stream contained only silence,
     * and the service timed out waiting for speech.
     * @member NoMatchReason.InitialSilenceTimeout
     */
    NoMatchReason[NoMatchReason["InitialSilenceTimeout"] = 1] = "InitialSilenceTimeout";
    /**
     * Indicates that the start of the audio stream contained only noise,
     * and the service timed out waiting for speech.
     * @member NoMatchReason.InitialBabbleTimeout
     */
    NoMatchReason[NoMatchReason["InitialBabbleTimeout"] = 2] = "InitialBabbleTimeout";
})(NoMatchReason || (NoMatchReason = {}));

//# sourceMappingURL=NoMatchReason.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js ***!
  \****************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "OutputFormat": () => (/* binding */ OutputFormat)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Define Speech Recognizer output formats.
 * @class OutputFormat
 */
var OutputFormat;
(function (OutputFormat) {
    /**
     * @member OutputFormat.Simple
     */
    OutputFormat[OutputFormat["Simple"] = 0] = "Simple";
    /**
     * @member OutputFormat.Detailed
     */
    OutputFormat[OutputFormat["Detailed"] = 1] = "Detailed";
})(OutputFormat || (OutputFormat = {}));

//# sourceMappingURL=OutputFormat.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PhraseListGrammar.js":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PhraseListGrammar.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PhraseListGrammar": () => (/* binding */ PhraseListGrammar)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Allows additions of new phrases to improve speech recognition.
 *
 * Phrases added to the recognizer are effective at the start of the next recognition, or the next time the SpeechSDK must reconnect
 * to the speech service.
 */
class PhraseListGrammar {
    constructor(recogBase) {
        this.privGrammerBuilder = recogBase.dynamicGrammar;
    }
    /**
     * Creates a PhraseListGrammar from a given speech recognizer. Will accept any recognizer that derives from @class Recognizer.
     * @param recognizer The recognizer to add phrase lists to.
     */
    static fromRecognizer(recognizer) {
        const recoBase = recognizer.internalData;
        return new PhraseListGrammar(recoBase);
    }
    /**
     * Adds a single phrase to the current recognizer.
     * @param phrase Phrase to add.
     */
    addPhrase(phrase) {
        this.privGrammerBuilder.addPhrase(phrase);
    }
    /**
     * Adds multiple phrases to the current recognizer.
     * @param phrases Array of phrases to add.
     */
    addPhrases(phrases) {
        this.privGrammerBuilder.addPhrase(phrases);
    }
    /**
     * Clears all phrases added to the current recognizer.
     */
    clear() {
        this.privGrammerBuilder.clearPhrases();
    }
}

//# sourceMappingURL=PhraseListGrammar.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ProfanityOption.js":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ProfanityOption.js ***!
  \*******************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ProfanityOption": () => (/* binding */ ProfanityOption)
/* harmony export */ });
// Copyright (c) Microsoft Corporation.
// Licensed under the MIT license.
/**
 * Profanity option.
 * Added in version 1.7.0.
 */
var ProfanityOption;
(function (ProfanityOption) {
    ProfanityOption[ProfanityOption["Masked"] = 0] = "Masked";
    ProfanityOption[ProfanityOption["Removed"] = 1] = "Removed";
    ProfanityOption[ProfanityOption["Raw"] = 2] = "Raw";
})(ProfanityOption || (ProfanityOption = {}));

//# sourceMappingURL=ProfanityOption.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentConfig.js":
/*!*********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentConfig.js ***!
  \*********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PronunciationAssessmentConfig": () => (/* binding */ PronunciationAssessmentConfig)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentGradingSystem.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentGranularity.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


/**
 * Pronunciation assessment configuration.
 * @class PronunciationAssessmentConfig
 * Added in version 1.15.0.
 */
class PronunciationAssessmentConfig {
    /**
     * PronunciationAssessmentConfig constructor.
     * @constructor
     * @param {string} referenceText
     * @param gradingSystem
     * @param granularity
     * @param enableMiscue
     */
    constructor(referenceText, gradingSystem = _Exports__WEBPACK_IMPORTED_MODULE_0__.PronunciationAssessmentGradingSystem.FivePoint, granularity = _Exports__WEBPACK_IMPORTED_MODULE_1__.PronunciationAssessmentGranularity.Phoneme, enableMiscue = false) {
        _Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrUndefined(referenceText, "referenceText");
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyCollection();
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_ReferenceText, referenceText);
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_GradingSystem, _Exports__WEBPACK_IMPORTED_MODULE_0__.PronunciationAssessmentGradingSystem[gradingSystem]);
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_Granularity, _Exports__WEBPACK_IMPORTED_MODULE_1__.PronunciationAssessmentGranularity[granularity]);
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_EnableMiscue, String(enableMiscue));
    }
    /**
     * @member PronunciationAssessmentConfig.fromJSON
     * @function
     * @public
     * @param {string} json The json string containing the pronunciation assessment parameters.
     * @return {PronunciationAssessmentConfig} Instance of PronunciationAssessmentConfig
     * @summary Creates an instance of the PronunciationAssessmentConfig from json.
     */
    static fromJSON(json) {
        _Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrUndefined(json, "json");
        const config = new PronunciationAssessmentConfig("");
        config.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyCollection();
        config.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_Json, json);
        return config;
    }
    toJSON() {
        this.updateJson();
        return this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_Params);
    }
    applyTo(recognizer) {
        this.updateJson();
        const recoBase = recognizer.internalData;
        recoBase.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_Params));
    }
    /**
     * Gets the reference text.
     * @member PronunciationAssessmentConfig.prototype.referenceText
     * @function
     * @public
     * @returns {string} Reference text.
     */
    get referenceText() {
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_ReferenceText);
    }
    /**
     * Gets/Sets the reference text.
     * @member PronunciationAssessmentConfig.prototype.referenceText
     * @function
     * @public
     * @param {string} referenceText - Reference text.
     */
    set referenceText(referenceText) {
        _Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrWhitespace(referenceText, "referenceText");
        this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_ReferenceText, referenceText);
    }
    /**
     * Sets the phoneme alphabet.
     * The valid values are "SAPI" (default) and "IPA".
     * Added in version 1.20.0
     * @member PronunciationAssessmentConfig.prototype.phonemeAlphabet
     * @function
     * @public
     * @param {string} phonemeAlphabet - Phoneme alphabet.
     */
    set phonemeAlphabet(phonemeAlphabet) {
        _Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrWhitespace(phonemeAlphabet, "phonemeAlphabet");
        this.privPhonemeAlphabet = phonemeAlphabet;
    }
    /**
     * Sets the boolean enableMiscue property.
     * Added in version 1.26.0
     * @member PronunciationAssessmentConfig.prototype.enableMiscue
     * @function
     * @public
     * @param {boolean} enableMiscue - enable miscue.
     */
    set enableMiscue(enableMiscue) {
        const enableMiscueString = enableMiscue ? "true" : "false";
        this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_EnableMiscue, enableMiscueString);
    }
    /**
     * Gets the boolean enableMiscue property.
     * Added in version 1.26.0
     * @member PronunciationAssessmentConfig.prototype.enableMiscue
     * @function
     * @public
     * @return {boolean} enableMiscue - enable miscue.
     */
    get enableMiscue() {
        const enableMiscueString = this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_EnableMiscue, "false");
        return (enableMiscueString.toLowerCase() === "true");
    }
    /**
     * Sets the nbest phoneme count
     * Added in version 1.20.0
     * @member PronunciationAssessmentConfig.prototype.nbestPhonemeCount
     * @function
     * @public
     * @param {number} nbestPhonemeCount - NBest phoneme count.
     */
    set nbestPhonemeCount(nbestPhonemeCount) {
        this.privNBestPhonemeCount = nbestPhonemeCount;
    }
    /**
     * @member PronunciationAssessmentConfig.prototype.properties
     * @function
     * @public
     * @return {PropertyCollection} Properties of the config.
     * @summary Gets a pronunciation assessment config properties
     */
    get properties() {
        return this.privProperties;
    }
    updateJson() {
        const jsonString = this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_Json, "{}");
        const paramsJson = JSON.parse(jsonString);
        const referenceText = this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_ReferenceText);
        if (referenceText) {
            paramsJson.referenceText = referenceText;
        }
        const gradingSystem = this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_GradingSystem);
        if (gradingSystem) {
            paramsJson.gradingSystem = gradingSystem;
        }
        const granularity = this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_Granularity);
        if (granularity) {
            paramsJson.granularity = granularity;
        }
        if (this.privPhonemeAlphabet) {
            paramsJson.phonemeAlphabet = this.privPhonemeAlphabet;
        }
        if (this.privNBestPhonemeCount) {
            paramsJson.nbestPhonemeCount = this.privNBestPhonemeCount;
        }
        // always set dimension to Comprehensive
        paramsJson.dimension = "Comprehensive";
        paramsJson.enableMiscue = this.enableMiscue;
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_Params, JSON.stringify(paramsJson));
    }
}

//# sourceMappingURL=PronunciationAssessmentConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentGradingSystem.js":
/*!****************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentGradingSystem.js ***!
  \****************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PronunciationAssessmentGradingSystem": () => (/* binding */ PronunciationAssessmentGradingSystem)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines the point system for pronunciation score calibration; default value is FivePoint.
 * Added in version 1.15.0
 * @class PronunciationAssessmentGradingSystem
 */
var PronunciationAssessmentGradingSystem;
(function (PronunciationAssessmentGradingSystem) {
    /**
     * Five point calibration
     * @member PronunciationAssessmentGradingSystem.FivePoint
     */
    PronunciationAssessmentGradingSystem[PronunciationAssessmentGradingSystem["FivePoint"] = 1] = "FivePoint";
    /**
     * Hundred mark
     * @member PronunciationAssessmentGradingSystem.HundredMark
     */
    PronunciationAssessmentGradingSystem[PronunciationAssessmentGradingSystem["HundredMark"] = 2] = "HundredMark";
})(PronunciationAssessmentGradingSystem || (PronunciationAssessmentGradingSystem = {}));

//# sourceMappingURL=PronunciationAssessmentGradingSystem.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentGranularity.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentGranularity.js ***!
  \**************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PronunciationAssessmentGranularity": () => (/* binding */ PronunciationAssessmentGranularity)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines the pronunciation evaluation granularity; default value is Phoneme.
 * Added in version 1.15.0
 * @class PronunciationAssessmentGranularity
 */
var PronunciationAssessmentGranularity;
(function (PronunciationAssessmentGranularity) {
    /**
     * Shows the score on the full text, word and phoneme level
     * @member PronunciationAssessmentGranularity.Phoneme
     */
    PronunciationAssessmentGranularity[PronunciationAssessmentGranularity["Phoneme"] = 1] = "Phoneme";
    /**
     * Shows the score on the full text and word level
     * @member PronunciationAssessmentGranularity.Word
     */
    PronunciationAssessmentGranularity[PronunciationAssessmentGranularity["Word"] = 2] = "Word";
    /**
     * Shows the score on the full text level only
     * @member PronunciationAssessmentGranularity.FullText
     */
    PronunciationAssessmentGranularity[PronunciationAssessmentGranularity["FullText"] = 3] = "FullText";
})(PronunciationAssessmentGranularity || (PronunciationAssessmentGranularity = {}));

//# sourceMappingURL=PronunciationAssessmentGranularity.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentResult.js":
/*!*********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentResult.js ***!
  \*********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PronunciationAssessmentResult": () => (/* binding */ PronunciationAssessmentResult)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


/**
 * Pronunciation assessment results.
 * @class PronunciationAssessmentResult
 * Added in version 1.15.0.
 */
class PronunciationAssessmentResult {
    constructor(jsonString) {
        const j = JSON.parse(jsonString);
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(j.NBest[0], "NBest");
        this.privPronJson = j.NBest[0];
    }
    /**
     * @member PronunciationAssessmentResult.fromResult
     * @function
     * @public
     * @param {RecognitionResult} result The recognition result.
     * @return {PronunciationAssessmentConfig} Instance of PronunciationAssessmentConfig
     * @summary Creates an instance of the PronunciationAssessmentResult from recognition result.
     */
    static fromResult(result) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(result, "result");
        const json = result.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceResponse_JsonResult);
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(json, "json");
        return new PronunciationAssessmentResult(json);
    }
    /**
     * Gets the detail result of pronunciation assessment.
     * @member PronunciationAssessmentConfig.prototype.detailResult
     * @function
     * @public
     * @returns {DetailResult} detail result.
     */
    get detailResult() {
        return this.privPronJson;
    }
    /**
     * The score indicating the pronunciation accuracy of the given speech, which indicates
     * how closely the phonemes match a native speaker's pronunciation.
     * @member PronunciationAssessmentResult.prototype.accuracyScore
     * @function
     * @public
     * @returns {number} Accuracy score.
     */
    get accuracyScore() {
        return this.detailResult.PronunciationAssessment.AccuracyScore;
    }
    /**
     * The overall score indicating the pronunciation quality of the given speech.
     * This is calculated from AccuracyScore, FluencyScore and CompletenessScore with weight.
     * @member PronunciationAssessmentResult.prototype.pronunciationScore
     * @function
     * @public
     * @returns {number} Pronunciation score.
     */
    get pronunciationScore() {
        return this.detailResult.PronunciationAssessment.PronScore;
    }
    /**
     * The score indicating the completeness of the given speech by calculating the ratio of pronounced words towards entire input.
     * @member PronunciationAssessmentResult.prototype.completenessScore
     * @function
     * @public
     * @returns {number} Completeness score.
     */
    get completenessScore() {
        return this.detailResult.PronunciationAssessment.CompletenessScore;
    }
    /**
     * The score indicating the fluency of the given speech.
     * @member PronunciationAssessmentResult.prototype.fluencyScore
     * @function
     * @public
     * @returns {number} Fluency score.
     */
    get fluencyScore() {
        return this.detailResult.PronunciationAssessment.FluencyScore;
    }
}

//# sourceMappingURL=PronunciationAssessmentResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PropertyCollection": () => (/* binding */ PropertyCollection)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Represents collection of properties and their values.
 * @class PropertyCollection
 */
class PropertyCollection {
    constructor() {
        this.privKeys = [];
        this.privValues = [];
    }
    /**
     * Returns the property value in type String.
     * Currently only String, int and bool are allowed.
     * If the name is not available, the specified defaultValue is returned.
     * @member PropertyCollection.prototype.getProperty
     * @function
     * @public
     * @param {string} key - The parameter name.
     * @param {string | number | boolean} def - The default value which is returned if the parameter
     * is not available in the collection.
     * @returns {string} value of the parameter.
     */
    getProperty(key, def) {
        let keyToUse;
        if (typeof key === "string") {
            keyToUse = key;
        }
        else {
            keyToUse = _Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId[key];
        }
        for (let n = 0; n < this.privKeys.length; n++) {
            if (this.privKeys[n] === keyToUse) {
                return this.privValues[n];
            }
        }
        if (def === undefined) {
            return undefined;
        }
        return String(def);
    }
    /**
     * Sets the String value of the parameter specified by name.
     * @member PropertyCollection.prototype.setProperty
     * @function
     * @public
     * @param {string} key - The parameter name.
     * @param {string} value - The value of the parameter.
     */
    setProperty(key, value) {
        let keyToUse;
        if (typeof key === "string") {
            keyToUse = key;
        }
        else {
            keyToUse = _Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId[key];
        }
        for (let n = 0; n < this.privKeys.length; n++) {
            if (this.privKeys[n] === keyToUse) {
                this.privValues[n] = value;
                return;
            }
        }
        this.privKeys.push(keyToUse);
        this.privValues.push(value);
    }
    /**
     * Clones the collection.
     * @member PropertyCollection.prototype.clone
     * @function
     * @public
     * @returns {PropertyCollection} A copy of the collection.
     */
    clone() {
        const clonedMap = new PropertyCollection();
        for (let n = 0; n < this.privKeys.length; n++) {
            clonedMap.privKeys.push(this.privKeys[n]);
            clonedMap.privValues.push(this.privValues[n]);
        }
        return clonedMap;
    }
    /**
     * Merges this set of properties into another, no overwrites.
     * @member PropertyCollection.prototype.mergeTo
     * @function
     * @public
     * @param {PropertyCollection}  destinationCollection - The collection to merge into.
     */
    mergeTo(destinationCollection) {
        this.privKeys.forEach((key) => {
            if (destinationCollection.getProperty(key, undefined) === undefined) {
                const value = this.getProperty(key);
                destinationCollection.setProperty(key, value);
            }
        });
    }
    /**
     * Get the keys in Property Collection.
     * @member PropertyCollection.prototype.keys
     * @function
     * @public
     * @returns {string []} Keys in the collection.
     */
    get keys() {
        return this.privKeys;
    }
}

//# sourceMappingURL=PropertyCollection.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js ***!
  \**************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PropertyId": () => (/* binding */ PropertyId)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines speech property ids.
 * @class PropertyId
 */
var PropertyId;
(function (PropertyId) {
    /**
     * The Cognitive Services Speech Service subscription Key. If you are using an intent recognizer, you need to
     * specify the LUIS endpoint key for your particular LUIS app. Under normal circumstances, you shouldn't
     * have to use this property directly.
     * Instead, use [[SpeechConfig.fromSubscription]].
     * @member PropertyId.SpeechServiceConnection_Key
     */
    PropertyId[PropertyId["SpeechServiceConnection_Key"] = 0] = "SpeechServiceConnection_Key";
    /**
     * The Cognitive Services Speech Service endpoint (url). Under normal circumstances, you shouldn't
     * have to use this property directly.
     * Instead, use [[SpeechConfig.fromEndpoint]].
     * NOTE: This endpoint is not the same as the endpoint used to obtain an access token.
     * @member PropertyId.SpeechServiceConnection_Endpoint
     */
    PropertyId[PropertyId["SpeechServiceConnection_Endpoint"] = 1] = "SpeechServiceConnection_Endpoint";
    /**
     * The Cognitive Services Speech Service region. Under normal circumstances, you shouldn't have to
     * use this property directly.
     * Instead, use [[SpeechConfig.fromSubscription]], [[SpeechConfig.fromEndpoint]], [[SpeechConfig.fromAuthorizationToken]].
     * @member PropertyId.SpeechServiceConnection_Region
     */
    PropertyId[PropertyId["SpeechServiceConnection_Region"] = 2] = "SpeechServiceConnection_Region";
    /**
     * The Cognitive Services Speech Service authorization token (aka access token). Under normal circumstances,
     * you shouldn't have to use this property directly.
     * Instead, use [[SpeechConfig.fromAuthorizationToken]], [[SpeechRecognizer.authorizationToken]],
     * [[IntentRecognizer.authorizationToken]], [[TranslationRecognizer.authorizationToken]], [[SpeakerRecognizer.authorizationToken]].
     * @member PropertyId.SpeechServiceAuthorization_Token
     */
    PropertyId[PropertyId["SpeechServiceAuthorization_Token"] = 3] = "SpeechServiceAuthorization_Token";
    /**
     * The Cognitive Services Speech Service authorization type. Currently unused.
     * @member PropertyId.SpeechServiceAuthorization_Type
     */
    PropertyId[PropertyId["SpeechServiceAuthorization_Type"] = 4] = "SpeechServiceAuthorization_Type";
    /**
     * The Cognitive Services Speech Service endpoint id. Under normal circumstances, you shouldn't
     * have to use this property directly.
     * Instead, use [[SpeechConfig.endpointId]].
     * NOTE: The endpoint id is available in the Speech Portal, listed under Endpoint Details.
     * @member PropertyId.SpeechServiceConnection_EndpointId
     */
    PropertyId[PropertyId["SpeechServiceConnection_EndpointId"] = 5] = "SpeechServiceConnection_EndpointId";
    /**
     * The list of comma separated languages (BCP-47 format) used as target translation languages. Under normal circumstances,
     * you shouldn't have to use this property directly.
     * Instead use [[SpeechTranslationConfig.addTargetLanguage]],
     * [[SpeechTranslationConfig.targetLanguages]], [[TranslationRecognizer.targetLanguages]].
     * @member PropertyId.SpeechServiceConnection_TranslationToLanguages
     */
    PropertyId[PropertyId["SpeechServiceConnection_TranslationToLanguages"] = 6] = "SpeechServiceConnection_TranslationToLanguages";
    /**
     * The name of the Cognitive Service Text to Speech Service Voice. Under normal circumstances, you shouldn't have to use this
     * property directly.
     * Instead, use [[SpeechTranslationConfig.voiceName]].
     * NOTE: Valid voice names can be found <a href="https://aka.ms/csspeech/voicenames">here</a>.
     * @member PropertyId.SpeechServiceConnection_TranslationVoice
     */
    PropertyId[PropertyId["SpeechServiceConnection_TranslationVoice"] = 7] = "SpeechServiceConnection_TranslationVoice";
    /**
     * Translation features.
     * @member PropertyId.SpeechServiceConnection_TranslationFeatures
     */
    PropertyId[PropertyId["SpeechServiceConnection_TranslationFeatures"] = 8] = "SpeechServiceConnection_TranslationFeatures";
    /**
     * The Language Understanding Service Region. Under normal circumstances, you shouldn't have to use this property directly.
     * Instead, use [[LanguageUnderstandingModel]].
     * @member PropertyId.SpeechServiceConnection_IntentRegion
     */
    PropertyId[PropertyId["SpeechServiceConnection_IntentRegion"] = 9] = "SpeechServiceConnection_IntentRegion";
    /**
     * The host name of the proxy server used to connect to the Cognitive Services Speech Service. Only relevant in Node.js environments.
     * You shouldn't have to use this property directly.
     * Instead use <see cref="SpeechConfig.SetProxy(string,int,string,string)"/>.
     * Added in version 1.4.0.
     */
    PropertyId[PropertyId["SpeechServiceConnection_ProxyHostName"] = 10] = "SpeechServiceConnection_ProxyHostName";
    /**
     * The port of the proxy server used to connect to the Cognitive Services Speech Service. Only relevant in Node.js environments.
     * You shouldn't have to use this property directly.
     * Instead use <see cref="SpeechConfig.SetProxy(string,int,string,string)"/>.
     * Added in version 1.4.0.
     */
    PropertyId[PropertyId["SpeechServiceConnection_ProxyPort"] = 11] = "SpeechServiceConnection_ProxyPort";
    /**
     * The user name of the proxy server used to connect to the Cognitive Services Speech Service. Only relevant in Node.js environments.
     * You shouldn't have to use this property directly.
     * Instead use <see cref="SpeechConfig.SetProxy(string,int,string,string)"/>.
     * Added in version 1.4.0.
     */
    PropertyId[PropertyId["SpeechServiceConnection_ProxyUserName"] = 12] = "SpeechServiceConnection_ProxyUserName";
    /**
     * The password of the proxy server used to connect to the Cognitive Services Speech Service. Only relevant in Node.js environments.
     * You shouldn't have to use this property directly.
     * Instead use <see cref="SpeechConfig.SetProxy(string,int,string,string)"/>.
     * Added in version 1.4.0.
     */
    PropertyId[PropertyId["SpeechServiceConnection_ProxyPassword"] = 13] = "SpeechServiceConnection_ProxyPassword";
    /**
     * The Cognitive Services Speech Service recognition Mode. Can be "INTERACTIVE", "CONVERSATION", "DICTATION".
     * This property is intended to be read-only. The SDK is using it internally.
     * @member PropertyId.SpeechServiceConnection_RecoMode
     */
    PropertyId[PropertyId["SpeechServiceConnection_RecoMode"] = 14] = "SpeechServiceConnection_RecoMode";
    /**
     * The spoken language to be recognized (in BCP-47 format). Under normal circumstances, you shouldn't have to use this property
     * directly.
     * Instead, use [[SpeechConfig.speechRecognitionLanguage]].
     * @member PropertyId.SpeechServiceConnection_RecoLanguage
     */
    PropertyId[PropertyId["SpeechServiceConnection_RecoLanguage"] = 15] = "SpeechServiceConnection_RecoLanguage";
    /**
     * The session id. This id is a universally unique identifier (aka UUID) representing a specific binding of an audio input stream
     * and the underlying speech recognition instance to which it is bound. Under normal circumstances, you shouldn't have to use this
     * property directly.
     * Instead use [[SessionEventArgs.sessionId]].
     * @member PropertyId.Speech_SessionId
     */
    PropertyId[PropertyId["Speech_SessionId"] = 16] = "Speech_SessionId";
    /**
     * The spoken language to be synthesized (e.g. en-US)
     * @member PropertyId.SpeechServiceConnection_SynthLanguage
     */
    PropertyId[PropertyId["SpeechServiceConnection_SynthLanguage"] = 17] = "SpeechServiceConnection_SynthLanguage";
    /**
     * The name of the TTS voice to be used for speech synthesis
     * @member PropertyId.SpeechServiceConnection_SynthVoice
     */
    PropertyId[PropertyId["SpeechServiceConnection_SynthVoice"] = 18] = "SpeechServiceConnection_SynthVoice";
    /**
     * The string to specify TTS output audio format
     * @member PropertyId.SpeechServiceConnection_SynthOutputFormat
     */
    PropertyId[PropertyId["SpeechServiceConnection_SynthOutputFormat"] = 19] = "SpeechServiceConnection_SynthOutputFormat";
    /**
     * The list of comma separated languages used as possible source languages
     * Added in version 1.13.0
     * @member PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages
     */
    PropertyId[PropertyId["SpeechServiceConnection_AutoDetectSourceLanguages"] = 20] = "SpeechServiceConnection_AutoDetectSourceLanguages";
    /**
     * The requested Cognitive Services Speech Service response output format (simple or detailed). Under normal circumstances, you shouldn't have
     * to use this property directly.
     * Instead use [[SpeechConfig.outputFormat]].
     * @member PropertyId.SpeechServiceResponse_RequestDetailedResultTrueFalse
     */
    PropertyId[PropertyId["SpeechServiceResponse_RequestDetailedResultTrueFalse"] = 21] = "SpeechServiceResponse_RequestDetailedResultTrueFalse";
    /**
     * The requested Cognitive Services Speech Service response output profanity level. Currently unused.
     * @member PropertyId.SpeechServiceResponse_RequestProfanityFilterTrueFalse
     */
    PropertyId[PropertyId["SpeechServiceResponse_RequestProfanityFilterTrueFalse"] = 22] = "SpeechServiceResponse_RequestProfanityFilterTrueFalse";
    /**
     * The Cognitive Services Speech Service response output (in JSON format). This property is available on recognition result objects only.
     * @member PropertyId.SpeechServiceResponse_JsonResult
     */
    PropertyId[PropertyId["SpeechServiceResponse_JsonResult"] = 23] = "SpeechServiceResponse_JsonResult";
    /**
     * The Cognitive Services Speech Service error details (in JSON format). Under normal circumstances, you shouldn't have to
     * use this property directly. Instead use [[CancellationDetails.errorDetails]].
     * @member PropertyId.SpeechServiceResponse_JsonErrorDetails
     */
    PropertyId[PropertyId["SpeechServiceResponse_JsonErrorDetails"] = 24] = "SpeechServiceResponse_JsonErrorDetails";
    /**
     * The cancellation reason. Currently unused.
     * @member PropertyId.CancellationDetails_Reason
     */
    PropertyId[PropertyId["CancellationDetails_Reason"] = 25] = "CancellationDetails_Reason";
    /**
     * The cancellation text. Currently unused.
     * @member PropertyId.CancellationDetails_ReasonText
     */
    PropertyId[PropertyId["CancellationDetails_ReasonText"] = 26] = "CancellationDetails_ReasonText";
    /**
     * The Cancellation detailed text. Currently unused.
     * @member PropertyId.CancellationDetails_ReasonDetailedText
     */
    PropertyId[PropertyId["CancellationDetails_ReasonDetailedText"] = 27] = "CancellationDetails_ReasonDetailedText";
    /**
     * The Language Understanding Service response output (in JSON format). Available via [[IntentRecognitionResult]]
     * @member PropertyId.LanguageUnderstandingServiceResponse_JsonResult
     */
    PropertyId[PropertyId["LanguageUnderstandingServiceResponse_JsonResult"] = 28] = "LanguageUnderstandingServiceResponse_JsonResult";
    /**
     * The URL string built from speech configuration.
     * This property is intended to be read-only. The SDK is using it internally.
     * NOTE: Added in version 1.7.0.
     */
    PropertyId[PropertyId["SpeechServiceConnection_Url"] = 29] = "SpeechServiceConnection_Url";
    /**
     * The initial silence timeout value (in milliseconds) used by the service.
     * Added in version 1.7.0
     */
    PropertyId[PropertyId["SpeechServiceConnection_InitialSilenceTimeoutMs"] = 30] = "SpeechServiceConnection_InitialSilenceTimeoutMs";
    /**
     * The end silence timeout value (in milliseconds) used by the service.
     * Added in version 1.7.0
     */
    PropertyId[PropertyId["SpeechServiceConnection_EndSilenceTimeoutMs"] = 31] = "SpeechServiceConnection_EndSilenceTimeoutMs";
    /**
     * A duration of detected silence, measured in milliseconds, after which speech-to-text will determine a spoken
     * phrase has ended and generate a final Recognized result. Configuring this timeout may be helpful in situations
     * where spoken input is significantly faster or slower than usual and default segmentation behavior consistently
     * yields results that are too long or too short. Segmentation timeout values that are inappropriately high or low
     * can negatively affect speech-to-text accuracy; this property should be carefully configured and the resulting
     * behavior should be thoroughly validated as intended.
     *
     * For more information about timeout configuration that includes discussion of default behaviors, please visit
     * https://aka.ms/csspeech/timeouts.
     *
     * Added in version 1.21.0.
     */
    PropertyId[PropertyId["Speech_SegmentationSilenceTimeoutMs"] = 32] = "Speech_SegmentationSilenceTimeoutMs";
    /**
     * A boolean value specifying whether audio logging is enabled in the service or not.
     * Audio and content logs are stored either in Microsoft-owned storage, or in your own storage account linked
     * to your Cognitive Services subscription (Bring Your Own Storage (BYOS) enabled Speech resource).
     * The logs will be removed after 30 days.
     * Added in version 1.7.0
     */
    PropertyId[PropertyId["SpeechServiceConnection_EnableAudioLogging"] = 33] = "SpeechServiceConnection_EnableAudioLogging";
    /**
     * The speech service connection language identifier mode.
     * Can be "AtStart" (the default), or "Continuous". See Language
     * Identification document https://aka.ms/speech/lid?pivots=programming-language-javascript
     * for more details.
     * Added in 1.25.0
     **/
    PropertyId[PropertyId["SpeechServiceConnection_LanguageIdMode"] = 34] = "SpeechServiceConnection_LanguageIdMode";
    /**
     * A string value representing the desired endpoint version to target for Speech Recognition.
     * Added in version 1.21.0
     */
    PropertyId[PropertyId["SpeechServiceConnection_RecognitionEndpointVersion"] = 35] = "SpeechServiceConnection_RecognitionEndpointVersion";
    /**
    /**
     * A string value the current speaker recognition scenario/mode (TextIndependentIdentification, etc.).
     * Added in version 1.23.0
     */
    PropertyId[PropertyId["SpeechServiceConnection_SpeakerIdMode"] = 36] = "SpeechServiceConnection_SpeakerIdMode";
    /**
     * The requested Cognitive Services Speech Service response output profanity setting.
     * Allowed values are "masked", "removed", and "raw".
     * Added in version 1.7.0.
     */
    PropertyId[PropertyId["SpeechServiceResponse_ProfanityOption"] = 37] = "SpeechServiceResponse_ProfanityOption";
    /**
     * A string value specifying which post processing option should be used by service.
     * Allowed values are "TrueText".
     * Added in version 1.7.0
     */
    PropertyId[PropertyId["SpeechServiceResponse_PostProcessingOption"] = 38] = "SpeechServiceResponse_PostProcessingOption";
    /**
     * A boolean value specifying whether to include word-level timestamps in the response result.
     * Added in version 1.7.0
     */
    PropertyId[PropertyId["SpeechServiceResponse_RequestWordLevelTimestamps"] = 39] = "SpeechServiceResponse_RequestWordLevelTimestamps";
    /**
     * The number of times a word has to be in partial results to be returned.
     * Added in version 1.7.0
     */
    PropertyId[PropertyId["SpeechServiceResponse_StablePartialResultThreshold"] = 40] = "SpeechServiceResponse_StablePartialResultThreshold";
    /**
     * A string value specifying the output format option in the response result. Internal use only.
     * Added in version 1.7.0.
     */
    PropertyId[PropertyId["SpeechServiceResponse_OutputFormatOption"] = 41] = "SpeechServiceResponse_OutputFormatOption";
    /**
     * A boolean value to request for stabilizing translation partial results by omitting words in the end.
     * Added in version 1.7.0.
     */
    PropertyId[PropertyId["SpeechServiceResponse_TranslationRequestStablePartialResult"] = 42] = "SpeechServiceResponse_TranslationRequestStablePartialResult";
    /**
     * A boolean value specifying whether to request WordBoundary events.
     * @member PropertyId.SpeechServiceResponse_RequestWordBoundary
     * Added in version 1.21.0.
     */
    PropertyId[PropertyId["SpeechServiceResponse_RequestWordBoundary"] = 43] = "SpeechServiceResponse_RequestWordBoundary";
    /**
     * A boolean value specifying whether to request punctuation boundary in WordBoundary Events. Default is true.
     * @member PropertyId.SpeechServiceResponse_RequestPunctuationBoundary
     * Added in version 1.21.0.
     */
    PropertyId[PropertyId["SpeechServiceResponse_RequestPunctuationBoundary"] = 44] = "SpeechServiceResponse_RequestPunctuationBoundary";
    /**
     * A boolean value specifying whether to request sentence boundary in WordBoundary Events. Default is false.
     * @member PropertyId.SpeechServiceResponse_RequestSentenceBoundary
     * Added in version 1.21.0.
     */
    PropertyId[PropertyId["SpeechServiceResponse_RequestSentenceBoundary"] = 45] = "SpeechServiceResponse_RequestSentenceBoundary";
    /**
     * Identifier used to connect to the backend service.
     * @member PropertyId.Conversation_ApplicationId
     */
    PropertyId[PropertyId["Conversation_ApplicationId"] = 46] = "Conversation_ApplicationId";
    /**
     * Type of dialog backend to connect to.
     * @member PropertyId.Conversation_DialogType
     */
    PropertyId[PropertyId["Conversation_DialogType"] = 47] = "Conversation_DialogType";
    /**
     * Silence timeout for listening
     * @member PropertyId.Conversation_Initial_Silence_Timeout
     */
    PropertyId[PropertyId["Conversation_Initial_Silence_Timeout"] = 48] = "Conversation_Initial_Silence_Timeout";
    /**
     * From Id to add to speech recognition activities.
     * @member PropertyId.Conversation_From_Id
     */
    PropertyId[PropertyId["Conversation_From_Id"] = 49] = "Conversation_From_Id";
    /**
     * ConversationId for the session.
     * @member PropertyId.Conversation_Conversation_Id
     */
    PropertyId[PropertyId["Conversation_Conversation_Id"] = 50] = "Conversation_Conversation_Id";
    /**
     * Comma separated list of custom voice deployment ids.
     * @member PropertyId.Conversation_Custom_Voice_Deployment_Ids
     */
    PropertyId[PropertyId["Conversation_Custom_Voice_Deployment_Ids"] = 51] = "Conversation_Custom_Voice_Deployment_Ids";
    /**
     * Speech activity template, stamp properties from the template on the activity generated by the service for speech.
     * @member PropertyId.Conversation_Speech_Activity_Template
     * Added in version 1.10.0.
     */
    PropertyId[PropertyId["Conversation_Speech_Activity_Template"] = 52] = "Conversation_Speech_Activity_Template";
    /**
     * Enables or disables the receipt of turn status messages as obtained on the turnStatusReceived event.
     * @member PropertyId.Conversation_Request_Bot_Status_Messages
     * Added in version 1.15.0.
     */
    PropertyId[PropertyId["Conversation_Request_Bot_Status_Messages"] = 53] = "Conversation_Request_Bot_Status_Messages";
    /**
     * Specifies the connection ID to be provided in the Agent configuration message, e.g. a Direct Line token for
     * channel authentication.
     * Added in version 1.15.1.
     */
    PropertyId[PropertyId["Conversation_Agent_Connection_Id"] = 54] = "Conversation_Agent_Connection_Id";
    /**
     * The Cognitive Services Speech Service host (url). Under normal circumstances, you shouldn't have to use this property directly.
     * Instead, use [[SpeechConfig.fromHost]].
     */
    PropertyId[PropertyId["SpeechServiceConnection_Host"] = 55] = "SpeechServiceConnection_Host";
    /**
     * Set the host for service calls to the Conversation Translator REST management and websocket calls.
     */
    PropertyId[PropertyId["ConversationTranslator_Host"] = 56] = "ConversationTranslator_Host";
    /**
     * Optionally set the the host's display name.
     * Used when joining a conversation.
     */
    PropertyId[PropertyId["ConversationTranslator_Name"] = 57] = "ConversationTranslator_Name";
    /**
     * Optionally set a value for the X-CorrelationId request header.
     * Used for troubleshooting errors in the server logs. It should be a valid guid.
     */
    PropertyId[PropertyId["ConversationTranslator_CorrelationId"] = 58] = "ConversationTranslator_CorrelationId";
    /**
     * Set the conversation token to be sent to the speech service. This enables the
     * service to service call from the speech service to the Conversation Translator service for relaying
     * recognitions. For internal use.
     */
    PropertyId[PropertyId["ConversationTranslator_Token"] = 59] = "ConversationTranslator_Token";
    /**
     * The reference text of the audio for pronunciation evaluation.
     * For this and the following pronunciation assessment parameters, see
     * https://docs.microsoft.com/azure/cognitive-services/speech-service/rest-speech-to-text#pronunciation-assessment-parameters for details.
     * Under normal circumstances, you shouldn't have to use this property directly.
     * Added in version 1.15.0
     */
    PropertyId[PropertyId["PronunciationAssessment_ReferenceText"] = 60] = "PronunciationAssessment_ReferenceText";
    /**
     * The point system for pronunciation score calibration (FivePoint or HundredMark).
     * Under normal circumstances, you shouldn't have to use this property directly.
     * Added in version 1.15.0
     */
    PropertyId[PropertyId["PronunciationAssessment_GradingSystem"] = 61] = "PronunciationAssessment_GradingSystem";
    /**
     * The pronunciation evaluation granularity (Phoneme, Word, or FullText).
     * Under normal circumstances, you shouldn't have to use this property directly.
     * Added in version 1.15.0
     */
    PropertyId[PropertyId["PronunciationAssessment_Granularity"] = 62] = "PronunciationAssessment_Granularity";
    /**
     * Defines if enable miscue calculation.
     * With this enabled, the pronounced words will be compared to the reference text,
     * and will be marked with omission/insertion based on the comparison. The default setting is False.
     * Under normal circumstances, you shouldn't have to use this property directly.
     * Added in version 1.15.0
     */
    PropertyId[PropertyId["PronunciationAssessment_EnableMiscue"] = 63] = "PronunciationAssessment_EnableMiscue";
    /**
     * The json string of pronunciation assessment parameters
     * Under normal circumstances, you shouldn't have to use this property directly.
     * Added in version 1.15.0
     */
    PropertyId[PropertyId["PronunciationAssessment_Json"] = 64] = "PronunciationAssessment_Json";
    /**
     * Pronunciation assessment parameters.
     * This property is intended to be read-only. The SDK is using it internally.
     * Added in version 1.15.0
     */
    PropertyId[PropertyId["PronunciationAssessment_Params"] = 65] = "PronunciationAssessment_Params";
    /**
     * Version of Speaker Recognition API to use.
     * Added in version 1.18.0
     */
    PropertyId[PropertyId["SpeakerRecognition_Api_Version"] = 66] = "SpeakerRecognition_Api_Version";
})(PropertyId || (PropertyId = {}));

//# sourceMappingURL=PropertyId.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js":
/*!************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RecognitionEventArgs": () => (/* binding */ RecognitionEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Defines payload for session events like Speech Start/End Detected
 * @class
 */
class RecognitionEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {number} offset - The offset.
     * @param {string} sessionId - The session id.
     */
    constructor(offset, sessionId) {
        super(sessionId);
        this.privOffset = offset;
    }
    /**
     * Represents the message offset
     * @member RecognitionEventArgs.prototype.offset
     * @function
     * @public
     */
    get offset() {
        return this.privOffset;
    }
}

//# sourceMappingURL=RecognitionEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionResult.js":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionResult.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RecognitionResult": () => (/* binding */ RecognitionResult)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines result of speech recognition.
 * @class RecognitionResult
 */
class RecognitionResult {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {string} resultId - The result id.
     * @param {ResultReason} reason - The reason.
     * @param {string} text - The recognized text.
     * @param {number} duration - The duration.
     * @param {number} offset - The offset into the stream.
     * @param {string} language - Primary Language detected, if provided.
     * @param {string} languageDetectionConfidence - Primary Language confidence ("Unknown," "Low," "Medium," "High"...), if provided.
     * @param {string} errorDetails - Error details, if provided.
     * @param {string} json - Additional Json, if provided.
     * @param {PropertyCollection} properties - Additional properties, if provided.
     */
    constructor(resultId, reason, text, duration, offset, language, languageDetectionConfidence, errorDetails, json, properties) {
        this.privResultId = resultId;
        this.privReason = reason;
        this.privText = text;
        this.privDuration = duration;
        this.privOffset = offset;
        this.privLanguage = language;
        this.privLanguageDetectionConfidence = languageDetectionConfidence;
        this.privErrorDetails = errorDetails;
        this.privJson = json;
        this.privProperties = properties;
    }
    /**
     * Specifies the result identifier.
     * @member RecognitionResult.prototype.resultId
     * @function
     * @public
     * @returns {string} Specifies the result identifier.
     */
    get resultId() {
        return this.privResultId;
    }
    /**
     * Specifies status of the result.
     * @member RecognitionResult.prototype.reason
     * @function
     * @public
     * @returns {ResultReason} Specifies status of the result.
     */
    get reason() {
        return this.privReason;
    }
    /**
     * Presents the recognized text in the result.
     * @member RecognitionResult.prototype.text
     * @function
     * @public
     * @returns {string} Presents the recognized text in the result.
     */
    get text() {
        return this.privText;
    }
    /**
     * Duration of recognized speech in 100 nano second increments.
     * @member RecognitionResult.prototype.duration
     * @function
     * @public
     * @returns {number} Duration of recognized speech in 100 nano second increments.
     */
    get duration() {
        return this.privDuration;
    }
    /**
     * Offset of recognized speech in 100 nano second increments.
     * @member RecognitionResult.prototype.offset
     * @function
     * @public
     * @returns {number} Offset of recognized speech in 100 nano second increments.
     */
    get offset() {
        return this.privOffset;
    }
    /**
     * Primary Language detected.
     * @member RecognitionResult.prototype.language
     * @function
     * @public
     * @returns {string} language detected.
     */
    get language() {
        return this.privLanguage;
    }
    /**
     * Primary Language detection confidence (Unknown, Low, Medium, High).
     * @member RecognitionResult.prototype.languageDetectionConfidence
     * @function
     * @public
     * @returns {string} detection confidence strength.
     */
    get languageDetectionConfidence() {
        return this.privLanguageDetectionConfidence;
    }
    /**
     * In case of an unsuccessful recognition, provides details of the occurred error.
     * @member RecognitionResult.prototype.errorDetails
     * @function
     * @public
     * @returns {string} a brief description of an error.
     */
    get errorDetails() {
        return this.privErrorDetails;
    }
    /**
     * A string containing Json serialized recognition result as it was received from the service.
     * @member RecognitionResult.prototype.json
     * @function
     * @private
     * @returns {string} Json serialized representation of the result.
     */
    get json() {
        return this.privJson;
    }
    /**
     * The set of properties exposed in the result.
     * @member RecognitionResult.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The set of properties exposed in the result.
     */
    get properties() {
        return this.privProperties;
    }
}

//# sourceMappingURL=RecognitionResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js ***!
  \**************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Recognizer": () => (/* binding */ Recognizer)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveSubscriptionKeyAuthentication.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveTokenAuthentication.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




/**
 * Defines the base class Recognizer which mainly contains common event handlers.
 * @class Recognizer
 */
class Recognizer {
    /**
     * Creates and initializes an instance of a Recognizer
     * @constructor
     * @param {AudioConfig} audioInput - An optional audio input stream associated with the recognizer
     */
    constructor(audioConfig, properties, connectionFactory) {
        this.audioConfig = (audioConfig !== undefined) ? audioConfig : _Exports__WEBPACK_IMPORTED_MODULE_0__.AudioConfig.fromDefaultMicrophoneInput();
        this.privDisposed = false;
        this.privProperties = properties.clone();
        this.privConnectionFactory = connectionFactory;
        this.implCommonRecognizerSetup();
    }
    /**
     * Dispose of associated resources.
     * @member Recognizer.prototype.close
     * @function
     * @public
     */
    close(cb, errorCb) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposed);
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_2__.marshalPromiseToCallbacks)(this.dispose(true), cb, errorCb);
    }
    /**
     * @Internal
     * Internal data member to support fromRecognizer* pattern methods on other classes.
     * Do not use externally, object returned will change without warning or notice.
     */
    get internalData() {
        return this.privReco;
    }
    /**
     * This method performs cleanup of resources.
     * The Boolean parameter disposing indicates whether the method is called
     * from Dispose (if disposing is true) or from the finalizer (if disposing is false).
     * Derived classes should override this method to dispose resource if needed.
     * @member Recognizer.prototype.dispose
     * @function
     * @public
     * @param {boolean} disposing - Flag to request disposal.
     */
    dispose(disposing) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privDisposed) {
                return;
            }
            this.privDisposed = true;
            if (disposing) {
                if (this.privReco) {
                    yield this.privReco.audioSource.turnOff();
                    yield this.privReco.dispose();
                }
            }
        });
    }
    /**
     * This method returns the current state of the telemetry setting.
     * @member Recognizer.prototype.telemetryEnabled
     * @function
     * @public
     * @returns true if the telemetry is enabled, false otherwise.
     */
    static get telemetryEnabled() {
        return _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.ServiceRecognizerBase.telemetryDataEnabled;
    }
    /**
     * This method globally enables or disables telemetry.
     * @member Recognizer.prototype.enableTelemetry
     * @function
     * @public
     * @param enabled - Global setting for telemetry collection.
     * If set to true, telemetry information like microphone errors,
     * recognition errors are collected and sent to Microsoft.
     * If set to false, no telemetry is sent to Microsoft.
     */
    static enableTelemetry(enabled) {
        _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.ServiceRecognizerBase.telemetryDataEnabled = enabled;
    }
    // Does the generic recognizer setup that is common across all recognizer types.
    implCommonRecognizerSetup() {
        let osPlatform = (typeof window !== "undefined") ? "Browser" : "Node";
        let osName = "unknown";
        let osVersion = "unknown";
        if (typeof navigator !== "undefined") {
            osPlatform = osPlatform + "/" + navigator.platform;
            osName = navigator.userAgent;
            osVersion = navigator.appVersion;
        }
        const recognizerConfig = this.createRecognizerConfig(new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.SpeechServiceConfig(new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.Context(new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.OS(osPlatform, osName, osVersion))));
        this.privReco = this.createServiceRecognizer(Recognizer.getAuthFromProperties(this.privProperties), this.privConnectionFactory, this.audioConfig, recognizerConfig);
    }
    recognizeOnceAsyncImpl(recognitionMode) {
        return __awaiter(this, void 0, void 0, function* () {
            _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposed);
            const ret = new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.Deferred();
            yield this.implRecognizerStop();
            yield this.privReco.recognize(recognitionMode, ret.resolve, ret.reject);
            const result = yield ret.promise;
            yield this.implRecognizerStop();
            return result;
        });
    }
    startContinuousRecognitionAsyncImpl(recognitionMode) {
        return __awaiter(this, void 0, void 0, function* () {
            _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposed);
            yield this.implRecognizerStop();
            yield this.privReco.recognize(recognitionMode, undefined, undefined);
        });
    }
    stopContinuousRecognitionAsyncImpl() {
        return __awaiter(this, void 0, void 0, function* () {
            _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposed);
            yield this.implRecognizerStop();
        });
    }
    implRecognizerStop() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privReco) {
                yield this.privReco.stopRecognizing();
            }
            return;
        });
    }
    static getAuthFromProperties(properties) {
        const subscriptionKey = properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_5__.PropertyId.SpeechServiceConnection_Key, undefined);
        const authentication = (subscriptionKey && subscriptionKey !== "") ?
            new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__.CognitiveSubscriptionKeyAuthentication(subscriptionKey) :
            new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__.CognitiveTokenAuthentication(() => {
                const authorizationToken = properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_5__.PropertyId.SpeechServiceAuthorization_Token, undefined);
                return Promise.resolve(authorizationToken);
            }, () => {
                const authorizationToken = properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_5__.PropertyId.SpeechServiceAuthorization_Token, undefined);
                return Promise.resolve(authorizationToken);
            });
        return authentication;
    }
}

//# sourceMappingURL=Recognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js ***!
  \****************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ResultReason": () => (/* binding */ ResultReason)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines the possible reasons a recognition result might be generated.
 * @class ResultReason
 */
var ResultReason;
(function (ResultReason) {
    /**
     * Indicates speech could not be recognized. More details
     * can be found in the NoMatchDetails object.
     * @member ResultReason.NoMatch
     */
    ResultReason[ResultReason["NoMatch"] = 0] = "NoMatch";
    /**
     * Indicates that the recognition was canceled. More details
     * can be found using the CancellationDetails object.
     * @member ResultReason.Canceled
     */
    ResultReason[ResultReason["Canceled"] = 1] = "Canceled";
    /**
     * Indicates the speech result contains hypothesis text.
     * @member ResultReason.RecognizedSpeech
     */
    ResultReason[ResultReason["RecognizingSpeech"] = 2] = "RecognizingSpeech";
    /**
     * Indicates the speech result contains final text that has been recognized.
     * Speech Recognition is now complete for this phrase.
     * @member ResultReason.RecognizedSpeech
     */
    ResultReason[ResultReason["RecognizedSpeech"] = 3] = "RecognizedSpeech";
    /**
     * Indicates the speech result contains a finalized acceptance of a provided keyword.
     * Speech recognition will continue unless otherwise configured.
     * @member ResultReason.RecognizedKeyword
     */
    ResultReason[ResultReason["RecognizedKeyword"] = 4] = "RecognizedKeyword";
    /**
     * Indicates the intent result contains hypothesis text and intent.
     * @member ResultReason.RecognizingIntent
     */
    ResultReason[ResultReason["RecognizingIntent"] = 5] = "RecognizingIntent";
    /**
     * Indicates the intent result contains final text and intent.
     * Speech Recognition and Intent determination are now complete for this phrase.
     * @member ResultReason.RecognizedIntent
     */
    ResultReason[ResultReason["RecognizedIntent"] = 6] = "RecognizedIntent";
    /**
     * Indicates the translation result contains hypothesis text and its translation(s).
     * @member ResultReason.TranslatingSpeech
     */
    ResultReason[ResultReason["TranslatingSpeech"] = 7] = "TranslatingSpeech";
    /**
     * Indicates the translation result contains final text and corresponding translation(s).
     * Speech Recognition and Translation are now complete for this phrase.
     * @member ResultReason.TranslatedSpeech
     */
    ResultReason[ResultReason["TranslatedSpeech"] = 8] = "TranslatedSpeech";
    /**
     * Indicates the synthesized audio result contains a non-zero amount of audio data
     * @member ResultReason.SynthesizingAudio
     */
    ResultReason[ResultReason["SynthesizingAudio"] = 9] = "SynthesizingAudio";
    /**
     * Indicates the synthesized audio is now complete for this phrase.
     * @member ResultReason.SynthesizingAudioCompleted
     */
    ResultReason[ResultReason["SynthesizingAudioCompleted"] = 10] = "SynthesizingAudioCompleted";
    /**
     * Indicates the speech synthesis is now started
     * @member ResultReason.SynthesizingAudioStarted
     */
    ResultReason[ResultReason["SynthesizingAudioStarted"] = 11] = "SynthesizingAudioStarted";
    /**
     * Indicates the voice profile is being enrolled and customers need to send more audio to create a voice profile.
     * @member ResultReason.EnrollingVoiceProfile
     */
    ResultReason[ResultReason["EnrollingVoiceProfile"] = 12] = "EnrollingVoiceProfile";
    /**
     * Indicates the voice profile has been enrolled.
     * @member ResultReason.EnrolledVoiceProfile
     */
    ResultReason[ResultReason["EnrolledVoiceProfile"] = 13] = "EnrolledVoiceProfile";
    /**
     * Indicates successful identification of some speakers.
     * @member ResultReason.RecognizedSpeakers
     */
    ResultReason[ResultReason["RecognizedSpeakers"] = 14] = "RecognizedSpeakers";
    /**
     * Indicates successfully verified one speaker.
     * @member ResultReason.RecognizedSpeaker
     */
    ResultReason[ResultReason["RecognizedSpeaker"] = 15] = "RecognizedSpeaker";
    /**
     * Indicates a voice profile has been reset successfully.
     * @member ResultReason.ResetVoiceProfile
     */
    ResultReason[ResultReason["ResetVoiceProfile"] = 16] = "ResetVoiceProfile";
    /**
     * Indicates a voice profile has been deleted successfully.
     * @member ResultReason.DeletedVoiceProfile
     */
    ResultReason[ResultReason["DeletedVoiceProfile"] = 17] = "DeletedVoiceProfile";
    /**
     * Indicates synthesis voices list has been successfully retrieved.
     * @member ResultReason.VoicesListRetrieved
     */
    ResultReason[ResultReason["VoicesListRetrieved"] = 18] = "VoicesListRetrieved";
    /**
     * Indicates the transcription result contains hypothesis text and its translation(s) for
     * other participants in the conversation.
     * @member ResultReason.TranslatingParticipantSpeech
     */
    ResultReason[ResultReason["TranslatingParticipantSpeech"] = 19] = "TranslatingParticipantSpeech";
    /**
     * Indicates the transcription result contains final text and corresponding translation(s)
     * for other participants in the conversation. Speech Recognition and Translation are now
     * complete for this phrase.
     * @member ResultReason.TranslatedParticipantSpeech
     */
    ResultReason[ResultReason["TranslatedParticipantSpeech"] = 20] = "TranslatedParticipantSpeech";
    /**
     * <summary>
     * Indicates the transcription result contains the instant message and corresponding
     * translation(s).
     * @member ResultReason.TranslatedInstantMessage
     */
    ResultReason[ResultReason["TranslatedInstantMessage"] = 21] = "TranslatedInstantMessage";
    /**
     * Indicates the transcription result contains the instant message for other participants
     * in the conversation and corresponding translation(s).
     * @member ResultReason.TranslatedParticipantInstantMessage
     */
    ResultReason[ResultReason["TranslatedParticipantInstantMessage"] = 22] = "TranslatedParticipantInstantMessage";
})(ResultReason || (ResultReason = {}));

//# sourceMappingURL=ResultReason.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ServiceEventArgs.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ServiceEventArgs.js ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ServiceEventArgs": () => (/* binding */ ServiceEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
//
// Copyright (c) Microsoft. All rights reserved.
// Licensed under the MIT license. See LICENSE.md file in the project root for full license information.
//

/**
 * Defines payload for any Service message event
 * Added in version 1.9.0
 */
class ServiceEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {string} json - json payload of the USP message.
     */
    constructor(json, name, sessionId) {
        super(sessionId);
        this.privJsonResult = json;
        this.privEventName = name;
    }
    get jsonString() {
        return this.privJsonResult;
    }
    get eventName() {
        return this.privEventName;
    }
}

//# sourceMappingURL=ServiceEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ServicePropertyChannel.js":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ServicePropertyChannel.js ***!
  \**************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ServicePropertyChannel": () => (/* binding */ ServicePropertyChannel)
/* harmony export */ });
// Copyright (c) Microsoft Corporation.
// Licensed under the MIT license.
/**
 * Defines channels used to pass property settings to service.
 * Added in version 1.7.0.
 */
var ServicePropertyChannel;
(function (ServicePropertyChannel) {
    /**
     * Uses URI query parameter to pass property settings to service.
     */
    ServicePropertyChannel[ServicePropertyChannel["UriQueryParameter"] = 0] = "UriQueryParameter";
})(ServicePropertyChannel || (ServicePropertyChannel = {}));

//# sourceMappingURL=ServicePropertyChannel.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SessionEventArgs": () => (/* binding */ SessionEventArgs)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines content for session events like SessionStarted/Stopped, SoundStarted/Stopped.
 * @class SessionEventArgs
 */
class SessionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {string} sessionId - The session id.
     */
    constructor(sessionId) {
        this.privSessionId = sessionId;
    }
    /**
     * Represents the session identifier.
     * @member SessionEventArgs.prototype.sessionId
     * @function
     * @public
     * @returns {string} Represents the session identifier.
     */
    get sessionId() {
        return this.privSessionId;
    }
}

//# sourceMappingURL=SessionEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SourceLanguageConfig.js":
/*!************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SourceLanguageConfig.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SourceLanguageConfig": () => (/* binding */ SourceLanguageConfig)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Source Language configuration.
 * @class SourceLanguageConfig
 */
class SourceLanguageConfig {
    constructor(language, endpointId) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(language, "language");
        this.privLanguage = language;
        this.privEndpointId = endpointId;
    }
    /**
     * @member SourceLanguageConfig.fromLanguage
     * @function
     * @public
     * @param {string} language language (eg. "en-US") value of config.
     * @param {string?} endpointId endpointId of model bound to given language of config.
     * @return {SourceLanguageConfig} Instance of SourceLanguageConfig
     * @summary Creates an instance of the SourceLanguageConfig with the given language and optional endpointId.
     * Added in version 1.13.0.
     */
    static fromLanguage(language, endpointId) {
        return new SourceLanguageConfig(language, endpointId);
    }
    get language() {
        return this.privLanguage;
    }
    get endpointId() {
        return this.privEndpointId;
    }
}

//# sourceMappingURL=SourceLanguageConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerIdentificationModel.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerIdentificationModel.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeakerIdentificationModel": () => (/* binding */ SpeakerIdentificationModel)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileType.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


/**
 * Defines SpeakerIdentificationModel class for Speaker Recognition
 * Model contains a set of profiles against which to identify speaker(s)
 * @class SpeakerIdentificationModel
 */
class SpeakerIdentificationModel {
    constructor(profiles) {
        this.privVoiceProfiles = [];
        this.privProfileIds = [];
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(profiles, "VoiceProfiles");
        if (profiles.length === 0) {
            throw new Error("Empty Voice Profiles array");
        }
        for (const profile of profiles) {
            if (profile.profileType !== _Exports__WEBPACK_IMPORTED_MODULE_1__.VoiceProfileType.TextIndependentIdentification) {
                throw new Error("Identification model can only be created from Identification profile: " + profile.profileId);
            }
            this.privVoiceProfiles.push(profile);
            this.privProfileIds.push(profile.profileId);
        }
    }
    static fromProfiles(profiles) {
        return new SpeakerIdentificationModel(profiles);
    }
    get voiceProfileIds() {
        return this.privProfileIds.join(",");
    }
    get profileIds() {
        return this.privProfileIds;
    }
    get scenario() {
        return "TextIndependentIdentification";
    }
}

//# sourceMappingURL=SpeakerIdentificationModel.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerRecognitionResult.js":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerRecognitionResult.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeakerRecognitionCancellationDetails": () => (/* binding */ SpeakerRecognitionCancellationDetails),
/* harmony export */   "SpeakerRecognitionResult": () => (/* binding */ SpeakerRecognitionResult),
/* harmony export */   "SpeakerRecognitionResultType": () => (/* binding */ SpeakerRecognitionResultType)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetailsBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */


var SpeakerRecognitionResultType;
(function (SpeakerRecognitionResultType) {
    SpeakerRecognitionResultType[SpeakerRecognitionResultType["Verify"] = 0] = "Verify";
    SpeakerRecognitionResultType[SpeakerRecognitionResultType["Identify"] = 1] = "Identify";
})(SpeakerRecognitionResultType || (SpeakerRecognitionResultType = {}));
/**
 * Output format
 * @class SpeakerRecognitionResult
 */
class SpeakerRecognitionResult {
    constructor(response, resultReason = _Exports__WEBPACK_IMPORTED_MODULE_0__.ResultReason.RecognizedSpeaker, cancellationErrorCode = _Exports__WEBPACK_IMPORTED_MODULE_1__.CancellationErrorCode.NoError, errorDetails = "") {
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyCollection();
        const resultType = response.scenario === "TextIndependentIdentification" ? SpeakerRecognitionResultType.Identify : SpeakerRecognitionResultType.Verify;
        this.privReason = resultReason;
        if (this.privReason !== _Exports__WEBPACK_IMPORTED_MODULE_0__.ResultReason.Canceled) {
            if (resultType === SpeakerRecognitionResultType.Identify) {
                this.privProfileId = response.identificationResult.identifiedProfile.profileId;
                this.privScore = response.identificationResult.identifiedProfile.score;
                this.privReason = _Exports__WEBPACK_IMPORTED_MODULE_0__.ResultReason.RecognizedSpeakers;
            }
            else {
                this.privScore = response.verificationResult.score;
                if (response.verificationResult.recognitionResult.toLowerCase() !== "accept") {
                    this.privReason = _Exports__WEBPACK_IMPORTED_MODULE_0__.ResultReason.NoMatch;
                }
                if (response.verificationResult.profileId !== undefined && response.verificationResult.profileId !== "") {
                    this.privProfileId = response.verificationResult.profileId;
                }
            }
        }
        else {
            this.privErrorDetails = errorDetails;
            this.privProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCodePropertyName, _Exports__WEBPACK_IMPORTED_MODULE_1__.CancellationErrorCode[cancellationErrorCode]);
        }
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceResponse_JsonResult, JSON.stringify(response));
    }
    get properties() {
        return this.privProperties;
    }
    get reason() {
        return this.privReason;
    }
    get profileId() {
        return this.privProfileId;
    }
    get errorDetails() {
        return this.privErrorDetails;
    }
    get score() {
        return this.privScore;
    }
}
/**
 * @class SpeakerRecognitionCancellationDetails
 */
class SpeakerRecognitionCancellationDetails extends _Exports__WEBPACK_IMPORTED_MODULE_5__.CancellationDetailsBase {
    constructor(reason, errorDetails, errorCode) {
        super(reason, errorDetails, errorCode);
    }
    /**
     * Creates an instance of SpeakerRecognitionCancellationDetails object for the canceled SpeakerRecognitionResult
     * @member SpeakerRecognitionCancellationDetails.fromResult
     * @function
     * @public
     * @param {SpeakerRecognitionResult} result - The result that was canceled.
     * @returns {SpeakerRecognitionCancellationDetails} The cancellation details object being created.
     */
    static fromResult(result) {
        const reason = _Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationReason.Error;
        let errorCode = _Exports__WEBPACK_IMPORTED_MODULE_1__.CancellationErrorCode.NoError;
        if (!!result.properties) {
            errorCode = _Exports__WEBPACK_IMPORTED_MODULE_1__.CancellationErrorCode[result.properties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCodePropertyName, _Exports__WEBPACK_IMPORTED_MODULE_1__.CancellationErrorCode[_Exports__WEBPACK_IMPORTED_MODULE_1__.CancellationErrorCode.NoError])];
        }
        return new SpeakerRecognitionCancellationDetails(reason, result.errorDetails, errorCode);
    }
}

//# sourceMappingURL=SpeakerRecognitionResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerRecognizer.js":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerRecognizer.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeakerRecognizer": () => (/* binding */ SpeakerRecognizer)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerRecognitionConnectionFactory.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerServiceRecognizer.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



/**
 * Defines SpeakerRecognizer class for Speaker Recognition
 * Handles operations from user for Voice Profile operations (e.g. createProfile, deleteProfile)
 * @class SpeakerRecognizer
 */
class SpeakerRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.Recognizer {
    /**
     * Initializes an instance of the SpeakerRecognizer.
     * @constructor
     * @param {SpeechConfig} speechConfig - The set of configuration properties.
     * @param {AudioConfig} audioConfig - An optional audio input config associated with the recognizer
     */
    constructor(speechConfig, audioConfig) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(speechConfig, "speechConfig");
        const configImpl = speechConfig;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(configImpl, "speechConfig");
        super(audioConfig, configImpl.properties, new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeakerRecognitionConnectionFactory());
        this.privAudioConfigImpl = audioConfig;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(this.privAudioConfigImpl, "audioConfig");
        this.privDisposedSpeakerRecognizer = false;
        this.privProperties = configImpl.properties;
    }
    /**
     * Gets the authorization token used to communicate with the service.
     * @member SpeakerRecognizer.prototype.authorizationToken
     * @function
     * @public
     * @returns {string} Authorization token.
     */
    get authorizationToken() {
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceAuthorization_Token);
    }
    /**
     * Gets/Sets the authorization token used to communicate with the service.
     * @member SpeakerRecognizer.prototype.authorizationToken
     * @function
     * @public
     * @param {string} token - Authorization token.
     */
    set authorizationToken(token) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(token, "token");
        this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceAuthorization_Token, token);
    }
    /**
     * The collection of properties and their values defined for this SpeakerRecognizer.
     * @member SpeakerRecognizer.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The collection of properties and their values defined for this SpeakerRecognizer.
     */
    get properties() {
        return this.privProperties;
    }
    /**
     * Get recognition result for model using given audio
     * @member SpeakerRecognizer.prototype.recognizeOnceAsync
     * @function
     * @public
     * @async
     * @param {SpeakerIdentificationModel | SpeakerVerificationModel} model Model containing Voice Profiles to be identified
     * @param cb - Callback invoked once result is returned.
     * @param err - Callback invoked in case of an error.
     */
    recognizeOnceAsync(model) {
        return __awaiter(this, void 0, void 0, function* () {
            _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer);
            return this.recognizeSpeakerOnceAsyncImpl(model);
        });
    }
    /**
     * Included for compatibility
     * @member SpeakerRecognizer.prototype.close
     * @function
     * @public
     * @async
     */
    close() {
        return __awaiter(this, void 0, void 0, function* () {
            _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer);
            yield this.dispose(true);
        });
    }
    recognizeSpeakerOnceAsyncImpl(model) {
        return __awaiter(this, void 0, void 0, function* () {
            _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer);
            yield this.implRecognizerStop();
            const result = yield this.privReco.recognizeSpeaker(model);
            yield this.implRecognizerStop();
            return result;
        });
    }
    implRecognizerStop() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privReco) {
                yield this.privReco.stopRecognizing();
            }
            return;
        });
    }
    createRecognizerConfig(speechConfig) {
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.RecognizerConfig(speechConfig, this.privProperties);
    }
    createServiceRecognizer(authentication, connectionFactory, audioConfig, recognizerConfig) {
        const audioImpl = audioConfig;
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.SpeakerServiceRecognizer(authentication, connectionFactory, audioImpl, recognizerConfig, this);
    }
    dispose(disposing) {
        const _super = Object.create(null, {
            dispose: { get: () => super.dispose }
        });
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privDisposedSpeakerRecognizer) {
                return;
            }
            if (disposing) {
                this.privDisposedSpeakerRecognizer = true;
                yield _super.dispose.call(this, disposing);
            }
        });
    }
}

//# sourceMappingURL=SpeakerRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerVerificationModel.js":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerVerificationModel.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeakerVerificationModel": () => (/* binding */ SpeakerVerificationModel)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileType.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


/**
 * Defines SpeakerVerificationModel class for Speaker Recognition
 * Model contains a profile against which to verify a speaker
 * @class SpeakerVerificationModel
 */
class SpeakerVerificationModel {
    constructor(profile) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(profile, "VoiceProfile");
        if (profile.profileType === _Exports__WEBPACK_IMPORTED_MODULE_1__.VoiceProfileType.TextIndependentIdentification) {
            throw new Error("Verification model cannot be created from Identification profile");
        }
        this.privVoiceProfile = profile;
    }
    static fromProfile(profile) {
        return new SpeakerVerificationModel(profile);
    }
    get voiceProfile() {
        return this.privVoiceProfile;
    }
    get profileIds() {
        return [this.voiceProfile.profileId];
    }
    get scenario() {
        if (this.voiceProfile.profileType === _Exports__WEBPACK_IMPORTED_MODULE_1__.VoiceProfileType.TextDependentVerification) {
            return "TextDependentVerification";
        }
        else {
            return "TextIndependentVerification";
        }
    }
}

//# sourceMappingURL=SpeakerVerificationModel.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechConfig.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechConfig.js ***!
  \****************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechConfig": () => (/* binding */ SpeechConfig),
/* harmony export */   "SpeechConfigImpl": () => (/* binding */ SpeechConfigImpl)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ProfanityOption.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisOutputFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */



/**
 * Speech configuration.
 * @class SpeechConfig
 */
class SpeechConfig {
    /**
     * Creates and initializes an instance.
     * @constructor
     */
    constructor() {
        return;
    }
    /**
     * Static instance of SpeechConfig returned by passing subscriptionKey and service region.
     * Note: Please use your LanguageUnderstanding subscription key in case you want to use the Intent recognizer.
     * @member SpeechConfig.fromSubscription
     * @function
     * @public
     * @param {string} subscriptionKey - The subscription key.
     * @param {string} region - The region name (see the <a href="https://aka.ms/csspeech/region">region page</a>).
     * @returns {SpeechConfig} The speech factory
     */
    static fromSubscription(subscriptionKey, region) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(subscriptionKey, "subscriptionKey");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(region, "region");
        const speechImpl = new SpeechConfigImpl();
        speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Region, region);
        speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_IntentRegion, region);
        speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Key, subscriptionKey);
        return speechImpl;
    }
    /**
     * Creates an instance of the speech config with specified endpoint and subscription key.
     * This method is intended only for users who use a non-standard service endpoint or parameters.
     * Note: Please use your LanguageUnderstanding subscription key in case you want to use the Intent recognizer.
     * Note: The query parameters specified in the endpoint URL are not changed, even if they are set by any other APIs.
     * For example, if language is defined in the uri as query parameter "language=de-DE", and also set by
     * SpeechConfig.speechRecognitionLanguage = "en-US", the language setting in uri takes precedence,
     * and the effective language is "de-DE". Only the parameters that are not specified in the
     * endpoint URL can be set by other APIs.
     * Note: To use authorization token with fromEndpoint, pass an empty string to the subscriptionKey in the
     * fromEndpoint method, and then set authorizationToken="token" on the created SpeechConfig instance to
     * use the authorization token.
     * @member SpeechConfig.fromEndpoint
     * @function
     * @public
     * @param {URL} endpoint - The service endpoint to connect to.
     * @param {string} subscriptionKey - The subscription key. If a subscription key is not specified, an authorization token must be set.
     * @returns {SpeechConfig} A speech factory instance.
     */
    static fromEndpoint(endpoint, subscriptionKey) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNull(endpoint, "endpoint");
        const speechImpl = new SpeechConfigImpl();
        speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Endpoint, endpoint.href);
        if (undefined !== subscriptionKey) {
            speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Key, subscriptionKey);
        }
        return speechImpl;
    }
    /**
     * Creates an instance of the speech config with specified host and subscription key.
     * This method is intended only for users who use a non-default service host. Standard resource path will be assumed.
     * For services with a non-standard resource path or no path at all, use fromEndpoint instead.
     * Note: Query parameters are not allowed in the host URI and must be set by other APIs.
     * Note: To use an authorization token with fromHost, use fromHost(URL),
     * and then set the AuthorizationToken property on the created SpeechConfig instance.
     * Note: Added in version 1.9.0.
     * @member SpeechConfig.fromHost
     * @function
     * @public
     * @param {URL} host - The service endpoint to connect to. Format is "protocol://host:port" where ":port" is optional.
     * @param {string} subscriptionKey - The subscription key. If a subscription key is not specified, an authorization token must be set.
     * @returns {SpeechConfig} A speech factory instance.
     */
    static fromHost(hostName, subscriptionKey) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNull(hostName, "hostName");
        const speechImpl = new SpeechConfigImpl();
        speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Host, hostName.protocol + "//" + hostName.hostname + (hostName.port === "" ? "" : ":" + hostName.port));
        if (undefined !== subscriptionKey) {
            speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Key, subscriptionKey);
        }
        return speechImpl;
    }
    /**
     * Creates an instance of the speech factory with specified initial authorization token and region.
     * Note: The caller needs to ensure that the authorization token is valid. Before the authorization token
     * expires, the caller needs to refresh it by calling this setter with a new valid token.
     * Note: Please use a token derived from your LanguageUnderstanding subscription key in case you want
     * to use the Intent recognizer. As configuration values are copied when creating a new recognizer,
     * the new token value will not apply to recognizers that have already been created. For recognizers
     * that have been created before, you need to set authorization token of the corresponding recognizer
     * to refresh the token. Otherwise, the recognizers will encounter errors during recognition.
     * @member SpeechConfig.fromAuthorizationToken
     * @function
     * @public
     * @param {string} authorizationToken - The initial authorization token.
     * @param {string} region - The region name (see the <a href="https://aka.ms/csspeech/region">region page</a>).
     * @returns {SpeechConfig} A speech factory instance.
     */
    static fromAuthorizationToken(authorizationToken, region) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNull(authorizationToken, "authorizationToken");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(region, "region");
        const speechImpl = new SpeechConfigImpl();
        speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Region, region);
        speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_IntentRegion, region);
        speechImpl.authorizationToken = authorizationToken;
        return speechImpl;
    }
    /**
     * Closes the configuration.
     * @member SpeechConfig.prototype.close
     * @function
     * @public
     */
    // eslint-disable-next-line @typescript-eslint/no-empty-function
    close() { }
}
/**
 * @public
 * @class SpeechConfigImpl
 */
class SpeechConfigImpl extends SpeechConfig {
    constructor() {
        super();
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyCollection();
        this.speechRecognitionLanguage = "en-US"; // Should we have a default?
        this.outputFormat = _Exports__WEBPACK_IMPORTED_MODULE_3__.OutputFormat.Simple;
    }
    get properties() {
        return this.privProperties;
    }
    get endPoint() {
        return new URL(this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Endpoint));
    }
    get subscriptionKey() {
        return this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Key);
    }
    get region() {
        return this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Region);
    }
    get authorizationToken() {
        return this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceAuthorization_Token);
    }
    set authorizationToken(value) {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceAuthorization_Token, value);
    }
    get speechRecognitionLanguage() {
        return this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_RecoLanguage);
    }
    set speechRecognitionLanguage(value) {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_RecoLanguage, value);
    }
    get autoDetectSourceLanguages() {
        return this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages);
    }
    set autoDetectSourceLanguages(value) {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages, value);
    }
    get outputFormat() {
        return _Exports__WEBPACK_IMPORTED_MODULE_3__.OutputFormat[this.privProperties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.OutputFormatPropertyName, undefined)];
    }
    set outputFormat(value) {
        this.privProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.OutputFormatPropertyName, _Exports__WEBPACK_IMPORTED_MODULE_3__.OutputFormat[value]);
    }
    get endpointId() {
        return this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_EndpointId);
    }
    set endpointId(value) {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_EndpointId, value);
    }
    setProperty(name, value) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNull(value, "value");
        this.privProperties.setProperty(name, value);
    }
    getProperty(name, def) {
        return this.privProperties.getProperty(name, def);
    }
    setProxy(proxyHostName, proxyPort, proxyUserName, proxyPassword) {
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_ProxyHostName], proxyHostName);
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_ProxyPort], proxyPort);
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_ProxyUserName], proxyUserName);
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_ProxyPassword], proxyPassword);
    }
    setServiceProperty(name, value) {
        const currentProperties = JSON.parse(this.privProperties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ServicePropertiesPropertyName, "{}"));
        currentProperties[name] = value;
        this.privProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ServicePropertiesPropertyName, JSON.stringify(currentProperties));
    }
    setProfanity(profanity) {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceResponse_ProfanityOption, _Exports__WEBPACK_IMPORTED_MODULE_5__.ProfanityOption[profanity]);
    }
    enableAudioLogging() {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_EnableAudioLogging, "true");
    }
    requestWordLevelTimestamps() {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps, "true");
    }
    enableDictation() {
        this.privProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ForceDictationPropertyName, "true");
    }
    clone() {
        const ret = new SpeechConfigImpl();
        ret.privProperties = this.privProperties.clone();
        return ret;
    }
    get speechSynthesisLanguage() {
        return this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_SynthLanguage);
    }
    set speechSynthesisLanguage(language) {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_SynthLanguage, language);
    }
    get speechSynthesisVoiceName() {
        return this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_SynthVoice);
    }
    set speechSynthesisVoiceName(voice) {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_SynthVoice, voice);
    }
    get speechSynthesisOutputFormat() {
        return _Exports__WEBPACK_IMPORTED_MODULE_6__.SpeechSynthesisOutputFormat[this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_SynthOutputFormat, undefined)];
    }
    set speechSynthesisOutputFormat(format) {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_SynthOutputFormat, _Exports__WEBPACK_IMPORTED_MODULE_6__.SpeechSynthesisOutputFormat[format]);
    }
}

//# sourceMappingURL=SpeechConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionCanceledEventArgs.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionCanceledEventArgs.js ***!
  \**************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechRecognitionCanceledEventArgs": () => (/* binding */ SpeechRecognitionCanceledEventArgs)
/* harmony export */ });
/* harmony import */ var _CancellationEventArgsBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CancellationEventArgsBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationEventArgsBase.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class SpeechRecognitionCanceledEventArgs extends _CancellationEventArgsBase__WEBPACK_IMPORTED_MODULE_0__.CancellationEventArgsBase {
}

//# sourceMappingURL=SpeechRecognitionCanceledEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionEventArgs.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionEventArgs.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationTranscriptionEventArgs": () => (/* binding */ ConversationTranscriptionEventArgs),
/* harmony export */   "SpeechRecognitionEventArgs": () => (/* binding */ SpeechRecognitionEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */

/**
 * Defines contents of speech recognizing/recognized event.
 * @class SpeechRecognitionEventArgs
 */
class SpeechRecognitionEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.RecognitionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {SpeechRecognitionResult} result - The speech recognition result.
     * @param {number} offset - The offset.
     * @param {string} sessionId - The session id.
     */
    constructor(result, offset, sessionId) {
        super(offset, sessionId);
        this.privResult = result;
    }
    /**
     * Specifies the recognition result.
     * @member SpeechRecognitionEventArgs.prototype.result
     * @function
     * @public
     * @returns {SpeechRecognitionResult} the recognition result.
     */
    get result() {
        return this.privResult;
    }
}
/**
 * Defines contents of conversation transcribed/transcribing event.
 * @class ConversationTranscriptionEventArgs
 */
class ConversationTranscriptionEventArgs extends SpeechRecognitionEventArgs {
}

//# sourceMappingURL=SpeechRecognitionEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionResult.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionResult.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechRecognitionResult": () => (/* binding */ SpeechRecognitionResult)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionResult.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Defines result of speech recognition.
 * @class SpeechRecognitionResult
 */
class SpeechRecognitionResult extends _Exports__WEBPACK_IMPORTED_MODULE_0__.RecognitionResult {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @public
     * @param {string} resultId - The result id.
     * @param {ResultReason} reason - The reason.
     * @param {string} text - The recognized text.
     * @param {number} duration - The duration.
     * @param {number} offset - The offset into the stream.
     * @param {string} language - Primary Language detected, if provided.
     * @param {string} languageDetectionConfidence - Primary Language confidence ("Unknown," "Low," "Medium," "High"...), if provided.
     * @param {string} speakerId - speaker id for conversation transcription, if provided.
     * @param {string} errorDetails - Error details, if provided.
     * @param {string} json - Additional Json, if provided.
     * @param {PropertyCollection} properties - Additional properties, if provided.
     */
    constructor(resultId, reason, text, duration, offset, language, languageDetectionConfidence, speakerId, errorDetails, json, properties) {
        super(resultId, reason, text, duration, offset, language, languageDetectionConfidence, errorDetails, json, properties);
        this.privSpeakerId = speakerId;
    }
    /**
     * speaker id from conversation transcription/id scenarios
     * @member SpeechRecognitionResult.prototype.speakerId
     * @function
     * @public
     * @returns {string} id of speaker in given result
     */
    get speakerId() {
        return this.privSpeakerId;
    }
}

//# sourceMappingURL=SpeechRecognitionResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognizer.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognizer.js ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechRecognizer": () => (/* binding */ SpeechRecognizer)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionFactory.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechServiceRecognizer.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




/**
 * Performs speech recognition from microphone, file, or other audio input streams, and gets transcribed text as result.
 * @class SpeechRecognizer
 */
class SpeechRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.Recognizer {
    /**
     * SpeechRecognizer constructor.
     * @constructor
     * @param {SpeechConfig} speechConfig - an set of initial properties for this recognizer
     * @param {AudioConfig} audioConfig - An optional audio configuration associated with the recognizer
     */
    constructor(speechConfig, audioConfig) {
        const speechConfigImpl = speechConfig;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(speechConfigImpl, "speechConfig");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(speechConfigImpl.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage), _Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage]);
        super(audioConfig, speechConfigImpl.properties, new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.SpeechConnectionFactory());
        this.privDisposedRecognizer = false;
    }
    /**
     * SpeechRecognizer constructor.
     * @constructor
     * @param {SpeechConfig} speechConfig - an set of initial properties for this recognizer
     * @param {AutoDetectSourceLanguageConfig} autoDetectSourceLanguageConfig - An source language detection configuration associated with the recognizer
     * @param {AudioConfig} audioConfig - An optional audio configuration associated with the recognizer
     */
    static FromConfig(speechConfig, autoDetectSourceLanguageConfig, audioConfig) {
        const speechConfigImpl = speechConfig;
        autoDetectSourceLanguageConfig.properties.mergeTo(speechConfigImpl.properties);
        const recognizer = new SpeechRecognizer(speechConfig, audioConfig);
        return recognizer;
    }
    /**
     * Gets the endpoint id of a customized speech model that is used for speech recognition.
     * @member SpeechRecognizer.prototype.endpointId
     * @function
     * @public
     * @returns {string} the endpoint id of a customized speech model that is used for speech recognition.
     */
    get endpointId() {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedRecognizer);
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_EndpointId, "00000000-0000-0000-0000-000000000000");
    }
    /**
     * Gets the authorization token used to communicate with the service.
     * @member SpeechRecognizer.prototype.authorizationToken
     * @function
     * @public
     * @returns {string} Authorization token.
     */
    get authorizationToken() {
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token);
    }
    /**
     * Gets/Sets the authorization token used to communicate with the service.
     * @member SpeechRecognizer.prototype.authorizationToken
     * @function
     * @public
     * @param {string} token - Authorization token.
     */
    set authorizationToken(token) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(token, "token");
        this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token, token);
    }
    /**
     * Gets the spoken language of recognition.
     * @member SpeechRecognizer.prototype.speechRecognitionLanguage
     * @function
     * @public
     * @returns {string} The spoken language of recognition.
     */
    get speechRecognitionLanguage() {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedRecognizer);
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage);
    }
    /**
     * Gets the output format of recognition.
     * @member SpeechRecognizer.prototype.outputFormat
     * @function
     * @public
     * @returns {OutputFormat} The output format of recognition.
     */
    get outputFormat() {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedRecognizer);
        if (this.properties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.OutputFormatPropertyName, _Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormat[_Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormat.Simple]) === _Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormat[_Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormat.Simple]) {
            return _Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormat.Simple;
        }
        else {
            return _Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormat.Detailed;
        }
    }
    /**
     * The collection of properties and their values defined for this SpeechRecognizer.
     * @member SpeechRecognizer.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The collection of properties and their values defined for this SpeechRecognizer.
     */
    get properties() {
        return this.privProperties;
    }
    /**
     * Starts speech recognition, and stops after the first utterance is recognized.
     * The task returns the recognition text as result.
     * Note: RecognizeOnceAsync() returns when the first utterance has been recognized,
     * so it is suitable only for single shot recognition
     * like command or query. For long-running recognition, use StartContinuousRecognitionAsync() instead.
     * @member SpeechRecognizer.prototype.recognizeOnceAsync
     * @function
     * @public
     * @param cb - Callback that received the SpeechRecognitionResult.
     * @param err - Callback invoked in case of an error.
     */
    recognizeOnceAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_6__.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__.RecognitionMode.Interactive), cb, err);
    }
    /**
     * Starts speech recognition, until stopContinuousRecognitionAsync() is called.
     * User must subscribe to events to receive recognition results.
     * @member SpeechRecognizer.prototype.startContinuousRecognitionAsync
     * @function
     * @public
     * @param cb - Callback invoked once the recognition has started.
     * @param err - Callback invoked in case of an error.
     */
    startContinuousRecognitionAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_6__.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__.RecognitionMode.Conversation), cb, err);
    }
    /**
     * Stops continuous speech recognition.
     * @member SpeechRecognizer.prototype.stopContinuousRecognitionAsync
     * @function
     * @public
     * @param cb - Callback invoked once the recognition has stopped.
     * @param err - Callback invoked in case of an error.
     */
    stopContinuousRecognitionAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_6__.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(), cb, err);
    }
    /**
     * Starts speech recognition with keyword spotting, until
     * stopKeywordRecognitionAsync() is called.
     * User must subscribe to events to receive recognition results.
     * Note: Key word spotting functionality is only available on the
     * Speech Devices SDK. This functionality is currently not included in the SDK itself.
     * @member SpeechRecognizer.prototype.startKeywordRecognitionAsync
     * @function
     * @public
     * @param {KeywordRecognitionModel} model The keyword recognition model that
     * specifies the keyword to be recognized.
     * @param cb - Callback invoked once the recognition has started.
     * @param err - Callback invoked in case of an error.
     */
    startKeywordRecognitionAsync(model, cb, err) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(model, "model");
        if (!!err) {
            err("Not yet implemented.");
        }
    }
    /**
     * Stops continuous speech recognition.
     * Note: Key word spotting functionality is only available on the
     * Speech Devices SDK. This functionality is currently not included in the SDK itself.
     * @member SpeechRecognizer.prototype.stopKeywordRecognitionAsync
     * @function
     * @public
     * @param cb - Callback invoked once the recognition has stopped.
     * @param err - Callback invoked in case of an error.
     */
    stopKeywordRecognitionAsync(cb) {
        if (!!cb) {
            cb();
        }
    }
    /**
     * closes all external resources held by an instance of this class.
     * @member SpeechRecognizer.prototype.close
     * @function
     * @public
     */
    close(cb, errorCb) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedRecognizer);
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_6__.marshalPromiseToCallbacks)(this.dispose(true), cb, errorCb);
    }
    /**
     * Disposes any resources held by the object.
     * @member SpeechRecognizer.prototype.dispose
     * @function
     * @public
     * @param {boolean} disposing - true if disposing the object.
     */
    dispose(disposing) {
        const _super = Object.create(null, {
            dispose: { get: () => super.dispose }
        });
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privDisposedRecognizer) {
                return;
            }
            if (disposing) {
                this.privDisposedRecognizer = true;
                yield this.implRecognizerStop();
            }
            yield _super.dispose.call(this, disposing);
        });
    }
    createRecognizerConfig(speechConfig) {
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__.RecognizerConfig(speechConfig, this.privProperties);
    }
    createServiceRecognizer(authentication, connectionFactory, audioConfig, recognizerConfig) {
        const configImpl = audioConfig;
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__.SpeechServiceRecognizer(authentication, connectionFactory, configImpl, recognizerConfig, this);
    }
}

//# sourceMappingURL=SpeechRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisBookmarkEventArgs.js":
/*!************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisBookmarkEventArgs.js ***!
  \************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechSynthesisBookmarkEventArgs": () => (/* binding */ SpeechSynthesisBookmarkEventArgs)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines contents of speech synthesis bookmark event.
 * @class SpeechSynthesisBookmarkEventArgs
 * Added in version 1.16.0
 */
class SpeechSynthesisBookmarkEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {number} audioOffset - The audio offset.
     * @param {string} text - The bookmark text.
     */
    constructor(audioOffset, text) {
        this.privAudioOffset = audioOffset;
        this.privText = text;
    }
    /**
     * Specifies the audio offset.
     * @member SpeechSynthesisBookmarkEventArgs.prototype.audioOffset
     * @function
     * @public
     * @returns {number} the audio offset.
     */
    get audioOffset() {
        return this.privAudioOffset;
    }
    /**
     * Specifies the bookmark.
     * @member SpeechSynthesisBookmarkEventArgs.prototype.text
     * @function
     * @public
     * @returns {string} the bookmark text.
     */
    get text() {
        return this.privText;
    }
}

//# sourceMappingURL=SpeechSynthesisBookmarkEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisBoundaryType.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisBoundaryType.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechSynthesisBoundaryType": () => (/* binding */ SpeechSynthesisBoundaryType)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines the boundary type of speech synthesis boundary event.
 * @class SpeechSynthesisBoundaryType
 * Added in version 1.21.0
 */
var SpeechSynthesisBoundaryType;
(function (SpeechSynthesisBoundaryType) {
    /**
     * Indicates the boundary text is a word.
     * @member SpeechSynthesisBoundaryType.Word
     */
    SpeechSynthesisBoundaryType["Word"] = "WordBoundary";
    /**
     * Indicates the boundary text is a punctuation.
     * @member SpeechSynthesisBoundaryType.Punctuation
     */
    SpeechSynthesisBoundaryType["Punctuation"] = "PunctuationBoundary";
    /**
     * Indicates the boundary text is a sentence.
     * @member SpeechSynthesisBoundaryType.Sentence
     */
    SpeechSynthesisBoundaryType["Sentence"] = "SentenceBoundary";
})(SpeechSynthesisBoundaryType || (SpeechSynthesisBoundaryType = {}));

//# sourceMappingURL=SpeechSynthesisBoundaryType.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisEventArgs.js":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisEventArgs.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechSynthesisEventArgs": () => (/* binding */ SpeechSynthesisEventArgs)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines contents of speech synthesis events.
 * @class SpeechSynthesisEventArgs
 * Added in version 1.11.0
 */
class SpeechSynthesisEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {SpeechSynthesisResult} result - The speech synthesis result.
     */
    constructor(result) {
        this.privResult = result;
    }
    /**
     * Specifies the synthesis result.
     * @member SpeechSynthesisEventArgs.prototype.result
     * @function
     * @public
     * @returns {SpeechSynthesisResult} the synthesis result.
     */
    get result() {
        return this.privResult;
    }
}

//# sourceMappingURL=SpeechSynthesisEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisOutputFormat.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisOutputFormat.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechSynthesisOutputFormat": () => (/* binding */ SpeechSynthesisOutputFormat)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Define speech synthesis audio output formats.
 * @enum SpeechSynthesisOutputFormat
 * Updated in version 1.17.0
 */
var SpeechSynthesisOutputFormat;
(function (SpeechSynthesisOutputFormat) {
    /**
     * raw-8khz-8bit-mono-mulaw
     * @member SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw,
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw8Khz8BitMonoMULaw"] = 0] = "Raw8Khz8BitMonoMULaw";
    /**
     * riff-16khz-16kbps-mono-siren
     * @note Unsupported by the service. Do not use this value.
     * @member SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Riff16Khz16KbpsMonoSiren"] = 1] = "Riff16Khz16KbpsMonoSiren";
    /**
     * audio-16khz-16kbps-mono-siren
     * @note Unsupported by the service. Do not use this value.
     * @member SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio16Khz16KbpsMonoSiren"] = 2] = "Audio16Khz16KbpsMonoSiren";
    /**
     * audio-16khz-32kbitrate-mono-mp3
     * @member SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio16Khz32KBitRateMonoMp3"] = 3] = "Audio16Khz32KBitRateMonoMp3";
    /**
     * audio-16khz-128kbitrate-mono-mp3
     * @member SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio16Khz128KBitRateMonoMp3"] = 4] = "Audio16Khz128KBitRateMonoMp3";
    /**
     * audio-16khz-64kbitrate-mono-mp3
     * @member SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio16Khz64KBitRateMonoMp3"] = 5] = "Audio16Khz64KBitRateMonoMp3";
    /**
     * audio-24khz-48kbitrate-mono-mp3
     * @member SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio24Khz48KBitRateMonoMp3"] = 6] = "Audio24Khz48KBitRateMonoMp3";
    /**
     * audio-24khz-96kbitrate-mono-mp3
     * @member SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio24Khz96KBitRateMonoMp3"] = 7] = "Audio24Khz96KBitRateMonoMp3";
    /**
     * audio-24khz-160kbitrate-mono-mp3
     * @member SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio24Khz160KBitRateMonoMp3"] = 8] = "Audio24Khz160KBitRateMonoMp3";
    /**
     * raw-16khz-16bit-mono-truesilk
     * @member SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw16Khz16BitMonoTrueSilk"] = 9] = "Raw16Khz16BitMonoTrueSilk";
    /**
     * riff-16khz-16bit-mono-pcm
     * @member SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Riff16Khz16BitMonoPcm"] = 10] = "Riff16Khz16BitMonoPcm";
    /**
     * riff-8khz-16bit-mono-pcm
     * @member SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Riff8Khz16BitMonoPcm"] = 11] = "Riff8Khz16BitMonoPcm";
    /**
     * riff-24khz-16bit-mono-pcm
     * @member SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Riff24Khz16BitMonoPcm"] = 12] = "Riff24Khz16BitMonoPcm";
    /**
     * riff-8khz-8bit-mono-mulaw
     * @member SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Riff8Khz8BitMonoMULaw"] = 13] = "Riff8Khz8BitMonoMULaw";
    /**
     * raw-16khz-16bit-mono-pcm
     * @member SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw16Khz16BitMonoPcm"] = 14] = "Raw16Khz16BitMonoPcm";
    /**
     * raw-24khz-16bit-mono-pcm
     * @member SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw24Khz16BitMonoPcm"] = 15] = "Raw24Khz16BitMonoPcm";
    /**
     * raw-8khz-16bit-mono-pcm
     * @member SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw8Khz16BitMonoPcm"] = 16] = "Raw8Khz16BitMonoPcm";
    /**
     * ogg-16khz-16bit-mono-opus
     * @member SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Ogg16Khz16BitMonoOpus"] = 17] = "Ogg16Khz16BitMonoOpus";
    /**
     * ogg-24khz-16bit-mono-opus
     * @member SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Ogg24Khz16BitMonoOpus"] = 18] = "Ogg24Khz16BitMonoOpus";
    /**
     * raw-48khz-16bit-mono-pcm
     * @member SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw48Khz16BitMonoPcm"] = 19] = "Raw48Khz16BitMonoPcm";
    /**
     * riff-48khz-16bit-mono-pcm
     * @member SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Riff48Khz16BitMonoPcm"] = 20] = "Riff48Khz16BitMonoPcm";
    /**
     * audio-48khz-96kbitrate-mono-mp3
     * @member SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio48Khz96KBitRateMonoMp3"] = 21] = "Audio48Khz96KBitRateMonoMp3";
    /**
     * audio-48khz-192kbitrate-mono-mp3
     * @member SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio48Khz192KBitRateMonoMp3"] = 22] = "Audio48Khz192KBitRateMonoMp3";
    /**
     * ogg-48khz-16bit-mono-opus
     * Added in version 1.16.0
     * @member SpeechSynthesisOutputFormat.Ogg48Khz16BitMonoOpus
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Ogg48Khz16BitMonoOpus"] = 23] = "Ogg48Khz16BitMonoOpus";
    /**
     * webm-16khz-16bit-mono-opus
     * Added in version 1.16.0
     * @member SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Webm16Khz16BitMonoOpus"] = 24] = "Webm16Khz16BitMonoOpus";
    /**
     * webm-24khz-16bit-mono-opus
     * Added in version 1.16.0
     * @member SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Webm24Khz16BitMonoOpus"] = 25] = "Webm24Khz16BitMonoOpus";
    /**
     * raw-24khz-16bit-mono-truesilk
     * Added in version 1.17.0
     * @member SpeechSynthesisOutputFormat.Raw24Khz16BitMonoTrueSilk
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw24Khz16BitMonoTrueSilk"] = 26] = "Raw24Khz16BitMonoTrueSilk";
    /**
     * raw-8khz-8bit-mono-alaw
     * Added in version 1.17.0
     * @member SpeechSynthesisOutputFormat.Raw8Khz8BitMonoALaw
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw8Khz8BitMonoALaw"] = 27] = "Raw8Khz8BitMonoALaw";
    /**
     * riff-8khz-8bit-mono-alaw
     * Added in version 1.17.0
     * @member SpeechSynthesisOutputFormat.Riff8Khz8BitMonoALaw
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Riff8Khz8BitMonoALaw"] = 28] = "Riff8Khz8BitMonoALaw";
    /**
     * webm-24khz-16bit-24kbps-mono-opus
     * Audio compressed by OPUS codec in a webm container, with bitrate of 24kbps, optimized for IoT scenario.
     * Added in version 1.19.0
     * @member SpeechSynthesisOutputFormat.Webm24Khz16Bit24KbpsMonoOpus
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Webm24Khz16Bit24KbpsMonoOpus"] = 29] = "Webm24Khz16Bit24KbpsMonoOpus";
    /**
     * audio-16khz-16bit-32kbps-mono-opus
     * Audio compressed by OPUS codec without container, with bitrate of 32kbps.
     * Added in version 1.20.0
     * @member SpeechSynthesisOutputFormat.Audio16Khz16Bit32KbpsMonoOpus
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio16Khz16Bit32KbpsMonoOpus"] = 30] = "Audio16Khz16Bit32KbpsMonoOpus";
    /**
     * audio-24khz-16bit-48kbps-mono-opus
     * Audio compressed by OPUS codec without container, with bitrate of 48kbps.
     * Added in version 1.20.0
     * @member SpeechSynthesisOutputFormat.Audio24Khz16Bit48KbpsMonoOpus
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio24Khz16Bit48KbpsMonoOpus"] = 31] = "Audio24Khz16Bit48KbpsMonoOpus";
    /**
     * audio-24khz-16bit-24kbps-mono-opus
     * Audio compressed by OPUS codec without container, with bitrate of 24kbps.
     * Added in version 1.20.0
     * @member SpeechSynthesisOutputFormat.Audio24Khz16Bit24KbpsMonoOpus
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio24Khz16Bit24KbpsMonoOpus"] = 32] = "Audio24Khz16Bit24KbpsMonoOpus";
    /**
     * raw-22050hz-16bit-mono-pcm
     * Raw PCM audio at 22050Hz sampling rate and 16-bit depth.
     * Added in version 1.22.0
     * @member SpeechSynthesisOutputFormat.Raw22050Hz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw22050Hz16BitMonoPcm"] = 33] = "Raw22050Hz16BitMonoPcm";
    /**
     * riff-22050hz-16bit-mono-pcm
     * PCM audio at 22050Hz sampling rate and 16-bit depth, with RIFF header.
     * Added in version 1.22.0
     * @member SpeechSynthesisOutputFormat.Riff22050Hz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Riff22050Hz16BitMonoPcm"] = 34] = "Riff22050Hz16BitMonoPcm";
    /**
     * raw-44100hz-16bit-mono-pcm
     * Raw PCM audio at 44100Hz sampling rate and 16-bit depth.
     * Added in version 1.22.0
     * @member SpeechSynthesisOutputFormat.Raw44100Hz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw44100Hz16BitMonoPcm"] = 35] = "Raw44100Hz16BitMonoPcm";
    /**
     * riff-44100hz-16bit-mono-pcm
     * PCM audio at 44100Hz sampling rate and 16-bit depth, with RIFF header.
     * Added in version 1.22.0
     * @member SpeechSynthesisOutputFormat.Riff44100Hz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Riff44100Hz16BitMonoPcm"] = 36] = "Riff44100Hz16BitMonoPcm";
})(SpeechSynthesisOutputFormat || (SpeechSynthesisOutputFormat = {}));

//# sourceMappingURL=SpeechSynthesisOutputFormat.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisResult.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisResult.js ***!
  \*************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechSynthesisResult": () => (/* binding */ SpeechSynthesisResult)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SynthesisResult.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Defines result of speech synthesis.
 * @class SpeechSynthesisResult
 * Added in version 1.11.0
 */
class SpeechSynthesisResult extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SynthesisResult {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {string} resultId - The result id.
     * @param {ResultReason} reason - The reason.
     * @param {ArrayBuffer} audioData - The synthesized audio binary.
     * @param {string} errorDetails - Error details, if provided.
     * @param {PropertyCollection} properties - Additional properties, if provided.
     * @param {number} audioDuration - The audio duration.
     */
    constructor(resultId, reason, audioData, errorDetails, properties, audioDuration) {
        super(resultId, reason, errorDetails, properties);
        this.privAudioData = audioData;
        this.privAudioDuration = audioDuration;
    }
    /**
     * The synthesized audio data
     * @member SpeechSynthesisResult.prototype.audioData
     * @function
     * @public
     * @returns {ArrayBuffer} The synthesized audio data.
     */
    get audioData() {
        return this.privAudioData;
    }
    /**
     * The time duration of synthesized audio, in ticks (100 nanoseconds).
     * @member SpeechSynthesisResult.prototype.audioDuration
     * @function
     * @public
     * @returns {number} The time duration of synthesized audio.
     */
    get audioDuration() {
        return this.privAudioDuration;
    }
}

//# sourceMappingURL=SpeechSynthesisResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisVisemeEventArgs.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisVisemeEventArgs.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechSynthesisVisemeEventArgs": () => (/* binding */ SpeechSynthesisVisemeEventArgs)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines contents of speech synthesis viseme event.
 * @class SpeechSynthesisVisemeEventArgs
 * Added in version 1.16.0
 */
class SpeechSynthesisVisemeEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {number} audioOffset - The audio offset.
     * @param {number} visemeId - The viseme ID.
     * @param {string} animation - The animation, could be in svg or other format.
     */
    constructor(audioOffset, visemeId, animation) {
        this.privAudioOffset = audioOffset;
        this.privVisemeId = visemeId;
        this.privAnimation = animation;
    }
    /**
     * Specifies the audio offset.
     * @member SpeechSynthesisVisemeEventArgs.prototype.audioOffset
     * @function
     * @public
     * @returns {number} the audio offset.
     */
    get audioOffset() {
        return this.privAudioOffset;
    }
    /**
     * Specifies the viseme ID.
     * @member SpeechSynthesisVisemeEventArgs.prototype.visemeId
     * @function
     * @public
     * @returns {number} the viseme ID.
     */
    get visemeId() {
        return this.privVisemeId;
    }
    /**
     * Specifies the animation.
     * @member SpeechSynthesisVisemeEventArgs.prototype.animation
     * @function
     * @public
     * @returns {string} the animation, could be in svg or other format.
     */
    get animation() {
        return this.privAnimation;
    }
}

//# sourceMappingURL=SpeechSynthesisVisemeEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisWordBoundaryEventArgs.js":
/*!****************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisWordBoundaryEventArgs.js ***!
  \****************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechSynthesisWordBoundaryEventArgs": () => (/* binding */ SpeechSynthesisWordBoundaryEventArgs)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines contents of speech synthesis word boundary event.
 * @class SpeechSynthesisWordBoundaryEventArgs
 * Added in version 1.11.0
 */
class SpeechSynthesisWordBoundaryEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {number} audioOffset - The audio offset.
     * @param {number} duration - The audio duration.
     * @param {string} text - The text.
     * @param {number} wordLength - The length of the word.
     * @param {number} textOffset - The text offset.
     * @param {SpeechSynthesisBoundaryType} boundaryType - The boundary type
     */
    constructor(audioOffset, duration, text, wordLength, textOffset, boundaryType) {
        this.privAudioOffset = audioOffset;
        this.privDuration = duration;
        this.privText = text;
        this.privWordLength = wordLength;
        this.privTextOffset = textOffset;
        this.privBoundaryType = boundaryType;
    }
    /**
     * Specifies the audio offset.
     * @member SpeechSynthesisWordBoundaryEventArgs.prototype.audioOffset
     * @function
     * @public
     * @returns {number} the audio offset.
     */
    get audioOffset() {
        return this.privAudioOffset;
    }
    /**
     * Specifies the duration, in ticks (100 nanoseconds).
     * @member SpeechSynthesisWordBoundaryEventArgs.prototype.duration
     * @function
     * @public
     * @returns {number} Duration in 100 nanosecond increments.
     */
    get duration() {
        return this.privDuration;
    }
    /**
     * Specifies the text of the word boundary event.
     * @member SpeechSynthesisWordBoundaryEventArgs.prototype.text
     * @function
     * @public
     * @returns {string} the text.
     */
    get text() {
        return this.privText;
    }
    /**
     * Specifies the word length
     * @member SpeechSynthesisWordBoundaryEventArgs.prototype.wordLength
     * @function
     * @public
     * @returns {number} the word length
     */
    get wordLength() {
        return this.privWordLength;
    }
    /**
     * Specifies the text offset.
     * @member SpeechSynthesisWordBoundaryEventArgs.prototype.textOffset
     * @function
     * @public
     * @returns {number} the text offset.
     */
    get textOffset() {
        return this.privTextOffset;
    }
    /**
     * Specifies the boundary type.
     * @member SpeechSynthesisWordBoundaryEventArgs.prototype.boundaryType
     * @function
     * @public
     * @returns {SpeechSynthesisBoundaryType} the boundary type.
     */
    get boundaryType() {
        return this.privBoundaryType;
    }
}

//# sourceMappingURL=SpeechSynthesisWordBoundaryEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesizer.js":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesizer.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechSynthesizer": () => (/* binding */ SpeechSynthesizer),
/* harmony export */   "SynthesisRequest": () => (/* binding */ SynthesisRequest)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechSynthesisConnectionFactory.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesizerConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisAdapterBase.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveSubscriptionKeyAuthentication.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveTokenAuthentication.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisRestAdapter.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Queue.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _Audio_AudioFileWriter__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./Audio/AudioFileWriter */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioFileWriter.js");
/* harmony import */ var _Audio_AudioOutputFormat__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./Audio/AudioOutputFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputFormat.js");
/* harmony import */ var _Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputStream.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisOutputFormat.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/PushAudioOutputStreamCallback.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SynthesisVoicesResult.js");
/* eslint-disable @typescript-eslint/no-empty-function */
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};







/**
 * Defines the class SpeechSynthesizer for text to speech.
 * Updated in version 1.16.0
 * @class SpeechSynthesizer
 */
class SpeechSynthesizer {
    /**
     * SpeechSynthesizer constructor.
     * @constructor
     * @param {SpeechConfig} speechConfig - An set of initial properties for this synthesizer.
     * @param {AudioConfig} audioConfig - An optional audio configuration associated with the synthesizer.
     */
    constructor(speechConfig, audioConfig) {
        const speechConfigImpl = speechConfig;
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNull(speechConfigImpl, "speechConfig");
        if (audioConfig !== null) {
            if (audioConfig === undefined) {
                this.audioConfig = (typeof window === "undefined") ? undefined : _Exports__WEBPACK_IMPORTED_MODULE_1__.AudioConfig.fromDefaultSpeakerOutput();
            }
            else {
                this.audioConfig = audioConfig;
            }
        }
        this.privProperties = speechConfigImpl.properties.clone();
        this.privDisposed = false;
        this.privSynthesizing = false;
        this.privConnectionFactory = new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechSynthesisConnectionFactory();
        this.synthesisRequestQueue = new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.Queue();
        this.implCommonSynthesizeSetup();
    }
    /**
     * Gets the authorization token used to communicate with the service.
     * @member SpeechSynthesizer.prototype.authorizationToken
     * @function
     * @public
     * @returns {string} Authorization token.
     */
    get authorizationToken() {
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceAuthorization_Token);
    }
    /**
     * Gets/Sets the authorization token used to communicate with the service.
     * @member SpeechSynthesizer.prototype.authorizationToken
     * @function
     * @public
     * @param {string} token - Authorization token.
     */
    set authorizationToken(token) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(token, "token");
        this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceAuthorization_Token, token);
    }
    /**
     * The collection of properties and their values defined for this SpeechSynthesizer.
     * @member SpeechSynthesizer.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The collection of properties and their values defined for this SpeechSynthesizer.
     */
    get properties() {
        return this.privProperties;
    }
    /**
     * Indicates if auto detect source language is enabled
     * @member SpeechSynthesizer.prototype.properties
     * @function
     * @public
     * @returns {boolean} if auto detect source language is enabled
     */
    get autoDetectSourceLanguage() {
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages) === _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.AutoDetectSourceLanguagesOpenRangeOptionName;
    }
    /**
     * SpeechSynthesizer constructor.
     * @constructor
     * @param {SpeechConfig} speechConfig - an set of initial properties for this synthesizer
     * @param {AutoDetectSourceLanguageConfig} autoDetectSourceLanguageConfig - An source language detection configuration associated with the synthesizer
     * @param {AudioConfig} audioConfig - An optional audio configuration associated with the synthesizer
     */
    static FromConfig(speechConfig, autoDetectSourceLanguageConfig, audioConfig) {
        const speechConfigImpl = speechConfig;
        autoDetectSourceLanguageConfig.properties.mergeTo(speechConfigImpl.properties);
        return new SpeechSynthesizer(speechConfig, audioConfig);
    }
    buildSsml(text) {
        const languageToDefaultVoice = {
            ["af-ZA"]: "af-ZA-AdriNeural",
            ["am-ET"]: "am-ET-AmehaNeural",
            ["ar-AE"]: "ar-AE-FatimaNeural",
            ["ar-BH"]: "ar-BH-AliNeural",
            ["ar-DZ"]: "ar-DZ-AminaNeural",
            ["ar-EG"]: "ar-EG-SalmaNeural",
            ["ar-IQ"]: "ar-IQ-BasselNeural",
            ["ar-JO"]: "ar-JO-SanaNeural",
            ["ar-KW"]: "ar-KW-FahedNeural",
            ["ar-LY"]: "ar-LY-ImanNeural",
            ["ar-MA"]: "ar-MA-JamalNeural",
            ["ar-QA"]: "ar-QA-AmalNeural",
            ["ar-SA"]: "ar-SA-HamedNeural",
            ["ar-SY"]: "ar-SY-AmanyNeural",
            ["ar-TN"]: "ar-TN-HediNeural",
            ["ar-YE"]: "ar-YE-MaryamNeural",
            ["bg-BG"]: "bg-BG-BorislavNeural",
            ["bn-BD"]: "bn-BD-NabanitaNeural",
            ["bn-IN"]: "bn-IN-BashkarNeural",
            ["ca-ES"]: "ca-ES-JoanaNeural",
            ["cs-CZ"]: "cs-CZ-AntoninNeural",
            ["cy-GB"]: "cy-GB-AledNeural",
            ["da-DK"]: "da-DK-ChristelNeural",
            ["de-AT"]: "de-AT-IngridNeural",
            ["de-CH"]: "de-CH-JanNeural",
            ["de-DE"]: "de-DE-KatjaNeural",
            ["el-GR"]: "el-GR-AthinaNeural",
            ["en-AU"]: "en-AU-NatashaNeural",
            ["en-CA"]: "en-CA-ClaraNeural",
            ["en-GB"]: "en-GB-LibbyNeural",
            ["en-HK"]: "en-HK-SamNeural",
            ["en-IE"]: "en-IE-ConnorNeural",
            ["en-IN"]: "en-IN-NeerjaNeural",
            ["en-KE"]: "en-KE-AsiliaNeural",
            ["en-NG"]: "en-NG-AbeoNeural",
            ["en-NZ"]: "en-NZ-MitchellNeural",
            ["en-PH"]: "en-PH-JamesNeural",
            ["en-SG"]: "en-SG-LunaNeural",
            ["en-TZ"]: "en-TZ-ElimuNeural",
            ["en-US"]: "en-US-JennyNeural",
            ["en-ZA"]: "en-ZA-LeahNeural",
            ["es-AR"]: "es-AR-ElenaNeural",
            ["es-BO"]: "es-BO-MarceloNeural",
            ["es-CL"]: "es-CL-CatalinaNeural",
            ["es-CO"]: "es-CO-GonzaloNeural",
            ["es-CR"]: "es-CR-JuanNeural",
            ["es-CU"]: "es-CU-BelkysNeural",
            ["es-DO"]: "es-DO-EmilioNeural",
            ["es-EC"]: "es-EC-AndreaNeural",
            ["es-ES"]: "es-ES-AlvaroNeural",
            ["es-GQ"]: "es-GQ-JavierNeural",
            ["es-GT"]: "es-GT-AndresNeural",
            ["es-HN"]: "es-HN-CarlosNeural",
            ["es-MX"]: "es-MX-DaliaNeural",
            ["es-NI"]: "es-NI-FedericoNeural",
            ["es-PA"]: "es-PA-MargaritaNeural",
            ["es-PE"]: "es-PE-AlexNeural",
            ["es-PR"]: "es-PR-KarinaNeural",
            ["es-PY"]: "es-PY-MarioNeural",
            ["es-SV"]: "es-SV-LorenaNeural",
            ["es-US"]: "es-US-AlonsoNeural",
            ["es-UY"]: "es-UY-MateoNeural",
            ["es-VE"]: "es-VE-PaolaNeural",
            ["et-EE"]: "et-EE-AnuNeural",
            ["fa-IR"]: "fa-IR-DilaraNeural",
            ["fi-FI"]: "fi-FI-SelmaNeural",
            ["fil-PH"]: "fil-PH-AngeloNeural",
            ["fr-BE"]: "fr-BE-CharlineNeural",
            ["fr-CA"]: "fr-CA-SylvieNeural",
            ["fr-CH"]: "fr-CH-ArianeNeural",
            ["fr-FR"]: "fr-FR-DeniseNeural",
            ["ga-IE"]: "ga-IE-ColmNeural",
            ["gl-ES"]: "gl-ES-RoiNeural",
            ["gu-IN"]: "gu-IN-DhwaniNeural",
            ["he-IL"]: "he-IL-AvriNeural",
            ["hi-IN"]: "hi-IN-MadhurNeural",
            ["hr-HR"]: "hr-HR-GabrijelaNeural",
            ["hu-HU"]: "hu-HU-NoemiNeural",
            ["id-ID"]: "id-ID-ArdiNeural",
            ["is-IS"]: "is-IS-GudrunNeural",
            ["it-IT"]: "it-IT-IsabellaNeural",
            ["ja-JP"]: "ja-JP-NanamiNeural",
            ["jv-ID"]: "jv-ID-DimasNeural",
            ["kk-KZ"]: "kk-KZ-AigulNeural",
            ["km-KH"]: "km-KH-PisethNeural",
            ["kn-IN"]: "kn-IN-GaganNeural",
            ["ko-KR"]: "ko-KR-SunHiNeural",
            ["lo-LA"]: "lo-LA-ChanthavongNeural",
            ["lt-LT"]: "lt-LT-LeonasNeural",
            ["lv-LV"]: "lv-LV-EveritaNeural",
            ["mk-MK"]: "mk-MK-AleksandarNeural",
            ["ml-IN"]: "ml-IN-MidhunNeural",
            ["mr-IN"]: "mr-IN-AarohiNeural",
            ["ms-MY"]: "ms-MY-OsmanNeural",
            ["mt-MT"]: "mt-MT-GraceNeural",
            ["my-MM"]: "my-MM-NilarNeural",
            ["nb-NO"]: "nb-NO-PernilleNeural",
            ["nl-BE"]: "nl-BE-ArnaudNeural",
            ["nl-NL"]: "nl-NL-ColetteNeural",
            ["pl-PL"]: "pl-PL-AgnieszkaNeural",
            ["ps-AF"]: "ps-AF-GulNawazNeural",
            ["pt-BR"]: "pt-BR-FranciscaNeural",
            ["pt-PT"]: "pt-PT-DuarteNeural",
            ["ro-RO"]: "ro-RO-AlinaNeural",
            ["ru-RU"]: "ru-RU-SvetlanaNeural",
            ["si-LK"]: "si-LK-SameeraNeural",
            ["sk-SK"]: "sk-SK-LukasNeural",
            ["sl-SI"]: "sl-SI-PetraNeural",
            ["so-SO"]: "so-SO-MuuseNeural",
            ["sr-RS"]: "sr-RS-NicholasNeural",
            ["su-ID"]: "su-ID-JajangNeural",
            ["sv-SE"]: "sv-SE-SofieNeural",
            ["sw-KE"]: "sw-KE-RafikiNeural",
            ["sw-TZ"]: "sw-TZ-DaudiNeural",
            ["ta-IN"]: "ta-IN-PallaviNeural",
            ["ta-LK"]: "ta-LK-KumarNeural",
            ["ta-SG"]: "ta-SG-AnbuNeural",
            ["te-IN"]: "te-IN-MohanNeural",
            ["th-TH"]: "th-TH-PremwadeeNeural",
            ["tr-TR"]: "tr-TR-AhmetNeural",
            ["uk-UA"]: "uk-UA-OstapNeural",
            ["ur-IN"]: "ur-IN-GulNeural",
            ["ur-PK"]: "ur-PK-AsadNeural",
            ["uz-UZ"]: "uz-UZ-MadinaNeural",
            ["vi-VN"]: "vi-VN-HoaiMyNeural",
            ["zh-CN"]: "zh-CN-XiaoxiaoNeural",
            ["zh-HK"]: "zh-HK-HiuMaanNeural",
            ["zh-TW"]: "zh-TW-HsiaoChenNeural",
            ["zu-ZA"]: "zu-ZA-ThandoNeural",
        };
        let language = this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceConnection_SynthLanguage, "en-US");
        let voice = this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceConnection_SynthVoice, "");
        let ssml = SpeechSynthesizer.XMLEncode(text);
        if (this.autoDetectSourceLanguage) {
            language = "en-US";
        }
        else {
            voice = voice || languageToDefaultVoice[language];
        }
        if (voice) {
            ssml = `<voice name='${voice}'>${ssml}</voice>`;
        }
        ssml = `<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${language}'>${ssml}</speak>`;
        return ssml;
    }
    /**
     * Executes speech synthesis on plain text.
     * The task returns the synthesis result.
     * @member SpeechSynthesizer.prototype.speakTextAsync
     * @function
     * @public
     * @param text - Text to be synthesized.
     * @param cb - Callback that received the SpeechSynthesisResult.
     * @param err - Callback invoked in case of an error.
     * @param stream - AudioOutputStream to receive the synthesized audio.
     */
    speakTextAsync(text, cb, err, stream) {
        this.speakImpl(text, false, cb, err, stream);
    }
    /**
     * Executes speech synthesis on SSML.
     * The task returns the synthesis result.
     * @member SpeechSynthesizer.prototype.speakSsmlAsync
     * @function
     * @public
     * @param ssml - SSML to be synthesized.
     * @param cb - Callback that received the SpeechSynthesisResult.
     * @param err - Callback invoked in case of an error.
     * @param stream - AudioOutputStream to receive the synthesized audio.
     */
    speakSsmlAsync(ssml, cb, err, stream) {
        this.speakImpl(ssml, true, cb, err, stream);
    }
    /**
     * Get list of synthesis voices available.
     * The task returns the synthesis voice result.
     * @member SpeechSynthesizer.prototype.getVoicesAsync
     * @function
     * @async
     * @public
     * @param locale - Locale of voices in BCP-47 format; if left empty, get all available voices.
     * @return {Promise<SynthesisVoicesResult>} - Promise of a SynthesisVoicesResult.
     */
    getVoicesAsync(locale = "") {
        return __awaiter(this, void 0, void 0, function* () {
            return this.getVoices(locale);
        });
    }
    /**
     * Dispose of associated resources.
     * @member SpeechSynthesizer.prototype.close
     * @function
     * @public
     */
    close(cb, err) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privDisposed);
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_6__.marshalPromiseToCallbacks)(this.dispose(true), cb, err);
    }
    /**
     * @Internal
     * Do not use externally, object returned will change without warning or notice.
     */
    get internalData() {
        return this.privAdapter;
    }
    /**
     * This method performs cleanup of resources.
     * The Boolean parameter disposing indicates whether the method is called
     * from Dispose (if disposing is true) or from the finalizer (if disposing is false).
     * Derived classes should override this method to dispose resource if needed.
     * @member SpeechSynthesizer.prototype.dispose
     * @function
     * @public
     * @param {boolean} disposing - Flag to request disposal.
     */
    dispose(disposing) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privDisposed) {
                return;
            }
            if (disposing) {
                if (this.privAdapter) {
                    yield this.privAdapter.dispose();
                }
            }
            this.privDisposed = true;
        });
    }
    //
    // ################################################################################################################
    // IMPLEMENTATION.
    // Move to independent class
    // ################################################################################################################
    //
    createSynthesizerConfig(speechConfig) {
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__.SynthesizerConfig(speechConfig, this.privProperties);
    }
    // Creates the synthesis adapter
    createSynthesisAdapter(authentication, connectionFactory, audioConfig, synthesizerConfig) {
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__.SynthesisAdapterBase(authentication, connectionFactory, synthesizerConfig, this, this.audioConfig);
    }
    implCommonSynthesizeSetup() {
        let osPlatform = (typeof window !== "undefined") ? "Browser" : "Node";
        let osName = "unknown";
        let osVersion = "unknown";
        if (typeof navigator !== "undefined") {
            osPlatform = osPlatform + "/" + navigator.platform;
            osName = navigator.userAgent;
            osVersion = navigator.appVersion;
        }
        const synthesizerConfig = this.createSynthesizerConfig(new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_9__.SpeechServiceConfig(new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_9__.Context(new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_9__.OS(osPlatform, osName, osVersion))));
        const subscriptionKey = this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceConnection_Key, undefined);
        const authentication = (subscriptionKey && subscriptionKey !== "") ?
            new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_10__.CognitiveSubscriptionKeyAuthentication(subscriptionKey) :
            new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_11__.CognitiveTokenAuthentication(() => {
                const authorizationToken = this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceAuthorization_Token, undefined);
                return Promise.resolve(authorizationToken);
            }, () => {
                const authorizationToken = this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceAuthorization_Token, undefined);
                return Promise.resolve(authorizationToken);
            });
        this.privAdapter = this.createSynthesisAdapter(authentication, this.privConnectionFactory, this.audioConfig, synthesizerConfig);
        this.privAdapter.audioOutputFormat = _Audio_AudioOutputFormat__WEBPACK_IMPORTED_MODULE_12__.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(_Exports__WEBPACK_IMPORTED_MODULE_13__.SpeechSynthesisOutputFormat[this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceConnection_SynthOutputFormat, undefined)]);
        this.privRestAdapter = new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_14__.SynthesisRestAdapter(synthesizerConfig, authentication);
    }
    speakImpl(text, IsSsml, cb, err, dataStream) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privDisposed);
            const requestId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_15__.createNoDashGuid)();
            let audioDestination;
            if (dataStream instanceof _Exports__WEBPACK_IMPORTED_MODULE_16__.PushAudioOutputStreamCallback) {
                audioDestination = new _Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_17__.PushAudioOutputStreamImpl(dataStream);
            }
            else if (dataStream instanceof _Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_17__.PullAudioOutputStream) {
                audioDestination = dataStream;
            }
            else if (dataStream !== undefined) {
                audioDestination = new _Audio_AudioFileWriter__WEBPACK_IMPORTED_MODULE_18__.AudioFileWriter(dataStream);
            }
            else {
                audioDestination = undefined;
            }
            this.synthesisRequestQueue.enqueue(new SynthesisRequest(requestId, text, IsSsml, (e) => {
                this.privSynthesizing = false;
                if (!!cb) {
                    try {
                        cb(e);
                    }
                    catch (e) {
                        if (!!err) {
                            err(e);
                        }
                    }
                }
                cb = undefined;
                /* eslint-disable no-empty */
                this.adapterSpeak().catch(() => { });
            }, (e) => {
                if (!!err) {
                    err(e);
                }
            }, audioDestination));
            /* eslint-disable no-empty-function */
            this.adapterSpeak().catch(() => { });
        }
        catch (error) {
            if (!!err) {
                if (error instanceof Error) {
                    const typedError = error;
                    err(typedError.name + ": " + typedError.message);
                }
                else {
                    err(error);
                }
            }
            // Destroy the synthesizer.
            /* eslint-disable no-empty */
            this.dispose(true).catch(() => { });
        }
    }
    getVoices(locale) {
        return __awaiter(this, void 0, void 0, function* () {
            const requestId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_15__.createNoDashGuid)();
            const response = yield this.privRestAdapter.getVoicesList(requestId);
            if (response.ok && Array.isArray(response.json)) {
                let json = response.json;
                if (!!locale && locale.length > 0) {
                    json = json.filter((item) => !!item.Locale && item.Locale.toLowerCase() === locale.toLowerCase());
                }
                return new _Exports__WEBPACK_IMPORTED_MODULE_19__.SynthesisVoicesResult(requestId, json, undefined);
            }
            else {
                return new _Exports__WEBPACK_IMPORTED_MODULE_19__.SynthesisVoicesResult(requestId, undefined, `Error: ${response.status}: ${response.statusText}`);
            }
        });
    }
    adapterSpeak() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.privDisposed && !this.privSynthesizing) {
                this.privSynthesizing = true;
                const request = yield this.synthesisRequestQueue.dequeue();
                return this.privAdapter.Speak(request.text, request.isSSML, request.requestId, request.cb, request.err, request.dataStream);
            }
        });
    }
    static XMLEncode(text) {
        return text.replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/"/g, "&quot;")
            .replace(/'/g, "&apos;");
    }
}
class SynthesisRequest {
    constructor(requestId, text, isSSML, cb, err, dataStream) {
        this.requestId = requestId;
        this.text = text;
        this.isSSML = isSSML;
        this.cb = cb;
        this.err = err;
        this.dataStream = dataStream;
    }
}

//# sourceMappingURL=SpeechSynthesizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechTranslationConfig.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechTranslationConfig.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechTranslationConfig": () => (/* binding */ SpeechTranslationConfig),
/* harmony export */   "SpeechTranslationConfigImpl": () => (/* binding */ SpeechTranslationConfigImpl)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ProfanityOption.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisOutputFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */



/**
 * Speech translation configuration.
 * @class SpeechTranslationConfig
 */
class SpeechTranslationConfig extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SpeechConfig {
    /**
     * Creates an instance of recognizer config.
     */
    constructor() {
        super();
    }
    /**
     * Static instance of SpeechTranslationConfig returned by passing a subscription key and service region.
     * @member SpeechTranslationConfig.fromSubscription
     * @function
     * @public
     * @param {string} subscriptionKey - The subscription key.
     * @param {string} region - The region name (see the <a href="https://aka.ms/csspeech/region">region page</a>).
     * @returns {SpeechTranslationConfig} The speech translation config.
     */
    static fromSubscription(subscriptionKey, region) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(subscriptionKey, "subscriptionKey");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(region, "region");
        const ret = new SpeechTranslationConfigImpl();
        ret.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Key, subscriptionKey);
        ret.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Region, region);
        return ret;
    }
    /**
     * Static instance of SpeechTranslationConfig returned by passing authorization token and service region.
     * Note: The caller needs to ensure that the authorization token is valid. Before the authorization token
     * expires, the caller needs to refresh it by setting the property authorizationToken with a new
     * valid token. Otherwise, all the recognizers created by this SpeechTranslationConfig instance
     * will encounter errors during recognition.
     * As configuration values are copied when creating a new recognizer, the new token value will not apply
     * to recognizers that have already been created.
     * For recognizers that have been created before, you need to set authorization token of the corresponding recognizer
     * to refresh the token. Otherwise, the recognizers will encounter errors during recognition.
     * @member SpeechTranslationConfig.fromAuthorizationToken
     * @function
     * @public
     * @param {string} authorizationToken - The authorization token.
     * @param {string} region - The region name (see the <a href="https://aka.ms/csspeech/region">region page</a>).
     * @returns {SpeechTranslationConfig} The speech translation config.
     */
    static fromAuthorizationToken(authorizationToken, region) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(authorizationToken, "authorizationToken");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(region, "region");
        const ret = new SpeechTranslationConfigImpl();
        ret.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token, authorizationToken);
        ret.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Region, region);
        return ret;
    }
    /**
     * Creates an instance of the speech config with specified host and subscription key.
     * This method is intended only for users who use a non-default service host. Standard resource path will be assumed.
     * For services with a non-standard resource path or no path at all, use fromEndpoint instead.
     * Note: Query parameters are not allowed in the host URI and must be set by other APIs.
     * Note: To use an authorization token with fromHost, use fromHost(URL),
     * and then set the AuthorizationToken property on the created SpeechConfig instance.
     * Note: Added in version 1.9.0.
     * @member SpeechConfig.fromHost
     * @function
     * @public
     * @param {URL} host - The service endpoint to connect to. Format is "protocol://host:port" where ":port" is optional.
     * @param {string} subscriptionKey - The subscription key. If a subscription key is not specified, an authorization token must be set.
     * @returns {SpeechConfig} A speech factory instance.
     */
    static fromHost(hostName, subscriptionKey) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(hostName, "hostName");
        const speechImpl = new SpeechTranslationConfigImpl();
        speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Host, hostName.protocol + "//" + hostName.hostname + (hostName.port === "" ? "" : ":" + hostName.port));
        if (undefined !== subscriptionKey) {
            speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Key, subscriptionKey);
        }
        return speechImpl;
    }
    /**
     * Creates an instance of the speech translation config with specified endpoint and subscription key.
     * This method is intended only for users who use a non-standard service endpoint or paramters.
     * Note: The query properties specified in the endpoint URL are not changed, even if they are
     * set by any other APIs. For example, if language is defined in the uri as query parameter
     * "language=de-DE", and also set by the speechRecognitionLanguage property, the language
     * setting in uri takes precedence, and the effective language is "de-DE".
     * Only the properties that are not specified in the endpoint URL can be set by other APIs.
     * Note: To use authorization token with fromEndpoint, pass an empty string to the subscriptionKey in the
     * fromEndpoint method, and then set authorizationToken="token" on the created SpeechConfig instance to
     * use the authorization token.
     * @member SpeechTranslationConfig.fromEndpoint
     * @function
     * @public
     * @param {URL} endpoint - The service endpoint to connect to.
     * @param {string} subscriptionKey - The subscription key.
     * @returns {SpeechTranslationConfig} A speech config instance.
     */
    static fromEndpoint(endpoint, subscriptionKey) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(endpoint, "endpoint");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(subscriptionKey, "subscriptionKey");
        const ret = new SpeechTranslationConfigImpl();
        ret.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Endpoint, endpoint.href);
        ret.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Key, subscriptionKey);
        return ret;
    }
}
/**
 * @private
 * @class SpeechTranslationConfigImpl
 */
class SpeechTranslationConfigImpl extends SpeechTranslationConfig {
    constructor() {
        super();
        this.privSpeechProperties = new _Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyCollection();
        this.outputFormat = _Exports__WEBPACK_IMPORTED_MODULE_4__.OutputFormat.Simple;
    }
    /**
     * Gets/Sets the authorization token.
     * If this is set, subscription key is ignored.
     * User needs to make sure the provided authorization token is valid and not expired.
     * @member SpeechTranslationConfigImpl.prototype.authorizationToken
     * @function
     * @public
     * @param {string} value - The authorization token.
     */
    set authorizationToken(value) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(value, "value");
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token, value);
    }
    /**
     * Sets the speech recognition language.
     * @member SpeechTranslationConfigImpl.prototype.speechRecognitionLanguage
     * @function
     * @public
     * @param {string} value - The authorization token.
     */
    set speechRecognitionLanguage(value) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(value, "value");
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage, value);
    }
    /**
     * Gets the speech recognition language.
     * @member SpeechTranslationConfigImpl.prototype.speechRecognitionLanguage
     * @function
     * @public
     * @return {string} The speechRecognitionLanguage.
     */
    get speechRecognitionLanguage() {
        return this.privSpeechProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage]);
    }
    /**
     * @member SpeechTranslationConfigImpl.prototype.subscriptionKey
     * @function
     * @public
     */
    get subscriptionKey() {
        return this.privSpeechProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Key]);
    }
    /**
     * Gets the output format
     * @member SpeechTranslationConfigImpl.prototype.outputFormat
     * @function
     * @public
     */
    get outputFormat() {
        // eslint-disable-next-line
        return _Exports__WEBPACK_IMPORTED_MODULE_4__.OutputFormat[this.privSpeechProperties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormatPropertyName, undefined)];
    }
    /**
     * Gets/Sets the output format
     * @member SpeechTranslationConfigImpl.prototype.outputFormat
     * @function
     * @public
     */
    set outputFormat(value) {
        this.privSpeechProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormatPropertyName, _Exports__WEBPACK_IMPORTED_MODULE_4__.OutputFormat[value]);
    }
    /**
     * Gets the endpoint id.
     * @member SpeechTranslationConfigImpl.prototype.endpointId
     * @function
     * @public
     */
    get endpointId() {
        return this.privSpeechProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_EndpointId);
    }
    /**
     * Gets/Sets the endpoint id.
     * @member SpeechTranslationConfigImpl.prototype.endpointId
     * @function
     * @public
     */
    set endpointId(value) {
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_EndpointId, value);
    }
    /**
     * Add a (text) target language to translate into.
     * @member SpeechTranslationConfigImpl.prototype.addTargetLanguage
     * @function
     * @public
     * @param {string} value - The language such as de-DE
     */
    addTargetLanguage(value) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(value, "value");
        const languages = this.targetLanguages;
        languages.push(value);
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_TranslationToLanguages, languages.join(","));
    }
    /**
     * Gets the (text) target language to translate into.
     * @member SpeechTranslationConfigImpl.prototype.targetLanguages
     * @function
     * @public
     * @param {string} value - The language such as de-DE
     */
    get targetLanguages() {
        if (this.privSpeechProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_TranslationToLanguages, undefined) !== undefined) {
            return this.privSpeechProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",");
        }
        else {
            return [];
        }
    }
    /**
     * Gets the voice name.
     * @member SpeechTranslationConfigImpl.prototype.voiceName
     * @function
     * @public
     */
    get voiceName() {
        return this.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_TranslationVoice]);
    }
    /**
     * Gets/Sets the voice of the translated language, enable voice synthesis output.
     * @member SpeechTranslationConfigImpl.prototype.voiceName
     * @function
     * @public
     * @param {string} value - The name of the voice.
     */
    set voiceName(value) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(value, "value");
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_TranslationVoice, value);
    }
    /**
     * Provides the region.
     * @member SpeechTranslationConfigImpl.prototype.region
     * @function
     * @public
     * @returns {string} The region.
     */
    get region() {
        return this.privSpeechProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Region);
    }
    setProxy(proxyHostName, proxyPort, proxyUserName, proxyPassword) {
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_ProxyHostName], proxyHostName);
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_ProxyPort], proxyPort);
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_ProxyUserName], proxyUserName);
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_ProxyPassword], proxyPassword);
    }
    /**
     * Gets an arbitrary property value.
     * @member SpeechTranslationConfigImpl.prototype.getProperty
     * @function
     * @public
     * @param {string} name - The name of the property.
     * @param {string} def - The default value of the property in case it is not set.
     * @returns {string} The value of the property.
     */
    getProperty(name, def) {
        return this.privSpeechProperties.getProperty(name, def);
    }
    /**
     * Gets/Sets an arbitrary property value.
     * @member SpeechTranslationConfigImpl.prototype.setProperty
     * @function
     * @public
     * @param {string | PropertyId} name - The name of the property to set.
     * @param {string} value - The value of the property.
     */
    setProperty(name, value) {
        this.privSpeechProperties.setProperty(name, value);
    }
    /**
     * Provides access to custom properties.
     * @member SpeechTranslationConfigImpl.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The properties.
     */
    get properties() {
        return this.privSpeechProperties;
    }
    /**
     * Dispose of associated resources.
     * @member SpeechTranslationConfigImpl.prototype.close
     * @function
     * @public
     */
    close() {
        return;
    }
    setServiceProperty(name, value) {
        const currentProperties = JSON.parse(this.privSpeechProperties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.ServicePropertiesPropertyName, "{}"));
        currentProperties[name] = value;
        this.privSpeechProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.ServicePropertiesPropertyName, JSON.stringify(currentProperties));
    }
    setProfanity(profanity) {
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceResponse_ProfanityOption, _Exports__WEBPACK_IMPORTED_MODULE_6__.ProfanityOption[profanity]);
    }
    enableAudioLogging() {
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_EnableAudioLogging, "true");
    }
    requestWordLevelTimestamps() {
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps, "true");
    }
    enableDictation() {
        this.privSpeechProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.ForceDictationPropertyName, "true");
    }
    get speechSynthesisLanguage() {
        return this.privSpeechProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_SynthLanguage);
    }
    set speechSynthesisLanguage(language) {
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_SynthLanguage, language);
    }
    get speechSynthesisVoiceName() {
        return this.privSpeechProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_SynthVoice);
    }
    set speechSynthesisVoiceName(voice) {
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_SynthVoice, voice);
    }
    get speechSynthesisOutputFormat() {
        // eslint-disable-next-line
        return _Exports__WEBPACK_IMPORTED_MODULE_7__.SpeechSynthesisOutputFormat[this.privSpeechProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_SynthOutputFormat, undefined)];
    }
    set speechSynthesisOutputFormat(format) {
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_SynthOutputFormat, _Exports__WEBPACK_IMPORTED_MODULE_7__.SpeechSynthesisOutputFormat[format]);
    }
}

//# sourceMappingURL=SpeechTranslationConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SynthesisResult.js":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SynthesisResult.js ***!
  \*******************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SynthesisResult": () => (/* binding */ SynthesisResult)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Base class for synthesis results
 * @class SynthesisResult
 * Added in version 1.20.0
 */
class SynthesisResult {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {string} resultId - The result id.
     * @param {ResultReason} reason - The reason.
     * @param {string} errorDetails - Error details, if provided.
     * @param {PropertyCollection} properties - Additional properties, if provided.
     */
    constructor(resultId, reason, errorDetails, properties) {
        this.privResultId = resultId;
        this.privReason = reason;
        this.privErrorDetails = errorDetails;
        this.privProperties = properties;
    }
    /**
     * Specifies the result identifier.
     * @member SynthesisResult.prototype.resultId
     * @function
     * @public
     * @returns {string} Specifies the result identifier.
     */
    get resultId() {
        return this.privResultId;
    }
    /**
     * Specifies status of the result.
     * @member SynthesisResult.prototype.reason
     * @function
     * @public
     * @returns {ResultReason} Specifies status of the result.
     */
    get reason() {
        return this.privReason;
    }
    /**
     * In case of an unsuccessful synthesis, provides details of the occurred error.
     * @member SynthesisResult.prototype.errorDetails
     * @function
     * @public
     * @returns {string} a brief description of an error.
     */
    get errorDetails() {
        return this.privErrorDetails;
    }
    /**
     * The set of properties exposed in the result.
     * @member SynthesisResult.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The set of properties exposed in the result.
     */
    get properties() {
        return this.privProperties;
    }
}

//# sourceMappingURL=SynthesisResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SynthesisVoicesResult.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SynthesisVoicesResult.js ***!
  \*************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SynthesisVoicesResult": () => (/* binding */ SynthesisVoicesResult)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SynthesisResult.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceInfo.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Defines result of speech synthesis.
 * @class SynthesisVoicesResult
 * Added in version 1.20.0
 */
class SynthesisVoicesResult extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SynthesisResult {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param requestId - result id for request.
     * @param json - json payload from endpoint.
     */
    constructor(requestId, json, errorDetails) {
        if (Array.isArray(json)) {
            super(requestId, _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.VoicesListRetrieved, undefined, new _Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyCollection());
            this.privVoices = [];
            for (const item of json) {
                this.privVoices.push(new _Exports__WEBPACK_IMPORTED_MODULE_3__.VoiceInfo(item));
            }
        }
        else {
            super(requestId, _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.Canceled, errorDetails ? errorDetails : "Error information unavailable", new _Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyCollection());
        }
    }
    /**
     * The list of voices
     * @member SynthesisVoicesResult.prototype.voices
     * @function
     * @public
     * @returns {VoiceInfo[]} List of synthesized voices.
     */
    get voices() {
        return this.privVoices;
    }
}

//# sourceMappingURL=SynthesisVoicesResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/Conversation.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/Conversation.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Conversation": () => (/* binding */ Conversation),
/* harmony export */   "ConversationImpl": () => (/* binding */ ConversationImpl)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorInterfaces.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationManager.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorRecognizer.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationParticipantsChangedEventArgs.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ParticipantChangedReason.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationEventArgs.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ProfanityOption.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/IParticipant.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Multi-device Conversation is a Preview feature.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
/* eslint-disable max-classes-per-file */




class Conversation {
    constructor() {
        return;
    }
    /**
     * Create a conversation
     * @param speechConfig
     * @param cb
     * @param err
     */
    static createConversationAsync(speechConfig, arg2, arg3, arg4) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(speechConfig, _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}", "config"));
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(speechConfig.region, _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}", "SpeechServiceConnection_Region"));
        if (!speechConfig.subscriptionKey && !speechConfig.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token])) {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(speechConfig.subscriptionKey, _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}", "SpeechServiceConnection_Key"));
        }
        let conversationImpl;
        let cb;
        let err;
        if (typeof arg2 === "string") {
            conversationImpl = new ConversationImpl(speechConfig, arg2);
            // eslint-disable-next-line @typescript-eslint/no-empty-function
            (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)((() => __awaiter(this, void 0, void 0, function* () { }))(), arg3, arg4);
        }
        else {
            conversationImpl = new ConversationImpl(speechConfig);
            cb = arg2;
            err = arg3;
            conversationImpl.createConversationAsync((() => {
                if (!!cb) {
                    cb();
                }
            }), (error) => {
                if (!!err) {
                    err(error);
                }
            });
        }
        return conversationImpl;
    }
}
class ConversationImpl extends Conversation {
    /**
     * Create a conversation impl
     * @param speechConfig
     * @param {string} id - optional conversationId
     */
    constructor(speechConfig, id) {
        super();
        this.privErrors = _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__.ConversationConnectionConfig.restErrors;
        /** websocket callbacks */
        /* eslint-disable @typescript-eslint/typedef */
        this.onConnected = (e) => {
            var _a;
            this.privIsConnected = true;
            try {
                if (!!((_a = this.privConversationTranslator) === null || _a === void 0 ? void 0 : _a.sessionStarted)) {
                    this.privConversationTranslator.sessionStarted(this.privConversationTranslator, e);
                }
            }
            catch (e) {
                //
            }
        };
        this.onDisconnected = (e) => {
            var _a;
            try {
                if (!!((_a = this.privConversationTranslator) === null || _a === void 0 ? void 0 : _a.sessionStopped)) {
                    this.privConversationTranslator.sessionStopped(this.privConversationTranslator, e);
                }
            }
            catch (e) {
                //
            }
            finally {
                void this.close(false);
            }
        };
        this.onCanceled = (r, e) => {
            var _a;
            try {
                if (!!((_a = this.privConversationTranslator) === null || _a === void 0 ? void 0 : _a.canceled)) {
                    this.privConversationTranslator.canceled(this.privConversationTranslator, e);
                }
            }
            catch (e) {
                //
            }
        };
        this.onParticipantUpdateCommandReceived = (r, e) => {
            try {
                const updatedParticipant = this.privParticipants.getParticipant(e.id);
                if (updatedParticipant !== undefined) {
                    switch (e.key) {
                        case _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.changeNickname:
                            updatedParticipant.displayName = e.value;
                            break;
                        case _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.setUseTTS:
                            updatedParticipant.isUsingTts = e.value;
                            break;
                        case _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.setProfanityFiltering:
                            updatedParticipant.profanity = e.value;
                            break;
                        case _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.setMute:
                            updatedParticipant.isMuted = e.value;
                            break;
                        case _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.setTranslateToLanguages:
                            updatedParticipant.translateToLanguages = e.value;
                            break;
                    }
                    this.privParticipants.addOrUpdateParticipant(updatedParticipant);
                    if (!!this.privConversationTranslator) {
                        this.privConversationTranslator.participantsChanged(this.privConversationTranslator, new _Exports__WEBPACK_IMPORTED_MODULE_5__.ConversationParticipantsChangedEventArgs(_Exports__WEBPACK_IMPORTED_MODULE_6__.ParticipantChangedReason.Updated, [this.toParticipant(updatedParticipant)], e.sessionId));
                    }
                }
            }
            catch (e) {
                //
            }
        };
        this.onLockRoomCommandReceived = () => {
            // TODO
        };
        this.onMuteAllCommandReceived = (r, e) => {
            try {
                this.privParticipants.participants.forEach((p) => p.isMuted = (p.isHost ? false : e.isMuted));
                if (!!this.privConversationTranslator) {
                    this.privConversationTranslator.participantsChanged(this.privConversationTranslator, new _Exports__WEBPACK_IMPORTED_MODULE_5__.ConversationParticipantsChangedEventArgs(_Exports__WEBPACK_IMPORTED_MODULE_6__.ParticipantChangedReason.Updated, this.toParticipants(false), e.sessionId));
                }
            }
            catch (e) {
                //
            }
        };
        this.onParticipantJoinCommandReceived = (r, e) => {
            try {
                const newParticipant = this.privParticipants.addOrUpdateParticipant(e.participant);
                if (newParticipant !== undefined) {
                    if (!!this.privConversationTranslator) {
                        this.privConversationTranslator.participantsChanged(this.privConversationTranslator, new _Exports__WEBPACK_IMPORTED_MODULE_5__.ConversationParticipantsChangedEventArgs(_Exports__WEBPACK_IMPORTED_MODULE_6__.ParticipantChangedReason.JoinedConversation, [this.toParticipant(newParticipant)], e.sessionId));
                    }
                }
            }
            catch (e) {
                //
            }
        };
        this.onParticipantLeaveCommandReceived = (r, e) => {
            try {
                const ejectedParticipant = this.privParticipants.getParticipant(e.participant.id);
                if (ejectedParticipant !== undefined) {
                    // remove the participant from the internal participants list
                    this.privParticipants.deleteParticipant(e.participant.id);
                    if (!!this.privConversationTranslator) {
                        // notify subscribers that the participant has left the conversation
                        this.privConversationTranslator.participantsChanged(this.privConversationTranslator, new _Exports__WEBPACK_IMPORTED_MODULE_5__.ConversationParticipantsChangedEventArgs(_Exports__WEBPACK_IMPORTED_MODULE_6__.ParticipantChangedReason.LeftConversation, [this.toParticipant(ejectedParticipant)], e.sessionId));
                    }
                }
            }
            catch (e) {
                //
            }
        };
        this.onTranslationReceived = (r, e) => {
            try {
                switch (e.command) {
                    case _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.final:
                        if (!!this.privConversationTranslator) {
                            this.privConversationTranslator.transcribed(this.privConversationTranslator, new _Exports__WEBPACK_IMPORTED_MODULE_7__.ConversationTranslationEventArgs(e.payload, undefined, e.sessionId));
                        }
                        break;
                    case _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.partial:
                        if (!!this.privConversationTranslator) {
                            this.privConversationTranslator.transcribing(this.privConversationTranslator, new _Exports__WEBPACK_IMPORTED_MODULE_7__.ConversationTranslationEventArgs(e.payload, undefined, e.sessionId));
                        }
                        break;
                    case _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.instantMessage:
                        if (!!this.privConversationTranslator) {
                            this.privConversationTranslator.textMessageReceived(this.privConversationTranslator, new _Exports__WEBPACK_IMPORTED_MODULE_7__.ConversationTranslationEventArgs(e.payload, undefined, e.sessionId));
                        }
                        break;
                }
            }
            catch (e) {
                //
            }
        };
        this.onParticipantsListReceived = (r, e) => {
            var _a;
            try {
                // check if the session token needs to be updated
                if (e.sessionToken !== undefined && e.sessionToken !== null) {
                    this.privRoom.token = e.sessionToken;
                }
                // save the participants
                this.privParticipants.participants = [...e.participants];
                // enable the conversation
                if (this.privParticipants.me !== undefined) {
                    this.privIsReady = true;
                }
                if (!!this.privConversationTranslator) {
                    this.privConversationTranslator.participantsChanged(this.privConversationTranslator, new _Exports__WEBPACK_IMPORTED_MODULE_5__.ConversationParticipantsChangedEventArgs(_Exports__WEBPACK_IMPORTED_MODULE_6__.ParticipantChangedReason.JoinedConversation, this.toParticipants(true), e.sessionId));
                }
                // if this is the host, update the nickname if needed
                if (this.me.isHost) {
                    const nickname = (_a = this.privConversationTranslator) === null || _a === void 0 ? void 0 : _a.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.ConversationTranslator_Name);
                    if (nickname !== undefined && nickname.length > 0 && nickname !== this.me.displayName) {
                        // issue a change nickname request
                        this.changeNicknameAsync(nickname);
                    }
                }
            }
            catch (e) {
                //
            }
        };
        this.onConversationExpiration = (r, e) => {
            try {
                if (!!this.privConversationTranslator) {
                    this.privConversationTranslator.conversationExpiration(this.privConversationTranslator, e);
                }
            }
            catch (e) {
                //
            }
        };
        this.privIsConnected = false;
        this.privIsDisposed = false;
        this.privConversationId = "";
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_8__.PropertyCollection();
        this.privManager = new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_9__.ConversationManager();
        // check the speech language
        const language = speechConfig.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage]);
        if (!language) {
            speechConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage], _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__.ConversationConnectionConfig.defaultLanguageCode);
        }
        this.privLanguage = speechConfig.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage]);
        if (!id) {
            // check the target language(s)
            if (speechConfig.targetLanguages.length === 0) {
                speechConfig.addTargetLanguage(this.privLanguage);
            }
            // check the profanity setting: speech and conversationTranslator should be in sync
            const profanity = speechConfig.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceResponse_ProfanityOption]);
            if (!profanity) {
                speechConfig.setProfanity(_Exports__WEBPACK_IMPORTED_MODULE_10__.ProfanityOption.Masked);
            }
            // check the nickname: it should pass this regex: ^\w+([\s-][\w\(\)]+)*$"
            // TODO: specify the regex required. Nicknames must be unique or get the duplicate nickname error
            // TODO: check what the max length is and if a truncation is required or if the service handles it without an error
            let hostNickname = speechConfig.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.ConversationTranslator_Name]);
            if (hostNickname === undefined || hostNickname === null) {
                hostNickname = "Host";
            }
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrTooLong(hostNickname, "nickname", 50);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrTooShort(hostNickname, "nickname", 2);
            speechConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.ConversationTranslator_Name], hostNickname);
        }
        else {
            this.privConversationId = id;
        }
        // save the speech config for future usage
        this.privConfig = speechConfig;
        // save the config properties
        const configImpl = speechConfig;
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNull(configImpl, "speechConfig");
        this.privProperties = configImpl.properties.clone();
        this.privIsConnected = false;
        this.privParticipants = new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.InternalParticipants();
        this.privIsReady = false;
        this.privTextMessageMaxLength = 1000;
    }
    // get the internal data about a conversation
    get room() {
        return this.privRoom;
    }
    // get the wrapper for connecting to the websockets
    get connection() {
        return this.privConversationRecognizer; // this.privConnection;
    }
    // get the config
    get config() {
        return this.privConfig;
    }
    // get the conversation Id
    get conversationId() {
        return this.privRoom ? this.privRoom.roomId : this.privConversationId;
    }
    // get the properties
    get properties() {
        return this.privProperties;
    }
    // get the speech language
    get speechRecognitionLanguage() {
        return this.privLanguage;
    }
    get isMutedByHost() {
        var _a, _b;
        return ((_a = this.privParticipants.me) === null || _a === void 0 ? void 0 : _a.isHost) ? false : (_b = this.privParticipants.me) === null || _b === void 0 ? void 0 : _b.isMuted;
    }
    get isConnected() {
        return this.privIsConnected && this.privIsReady;
    }
    get participants() {
        return this.toParticipants(true);
    }
    get me() {
        return this.toParticipant(this.privParticipants.me);
    }
    get host() {
        return this.toParticipant(this.privParticipants.host);
    }
    get transcriberRecognizer() {
        return this.privTranscriberRecognizer;
    }
    get conversationInfo() {
        const convId = this.conversationId;
        const p = this.participants.map((part) => ({
            id: part.id,
            preferredLanguage: part.preferredLanguage,
            voice: part.voice
        }));
        const props = {};
        for (const key of _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__.ConversationConnectionConfig.transcriptionEventKeys) {
            const val = this.properties.getProperty(key, "");
            if (val !== "") {
                props[key] = val;
            }
        }
        const info = { id: convId, participants: p, conversationProperties: props };
        return info;
    }
    get canSend() {
        var _a;
        return this.privIsConnected && !((_a = this.privParticipants.me) === null || _a === void 0 ? void 0 : _a.isMuted);
    }
    get canSendAsHost() {
        var _a;
        return this.privIsConnected && ((_a = this.privParticipants.me) === null || _a === void 0 ? void 0 : _a.isHost);
    }
    // get / set the speech auth token
    // eslint-disable-next-line @typescript-eslint/member-ordering
    get authorizationToken() {
        return this.privToken;
    }
    set authorizationToken(value) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(value, "authorizationToken");
        this.privToken = value;
    }
    set conversationTranslator(conversationTranslator) {
        this.privConversationTranslator = conversationTranslator;
    }
    /**
     * Create a new conversation as Host
     * @param cb
     * @param err
     */
    createConversationAsync(cb, err) {
        try {
            if (!!this.privConversationRecognizer) {
                this.handleError(new Error(this.privErrors.permissionDeniedStart), err);
            }
            this.privManager.createOrJoin(this.privProperties, undefined, ((room) => {
                if (!room) {
                    this.handleError(new Error(this.privErrors.permissionDeniedConnect), err);
                }
                this.privRoom = room;
                this.handleCallback(cb, err);
            }), ((error) => {
                this.handleError(error, err);
            }));
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Starts a new conversation as host.
     * @param cb
     * @param err
     */
    startConversationAsync(cb, err) {
        try {
            // check if there is already a recognizer
            if (!!this.privConversationRecognizer) {
                this.handleError(new Error(this.privErrors.permissionDeniedStart), err);
            }
            // check if there is conversation data available
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedConnect);
            // connect to the conversation websocket
            this.privParticipants.meId = this.privRoom.participantId;
            this.privConversationRecognizer = _common_speech_Exports__WEBPACK_IMPORTED_MODULE_11__.ConversationRecognizerFactory.fromConfig(this, this.privConfig);
            // Because ConversationTranslator manually sets up and manages the connection, Conversation
            // has to forward serviceRecognizer connection events that usually get passed automatically
            this.privConversationRecognizer.connected = this.onConnected;
            this.privConversationRecognizer.disconnected = this.onDisconnected;
            this.privConversationRecognizer.canceled = this.onCanceled;
            this.privConversationRecognizer.participantUpdateCommandReceived = this.onParticipantUpdateCommandReceived;
            this.privConversationRecognizer.lockRoomCommandReceived = this.onLockRoomCommandReceived;
            this.privConversationRecognizer.muteAllCommandReceived = this.onMuteAllCommandReceived;
            this.privConversationRecognizer.participantJoinCommandReceived = this.onParticipantJoinCommandReceived;
            this.privConversationRecognizer.participantLeaveCommandReceived = this.onParticipantLeaveCommandReceived;
            this.privConversationRecognizer.translationReceived = this.onTranslationReceived;
            this.privConversationRecognizer.participantsListReceived = this.onParticipantsListReceived;
            this.privConversationRecognizer.conversationExpiration = this.onConversationExpiration;
            this.privConversationRecognizer.connect(this.privRoom.token, (() => {
                this.handleCallback(cb, err);
            }), ((error) => {
                this.handleError(error, err);
            }));
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Join a conversation as a participant.
     * @param { IParticipant } participant - participant to add
     * @param cb
     * @param err
     */
    addParticipantAsync(participant, cb, err) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(participant, "Participant");
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)(this.addParticipantImplAsync(participant), cb, err);
    }
    /**
     * Join a conversation as a participant.
     * @param conversation
     * @param nickname
     * @param lang
     * @param cb
     * @param err
     */
    joinConversationAsync(conversationId, nickname, lang, cb, err) {
        try {
            // TODO
            // if (!!this.privConversationRecognizer) {
            //     throw new Error(this.privErrors.permissionDeniedStart);
            // }
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(conversationId, this.privErrors.invalidArgs.replace("{arg}", "conversationId"));
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(nickname, this.privErrors.invalidArgs.replace("{arg}", "nickname"));
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(lang, this.privErrors.invalidArgs.replace("{arg}", "language"));
            // join the conversation
            this.privManager.createOrJoin(this.privProperties, conversationId, ((room) => {
                _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(room, this.privErrors.permissionDeniedConnect);
                this.privRoom = room;
                this.privConfig.authorizationToken = room.cognitiveSpeechAuthToken;
                // join callback
                if (!!cb) {
                    cb(room.cognitiveSpeechAuthToken);
                }
            }), ((error) => {
                this.handleError(error, err);
            }));
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Deletes a conversation
     * @param cb
     * @param err
     */
    deleteConversationAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)(this.deleteConversationImplAsync(), cb, err);
    }
    deleteConversationImplAsync() {
        return __awaiter(this, void 0, void 0, function* () {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privProperties, this.privErrors.permissionDeniedConnect);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.token, this.privErrors.permissionDeniedConnect);
            yield this.privManager.leave(this.privProperties, this.privRoom.token);
            this.dispose();
        });
    }
    /**
     * Issues a request to close the client websockets
     * @param cb
     * @param err
     */
    endConversationAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)(this.endConversationImplAsync(), cb, err);
    }
    endConversationImplAsync() {
        return this.close(true);
    }
    /**
     * Issues a request to lock the conversation
     * @param cb
     * @param err
     */
    lockConversationAsync(cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
            if (!this.canSendAsHost) {
                this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}", "lock")), err);
            }
            if (!!this.privConversationRecognizer) {
                this.privConversationRecognizer.sendRequest(this.getLockCommand(true), (() => {
                    this.handleCallback(cb, err);
                }), ((error) => {
                    this.handleError(error, err);
                }));
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Issues a request to mute the conversation
     * @param cb
     * @param err
     */
    muteAllParticipantsAsync(cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer, this.privErrors.permissionDeniedSend);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
            // check the user's permissions
            if (!this.canSendAsHost) {
                this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}", "mute")), err);
            }
            if (!!this.privConversationRecognizer) {
                this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(true), (() => {
                    this.handleCallback(cb, err);
                }), ((error) => {
                    this.handleError(error, err);
                }));
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Issues a request to mute a participant in the conversation
     * @param userId
     * @param cb
     * @param err
     */
    muteParticipantAsync(userId, cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(userId, this.privErrors.invalidArgs.replace("{arg}", "userId"));
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
            // check the connection is open (host + participant can perform the mute command)
            if (!this.canSend) {
                this.handleError(new Error(this.privErrors.permissionDeniedSend), err);
            }
            // if not host, check the participant is not muting another participant
            if (!this.me.isHost && this.me.id !== userId) {
                this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}", "mute")), err);
            }
            // check the user exists
            const exists = this.privParticipants.getParticipantIndex(userId);
            if (exists === -1) {
                this.handleError(new Error(this.privErrors.invalidParticipantRequest), err);
            }
            if (!!this.privConversationRecognizer) {
                this.privConversationRecognizer.sendRequest(this.getMuteCommand(userId, true), (() => {
                    this.handleCallback(cb, err);
                }), ((error) => {
                    this.handleError(error, err);
                }));
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Issues a request to remove a participant from the conversation
     * @param userId
     * @param cb
     * @param err
     */
    removeParticipantAsync(userId, cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            if (!!this.privTranscriberRecognizer && userId.hasOwnProperty("id")) {
                // Assume this is a transcription participant
                (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)(this.removeParticipantImplAsync(userId), cb, err);
            }
            else {
                _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
                _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
                if (!this.canSendAsHost) {
                    this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}", "remove")), err);
                }
                let participantId = "";
                if (typeof userId === "string") {
                    participantId = userId;
                }
                else if (userId.hasOwnProperty("id")) {
                    const participant = userId;
                    participantId = participant.id;
                }
                else if (userId.hasOwnProperty("userId")) {
                    const user = userId;
                    participantId = user.userId;
                }
                _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(participantId, this.privErrors.invalidArgs.replace("{arg}", "userId"));
                // check the participant exists
                const index = this.participants.findIndex((p) => p.id === participantId);
                if (index === -1) {
                    this.handleError(new Error(this.privErrors.invalidParticipantRequest), err);
                }
                if (!!this.privConversationRecognizer) {
                    this.privConversationRecognizer.sendRequest(this.getEjectCommand(participantId), (() => {
                        this.handleCallback(cb, err);
                    }), ((error) => {
                        this.handleError(error, err);
                    }));
                }
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Issues a request to unlock the conversation
     * @param cb
     * @param err
     */
    unlockConversationAsync(cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
            if (!this.canSendAsHost) {
                this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}", "unlock")), err);
            }
            if (!!this.privConversationRecognizer) {
                this.privConversationRecognizer.sendRequest(this.getLockCommand(false), (() => {
                    this.handleCallback(cb, err);
                }), ((error) => {
                    this.handleError(error, err);
                }));
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Issues a request to unmute all participants in the conversation
     * @param cb
     * @param err
     */
    unmuteAllParticipantsAsync(cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
            if (!this.canSendAsHost) {
                this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}", "unmute all")), err);
            }
            if (!!this.privConversationRecognizer) {
                this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(false), (() => {
                    this.handleCallback(cb, err);
                }), ((error) => {
                    this.handleError(error, err);
                }));
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Issues a request to unmute a participant in the conversation
     * @param userId
     * @param cb
     * @param err
     */
    unmuteParticipantAsync(userId, cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(userId, this.privErrors.invalidArgs.replace("{arg}", "userId"));
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
            // check the connection is open (host + participant can perform the mute command)
            if (!this.canSend) {
                this.handleError(new Error(this.privErrors.permissionDeniedSend), err);
            }
            // if not host, check the participant is not muting another participant
            if (!this.me.isHost && this.me.id !== userId) {
                this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}", "mute")), err);
            }
            // check the user exists
            const exists = this.privParticipants.getParticipantIndex(userId);
            if (exists === -1) {
                this.handleError(new Error(this.privErrors.invalidParticipantRequest), err);
            }
            if (!!this.privConversationRecognizer) {
                this.privConversationRecognizer.sendRequest(this.getMuteCommand(userId, false), (() => {
                    this.handleCallback(cb, err);
                }), ((error) => {
                    this.handleError(error, err);
                }));
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Send a text message
     * @param message
     * @param cb
     * @param err
     */
    sendTextMessageAsync(message, cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(message, this.privErrors.invalidArgs.replace("{arg}", "message"));
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
            if (!this.canSend) {
                this.handleError(new Error(this.privErrors.permissionDeniedSend), err);
            }
            // TODO: is a max length check required?
            if (message.length > this.privTextMessageMaxLength) {
                this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}", "message length")), err);
            }
            if (!!this.privConversationRecognizer) {
                this.privConversationRecognizer.sendRequest(this.getMessageCommand(message), (() => {
                    this.handleCallback(cb, err);
                }), ((error) => {
                    this.handleError(error, err);
                }));
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Set translated to languages
     * @param {string[]} languages - languages to translate to
     * @param cb
     * @param err
     */
    setTranslatedLanguagesAsync(languages, cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfArrayEmptyOrWhitespace(languages, this.privErrors.invalidArgs.replace("{arg}", "languages"));
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
            if (!this.canSend) {
                this.handleError(new Error(this.privErrors.permissionDeniedSend), err);
            }
            if (!!this.privConversationRecognizer) {
                this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(languages), (() => {
                    this.handleCallback(cb, err);
                }), ((error) => {
                    this.handleError(error, err);
                }));
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Change nickname
     * @param {string} nickname - new nickname for the room
     * @param cb
     * @param err
     */
    changeNicknameAsync(nickname, cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(nickname, this.privErrors.invalidArgs.replace("{arg}", "nickname"));
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
            if (!this.canSend) {
                this.handleError(new Error(this.privErrors.permissionDeniedSend), err);
            }
            if (!!this.privConversationRecognizer) {
                this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(nickname), (() => {
                    this.handleCallback(cb, err);
                }), ((error) => {
                    this.handleError(error, err);
                }));
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    isDisposed() {
        return this.privIsDisposed;
    }
    dispose() {
        if (this.isDisposed) {
            return;
        }
        this.privIsDisposed = true;
        if (!!this.config) {
            this.config.close();
        }
        this.privConfig = undefined;
        this.privLanguage = undefined;
        this.privProperties = undefined;
        this.privRoom = undefined;
        this.privToken = undefined;
        this.privManager = undefined;
        this.privIsConnected = false;
        this.privIsReady = false;
        this.privParticipants = undefined;
    }
    connectTranscriberRecognizer(recognizer) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!!this.privTranscriberRecognizer) {
                yield this.privTranscriberRecognizer.close();
            }
            yield recognizer.enforceAudioGating();
            this.privTranscriberRecognizer = recognizer;
            this.privTranscriberRecognizer.conversation = this;
        });
    }
    getKeepAlive() {
        const nickname = (!!this.me) ? this.me.displayName : "default_nickname";
        return JSON.stringify({
            id: "0",
            nickname,
            participantId: this.privRoom.participantId,
            roomId: this.privRoom.roomId,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.keepAlive
        });
    }
    /* eslint-enable @typescript-eslint/typedef */
    addParticipantImplAsync(participant) {
        const newParticipant = this.privParticipants.addOrUpdateParticipant(participant);
        if (newParticipant !== undefined) {
            if (!!this.privTranscriberRecognizer) {
                const conversationInfo = this.conversationInfo;
                conversationInfo.participants = [participant];
                return this.privTranscriberRecognizer.pushConversationEvent(conversationInfo, "join");
            }
        }
    }
    removeParticipantImplAsync(participant) {
        this.privParticipants.deleteParticipant(participant.id);
        const conversationInfo = this.conversationInfo;
        conversationInfo.participants = [participant];
        return this.privTranscriberRecognizer.pushConversationEvent(conversationInfo, "leave");
    }
    close(dispose) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            try {
                this.privIsConnected = false;
                yield ((_a = this.privConversationRecognizer) === null || _a === void 0 ? void 0 : _a.close());
                this.privConversationRecognizer = undefined;
                if (!!this.privConversationTranslator) {
                    this.privConversationTranslator.dispose();
                }
            }
            catch (e) {
                // ignore error
                throw e;
            }
            if (dispose) {
                this.dispose();
            }
        });
    }
    /** Helpers */
    handleCallback(cb, err) {
        if (!!cb) {
            try {
                cb();
            }
            catch (e) {
                if (!!err) {
                    err(e);
                }
            }
            cb = undefined;
        }
    }
    handleError(error, err) {
        if (!!err) {
            if (error instanceof Error) {
                const typedError = error;
                err(typedError.name + ": " + typedError.message);
            }
            else {
                err(error);
            }
        }
    }
    /** Participant Helpers */
    toParticipants(includeHost) {
        const participants = this.privParticipants.participants.map((p) => (this.toParticipant(p)));
        if (!includeHost) {
            return participants.filter((p) => p.isHost === false);
        }
        else {
            return participants;
        }
    }
    toParticipant(p) {
        return new _Exports__WEBPACK_IMPORTED_MODULE_12__.Participant(p.id, p.avatar, p.displayName, p.isHost, p.isMuted, p.isUsingTts, p.preferredLanguage, p.voice);
    }
    getMuteAllCommand(isMuted) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId, "conversationId");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId, "participantId");
        return JSON.stringify({
            command: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.setMuteAll,
            participantId: this.privRoom.participantId,
            roomid: this.privRoom.roomId,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.participantCommand,
            value: isMuted
        });
    }
    getMuteCommand(participantId, isMuted) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId, "conversationId");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(participantId, "participantId");
        return JSON.stringify({
            command: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.setMute,
            // eslint-disable-next-line object-shorthand
            participantId: participantId,
            roomid: this.privRoom.roomId,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.participantCommand,
            value: isMuted
        });
    }
    getLockCommand(isLocked) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId, "conversationId");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId, "participantId");
        return JSON.stringify({
            command: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.setLockState,
            participantId: this.privRoom.participantId,
            roomid: this.privRoom.roomId,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.participantCommand,
            value: isLocked
        });
    }
    getEjectCommand(participantId) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId, "conversationId");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(participantId, "participantId");
        return JSON.stringify({
            command: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.ejectParticipant,
            // eslint-disable-next-line object-shorthand
            participantId: participantId,
            roomid: this.privRoom.roomId,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.participantCommand,
        });
    }
    getSetTranslateToLanguagesCommand(languages) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId, "conversationId");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId, "participantId");
        return JSON.stringify({
            command: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.setTranslateToLanguages,
            participantId: this.privRoom.participantId,
            roomid: this.privRoom.roomId,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.participantCommand,
            value: languages
        });
    }
    getChangeNicknameCommand(nickname) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId, "conversationId");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(nickname, "nickname");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId, "participantId");
        return JSON.stringify({
            command: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.changeNickname,
            nickname,
            participantId: this.privRoom.participantId,
            roomid: this.privRoom.roomId,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.participantCommand,
            value: nickname
        });
    }
    getMessageCommand(message) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId, "conversationId");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId, "participantId");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(message, "message");
        return JSON.stringify({
            participantId: this.privRoom.participantId,
            roomId: this.privRoom.roomId,
            text: message,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.instantMessage
        });
    }
}

//# sourceMappingURL=Conversation.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationCommon.js":
/*!************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationCommon.js ***!
  \************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationCommon": () => (/* binding */ ConversationCommon)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class ConversationCommon {
    constructor(audioConfig) {
        this.privAudioConfig = audioConfig;
    }
    handleCallback(cb, err) {
        if (!!cb) {
            try {
                cb();
            }
            catch (e) {
                if (!!err) {
                    err(e);
                }
            }
            cb = undefined;
        }
    }
    handleError(error, err) {
        if (!!err) {
            if (error instanceof Error) {
                const typedError = error;
                err(typedError.name + ": " + typedError.message);
            }
            else {
                err(error);
            }
        }
    }
}

//# sourceMappingURL=ConversationCommon.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationExpirationEventArgs.js":
/*!*************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationExpirationEventArgs.js ***!
  \*************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationExpirationEventArgs": () => (/* binding */ ConversationExpirationEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Multi-device Conversation is a Preview feature.

class ConversationExpirationEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    constructor(expirationTime, sessionId) {
        super(sessionId);
        this.privExpirationTime = expirationTime;
    }
    /** How much longer until the conversation expires (in minutes). */
    get expirationTime() {
        return this.privExpirationTime;
    }
}

//# sourceMappingURL=ConversationExpirationEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationParticipantsChangedEventArgs.js":
/*!**********************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationParticipantsChangedEventArgs.js ***!
  \**********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationParticipantsChangedEventArgs": () => (/* binding */ ConversationParticipantsChangedEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Multi-device Conversation is a Preview feature.

class ConversationParticipantsChangedEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    constructor(reason, participants, sessionId) {
        super(sessionId);
        this.privReason = reason;
        this.privParticipant = participants;
    }
    get reason() {
        return this.privReason;
    }
    get participants() {
        return this.privParticipant;
    }
}

//# sourceMappingURL=ConversationParticipantsChangedEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranscriber.js":
/*!*****************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranscriber.js ***!
  \*****************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationTranscriber": () => (/* binding */ ConversationTranscriber)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/TranscriberRecognizer.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Connection.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




class ConversationTranscriber {
    /**
     * ConversationTranscriber constructor.
     * @constructor
     * @param {AudioConfig} audioConfig - An optional audio configuration associated with the recognizer
     */
    constructor(audioConfig) {
        this.privAudioConfig = audioConfig;
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyCollection();
        this.privRecognizer = undefined;
        this.privDisposedRecognizer = false;
    }
    /**
     * Gets the spoken language of recognition.
     * @member ConversationTranscriber.prototype.speechRecognitionLanguage
     * @function
     * @public
     * @returns {string} The spoken language of recognition.
     */
    get speechRecognitionLanguage() {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedRecognizer);
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage);
    }
    /**
     * The collection of properties and their values defined for this ConversationTranscriber.
     * @member ConversationTranscriber.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The collection of properties and their values defined for this ConversationTranscriber.
     */
    get properties() {
        return this.privProperties;
    }
    /**
     * @Internal
     * Internal data member to support fromRecognizer* pattern methods on other classes.
     * Do not use externally, object returned will change without warning or notice.
     */
    get internalData() {
        return this.privRecognizer.internalData;
    }
    /**
     * @Deprecated
     * @Obsolete
     * Please use the Connection.fromRecognizer pattern to obtain a connection object
     */
    get connection() {
        return _Exports__WEBPACK_IMPORTED_MODULE_3__.Connection.fromRecognizer(this.privRecognizer);
    }
    /**
     * Gets the authorization token used to communicate with the service.
     * @member ConversationTranscriber.prototype.authorizationToken
     * @function
     * @public
     * @returns {string} Authorization token.
     */
    get authorizationToken() {
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token);
    }
    /**
     * Gets/Sets the authorization token used to communicate with the service.
     * @member ConversationTranscriber.prototype.authorizationToken
     * @function
     * @public
     * @param {string} token - Authorization token.
     */
    set authorizationToken(token) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(token, "token");
        this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token, token);
    }
    /**
     * @param {Conversation} conversation - conversation to be recognized
     */
    joinConversationAsync(conversation, cb, err) {
        const conversationImpl = conversation;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(conversationImpl, "Conversation");
        // ref the conversation object
        // create recognizer and subscribe to recognizer events
        this.privRecognizer = new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.TranscriberRecognizer(conversation.config, this.privAudioConfig);
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(this.privRecognizer, "Recognizer");
        this.privRecognizer.connectCallbacks(this);
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_5__.marshalPromiseToCallbacks)(conversationImpl.connectTranscriberRecognizer(this.privRecognizer), cb, err);
    }
    /**
     * Starts conversation transcription, until stopTranscribingAsync() is called.
     * User must subscribe to events to receive transcription results.
     * @member ConversationTranscriber.prototype.startTranscribingAsync
     * @function
     * @public
     * @param cb - Callback invoked once the transcription has started.
     * @param err - Callback invoked in case of an error.
     */
    startTranscribingAsync(cb, err) {
        this.privRecognizer.startContinuousRecognitionAsync(cb, err);
    }
    /**
     * Starts conversation transcription, until stopTranscribingAsync() is called.
     * User must subscribe to events to receive transcription results.
     * @member ConversationTranscriber.prototype.stopTranscribingAsync
     * @function
     * @public
     * @param cb - Callback invoked once the transcription has started.
     * @param err - Callback invoked in case of an error.
     */
    stopTranscribingAsync(cb, err) {
        this.privRecognizer.stopContinuousRecognitionAsync(cb, err);
    }
    /**
     * Leave the current conversation. After this is called, you will no longer receive any events.
     */
    leaveConversationAsync(cb, err) {
        this.privRecognizer.disconnectCallbacks();
        // eslint-disable-next-line
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_5__.marshalPromiseToCallbacks)((() => __awaiter(this, void 0, void 0, function* () { return; }))(), cb, err);
    }
    /**
     * closes all external resources held by an instance of this class.
     * @member ConversationTranscriber.prototype.close
     * @function
     * @public
     */
    close(cb, errorCb) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedRecognizer);
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_5__.marshalPromiseToCallbacks)(this.dispose(true), cb, errorCb);
    }
    /**
     * Disposes any resources held by the object.
     * @member ConversationTranscriber.prototype.dispose
     * @function
     * @public
     * @param {boolean} disposing - true if disposing the object.
     */
    dispose(disposing) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privDisposedRecognizer) {
                return;
            }
            if (!!this.privRecognizer) {
                yield this.privRecognizer.close();
                this.privRecognizer = undefined;
            }
            if (disposing) {
                this.privDisposedRecognizer = true;
            }
        });
    }
}

//# sourceMappingURL=ConversationTranscriber.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationCanceledEventArgs.js":
/*!**********************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationCanceledEventArgs.js ***!
  \**********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationTranslationCanceledEventArgs": () => (/* binding */ ConversationTranslationCanceledEventArgs)
/* harmony export */ });
/* harmony import */ var _CancellationEventArgsBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../CancellationEventArgsBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationEventArgsBase.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Multi-device Conversation is a Preview feature.

class ConversationTranslationCanceledEventArgs extends _CancellationEventArgsBase__WEBPACK_IMPORTED_MODULE_0__.CancellationEventArgsBase {
}

//# sourceMappingURL=ConversationTranslationCanceledEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationEventArgs.js":
/*!**************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationEventArgs.js ***!
  \**************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationTranslationEventArgs": () => (/* binding */ ConversationTranslationEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Multi-device Conversation is a Preview feature.

class ConversationTranslationEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.RecognitionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {ConversationTranslationResult} result - The translation recognition result.
     * @param {number} offset - The offset.
     * @param {string} sessionId - The session id.
     */
    constructor(result, offset, sessionId) {
        super(offset, sessionId);
        this.privResult = result;
    }
    /**
     * Specifies the recognition result.
     * @returns {ConversationTranslationResult} the recognition result.
     */
    get result() {
        return this.privResult;
    }
}

//# sourceMappingURL=ConversationTranslationEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationResult.js":
/*!***********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationResult.js ***!
  \***********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationTranslationResult": () => (/* binding */ ConversationTranslationResult)
/* harmony export */ });
/* harmony import */ var _TranslationRecognitionResult__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../TranslationRecognitionResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionResult.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Multi-device Conversation is a Preview feature.

class ConversationTranslationResult extends _TranslationRecognitionResult__WEBPACK_IMPORTED_MODULE_0__.TranslationRecognitionResult {
    constructor(participantId, translations, originalLanguage, resultId, reason, text, duration, offset, errorDetails, json, properties) {
        super(translations, resultId, reason, text, duration, offset, undefined, undefined, errorDetails, json, properties);
        this.privId = participantId;
        this.privOrigLang = originalLanguage;
    }
    /**
     * The unique identifier for the participant this result is for.
     */
    get participantId() {
        return this.privId;
    }
    /**
     * The original language this result was in.
     */
    get originalLang() {
        return this.privOrigLang;
    }
}

//# sourceMappingURL=ConversationTranslationResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslator.js":
/*!****************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslator.js ***!
  \****************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationTranslator": () => (/* binding */ ConversationTranslator),
/* harmony export */   "SpeechState": () => (/* binding */ SpeechState)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _common_speech_Transcription_ConversationTranslatorConnectionFactory__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common.speech/Transcription/ConversationTranslatorConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorConnectionFactory.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognizer.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechTranslationConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ProfanityOption.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ServicePropertyChannel.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioConfig.js");
/* harmony import */ var _Conversation__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./Conversation */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/Conversation.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationCanceledEventArgs.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationCommon.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Multi-device Conversation is a Preview feature.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
/* eslint-disable max-classes-per-file */







var SpeechState;
(function (SpeechState) {
    SpeechState[SpeechState["Inactive"] = 0] = "Inactive";
    SpeechState[SpeechState["Connecting"] = 1] = "Connecting";
    SpeechState[SpeechState["Connected"] = 2] = "Connected";
})(SpeechState || (SpeechState = {}));
// child class of TranslationRecognizer meant only for use with ConversationTranslator
class ConversationTranslationRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.TranslationRecognizer {
    constructor(speechConfig, audioConfig, translator, convGetter) {
        super(speechConfig, audioConfig, new _common_speech_Transcription_ConversationTranslatorConnectionFactory__WEBPACK_IMPORTED_MODULE_1__.ConversationTranslatorConnectionFactory(convGetter));
        this.privSpeechState = SpeechState.Inactive;
        if (!!translator) {
            this.privTranslator = translator;
            this.sessionStarted = () => {
                this.privSpeechState = SpeechState.Connected;
            };
            this.sessionStopped = () => {
                this.privSpeechState = SpeechState.Inactive;
            };
            this.recognizing = (tr, e) => {
                if (!!this.privTranslator.recognizing) {
                    this.privTranslator.recognizing(this.privTranslator, e);
                }
            };
            // eslint-disable-next-line @typescript-eslint/no-misused-promises
            this.recognized = (tr, e) => __awaiter(this, void 0, void 0, function* () {
                var _a;
                // if there is an error connecting to the conversation service from the speech service the error will be returned in the ErrorDetails field.
                if ((_a = e.result) === null || _a === void 0 ? void 0 : _a.errorDetails) {
                    yield this.cancelSpeech();
                    // TODO: format the error message contained in 'errorDetails'
                    this.fireCancelEvent(e.result.errorDetails);
                }
                else {
                    if (!!this.privTranslator.recognized) {
                        this.privTranslator.recognized(this.privTranslator, e);
                    }
                }
                return;
            });
            // eslint-disable-next-line @typescript-eslint/no-misused-promises
            this.canceled = () => __awaiter(this, void 0, void 0, function* () {
                if (this.privSpeechState !== SpeechState.Inactive) {
                    try {
                        yield this.cancelSpeech();
                    }
                    catch (error) {
                        this.privSpeechState = SpeechState.Inactive;
                    }
                }
            });
        }
    }
    get state() {
        return this.privSpeechState;
    }
    set state(newState) {
        this.privSpeechState = newState;
    }
    onConnection() {
        this.privSpeechState = SpeechState.Connected;
    }
    onDisconnection() {
        return __awaiter(this, void 0, void 0, function* () {
            this.privSpeechState = SpeechState.Inactive;
            yield this.cancelSpeech();
        });
    }
    /**
     * Fire a cancel event
     * @param error
     */
    fireCancelEvent(error) {
        try {
            if (!!this.privTranslator.canceled) {
                const cancelEvent = new _Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationTranslationCanceledEventArgs(_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationReason.Error, error, _Exports__WEBPACK_IMPORTED_MODULE_4__.CancellationErrorCode.RuntimeError);
                this.privTranslator.canceled(this.privTranslator, cancelEvent);
            }
        }
        catch (e) {
            //
        }
    }
    cancelSpeech() {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            try {
                this.stopContinuousRecognitionAsync();
                yield ((_a = this.privReco) === null || _a === void 0 ? void 0 : _a.disconnect());
                this.privSpeechState = SpeechState.Inactive;
            }
            catch (e) {
                // ignore the error
            }
        });
    }
}
/**
 * Join, leave or connect to a conversation.
 */
class ConversationTranslator extends _Exports__WEBPACK_IMPORTED_MODULE_5__.ConversationCommon {
    constructor(audioConfig) {
        super(audioConfig);
        this.privErrors = _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__.ConversationConnectionConfig.restErrors;
        this.privIsDisposed = false;
        this.privIsSpeaking = false;
        this.privPlaceholderKey = "abcdefghijklmnopqrstuvwxyz012345";
        this.privPlaceholderRegion = "westus";
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_7__.PropertyCollection();
    }
    get properties() {
        return this.privProperties;
    }
    get speechRecognitionLanguage() {
        return this.privSpeechRecognitionLanguage;
    }
    get participants() {
        var _a;
        return (_a = this.privConversation) === null || _a === void 0 ? void 0 : _a.participants;
    }
    get canSpeak() {
        // is there a Conversation websocket available and has the Recognizer been set up
        if (!this.privConversation.isConnected || !this.privCTRecognizer) {
            return false;
        }
        // is the user already speaking
        if (this.privIsSpeaking || this.privCTRecognizer.state === SpeechState.Connected || this.privCTRecognizer.state === SpeechState.Connecting) {
            return false;
        }
        // is the user muted
        if (this.privConversation.isMutedByHost) {
            return false;
        }
        return true;
    }
    setServiceProperty(name, value) {
        const currentProperties = JSON.parse(this.privProperties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__.ServicePropertiesPropertyName, "{}"));
        currentProperties[name] = value;
        this.privProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__.ServicePropertiesPropertyName, JSON.stringify(currentProperties));
    }
    joinConversationAsync(conversation, nickname, param1, param2, param3) {
        try {
            if (typeof conversation === "string") {
                _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrUndefined(conversation, this.privErrors.invalidArgs.replace("{arg}", "conversation id"));
                _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrWhitespace(nickname, this.privErrors.invalidArgs.replace("{arg}", "nickname"));
                if (!!this.privConversation) {
                    this.handleError(new Error(this.privErrors.permissionDeniedStart), param3);
                }
                let lang = param1;
                if (lang === undefined || lang === null || lang === "") {
                    lang = _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__.ConversationConnectionConfig.defaultLanguageCode;
                }
                // create a placeholder config
                this.privSpeechTranslationConfig = _Exports__WEBPACK_IMPORTED_MODULE_10__.SpeechTranslationConfig.fromSubscription(this.privPlaceholderKey, this.privPlaceholderRegion);
                this.privSpeechTranslationConfig.setProfanity(_Exports__WEBPACK_IMPORTED_MODULE_11__.ProfanityOption.Masked);
                this.privSpeechTranslationConfig.addTargetLanguage(lang);
                this.privSpeechTranslationConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.SpeechServiceConnection_RecoLanguage], lang);
                this.privSpeechTranslationConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.ConversationTranslator_Name], nickname);
                const propertyIdsToCopy = [
                    _Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.SpeechServiceConnection_Host,
                    _Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.ConversationTranslator_Host,
                    _Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.SpeechServiceConnection_Endpoint,
                    _Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.SpeechServiceConnection_ProxyHostName,
                    _Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.SpeechServiceConnection_ProxyPassword,
                    _Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.SpeechServiceConnection_ProxyPort,
                    _Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.SpeechServiceConnection_ProxyUserName,
                    "ConversationTranslator_MultiChannelAudio",
                    "ConversationTranslator_Region"
                ];
                for (const prop of propertyIdsToCopy) {
                    const value = this.privProperties.getProperty(prop);
                    if (value) {
                        const key = typeof prop === "string" ? prop : _Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId[prop];
                        this.privSpeechTranslationConfig.setProperty(key, value);
                    }
                }
                const currentProperties = JSON.parse(this.privProperties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__.ServicePropertiesPropertyName, "{}"));
                for (const prop of Object.keys(currentProperties)) {
                    this.privSpeechTranslationConfig.setServiceProperty(prop, currentProperties[prop], _Exports__WEBPACK_IMPORTED_MODULE_13__.ServicePropertyChannel.UriQueryParameter);
                }
                // join the conversation
                this.privConversation = new _Conversation__WEBPACK_IMPORTED_MODULE_14__.ConversationImpl(this.privSpeechTranslationConfig);
                this.privConversation.conversationTranslator = this;
                this.privConversation.joinConversationAsync(conversation, nickname, lang, ((result) => {
                    if (!result) {
                        this.handleError(new Error(this.privErrors.permissionDeniedConnect), param3);
                    }
                    this.privSpeechTranslationConfig.authorizationToken = result;
                    this.privConversation.room.isHost = false;
                    // connect to the ws
                    this.privConversation.startConversationAsync((() => {
                        this.handleCallback(param2, param3);
                    }), ((error) => {
                        this.handleError(error, param3);
                    }));
                }), ((error) => {
                    this.handleError(error, param3);
                }));
            }
            else if (typeof conversation === "object") {
                _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrUndefined(conversation, this.privErrors.invalidArgs.replace("{arg}", "conversation id"));
                _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrWhitespace(nickname, this.privErrors.invalidArgs.replace("{arg}", "nickname"));
                // save the nickname
                this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.ConversationTranslator_Name, nickname);
                // ref the conversation object
                this.privConversation = conversation;
                // ref the conversation translator object
                this.privConversation.conversationTranslator = this;
                this.privConversation.room.isHost = true;
                _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrUndefined(this.privConversation, this.privErrors.permissionDeniedConnect);
                _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrUndefined(this.privConversation.room.token, this.privErrors.permissionDeniedConnect);
                this.privSpeechTranslationConfig = conversation.config;
                this.handleCallback(param1, param2);
            }
            else {
                this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}", "invalid conversation type")), param2);
            }
        }
        catch (error) {
            this.handleError(error, typeof param1 === "string" ? param3 : param2);
        }
    }
    /**
     * Leave the conversation
     * @param cb
     * @param err
     */
    leaveConversationAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_15__.marshalPromiseToCallbacks)((() => __awaiter(this, void 0, void 0, function* () {
            // stop the speech websocket
            yield this.cancelSpeech();
            // stop the websocket
            yield this.privConversation.endConversationImplAsync();
            // https delete request
            yield this.privConversation.deleteConversationImplAsync();
            this.dispose();
        }))(), cb, err);
    }
    /**
     * Send a text message
     * @param message
     * @param cb
     * @param err
     */
    sendTextMessageAsync(message, cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrUndefined(this.privConversation, this.privErrors.permissionDeniedSend);
            _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrWhitespace(message, this.privErrors.invalidArgs.replace("{arg}", message));
            this.privConversation.sendTextMessageAsync(message, cb, err);
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Start speaking
     * @param cb
     * @param err
     */
    startTranscribingAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_15__.marshalPromiseToCallbacks)((() => __awaiter(this, void 0, void 0, function* () {
            try {
                _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrUndefined(this.privConversation, this.privErrors.permissionDeniedSend);
                _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrUndefined(this.privConversation.room.token, this.privErrors.permissionDeniedConnect);
                if (this.privCTRecognizer === undefined) {
                    yield this.connectTranslatorRecognizer();
                }
                _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrUndefined(this.privCTRecognizer, this.privErrors.permissionDeniedSend);
                if (!this.canSpeak) {
                    this.handleError(new Error(this.privErrors.permissionDeniedSend), err);
                }
                yield this.startContinuousRecognition();
                this.privIsSpeaking = true;
            }
            catch (error) {
                this.privIsSpeaking = false;
                yield this.cancelSpeech();
                throw error;
            }
        }))(), cb, err);
    }
    /**
     * Stop speaking
     * @param cb
     * @param err
     */
    stopTranscribingAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_15__.marshalPromiseToCallbacks)((() => __awaiter(this, void 0, void 0, function* () {
            try {
                if (!this.privIsSpeaking) {
                    // stop speech
                    yield this.cancelSpeech();
                    return;
                }
                // stop the recognition but leave the websocket open
                this.privIsSpeaking = false;
                yield new Promise((resolve, reject) => {
                    this.privCTRecognizer.stopContinuousRecognitionAsync(resolve, reject);
                });
            }
            catch (error) {
                yield this.cancelSpeech();
            }
        }))(), cb, err);
    }
    isDisposed() {
        return this.privIsDisposed;
    }
    dispose(reason, success, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_15__.marshalPromiseToCallbacks)((() => __awaiter(this, void 0, void 0, function* () {
            if (this.isDisposed && !this.privIsSpeaking) {
                return;
            }
            yield this.cancelSpeech();
            this.privIsDisposed = true;
            this.privSpeechTranslationConfig.close();
            this.privSpeechRecognitionLanguage = undefined;
            this.privProperties = undefined;
            this.privAudioConfig = undefined;
            this.privSpeechTranslationConfig = undefined;
            this.privConversation.dispose();
            this.privConversation = undefined;
        }))(), success, err);
    }
    /**
     * Cancel the speech websocket
     */
    cancelSpeech() {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            try {
                this.privIsSpeaking = false;
                yield ((_a = this.privCTRecognizer) === null || _a === void 0 ? void 0 : _a.onDisconnection());
                this.privCTRecognizer = undefined;
            }
            catch (e) {
                // ignore the error
            }
        });
    }
    /**
     * Connect to the speech translation recognizer.
     * Currently there is no language validation performed before sending the SpeechLanguage code to the service.
     * If it's an invalid language the raw error will be: 'Error during WebSocket handshake: Unexpected response code: 400'
     * e.g. pass in 'fr' instead of 'fr-FR', or a text-only language 'cy'
     */
    connectTranslatorRecognizer() {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                if (this.privAudioConfig === undefined) {
                    this.privAudioConfig = _Exports__WEBPACK_IMPORTED_MODULE_16__.AudioConfig.fromDefaultMicrophoneInput();
                }
                // clear the temp subscription key if it's a participant joining
                if (this.privSpeechTranslationConfig.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.SpeechServiceConnection_Key])
                    === this.privPlaceholderKey) {
                    this.privSpeechTranslationConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.SpeechServiceConnection_Key], "");
                }
                const convGetter = () => this.privConversation;
                this.privCTRecognizer = new ConversationTranslationRecognizer(this.privSpeechTranslationConfig, this.privAudioConfig, this, convGetter);
            }
            catch (error) {
                yield this.cancelSpeech();
                throw error;
            }
        });
    }
    /**
     * Handle the start speaking request
     */
    startContinuousRecognition() {
        return new Promise((resolve, reject) => {
            this.privCTRecognizer.startContinuousRecognitionAsync(resolve, reject);
        });
    }
}

//# sourceMappingURL=ConversationTranslator.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/IParticipant.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/IParticipant.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Participant": () => (/* binding */ Participant),
/* harmony export */   "User": () => (/* binding */ User)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Multi-device Conversation is a Preview feature.
/* eslint-disable max-classes-per-file */

class User {
    constructor(userId) {
        this.privUserId = userId;
    }
    get userId() {
        return this.privUserId;
    }
}
class Participant {
    constructor(id, avatar, displayName, isHost, isMuted, isUsingTts, preferredLanguage, voice) {
        this.privId = id;
        this.privAvatar = avatar;
        this.privDisplayName = displayName;
        this.privIsHost = isHost;
        this.privIsMuted = isMuted;
        this.privIsUsingTts = isUsingTts;
        this.privPreferredLanguage = preferredLanguage;
        this.privVoice = voice;
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyCollection();
    }
    get avatar() {
        return this.privAvatar;
    }
    get displayName() {
        return this.privDisplayName;
    }
    get id() {
        return this.privId;
    }
    get preferredLanguage() {
        return this.privPreferredLanguage;
    }
    get isHost() {
        return this.privIsHost;
    }
    get isMuted() {
        return this.privIsMuted;
    }
    get isUsingTts() {
        return this.privIsUsingTts;
    }
    get voice() {
        return this.privVoice;
    }
    get properties() {
        return this.privProperties;
    }
    static From(id, language, voice) {
        return new Participant(id, "", id, false, false, false, language, voice);
    }
}

//# sourceMappingURL=IParticipant.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ParticipantChangedReason.js":
/*!******************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ParticipantChangedReason.js ***!
  \******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ParticipantChangedReason": () => (/* binding */ ParticipantChangedReason)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Multi-device Conversation is a Preview feature.
var ParticipantChangedReason;
(function (ParticipantChangedReason) {
    /** Participant has joined the conversation. */
    ParticipantChangedReason[ParticipantChangedReason["JoinedConversation"] = 0] = "JoinedConversation";
    /** Participant has left the conversation. This could be voluntary, or involuntary
     * (e.g. they are experiencing networking issues).
     */
    ParticipantChangedReason[ParticipantChangedReason["LeftConversation"] = 1] = "LeftConversation";
    /** The participants' state has changed (e.g. they became muted, changed their nickname). */
    ParticipantChangedReason[ParticipantChangedReason["Updated"] = 2] = "Updated";
})(ParticipantChangedReason || (ParticipantChangedReason = {}));

//# sourceMappingURL=ParticipantChangedReason.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionCanceledEventArgs.js":
/*!*******************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionCanceledEventArgs.js ***!
  \*******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationRecognitionCanceledEventArgs": () => (/* binding */ TranslationRecognitionCanceledEventArgs)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Define payload of speech recognition canceled result events.
 * @class TranslationRecognitionCanceledEventArgs
 */
class TranslationRecognitionCanceledEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {string} sessionid - The session id.
     * @param {CancellationReason} cancellationReason - The cancellation reason.
     * @param {string} errorDetails - Error details, if provided.
     * @param {TranslationRecognitionResult} result - The result.
     */
    constructor(sessionid, cancellationReason, errorDetails, errorCode, result) {
        this.privCancelReason = cancellationReason;
        this.privErrorDetails = errorDetails;
        this.privResult = result;
        this.privSessionId = sessionid;
        this.privErrorCode = errorCode;
    }
    /**
     * Specifies the recognition result.
     * @member TranslationRecognitionCanceledEventArgs.prototype.result
     * @function
     * @public
     * @returns {TranslationRecognitionResult} the recognition result.
     */
    get result() {
        return this.privResult;
    }
    /**
     * Specifies the session identifier.
     * @member TranslationRecognitionCanceledEventArgs.prototype.sessionId
     * @function
     * @public
     * @returns {string} the session identifier.
     */
    get sessionId() {
        return this.privSessionId;
    }
    /**
     * The reason the recognition was canceled.
     * @member TranslationRecognitionCanceledEventArgs.prototype.reason
     * @function
     * @public
     * @returns {CancellationReason} Specifies the reason canceled.
     */
    get reason() {
        return this.privCancelReason;
    }
    /**
     * The error code in case of an unsuccessful recognition.
     * Added in version 1.1.0.
     * @return An error code that represents the error reason.
     */
    get errorCode() {
        return this.privErrorCode;
    }
    /**
     * In case of an unsuccessful recognition, provides details of the occurred error.
     * @member TranslationRecognitionCanceledEventArgs.prototype.errorDetails
     * @function
     * @public
     * @returns {string} A String that represents the error details.
     */
    get errorDetails() {
        return this.privErrorDetails;
    }
}

//# sourceMappingURL=TranslationRecognitionCanceledEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionEventArgs.js":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionEventArgs.js ***!
  \***********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationRecognitionEventArgs": () => (/* binding */ TranslationRecognitionEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Translation text result event arguments.
 * @class TranslationRecognitionEventArgs
 */
class TranslationRecognitionEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.RecognitionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {TranslationRecognitionResult} result - The translation recognition result.
     * @param {number} offset - The offset.
     * @param {string} sessionId - The session id.
     */
    constructor(result, offset, sessionId) {
        super(offset, sessionId);
        this.privResult = result;
    }
    /**
     * Specifies the recognition result.
     * @member TranslationRecognitionEventArgs.prototype.result
     * @function
     * @public
     * @returns {TranslationRecognitionResult} the recognition result.
     */
    get result() {
        return this.privResult;
    }
}

//# sourceMappingURL=TranslationRecognitionEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionResult.js":
/*!********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionResult.js ***!
  \********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationRecognitionResult": () => (/* binding */ TranslationRecognitionResult)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionResult.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Translation text result.
 * @class TranslationRecognitionResult
 */
class TranslationRecognitionResult extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SpeechRecognitionResult {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {Translations} translations - The translations.
     * @param {string} resultId - The result id.
     * @param {ResultReason} reason - The reason.
     * @param {string} text - The recognized text.
     * @param {number} duration - The duration.
     * @param {number} offset - The offset into the stream.
     * @param {string} language - Primary Language detected, if provided.
     * @param {string} languageDetectionConfidence - Primary Language confidence ("Unknown," "Low," "Medium," "High"...), if provided.
     * @param {string} errorDetails - Error details, if provided.
     * @param {string} json - Additional Json, if provided.
     * @param {PropertyCollection} properties - Additional properties, if provided.
     */
    constructor(translations, resultId, reason, text, duration, offset, language, languageDetectionConfidence, errorDetails, json, properties) {
        super(resultId, reason, text, duration, offset, language, languageDetectionConfidence, undefined, errorDetails, json, properties);
        this.privTranslations = translations;
    }
    static fromSpeechRecognitionResult(result) {
        return new TranslationRecognitionResult(undefined, result.resultId, result.reason, result.text, result.duration, result.offset, result.language, result.languageDetectionConfidence, result.errorDetails, result.json, result.properties);
    }
    /**
     * Presents the translation results. Each item in the dictionary represents
     * a translation result in one of target languages, where the key is the name
     * of the target language, in BCP-47 format, and the value is the translation
     * text in the specified language.
     * @member TranslationRecognitionResult.prototype.translations
     * @function
     * @public
     * @returns {Translations} the current translation map that holds all translations requested.
     */
    get translations() {
        return this.privTranslations;
    }
}

//# sourceMappingURL=TranslationRecognitionResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognizer.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognizer.js ***!
  \*************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationRecognizer": () => (/* binding */ TranslationRecognizer)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationConnectionFactory.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationServiceRecognizer.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _Connection__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Connection */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Connection.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





/**
 * Translation recognizer
 * @class TranslationRecognizer
 */
class TranslationRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.Recognizer {
    /**
     * Initializes an instance of the TranslationRecognizer.
     * @constructor
     * @param {SpeechTranslationConfig} speechConfig - Set of properties to configure this recognizer.
     * @param {AudioConfig} audioConfig - An optional audio config associated with the recognizer
     * @param {IConnectionFactory} connectionFactory - An optional connection factory to use to generate the endpoint URIs, headers to set, etc...
     */
    constructor(speechConfig, audioConfig, connectionFactory) {
        const configImpl = speechConfig;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(configImpl, "speechConfig");
        super(audioConfig, configImpl.properties, connectionFactory || new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.TranslationConnectionFactory());
        this.privDisposedTranslationRecognizer = false;
        if (this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationVoice, undefined) !== undefined) {
            _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationVoice), _Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationVoice]);
        }
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages), _Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages]);
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_RecoLanguage), _Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_RecoLanguage]);
    }
    /**
     * TranslationRecognizer constructor.
     * @constructor
     * @param {SpeechTranslationConfig} speechTranslationConfig - an set of initial properties for this recognizer
     * @param {AutoDetectSourceLanguageConfig} autoDetectSourceLanguageConfig - An source language detection configuration associated with the recognizer
     * @param {AudioConfig} audioConfig - An optional audio configuration associated with the recognizer
     */
    static FromConfig(speechTranslationConfig, autoDetectSourceLanguageConfig, audioConfig) {
        const speechTranslationConfigImpl = speechTranslationConfig;
        autoDetectSourceLanguageConfig.properties.mergeTo(speechTranslationConfigImpl.properties);
        return new TranslationRecognizer(speechTranslationConfig, audioConfig);
    }
    /**
     * Gets the language name that was set when the recognizer was created.
     * @member TranslationRecognizer.prototype.speechRecognitionLanguage
     * @function
     * @public
     * @returns {string} Gets the language name that was set when the recognizer was created.
     */
    get speechRecognitionLanguage() {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer);
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_RecoLanguage);
    }
    /**
     * Gets target languages for translation that were set when the recognizer was created.
     * The language is specified in BCP-47 format. The translation will provide translated text for each of language.
     * @member TranslationRecognizer.prototype.targetLanguages
     * @function
     * @public
     * @returns {string[]} Gets target languages for translation that were set when the recognizer was created.
     */
    get targetLanguages() {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer);
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",");
    }
    /**
     * Gets the name of output voice.
     * @member TranslationRecognizer.prototype.voiceName
     * @function
     * @public
     * @returns {string} the name of output voice.
     */
    get voiceName() {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer);
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationVoice, undefined);
    }
    /**
     * The collection of properties and their values defined for this TranslationRecognizer.
     * @member TranslationRecognizer.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The collection of properties and their values defined for this TranslationRecognizer.
     */
    get properties() {
        return this.privProperties;
    }
    /**
     * Gets the authorization token used to communicate with the service.
     * @member TranslationRecognizer.prototype.authorizationToken
     * @function
     * @public
     * @returns {string} Authorization token.
     */
    get authorizationToken() {
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceAuthorization_Token);
    }
    /**
     * Gets/Sets the authorization token used to communicate with the service.
     * @member TranslationRecognizer.prototype.authorizationToken
     * @function
     * @public
     * @param {string} value - Authorization token.
     */
    set authorizationToken(value) {
        this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceAuthorization_Token, value);
    }
    /**
     * Starts recognition and translation, and stops after the first utterance is recognized.
     * The task returns the translation text as result.
     * Note: recognizeOnceAsync returns when the first utterance has been recognized, so it is suitable only
     * for single shot recognition like command or query. For long-running recognition,
     * use startContinuousRecognitionAsync() instead.
     * @member TranslationRecognizer.prototype.recognizeOnceAsync
     * @function
     * @public
     * @param cb - Callback that received the result when the translation has completed.
     * @param err - Callback invoked in case of an error.
     */
    recognizeOnceAsync(cb, err) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer);
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.RecognitionMode.Conversation), cb, err);
    }
    /**
     * Starts recognition and translation, until stopContinuousRecognitionAsync() is called.
     * User must subscribe to events to receive translation results.
     * @member TranslationRecognizer.prototype.startContinuousRecognitionAsync
     * @function
     * @public
     * @param cb - Callback that received the translation has started.
     * @param err - Callback invoked in case of an error.
     */
    startContinuousRecognitionAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.RecognitionMode.Conversation), cb, err);
    }
    /**
     * Stops continuous recognition and translation.
     * @member TranslationRecognizer.prototype.stopContinuousRecognitionAsync
     * @function
     * @public
     * @param cb - Callback that received the translation has stopped.
     * @param err - Callback invoked in case of an error.
     */
    stopContinuousRecognitionAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(), cb, err);
    }
    /**
     * dynamically remove a language from list of target language
     * (can be used while recognition is ongoing)
     * @member TranslationRecognizer.prototype.removeTargetLanguage
     * @function
     * @param lang - language to be removed
     * @public
     */
    removeTargetLanguage(lang) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(lang, "language to be removed");
        if (this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages, undefined) !== undefined) {
            const languages = this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",");
            const index = languages.indexOf(lang);
            if (index > -1) {
                languages.splice(index, 1);
                this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages, languages.join(","));
                this.updateLanguages(languages);
            }
        }
    }
    /**
     * dynamically add a language to list of target language
     * (can be used while recognition is ongoing)
     * @member TranslationRecognizer.prototype.addTargetLanguage
     * @function
     * @param lang - language to be added
     * @public
     */
    addTargetLanguage(lang) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(lang, "language to be added");
        let languages = [];
        if (this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages, undefined) !== undefined) {
            languages = this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",");
            if (!languages.includes(lang)) {
                languages.push(lang);
                this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages, languages.join(","));
            }
        }
        else {
            this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages, lang);
            languages = [lang];
        }
        this.updateLanguages(languages);
    }
    /**
     * closes all external resources held by an instance of this class.
     * @member TranslationRecognizer.prototype.close
     * @function
     * @public
     */
    close(cb, errorCb) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer);
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.dispose(true), cb, errorCb);
    }
    /**
     * handles ConnectionEstablishedEvent for conversation translation scenarios.
     * @member TranslationRecognizer.prototype.onConnection
     * @function
     * @public
     */
    // eslint-disable-next-line @typescript-eslint/no-empty-function
    onConnection() { }
    /**
     * handles disconnection events for conversation translation scenarios.
     * @member TranslationRecognizer.prototype.onDisconnection
     * @function
     * @public
     */
    // eslint-disable-next-line @typescript-eslint/no-empty-function
    onDisconnection() {
        return __awaiter(this, void 0, void 0, function* () { });
    }
    dispose(disposing) {
        const _super = Object.create(null, {
            dispose: { get: () => super.dispose }
        });
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privDisposedTranslationRecognizer) {
                return;
            }
            this.privDisposedTranslationRecognizer = true;
            if (disposing) {
                yield this.implRecognizerStop();
                yield _super.dispose.call(this, disposing);
            }
        });
    }
    createRecognizerConfig(speechConfig) {
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.RecognizerConfig(speechConfig, this.privProperties);
    }
    createServiceRecognizer(authentication, connectionFactory, audioConfig, recognizerConfig) {
        const configImpl = audioConfig;
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__.TranslationServiceRecognizer(authentication, connectionFactory, configImpl, recognizerConfig, this);
    }
    updateLanguages(languages) {
        const conn = _Connection__WEBPACK_IMPORTED_MODULE_7__.Connection.fromRecognizer(this);
        if (!!conn) {
            conn.setMessageProperty("speech.context", "translationcontext", { to: languages });
            conn.sendMessageAsync("event", JSON.stringify({
                id: "translation",
                name: "updateLanguage",
                to: languages
            }));
        }
    }
}

//# sourceMappingURL=TranslationRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationSynthesisEventArgs.js":
/*!*********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationSynthesisEventArgs.js ***!
  \*********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationSynthesisEventArgs": () => (/* binding */ TranslationSynthesisEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Translation Synthesis event arguments
 * @class TranslationSynthesisEventArgs
 */
class TranslationSynthesisEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {TranslationSynthesisResult} result - The translation synthesis result.
     * @param {string} sessionId - The session id.
     */
    constructor(result, sessionId) {
        super(sessionId);
        this.privResult = result;
    }
    /**
     * Specifies the translation synthesis result.
     * @member TranslationSynthesisEventArgs.prototype.result
     * @function
     * @public
     * @returns {TranslationSynthesisResult} Specifies the translation synthesis result.
     */
    get result() {
        return this.privResult;
    }
}

//# sourceMappingURL=TranslationSynthesisEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationSynthesisResult.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationSynthesisResult.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationSynthesisResult": () => (/* binding */ TranslationSynthesisResult)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines translation synthesis result, i.e. the voice output of the translated
 * text in the target language.
 * @class TranslationSynthesisResult
 */
class TranslationSynthesisResult {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {ResultReason} reason - The synthesis reason.
     * @param {ArrayBuffer} audio - The audio data.
     */
    constructor(reason, audio) {
        this.privReason = reason;
        this.privAudio = audio;
    }
    /**
     * Translated text in the target language.
     * @member TranslationSynthesisResult.prototype.audio
     * @function
     * @public
     * @returns {ArrayBuffer} Translated audio in the target language.
     */
    get audio() {
        return this.privAudio;
    }
    /**
     * The synthesis status.
     * @member TranslationSynthesisResult.prototype.reason
     * @function
     * @public
     * @returns {ResultReason} The synthesis status.
     */
    get reason() {
        return this.privReason;
    }
}

//# sourceMappingURL=TranslationSynthesisResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Translations.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Translations.js ***!
  \****************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Translations": () => (/* binding */ Translations)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Represents collection of parameters and their values.
 * @class Translations
 */
class Translations {
    constructor() {
        // Use an PropertyCollection internally, just wrapping it to hide the | enum syntax it has.
        this.privMap = new _Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyCollection();
    }
    /**
     * Get the languages in the object in a String array.
     * @member Translations.prototype.languages
     * @function
     * @public
     * @returns {string[]} languages in translations object.
     */
    get languages() {
        return this.privMap.keys;
    }
    /**
     * Returns the parameter value in type String. The parameter must have the same type as String.
     * Currently only String, int and bool are allowed.
     * If the name is not available, the specified defaultValue is returned.
     * @member Translations.prototype.get
     * @function
     * @public
     * @param {string} key - The parameter name.
     * @param {string} def - The default value which is returned if the parameter is not available in the collection.
     * @returns {string} value of the parameter.
     */
    get(key, def) {
        return this.privMap.getProperty(key, def);
    }
    /**
     * Sets the String value of the parameter specified by name.
     * @member Translations.prototype.set
     * @function
     * @public
     * @param {string} key - The parameter name.
     * @param {string} value - The value of the parameter.
     */
    set(key, value) {
        this.privMap.setProperty(key, value);
    }
}

//# sourceMappingURL=Translations.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TurnStatusReceivedEventArgs.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TurnStatusReceivedEventArgs.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TurnStatusReceivedEventArgs": () => (/* binding */ TurnStatusReceivedEventArgs)
/* harmony export */ });
/* harmony import */ var _common_speech_ServiceMessages_TurnStatusPayload__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common.speech/ServiceMessages/TurnStatusPayload */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TurnStatusPayload.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Defines contents of received message/events.
 * @class TurnStatusReceivedEventArgs
 */
class TurnStatusReceivedEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {string} turnStatus - The JSON-encoded turn status message.
     */
    constructor(turnStatus) {
        this.privTurnStatus = _common_speech_ServiceMessages_TurnStatusPayload__WEBPACK_IMPORTED_MODULE_0__.TurnStatusResponsePayload.fromJSON(turnStatus);
    }
    /**
     * Gets the interaction identifier associated with this turn status event.
     * @member TurnStatusReceivedEventArgs.prototype.interactionId
     * @function
     * @public
     * @returns {any} the received interaction id.
     */
    get interactionId() {
        return this.privTurnStatus.interactionId;
    }
    /**
     * Gets the conversation identifier associated with this turn status event.
     * @member TurnStatusReceivedEventArgs.prototype.conversationId
     * @function
     * @public
     * @returns {any} the received conversation id.
     */
    get conversationId() {
        return this.privTurnStatus.conversationId;
    }
    /**
     * Gets the received turn status code.
     * @member TurnStatusReceivedEventArgs.prototype.statusCode
     * @function
     * @public
     * @returns {number} the received turn status.
     */
    get statusCode() {
        return this.privTurnStatus.statusCode; // eslint-disable-line @typescript-eslint/no-unsafe-return
    }
}

//# sourceMappingURL=TurnStatusReceivedEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceInfo.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceInfo.js ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SynthesisVoiceGender": () => (/* binding */ SynthesisVoiceGender),
/* harmony export */   "SynthesisVoiceType": () => (/* binding */ SynthesisVoiceType),
/* harmony export */   "VoiceInfo": () => (/* binding */ VoiceInfo)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines the gender of synthesis voices.
 * Added in version 1.20.0.
 */
var SynthesisVoiceGender;
(function (SynthesisVoiceGender) {
    /** Gender unknown */
    SynthesisVoiceGender[SynthesisVoiceGender["Unknown"] = 0] = "Unknown";
    /** Female voice */
    SynthesisVoiceGender[SynthesisVoiceGender["Female"] = 1] = "Female";
    /** Male voice */
    SynthesisVoiceGender[SynthesisVoiceGender["Male"] = 2] = "Male";
})(SynthesisVoiceGender || (SynthesisVoiceGender = {}));
var SynthesisVoiceType;
(function (SynthesisVoiceType) {
    SynthesisVoiceType[SynthesisVoiceType["OnlineNeural"] = 1] = "OnlineNeural";
    SynthesisVoiceType[SynthesisVoiceType["OnlineStandard"] = 2] = "OnlineStandard";
    SynthesisVoiceType[SynthesisVoiceType["OfflineNeural"] = 3] = "OfflineNeural";
    SynthesisVoiceType[SynthesisVoiceType["OfflineStandard"] = 4] = "OfflineStandard";
})(SynthesisVoiceType || (SynthesisVoiceType = {}));
/**
 * Information about Speech Synthesis voice
 * Added in version 1.20.0.
 * @class VoiceInfo
 */
class VoiceInfo {
    constructor(json) {
        this.privStyleList = [];
        this.privVoicePath = "";
        if (!!json) {
            this.privName = json.Name;
            this.privLocale = json.Locale;
            this.privShortName = json.ShortName;
            this.privLocaleName = json.LocaleName;
            this.privLocalName = json.LocalName;
            this.privVoiceType = json.VoiceType.endsWith("Standard") ? SynthesisVoiceType.OnlineStandard : SynthesisVoiceType.OnlineNeural;
            this.privGender = json.Gender === "Male" ? SynthesisVoiceGender.Male : json.Gender === "Female" ? SynthesisVoiceGender.Female : SynthesisVoiceGender.Unknown;
            if (!!json.StyleList && Array.isArray(json.StyleList)) {
                for (const style of json.StyleList) {
                    this.privStyleList.push(style);
                }
            }
        }
    }
    get name() {
        return this.privName;
    }
    get locale() {
        return this.privLocale;
    }
    get shortName() {
        return this.privShortName;
    }
    get localName() {
        return this.privLocalName;
    }
    get localeName() {
        return this.privLocaleName;
    }
    get gender() {
        return this.privGender;
    }
    get voiceType() {
        return this.privVoiceType;
    }
    get styleList() {
        return this.privStyleList;
    }
    get voicePath() {
        return this.privVoicePath;
    }
}

//# sourceMappingURL=VoiceInfo.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfile.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfile.js ***!
  \****************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "VoiceProfile": () => (/* binding */ VoiceProfile)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines Voice Profile class for Speaker Recognition
 * @class VoiceProfile
 */
class VoiceProfile {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {string} profileId - profileId of this Voice Profile.
     * @param {VoiceProfileType} profileType - profileType of this Voice Profile.
     */
    constructor(profileId, profileType) {
        this.privId = profileId;
        this.privProfileType = profileType;
    }
    /**
     * profileId of this Voice Profile instance
     * @member VoiceProfile.prototype.profileId
     * @function
     * @public
     * @returns {string} profileId of this Voice Profile instance.
     */
    get profileId() {
        return this.privId;
    }
    /**
     * profileType of this Voice Profile instance
     * @member VoiceProfile.prototype.profileType
     * @function
     * @public
     * @returns {VoiceProfileType} profile type of this Voice Profile instance.
     */
    get profileType() {
        return this.privProfileType;
    }
}

//# sourceMappingURL=VoiceProfile.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileClient.js":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileClient.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "VoiceProfileClient": () => (/* binding */ VoiceProfileClient)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerRecognitionConnectionFactory.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/VoiceServiceRecognizer.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _Audio_AudioConfig__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Audio/AudioConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioConfig.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioInputStream.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfile.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileResult.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




/**
 * Defines VoiceProfileClient class for Speaker Recognition
 * Handles operations from user for Voice Profile operations (e.g. createProfile, deleteProfile)
 * @class VoiceProfileClient
 */
class VoiceProfileClient extends _Exports__WEBPACK_IMPORTED_MODULE_0__.Recognizer {
    /**
     * VoiceProfileClient constructor.
     * @constructor
     * @param {SpeechConfig} speechConfig - An set of initial properties for this synthesizer (authentication key, region, &c)
     */
    constructor(speechConfig) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(speechConfig, "speechConfig");
        const speechConfigImpl = speechConfig;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(speechConfigImpl, "speechConfig");
        super(_Audio_AudioConfig__WEBPACK_IMPORTED_MODULE_2__.AudioConfig.fromStreamInput(_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioInputStream.createPushStream()), speechConfigImpl.properties, new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.VoiceProfileConnectionFactory());
        this.privProperties = speechConfigImpl.properties.clone();
        this.privVoiceAdapter = this.privReco;
        this.privDisposedVoiceAdapter = false;
    }
    /**
     * The collection of properties and their values defined for this VoiceProfileClient.
     * @member VoiceProfileClient.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The collection of properties and their values defined for this VoiceProfileClient.
     */
    get properties() {
        return this.privProperties;
    }
    /**
     * Gets the authorization token used to communicate with the service.
     * @member VoiceProfileClient.prototype.authorizationToken
     * @function
     * @public
     * @returns {string} Authorization token.
     */
    get authorizationToken() {
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_5__.PropertyId.SpeechServiceAuthorization_Token);
    }
    /**
     * Gets/Sets the authorization token used to communicate with the service.
     * @member VoiceProfileClient.prototype.authorizationToken
     * @function
     * @public
     * @param {string} token - Authorization token.
     */
    set authorizationToken(token) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(token, "token");
        this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_5__.PropertyId.SpeechServiceAuthorization_Token, token);
    }
    /**
     * Create a speaker recognition voice profile
     * @member VoiceProfileClient.prototype.createProfileAsync
     * @function
     * @public
     * @async
     * @param {VoiceProfileType} profileType Type of Voice Profile to be created
     * @param {string} lang Language string (locale) for Voice Profile
     * @return {Promise<VoiceProfile>} - Promise of a VoiceProfile.
     */
    createProfileAsync(profileType, lang) {
        return __awaiter(this, void 0, void 0, function* () {
            const profileIds = yield this.privVoiceAdapter.createProfile(profileType, lang);
            return new _Exports__WEBPACK_IMPORTED_MODULE_6__.VoiceProfile(profileIds[0], profileType);
        });
    }
    /**
     * Get current information of a voice profile
     * @member VoiceProfileClient.prototype.retrieveEnrollmentResultAsync
     * @function
     * @public
     * @async
     * @param {VoiceProfile} profile Voice Profile to retrieve info for
     * @return {Promise<VoiceProfileEnrollmentResult>} - Promise of a VoiceProfileEnrollmentResult.
     */
    retrieveEnrollmentResultAsync(profile) {
        return __awaiter(this, void 0, void 0, function* () {
            return this.privVoiceAdapter.retrieveEnrollmentResult(profile);
        });
    }
    /**
     * Get all voice profiles on account with given voice profile type
     * @member VoiceProfileClient.prototype.getAllProfilesAsync
     * @function
     * @public
     * @async
     * @param {VoiceProfileType} profileType profile type (identification/verification) for which to list profiles
     * @return {Promise<VoiceProfileEnrollmentResult[]>} - Promise of an array of VoiceProfileEnrollmentResults.
     */
    getAllProfilesAsync(profileType) {
        return __awaiter(this, void 0, void 0, function* () {
            return this.privVoiceAdapter.getAllProfiles(profileType);
            /*
            const result: { json: { value: EnrollmentResultJSON[] } } = await this.privAdapter.getProfiles(profileType);
            if (profileType === VoiceProfileType.TextIndependentIdentification) {
                return VoiceProfileEnrollmentResult.FromIdentificationProfileList(result.json);
            }
            return VoiceProfileEnrollmentResult.FromVerificationProfileList(result.json);
            */
        });
    }
    /**
     * Get valid authorization phrases for voice profile enrollment
     * @member VoiceProfileClient.prototype.getActivationPhrasesAsync
     * @function
     * @public
     * @async
     * @param {VoiceProfileType} profileType Profile Type to get activation phrases for
     * @param {string} lang Language string (locale) for Voice Profile
     */
    getActivationPhrasesAsync(profileType, lang) {
        return __awaiter(this, void 0, void 0, function* () {
            return this.privVoiceAdapter.getActivationPhrases(profileType, lang);
        });
    }
    /**
     * Create a speaker recognition voice profile
     * @member VoiceProfileClient.prototype.enrollProfileAsync
     * @function
     * @public
     * @async
     * @param {VoiceProfile} profile Voice Profile to create enrollment for
     * @param {AudioConfig} audioConfig source info from which to create enrollment
     * @return {Promise<VoiceProfileEnrollmentResult>} - Promise of a VoiceProfileEnrollmentResult.
     */
    enrollProfileAsync(profile, audioConfig) {
        return __awaiter(this, void 0, void 0, function* () {
            const configImpl = audioConfig;
            _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(configImpl, "audioConfig");
            this.audioConfig = audioConfig;
            this.privVoiceAdapter.SpeakerAudioSource = configImpl;
            return this.privVoiceAdapter.enrollProfile(profile);
        });
    }
    /**
     * Delete a speaker recognition voice profile
     * @member VoiceProfileClient.prototype.deleteProfileAsync
     * @function
     * @public
     * @async
     * @param {VoiceProfile} profile Voice Profile to be deleted
     * @return {Promise<VoiceProfileResult>} - Promise of a VoiceProfileResult.
     */
    deleteProfileAsync(profile) {
        return __awaiter(this, void 0, void 0, function* () {
            return this.privVoiceAdapter.deleteProfile(profile);
        });
    }
    /**
     * Remove all enrollments for a speaker recognition voice profile
     * @member VoiceProfileClient.prototype.resetProfileAsync
     * @function
     * @public
     * @async
     * @param {VoiceProfile} profile Voice Profile to be reset
     * @return {Promise<VoiceProfileResult>} - Promise of a VoiceProfileResult.
     */
    resetProfileAsync(profile) {
        return __awaiter(this, void 0, void 0, function* () {
            return this.privVoiceAdapter.resetProfile(profile);
        });
    }
    /**
     * Clean up object and close underlying connection
     * @member VoiceProfileClient.prototype.close
     * @function
     * @async
     * @public
     */
    close() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.dispose(true);
        });
    }
    createServiceRecognizer(authentication, connectionFactory, audioConfig, recognizerConfig) {
        const audioImpl = audioConfig;
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__.VoiceServiceRecognizer(authentication, connectionFactory, audioImpl, recognizerConfig, this);
    }
    dispose(disposing) {
        const _super = Object.create(null, {
            dispose: { get: () => super.dispose }
        });
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privDisposedVoiceAdapter) {
                return;
            }
            this.privDisposedVoiceAdapter = true;
            if (disposing) {
                yield _super.dispose.call(this, disposing);
            }
        });
    }
    createRecognizerConfig(speechConfig) {
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__.RecognizerConfig(speechConfig, this.properties);
    }
    getResult(result, successReason) {
        const response = new _Exports__WEBPACK_IMPORTED_MODULE_9__.VoiceProfileResult(result.ok ? successReason : _Exports__WEBPACK_IMPORTED_MODULE_10__.ResultReason.Canceled, result.statusText);
        return (response);
    }
}

//# sourceMappingURL=VoiceProfileClient.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileEnrollmentResult.js":
/*!********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileEnrollmentResult.js ***!
  \********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "VoiceProfileEnrollmentCancellationDetails": () => (/* binding */ VoiceProfileEnrollmentCancellationDetails),
/* harmony export */   "VoiceProfileEnrollmentResult": () => (/* binding */ VoiceProfileEnrollmentResult)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetailsBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */


/**
 * Output format
 * @class VoiceProfileEnrollmentResult
 */
class VoiceProfileEnrollmentResult {
    constructor(reason, json, statusText) {
        this.privReason = reason;
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyCollection();
        if (this.privReason !== _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.Canceled) {
            if (!!json) {
                this.privDetails = JSON.parse(json);
                if (this.privDetails.enrollmentStatus.toLowerCase() === "enrolling") {
                    this.privReason = _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.EnrollingVoiceProfile;
                }
            }
        }
        else {
            this.privErrorDetails = statusText;
            this.privProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationErrorCodePropertyName, _Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode[_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.ServiceError]);
        }
    }
    get reason() {
        return this.privReason;
    }
    get enrollmentsCount() {
        return this.privDetails.enrollmentsCount;
    }
    get enrollmentsLength() {
        return this.privDetails.enrollmentsLength;
    }
    get properties() {
        return this.privProperties;
    }
    get enrollmentResultDetails() {
        return this.privDetails;
    }
    get errorDetails() {
        return this.privErrorDetails;
    }
    static FromIdentificationProfileList(json) {
        const results = [];
        for (const item of json.value) {
            const reason = item.enrollmentStatus.toLowerCase() === "enrolling" ?
                _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.EnrollingVoiceProfile : item.enrollmentStatus.toLowerCase() === "enrolled" ?
                _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.EnrolledVoiceProfile : _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.Canceled;
            const result = new VoiceProfileEnrollmentResult(reason, null, null);
            result.privDetails = this.getIdentificationDetails(item);
            results.push(result);
        }
        return results;
    }
    static FromVerificationProfileList(json) {
        const results = [];
        for (const item of json.value) {
            const reason = item.enrollmentStatus.toLowerCase() === "enrolling" ?
                _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.EnrollingVoiceProfile : item.enrollmentStatus.toLowerCase() === "enrolled" ?
                _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.EnrolledVoiceProfile : _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.Canceled;
            const result = new VoiceProfileEnrollmentResult(reason, null, null);
            result.privDetails = this.getVerificationDetails(item);
            results.push(result);
        }
        return results;
    }
    static getIdentificationDetails(json) {
        return {
            audioLength: json.audioLength ? parseFloat(json.audioLength) : 0,
            audioSpeechLength: json.audioSpeechLength ? parseFloat(json.audioSpeechLength) : 0,
            enrollmentStatus: json.enrollmentStatus,
            enrollmentsCount: json.enrollmentsCount || 0,
            enrollmentsLength: json.enrollmentsLength ? parseFloat(json.enrollmentsLength) : 0,
            enrollmentsSpeechLength: json.enrollmentsSpeechLength ? parseFloat(json.enrollmentsSpeechLength) : 0,
            profileId: json.profileId || json.identificationProfileId,
            remainingEnrollmentsSpeechLength: json.remainingEnrollmentsSpeechLength ? parseFloat(json.remainingEnrollmentsSpeechLength) : 0
        };
    }
    static getVerificationDetails(json) {
        return {
            audioLength: json.audioLength ? parseFloat(json.audioLength) : 0,
            audioSpeechLength: json.audioSpeechLength ? parseFloat(json.audioSpeechLength) : 0,
            enrollmentStatus: json.enrollmentStatus,
            enrollmentsCount: json.enrollmentsCount,
            enrollmentsLength: json.enrollmentsLength ? parseFloat(json.enrollmentsLength) : 0,
            enrollmentsSpeechLength: json.enrollmentsSpeechLength ? parseFloat(json.enrollmentsSpeechLength) : 0,
            profileId: json.profileId || json.verificationProfileId,
            remainingEnrollmentsCount: json.remainingEnrollments || json.remainingEnrollmentsCount,
            remainingEnrollmentsSpeechLength: json.remainingEnrollmentsSpeechLength ? parseFloat(json.remainingEnrollmentsSpeechLength) : 0
        };
    }
}
/**
 * @class VoiceProfileEnrollmentCancellationDetails
 */
class VoiceProfileEnrollmentCancellationDetails extends _Exports__WEBPACK_IMPORTED_MODULE_4__.CancellationDetailsBase {
    constructor(reason, errorDetails, errorCode) {
        super(reason, errorDetails, errorCode);
    }
    /**
     * Creates an instance of VoiceProfileEnrollmentCancellationDetails object for the canceled VoiceProfileEnrollmentResult.
     * @member VoiceProfileEnrollmentCancellationDetails.fromResult
     * @function
     * @public
     * @param {VoiceProfileEnrollmentResult} result - The result that was canceled.
     * @returns {VoiceProfileEnrollmentCancellationDetails} The cancellation details object being created.
     */
    static fromResult(result) {
        const reason = _Exports__WEBPACK_IMPORTED_MODULE_5__.CancellationReason.Error;
        let errorCode = _Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.NoError;
        if (!!result.properties) {
            errorCode = _Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode[result.properties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationErrorCodePropertyName, _Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode[_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.NoError])]; //eslint-disable-line
        }
        return new VoiceProfileEnrollmentCancellationDetails(reason, result.errorDetails, errorCode);
    }
}

//# sourceMappingURL=VoiceProfileEnrollmentResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfilePhraseResult.js":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfilePhraseResult.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "VoiceProfilePhraseResult": () => (/* binding */ VoiceProfilePhraseResult)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileResult.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


/**
 * Output format
 * @class VoiceProfilePhraseResult
 */
class VoiceProfilePhraseResult extends _Exports__WEBPACK_IMPORTED_MODULE_0__.VoiceProfileResult {
    constructor(reason, statusText, type, phraseArray) {
        super(reason, statusText);
        this.privPhrases = [];
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(phraseArray, "phrase array");
        this.privType = type;
        if (!!phraseArray && !!phraseArray[0]) {
            this.privPhrases = phraseArray;
        }
    }
    get phrases() {
        return this.privPhrases;
    }
    get type() {
        return this.privType;
    }
}

//# sourceMappingURL=VoiceProfilePhraseResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileResult.js":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileResult.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "VoiceProfileCancellationDetails": () => (/* binding */ VoiceProfileCancellationDetails),
/* harmony export */   "VoiceProfileResult": () => (/* binding */ VoiceProfileResult)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetailsBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */



/**
 * Output format
 * @class VoiceProfileResult
 */
class VoiceProfileResult {
    constructor(reason, statusText) {
        this.privReason = reason;
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyCollection();
        if (reason === _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.Canceled) {
            _Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrUndefined(statusText, "statusText");
            this.privErrorDetails = statusText;
            this.privProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCodePropertyName, _Exports__WEBPACK_IMPORTED_MODULE_4__.CancellationErrorCode[_Exports__WEBPACK_IMPORTED_MODULE_4__.CancellationErrorCode.ServiceError]);
        }
    }
    get reason() {
        return this.privReason;
    }
    get properties() {
        return this.privProperties;
    }
    get errorDetails() {
        return this.privErrorDetails;
    }
}
/**
 * @class VoiceProfileCancellationDetails
 */
class VoiceProfileCancellationDetails extends _Exports__WEBPACK_IMPORTED_MODULE_5__.CancellationDetailsBase {
    constructor(reason, errorDetails, errorCode) {
        super(reason, errorDetails, errorCode);
    }
    /**
     * Creates an instance of VoiceProfileCancellationDetails object for the canceled VoiceProfileResult.
     * @member VoiceProfileCancellationDetails.fromResult
     * @function
     * @public
     * @param {VoiceProfileResult} result - The result that was canceled.
     * @returns {VoiceProfileCancellationDetails} The cancellation details object being created.
     */
    static fromResult(result) {
        const reason = _Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationReason.Error;
        let errorCode = _Exports__WEBPACK_IMPORTED_MODULE_4__.CancellationErrorCode.NoError;
        if (!!result.properties) {
            errorCode = _Exports__WEBPACK_IMPORTED_MODULE_4__.CancellationErrorCode[result.properties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCodePropertyName, _Exports__WEBPACK_IMPORTED_MODULE_4__.CancellationErrorCode[_Exports__WEBPACK_IMPORTED_MODULE_4__.CancellationErrorCode.NoError])]; //eslint-disable-line
        }
        return new VoiceProfileCancellationDetails(reason, result.errorDetails, errorCode);
    }
}

//# sourceMappingURL=VoiceProfileResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileType.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileType.js ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "VoiceProfileType": () => (/* binding */ VoiceProfileType)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Output format
 * @class VoiceProfileType
 */
var VoiceProfileType;
(function (VoiceProfileType) {
    /**
     * Text independent speaker identification
     * @member VoiceProfileType.TextIndependentIdentification
     */
    VoiceProfileType[VoiceProfileType["TextIndependentIdentification"] = 0] = "TextIndependentIdentification";
    /**
     * Text dependent speaker verification
     * @member VoiceProfileType.TextDependentVerification
     */
    VoiceProfileType[VoiceProfileType["TextDependentVerification"] = 1] = "TextDependentVerification";
    /**
     * Text independent speaker verification
     * @member VoiceProfileType.TextIndependentVerification
     */
    VoiceProfileType[VoiceProfileType["TextIndependentVerification"] = 2] = "TextIndependentVerification";
})(VoiceProfileType || (VoiceProfileType = {}));

//# sourceMappingURL=VoiceProfileType.js.map


/***/ }),

/***/ "./src/Options/models.ts":
/*!*******************************!*\
  !*** ./src/Options/models.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.models = void 0;
exports.models = [
    {
        'name': 'gpt-3.5-turbo',
        'id': 'openai/gpt-3.5-turbo'
    },
    {
        'name': 'gpt-3.5-turbo-16k',
        'id': 'openai/gpt-3.5-turbo-16k'
    },
    {
        'name': 'gpt-4',
        'id': 'openai/gpt-4'
    },
    {
        'name': 'gpt-4-32k',
        'id': 'openai/gpt-4-32k'
    },
    {
        'name': 'claude-2',
        'id': 'anthropic/claude-2'
    },
    {
        'name': 'claude-instant-v1',
        'id': 'anthropic/claude-instant-v1'
    },
    {
        'name': 'PaLM 2 Bison',
        'id': 'google/palm-2-chat-bison'
    },
    {
        'name': 'Llama v2 13B Chat (beta)',
        'id': 'meta-llama/llama-2-13b-chat'
    }
];


/***/ }),

/***/ "./src/Options/util.ts":
/*!*****************************!*\
  !*** ./src/Options/util.ts ***!
  \*****************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.getSettings = void 0;
const webextension_polyfill_1 = __importDefault(__webpack_require__(/*! webextension-polyfill */ "./node_modules/webextension-polyfill/dist/browser-polyfill.js"));
const models_1 = __webpack_require__(/*! ./models */ "./src/Options/models.ts");
function getSettings() {
    return __awaiter(this, void 0, void 0, function* () {
        let items = yield webextension_polyfill_1.default.storage.sync.get({
            "openApiKey": '',
            "openApiEndpoint": 'https://api.openai.com',
            "unsplashApiKey": '',
            "currentLanguage": '',
            "targetLanguage": '',
            "ankiDeckName": '',
            "licenseKey": '',
            "model": models_1.models[0]['id'], "apiKeySelection": 'licenseKey'
        });
        return items;
    });
}
exports.getSettings = getSettings;


/***/ }),

/***/ "./src/background.ts":
/*!***************************!*\
  !*** ./src/background.ts ***!
  \***************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
const webextension_polyfill_1 = __importDefault(__webpack_require__(/*! webextension-polyfill */ "./node_modules/webextension-polyfill/dist/browser-polyfill.js"));
const eventsource_parser_1 = __webpack_require__(/*! eventsource-parser */ "./node_modules/eventsource-parser/dist/index.js");
const util_1 = __webpack_require__(/*! ./util */ "./src/util.ts");
const unsplash_js_1 = __webpack_require__(/*! unsplash-js */ "./node_modules/unsplash-js/dist/unsplash-js.esm.js");
const util_2 = __webpack_require__(/*! ./Options/util */ "./src/Options/util.ts");
// content script  false 
// let isContinue = true
let controller = new AbortController();
const defaultOpenApiEndpoint = 'https://api.openai.com';
console.log('I am background');
webextension_polyfill_1.default.runtime.onInstalled.addListener(function () {
    console.log("");
});
// 
webextension_polyfill_1.default.runtime.setUninstallURL("https://docs.google.com/forms/d/e/1FAIpQLSdobGQN3O0Ck4fVrgfvRZMme3de-2OaEp1pFtibZkU0koc37w/viewform?usp=sf_link");
// 
webextension_polyfill_1.default.contextMenus.create({
    id: "2",
    title: "Run last prompt",
    contexts: ["selection"],
}, () => {
    webextension_polyfill_1.default.runtime.lastError;
});
webextension_polyfill_1.default.contextMenus.create({
    id: "1",
    title: "Open",
    contexts: ["selection"],
}, () => {
    webextension_polyfill_1.default.runtime.lastError;
});
// 
webextension_polyfill_1.default.contextMenus.onClicked.addListener(function (info, _tab) {
    return __awaiter(this, void 0, void 0, function* () {
        console.log('');
        console.log(info);
        const runPrompt = info.menuItemId === '2' ? true : false;
        sendMessageToContent(runPrompt);
    });
});
// 
webextension_polyfill_1.default.commands.onCommand.addListener(function (command) {
    console.log('hello');
    if (command === 'RunLastPrompt') {
        // 
        sendMessageToContent();
    }
});
//  GPT 
webextension_polyfill_1.default.runtime.onConnect.addListener(port => {
    //  content script 
    console.log('------------');
    console.log('process.env.AMPLITUDE_KEY:');
    console.log("ed720e33b4190ef29a0718a040bbb55a");
    console.log("MISSING_ENV_VAR");
    // amplitude.init(process.env.AMPLITUDE_KEY as string);
    // amplitude.track('executivePrompt');
    //  content script 
    port.onMessage.addListener((msg) => __awaiter(void 0, void 0, void 0, function* () {
        console.log('', msg);
        //  API Key 
        let openApiKey, apiKeySelection, model, licenseKey, currentLanguage, openApiEndpoint, targetLanguage = '';
        (0, util_2.getSettings)().then((result) => {
            apiKeySelection = result.apiKeySelection;
            licenseKey = result.licenseKey;
            openApiKey = result.openApiKey;
            openApiEndpoint = result.openApiEndpoint;
            currentLanguage = result.currentLanguage;
            targetLanguage = result.targetLanguage;
            model = result.model;
            //   GPT 
            if (msg.type === 'getGPTMsg') {
                console.log('getGPTMsg');
                // isContinue = true 
                // isContinue = true
                // controller.abort();
                controller = new AbortController();
                let messages = msg.messages;
                console.log(messages);
                //==================== 
                // port.postMessage({ 'type': 'sendGPTData', 'status': 'erro', 'content': ' API Key error. Please modify and try again..' })
                // port.postMessage({ 'type': 'sendGPTData', 'status': 'erro', 'content': ' Encountered some issues, please try again later.' })
                // setTimeout(() => {
                //   const now = new Date();
                //   port.postMessage({ 'type': 'sendGPTData', 'status': 'begin', 'content': '' })
                //   port.postMessage({ 'type': 'sendGPTData', 'status': 'process', 'content': `${now}` })
                //   setTimeout(() => {
                //     for (let i = 0; i < 20; i++) {
                //       port.postMessage({ 'type': 'sendGPTData', 'status': 'process', 'content': "W" })
                //       // if (!isContinue) {
                //       //   console.log('')
                //       //   break
                //       // }
                //     }
                //     port.postMessage({ 'type': 'sendGPTData', 'status': 'process', 'content': messages[messages.length - 1].content })
                //     port.postMessage({ 'type': 'sendGPTData', 'status': 'end', 'content': "" })
                //   }, 1000);
                // }, 1400);
                // return
                // ====================
                if (openApiKey.length < 5 && licenseKey.length < 5) {
                    port.postMessage({ 'type': 'sendGPTData', 'status': 'erro', 'code': 'invalid_api_key', 'content': ' API Key error. Please modify and try again..' });
                    return;
                }
                if (openApiEndpoint.length < 5) {
                    openApiEndpoint = defaultOpenApiEndpoint;
                }
                let headers = {};
                let body;
                //  Key
                if (apiKeySelection === 'licenseKey') {
                    // 
                    openApiEndpoint = 'https://openrouter.ai/api/v1/chat/completions';
                    openApiKey = licenseKey;
                    headers = {
                        'Authorization': 'Bearer ' + openApiKey,
                        'Content-Type': 'application/json',
                        'HTTP-Referer': 'https://notes.dabing.one/',
                        'X-Title': 'Scouter'
                    };
                    body = JSON.stringify({
                        "model": model,
                        "messages": messages,
                        "temperature": 0.7,
                        "max_tokens": 420,
                        "top_p": 1,
                        "frequency_penalty": 0,
                        "presence_penalty": 2,
                        "stream": true
                    });
                }
                else {
                    //  Key
                    if (openApiEndpoint.indexOf('azure.com') > -1) {
                        // Azure
                        headers = { 'api-key': openApiKey, 'Content-Type': 'application/json', };
                        body = JSON.stringify({
                            "model": "gpt-35-turbo",
                            "messages": messages,
                            "temperature": 0.7,
                            "max_tokens": 420,
                            "top_p": 1,
                            "frequency_penalty": 0,
                            "presence_penalty": 2,
                            "stream": true
                        });
                    }
                    else {
                        // OpenAI
                        headers = { 'Authorization': 'Bearer ' + openApiKey, 'Content-Type': 'application/json', };
                        //  \ 
                        if (openApiEndpoint.slice(-1) === "/") {
                            openApiEndpoint = openApiEndpoint.slice(0, -1);
                        }
                        openApiEndpoint += '/v1/chat/completions';
                        body = JSON.stringify({
                            "model": "gpt-3.5-turbo",
                            "messages": messages,
                            "temperature": 0.7,
                            "max_tokens": 420,
                            "top_p": 1,
                            "frequency_penalty": 0,
                            "presence_penalty": 2,
                            "stream": true
                        });
                    }
                }
                fetch(openApiEndpoint, {
                    signal: controller.signal,
                    method: "POST",
                    body: body,
                    headers: headers
                }).then((response) => __awaiter(void 0, void 0, void 0, function* () {
                    var _a;
                    port.postMessage({ 'type': 'sendGPTData', 'status': 'begin', 'content': '' });
                    if (response.status !== 200) {
                        // API KEY Error
                        response.json().then((data) => {
                            console.log(data);
                            port.postMessage({ 'type': 'sendGPTData', 'status': 'erro', 'content': ' ' + data.error.message, 'code': data.error.code });
                            return;
                        });
                    }
                    //  server-sent events
                    const parser = (0, eventsource_parser_1.createParser)((event) => {
                        if (event.type === 'event') {
                            // console.log('createParser:');
                            try {
                                if (event.data !== '[DONE]') {
                                    let new_msg = JSON.parse(event.data)['choices'][0]['delta']['content'];
                                    if (new_msg !== undefined) {
                                        console.log(JSON.parse(event.data).id);
                                        //  UI 
                                        port.postMessage({ 'type': 'sendGPTData', 'status': 'process', 'content': JSON.parse(event.data)['choices'][0]['delta']['content'], 'chatId': JSON.parse(event.data).id });
                                    }
                                }
                            }
                            catch (_a) {
                                console.log(' createParser JSON.parse errow');
                            }
                        }
                    });
                    const reader = (_a = response.body) === null || _a === void 0 ? void 0 : _a.getReader();
                    if (reader !== undefined) {
                        try {
                            // eslint-disable-next-line no-constant-condition
                            while (true) {
                                const { done, value } = yield reader.read();
                                // const { done:boolean, value:uint8Array } = await Promise.race([reader.read(), cancelPromise]);
                                if (done) {
                                    // 
                                    console.log('Done');
                                    port.postMessage({ 'type': 'sendGPTData', 'status': 'end', 'content': '' });
                                    break;
                                }
                                // if (!isContinue) {
                                //   console.log('')
                                //   break
                                // }
                                const str = new TextDecoder().decode(value);
                                parser.feed(str);
                            }
                        }
                        finally {
                            reader.releaseLock();
                        }
                        parser.reset();
                    }
                })).catch((error) => {
                    console.log('error');
                    console.log(error);
                    if (error.message.indexOf('aborted') >= 0) {
                        // 
                    }
                    else {
                        const tips = error.message.indexOf('Failed to fetch') >= 0 ? 'An error occurred. It might be an **API endpoint error**' + '(' + openApiEndpoint + ')' + '. Please modify and try again.' : 'An error occurred.';
                        port.postMessage({ 'type': 'sendGPTData', 'status': 'erro', 'content': tips + '(' + error.message + ')', 'code': error.message });
                    }
                    // port.postMessage({ 'type': 'sendGPTData', 'status': 'erro', 'content': " Encountered some issues, please try again later." })
                });
            }
            //  Unsplash 
            if (msg.type === 'getUnsplashImages') {
                // 
                if (msg.keyWord) {
                    // port.postMessage({ 'type': 'sendImgData', 'status': 'end', 'imgs': imgs })
                    (0, util_1.unsplashSearchPhotos)("t8eOwEDwJEGJe7mYWDleFDBK_EM0SaF1hK_4KYfcD_8", msg.keyWord).then((imgs) => {
                        console.log(imgs);
                        port.postMessage({ 'type': 'sendImgData', 'status': 'end', 'imgs': imgs });
                    }).catch((error) => {
                        console.log(error);
                    });
                }
            }
            // 
            if (msg.type === 'StopTheConversation') {
                // isContinue = false
                controller.abort();
            }
        });
    }));
});
webextension_polyfill_1.default.runtime.onMessage.addListener(handleMessage);
function handleMessage(request, sender, sendResponse) {
    console.log("Message from the content script: " +
        request.type);
    // Define sendResponse as an async function
    const asyncSendResponse = (response) => __awaiter(this, void 0, void 0, function* () {
        try {
            yield sendResponse(response);
        }
        catch (error) {
            console.error(error);
        }
    });
    if (request.type === 'addNote') {
        console.log('addNote');
        // Unsplash
        const unsplash = (0, unsplash_js_1.createApi)({
            accessKey: "t8eOwEDwJEGJe7mYWDleFDBK_EM0SaF1hK_4KYfcD_8"
        });
        console.log('unsplash.photos.trackDownload');
        if (request.messages.unsplash_download_location !== undefined) {
            unsplash.photos.trackDownload({ downloadLocation: request.messages.unsplash_download_location, }).then((result) => console.log(result));
        }
        (0, util_1.ankiAction)(request.messages.anki_action_type, 6, request.messages.anki_arguments).then((result) => {
            console.log(`got list of decks: ${result}`);
            // 
            asyncSendResponse({ type: 'addToAnki', result: 'success', data: result.result, error: result.error });
        })
            .catch((error) => {
            console.error(error);
            asyncSendResponse({ type: 'addToAnki', result: 'failure', error: error.error });
        });
        // Return true to inform sendResponse that you will be calling it asynchronously
        return true;
    }
    // 
    if (request.type === 'setModel') {
        const isAnkiSpace = request.messages.isAnkiSpace;
        //  DeckName
        (0, util_1.getDefaultDeckName)().then((result) => {
            let defaultDeckName = result.defaultDeckName;
            if (defaultDeckName === '' || defaultDeckName === undefined) {
                defaultDeckName = 'Default';
            }
            //  Model
            (0, util_1.ankiAction)('modelNames', 6).then((result) => {
                console.log(result.result);
                if (!result.error) {
                    let defaultModelName = 'Scouter';
                    let cardTemplates = [
                        {
                            'name': 'Card1',
                            'Front': '{{Front}}',
                            'Back': `{{Front}}
              <hr id=answer>
              {{Back}}`
                        }
                    ];
                    let inOrderFields = ["Front", "Back"];
                    if (isAnkiSpace) {
                        // Anki 
                        defaultModelName = 'Scouter Cloze Text';
                        cardTemplates = [
                            {
                                'name': 'Card2',
                                'Front': '{{cloze:Text}}',
                                'Back': `{{cloze:Text}}
                        <br>{{More}}`
                            }
                        ];
                        inOrderFields = ["Text", "More"];
                    }
                    if (result.result.includes(defaultModelName)) {
                        //  Scouter Model  Model 
                        (0, util_1.ankiAction)('modelFieldNames', 6, { 'modelName': defaultModelName }).then((result) => {
                            if (result.result.length < 2) {
                                //  2 
                                asyncSendResponse({ type: 'setModel', result: 'failure', data: {}, error: 'The Scouter model in Anki needs to include at least 2 fields. Please modify and try again.' });
                            }
                            else {
                                // 
                                asyncSendResponse({ type: 'setModel', result: 'success', data: { 'defaultDeckName': defaultDeckName, 'modelName': defaultModelName, 'field1': result.result[0], 'field2': result.result[1] }, error: result.error });
                            }
                        });
                    }
                    else {
                        //  Scouter  Model
                        (0, util_1.ankiAction)('createModel', 6, {
                            'modelName': defaultModelName,
                            'inOrderFields': inOrderFields,
                            'cardTemplates': cardTemplates,
                            'isCloze': isAnkiSpace
                        }).then((result) => {
                            if (!result.error) {
                                // 
                                asyncSendResponse({
                                    type: 'setModel', result: 'success', data: {
                                        'defaultDeckName': defaultDeckName,
                                        'modelName': defaultModelName,
                                        'field1': result.result.flds[0].name,
                                        'field2': result.result.flds[1].name
                                    }, error: result.error
                                });
                            }
                        });
                    }
                }
            })
                .catch((error) => {
                console.error(error);
                asyncSendResponse({ type: 'setModel', result: 'failure', error: error.error });
            });
        });
        webextension_polyfill_1.default.storage.sync.get({ 'ankiDeckName': 'Default' }).then((result) => {
        });
        return true;
    }
    if (request.type === 'guiEditNote') {
        (0, util_1.ankiAction)(request.messages.anki_action_type, 6, request.messages.anki_arguments).then((result) => {
            console.log(`got list of decks: ${result}`);
            // 
            asyncSendResponse({ type: 'guiEditNote', result: 'success', data: result.result, error: result.error });
        })
            .catch((error) => {
            console.error(error);
            asyncSendResponse({ type: 'guiEditNote', result: 'failure', error: error.error });
        });
        // Return true to inform sendResponse that you will be calling it asynchronously
        return true;
    }
    if (request.type === 'ankiAction') {
        (0, util_1.ankiAction)(request.messages.anki_action_type, 6, request.messages.anki_arguments).then((result) => {
            // 
            asyncSendResponse(result);
        }).catch((error) => {
            asyncSendResponse(error);
        });
        return true;
    }
}
const sendMessageToContent = (runPrompt) => {
    console.log('sendMessageToContent:');
    let needToRunPrompt = runPrompt;
    if (needToRunPrompt === undefined) {
        needToRunPrompt = true;
    }
    webextension_polyfill_1.default.tabs.query({ active: true, currentWindow: true }).then((tabs) => {
        var _a;
        console.log(tabs);
        const activeTab = tabs[0];
        let tID = (_a = activeTab.id) !== null && _a !== void 0 ? _a : -1;
        if (activeTab && activeTab.id !== undefined) {
            let b = webextension_polyfill_1.default.tabs.sendMessage(tID, { type: 'open-scouter', runPrompt: needToRunPrompt });
            //  content_script.js 
            // b.catch(e => {
            //   console.log(e);
            //   console.log('catch');
            //   browser.scripting.executeScript({
            //     target: { tabId: tID },
            //     files: ["js/vendor.js", "js/content_script.js"],
            //   }).then(() => {
            //     console.log('chrome.scripting.executeScript');
            //   }).then(() => {
            //     browser.tabs.sendMessage(tID, { type: 'open-scouter' })
            //   })
            // })
        }
    });
};


/***/ }),

/***/ "./src/util.ts":
/*!*********************!*\
  !*** ./src/util.ts ***!
  \*********************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.getUserId = exports.getBalance = exports.playTextToSpeech = exports.getDefaultDeckName = exports.unsplashSearchPhotos = exports.ankiAction = void 0;
const webextension_polyfill_1 = __importDefault(__webpack_require__(/*! webextension-polyfill */ "./node_modules/webextension-polyfill/dist/browser-polyfill.js"));
const unsplash_js_1 = __webpack_require__(/*! unsplash-js */ "./node_modules/unsplash-js/dist/unsplash-js.esm.js");
const sdk = __importStar(__webpack_require__(/*! microsoft-cognitiveservices-speech-sdk */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/microsoft.cognitiveservices.speech.sdk.js"));
const uuid_1 = __webpack_require__(/*! uuid */ "./node_modules/uuid/dist/commonjs-browser/index.js");
//  Anki
function ankiAction(action, version, params = {}) {
    return new Promise((resolve, reject) => {
        fetch('http://127.0.0.1:8765', {
            method: "POST",
            body: JSON.stringify({ "action": action, "version": version, "params": params })
        }).then(response => response.json()).then((data) => {
            // console.log(data);
            resolve(data);
        }).catch((error) => {
            reject({ 'result': [], 'error': 'Please open the Anki client and install the Anki-Connect plugin before trying again.' });
        });
    });
}
exports.ankiAction = ankiAction;
//  unsplash 
function unsplashSearchPhotos(API_KEY, query) {
    return new Promise((resolve, reject) => {
        const unsplash = (0, unsplash_js_1.createApi)({
            accessKey: API_KEY,
        });
        unsplash.search.getPhotos({
            query: query,
        }).then((data) => {
            // console.log(data);
            var _a, _b;
            if (((_a = data.response) === null || _a === void 0 ? void 0 : _a.results.length) === 0) {
                resolve([]);
            }
            else {
                resolve((_b = data.response) === null || _b === void 0 ? void 0 : _b.results);
            }
        }).catch((error) => {
            reject(error);
        });
    });
}
exports.unsplashSearchPhotos = unsplashSearchPhotos;
//  Anki  Deck 
function getDefaultDeckName() {
    return new Promise((resolve, reject) => {
        let defaultDeckName = '';
        //  Deck Name
        webextension_polyfill_1.default.storage.sync.get(["ankiDeckName"]).then((result) => __awaiter(this, void 0, void 0, function* () {
            // console.log('result:');
            // console.log(result);
            if (result.ankiDeckName) {
                // 
                defaultDeckName = result.ankiDeckName;
            }
            else {
                // 
                //  Anki 
                defaultDeckName = yield ankiAction('deckNames', 6).then((result) => {
                    // 
                    return result.result[0];
                }).catch((error) => {
                    // console.log(error);
                    return '';
                });
            }
            resolve({ 'defaultDeckName': defaultDeckName });
        }));
    });
}
exports.getDefaultDeckName = getDefaultDeckName;
const playTextToSpeech = (text, voice) => {
    const audioConfig = sdk.AudioConfig.fromDefaultSpeakerOutput();
    const speechConfig = sdk.SpeechConfig.fromSubscription("51675ff213a64c3896bc95141c6c54dd", "eastus");
    speechConfig.speechSynthesisVoiceName = voice;
    const synthesizer = new sdk.SpeechSynthesizer(speechConfig, audioConfig);
    synthesizer.speakTextAsync(text, function (result) {
        if (result.reason === sdk.ResultReason.SynthesizingAudioCompleted) {
            // console.log('synthesis finished.');
        }
        else {
            console.error('Speech synthesis canceled, ' + result.errorDetails + '\nDid you set the speech resource key and region values?');
        }
        synthesizer.close();
    }, function (err) {
        // console.trace('err - ' + err);
        synthesizer.close();
    });
    // console.log('Now synthesizing...');
};
exports.playTextToSpeech = playTextToSpeech;
const getBalance = (apiKey) => {
    return new Promise((resolve, reject) => {
        const url = 'https://openrouter.ai/api/v1/auth/key';
        const headers = { 'Authorization': 'Bearer ' + apiKey, 'Content-Type': 'application/json', };
        fetch(url, {
            headers: headers
        }).then((response) => {
            console.log(response);
            response.json().then((data) => {
                console.log(data);
                resolve(data);
            });
        });
    });
};
exports.getBalance = getBalance;
const getUserId = () => {
    return new Promise((resolve, reject) => {
        chrome.storage.sync.get('userId', (result) => {
            if (chrome.runtime.lastError) {
                reject(chrome.runtime.lastError);
            }
            if (result.userId) {
                resolve(result.userId);
            }
            else {
                let uniqueId = (0, uuid_1.v4)();
                chrome.storage.sync.set({ userId: uniqueId }, () => {
                    if (chrome.runtime.lastError) {
                        reject(chrome.runtime.lastError);
                    }
                    else {
                        resolve(uniqueId);
                    }
                });
            }
        });
    });
};
exports.getUserId = getUserId;


/***/ }),

/***/ "./node_modules/unsplash-js/dist/unsplash-js.esm.js":
/*!**********************************************************!*\
  !*** ./node_modules/unsplash-js/dist/unsplash-js.esm.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Language": () => (/* binding */ Language),
/* harmony export */   "OrderBy": () => (/* binding */ OrderBy),
/* harmony export */   "_internals": () => (/* binding */ internals),
/* harmony export */   "createApi": () => (/* binding */ createApi)
/* harmony export */ });
/* harmony import */ var content_type__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! content-type */ "./node_modules/content-type/index.js");


function _extends() {
  _extends = Object.assign || function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };

  return _extends.apply(this, arguments);
}

function _objectWithoutPropertiesLoose(source, excluded) {
  if (source == null) return {};
  var target = {};
  var sourceKeys = Object.keys(source);
  var key, i;

  for (i = 0; i < sourceKeys.length; i++) {
    key = sourceKeys[i];
    if (excluded.indexOf(key) >= 0) continue;
    target[key] = source[key];
  }

  return target;
}

var checkIsString = /*#__PURE__*/getRefinement(function (value) {
  return typeof value === 'string' ? value : null;
});
var isDefined = function isDefined(x) {
  return x !== null && x !== undefined;
};
function getRefinement(getB) {
  return function (a) {
    return isDefined(getB(a));
  };
}
var checkIsNonEmptyArray = function checkIsNonEmptyArray(a) {
  return a.length > 0;
};

/** Takes a dictionary containing nullish values and returns a dictionary of all the defined
 * (non-nullish) values.
 */

var compactDefined = function compactDefined(obj) {
  return Object.keys(obj).reduce(function (acc, key) {
    var _ref;

    var value = obj[key];
    return _extends({}, acc, isDefined(value) ? (_ref = {}, _ref[key] = value, _ref) : {});
  }, {});
};
function flow() {
  for (var _len = arguments.length, fns = new Array(_len), _key = 0; _key < _len; _key++) {
    fns[_key] = arguments[_key];
  }

  var len = fns.length - 1;
  return function () {
    for (var _len2 = arguments.length, x = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
      x[_key2] = arguments[_key2];
    }

    var y = fns[0].apply(this, x);

    for (var i = 1; i <= len; i++) {
      y = fns[i].call(this, y);
    }

    return y;
  };
}

var checkIsObject = /*#__PURE__*/getRefinement(function (response) {
  return isDefined(response) && typeof response === 'object' && !Array.isArray(response) ? response : null;
});
var checkIsErrors = /*#__PURE__*/getRefinement(function (errors) {
  return Array.isArray(errors) && errors.every(checkIsString) && checkIsNonEmptyArray(errors) ? errors : null;
});
var checkIsApiError = /*#__PURE__*/getRefinement(function (response) {
  return checkIsObject(response) && 'errors' in response && checkIsErrors(response.errors) ? {
    errors: response.errors
  } : null;
});
var getErrorForBadStatusCode = function getErrorForBadStatusCode(jsonResponse) {
  if (checkIsApiError(jsonResponse)) {
    return {
      errors: jsonResponse.errors,
      source: 'api'
    };
  } else {
    return {
      errors: ['Responded with a status code outside the 2xx range, and the response body is not recognisable.'],
      source: 'decoding'
    };
  }
};
var DecodingError = function DecodingError(message) {
  this.message = message;
};

var CONTENT_TYPE_RESPONSE_HEADER = 'content-type';
var CONTENT_TYPE_JSON = 'application/json';

var checkIsJsonResponse = function checkIsJsonResponse(response) {
  var contentTypeHeader = response.headers.get(CONTENT_TYPE_RESPONSE_HEADER);
  return isDefined(contentTypeHeader) && (0,content_type__WEBPACK_IMPORTED_MODULE_0__.parse)(contentTypeHeader).type === CONTENT_TYPE_JSON;
};
/**
 * Note: restrict the type of JSON to `AnyJson` so that `any` doesn't leak downstream.
 */


var getJsonResponse = function getJsonResponse(response) {
  if (checkIsJsonResponse(response)) {
    return response.json()["catch"](function (_err) {
      throw new DecodingError('unable to parse JSON response.');
    });
  } else {
    throw new DecodingError('expected JSON response from server.');
  }
};

var handleFetchResponse = function handleFetchResponse(handleResponse) {
  return function (response) {
    return (response.ok ? handleResponse({
      response: response
    }).then(function (handledResponse) {
      return {
        type: 'success',
        status: response.status,
        response: handledResponse,
        originalResponse: response
      };
    }) : getJsonResponse(response).then(function (jsonResponse) {
      return _extends({
        type: 'error',
        status: response.status
      }, getErrorForBadStatusCode(jsonResponse), {
        originalResponse: response
      });
    }))["catch"](function (error) {
      /**
       * We want to separate expected decoding errors from unknown ones. We do so by throwing a custom
       * `DecodingError` whenever we encounter one within `handleFetchResponse` and catch them all
       * here. This allows us to easily handle all of these errors at once. Unexpected errors are not
       * caught, so that they bubble up and fail loudly.
       *
       * Note: Ideally we'd use an Either type, but this does the job without introducing dependencies
       * like `fp-ts`.
       */
      if (error instanceof DecodingError) {
        return {
          type: 'error',
          source: 'decoding',
          status: response.status,
          originalResponse: response,
          errors: [error.message]
        };
      } else {
        throw error;
      }
    });
  };
};
var castResponse = function castResponse() {
  return function (_ref) {
    var response = _ref.response;
    return getJsonResponse(response);
  };
};

var addQueryToUrl = function addQueryToUrl(query) {
  return function (url) {
    Object.keys(query).forEach(function (queryKey) {
      return url.searchParams.set(queryKey, query[queryKey].toString());
    });
  };
};

var addPathnameToUrl = function addPathnameToUrl(pathname) {
  return function (url) {
    // When there is no existing pathname, the value is `/`. Appending would give us a URL with two
    // forward slashes. This is why we replace the value in that scenario.
    if (url.pathname === '/') {
      url.pathname = pathname;
    } else {
      url.pathname += pathname;
    }
  };
};

var buildUrl = function buildUrl(_ref) {
  var pathname = _ref.pathname,
      query = _ref.query;
  return function (apiUrl) {
    var url = new URL(apiUrl);
    addPathnameToUrl(pathname)(url);
    addQueryToUrl(query)(url);
    return url.toString();
  };
};

var getQueryFromSearchParams = function getQueryFromSearchParams(searchParams) {
  var query = {};
  searchParams.forEach(function (value, key) {
    query[key] = value;
  });
  return query;
};

var parseQueryAndPathname = function parseQueryAndPathname(url) {
  var _URL = new URL(url),
      pathname = _URL.pathname,
      searchParams = _URL.searchParams;

  var query = getQueryFromSearchParams(searchParams);
  return {
    query: query,
    pathname: pathname === '/' ? undefined : pathname
  };
};

/**
 * helper used to type-check the arguments, and add default params for all requests
 */

var createRequestHandler = function createRequestHandler(fn) {
  return function (a, additionalFetchOptions) {
    if (additionalFetchOptions === void 0) {
      additionalFetchOptions = {};
    }

    var _fn = fn(a),
        headers = _fn.headers,
        query = _fn.query,
        baseReqParams = _objectWithoutPropertiesLoose(_fn, ["headers", "query"]);

    return _extends({}, baseReqParams, additionalFetchOptions, {
      query: query,
      headers: _extends({}, headers, additionalFetchOptions.headers)
    });
  };
};
var makeEndpoint = function makeEndpoint(endpoint) {
  return endpoint;
};
var initMakeRequest = function initMakeRequest(_ref) {
  var accessKey = _ref.accessKey,
      _ref$apiVersion = _ref.apiVersion,
      apiVersion = _ref$apiVersion === void 0 ? 'v1' : _ref$apiVersion,
      _ref$apiUrl = _ref.apiUrl,
      apiUrl = _ref$apiUrl === void 0 ? 'https://api.unsplash.com' : _ref$apiUrl,
      generalHeaders = _ref.headers,
      providedFetch = _ref.fetch,
      generalFetchOptions = _objectWithoutPropertiesLoose(_ref, ["accessKey", "apiVersion", "apiUrl", "headers", "fetch"]);

  return function (_ref2) {
    var handleResponse = _ref2.handleResponse,
        handleRequest = _ref2.handleRequest;
    return flow(handleRequest, function (_ref3) {
      var pathname = _ref3.pathname,
          query = _ref3.query,
          _ref3$method = _ref3.method,
          method = _ref3$method === void 0 ? 'GET' : _ref3$method,
          endpointHeaders = _ref3.headers,
          body = _ref3.body,
          signal = _ref3.signal;
      var url = buildUrl({
        pathname: pathname,
        query: query
      })(apiUrl);

      var fetchOptions = _extends({
        method: method,
        headers: _extends({}, generalHeaders, endpointHeaders, {
          'Accept-Version': apiVersion
        }, isDefined(accessKey) ? {
          Authorization: "Client-ID " + accessKey
        } : {}),
        body: body,
        signal: signal
      }, generalFetchOptions);

      var fetchToUse = providedFetch != null ? providedFetch : fetch;
      return fetchToUse(url, fetchOptions).then(handleFetchResponse(handleResponse));
    });
  };
};

var TOTAL_RESPONSE_HEADER = 'x-total';

var getTotalFromApiFeedResponse = function getTotalFromApiFeedResponse(response) {
  var totalsStr = response.headers.get(TOTAL_RESPONSE_HEADER);

  if (isDefined(totalsStr)) {
    var total = parseInt(totalsStr);

    if (Number.isInteger(total)) {
      return total;
    } else {
      throw new DecodingError("expected " + TOTAL_RESPONSE_HEADER + " header to be valid integer.");
    }
  } else {
    throw new DecodingError("expected " + TOTAL_RESPONSE_HEADER + " header to exist.");
  }
};

var handleFeedResponse = function handleFeedResponse() {
  return function (_ref) {
    var response = _ref.response;
    return castResponse()({
      response: response
    }).then(function (results) {
      return {
        results: results,
        total: getTotalFromApiFeedResponse(response)
      };
    });
  };
};

var getCollections = function getCollections(collectionIds) {
  return isDefined(collectionIds) ? {
    collections: collectionIds.join()
  } : {};
};
var getTopics = function getTopics(topicIds) {
  return isDefined(topicIds) ? {
    topics: topicIds.join()
  } : {};
};
var getFeedParams = function getFeedParams(_ref) {
  var page = _ref.page,
      perPage = _ref.perPage,
      orderBy = _ref.orderBy;
  return compactDefined({
    per_page: perPage,
    order_by: orderBy,
    page: page
  });
};

var COLLECTIONS_PATH_PREFIX = '/collections';
var getPhotos = /*#__PURE__*/function () {
  var getPathname = function getPathname(_ref) {
    var collectionId = _ref.collectionId;
    return COLLECTIONS_PATH_PREFIX + "/" + collectionId + "/photos";
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_ref2) {
      var collectionId = _ref2.collectionId,
          orientation = _ref2.orientation,
          paginationParams = _objectWithoutPropertiesLoose(_ref2, ["collectionId", "orientation"]);

      return {
        pathname: getPathname({
          collectionId: collectionId
        }),
        query: compactDefined(_extends({}, getFeedParams(paginationParams), {
          orientation: orientation
        }))
      };
    }),
    handleResponse: handleFeedResponse()
  });
}();
var get = /*#__PURE__*/function () {
  var getPathname = function getPathname(_ref3) {
    var collectionId = _ref3.collectionId;
    return COLLECTIONS_PATH_PREFIX + "/" + collectionId;
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_ref4) {
      var collectionId = _ref4.collectionId;
      return {
        pathname: getPathname({
          collectionId: collectionId
        }),
        query: {}
      };
    }),
    handleResponse: castResponse()
  });
}();
var list = /*#__PURE__*/function () {
  var getPathname = function getPathname() {
    return COLLECTIONS_PATH_PREFIX;
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (paginationParams) {
      if (paginationParams === void 0) {
        paginationParams = {};
      }

      return {
        pathname: getPathname(),
        query: getFeedParams(paginationParams)
      };
    }),
    handleResponse: handleFeedResponse()
  });
}();
var getRelated = /*#__PURE__*/function () {
  var getPathname = function getPathname(_ref5) {
    var collectionId = _ref5.collectionId;
    return COLLECTIONS_PATH_PREFIX + "/" + collectionId + "/related";
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_ref6) {
      var collectionId = _ref6.collectionId;
      return {
        pathname: getPathname({
          collectionId: collectionId
        }),
        query: {}
      };
    }),
    handleResponse: castResponse()
  });
}();

var index = {
  __proto__: null,
  getPhotos: getPhotos,
  get: get,
  list: list,
  getRelated: getRelated
};

var PHOTOS_PATH_PREFIX = '/photos';
var list$1 = /*#__PURE__*/function () {
  var _getPathname = function getPathname() {
    return PHOTOS_PATH_PREFIX;
  };

  return makeEndpoint({
    // Wrapper uses type trick to allow 0 args
    getPathname: function getPathname(_params) {
      return _getPathname();
    },
    handleRequest: createRequestHandler(function (feedParams) {
      if (feedParams === void 0) {
        feedParams = {};
      }

      return {
        pathname: PHOTOS_PATH_PREFIX,
        query: compactDefined(getFeedParams(feedParams))
      };
    }),
    handleResponse: handleFeedResponse()
  });
}();
var get$1 = /*#__PURE__*/function () {
  var getPathname = function getPathname(_ref) {
    var photoId = _ref.photoId;
    return PHOTOS_PATH_PREFIX + "/" + photoId;
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_ref2) {
      var photoId = _ref2.photoId;
      return {
        pathname: getPathname({
          photoId: photoId
        }),
        query: {}
      };
    }),
    handleResponse: castResponse()
  });
}();
var getStats = /*#__PURE__*/function () {
  var getPathname = function getPathname(_ref3) {
    var photoId = _ref3.photoId;
    return PHOTOS_PATH_PREFIX + "/" + photoId + "/statistics";
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_ref4) {
      var photoId = _ref4.photoId;
      return {
        pathname: getPathname({
          photoId: photoId
        }),
        query: {}
      };
    }),
    handleResponse: castResponse()
  });
}();
var getRandom = /*#__PURE__*/function () {
  var getPathname = function getPathname() {
    return PHOTOS_PATH_PREFIX + "/random";
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_temp) {
      var _ref5 = _temp === void 0 ? {} : _temp,
          collectionIds = _ref5.collectionIds,
          contentFilter = _ref5.contentFilter,
          topicIds = _ref5.topicIds,
          queryParams = _objectWithoutPropertiesLoose(_ref5, ["collectionIds", "contentFilter", "topicIds"]);

      return {
        pathname: getPathname(),
        query: compactDefined(_extends({}, queryParams, {
          content_filter: contentFilter
        }, getCollections(collectionIds), getTopics(topicIds))),
        headers: {
          /**
           * Avoid response caching
           */
          'cache-control': 'no-cache'
        }
      };
    }),
    handleResponse: castResponse()
  });
}();
var trackDownload = {
  handleRequest: /*#__PURE__*/createRequestHandler(function (_ref6) {
    var downloadLocation = _ref6.downloadLocation;

    var _parseQueryAndPathnam = parseQueryAndPathname(downloadLocation),
        pathname = _parseQueryAndPathnam.pathname,
        query = _parseQueryAndPathnam.query;

    if (!isDefined(pathname)) {
      throw new Error('Could not parse pathname from url.');
    }

    return {
      pathname: pathname,
      query: compactDefined(query)
    };
  }),
  handleResponse: /*#__PURE__*/castResponse()
};

var index$1 = {
  __proto__: null,
  list: list$1,
  get: get$1,
  getStats: getStats,
  getRandom: getRandom,
  trackDownload: trackDownload
};

var SEARCH_PATH_PREFIX = "/search";
var getPhotos$1 = /*#__PURE__*/function () {
  var _getPathname = function getPathname() {
    return SEARCH_PATH_PREFIX + "/photos";
  };

  return makeEndpoint({
    // Wrapper uses type trick to allow 0 args
    getPathname: function getPathname(_params) {
      return _getPathname();
    },
    handleRequest: createRequestHandler(function (_ref) {
      var query = _ref.query,
          page = _ref.page,
          perPage = _ref.perPage,
          orderBy = _ref.orderBy,
          collectionIds = _ref.collectionIds,
          lang = _ref.lang,
          contentFilter = _ref.contentFilter,
          filters = _objectWithoutPropertiesLoose(_ref, ["query", "page", "perPage", "orderBy", "collectionIds", "lang", "contentFilter"]);

      return {
        pathname: _getPathname(),
        query: compactDefined(_extends({
          query: query,
          content_filter: contentFilter,
          lang: lang,
          order_by: orderBy
        }, getFeedParams({
          page: page,
          perPage: perPage
        }), getCollections(collectionIds), filters))
      };
    }),
    handleResponse: castResponse()
  });
}();
var getCollections$1 = /*#__PURE__*/function () {
  var _getPathname2 = function getPathname() {
    return SEARCH_PATH_PREFIX + "/collections";
  };

  return makeEndpoint({
    // Wrapper uses type trick to allow 0 args
    getPathname: function getPathname(_params) {
      return _getPathname2();
    },
    handleRequest: createRequestHandler(function (_ref2) {
      var query = _ref2.query,
          paginationParams = _objectWithoutPropertiesLoose(_ref2, ["query"]);

      return {
        pathname: _getPathname2(),
        query: _extends({
          query: query
        }, getFeedParams(paginationParams))
      };
    }),
    handleResponse: castResponse()
  });
}();
var getUsers = /*#__PURE__*/function () {
  var _getPathname3 = function getPathname() {
    return SEARCH_PATH_PREFIX + "/users";
  };

  return makeEndpoint({
    // Wrapper uses type trick to allow 0 args
    getPathname: function getPathname(_params) {
      return _getPathname3();
    },
    handleRequest: createRequestHandler(function (_ref3) {
      var query = _ref3.query,
          paginationParams = _objectWithoutPropertiesLoose(_ref3, ["query"]);

      return {
        pathname: _getPathname3(),
        query: _extends({
          query: query
        }, getFeedParams(paginationParams))
      };
    }),
    handleResponse: castResponse()
  });
}();

var index$2 = {
  __proto__: null,
  getPhotos: getPhotos$1,
  getCollections: getCollections$1,
  getUsers: getUsers
};

var USERS_PATH_PREFIX = '/users';
var get$2 = /*#__PURE__*/function () {
  var getPathname = function getPathname(_ref) {
    var username = _ref.username;
    return USERS_PATH_PREFIX + "/" + username;
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_ref2) {
      var username = _ref2.username;
      return {
        pathname: getPathname({
          username: username
        }),
        query: {}
      };
    }),
    handleResponse: castResponse()
  });
}();
var getPhotos$2 = /*#__PURE__*/function () {
  var getPathname = function getPathname(_ref3) {
    var username = _ref3.username;
    return USERS_PATH_PREFIX + "/" + username + "/photos";
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_ref4) {
      var username = _ref4.username,
          stats = _ref4.stats,
          orientation = _ref4.orientation,
          paginationParams = _objectWithoutPropertiesLoose(_ref4, ["username", "stats", "orientation"]);

      return {
        pathname: getPathname({
          username: username
        }),
        query: compactDefined(_extends({}, getFeedParams(paginationParams), {
          orientation: orientation,
          stats: stats
        }))
      };
    }),
    handleResponse: handleFeedResponse()
  });
}();
var getLikes = /*#__PURE__*/function () {
  var getPathname = function getPathname(_ref5) {
    var username = _ref5.username;
    return USERS_PATH_PREFIX + "/" + username + "/likes";
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_ref6) {
      var username = _ref6.username,
          orientation = _ref6.orientation,
          paginationParams = _objectWithoutPropertiesLoose(_ref6, ["username", "orientation"]);

      return {
        pathname: getPathname({
          username: username
        }),
        query: compactDefined(_extends({}, getFeedParams(paginationParams), {
          orientation: orientation
        }))
      };
    }),
    handleResponse: handleFeedResponse()
  });
}();
var getCollections$2 = /*#__PURE__*/function () {
  var getPathname = function getPathname(_ref7) {
    var username = _ref7.username;
    return USERS_PATH_PREFIX + "/" + username + "/collections";
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_ref8) {
      var username = _ref8.username,
          paginationParams = _objectWithoutPropertiesLoose(_ref8, ["username"]);

      return {
        pathname: getPathname({
          username: username
        }),
        query: getFeedParams(paginationParams)
      };
    }),
    handleResponse: handleFeedResponse()
  });
}();

var index$3 = {
  __proto__: null,
  get: get$2,
  getPhotos: getPhotos$2,
  getLikes: getLikes,
  getCollections: getCollections$2
};

var BASE_TOPIC_PATH = '/topics';

var getTopicPath = function getTopicPath(_ref) {
  var topicIdOrSlug = _ref.topicIdOrSlug;
  return BASE_TOPIC_PATH + "/" + topicIdOrSlug;
};

var list$2 = /*#__PURE__*/makeEndpoint({
  getPathname: getTopicPath,
  handleRequest: function handleRequest(_ref2) {
    var page = _ref2.page,
        perPage = _ref2.perPage,
        orderBy = _ref2.orderBy,
        topicIdsOrSlugs = _ref2.topicIdsOrSlugs;
    return {
      pathname: BASE_TOPIC_PATH,
      query: compactDefined(_extends({}, getFeedParams({
        page: page,
        perPage: perPage
      }), {
        ids: topicIdsOrSlugs == null ? void 0 : topicIdsOrSlugs.join(','),
        order_by: orderBy
      }))
    };
  },
  handleResponse: /*#__PURE__*/handleFeedResponse()
});
var get$3 = /*#__PURE__*/makeEndpoint({
  getPathname: getTopicPath,
  handleRequest: function handleRequest(_ref3) {
    var topicIdOrSlug = _ref3.topicIdOrSlug;
    return {
      pathname: getTopicPath({
        topicIdOrSlug: topicIdOrSlug
      }),
      query: {}
    };
  },
  handleResponse: /*#__PURE__*/castResponse()
});
var getPhotos$3 = /*#__PURE__*/function () {
  var getPathname = /*#__PURE__*/flow(getTopicPath, function (topicPath) {
    return topicPath + "/photos";
  });
  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: function handleRequest(_ref4) {
      var topicIdOrSlug = _ref4.topicIdOrSlug,
          orientation = _ref4.orientation,
          feedParams = _objectWithoutPropertiesLoose(_ref4, ["topicIdOrSlug", "orientation"]);

      return {
        pathname: getPathname({
          topicIdOrSlug: topicIdOrSlug
        }),
        query: compactDefined(_extends({}, getFeedParams(feedParams), {
          orientation: orientation
        }))
      };
    },
    handleResponse: handleFeedResponse()
  });
}();

var index$4 = {
  __proto__: null,
  list: list$2,
  get: get$3,
  getPhotos: getPhotos$3
};

var trackNonHotLinkedPhotoView = function trackNonHotLinkedPhotoView(_ref) {
  var appId = _ref.appId;
  return function (_ref2) {
    var photoId = _ref2.photoId;
    var ids = !Array.isArray(photoId) ? [photoId] : photoId;

    if (ids.length > 20) {
      throw new Error('You cannot track more than 20 photos at once. Please try again with fewer photos.');
    }

    return fetch("views.unsplash.com/v?photo_id=" + ids.join() + "&app_id=" + appId);
  };
};



var internals = {
  __proto__: null,
  collections: index,
  photos: index$1,
  search: index$2,
  users: index$3,
  topics: index$4,
  trackNonHotLinkedPhotoView: trackNonHotLinkedPhotoView
};

var Language;

(function (Language) {
  Language["Afrikaans"] = "af";
  Language["Amharic"] = "am";
  Language["Arabic"] = "ar";
  Language["Azerbaijani"] = "az";
  Language["Belarusian"] = "be";
  Language["Bulgarian"] = "bg";
  Language["Bengali"] = "bn";
  Language["Bosnian"] = "bs";
  Language["Catalan"] = "ca";
  Language["Cebuano"] = "ceb";
  Language["Corsican"] = "co";
  Language["Czech"] = "cs";
  Language["Welsh"] = "cy";
  Language["Danish"] = "da";
  Language["German"] = "de";
  Language["Greek"] = "el";
  Language["English"] = "en";
  Language["Esperanto"] = "eo";
  Language["Spanish"] = "es";
  Language["Estonian"] = "et";
  Language["Basque"] = "eu";
  Language["Persian"] = "fa";
  Language["Finnish"] = "fi";
  Language["French"] = "fr";
  Language["Frisian"] = "fy";
  Language["Irish"] = "ga";
  Language["ScotsGaelic"] = "gd";
  Language["Galician"] = "gl";
  Language["Gujarati"] = "gu";
  Language["Hausa"] = "ha";
  Language["Hawaiian"] = "haw";
  Language["Hindi"] = "hi";
  Language["Hmong"] = "hmn";
  Language["Croatian"] = "hr";
  Language["HaitianCreole"] = "ht";
  Language["Hungarian"] = "hu";
  Language["Armenian"] = "hy";
  Language["Indonesian"] = "id";
  Language["Igbo"] = "ig";
  Language["Icelandic"] = "is";
  Language["Italian"] = "it";
  Language["Hebrew"] = "iw";
  Language["Japanese"] = "ja";
  Language["Javanese"] = "jw";
  Language["Georgian"] = "ka";
  Language["Kazakh"] = "kk";
  Language["Khmer"] = "km";
  Language["Kannada"] = "kn";
  Language["Korean"] = "ko";
  Language["Kurdish"] = "ku";
  Language["Kyrgyz"] = "ky";
  Language["Latin"] = "la";
  Language["Luxembourgish"] = "lb";
  Language["Lao"] = "lo";
  Language["Lithuanian"] = "lt";
  Language["Latvian"] = "lv";
  Language["Malagasy"] = "mg";
  Language["Maori"] = "mi";
  Language["Macedonian"] = "mk";
  Language["Malayalam"] = "ml";
  Language["Mongolian"] = "mn";
  Language["Marathi"] = "mr";
  Language["Malay"] = "ms";
  Language["Maltese"] = "mt";
  Language["Myanmar"] = "my";
  Language["Nepali"] = "ne";
  Language["Dutch"] = "nl";
  Language["Norwegian"] = "no";
  Language["Nyanja"] = "ny";
  Language["Oriya"] = "or";
  Language["Punjabi"] = "pa";
  Language["Polish"] = "pl";
  Language["Pashto"] = "ps";
  Language["Portuguese"] = "pt";
  Language["Romanian"] = "ro";
  Language["Russian"] = "ru";
  Language["Kinyarwanda"] = "rw";
  Language["Sindhi"] = "sd";
  Language["Sinhala"] = "si";
  Language["Slovak"] = "sk";
  Language["Slovenian"] = "sl";
  Language["Samoan"] = "sm";
  Language["Shona"] = "sn";
  Language["Somali"] = "so";
  Language["Albanian"] = "sq";
  Language["Serbian"] = "sr";
  Language["Sesotho"] = "st";
  Language["Sundanese"] = "su";
  Language["Swedish"] = "sv";
  Language["Swahili"] = "sw";
  Language["Tamil"] = "ta";
  Language["Telugu"] = "te";
  Language["Tajik"] = "tg";
  Language["Thai"] = "th";
  Language["Turkmen"] = "tk";
  Language["Filipino"] = "tl";
  Language["Turkish"] = "tr";
  Language["Tatar"] = "tt";
  Language["Uighur"] = "ug";
  Language["Ukrainian"] = "uk";
  Language["Urdu"] = "ur";
  Language["Uzbek"] = "uz";
  Language["Vietnamese"] = "vi";
  Language["Xhosa"] = "xh";
  Language["Yiddish"] = "yi";
  Language["Yoruba"] = "yo";
  Language["ChineseSimplified"] = "zh";
  Language["ChineseTraditional"] = "zh-TW";
  Language["Zulu"] = "zu";
})(Language || (Language = {}));

var OrderBy;

(function (OrderBy) {
  OrderBy["LATEST"] = "latest";
  OrderBy["POPULAR"] = "popular";
  OrderBy["VIEWS"] = "views";
  OrderBy["DOWNLOADS"] = "downloads";
  OrderBy["OLDEST"] = "oldest";
})(OrderBy || (OrderBy = {}));

var createApi = /*#__PURE__*/flow(initMakeRequest, function (makeRequest) {
  return {
    photos: {
      get: makeRequest(get$1),
      list: makeRequest(list$1),
      getStats: makeRequest(getStats),
      getRandom: makeRequest(getRandom),
      trackDownload: makeRequest(trackDownload)
    },
    users: {
      getPhotos: makeRequest(getPhotos$2),
      getCollections: makeRequest(getCollections$2),
      getLikes: makeRequest(getLikes),
      get: makeRequest(get$2)
    },
    search: {
      getCollections: makeRequest(getCollections$1),
      getPhotos: makeRequest(getPhotos$1),
      getUsers: makeRequest(getUsers)
    },
    collections: {
      getPhotos: makeRequest(getPhotos),
      get: makeRequest(get),
      list: makeRequest(list),
      getRelated: makeRequest(getRelated)
    },
    topics: {
      list: makeRequest(list$2),
      get: makeRequest(get$3),
      getPhotos: makeRequest(getPhotos$3)
    }
  };
});


//# sourceMappingURL=unsplash-js.esm.js.map


/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/index.js":
/*!**********************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/index.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
Object.defineProperty(exports, "NIL", ({
  enumerable: true,
  get: function get() {
    return _nil.default;
  }
}));
Object.defineProperty(exports, "parse", ({
  enumerable: true,
  get: function get() {
    return _parse.default;
  }
}));
Object.defineProperty(exports, "stringify", ({
  enumerable: true,
  get: function get() {
    return _stringify.default;
  }
}));
Object.defineProperty(exports, "v1", ({
  enumerable: true,
  get: function get() {
    return _v.default;
  }
}));
Object.defineProperty(exports, "v3", ({
  enumerable: true,
  get: function get() {
    return _v2.default;
  }
}));
Object.defineProperty(exports, "v4", ({
  enumerable: true,
  get: function get() {
    return _v3.default;
  }
}));
Object.defineProperty(exports, "v5", ({
  enumerable: true,
  get: function get() {
    return _v4.default;
  }
}));
Object.defineProperty(exports, "validate", ({
  enumerable: true,
  get: function get() {
    return _validate.default;
  }
}));
Object.defineProperty(exports, "version", ({
  enumerable: true,
  get: function get() {
    return _version.default;
  }
}));

var _v = _interopRequireDefault(__webpack_require__(/*! ./v1.js */ "./node_modules/uuid/dist/commonjs-browser/v1.js"));

var _v2 = _interopRequireDefault(__webpack_require__(/*! ./v3.js */ "./node_modules/uuid/dist/commonjs-browser/v3.js"));

var _v3 = _interopRequireDefault(__webpack_require__(/*! ./v4.js */ "./node_modules/uuid/dist/commonjs-browser/v4.js"));

var _v4 = _interopRequireDefault(__webpack_require__(/*! ./v5.js */ "./node_modules/uuid/dist/commonjs-browser/v5.js"));

var _nil = _interopRequireDefault(__webpack_require__(/*! ./nil.js */ "./node_modules/uuid/dist/commonjs-browser/nil.js"));

var _version = _interopRequireDefault(__webpack_require__(/*! ./version.js */ "./node_modules/uuid/dist/commonjs-browser/version.js"));

var _validate = _interopRequireDefault(__webpack_require__(/*! ./validate.js */ "./node_modules/uuid/dist/commonjs-browser/validate.js"));

var _stringify = _interopRequireDefault(__webpack_require__(/*! ./stringify.js */ "./node_modules/uuid/dist/commonjs-browser/stringify.js"));

var _parse = _interopRequireDefault(__webpack_require__(/*! ./parse.js */ "./node_modules/uuid/dist/commonjs-browser/parse.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/md5.js":
/*!********************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/md5.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

/*
 * Browser-compatible JavaScript MD5
 *
 * Modification of JavaScript MD5
 * https://github.com/blueimp/JavaScript-MD5
 *
 * Copyright 2011, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * https://opensource.org/licenses/MIT
 *
 * Based on
 * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message
 * Digest Algorithm, as defined in RFC 1321.
 * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009
 * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
 * Distributed under the BSD License
 * See http://pajhome.org.uk/crypt/md5 for more info.
 */
function md5(bytes) {
  if (typeof bytes === 'string') {
    const msg = unescape(encodeURIComponent(bytes)); // UTF8 escape

    bytes = new Uint8Array(msg.length);

    for (let i = 0; i < msg.length; ++i) {
      bytes[i] = msg.charCodeAt(i);
    }
  }

  return md5ToHexEncodedArray(wordsToMd5(bytesToWords(bytes), bytes.length * 8));
}
/*
 * Convert an array of little-endian words to an array of bytes
 */


function md5ToHexEncodedArray(input) {
  const output = [];
  const length32 = input.length * 32;
  const hexTab = '0123456789abcdef';

  for (let i = 0; i < length32; i += 8) {
    const x = input[i >> 5] >>> i % 32 & 0xff;
    const hex = parseInt(hexTab.charAt(x >>> 4 & 0x0f) + hexTab.charAt(x & 0x0f), 16);
    output.push(hex);
  }

  return output;
}
/**
 * Calculate output length with padding and bit length
 */


function getOutputLength(inputLength8) {
  return (inputLength8 + 64 >>> 9 << 4) + 14 + 1;
}
/*
 * Calculate the MD5 of an array of little-endian words, and a bit length.
 */


function wordsToMd5(x, len) {
  /* append padding */
  x[len >> 5] |= 0x80 << len % 32;
  x[getOutputLength(len) - 1] = len;
  let a = 1732584193;
  let b = -271733879;
  let c = -1732584194;
  let d = 271733878;

  for (let i = 0; i < x.length; i += 16) {
    const olda = a;
    const oldb = b;
    const oldc = c;
    const oldd = d;
    a = md5ff(a, b, c, d, x[i], 7, -680876936);
    d = md5ff(d, a, b, c, x[i + 1], 12, -389564586);
    c = md5ff(c, d, a, b, x[i + 2], 17, 606105819);
    b = md5ff(b, c, d, a, x[i + 3], 22, -1044525330);
    a = md5ff(a, b, c, d, x[i + 4], 7, -176418897);
    d = md5ff(d, a, b, c, x[i + 5], 12, 1200080426);
    c = md5ff(c, d, a, b, x[i + 6], 17, -1473231341);
    b = md5ff(b, c, d, a, x[i + 7], 22, -45705983);
    a = md5ff(a, b, c, d, x[i + 8], 7, 1770035416);
    d = md5ff(d, a, b, c, x[i + 9], 12, -1958414417);
    c = md5ff(c, d, a, b, x[i + 10], 17, -42063);
    b = md5ff(b, c, d, a, x[i + 11], 22, -1990404162);
    a = md5ff(a, b, c, d, x[i + 12], 7, 1804603682);
    d = md5ff(d, a, b, c, x[i + 13], 12, -40341101);
    c = md5ff(c, d, a, b, x[i + 14], 17, -1502002290);
    b = md5ff(b, c, d, a, x[i + 15], 22, 1236535329);
    a = md5gg(a, b, c, d, x[i + 1], 5, -165796510);
    d = md5gg(d, a, b, c, x[i + 6], 9, -1069501632);
    c = md5gg(c, d, a, b, x[i + 11], 14, 643717713);
    b = md5gg(b, c, d, a, x[i], 20, -373897302);
    a = md5gg(a, b, c, d, x[i + 5], 5, -701558691);
    d = md5gg(d, a, b, c, x[i + 10], 9, 38016083);
    c = md5gg(c, d, a, b, x[i + 15], 14, -660478335);
    b = md5gg(b, c, d, a, x[i + 4], 20, -405537848);
    a = md5gg(a, b, c, d, x[i + 9], 5, 568446438);
    d = md5gg(d, a, b, c, x[i + 14], 9, -1019803690);
    c = md5gg(c, d, a, b, x[i + 3], 14, -187363961);
    b = md5gg(b, c, d, a, x[i + 8], 20, 1163531501);
    a = md5gg(a, b, c, d, x[i + 13], 5, -1444681467);
    d = md5gg(d, a, b, c, x[i + 2], 9, -51403784);
    c = md5gg(c, d, a, b, x[i + 7], 14, 1735328473);
    b = md5gg(b, c, d, a, x[i + 12], 20, -1926607734);
    a = md5hh(a, b, c, d, x[i + 5], 4, -378558);
    d = md5hh(d, a, b, c, x[i + 8], 11, -2022574463);
    c = md5hh(c, d, a, b, x[i + 11], 16, 1839030562);
    b = md5hh(b, c, d, a, x[i + 14], 23, -35309556);
    a = md5hh(a, b, c, d, x[i + 1], 4, -1530992060);
    d = md5hh(d, a, b, c, x[i + 4], 11, 1272893353);
    c = md5hh(c, d, a, b, x[i + 7], 16, -155497632);
    b = md5hh(b, c, d, a, x[i + 10], 23, -1094730640);
    a = md5hh(a, b, c, d, x[i + 13], 4, 681279174);
    d = md5hh(d, a, b, c, x[i], 11, -358537222);
    c = md5hh(c, d, a, b, x[i + 3], 16, -722521979);
    b = md5hh(b, c, d, a, x[i + 6], 23, 76029189);
    a = md5hh(a, b, c, d, x[i + 9], 4, -640364487);
    d = md5hh(d, a, b, c, x[i + 12], 11, -421815835);
    c = md5hh(c, d, a, b, x[i + 15], 16, 530742520);
    b = md5hh(b, c, d, a, x[i + 2], 23, -995338651);
    a = md5ii(a, b, c, d, x[i], 6, -198630844);
    d = md5ii(d, a, b, c, x[i + 7], 10, 1126891415);
    c = md5ii(c, d, a, b, x[i + 14], 15, -1416354905);
    b = md5ii(b, c, d, a, x[i + 5], 21, -57434055);
    a = md5ii(a, b, c, d, x[i + 12], 6, 1700485571);
    d = md5ii(d, a, b, c, x[i + 3], 10, -1894986606);
    c = md5ii(c, d, a, b, x[i + 10], 15, -1051523);
    b = md5ii(b, c, d, a, x[i + 1], 21, -2054922799);
    a = md5ii(a, b, c, d, x[i + 8], 6, 1873313359);
    d = md5ii(d, a, b, c, x[i + 15], 10, -30611744);
    c = md5ii(c, d, a, b, x[i + 6], 15, -1560198380);
    b = md5ii(b, c, d, a, x[i + 13], 21, 1309151649);
    a = md5ii(a, b, c, d, x[i + 4], 6, -145523070);
    d = md5ii(d, a, b, c, x[i + 11], 10, -1120210379);
    c = md5ii(c, d, a, b, x[i + 2], 15, 718787259);
    b = md5ii(b, c, d, a, x[i + 9], 21, -343485551);
    a = safeAdd(a, olda);
    b = safeAdd(b, oldb);
    c = safeAdd(c, oldc);
    d = safeAdd(d, oldd);
  }

  return [a, b, c, d];
}
/*
 * Convert an array bytes to an array of little-endian words
 * Characters >255 have their high-byte silently ignored.
 */


function bytesToWords(input) {
  if (input.length === 0) {
    return [];
  }

  const length8 = input.length * 8;
  const output = new Uint32Array(getOutputLength(length8));

  for (let i = 0; i < length8; i += 8) {
    output[i >> 5] |= (input[i / 8] & 0xff) << i % 32;
  }

  return output;
}
/*
 * Add integers, wrapping at 2^32. This uses 16-bit operations internally
 * to work around bugs in some JS interpreters.
 */


function safeAdd(x, y) {
  const lsw = (x & 0xffff) + (y & 0xffff);
  const msw = (x >> 16) + (y >> 16) + (lsw >> 16);
  return msw << 16 | lsw & 0xffff;
}
/*
 * Bitwise rotate a 32-bit number to the left.
 */


function bitRotateLeft(num, cnt) {
  return num << cnt | num >>> 32 - cnt;
}
/*
 * These functions implement the four basic operations the algorithm uses.
 */


function md5cmn(q, a, b, x, s, t) {
  return safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b);
}

function md5ff(a, b, c, d, x, s, t) {
  return md5cmn(b & c | ~b & d, a, b, x, s, t);
}

function md5gg(a, b, c, d, x, s, t) {
  return md5cmn(b & d | c & ~d, a, b, x, s, t);
}

function md5hh(a, b, c, d, x, s, t) {
  return md5cmn(b ^ c ^ d, a, b, x, s, t);
}

function md5ii(a, b, c, d, x, s, t) {
  return md5cmn(c ^ (b | ~d), a, b, x, s, t);
}

var _default = md5;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/native.js":
/*!***********************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/native.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;
const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);
var _default = {
  randomUUID
};
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/nil.js":
/*!********************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/nil.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;
var _default = '00000000-0000-0000-0000-000000000000';
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/parse.js":
/*!**********************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/parse.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

var _validate = _interopRequireDefault(__webpack_require__(/*! ./validate.js */ "./node_modules/uuid/dist/commonjs-browser/validate.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function parse(uuid) {
  if (!(0, _validate.default)(uuid)) {
    throw TypeError('Invalid UUID');
  }

  let v;
  const arr = new Uint8Array(16); // Parse ########-....-....-....-............

  arr[0] = (v = parseInt(uuid.slice(0, 8), 16)) >>> 24;
  arr[1] = v >>> 16 & 0xff;
  arr[2] = v >>> 8 & 0xff;
  arr[3] = v & 0xff; // Parse ........-####-....-....-............

  arr[4] = (v = parseInt(uuid.slice(9, 13), 16)) >>> 8;
  arr[5] = v & 0xff; // Parse ........-....-####-....-............

  arr[6] = (v = parseInt(uuid.slice(14, 18), 16)) >>> 8;
  arr[7] = v & 0xff; // Parse ........-....-....-####-............

  arr[8] = (v = parseInt(uuid.slice(19, 23), 16)) >>> 8;
  arr[9] = v & 0xff; // Parse ........-....-....-....-############
  // (Use "/" to avoid 32-bit truncation when bit-shifting high-order bytes)

  arr[10] = (v = parseInt(uuid.slice(24, 36), 16)) / 0x10000000000 & 0xff;
  arr[11] = v / 0x100000000 & 0xff;
  arr[12] = v >>> 24 & 0xff;
  arr[13] = v >>> 16 & 0xff;
  arr[14] = v >>> 8 & 0xff;
  arr[15] = v & 0xff;
  return arr;
}

var _default = parse;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/regex.js":
/*!**********************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/regex.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;
var _default = /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/rng.js":
/*!********************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/rng.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = rng;
// Unique ID creation requires a high quality random # generator. In the browser we therefore
// require the crypto API and do not support built-in fallback to lower quality random number
// generators (like Math.random()).
let getRandomValues;
const rnds8 = new Uint8Array(16);

function rng() {
  // lazy load so that environments that need to polyfill have a chance to do so
  if (!getRandomValues) {
    // getRandomValues needs to be invoked in a context where "this" is a Crypto implementation.
    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);

    if (!getRandomValues) {
      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');
    }
  }

  return getRandomValues(rnds8);
}

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/sha1.js":
/*!*********************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/sha1.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

// Adapted from Chris Veness' SHA1 code at
// http://www.movable-type.co.uk/scripts/sha1.html
function f(s, x, y, z) {
  switch (s) {
    case 0:
      return x & y ^ ~x & z;

    case 1:
      return x ^ y ^ z;

    case 2:
      return x & y ^ x & z ^ y & z;

    case 3:
      return x ^ y ^ z;
  }
}

function ROTL(x, n) {
  return x << n | x >>> 32 - n;
}

function sha1(bytes) {
  const K = [0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xca62c1d6];
  const H = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0];

  if (typeof bytes === 'string') {
    const msg = unescape(encodeURIComponent(bytes)); // UTF8 escape

    bytes = [];

    for (let i = 0; i < msg.length; ++i) {
      bytes.push(msg.charCodeAt(i));
    }
  } else if (!Array.isArray(bytes)) {
    // Convert Array-like to Array
    bytes = Array.prototype.slice.call(bytes);
  }

  bytes.push(0x80);
  const l = bytes.length / 4 + 2;
  const N = Math.ceil(l / 16);
  const M = new Array(N);

  for (let i = 0; i < N; ++i) {
    const arr = new Uint32Array(16);

    for (let j = 0; j < 16; ++j) {
      arr[j] = bytes[i * 64 + j * 4] << 24 | bytes[i * 64 + j * 4 + 1] << 16 | bytes[i * 64 + j * 4 + 2] << 8 | bytes[i * 64 + j * 4 + 3];
    }

    M[i] = arr;
  }

  M[N - 1][14] = (bytes.length - 1) * 8 / Math.pow(2, 32);
  M[N - 1][14] = Math.floor(M[N - 1][14]);
  M[N - 1][15] = (bytes.length - 1) * 8 & 0xffffffff;

  for (let i = 0; i < N; ++i) {
    const W = new Uint32Array(80);

    for (let t = 0; t < 16; ++t) {
      W[t] = M[i][t];
    }

    for (let t = 16; t < 80; ++t) {
      W[t] = ROTL(W[t - 3] ^ W[t - 8] ^ W[t - 14] ^ W[t - 16], 1);
    }

    let a = H[0];
    let b = H[1];
    let c = H[2];
    let d = H[3];
    let e = H[4];

    for (let t = 0; t < 80; ++t) {
      const s = Math.floor(t / 20);
      const T = ROTL(a, 5) + f(s, b, c, d) + e + K[s] + W[t] >>> 0;
      e = d;
      d = c;
      c = ROTL(b, 30) >>> 0;
      b = a;
      a = T;
    }

    H[0] = H[0] + a >>> 0;
    H[1] = H[1] + b >>> 0;
    H[2] = H[2] + c >>> 0;
    H[3] = H[3] + d >>> 0;
    H[4] = H[4] + e >>> 0;
  }

  return [H[0] >> 24 & 0xff, H[0] >> 16 & 0xff, H[0] >> 8 & 0xff, H[0] & 0xff, H[1] >> 24 & 0xff, H[1] >> 16 & 0xff, H[1] >> 8 & 0xff, H[1] & 0xff, H[2] >> 24 & 0xff, H[2] >> 16 & 0xff, H[2] >> 8 & 0xff, H[2] & 0xff, H[3] >> 24 & 0xff, H[3] >> 16 & 0xff, H[3] >> 8 & 0xff, H[3] & 0xff, H[4] >> 24 & 0xff, H[4] >> 16 & 0xff, H[4] >> 8 & 0xff, H[4] & 0xff];
}

var _default = sha1;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/stringify.js":
/*!**************************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/stringify.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;
exports.unsafeStringify = unsafeStringify;

var _validate = _interopRequireDefault(__webpack_require__(/*! ./validate.js */ "./node_modules/uuid/dist/commonjs-browser/validate.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Convert array of 16 byte values to UUID string format of the form:
 * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
 */
const byteToHex = [];

for (let i = 0; i < 256; ++i) {
  byteToHex.push((i + 0x100).toString(16).slice(1));
}

function unsafeStringify(arr, offset = 0) {
  // Note: Be careful editing this code!  It's been tuned for performance
  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434
  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();
}

function stringify(arr, offset = 0) {
  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one
  // of the following:
  // - One or more input array values don't map to a hex octet (leading to
  // "undefined" in the uuid)
  // - Invalid input values for the RFC `version` or `variant` fields

  if (!(0, _validate.default)(uuid)) {
    throw TypeError('Stringified UUID is invalid');
  }

  return uuid;
}

var _default = stringify;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/v1.js":
/*!*******************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/v1.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

var _rng = _interopRequireDefault(__webpack_require__(/*! ./rng.js */ "./node_modules/uuid/dist/commonjs-browser/rng.js"));

var _stringify = __webpack_require__(/*! ./stringify.js */ "./node_modules/uuid/dist/commonjs-browser/stringify.js");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// **`v1()` - Generate time-based UUID**
//
// Inspired by https://github.com/LiosK/UUID.js
// and http://docs.python.org/library/uuid.html
let _nodeId;

let _clockseq; // Previous uuid creation time


let _lastMSecs = 0;
let _lastNSecs = 0; // See https://github.com/uuidjs/uuid for API details

function v1(options, buf, offset) {
  let i = buf && offset || 0;
  const b = buf || new Array(16);
  options = options || {};
  let node = options.node || _nodeId;
  let clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq; // node and clockseq need to be initialized to random values if they're not
  // specified.  We do this lazily to minimize issues related to insufficient
  // system entropy.  See #189

  if (node == null || clockseq == null) {
    const seedBytes = options.random || (options.rng || _rng.default)();

    if (node == null) {
      // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)
      node = _nodeId = [seedBytes[0] | 0x01, seedBytes[1], seedBytes[2], seedBytes[3], seedBytes[4], seedBytes[5]];
    }

    if (clockseq == null) {
      // Per 4.2.2, randomize (14 bit) clockseq
      clockseq = _clockseq = (seedBytes[6] << 8 | seedBytes[7]) & 0x3fff;
    }
  } // UUID timestamps are 100 nano-second units since the Gregorian epoch,
  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so
  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'
  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.


  let msecs = options.msecs !== undefined ? options.msecs : Date.now(); // Per 4.2.1.2, use count of uuid's generated during the current clock
  // cycle to simulate higher resolution clock

  let nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1; // Time since last uuid creation (in msecs)

  const dt = msecs - _lastMSecs + (nsecs - _lastNSecs) / 10000; // Per 4.2.1.2, Bump clockseq on clock regression

  if (dt < 0 && options.clockseq === undefined) {
    clockseq = clockseq + 1 & 0x3fff;
  } // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new
  // time interval


  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {
    nsecs = 0;
  } // Per 4.2.1.2 Throw error if too many uuids are requested


  if (nsecs >= 10000) {
    throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");
  }

  _lastMSecs = msecs;
  _lastNSecs = nsecs;
  _clockseq = clockseq; // Per 4.1.4 - Convert from unix epoch to Gregorian epoch

  msecs += 12219292800000; // `time_low`

  const tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;
  b[i++] = tl >>> 24 & 0xff;
  b[i++] = tl >>> 16 & 0xff;
  b[i++] = tl >>> 8 & 0xff;
  b[i++] = tl & 0xff; // `time_mid`

  const tmh = msecs / 0x100000000 * 10000 & 0xfffffff;
  b[i++] = tmh >>> 8 & 0xff;
  b[i++] = tmh & 0xff; // `time_high_and_version`

  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version

  b[i++] = tmh >>> 16 & 0xff; // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)

  b[i++] = clockseq >>> 8 | 0x80; // `clock_seq_low`

  b[i++] = clockseq & 0xff; // `node`

  for (let n = 0; n < 6; ++n) {
    b[i + n] = node[n];
  }

  return buf || (0, _stringify.unsafeStringify)(b);
}

var _default = v1;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/v3.js":
/*!*******************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/v3.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

var _v = _interopRequireDefault(__webpack_require__(/*! ./v35.js */ "./node_modules/uuid/dist/commonjs-browser/v35.js"));

var _md = _interopRequireDefault(__webpack_require__(/*! ./md5.js */ "./node_modules/uuid/dist/commonjs-browser/md5.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const v3 = (0, _v.default)('v3', 0x30, _md.default);
var _default = v3;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/v35.js":
/*!********************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/v35.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports.URL = exports.DNS = void 0;
exports["default"] = v35;

var _stringify = __webpack_require__(/*! ./stringify.js */ "./node_modules/uuid/dist/commonjs-browser/stringify.js");

var _parse = _interopRequireDefault(__webpack_require__(/*! ./parse.js */ "./node_modules/uuid/dist/commonjs-browser/parse.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function stringToBytes(str) {
  str = unescape(encodeURIComponent(str)); // UTF8 escape

  const bytes = [];

  for (let i = 0; i < str.length; ++i) {
    bytes.push(str.charCodeAt(i));
  }

  return bytes;
}

const DNS = '6ba7b810-9dad-11d1-80b4-00c04fd430c8';
exports.DNS = DNS;
const URL = '6ba7b811-9dad-11d1-80b4-00c04fd430c8';
exports.URL = URL;

function v35(name, version, hashfunc) {
  function generateUUID(value, namespace, buf, offset) {
    var _namespace;

    if (typeof value === 'string') {
      value = stringToBytes(value);
    }

    if (typeof namespace === 'string') {
      namespace = (0, _parse.default)(namespace);
    }

    if (((_namespace = namespace) === null || _namespace === void 0 ? void 0 : _namespace.length) !== 16) {
      throw TypeError('Namespace must be array-like (16 iterable integer values, 0-255)');
    } // Compute hash of namespace and value, Per 4.3
    // Future: Use spread syntax when supported on all platforms, e.g. `bytes =
    // hashfunc([...namespace, ... value])`


    let bytes = new Uint8Array(16 + value.length);
    bytes.set(namespace);
    bytes.set(value, namespace.length);
    bytes = hashfunc(bytes);
    bytes[6] = bytes[6] & 0x0f | version;
    bytes[8] = bytes[8] & 0x3f | 0x80;

    if (buf) {
      offset = offset || 0;

      for (let i = 0; i < 16; ++i) {
        buf[offset + i] = bytes[i];
      }

      return buf;
    }

    return (0, _stringify.unsafeStringify)(bytes);
  } // Function#name is not settable on some platforms (#270)


  try {
    generateUUID.name = name; // eslint-disable-next-line no-empty
  } catch (err) {} // For CommonJS default export support


  generateUUID.DNS = DNS;
  generateUUID.URL = URL;
  return generateUUID;
}

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/v4.js":
/*!*******************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/v4.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

var _native = _interopRequireDefault(__webpack_require__(/*! ./native.js */ "./node_modules/uuid/dist/commonjs-browser/native.js"));

var _rng = _interopRequireDefault(__webpack_require__(/*! ./rng.js */ "./node_modules/uuid/dist/commonjs-browser/rng.js"));

var _stringify = __webpack_require__(/*! ./stringify.js */ "./node_modules/uuid/dist/commonjs-browser/stringify.js");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function v4(options, buf, offset) {
  if (_native.default.randomUUID && !buf && !options) {
    return _native.default.randomUUID();
  }

  options = options || {};

  const rnds = options.random || (options.rng || _rng.default)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`


  rnds[6] = rnds[6] & 0x0f | 0x40;
  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided

  if (buf) {
    offset = offset || 0;

    for (let i = 0; i < 16; ++i) {
      buf[offset + i] = rnds[i];
    }

    return buf;
  }

  return (0, _stringify.unsafeStringify)(rnds);
}

var _default = v4;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/v5.js":
/*!*******************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/v5.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

var _v = _interopRequireDefault(__webpack_require__(/*! ./v35.js */ "./node_modules/uuid/dist/commonjs-browser/v35.js"));

var _sha = _interopRequireDefault(__webpack_require__(/*! ./sha1.js */ "./node_modules/uuid/dist/commonjs-browser/sha1.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const v5 = (0, _v.default)('v5', 0x50, _sha.default);
var _default = v5;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/validate.js":
/*!*************************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/validate.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

var _regex = _interopRequireDefault(__webpack_require__(/*! ./regex.js */ "./node_modules/uuid/dist/commonjs-browser/regex.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function validate(uuid) {
  return typeof uuid === 'string' && _regex.default.test(uuid);
}

var _default = validate;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/version.js":
/*!************************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/version.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

var _validate = _interopRequireDefault(__webpack_require__(/*! ./validate.js */ "./node_modules/uuid/dist/commonjs-browser/validate.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function version(uuid) {
  if (!(0, _validate.default)(uuid)) {
    throw TypeError('Invalid UUID');
  }

  return parseInt(uuid.slice(14, 15), 16);
}

var _default = version;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/esm-browser/native.js":
/*!******************************************************!*\
  !*** ./node_modules/uuid/dist/esm-browser/native.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
  randomUUID
});

/***/ }),

/***/ "./node_modules/uuid/dist/esm-browser/regex.js":
/*!*****************************************************!*\
  !*** ./node_modules/uuid/dist/esm-browser/regex.js ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i);

/***/ }),

/***/ "./node_modules/uuid/dist/esm-browser/rng.js":
/*!***************************************************!*\
  !*** ./node_modules/uuid/dist/esm-browser/rng.js ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ rng)
/* harmony export */ });
// Unique ID creation requires a high quality random # generator. In the browser we therefore
// require the crypto API and do not support built-in fallback to lower quality random number
// generators (like Math.random()).
let getRandomValues;
const rnds8 = new Uint8Array(16);
function rng() {
  // lazy load so that environments that need to polyfill have a chance to do so
  if (!getRandomValues) {
    // getRandomValues needs to be invoked in a context where "this" is a Crypto implementation.
    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);

    if (!getRandomValues) {
      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');
    }
  }

  return getRandomValues(rnds8);
}

/***/ }),

/***/ "./node_modules/uuid/dist/esm-browser/stringify.js":
/*!*********************************************************!*\
  !*** ./node_modules/uuid/dist/esm-browser/stringify.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__),
/* harmony export */   "unsafeStringify": () => (/* binding */ unsafeStringify)
/* harmony export */ });
/* harmony import */ var _validate_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./validate.js */ "./node_modules/uuid/dist/esm-browser/validate.js");

/**
 * Convert array of 16 byte values to UUID string format of the form:
 * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
 */

const byteToHex = [];

for (let i = 0; i < 256; ++i) {
  byteToHex.push((i + 0x100).toString(16).slice(1));
}

function unsafeStringify(arr, offset = 0) {
  // Note: Be careful editing this code!  It's been tuned for performance
  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434
  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();
}

function stringify(arr, offset = 0) {
  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one
  // of the following:
  // - One or more input array values don't map to a hex octet (leading to
  // "undefined" in the uuid)
  // - Invalid input values for the RFC `version` or `variant` fields

  if (!(0,_validate_js__WEBPACK_IMPORTED_MODULE_0__["default"])(uuid)) {
    throw TypeError('Stringified UUID is invalid');
  }

  return uuid;
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (stringify);

/***/ }),

/***/ "./node_modules/uuid/dist/esm-browser/v4.js":
/*!**************************************************!*\
  !*** ./node_modules/uuid/dist/esm-browser/v4.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _native_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./native.js */ "./node_modules/uuid/dist/esm-browser/native.js");
/* harmony import */ var _rng_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./rng.js */ "./node_modules/uuid/dist/esm-browser/rng.js");
/* harmony import */ var _stringify_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./stringify.js */ "./node_modules/uuid/dist/esm-browser/stringify.js");




function v4(options, buf, offset) {
  if (_native_js__WEBPACK_IMPORTED_MODULE_0__["default"].randomUUID && !buf && !options) {
    return _native_js__WEBPACK_IMPORTED_MODULE_0__["default"].randomUUID();
  }

  options = options || {};
  const rnds = options.random || (options.rng || _rng_js__WEBPACK_IMPORTED_MODULE_1__["default"])(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`

  rnds[6] = rnds[6] & 0x0f | 0x40;
  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided

  if (buf) {
    offset = offset || 0;

    for (let i = 0; i < 16; ++i) {
      buf[offset + i] = rnds[i];
    }

    return buf;
  }

  return (0,_stringify_js__WEBPACK_IMPORTED_MODULE_2__.unsafeStringify)(rnds);
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (v4);

/***/ }),

/***/ "./node_modules/uuid/dist/esm-browser/validate.js":
/*!********************************************************!*\
  !*** ./node_modules/uuid/dist/esm-browser/validate.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _regex_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./regex.js */ "./node_modules/uuid/dist/esm-browser/regex.js");


function validate(uuid) {
  return typeof uuid === 'string' && _regex_js__WEBPACK_IMPORTED_MODULE_0__["default"].test(uuid);
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (validate);

/***/ }),

/***/ "./node_modules/webextension-polyfill/dist/browser-polyfill.js":
/*!*********************************************************************!*\
  !*** ./node_modules/webextension-polyfill/dist/browser-polyfill.js ***!
  \*********************************************************************/
/***/ (function(module, exports) {

var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (global, factory) {
  if (true) {
    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [module], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),
		__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
		(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
		__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
  } else { var mod; }
})(typeof globalThis !== "undefined" ? globalThis : typeof self !== "undefined" ? self : this, function (module) {
  /* webextension-polyfill - v0.10.0 - Fri Aug 12 2022 19:42:44 */

  /* -*- Mode: indent-tabs-mode: nil; js-indent-level: 2 -*- */

  /* vim: set sts=2 sw=2 et tw=80: */

  /* This Source Code Form is subject to the terms of the Mozilla Public
   * License, v. 2.0. If a copy of the MPL was not distributed with this
   * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
  "use strict";

  if (!globalThis.chrome?.runtime?.id) {
    throw new Error("This script should only be loaded in a browser extension.");
  }

  if (typeof globalThis.browser === "undefined" || Object.getPrototypeOf(globalThis.browser) !== Object.prototype) {
    const CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE = "The message port closed before a response was received."; // Wrapping the bulk of this polyfill in a one-time-use function is a minor
    // optimization for Firefox. Since Spidermonkey does not fully parse the
    // contents of a function until the first time it's called, and since it will
    // never actually need to be called, this allows the polyfill to be included
    // in Firefox nearly for free.

    const wrapAPIs = extensionAPIs => {
      // NOTE: apiMetadata is associated to the content of the api-metadata.json file
      // at build time by replacing the following "include" with the content of the
      // JSON file.
      const apiMetadata = {
        "alarms": {
          "clear": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "clearAll": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "get": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "getAll": {
            "minArgs": 0,
            "maxArgs": 0
          }
        },
        "bookmarks": {
          "create": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "get": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getChildren": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getRecent": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getSubTree": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getTree": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "move": {
            "minArgs": 2,
            "maxArgs": 2
          },
          "remove": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removeTree": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "search": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "update": {
            "minArgs": 2,
            "maxArgs": 2
          }
        },
        "browserAction": {
          "disable": {
            "minArgs": 0,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          },
          "enable": {
            "minArgs": 0,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          },
          "getBadgeBackgroundColor": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getBadgeText": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getPopup": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getTitle": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "openPopup": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "setBadgeBackgroundColor": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          },
          "setBadgeText": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          },
          "setIcon": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "setPopup": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          },
          "setTitle": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          }
        },
        "browsingData": {
          "remove": {
            "minArgs": 2,
            "maxArgs": 2
          },
          "removeCache": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removeCookies": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removeDownloads": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removeFormData": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removeHistory": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removeLocalStorage": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removePasswords": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removePluginData": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "settings": {
            "minArgs": 0,
            "maxArgs": 0
          }
        },
        "commands": {
          "getAll": {
            "minArgs": 0,
            "maxArgs": 0
          }
        },
        "contextMenus": {
          "remove": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removeAll": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "update": {
            "minArgs": 2,
            "maxArgs": 2
          }
        },
        "cookies": {
          "get": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getAll": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getAllCookieStores": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "remove": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "set": {
            "minArgs": 1,
            "maxArgs": 1
          }
        },
        "devtools": {
          "inspectedWindow": {
            "eval": {
              "minArgs": 1,
              "maxArgs": 2,
              "singleCallbackArg": false
            }
          },
          "panels": {
            "create": {
              "minArgs": 3,
              "maxArgs": 3,
              "singleCallbackArg": true
            },
            "elements": {
              "createSidebarPane": {
                "minArgs": 1,
                "maxArgs": 1
              }
            }
          }
        },
        "downloads": {
          "cancel": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "download": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "erase": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getFileIcon": {
            "minArgs": 1,
            "maxArgs": 2
          },
          "open": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          },
          "pause": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removeFile": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "resume": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "search": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "show": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          }
        },
        "extension": {
          "isAllowedFileSchemeAccess": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "isAllowedIncognitoAccess": {
            "minArgs": 0,
            "maxArgs": 0
          }
        },
        "history": {
          "addUrl": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "deleteAll": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "deleteRange": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "deleteUrl": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getVisits": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "search": {
            "minArgs": 1,
            "maxArgs": 1
          }
        },
        "i18n": {
          "detectLanguage": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getAcceptLanguages": {
            "minArgs": 0,
            "maxArgs": 0
          }
        },
        "identity": {
          "launchWebAuthFlow": {
            "minArgs": 1,
            "maxArgs": 1
          }
        },
        "idle": {
          "queryState": {
            "minArgs": 1,
            "maxArgs": 1
          }
        },
        "management": {
          "get": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getAll": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "getSelf": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "setEnabled": {
            "minArgs": 2,
            "maxArgs": 2
          },
          "uninstallSelf": {
            "minArgs": 0,
            "maxArgs": 1
          }
        },
        "notifications": {
          "clear": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "create": {
            "minArgs": 1,
            "maxArgs": 2
          },
          "getAll": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "getPermissionLevel": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "update": {
            "minArgs": 2,
            "maxArgs": 2
          }
        },
        "pageAction": {
          "getPopup": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getTitle": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "hide": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          },
          "setIcon": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "setPopup": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          },
          "setTitle": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          },
          "show": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          }
        },
        "permissions": {
          "contains": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getAll": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "remove": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "request": {
            "minArgs": 1,
            "maxArgs": 1
          }
        },
        "runtime": {
          "getBackgroundPage": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "getPlatformInfo": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "openOptionsPage": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "requestUpdateCheck": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "sendMessage": {
            "minArgs": 1,
            "maxArgs": 3
          },
          "sendNativeMessage": {
            "minArgs": 2,
            "maxArgs": 2
          },
          "setUninstallURL": {
            "minArgs": 1,
            "maxArgs": 1
          }
        },
        "sessions": {
          "getDevices": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "getRecentlyClosed": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "restore": {
            "minArgs": 0,
            "maxArgs": 1
          }
        },
        "storage": {
          "local": {
            "clear": {
              "minArgs": 0,
              "maxArgs": 0
            },
            "get": {
              "minArgs": 0,
              "maxArgs": 1
            },
            "getBytesInUse": {
              "minArgs": 0,
              "maxArgs": 1
            },
            "remove": {
              "minArgs": 1,
              "maxArgs": 1
            },
            "set": {
              "minArgs": 1,
              "maxArgs": 1
            }
          },
          "managed": {
            "get": {
              "minArgs": 0,
              "maxArgs": 1
            },
            "getBytesInUse": {
              "minArgs": 0,
              "maxArgs": 1
            }
          },
          "sync": {
            "clear": {
              "minArgs": 0,
              "maxArgs": 0
            },
            "get": {
              "minArgs": 0,
              "maxArgs": 1
            },
            "getBytesInUse": {
              "minArgs": 0,
              "maxArgs": 1
            },
            "remove": {
              "minArgs": 1,
              "maxArgs": 1
            },
            "set": {
              "minArgs": 1,
              "maxArgs": 1
            }
          }
        },
        "tabs": {
          "captureVisibleTab": {
            "minArgs": 0,
            "maxArgs": 2
          },
          "create": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "detectLanguage": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "discard": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "duplicate": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "executeScript": {
            "minArgs": 1,
            "maxArgs": 2
          },
          "get": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getCurrent": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "getZoom": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "getZoomSettings": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "goBack": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "goForward": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "highlight": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "insertCSS": {
            "minArgs": 1,
            "maxArgs": 2
          },
          "move": {
            "minArgs": 2,
            "maxArgs": 2
          },
          "query": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "reload": {
            "minArgs": 0,
            "maxArgs": 2
          },
          "remove": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removeCSS": {
            "minArgs": 1,
            "maxArgs": 2
          },
          "sendMessage": {
            "minArgs": 2,
            "maxArgs": 3
          },
          "setZoom": {
            "minArgs": 1,
            "maxArgs": 2
          },
          "setZoomSettings": {
            "minArgs": 1,
            "maxArgs": 2
          },
          "update": {
            "minArgs": 1,
            "maxArgs": 2
          }
        },
        "topSites": {
          "get": {
            "minArgs": 0,
            "maxArgs": 0
          }
        },
        "webNavigation": {
          "getAllFrames": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getFrame": {
            "minArgs": 1,
            "maxArgs": 1
          }
        },
        "webRequest": {
          "handlerBehaviorChanged": {
            "minArgs": 0,
            "maxArgs": 0
          }
        },
        "windows": {
          "create": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "get": {
            "minArgs": 1,
            "maxArgs": 2
          },
          "getAll": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "getCurrent": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "getLastFocused": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "remove": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "update": {
            "minArgs": 2,
            "maxArgs": 2
          }
        }
      };

      if (Object.keys(apiMetadata).length === 0) {
        throw new Error("api-metadata.json has not been included in browser-polyfill");
      }
      /**
       * A WeakMap subclass which creates and stores a value for any key which does
       * not exist when accessed, but behaves exactly as an ordinary WeakMap
       * otherwise.
       *
       * @param {function} createItem
       *        A function which will be called in order to create the value for any
       *        key which does not exist, the first time it is accessed. The
       *        function receives, as its only argument, the key being created.
       */


      class DefaultWeakMap extends WeakMap {
        constructor(createItem, items = undefined) {
          super(items);
          this.createItem = createItem;
        }

        get(key) {
          if (!this.has(key)) {
            this.set(key, this.createItem(key));
          }

          return super.get(key);
        }

      }
      /**
       * Returns true if the given object is an object with a `then` method, and can
       * therefore be assumed to behave as a Promise.
       *
       * @param {*} value The value to test.
       * @returns {boolean} True if the value is thenable.
       */


      const isThenable = value => {
        return value && typeof value === "object" && typeof value.then === "function";
      };
      /**
       * Creates and returns a function which, when called, will resolve or reject
       * the given promise based on how it is called:
       *
       * - If, when called, `chrome.runtime.lastError` contains a non-null object,
       *   the promise is rejected with that value.
       * - If the function is called with exactly one argument, the promise is
       *   resolved to that value.
       * - Otherwise, the promise is resolved to an array containing all of the
       *   function's arguments.
       *
       * @param {object} promise
       *        An object containing the resolution and rejection functions of a
       *        promise.
       * @param {function} promise.resolve
       *        The promise's resolution function.
       * @param {function} promise.reject
       *        The promise's rejection function.
       * @param {object} metadata
       *        Metadata about the wrapped method which has created the callback.
       * @param {boolean} metadata.singleCallbackArg
       *        Whether or not the promise is resolved with only the first
       *        argument of the callback, alternatively an array of all the
       *        callback arguments is resolved. By default, if the callback
       *        function is invoked with only a single argument, that will be
       *        resolved to the promise, while all arguments will be resolved as
       *        an array if multiple are given.
       *
       * @returns {function}
       *        The generated callback function.
       */


      const makeCallback = (promise, metadata) => {
        return (...callbackArgs) => {
          if (extensionAPIs.runtime.lastError) {
            promise.reject(new Error(extensionAPIs.runtime.lastError.message));
          } else if (metadata.singleCallbackArg || callbackArgs.length <= 1 && metadata.singleCallbackArg !== false) {
            promise.resolve(callbackArgs[0]);
          } else {
            promise.resolve(callbackArgs);
          }
        };
      };

      const pluralizeArguments = numArgs => numArgs == 1 ? "argument" : "arguments";
      /**
       * Creates a wrapper function for a method with the given name and metadata.
       *
       * @param {string} name
       *        The name of the method which is being wrapped.
       * @param {object} metadata
       *        Metadata about the method being wrapped.
       * @param {integer} metadata.minArgs
       *        The minimum number of arguments which must be passed to the
       *        function. If called with fewer than this number of arguments, the
       *        wrapper will raise an exception.
       * @param {integer} metadata.maxArgs
       *        The maximum number of arguments which may be passed to the
       *        function. If called with more than this number of arguments, the
       *        wrapper will raise an exception.
       * @param {boolean} metadata.singleCallbackArg
       *        Whether or not the promise is resolved with only the first
       *        argument of the callback, alternatively an array of all the
       *        callback arguments is resolved. By default, if the callback
       *        function is invoked with only a single argument, that will be
       *        resolved to the promise, while all arguments will be resolved as
       *        an array if multiple are given.
       *
       * @returns {function(object, ...*)}
       *       The generated wrapper function.
       */


      const wrapAsyncFunction = (name, metadata) => {
        return function asyncFunctionWrapper(target, ...args) {
          if (args.length < metadata.minArgs) {
            throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);
          }

          if (args.length > metadata.maxArgs) {
            throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);
          }

          return new Promise((resolve, reject) => {
            if (metadata.fallbackToNoCallback) {
              // This API method has currently no callback on Chrome, but it return a promise on Firefox,
              // and so the polyfill will try to call it with a callback first, and it will fallback
              // to not passing the callback if the first call fails.
              try {
                target[name](...args, makeCallback({
                  resolve,
                  reject
                }, metadata));
              } catch (cbError) {
                console.warn(`${name} API method doesn't seem to support the callback parameter, ` + "falling back to call it without a callback: ", cbError);
                target[name](...args); // Update the API method metadata, so that the next API calls will not try to
                // use the unsupported callback anymore.

                metadata.fallbackToNoCallback = false;
                metadata.noCallback = true;
                resolve();
              }
            } else if (metadata.noCallback) {
              target[name](...args);
              resolve();
            } else {
              target[name](...args, makeCallback({
                resolve,
                reject
              }, metadata));
            }
          });
        };
      };
      /**
       * Wraps an existing method of the target object, so that calls to it are
       * intercepted by the given wrapper function. The wrapper function receives,
       * as its first argument, the original `target` object, followed by each of
       * the arguments passed to the original method.
       *
       * @param {object} target
       *        The original target object that the wrapped method belongs to.
       * @param {function} method
       *        The method being wrapped. This is used as the target of the Proxy
       *        object which is created to wrap the method.
       * @param {function} wrapper
       *        The wrapper function which is called in place of a direct invocation
       *        of the wrapped method.
       *
       * @returns {Proxy<function>}
       *        A Proxy object for the given method, which invokes the given wrapper
       *        method in its place.
       */


      const wrapMethod = (target, method, wrapper) => {
        return new Proxy(method, {
          apply(targetMethod, thisObj, args) {
            return wrapper.call(thisObj, target, ...args);
          }

        });
      };

      let hasOwnProperty = Function.call.bind(Object.prototype.hasOwnProperty);
      /**
       * Wraps an object in a Proxy which intercepts and wraps certain methods
       * based on the given `wrappers` and `metadata` objects.
       *
       * @param {object} target
       *        The target object to wrap.
       *
       * @param {object} [wrappers = {}]
       *        An object tree containing wrapper functions for special cases. Any
       *        function present in this object tree is called in place of the
       *        method in the same location in the `target` object tree. These
       *        wrapper methods are invoked as described in {@see wrapMethod}.
       *
       * @param {object} [metadata = {}]
       *        An object tree containing metadata used to automatically generate
       *        Promise-based wrapper functions for asynchronous. Any function in
       *        the `target` object tree which has a corresponding metadata object
       *        in the same location in the `metadata` tree is replaced with an
       *        automatically-generated wrapper function, as described in
       *        {@see wrapAsyncFunction}
       *
       * @returns {Proxy<object>}
       */

      const wrapObject = (target, wrappers = {}, metadata = {}) => {
        let cache = Object.create(null);
        let handlers = {
          has(proxyTarget, prop) {
            return prop in target || prop in cache;
          },

          get(proxyTarget, prop, receiver) {
            if (prop in cache) {
              return cache[prop];
            }

            if (!(prop in target)) {
              return undefined;
            }

            let value = target[prop];

            if (typeof value === "function") {
              // This is a method on the underlying object. Check if we need to do
              // any wrapping.
              if (typeof wrappers[prop] === "function") {
                // We have a special-case wrapper for this method.
                value = wrapMethod(target, target[prop], wrappers[prop]);
              } else if (hasOwnProperty(metadata, prop)) {
                // This is an async method that we have metadata for. Create a
                // Promise wrapper for it.
                let wrapper = wrapAsyncFunction(prop, metadata[prop]);
                value = wrapMethod(target, target[prop], wrapper);
              } else {
                // This is a method that we don't know or care about. Return the
                // original method, bound to the underlying object.
                value = value.bind(target);
              }
            } else if (typeof value === "object" && value !== null && (hasOwnProperty(wrappers, prop) || hasOwnProperty(metadata, prop))) {
              // This is an object that we need to do some wrapping for the children
              // of. Create a sub-object wrapper for it with the appropriate child
              // metadata.
              value = wrapObject(value, wrappers[prop], metadata[prop]);
            } else if (hasOwnProperty(metadata, "*")) {
              // Wrap all properties in * namespace.
              value = wrapObject(value, wrappers[prop], metadata["*"]);
            } else {
              // We don't need to do any wrapping for this property,
              // so just forward all access to the underlying object.
              Object.defineProperty(cache, prop, {
                configurable: true,
                enumerable: true,

                get() {
                  return target[prop];
                },

                set(value) {
                  target[prop] = value;
                }

              });
              return value;
            }

            cache[prop] = value;
            return value;
          },

          set(proxyTarget, prop, value, receiver) {
            if (prop in cache) {
              cache[prop] = value;
            } else {
              target[prop] = value;
            }

            return true;
          },

          defineProperty(proxyTarget, prop, desc) {
            return Reflect.defineProperty(cache, prop, desc);
          },

          deleteProperty(proxyTarget, prop) {
            return Reflect.deleteProperty(cache, prop);
          }

        }; // Per contract of the Proxy API, the "get" proxy handler must return the
        // original value of the target if that value is declared read-only and
        // non-configurable. For this reason, we create an object with the
        // prototype set to `target` instead of using `target` directly.
        // Otherwise we cannot return a custom object for APIs that
        // are declared read-only and non-configurable, such as `chrome.devtools`.
        //
        // The proxy handlers themselves will still use the original `target`
        // instead of the `proxyTarget`, so that the methods and properties are
        // dereferenced via the original targets.

        let proxyTarget = Object.create(target);
        return new Proxy(proxyTarget, handlers);
      };
      /**
       * Creates a set of wrapper functions for an event object, which handles
       * wrapping of listener functions that those messages are passed.
       *
       * A single wrapper is created for each listener function, and stored in a
       * map. Subsequent calls to `addListener`, `hasListener`, or `removeListener`
       * retrieve the original wrapper, so that  attempts to remove a
       * previously-added listener work as expected.
       *
       * @param {DefaultWeakMap<function, function>} wrapperMap
       *        A DefaultWeakMap object which will create the appropriate wrapper
       *        for a given listener function when one does not exist, and retrieve
       *        an existing one when it does.
       *
       * @returns {object}
       */


      const wrapEvent = wrapperMap => ({
        addListener(target, listener, ...args) {
          target.addListener(wrapperMap.get(listener), ...args);
        },

        hasListener(target, listener) {
          return target.hasListener(wrapperMap.get(listener));
        },

        removeListener(target, listener) {
          target.removeListener(wrapperMap.get(listener));
        }

      });

      const onRequestFinishedWrappers = new DefaultWeakMap(listener => {
        if (typeof listener !== "function") {
          return listener;
        }
        /**
         * Wraps an onRequestFinished listener function so that it will return a
         * `getContent()` property which returns a `Promise` rather than using a
         * callback API.
         *
         * @param {object} req
         *        The HAR entry object representing the network request.
         */


        return function onRequestFinished(req) {
          const wrappedReq = wrapObject(req, {}
          /* wrappers */
          , {
            getContent: {
              minArgs: 0,
              maxArgs: 0
            }
          });
          listener(wrappedReq);
        };
      });
      const onMessageWrappers = new DefaultWeakMap(listener => {
        if (typeof listener !== "function") {
          return listener;
        }
        /**
         * Wraps a message listener function so that it may send responses based on
         * its return value, rather than by returning a sentinel value and calling a
         * callback. If the listener function returns a Promise, the response is
         * sent when the promise either resolves or rejects.
         *
         * @param {*} message
         *        The message sent by the other end of the channel.
         * @param {object} sender
         *        Details about the sender of the message.
         * @param {function(*)} sendResponse
         *        A callback which, when called with an arbitrary argument, sends
         *        that value as a response.
         * @returns {boolean}
         *        True if the wrapped listener returned a Promise, which will later
         *        yield a response. False otherwise.
         */


        return function onMessage(message, sender, sendResponse) {
          let didCallSendResponse = false;
          let wrappedSendResponse;
          let sendResponsePromise = new Promise(resolve => {
            wrappedSendResponse = function (response) {
              didCallSendResponse = true;
              resolve(response);
            };
          });
          let result;

          try {
            result = listener(message, sender, wrappedSendResponse);
          } catch (err) {
            result = Promise.reject(err);
          }

          const isResultThenable = result !== true && isThenable(result); // If the listener didn't returned true or a Promise, or called
          // wrappedSendResponse synchronously, we can exit earlier
          // because there will be no response sent from this listener.

          if (result !== true && !isResultThenable && !didCallSendResponse) {
            return false;
          } // A small helper to send the message if the promise resolves
          // and an error if the promise rejects (a wrapped sendMessage has
          // to translate the message into a resolved promise or a rejected
          // promise).


          const sendPromisedResult = promise => {
            promise.then(msg => {
              // send the message value.
              sendResponse(msg);
            }, error => {
              // Send a JSON representation of the error if the rejected value
              // is an instance of error, or the object itself otherwise.
              let message;

              if (error && (error instanceof Error || typeof error.message === "string")) {
                message = error.message;
              } else {
                message = "An unexpected error occurred";
              }

              sendResponse({
                __mozWebExtensionPolyfillReject__: true,
                message
              });
            }).catch(err => {
              // Print an error on the console if unable to send the response.
              console.error("Failed to send onMessage rejected reply", err);
            });
          }; // If the listener returned a Promise, send the resolved value as a
          // result, otherwise wait the promise related to the wrappedSendResponse
          // callback to resolve and send it as a response.


          if (isResultThenable) {
            sendPromisedResult(result);
          } else {
            sendPromisedResult(sendResponsePromise);
          } // Let Chrome know that the listener is replying.


          return true;
        };
      });

      const wrappedSendMessageCallback = ({
        reject,
        resolve
      }, reply) => {
        if (extensionAPIs.runtime.lastError) {
          // Detect when none of the listeners replied to the sendMessage call and resolve
          // the promise to undefined as in Firefox.
          // See https://github.com/mozilla/webextension-polyfill/issues/130
          if (extensionAPIs.runtime.lastError.message === CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE) {
            resolve();
          } else {
            reject(new Error(extensionAPIs.runtime.lastError.message));
          }
        } else if (reply && reply.__mozWebExtensionPolyfillReject__) {
          // Convert back the JSON representation of the error into
          // an Error instance.
          reject(new Error(reply.message));
        } else {
          resolve(reply);
        }
      };

      const wrappedSendMessage = (name, metadata, apiNamespaceObj, ...args) => {
        if (args.length < metadata.minArgs) {
          throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);
        }

        if (args.length > metadata.maxArgs) {
          throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);
        }

        return new Promise((resolve, reject) => {
          const wrappedCb = wrappedSendMessageCallback.bind(null, {
            resolve,
            reject
          });
          args.push(wrappedCb);
          apiNamespaceObj.sendMessage(...args);
        });
      };

      const staticWrappers = {
        devtools: {
          network: {
            onRequestFinished: wrapEvent(onRequestFinishedWrappers)
          }
        },
        runtime: {
          onMessage: wrapEvent(onMessageWrappers),
          onMessageExternal: wrapEvent(onMessageWrappers),
          sendMessage: wrappedSendMessage.bind(null, "sendMessage", {
            minArgs: 1,
            maxArgs: 3
          })
        },
        tabs: {
          sendMessage: wrappedSendMessage.bind(null, "sendMessage", {
            minArgs: 2,
            maxArgs: 3
          })
        }
      };
      const settingMetadata = {
        clear: {
          minArgs: 1,
          maxArgs: 1
        },
        get: {
          minArgs: 1,
          maxArgs: 1
        },
        set: {
          minArgs: 1,
          maxArgs: 1
        }
      };
      apiMetadata.privacy = {
        network: {
          "*": settingMetadata
        },
        services: {
          "*": settingMetadata
        },
        websites: {
          "*": settingMetadata
        }
      };
      return wrapObject(extensionAPIs, staticWrappers, apiMetadata);
    }; // The build process adds a UMD wrapper around this file, which makes the
    // `module` variable available.


    module.exports = wrapAPIs(chrome);
  } else {
    module.exports = globalThis.browser;
  }
});
//# sourceMappingURL=browser-polyfill.js.map


/***/ }),

/***/ "?6483":
/*!****************************!*\
  !*** agent-base (ignored) ***!
  \****************************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "?0825":
/*!********************!*\
  !*** fs (ignored) ***!
  \********************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "?72ad":
/*!***********************************!*\
  !*** https-proxy-agent (ignored) ***!
  \***********************************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "?a1bf":
/*!*********************!*\
  !*** net (ignored) ***!
  \*********************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "?14d6":
/*!*********************!*\
  !*** tls (ignored) ***!
  \*********************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "?e42a":
/*!********************!*\
  !*** ws (ignored) ***!
  \********************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "?9463":
/*!********************!*\
  !*** fs (ignored) ***!
  \********************/
/***/ (() => {

/* (ignored) */

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module is referenced by other modules so it can't be inlined
/******/ 	var __webpack_exports__ = __webpack_require__("./src/background.ts");
/******/ 	
/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxnQ0FBZ0M7O0FBRWpDOzs7Ozs7Ozs7Ozs7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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxrRUFBa0U7O0FBRW5FOzs7Ozs7Ozs7Ozs7Ozs7OztBQzVOQTtBQUNBO0FBQzRDO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTyxvQ0FBb0Ms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Q0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsc0JBQXNCO0FBQ3RCO0FBQ0EsMEJBQTBCO0FBQzFCLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxVQUFVLElBQUk7QUFDZDtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QseUNBQXlDO0FBQ3pDO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0gsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNILENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0gsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QztBQUN4QztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EseUNBQXlDO0FBQ3pDO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNILENBQUM7QUFDRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0gsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0gsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULHlDQUF5QztBQUN6QztBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QseUNBQXlDO0FBQ3pDO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0gsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUM7QUFDdkM7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsR0FBRztBQUNIO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QseUNBQXlDO0FBQ3pDO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNILENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyw0QkFBNEI7O0FBRTdCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsMEJBQTBCOztBQUUzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVnRTtBQUNqRTs7Ozs7Ozs7Ozs7O0FDaGdDYTs7QUFFYiw4Q0FBNkM7QUFDN0M7QUFDQSxDQUFDLEVBQUM7QUFDRix1Q0FBc0M7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLEVBQUM7QUFDRix5Q0FBd0M7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLEVBQUM7QUFDRiw2Q0FBNEM7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLEVBQUM7QUFDRixzQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLEVBQUM7QUFDRixzQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLEVBQUM7QUFDRixzQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLEVBQUM7QUFDRixzQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLEVBQUM7QUFDRiw0Q0FBMkM7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLEVBQUM7QUFDRiwyQ0FBMEM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLEVBQUM7O0FBRUYsZ0NBQWdDLG1CQUFPLENBQUMsZ0VBQVM7O0FBRWpELGlDQUFpQyxtQkFBTyxDQUFDLGdFQUFTOztBQUVsRCxpQ0FBaUMsbUJBQU8sQ0FBQyxnRUFBUzs7QUFFbEQsaUNBQWlDLG1CQUFPLENBQUMsZ0VBQVM7O0FBRWxELGtDQUFrQyxtQkFBTyxDQUFDLGtFQUFVOztBQUVwRCxzQ0FBc0MsbUJBQU8sQ0FBQywwRUFBYzs7QUFFNUQsdUNBQXVDLG1CQUFPLENBQUMsNEVBQWU7O0FBRTlELHdDQUF3QyxtQkFBTyxDQUFDLDhFQUFnQjs7QUFFaEUsb0NBQW9DLG1CQUFPLENBQUMsc0VBQVk7O0FBRXhELHVDQUF1Qyx1Q0FBdUM7Ozs7Ozs7Ozs7O0FDOUVqRTs7QUFFYiw4Q0FBNkM7QUFDN0M7QUFDQSxDQUFDLEVBQUM7QUFDRixrQkFBZTs7QUFFZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRDs7QUFFckQ7O0FBRUEsb0JBQW9CLGdCQUFnQjtBQUNwQztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsa0JBQWtCLGNBQWM7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGtCQUFrQixjQUFjO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxrQkFBa0IsYUFBYTtBQUMvQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0Esa0JBQWU7Ozs7Ozs7Ozs7O0FDOU5GOztBQUViLDhDQUE2QztBQUM3QztBQUNBLENB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LFlBUU47QUFDSCxDQUFDO0FBQ0Q7O0FBRUEsc0NBQXNDOztBQUV0Qzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx3SEFBd0g7QUFDeEg7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixVQUFVO0FBQzNCO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixHQUFHO0FBQ3BCLG1CQUFtQixTQUFTO0FBQzVCOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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VUVOQTtVQUNBO1VBQ0E7VUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL2JlbnQvc3JjL2Jyb3dzZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvYmVudC9zcmMvY29yZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9jb250ZW50LXR5cGUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvZXZlbnRzb3VyY2UtcGFyc2VyL2Rpc3QvaW5kZXguanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvbWljcm9zb2Z0LmNvZ25pdGl2ZXNlcnZpY2VzLnNwZWVjaC5zZGsuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5icm93c2VyL0NvbnNvbGVMb2dnaW5nTGlzdGVuZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5icm93c2VyL0ZpbGVBdWRpb1NvdXJjZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLmJyb3dzZXIvTWljQXVkaW9Tb3VyY2UuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5icm93c2VyL1BDTVJlY29yZGVyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uYnJvd3Nlci9Qcm94eUluZm8uanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5icm93c2VyL1JlcGxheWFibGVBdWRpb05vZGUuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5icm93c2VyL1Jlc3RDb25maWdCYXNlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uYnJvd3Nlci9SZXN0TWVzc2FnZUFkYXB0ZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5icm93c2VyL1dlYnNvY2tldENvbm5lY3Rpb24uanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5icm93c2VyL1dlYnNvY2tldE1lc3NhZ2VBZGFwdGVyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL0FkZGVkTG1JbnRlbnQuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvQWdlbnRDb25maWcuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvQ29nbml0aXZlU3Vic2NyaXB0aW9uS2V5QXV0aGVudGljYXRpb24uanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvQ29nbml0aXZlVG9rZW5BdXRoZW50aWNhdGlvbi5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9Db25uZWN0aW9uRmFjdG9yeUJhc2UuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvQ29udmVyc2F0aW9uU2VydmljZVJlY29nbml6ZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvRGlhbG9nQ29ubmVjdG9yRmFjdG9yeS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9EaWFsb2dTZXJ2aWNlQWRhcHRlci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9EaWFsb2dTZXJ2aWNlVHVyblN0YXRlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL0RpYWxvZ1NlcnZpY2VUdXJuU3RhdGVNYW5hZ2VyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL0R5bmFtaWNHcmFtbWFyQnVpbGRlci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9EeW5hbWljR3JhbW1hckludGVyZmFjZXMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvRW51bVRyYW5zbGF0aW9uLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL0V4cG9ydHMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvSGVhZGVyTmFtZXMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvSUF1dGhlbnRpY2F0aW9uLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL0lDb25uZWN0aW9uRmFjdG9yeS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9JU3ludGhlc2lzQ29ubmVjdGlvbkZhY3RvcnkuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvSW50ZW50Q29ubmVjdGlvbkZhY3RvcnkuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvSW50ZW50U2VydmljZVJlY29nbml6ZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvUXVlcnlQYXJhbWV0ZXJOYW1lcy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9SZWNvZ25pdGlvbkV2ZW50cy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9SZWNvZ25pemVyQ29uZmlnLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1JlcXVlc3RTZXNzaW9uLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NlcnZpY2VNZXNzYWdlcy9BY3Rpdml0eVJlc3BvbnNlUGF5bG9hZC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9TZXJ2aWNlTWVzc2FnZXMvRGV0YWlsZWRTcGVlY2hQaHJhc2UuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU2VydmljZU1lc3NhZ2VzL0VudW1zLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NlcnZpY2VNZXNzYWdlcy9JbnRlbnRSZXNwb25zZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9TZXJ2aWNlTWVzc2FnZXMvU2ltcGxlU3BlZWNoUGhyYXNlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NlcnZpY2VNZXNzYWdlcy9TcGVha2VyUmVzcG9uc2UuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU2VydmljZU1lc3NhZ2VzL1NwZWVjaERldGVjdGVkLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NlcnZpY2VNZXNzYWdlcy9TcGVlY2hIeXBvdGhlc2lzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NlcnZpY2VNZXNzYWdlcy9TcGVlY2hLZXl3b3JkLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NlcnZpY2VNZXNzYWdlcy9TeW50aGVzaXNBdWRpb01ldGFkYXRhLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NlcnZpY2VNZXNzYWdlcy9UcmFuc2xhdGlvbkh5cG90aGVzaXMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU2VydmljZU1lc3NhZ2VzL1RyYW5zbGF0aW9uUGhyYXNlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NlcnZpY2VNZXNzYWdlcy9UcmFuc2xhdGlvblN5bnRoZXNpc0VuZC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9TZXJ2aWNlTWVzc2FnZXMvVHVyblN0YXR1c1BheWxvYWQuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU2VydmljZVJlY29nbml6ZXJCYXNlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NlcnZpY2VUZWxlbWV0cnlMaXN0ZW5lci5JbnRlcm5hbC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9TcGVha2VyUmVjb2duaXRpb25Db25maWcuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU3BlYWtlclJlY29nbml0aW9uQ29ubmVjdGlvbkZhY3RvcnkuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU3BlYWtlclNlcnZpY2VSZWNvZ25pemVyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NwZWVjaENvbm5lY3Rpb25GYWN0b3J5LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NwZWVjaENvbm5lY3Rpb25NZXNzYWdlLkludGVybmFsLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NwZWVjaENvbnRleHQuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU3BlZWNoU2VydmljZUludGVyZmFjZXMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU3BlZWNoU2VydmljZVJlY29nbml6ZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU3BlZWNoU3ludGhlc2lzQ29ubmVjdGlvbkZhY3RvcnkuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU3ludGhlc2lzQWRhcHRlckJhc2UuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU3ludGhlc2lzQ29udGV4dC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9TeW50aGVzaXNFdmVudHMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU3ludGhlc2lzUmVzdEFkYXB0ZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU3ludGhlc2lzVHVybi5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9TeW50aGVzaXplckNvbmZpZy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaWJlckNvbm5lY3Rpb25GYWN0b3J5LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1RyYW5zY3JpcHRpb24vQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaXB0aW9uL0NvbnZlcnNhdGlvbkNvbm5lY3Rpb25GYWN0b3J5LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1RyYW5zY3JpcHRpb24vQ29udmVyc2F0aW9uQ29ubmVjdGlvbk1lc3NhZ2UuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvVHJhbnNjcmlwdGlvbi9Db252ZXJzYXRpb25NYW5hZ2VyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1RyYW5zY3JpcHRpb24vQ29udmVyc2F0aW9uUmVxdWVzdFNlc3Npb24uanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvVHJhbnNjcmlwdGlvbi9Db252ZXJzYXRpb25TZXJ2aWNlQWRhcHRlci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaXB0aW9uL0NvbnZlcnNhdGlvblRyYW5zbGF0b3JDb25uZWN0aW9uRmFjdG9yeS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaXB0aW9uL0NvbnZlcnNhdGlvblRyYW5zbGF0b3JFdmVudEFyZ3MuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvVHJhbnNjcmlwdGlvbi9Db252ZXJzYXRpb25UcmFuc2xhdG9ySW50ZXJmYWNlcy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaXB0aW9uL0NvbnZlcnNhdGlvblRyYW5zbGF0b3JSZWNvZ25pemVyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1RyYW5zY3JpcHRpb24vQ29udmVyc2F0aW9uV2Vic29ja2V0TWVzc2FnZUZvcm1hdHRlci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaXB0aW9uL0V4cG9ydHMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvVHJhbnNjcmlwdGlvbi9TZXJ2aWNlTWVzc2FnZXMvQ29tbWFuZFJlc3BvbnNlUGF5bG9hZC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaXB0aW9uL1NlcnZpY2VNZXNzYWdlcy9QYXJ0aWNpcGFudFJlc3BvbnNlUGF5bG9hZC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaXB0aW9uL1NlcnZpY2VNZXNzYWdlcy9UcmFuc2xhdGlvblJlc3BvbnNlUGF5bG9hZC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaXB0aW9uL1RyYW5zY3JpYmVyUmVjb2duaXplci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaXB0aW9uU2VydmljZVJlY29nbml6ZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvVHJhbnNsYXRpb25Db25uZWN0aW9uRmFjdG9yeS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2xhdGlvblNlcnZpY2VSZWNvZ25pemVyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1RyYW5zbGF0aW9uU3RhdHVzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1ZvaWNlU2VydmljZVJlY29nbml6ZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvV2Vic29ja2V0TWVzc2FnZUZvcm1hdHRlci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uL0F1ZGlvU291cmNlRXZlbnRzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vQmFja2dyb3VuZEVycm9yLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vQ2h1bmtlZEFycmF5QnVmZmVyU3RyZWFtLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vQ29ubmVjdGlvbkV2ZW50cy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uL0Nvbm5lY3Rpb25NZXNzYWdlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vQ29ubmVjdGlvbk9wZW5SZXNwb25zZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uL0RlZmVycmFsTWFwLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vRGlhbG9nRXZlbnRzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vRXJyb3IuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi9FdmVudFNvdXJjZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uL0V2ZW50cy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uL0d1aWQuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi9JQ29ubmVjdGlvbi5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uL0xpc3QuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi9QbGF0Zm9ybUV2ZW50LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vUHJvbWlzZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uL1F1ZXVlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vUmF3V2Vic29ja2V0TWVzc2FnZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uL1JpZmZQY21FbmNvZGVyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vU3RyZWFtLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vU3RyaW5nVXRpbHMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi9UaW1lb3V0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQWN0aXZpdHlSZWNlaXZlZEV2ZW50QXJncy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0F1ZGlvL0F1ZGlvQ29uZmlnLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQXVkaW8vQXVkaW9GaWxlV3JpdGVyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQXVkaW8vQXVkaW9JbnB1dFN0cmVhbS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0F1ZGlvL0F1ZGlvT3V0cHV0Rm9ybWF0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQXVkaW8vQXVkaW9PdXRwdXRTdHJlYW0uanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9BdWRpby9BdWRpb1N0cmVhbUZvcm1hdC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0F1ZGlvL0Jhc2VBdWRpb1BsYXllci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0F1ZGlvL1B1bGxBdWRpb0lucHV0U3RyZWFtQ2FsbGJhY2suanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9BdWRpby9QdXNoQXVkaW9PdXRwdXRTdHJlYW1DYWxsYmFjay5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0F1ZGlvL1NwZWFrZXJBdWRpb0Rlc3RpbmF0aW9uLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlUmVzdWx0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQm90RnJhbWV3b3JrQ29uZmlnLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQ2FuY2VsbGF0aW9uRGV0YWlscy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0NhbmNlbGxhdGlvbkRldGFpbHNCYXNlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQ2FuY2VsbGF0aW9uRXJyb3JDb2Rlcy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0NhbmNlbGxhdGlvbkV2ZW50QXJnc0Jhc2UuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9DYW5jZWxsYXRpb25SZWFzb24uanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9Db25uZWN0aW9uLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQ29ubmVjdGlvbkV2ZW50QXJncy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0Nvbm5lY3Rpb25NZXNzYWdlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQ29ubmVjdGlvbk1lc3NhZ2VFdmVudEFyZ3MuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9Db250cmFjdHMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9Db252ZXJzYXRpb25UcmFuc2NyaXB0aW9uQ2FuY2VsZWRFdmVudEFyZ3MuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9DdXN0b21Db21tYW5kc0NvbmZpZy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0RpYWdub3N0aWNzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvRGlhbG9nU2VydmljZUNvbmZpZy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0RpYWxvZ1NlcnZpY2VDb25uZWN0b3IuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9FeHBvcnRzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvSW50ZW50UmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJncy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0ludGVudFJlY29nbml0aW9uRXZlbnRBcmdzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvSW50ZW50UmVjb2duaXRpb25SZXN1bHQuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9JbnRlbnRSZWNvZ25pemVyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvS2V5d29yZFJlY29nbml0aW9uTW9kZWwuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9MYW5ndWFnZUlkTW9kZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0xhbmd1YWdlVW5kZXJzdGFuZGluZ01vZGVsLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvTm9NYXRjaERldGFpbHMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9Ob01hdGNoUmVhc29uLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvT3V0cHV0Rm9ybWF0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvUGhyYXNlTGlzdEdyYW1tYXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9Qcm9mYW5pdHlPcHRpb24uanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9Qcm9udW5jaWF0aW9uQXNzZXNzbWVudENvbmZpZy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1Byb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhZGluZ1N5c3RlbS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1Byb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhbnVsYXJpdHkuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9Qcm9udW5jaWF0aW9uQXNzZXNzbWVudFJlc3VsdC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1Byb3BlcnR5Q29sbGVjdGlvbi5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1Byb3BlcnR5SWQuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9SZWNvZ25pdGlvbkV2ZW50QXJncy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1JlY29nbml0aW9uUmVzdWx0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvUmVjb2duaXplci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1Jlc3VsdFJlYXNvbi5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1NlcnZpY2VFdmVudEFyZ3MuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9TZXJ2aWNlUHJvcGVydHlDaGFubmVsLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU2Vzc2lvbkV2ZW50QXJncy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1NvdXJjZUxhbmd1YWdlQ29uZmlnLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU3BlYWtlcklkZW50aWZpY2F0aW9uTW9kZWwuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9TcGVha2VyUmVjb2duaXRpb25SZXN1bHQuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9TcGVha2VyUmVjb2duaXplci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1NwZWFrZXJWZXJpZmljYXRpb25Nb2RlbC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1NwZWVjaENvbmZpZy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1NwZWVjaFJlY29nbml0aW9uQ2FuY2VsZWRFdmVudEFyZ3MuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9TcGVlY2hSZWNvZ25pdGlvbkV2ZW50QXJncy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1NwZWVjaFJlY29nbml0aW9uUmVzdWx0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU3BlZWNoUmVjb2duaXplci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1NwZWVjaFN5bnRoZXNpc0Jvb2ttYXJrRXZlbnRBcmdzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU3BlZWNoU3ludGhlc2lzQm91bmRhcnlUeXBlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU3BlZWNoU3ludGhlc2lzRXZlbnRBcmdzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU3BlZWNoU3ludGhlc2lzUmVzdWx0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU3BlZWNoU3ludGhlc2lzVmlzZW1lRXZlbnRBcmdzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU3BlZWNoU3ludGhlc2lzV29yZEJvdW5kYXJ5RXZlbnRBcmdzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU3BlZWNoU3ludGhlc2l6ZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9TcGVlY2hUcmFuc2xhdGlvbkNvbmZpZy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1N5bnRoZXNpc1Jlc3VsdC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1N5bnRoZXNpc1ZvaWNlc1Jlc3VsdC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1RyYW5zY3JpcHRpb24vQ29udmVyc2F0aW9uLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVHJhbnNjcmlwdGlvbi9Db252ZXJzYXRpb25Db21tb24uanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9UcmFuc2NyaXB0aW9uL0NvbnZlcnNhdGlvbkV4cGlyYXRpb25FdmVudEFyZ3MuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9UcmFuc2NyaXB0aW9uL0NvbnZlcnNhdGlvblBhcnRpY2lwYW50c0NoYW5nZWRFdmVudEFyZ3MuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9UcmFuc2NyaXB0aW9uL0NvbnZlcnNhdGlvblRyYW5zY3JpYmVyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVHJhbnNjcmlwdGlvbi9Db252ZXJzYXRpb25UcmFuc2xhdGlvbkNhbmNlbGVkRXZlbnRBcmdzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVHJhbnNjcmlwdGlvbi9Db252ZXJzYXRpb25UcmFuc2xhdGlvbkV2ZW50QXJncy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1RyYW5zY3JpcHRpb24vQ29udmVyc2F0aW9uVHJhbnNsYXRpb25SZXN1bHQuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9UcmFuc2NyaXB0aW9uL0NvbnZlcnNhdGlvblRyYW5zbGF0b3IuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9UcmFuc2NyaXB0aW9uL0lQYXJ0aWNpcGFudC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1RyYW5zY3JpcHRpb24vUGFydGljaXBhbnRDaGFuZ2VkUmVhc29uLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVHJhbnNsYXRpb25SZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVHJhbnNsYXRpb25SZWNvZ25pdGlvbkV2ZW50QXJncy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1RyYW5zbGF0aW9uUmVjb2duaXRpb25SZXN1bHQuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9UcmFuc2xhdGlvblJlY29nbml6ZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9UcmFuc2xhdGlvblN5bnRoZXNpc0V2ZW50QXJncy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1RyYW5zbGF0aW9uU3ludGhlc2lzUmVzdWx0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVHJhbnNsYXRpb25zLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVHVyblN0YXR1c1JlY2VpdmVkRXZlbnRBcmdzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVm9pY2VJbmZvLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVm9pY2VQcm9maWxlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVm9pY2VQcm9maWxlQ2xpZW50LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVm9pY2VQcm9maWxlRW5yb2xsbWVudFJlc3VsdC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1ZvaWNlUHJvZmlsZVBocmFzZVJlc3VsdC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1ZvaWNlUHJvZmlsZVJlc3VsdC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1ZvaWNlUHJvZmlsZVR5cGUuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9zcmMvT3B0aW9ucy9tb2RlbHMudHMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9zcmMvT3B0aW9ucy91dGlsLnRzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vc3JjL2JhY2tncm91bmQudHMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9zcmMvdXRpbC50cyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91bnNwbGFzaC1qcy9kaXN0L3Vuc3BsYXNoLWpzLmVzbS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvY29tbW9uanMtYnJvd3Nlci9pbmRleC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvY29tbW9uanMtYnJvd3Nlci9tZDUuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2NvbW1vbmpzLWJyb3dzZXIvbmF0aXZlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9jb21tb25qcy1icm93c2VyL25pbC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvY29tbW9uanMtYnJvd3Nlci9wYXJzZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvY29tbW9uanMtYnJvd3Nlci9yZWdleC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvY29tbW9uanMtYnJvd3Nlci9ybmcuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2NvbW1vbmpzLWJyb3dzZXIvc2hhMS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvY29tbW9uanMtYnJvd3Nlci9zdHJpbmdpZnkuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2NvbW1vbmpzLWJyb3dzZXIvdjEuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2NvbW1vbmpzLWJyb3dzZXIvdjMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2NvbW1vbmpzLWJyb3dzZXIvdjM1LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9jb21tb25qcy1icm93c2VyL3Y0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9jb21tb25qcy1icm93c2VyL3Y1LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9jb21tb25qcy1icm93c2VyL3ZhbGlkYXRlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9jb21tb25qcy1icm93c2VyL3ZlcnNpb24uanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL25hdGl2ZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvcmVnZXguanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3JuZy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvc3RyaW5naWZ5LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92NC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvdmFsaWRhdGUuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvd2ViZXh0ZW5zaW9uLXBvbHlmaWxsL2Rpc3QvYnJvd3Nlci1wb2x5ZmlsbC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci9pZ25vcmVkfC9Vc2Vycy9qaWFuZ3ppbG9uZy/lrabkuaAvbWlucGcvTGVhcm5pbmctRW5nbGlzaC9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5icm93c2VyfGFnZW50LWJhc2UiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvaWdub3JlZHwvVXNlcnMvamlhbmd6aWxvbmcv5a2m5LmgL21pbnBnL0xlYXJuaW5nLUVuZ2xpc2gvbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uYnJvd3NlcnxmcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci9pZ25vcmVkfC9Vc2Vycy9qaWFuZ3ppbG9uZy/lrabkuaAvbWlucGcvTGVhcm5pbmctRW5nbGlzaC9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5icm93c2VyfGh0dHBzLXByb3h5LWFnZW50Iiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyL2lnbm9yZWR8L1VzZXJzL2ppYW5nemlsb25nL+WtpuS5oC9taW5wZy9MZWFybmluZy1FbmdsaXNoL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLmJyb3dzZXJ8bmV0Iiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyL2lnbm9yZWR8L1VzZXJzL2ppYW5nemlsb25nL+WtpuS5oC9taW5wZy9MZWFybmluZy1FbmdsaXNoL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLmJyb3dzZXJ8dGxzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyL2lnbm9yZWR8L1VzZXJzL2ppYW5nemlsb25nL+WtpuS5oC9taW5wZy9MZWFybmluZy1FbmdsaXNoL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLmJyb3dzZXJ8d3MiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvaWdub3JlZHwvVXNlcnMvamlhbmd6aWxvbmcv5a2m5LmgL21pbnBnL0xlYXJuaW5nLUVuZ2xpc2gvbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQXVkaW98ZnMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvd2VicGFjay9ydW50aW1lL2NvbXBhdCBnZXQgZGVmYXVsdCBleHBvcnQiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci93ZWJwYWNrL2JlZm9yZS1zdGFydHVwIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyL3dlYnBhY2svc3RhcnR1cCIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci93ZWJwYWNrL2FmdGVyLXN0YXJ0dXAiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnXG4vKiBnbG9iYWwgZmV0Y2gsIGJ0b2EsIEhlYWRlcnMgKi9cbmNvbnN0IGNvcmUgPSByZXF1aXJlKCcuL2NvcmUnKVxuXG5jbGFzcyBTdGF0dXNFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IgKHJlcywgLi4ucGFyYW1zKSB7XG4gICAgc3VwZXIoLi4ucGFyYW1zKVxuXG4gICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCBTdGF0dXNFcnJvcilcbiAgICB9XG5cbiAgICB0aGlzLm5hbWUgPSAnU3RhdHVzRXJyb3InXG4gICAgdGhpcy5tZXNzYWdlID0gcmVzLnN0YXR1c01lc3NhZ2VcbiAgICB0aGlzLnN0YXR1c0NvZGUgPSByZXMuc3RhdHVzXG4gICAgdGhpcy5yZXMgPSByZXNcbiAgICB0aGlzLmpzb24gPSByZXMuanNvbi5iaW5kKHJlcylcbiAgICB0aGlzLnRleHQgPSByZXMudGV4dC5iaW5kKHJlcylcbiAgICB0aGlzLmFycmF5QnVmZmVyID0gcmVzLmFycmF5QnVmZmVyLmJpbmQocmVzKVxuICAgIGxldCBidWZmZXJcbiAgICBjb25zdCBnZXQgPSAoKSA9PiB7XG4gICAgICBpZiAoIWJ1ZmZlcikgYnVmZmVyID0gdGhpcy5hcnJheUJ1ZmZlcigpXG4gICAgICByZXR1cm4gYnVmZmVyXG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAncmVzcG9uc2VCb2R5JywgeyBnZXQgfSlcbiAgICAvLyBtYXRjaCBOb2RlLmpzIGhlYWRlcnMgb2JqZWN0XG4gICAgdGhpcy5oZWFkZXJzID0ge31cbiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiByZXMuaGVhZGVycy5lbnRyaWVzKCkpIHtcbiAgICAgIHRoaXMuaGVhZGVyc1trZXkudG9Mb3dlckNhc2UoKV0gPSB2YWx1ZVxuICAgIH1cbiAgfVxufVxuXG5jb25zdCBta3JlcXVlc3QgPSAoc3RhdHVzQ29kZXMsIG1ldGhvZCwgZW5jb2RpbmcsIGhlYWRlcnMsIGJhc2V1cmwpID0+IGFzeW5jIChfdXJsLCBib2R5LCBfaGVhZGVycyA9IHt9KSA9PiB7XG4gIF91cmwgPSBiYXNldXJsICsgKF91cmwgfHwgJycpXG4gIGxldCBwYXJzZWQgPSBuZXcgVVJMKF91cmwpXG5cbiAgaWYgKCFoZWFkZXJzKSBoZWFkZXJzID0ge31cbiAgaWYgKHBhcnNlZC51c2VybmFtZSkge1xuICAgIGhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCYXNpYyAnICsgYnRvYShwYXJzZWQudXNlcm5hbWUgKyAnOicgKyBwYXJzZWQucGFzc3dvcmQpXG4gICAgcGFyc2VkID0gbmV3IFVSTChwYXJzZWQucHJvdG9jb2wgKyAnLy8nICsgcGFyc2VkLmhvc3QgKyBwYXJzZWQucGF0aG5hbWUgKyBwYXJzZWQuc2VhcmNoKVxuICB9XG4gIGlmIChwYXJzZWQucHJvdG9jb2wgIT09ICdodHRwczonICYmIHBhcnNlZC5wcm90b2NvbCAhPT0gJ2h0dHA6Jykge1xuICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBwcm90b2NvbCwgJHtwYXJzZWQucHJvdG9jb2x9YClcbiAgfVxuXG4gIGlmIChib2R5KSB7XG4gICAgaWYgKGJvZHkgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlciB8fFxuICAgICAgQXJyYXlCdWZmZXIuaXNWaWV3KGJvZHkpIHx8XG4gICAgICB0eXBlb2YgYm9keSA9PT0gJ3N0cmluZydcbiAgICApIHtcbiAgICAgIC8vIG5vb3BcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBib2R5ID09PSAnb2JqZWN0Jykge1xuICAgICAgYm9keSA9IEpTT04uc3RyaW5naWZ5KGJvZHkpXG4gICAgICBoZWFkZXJzWydDb250ZW50LVR5cGUnXSA9ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vua25vd24gYm9keSB0eXBlLicpXG4gICAgfVxuICB9XG5cbiAgX2hlYWRlcnMgPSBuZXcgSGVhZGVycyh7IC4uLihoZWFkZXJzIHx8IHt9KSwgLi4uX2hlYWRlcnMgfSlcblxuICBjb25zdCByZXNwID0gYXdhaXQgZmV0Y2gocGFyc2VkLCB7IG1ldGhvZCwgaGVhZGVyczogX2hlYWRlcnMsIGJvZHkgfSlcbiAgcmVzcC5zdGF0dXNDb2RlID0gcmVzcC5zdGF0dXNcblxuICBpZiAoIXN0YXR1c0NvZGVzLmhhcyhyZXNwLnN0YXR1cykpIHtcbiAgICB0aHJvdyBuZXcgU3RhdHVzRXJyb3IocmVzcClcbiAgfVxuXG4gIGlmIChlbmNvZGluZyA9PT0gJ2pzb24nKSByZXR1cm4gcmVzcC5qc29uKClcbiAgZWxzZSBpZiAoZW5jb2RpbmcgPT09ICdidWZmZXInKSByZXR1cm4gcmVzcC5hcnJheUJ1ZmZlcigpXG4gIGVsc2UgaWYgKGVuY29kaW5nID09PSAnc3RyaW5nJykgcmV0dXJuIHJlc3AudGV4dCgpXG4gIGVsc2UgcmV0dXJuIHJlc3Bcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBjb3JlKG1rcmVxdWVzdClcbiIsIid1c2Ugc3RyaWN0J1xuY29uc3QgZW5jb2RpbmdzID0gbmV3IFNldChbJ2pzb24nLCAnYnVmZmVyJywgJ3N0cmluZyddKVxuXG5tb2R1bGUuZXhwb3J0cyA9IG1rcmVxdWVzdCA9PiAoLi4uYXJncykgPT4ge1xuICBjb25zdCBzdGF0dXNDb2RlcyA9IG5ldyBTZXQoKVxuICBsZXQgbWV0aG9kXG4gIGxldCBlbmNvZGluZ1xuICBsZXQgaGVhZGVyc1xuICBsZXQgYmFzZXVybCA9ICcnXG5cbiAgYXJncy5mb3JFYWNoKGFyZyA9PiB7XG4gICAgaWYgKHR5cGVvZiBhcmcgPT09ICdzdHJpbmcnKSB7XG4gICAgICBpZiAoYXJnLnRvVXBwZXJDYXNlKCkgPT09IGFyZykge1xuICAgICAgICBpZiAobWV0aG9kKSB7XG4gICAgICAgICAgY29uc3QgbXNnID0gYENhbid0IHNldCBtZXRob2QgdG8gJHthcmd9LCBhbHJlYWR5IHNldCB0byAke21ldGhvZH0uYFxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihtc2cpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbWV0aG9kID0gYXJnXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoYXJnLnN0YXJ0c1dpdGgoJ2h0dHA6JykgfHwgYXJnLnN0YXJ0c1dpdGgoJ2h0dHBzOicpKSB7XG4gICAgICAgIGJhc2V1cmwgPSBhcmdcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChlbmNvZGluZ3MuaGFzKGFyZykpIHtcbiAgICAgICAgICBlbmNvZGluZyA9IGFyZ1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBlbmNvZGluZywgJHthcmd9YClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodHlwZW9mIGFyZyA9PT0gJ251bWJlcicpIHtcbiAgICAgIHN0YXR1c0NvZGVzLmFkZChhcmcpXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgYXJnID09PSAnb2JqZWN0Jykge1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYXJnKSB8fCBhcmcgaW5zdGFuY2VvZiBTZXQpIHtcbiAgICAgICAgYXJnLmZvckVhY2goY29kZSA9PiBzdGF0dXNDb2Rlcy5hZGQoY29kZSkpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoaGVhZGVycykge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IHNldCBoZWFkZXJzIHR3aWNlLicpXG4gICAgICAgIH1cbiAgICAgICAgaGVhZGVycyA9IGFyZ1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gdHlwZTogJHt0eXBlb2YgYXJnfWApXG4gICAgfVxuICB9KVxuXG4gIGlmICghbWV0aG9kKSBtZXRob2QgPSAnR0VUJ1xuICBpZiAoc3RhdHVzQ29kZXMuc2l6ZSA9PT0gMCkge1xuICAgIHN0YXR1c0NvZGVzLmFkZCgyMDApXG4gIH1cblxuICByZXR1cm4gbWtyZXF1ZXN0KHN0YXR1c0NvZGVzLCBtZXRob2QsIGVuY29kaW5nLCBoZWFkZXJzLCBiYXNldXJsKVxufVxuIiwiLyohXG4gKiBjb250ZW50LXR5cGVcbiAqIENvcHlyaWdodChjKSAyMDE1IERvdWdsYXMgQ2hyaXN0b3BoZXIgV2lsc29uXG4gKiBNSVQgTGljZW5zZWRcbiAqL1xuXG4ndXNlIHN0cmljdCdcblxuLyoqXG4gKiBSZWdFeHAgdG8gbWF0Y2ggKiggXCI7XCIgcGFyYW1ldGVyICkgaW4gUkZDIDcyMzEgc2VjIDMuMS4xLjFcbiAqXG4gKiBwYXJhbWV0ZXIgICAgID0gdG9rZW4gXCI9XCIgKCB0b2tlbiAvIHF1b3RlZC1zdHJpbmcgKVxuICogdG9rZW4gICAgICAgICA9IDEqdGNoYXJcbiAqIHRjaGFyICAgICAgICAgPSBcIiFcIiAvIFwiI1wiIC8gXCIkXCIgLyBcIiVcIiAvIFwiJlwiIC8gXCInXCIgLyBcIipcIlxuICogICAgICAgICAgICAgICAvIFwiK1wiIC8gXCItXCIgLyBcIi5cIiAvIFwiXlwiIC8gXCJfXCIgLyBcImBcIiAvIFwifFwiIC8gXCJ+XCJcbiAqICAgICAgICAgICAgICAgLyBESUdJVCAvIEFMUEhBXG4gKiAgICAgICAgICAgICAgIDsgYW55IFZDSEFSLCBleGNlcHQgZGVsaW1pdGVyc1xuICogcXVvdGVkLXN0cmluZyA9IERRVU9URSAqKCBxZHRleHQgLyBxdW90ZWQtcGFpciApIERRVU9URVxuICogcWR0ZXh0ICAgICAgICA9IEhUQUIgLyBTUCAvICV4MjEgLyAleDIzLTVCIC8gJXg1RC03RSAvIG9icy10ZXh0XG4gKiBvYnMtdGV4dCAgICAgID0gJXg4MC1GRlxuICogcXVvdGVkLXBhaXIgICA9IFwiXFxcIiAoIEhUQUIgLyBTUCAvIFZDSEFSIC8gb2JzLXRleHQgKVxuICovXG52YXIgUEFSQU1fUkVHRVhQID0gLzsgKihbISMkJSYnKisuXl9gfH4wLTlBLVphLXotXSspICo9ICooXCIoPzpbXFx1MDAwYlxcdTAwMjBcXHUwMDIxXFx1MDAyMy1cXHUwMDViXFx1MDA1ZC1cXHUwMDdlXFx1MDA4MC1cXHUwMGZmXXxcXFxcW1xcdTAwMGJcXHUwMDIwLVxcdTAwZmZdKSpcInxbISMkJSYnKisuXl9gfH4wLTlBLVphLXotXSspICovZyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnRyb2wtcmVnZXhcbnZhciBURVhUX1JFR0VYUCA9IC9eW1xcdTAwMGJcXHUwMDIwLVxcdTAwN2VcXHUwMDgwLVxcdTAwZmZdKyQvIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29udHJvbC1yZWdleFxudmFyIFRPS0VOX1JFR0VYUCA9IC9eWyEjJCUmJyorLl5fYHx+MC05QS1aYS16LV0rJC9cblxuLyoqXG4gKiBSZWdFeHAgdG8gbWF0Y2ggcXVvdGVkLXBhaXIgaW4gUkZDIDcyMzAgc2VjIDMuMi42XG4gKlxuICogcXVvdGVkLXBhaXIgPSBcIlxcXCIgKCBIVEFCIC8gU1AgLyBWQ0hBUiAvIG9icy10ZXh0IClcbiAqIG9icy10ZXh0ICAgID0gJXg4MC1GRlxuICovXG52YXIgUUVTQ19SRUdFWFAgPSAvXFxcXChbXFx1MDAwYlxcdTAwMjAtXFx1MDBmZl0pL2cgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb250cm9sLXJlZ2V4XG5cbi8qKlxuICogUmVnRXhwIHRvIG1hdGNoIGNoYXJzIHRoYXQgbXVzdCBiZSBxdW90ZWQtcGFpciBpbiBSRkMgNzIzMCBzZWMgMy4yLjZcbiAqL1xudmFyIFFVT1RFX1JFR0VYUCA9IC8oW1xcXFxcIl0pL2dcblxuLyoqXG4gKiBSZWdFeHAgdG8gbWF0Y2ggdHlwZSBpbiBSRkMgNzIzMSBzZWMgMy4xLjEuMVxuICpcbiAqIG1lZGlhLXR5cGUgPSB0eXBlIFwiL1wiIHN1YnR5cGVcbiAqIHR5cGUgICAgICAgPSB0b2tlblxuICogc3VidHlwZSAgICA9IHRva2VuXG4gKi9cbnZhciBUWVBFX1JFR0VYUCA9IC9eWyEjJCUmJyorLl5fYHx+MC05QS1aYS16LV0rXFwvWyEjJCUmJyorLl5fYHx+MC05QS1aYS16LV0rJC9cblxuLyoqXG4gKiBNb2R1bGUgZXhwb3J0cy5cbiAqIEBwdWJsaWNcbiAqL1xuXG5leHBvcnRzLmZvcm1hdCA9IGZvcm1hdFxuZXhwb3J0cy5wYXJzZSA9IHBhcnNlXG5cbi8qKlxuICogRm9ybWF0IG9iamVjdCB0byBtZWRpYSB0eXBlLlxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBvYmpcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqIEBwdWJsaWNcbiAqL1xuXG5mdW5jdGlvbiBmb3JtYXQgKG9iaikge1xuICBpZiAoIW9iaiB8fCB0eXBlb2Ygb2JqICE9PSAnb2JqZWN0Jykge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2FyZ3VtZW50IG9iaiBpcyByZXF1aXJlZCcpXG4gIH1cblxuICB2YXIgcGFyYW1ldGVycyA9IG9iai5wYXJhbWV0ZXJzXG4gIHZhciB0eXBlID0gb2JqLnR5cGVcblxuICBpZiAoIXR5cGUgfHwgIVRZUEVfUkVHRVhQLnRlc3QodHlwZSkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdpbnZhbGlkIHR5cGUnKVxuICB9XG5cbiAgdmFyIHN0cmluZyA9IHR5cGVcblxuICAvLyBhcHBlbmQgcGFyYW1ldGVyc1xuICBpZiAocGFyYW1ldGVycyAmJiB0eXBlb2YgcGFyYW1ldGVycyA9PT0gJ29iamVjdCcpIHtcbiAgICB2YXIgcGFyYW1cbiAgICB2YXIgcGFyYW1zID0gT2JqZWN0LmtleXMocGFyYW1ldGVycykuc29ydCgpXG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcmFtcy5sZW5ndGg7IGkrKykge1xuICAgICAgcGFyYW0gPSBwYXJhbXNbaV1cblxuICAgICAgaWYgKCFUT0tFTl9SRUdFWFAudGVzdChwYXJhbSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignaW52YWxpZCBwYXJhbWV0ZXIgbmFtZScpXG4gICAgICB9XG5cbiAgICAgIHN0cmluZyArPSAnOyAnICsgcGFyYW0gKyAnPScgKyBxc3RyaW5nKHBhcmFtZXRlcnNbcGFyYW1dKVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBzdHJpbmdcbn1cblxuLyoqXG4gKiBQYXJzZSBtZWRpYSB0eXBlIHRvIG9iamVjdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ3xvYmplY3R9IHN0cmluZ1xuICogQHJldHVybiB7T2JqZWN0fVxuICogQHB1YmxpY1xuICovXG5cbmZ1bmN0aW9uIHBhcnNlIChzdHJpbmcpIHtcbiAgaWYgKCFzdHJpbmcpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdhcmd1bWVudCBzdHJpbmcgaXMgcmVxdWlyZWQnKVxuICB9XG5cbiAgLy8gc3VwcG9ydCByZXEvcmVzLWxpa2Ugb2JqZWN0cyBhcyBhcmd1bWVudFxuICB2YXIgaGVhZGVyID0gdHlwZW9mIHN0cmluZyA9PT0gJ29iamVjdCdcbiAgICA/IGdldGNvbnRlbnR0eXBlKHN0cmluZylcbiAgICA6IHN0cmluZ1xuXG4gIGlmICh0eXBlb2YgaGVhZGVyICE9PSAnc3RyaW5nJykge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2FyZ3VtZW50IHN0cmluZyBpcyByZXF1aXJlZCB0byBiZSBhIHN0cmluZycpXG4gIH1cblxuICB2YXIgaW5kZXggPSBoZWFkZXIuaW5kZXhPZignOycpXG4gIHZhciB0eXBlID0gaW5kZXggIT09IC0xXG4gICAgPyBoZWFkZXIuc2xpY2UoMCwgaW5kZXgpLnRyaW0oKVxuICAgIDogaGVhZGVyLnRyaW0oKVxuXG4gIGlmICghVFlQRV9SRUdFWFAudGVzdCh0eXBlKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2ludmFsaWQgbWVkaWEgdHlwZScpXG4gIH1cblxuICB2YXIgb2JqID0gbmV3IENvbnRlbnRUeXBlKHR5cGUudG9Mb3dlckNhc2UoKSlcblxuICAvLyBwYXJzZSBwYXJhbWV0ZXJzXG4gIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICB2YXIga2V5XG4gICAgdmFyIG1hdGNoXG4gICAgdmFyIHZhbHVlXG5cbiAgICBQQVJBTV9SRUdFWFAubGFzdEluZGV4ID0gaW5kZXhcblxuICAgIHdoaWxlICgobWF0Y2ggPSBQQVJBTV9SRUdFWFAuZXhlYyhoZWFkZXIpKSkge1xuICAgICAgaWYgKG1hdGNoLmluZGV4ICE9PSBpbmRleCkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdpbnZhbGlkIHBhcmFtZXRlciBmb3JtYXQnKVxuICAgICAgfVxuXG4gICAgICBpbmRleCArPSBtYXRjaFswXS5sZW5ndGhcbiAgICAgIGtleSA9IG1hdGNoWzFdLnRvTG93ZXJDYXNlKClcbiAgICAgIHZhbHVlID0gbWF0Y2hbMl1cblxuICAgICAgaWYgKHZhbHVlLmNoYXJDb2RlQXQoMCkgPT09IDB4MjIgLyogXCIgKi8pIHtcbiAgICAgICAgLy8gcmVtb3ZlIHF1b3Rlc1xuICAgICAgICB2YWx1ZSA9IHZhbHVlLnNsaWNlKDEsIC0xKVxuXG4gICAgICAgIC8vIHJlbW92ZSBlc2NhcGVzXG4gICAgICAgIGlmICh2YWx1ZS5pbmRleE9mKCdcXFxcJykgIT09IC0xKSB7XG4gICAgICAgICAgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKFFFU0NfUkVHRVhQLCAnJDEnKVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIG9iai5wYXJhbWV0ZXJzW2tleV0gPSB2YWx1ZVxuICAgIH1cblxuICAgIGlmIChpbmRleCAhPT0gaGVhZGVyLmxlbmd0aCkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignaW52YWxpZCBwYXJhbWV0ZXIgZm9ybWF0JylcbiAgICB9XG4gIH1cblxuICByZXR1cm4gb2JqXG59XG5cbi8qKlxuICogR2V0IGNvbnRlbnQtdHlwZSBmcm9tIHJlcS9yZXMgb2JqZWN0cy5cbiAqXG4gKiBAcGFyYW0ge29iamVjdH1cbiAqIEByZXR1cm4ge09iamVjdH1cbiAqIEBwcml2YXRlXG4gKi9cblxuZnVuY3Rpb24gZ2V0Y29udGVudHR5cGUgKG9iaikge1xuICB2YXIgaGVhZGVyXG5cbiAgaWYgKHR5cGVvZiBvYmouZ2V0SGVhZGVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgLy8gcmVzLWxpa2VcbiAgICBoZWFkZXIgPSBvYmouZ2V0SGVhZGVyKCdjb250ZW50LXR5cGUnKVxuICB9IGVsc2UgaWYgKHR5cGVvZiBvYmouaGVhZGVycyA9PT0gJ29iamVjdCcpIHtcbiAgICAvLyByZXEtbGlrZVxuICAgIGhlYWRlciA9IG9iai5oZWFkZXJzICYmIG9iai5oZWFkZXJzWydjb250ZW50LXR5cGUnXVxuICB9XG5cbiAgaWYgKHR5cGVvZiBoZWFkZXIgIT09ICdzdHJpbmcnKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignY29udGVudC10eXBlIGhlYWRlciBpcyBtaXNzaW5nIGZyb20gb2JqZWN0JylcbiAgfVxuXG4gIHJldHVybiBoZWFkZXJcbn1cblxuLyoqXG4gKiBRdW90ZSBhIHN0cmluZyBpZiBuZWNlc3NhcnkuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHZhbFxuICogQHJldHVybiB7c3RyaW5nfVxuICogQHByaXZhdGVcbiAqL1xuXG5mdW5jdGlvbiBxc3RyaW5nICh2YWwpIHtcbiAgdmFyIHN0ciA9IFN0cmluZyh2YWwpXG5cbiAgLy8gbm8gbmVlZCB0byBxdW90ZSB0b2tlbnNcbiAgaWYgKFRPS0VOX1JFR0VYUC50ZXN0KHN0cikpIHtcbiAgICByZXR1cm4gc3RyXG4gIH1cblxuICBpZiAoc3RyLmxlbmd0aCA+IDAgJiYgIVRFWFRfUkVHRVhQLnRlc3Qoc3RyKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2ludmFsaWQgcGFyYW1ldGVyIHZhbHVlJylcbiAgfVxuXG4gIHJldHVybiAnXCInICsgc3RyLnJlcGxhY2UoUVVPVEVfUkVHRVhQLCAnXFxcXCQxJykgKyAnXCInXG59XG5cbi8qKlxuICogQ2xhc3MgdG8gcmVwcmVzZW50IGEgY29udGVudCB0eXBlLlxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gQ29udGVudFR5cGUgKHR5cGUpIHtcbiAgdGhpcy5wYXJhbWV0ZXJzID0gT2JqZWN0LmNyZWF0ZShudWxsKVxuICB0aGlzLnR5cGUgPSB0eXBlXG59XG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZnVuY3Rpb24gY3JlYXRlUGFyc2VyKG9uUGFyc2UpIHtcbiAgbGV0IGlzRmlyc3RDaHVuaztcbiAgbGV0IGJ1ZmZlcjtcbiAgbGV0IHN0YXJ0aW5nUG9zaXRpb247XG4gIGxldCBzdGFydGluZ0ZpZWxkTGVuZ3RoO1xuICBsZXQgZXZlbnRJZDtcbiAgbGV0IGV2ZW50TmFtZTtcbiAgbGV0IGRhdGE7XG4gIHJlc2V0KCk7XG4gIHJldHVybiB7XG4gICAgZmVlZCxcbiAgICByZXNldFxuICB9O1xuICBmdW5jdGlvbiByZXNldCgpIHtcbiAgICBpc0ZpcnN0Q2h1bmsgPSB0cnVlO1xuICAgIGJ1ZmZlciA9IFwiXCI7XG4gICAgc3RhcnRpbmdQb3NpdGlvbiA9IDA7XG4gICAgc3RhcnRpbmdGaWVsZExlbmd0aCA9IC0xO1xuICAgIGV2ZW50SWQgPSB2b2lkIDA7XG4gICAgZXZlbnROYW1lID0gdm9pZCAwO1xuICAgIGRhdGEgPSBcIlwiO1xuICB9XG4gIGZ1bmN0aW9uIGZlZWQoY2h1bmspIHtcbiAgICBidWZmZXIgPSBidWZmZXIgPyBidWZmZXIgKyBjaHVuayA6IGNodW5rO1xuICAgIGlmIChpc0ZpcnN0Q2h1bmsgJiYgaGFzQm9tKGJ1ZmZlcikpIHtcbiAgICAgIGJ1ZmZlciA9IGJ1ZmZlci5zbGljZShCT00ubGVuZ3RoKTtcbiAgICB9XG4gICAgaXNGaXJzdENodW5rID0gZmFsc2U7XG4gICAgY29uc3QgbGVuZ3RoID0gYnVmZmVyLmxlbmd0aDtcbiAgICBsZXQgcG9zaXRpb24gPSAwO1xuICAgIGxldCBkaXNjYXJkVHJhaWxpbmdOZXdsaW5lID0gZmFsc2U7XG4gICAgd2hpbGUgKHBvc2l0aW9uIDwgbGVuZ3RoKSB7XG4gICAgICBpZiAoZGlzY2FyZFRyYWlsaW5nTmV3bGluZSkge1xuICAgICAgICBpZiAoYnVmZmVyW3Bvc2l0aW9uXSA9PT0gXCJcXG5cIikge1xuICAgICAgICAgICsrcG9zaXRpb247XG4gICAgICAgIH1cbiAgICAgICAgZGlzY2FyZFRyYWlsaW5nTmV3bGluZSA9IGZhbHNlO1xuICAgICAgfVxuICAgICAgbGV0IGxpbmVMZW5ndGggPSAtMTtcbiAgICAgIGxldCBmaWVsZExlbmd0aCA9IHN0YXJ0aW5nRmllbGRMZW5ndGg7XG4gICAgICBsZXQgY2hhcmFjdGVyO1xuICAgICAgZm9yIChsZXQgaW5kZXggPSBzdGFydGluZ1Bvc2l0aW9uOyBsaW5lTGVuZ3RoIDwgMCAmJiBpbmRleCA8IGxlbmd0aDsgKytpbmRleCkge1xuICAgICAgICBjaGFyYWN0ZXIgPSBidWZmZXJbaW5kZXhdO1xuICAgICAgICBpZiAoY2hhcmFjdGVyID09PSBcIjpcIiAmJiBmaWVsZExlbmd0aCA8IDApIHtcbiAgICAgICAgICBmaWVsZExlbmd0aCA9IGluZGV4IC0gcG9zaXRpb247XG4gICAgICAgIH0gZWxzZSBpZiAoY2hhcmFjdGVyID09PSBcIlxcclwiKSB7XG4gICAgICAgICAgZGlzY2FyZFRyYWlsaW5nTmV3bGluZSA9IHRydWU7XG4gICAgICAgICAgbGluZUxlbmd0aCA9IGluZGV4IC0gcG9zaXRpb247XG4gICAgICAgIH0gZWxzZSBpZiAoY2hhcmFjdGVyID09PSBcIlxcblwiKSB7XG4gICAgICAgICAgbGluZUxlbmd0aCA9IGluZGV4IC0gcG9zaXRpb247XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChsaW5lTGVuZ3RoIDwgMCkge1xuICAgICAgICBzdGFydGluZ1Bvc2l0aW9uID0gbGVuZ3RoIC0gcG9zaXRpb247XG4gICAgICAgIHN0YXJ0aW5nRmllbGRMZW5ndGggPSBmaWVsZExlbmd0aDtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzdGFydGluZ1Bvc2l0aW9uID0gMDtcbiAgICAgICAgc3RhcnRpbmdGaWVsZExlbmd0aCA9IC0xO1xuICAgICAgfVxuICAgICAgcGFyc2VFdmVudFN0cmVhbUxpbmUoYnVmZmVyLCBwb3NpdGlvbiwgZmllbGRMZW5ndGgsIGxpbmVMZW5ndGgpO1xuICAgICAgcG9zaXRpb24gKz0gbGluZUxlbmd0aCArIDE7XG4gICAgfVxuICAgIGlmIChwb3NpdGlvbiA9PT0gbGVuZ3RoKSB7XG4gICAgICBidWZmZXIgPSBcIlwiO1xuICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPiAwKSB7XG4gICAgICBidWZmZXIgPSBidWZmZXIuc2xpY2UocG9zaXRpb24pO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBwYXJzZUV2ZW50U3RyZWFtTGluZShsaW5lQnVmZmVyLCBpbmRleCwgZmllbGRMZW5ndGgsIGxpbmVMZW5ndGgpIHtcbiAgICBpZiAobGluZUxlbmd0aCA9PT0gMCkge1xuICAgICAgaWYgKGRhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICBvblBhcnNlKHtcbiAgICAgICAgICB0eXBlOiBcImV2ZW50XCIsXG4gICAgICAgICAgaWQ6IGV2ZW50SWQsXG4gICAgICAgICAgZXZlbnQ6IGV2ZW50TmFtZSB8fCB2b2lkIDAsXG4gICAgICAgICAgZGF0YTogZGF0YS5zbGljZSgwLCAtMSlcbiAgICAgICAgICAvLyByZW1vdmUgdHJhaWxpbmcgbmV3bGluZVxuICAgICAgICB9KTtcblxuICAgICAgICBkYXRhID0gXCJcIjtcbiAgICAgICAgZXZlbnRJZCA9IHZvaWQgMDtcbiAgICAgIH1cbiAgICAgIGV2ZW50TmFtZSA9IHZvaWQgMDtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3Qgbm9WYWx1ZSA9IGZpZWxkTGVuZ3RoIDwgMDtcbiAgICBjb25zdCBmaWVsZCA9IGxpbmVCdWZmZXIuc2xpY2UoaW5kZXgsIGluZGV4ICsgKG5vVmFsdWUgPyBsaW5lTGVuZ3RoIDogZmllbGRMZW5ndGgpKTtcbiAgICBsZXQgc3RlcCA9IDA7XG4gICAgaWYgKG5vVmFsdWUpIHtcbiAgICAgIHN0ZXAgPSBsaW5lTGVuZ3RoO1xuICAgIH0gZWxzZSBpZiAobGluZUJ1ZmZlcltpbmRleCArIGZpZWxkTGVuZ3RoICsgMV0gPT09IFwiIFwiKSB7XG4gICAgICBzdGVwID0gZmllbGRMZW5ndGggKyAyO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdGVwID0gZmllbGRMZW5ndGggKyAxO1xuICAgIH1cbiAgICBjb25zdCBwb3NpdGlvbiA9IGluZGV4ICsgc3RlcDtcbiAgICBjb25zdCB2YWx1ZUxlbmd0aCA9IGxpbmVMZW5ndGggLSBzdGVwO1xuICAgIGNvbnN0IHZhbHVlID0gbGluZUJ1ZmZlci5zbGljZShwb3NpdGlvbiwgcG9zaXRpb24gKyB2YWx1ZUxlbmd0aCkudG9TdHJpbmcoKTtcbiAgICBpZiAoZmllbGQgPT09IFwiZGF0YVwiKSB7XG4gICAgICBkYXRhICs9IHZhbHVlID8gXCJcIi5jb25jYXQodmFsdWUsIFwiXFxuXCIpIDogXCJcXG5cIjtcbiAgICB9IGVsc2UgaWYgKGZpZWxkID09PSBcImV2ZW50XCIpIHtcbiAgICAgIGV2ZW50TmFtZSA9IHZhbHVlO1xuICAgIH0gZWxzZSBpZiAoZmllbGQgPT09IFwiaWRcIiAmJiAhdmFsdWUuaW5jbHVkZXMoXCJcXDBcIikpIHtcbiAgICAgIGV2ZW50SWQgPSB2YWx1ZTtcbiAgICB9IGVsc2UgaWYgKGZpZWxkID09PSBcInJldHJ5XCIpIHtcbiAgICAgIGNvbnN0IHJldHJ5ID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICAgIGlmICghTnVtYmVyLmlzTmFOKHJldHJ5KSkge1xuICAgICAgICBvblBhcnNlKHtcbiAgICAgICAgICB0eXBlOiBcInJlY29ubmVjdC1pbnRlcnZhbFwiLFxuICAgICAgICAgIHZhbHVlOiByZXRyeVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbmNvbnN0IEJPTSA9IFsyMzksIDE4NywgMTkxXTtcbmZ1bmN0aW9uIGhhc0JvbShidWZmZXIpIHtcbiAgcmV0dXJuIEJPTS5ldmVyeSgoY2hhckNvZGUsIGluZGV4KSA9PiBidWZmZXIuY2hhckNvZGVBdChpbmRleCkgPT09IGNoYXJDb2RlKTtcbn1cbmV4cG9ydHMuY3JlYXRlUGFyc2VyID0gY3JlYXRlUGFyc2VyO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IENvbnNvbGVMb2dnaW5nTGlzdGVuZXIgfSBmcm9tIFwiLi9zcmMvY29tbW9uLmJyb3dzZXIvRXhwb3J0c1wiO1xuaW1wb3J0IHsgRXZlbnRzIH0gZnJvbSBcIi4vc3JjL2NvbW1vbi9FeHBvcnRzXCI7XG4vLyBDb21tb24uU3RvcmFnZS5TZXRMb2NhbFN0b3JhZ2UobmV3IENvbW1vbi5Ccm93c2VyLkxvY2FsU3RvcmFnZSgpKTtcbi8vIENvbW1vbi5TdG9yYWdlLlNldFNlc3Npb25TdG9yYWdlKG5ldyBDb21tb24uQnJvd3Nlci5TZXNzaW9uU3RvcmFnZSgpKTtcbkV2ZW50cy5pbnN0YW5jZS5hdHRhY2hDb25zb2xlTGlzdGVuZXIobmV3IENvbnNvbGVMb2dnaW5nTGlzdGVuZXIoKSk7XG4vLyBTcGVlY2ggU0RLIEFQSVxuZXhwb3J0ICogZnJvbSBcIi4vc3JjL3Nkay9FeHBvcnRzXCI7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1pY3Jvc29mdC5jb2duaXRpdmVzZXJ2aWNlcy5zcGVlY2guc2RrLmpzLm1hcFxuIiwiLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1hc3NpZ25tZW50ICovXG4vLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCAqIGFzIGZzIGZyb20gXCJmc1wiO1xuaW1wb3J0IHsgTG9nTGV2ZWwgfSBmcm9tIFwiLi4vc2RrL0xvZ0xldmVsXCI7XG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi4vc2RrL0NvbnRyYWN0c1wiO1xuZXhwb3J0IGNsYXNzIENvbnNvbGVMb2dnaW5nTGlzdGVuZXIge1xuICAgIGNvbnN0cnVjdG9yKGxvZ0xldmVsRmlsdGVyID0gTG9nTGV2ZWwuTm9uZSkge1xuICAgICAgICB0aGlzLnByaXZMb2dQYXRoID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnByaXZFbmFibGVDb25zb2xlT3V0cHV0ID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5wcml2TG9nTGV2ZWxGaWx0ZXIgPSBsb2dMZXZlbEZpbHRlcjtcbiAgICB9XG4gICAgc2V0IGxvZ1BhdGgocGF0aCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChmcy5vcGVuU3luYywgXCJcXG5GaWxlIFN5c3RlbSBhY2Nlc3Mgbm90IGF2YWlsYWJsZVwiKTtcbiAgICAgICAgdGhpcy5wcml2TG9nUGF0aCA9IHBhdGg7XG4gICAgfVxuICAgIHNldCBlbmFibGVDb25zb2xlT3V0cHV0KGVuYWJsZU91dHB1dCkge1xuICAgICAgICB0aGlzLnByaXZFbmFibGVDb25zb2xlT3V0cHV0ID0gZW5hYmxlT3V0cHV0O1xuICAgIH1cbiAgICBvbkV2ZW50KGV2ZW50KSB7XG4gICAgICAgIGlmIChldmVudC5ldmVudFR5cGUgPj0gdGhpcy5wcml2TG9nTGV2ZWxGaWx0ZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IGxvZyA9IHRoaXMudG9TdHJpbmcoZXZlbnQpO1xuICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2TG9nUGF0aCkge1xuICAgICAgICAgICAgICAgIGZzLndyaXRlRmlsZVN5bmModGhpcy5wcml2TG9nUGF0aCwgbG9nICsgXCJcXG5cIiwgeyBmbGFnOiBcImErXCIgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2RW5hYmxlQ29uc29sZU91dHB1dCkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoZXZlbnQuZXZlbnRUeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgTG9nTGV2ZWwuRGVidWc6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1Zyhsb2cpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgTG9nTGV2ZWwuSW5mbzpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8obG9nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIExvZ0xldmVsLldhcm5pbmc6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGxvZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBMb2dMZXZlbC5FcnJvcjpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGxvZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhsb2cpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHRvU3RyaW5nKGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IGxvZ0ZyYWdtZW50cyA9IFtcbiAgICAgICAgICAgIGAke2V2ZW50LmV2ZW50VGltZX1gLFxuICAgICAgICAgICAgYCR7ZXZlbnQubmFtZX1gLFxuICAgICAgICBdO1xuICAgICAgICBjb25zdCBlID0gZXZlbnQ7XG4gICAgICAgIGZvciAoY29uc3QgcHJvcCBpbiBlKSB7XG4gICAgICAgICAgICBpZiAocHJvcCAmJiBldmVudC5oYXNPd25Qcm9wZXJ0eShwcm9wKSAmJlxuICAgICAgICAgICAgICAgIHByb3AgIT09IFwiZXZlbnRUaW1lXCIgJiYgcHJvcCAhPT0gXCJldmVudFR5cGVcIiAmJlxuICAgICAgICAgICAgICAgIHByb3AgIT09IFwiZXZlbnRJZFwiICYmIHByb3AgIT09IFwibmFtZVwiICYmXG4gICAgICAgICAgICAgICAgcHJvcCAhPT0gXCJjb25zdHJ1Y3RvclwiKSB7XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtbWVtYmVyLWFjY2Vzc1xuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gZVtwcm9wXTtcbiAgICAgICAgICAgICAgICBsZXQgdmFsdWVUb0xvZyA9IFwiPE5VTEw+XCI7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAodmFsdWUpID09PSBcIm51bWJlclwiIHx8IHR5cGVvZiAodmFsdWUpID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZVRvTG9nID0gdmFsdWUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlVG9Mb2cgPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbG9nRnJhZ21lbnRzLnB1c2goYCR7cHJvcH06ICR7dmFsdWVUb0xvZ31gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbG9nRnJhZ21lbnRzLmpvaW4oXCIgfCBcIik7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db25zb2xlTG9nZ2luZ0xpc3RlbmVyLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCB7IGNvbm5lY3Rpdml0eSwgdHlwZSwgfSBmcm9tIFwiLi4vY29tbW9uLnNwZWVjaC9FeHBvcnRzXCI7XG5pbXBvcnQgeyBBdWRpb1NvdXJjZUVycm9yRXZlbnQsIEF1ZGlvU291cmNlSW5pdGlhbGl6aW5nRXZlbnQsIEF1ZGlvU291cmNlT2ZmRXZlbnQsIEF1ZGlvU291cmNlUmVhZHlFdmVudCwgQXVkaW9TdHJlYW1Ob2RlQXR0YWNoZWRFdmVudCwgQXVkaW9TdHJlYW1Ob2RlQXR0YWNoaW5nRXZlbnQsIEF1ZGlvU3RyZWFtTm9kZURldGFjaGVkRXZlbnQsIEF1ZGlvU3RyZWFtTm9kZUVycm9yRXZlbnQsIENodW5rZWRBcnJheUJ1ZmZlclN0cmVhbSwgY3JlYXRlTm9EYXNoR3VpZCwgRGVmZXJyZWQsIEV2ZW50cywgRXZlbnRTb3VyY2UsIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBBdWRpb1N0cmVhbUZvcm1hdCB9IGZyb20gXCIuLi9zZGsvQXVkaW8vQXVkaW9TdHJlYW1Gb3JtYXRcIjtcbmV4cG9ydCBjbGFzcyBGaWxlQXVkaW9Tb3VyY2Uge1xuICAgIGNvbnN0cnVjdG9yKGZpbGUsIGZpbGVuYW1lLCBhdWRpb1NvdXJjZUlkKSB7XG4gICAgICAgIHRoaXMucHJpdlN0cmVhbXMgPSB7fTtcbiAgICAgICAgdGhpcy5wcml2SGVhZGVyRW5kID0gNDQ7XG4gICAgICAgIHRoaXMucHJpdklkID0gYXVkaW9Tb3VyY2VJZCA/IGF1ZGlvU291cmNlSWQgOiBjcmVhdGVOb0Rhc2hHdWlkKCk7XG4gICAgICAgIHRoaXMucHJpdkV2ZW50cyA9IG5ldyBFdmVudFNvdXJjZSgpO1xuICAgICAgICB0aGlzLnByaXZTb3VyY2UgPSBmaWxlO1xuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB0eXBlb2YgQmxvYiAhPT0gXCJ1bmRlZmluZWRcIiAmJiB0aGlzLnByaXZTb3VyY2UgaW5zdGFuY2VvZiBCbG9iKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZGaWxlbmFtZSA9IGZpbGUubmFtZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkZpbGVuYW1lID0gZmlsZW5hbWUgfHwgXCJ1bmtub3duLndhdlwiO1xuICAgICAgICB9XG4gICAgICAgIC8vIFJlYWQgdGhlIGhlYWRlci5cbiAgICAgICAgdGhpcy5wcml2QXVkaW9Gb3JtYXRQcm9taXNlID0gdGhpcy5yZWFkSGVhZGVyKCk7XG4gICAgfVxuICAgIGdldCBmb3JtYXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb0Zvcm1hdFByb21pc2U7XG4gICAgfVxuICAgIHR1cm5PbigpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdkZpbGVuYW1lLmxhc3RJbmRleE9mKFwiLndhdlwiKSAhPT0gdGhpcy5wcml2RmlsZW5hbWUubGVuZ3RoIC0gNCkge1xuICAgICAgICAgICAgY29uc3QgZXJyb3JNc2cgPSB0aGlzLnByaXZGaWxlbmFtZSArIFwiIGlzIG5vdCBzdXBwb3J0ZWQuIE9ubHkgV0FWRSBmaWxlcyBhcmUgYWxsb3dlZCBhdCB0aGUgbW9tZW50LlwiO1xuICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1NvdXJjZUVycm9yRXZlbnQoZXJyb3JNc2csIFwiXCIpKTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvck1zZyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1NvdXJjZUluaXRpYWxpemluZ0V2ZW50KHRoaXMucHJpdklkKSk7IC8vIG5vIHN0cmVhbSBpZFxuICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU291cmNlUmVhZHlFdmVudCh0aGlzLnByaXZJZCkpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SWQ7XG4gICAgfVxuICAgIGF0dGFjaChhdWRpb05vZGVJZCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1N0cmVhbU5vZGVBdHRhY2hpbmdFdmVudCh0aGlzLnByaXZJZCwgYXVkaW9Ob2RlSWQpKTtcbiAgICAgICAgICAgIGNvbnN0IHN0cmVhbSA9IHlpZWxkIHRoaXMudXBsb2FkKGF1ZGlvTm9kZUlkKTtcbiAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9TdHJlYW1Ob2RlQXR0YWNoZWRFdmVudCh0aGlzLnByaXZJZCwgYXVkaW9Ob2RlSWQpKTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgICAgIGRldGFjaDogKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgICAgICAgICBzdHJlYW0ucmVhZEVuZGVkKCk7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnByaXZTdHJlYW1zW2F1ZGlvTm9kZUlkXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1N0cmVhbU5vZGVEZXRhY2hlZEV2ZW50KHRoaXMucHJpdklkLCBhdWRpb05vZGVJZCkpO1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnR1cm5PZmYoKTtcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBpZDogKCkgPT4gYXVkaW9Ob2RlSWQsXG4gICAgICAgICAgICAgICAgcmVhZDogKCkgPT4gc3RyZWFtLnJlYWQoKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZGV0YWNoKGF1ZGlvTm9kZUlkKSB7XG4gICAgICAgIGlmIChhdWRpb05vZGVJZCAmJiB0aGlzLnByaXZTdHJlYW1zW2F1ZGlvTm9kZUlkXSkge1xuICAgICAgICAgICAgdGhpcy5wcml2U3RyZWFtc1thdWRpb05vZGVJZF0uY2xvc2UoKTtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnByaXZTdHJlYW1zW2F1ZGlvTm9kZUlkXTtcbiAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9TdHJlYW1Ob2RlRGV0YWNoZWRFdmVudCh0aGlzLnByaXZJZCwgYXVkaW9Ob2RlSWQpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0dXJuT2ZmKCkge1xuICAgICAgICBmb3IgKGNvbnN0IHN0cmVhbUlkIGluIHRoaXMucHJpdlN0cmVhbXMpIHtcbiAgICAgICAgICAgIGlmIChzdHJlYW1JZCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMucHJpdlN0cmVhbXNbc3RyZWFtSWRdO1xuICAgICAgICAgICAgICAgIGlmIChzdHJlYW0gJiYgIXN0cmVhbS5pc0Nsb3NlZCkge1xuICAgICAgICAgICAgICAgICAgICBzdHJlYW0uY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1NvdXJjZU9mZkV2ZW50KHRoaXMucHJpdklkKSk7IC8vIG5vIHN0cmVhbSBub3dcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBnZXQgZXZlbnRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXZlbnRzO1xuICAgIH1cbiAgICBnZXQgZGV2aWNlSW5mbygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvRm9ybWF0UHJvbWlzZS50aGVuKChyZXN1bHQpID0+IChQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgYml0c3BlcnNhbXBsZTogcmVzdWx0LmJpdHNQZXJTYW1wbGUsXG4gICAgICAgICAgICBjaGFubmVsY291bnQ6IHJlc3VsdC5jaGFubmVscyxcbiAgICAgICAgICAgIGNvbm5lY3Rpdml0eTogY29ubmVjdGl2aXR5LlVua25vd24sXG4gICAgICAgICAgICBtYW51ZmFjdHVyZXI6IFwiU3BlZWNoIFNES1wiLFxuICAgICAgICAgICAgbW9kZWw6IFwiRmlsZVwiLFxuICAgICAgICAgICAgc2FtcGxlcmF0ZTogcmVzdWx0LnNhbXBsZXNQZXJTZWMsXG4gICAgICAgICAgICB0eXBlOiB0eXBlLkZpbGUsXG4gICAgICAgIH0pKSk7XG4gICAgfVxuICAgIHJlYWRIZWFkZXIoKSB7XG4gICAgICAgIC8vIFJlYWQgdGhlIHdhdmUgaGVhZGVyLlxuICAgICAgICBjb25zdCBtYXhIZWFkZXJTaXplID0gNDI5NjtcbiAgICAgICAgY29uc3QgaGVhZGVyID0gdGhpcy5wcml2U291cmNlLnNsaWNlKDAsIG1heEhlYWRlclNpemUpO1xuICAgICAgICBjb25zdCBoZWFkZXJSZXN1bHQgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgY29uc3QgcHJvY2Vzc0hlYWRlciA9IChoZWFkZXIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBuZXcgRGF0YVZpZXcoaGVhZGVyKTtcbiAgICAgICAgICAgIGNvbnN0IGdldFdvcmQgPSAoaW5kZXgpID0+IFN0cmluZy5mcm9tQ2hhckNvZGUodmlldy5nZXRVaW50OChpbmRleCksIHZpZXcuZ2V0VWludDgoaW5kZXggKyAxKSwgdmlldy5nZXRVaW50OChpbmRleCArIDIpLCB2aWV3LmdldFVpbnQ4KGluZGV4ICsgMykpO1xuICAgICAgICAgICAgLy8gUklGRiA0IGJ5dGVzLlxuICAgICAgICAgICAgaWYgKFwiUklGRlwiICE9PSBnZXRXb3JkKDApKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVyUmVzdWx0LnJlamVjdChcIkludmFsaWQgV0FWIGhlYWRlciBpbiBmaWxlLCBSSUZGIHdhcyBub3QgZm91bmRcIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gbGVuZ3RoLCA0IGJ5dGVzXG4gICAgICAgICAgICAvLyBSSUZGIFR5cGUgJiBmbXQgOCBieXRlc1xuICAgICAgICAgICAgaWYgKFwiV0FWRVwiICE9PSBnZXRXb3JkKDgpIHx8IFwiZm10IFwiICE9PSBnZXRXb3JkKDEyKSkge1xuICAgICAgICAgICAgICAgIGhlYWRlclJlc3VsdC5yZWplY3QoXCJJbnZhbGlkIFdBViBoZWFkZXIgaW4gZmlsZSwgV0FWRWZtdCB3YXMgbm90IGZvdW5kXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGZvcm1hdFNpemUgPSB2aWV3LmdldEludDMyKDE2LCB0cnVlKTtcbiAgICAgICAgICAgIGNvbnN0IGNoYW5uZWxDb3VudCA9IHZpZXcuZ2V0VWludDE2KDIyLCB0cnVlKTtcbiAgICAgICAgICAgIGNvbnN0IHNhbXBsZVJhdGUgPSB2aWV3LmdldFVpbnQzMigyNCwgdHJ1ZSk7XG4gICAgICAgICAgICBjb25zdCBiaXRzUGVyU2FtcGxlID0gdmlldy5nZXRVaW50MTYoMzQsIHRydWUpO1xuICAgICAgICAgICAgLy8gQ29uZmlybSBpZiBoZWFkZXIgaXMgNDQgYnl0ZXMgbG9uZy5cbiAgICAgICAgICAgIGxldCBwb3MgPSAzNiArIE1hdGgubWF4KGZvcm1hdFNpemUgLSAxNiwgMCk7XG4gICAgICAgICAgICBmb3IgKDsgZ2V0V29yZChwb3MpICE9PSBcImRhdGFcIjsgcG9zICs9IDIpIHtcbiAgICAgICAgICAgICAgICBpZiAocG9zID4gbWF4SGVhZGVyU2l6ZSAtIDgpIHtcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyUmVzdWx0LnJlamVjdChcIkludmFsaWQgV0FWIGhlYWRlciBpbiBmaWxlLCBkYXRhIGJsb2NrIHdhcyBub3QgZm91bmRcIik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnByaXZIZWFkZXJFbmQgPSBwb3MgKyA4O1xuICAgICAgICAgICAgaGVhZGVyUmVzdWx0LnJlc29sdmUoQXVkaW9TdHJlYW1Gb3JtYXQuZ2V0V2F2ZUZvcm1hdFBDTShzYW1wbGVSYXRlLCBiaXRzUGVyU2FtcGxlLCBjaGFubmVsQ291bnQpKTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgJiYgdHlwZW9mIEJsb2IgIT09IFwidW5kZWZpbmVkXCIgJiYgaGVhZGVyIGluc3RhbmNlb2YgQmxvYikge1xuICAgICAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXIgPSBldmVudC50YXJnZXQucmVzdWx0O1xuICAgICAgICAgICAgICAgIHByb2Nlc3NIZWFkZXIoaGVhZGVyKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoaGVhZGVyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGggPSBoZWFkZXI7XG4gICAgICAgICAgICBwcm9jZXNzSGVhZGVyKGguYnVmZmVyLnNsaWNlKGguYnl0ZU9mZnNldCwgaC5ieXRlT2Zmc2V0ICsgaC5ieXRlTGVuZ3RoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGhlYWRlclJlc3VsdC5wcm9taXNlO1xuICAgIH1cbiAgICB1cGxvYWQoYXVkaW9Ob2RlSWQpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IG9uZXJyb3IgPSAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlcnJvck1zZyA9IGBFcnJvciBvY2N1cnJlZCB3aGlsZSBwcm9jZXNzaW5nICcke3RoaXMucHJpdkZpbGVuYW1lfScuICR7ZXJyb3J9YDtcbiAgICAgICAgICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU3RyZWFtTm9kZUVycm9yRXZlbnQodGhpcy5wcml2SWQsIGF1ZGlvTm9kZUlkLCBlcnJvck1zZykpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvck1zZyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnR1cm5PbigpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdCA9IHlpZWxkIHRoaXMucHJpdkF1ZGlvRm9ybWF0UHJvbWlzZTtcbiAgICAgICAgICAgICAgICBjb25zdCBzdHJlYW0gPSBuZXcgQ2h1bmtlZEFycmF5QnVmZmVyU3RyZWFtKGZvcm1hdC5hdmdCeXRlc1BlclNlYyAvIDEwLCBhdWRpb05vZGVJZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U3RyZWFtc1thdWRpb05vZGVJZF0gPSBzdHJlYW07XG4gICAgICAgICAgICAgICAgY29uc3QgY2h1bmsgPSB0aGlzLnByaXZTb3VyY2Uuc2xpY2UodGhpcy5wcml2SGVhZGVyRW5kKTtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9jZXNzRmlsZSA9IChidWZmKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdHJlYW0uaXNDbG9zZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsgLy8gb3V0cHV0IHN0cmVhbSB3YXMgY2xvc2VkIChzb21lYm9keSBjYWxsZWQgVHVybk9mZikuIFdlJ3JlIGRvbmUgaGVyZS5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzdHJlYW0ud3JpdGVTdHJlYW1DaHVuayh7XG4gICAgICAgICAgICAgICAgICAgICAgICBidWZmZXI6IGJ1ZmYsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0VuZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lUmVjZWl2ZWQ6IERhdGUubm93KCksXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdHJlYW0uY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBCbG9iICE9PSBcInVuZGVmaW5lZFwiICYmIGNodW5rIGluc3RhbmNlb2YgQmxvYikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgICAgICAgICAgICAgICByZWFkZXIub25lcnJvciA9IChldikgPT4gb25lcnJvcihldi50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUJ1ZmZlciA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzRmlsZShmaWxlQnVmZmVyKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGNodW5rKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGMgPSBjaHVuaztcbiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0ZpbGUoYy5idWZmZXIuc2xpY2UoYy5ieXRlT2Zmc2V0LCBjLmJ5dGVPZmZzZXQgKyBjLmJ5dGVMZW5ndGgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0cmVhbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgb25lcnJvcihlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIG9uRXZlbnQoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5wcml2RXZlbnRzLm9uRXZlbnQoZXZlbnQpO1xuICAgICAgICBFdmVudHMuaW5zdGFuY2Uub25FdmVudChldmVudCk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1GaWxlQXVkaW9Tb3VyY2UuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgY29ubmVjdGl2aXR5LCB0eXBlIH0gZnJvbSBcIi4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQXVkaW9Tb3VyY2VFcnJvckV2ZW50LCBBdWRpb1NvdXJjZUluaXRpYWxpemluZ0V2ZW50LCBBdWRpb1NvdXJjZU9mZkV2ZW50LCBBdWRpb1NvdXJjZVJlYWR5RXZlbnQsIEF1ZGlvU3RyZWFtTm9kZUF0dGFjaGVkRXZlbnQsIEF1ZGlvU3RyZWFtTm9kZUF0dGFjaGluZ0V2ZW50LCBBdWRpb1N0cmVhbU5vZGVEZXRhY2hlZEV2ZW50LCBBdWRpb1N0cmVhbU5vZGVFcnJvckV2ZW50LCBDaHVua2VkQXJyYXlCdWZmZXJTdHJlYW0sIGNyZWF0ZU5vRGFzaEd1aWQsIERlZmVycmVkLCBFdmVudHMsIEV2ZW50U291cmNlLCB9IGZyb20gXCIuLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQXVkaW9TdHJlYW1Gb3JtYXQsIEF1ZGlvU3RyZWFtRm9ybWF0SW1wbCwgfSBmcm9tIFwiLi4vc2RrL0F1ZGlvL0F1ZGlvU3RyZWFtRm9ybWF0XCI7XG5leHBvcnQgY29uc3QgQXVkaW9Xb3JrbGV0U291cmNlVVJMUHJvcGVydHlOYW1lID0gXCJNSUNST1BIT05FLVdvcmtsZXRTb3VyY2VVcmxcIjtcbmV4cG9ydCBjbGFzcyBNaWNBdWRpb1NvdXJjZSB7XG4gICAgY29uc3RydWN0b3IocHJpdlJlY29yZGVyLCBkZXZpY2VJZCwgYXVkaW9Tb3VyY2VJZCwgbWVkaWFTdHJlYW0pIHtcbiAgICAgICAgdGhpcy5wcml2UmVjb3JkZXIgPSBwcml2UmVjb3JkZXI7XG4gICAgICAgIHRoaXMuZGV2aWNlSWQgPSBkZXZpY2VJZDtcbiAgICAgICAgdGhpcy5wcml2U3RyZWFtcyA9IHt9O1xuICAgICAgICB0aGlzLnByaXZPdXRwdXRDaHVua1NpemUgPSBNaWNBdWRpb1NvdXJjZS5BVURJT0ZPUk1BVC5hdmdCeXRlc1BlclNlYyAvIDEwO1xuICAgICAgICB0aGlzLnByaXZJZCA9IGF1ZGlvU291cmNlSWQgPyBhdWRpb1NvdXJjZUlkIDogY3JlYXRlTm9EYXNoR3VpZCgpO1xuICAgICAgICB0aGlzLnByaXZFdmVudHMgPSBuZXcgRXZlbnRTb3VyY2UoKTtcbiAgICAgICAgdGhpcy5wcml2TWVkaWFTdHJlYW0gPSBtZWRpYVN0cmVhbSB8fCBudWxsO1xuICAgICAgICB0aGlzLnByaXZJc0Nsb3NpbmcgPSBmYWxzZTtcbiAgICB9XG4gICAgZ2V0IGZvcm1hdCgpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShNaWNBdWRpb1NvdXJjZS5BVURJT0ZPUk1BVCk7XG4gICAgfVxuICAgIHR1cm5PbigpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdkluaXRpYWxpemVEZWZlcnJhbCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdkluaXRpYWxpemVEZWZlcnJhbC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdkluaXRpYWxpemVEZWZlcnJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVBdWRpb0NvbnRleHQoKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdHlwZWRFcnJvciA9IGVycm9yO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkluaXRpYWxpemVEZWZlcnJhbC5yZWplY3QodHlwZWRFcnJvci5uYW1lICsgXCI6IFwiICsgdHlwZWRFcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkluaXRpYWxpemVEZWZlcnJhbC5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdkluaXRpYWxpemVEZWZlcnJhbC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5hdiA9IHdpbmRvdy5uYXZpZ2F0b3I7XG4gICAgICAgIGxldCBnZXRVc2VyTWVkaWEgPSAoXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgICAgICBuYXYuZ2V0VXNlck1lZGlhIHx8XG4gICAgICAgICAgICBuYXYud2Via2l0R2V0VXNlck1lZGlhIHx8XG4gICAgICAgICAgICBuYXYubW96R2V0VXNlck1lZGlhIHx8XG4gICAgICAgICAgICBuYXYubXNHZXRVc2VyTWVkaWEpO1xuICAgICAgICBpZiAoISFuYXYubWVkaWFEZXZpY2VzKSB7XG4gICAgICAgICAgICBnZXRVc2VyTWVkaWEgPSAoY29uc3RyYWludHMsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykgPT4ge1xuICAgICAgICAgICAgICAgIG5hdi5tZWRpYURldmljZXNcbiAgICAgICAgICAgICAgICAgICAgLmdldFVzZXJNZWRpYShjb25zdHJhaW50cylcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oc3VjY2Vzc0NhbGxiYWNrKVxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZXJyb3JDYWxsYmFjayk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmICghZ2V0VXNlck1lZGlhKSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvck1zZyA9IFwiQnJvd3NlciBkb2VzIG5vdCBzdXBwb3J0IGdldFVzZXJNZWRpYS5cIjtcbiAgICAgICAgICAgIHRoaXMucHJpdkluaXRpYWxpemVEZWZlcnJhbC5yZWplY3QoZXJyb3JNc2cpO1xuICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1NvdXJjZUVycm9yRXZlbnQoZXJyb3JNc2csIFwiXCIpKTsgLy8gbWljIGluaXRpYWxpemVkIGVycm9yIC0gbm8gc3RyZWFtaWQgYXQgdGhpcyBwb2ludFxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgbmV4dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU291cmNlSW5pdGlhbGl6aW5nRXZlbnQodGhpcy5wcml2SWQpKTsgLy8gbm8gc3RyZWFtIGlkXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdk1lZGlhU3RyZWFtICYmIHRoaXMucHJpdk1lZGlhU3RyZWFtLmFjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU291cmNlUmVhZHlFdmVudCh0aGlzLnByaXZJZCkpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZJbml0aWFsaXplRGVmZXJyYWwucmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZ2V0VXNlck1lZGlhKHsgYXVkaW86IHRoaXMuZGV2aWNlSWQgPyB7IGRldmljZUlkOiB0aGlzLmRldmljZUlkIH0gOiB0cnVlLCB2aWRlbzogZmFsc2UgfSwgKG1lZGlhU3RyZWFtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZNZWRpYVN0cmVhbSA9IG1lZGlhU3RyZWFtO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1NvdXJjZVJlYWR5RXZlbnQodGhpcy5wcml2SWQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkluaXRpYWxpemVEZWZlcnJhbC5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXJyb3JNc2cgPSBgRXJyb3Igb2NjdXJyZWQgZHVyaW5nIG1pY3JvcGhvbmUgaW5pdGlhbGl6YXRpb246ICR7ZXJyb3J9YDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkluaXRpYWxpemVEZWZlcnJhbC5yZWplY3QoZXJyb3JNc2cpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1NvdXJjZUVycm9yRXZlbnQodGhpcy5wcml2SWQsIGVycm9yTXNnKSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2Q29udGV4dC5zdGF0ZSA9PT0gXCJzdXNwZW5kZWRcIikge1xuICAgICAgICAgICAgICAgIC8vIE5PVEU6IE9uIGlPUywgdGhlIFdlYiBBdWRpbyBBUEkgcmVxdWlyZXMgc291bmRzIHRvIGJlIHRyaWdnZXJlZCBmcm9tIGFuIGV4cGxpY2l0IHVzZXIgYWN0aW9uLlxuICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9XZWJBdWRpby93ZWItYXVkaW8tYXBpL2lzc3Vlcy83OTBcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb250ZXh0LnJlc3VtZSgpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKG5leHQpXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaCgocmVhc29uKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkluaXRpYWxpemVEZWZlcnJhbC5yZWplY3QoYEZhaWxlZCB0byBpbml0aWFsaXplIGF1ZGlvIGNvbnRleHQ6ICR7cmVhc29ufWApO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV4dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJbml0aWFsaXplRGVmZXJyYWwucHJvbWlzZTtcbiAgICB9XG4gICAgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJZDtcbiAgICB9XG4gICAgYXR0YWNoKGF1ZGlvTm9kZUlkKSB7XG4gICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9TdHJlYW1Ob2RlQXR0YWNoaW5nRXZlbnQodGhpcy5wcml2SWQsIGF1ZGlvTm9kZUlkKSk7XG4gICAgICAgIHJldHVybiB0aGlzLmxpc3RlbihhdWRpb05vZGVJZCkudGhlbigoc3RyZWFtKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU3RyZWFtTm9kZUF0dGFjaGVkRXZlbnQodGhpcy5wcml2SWQsIGF1ZGlvTm9kZUlkKSk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGRldGFjaDogKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgICAgICAgICBzdHJlYW0ucmVhZEVuZGVkKCk7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnByaXZTdHJlYW1zW2F1ZGlvTm9kZUlkXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1N0cmVhbU5vZGVEZXRhY2hlZEV2ZW50KHRoaXMucHJpdklkLCBhdWRpb05vZGVJZCkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50dXJuT2ZmKCk7XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgaWQ6ICgpID0+IGF1ZGlvTm9kZUlkLFxuICAgICAgICAgICAgICAgIHJlYWQ6ICgpID0+IHN0cmVhbS5yZWFkKCksXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZGV0YWNoKGF1ZGlvTm9kZUlkKSB7XG4gICAgICAgIGlmIChhdWRpb05vZGVJZCAmJiB0aGlzLnByaXZTdHJlYW1zW2F1ZGlvTm9kZUlkXSkge1xuICAgICAgICAgICAgdGhpcy5wcml2U3RyZWFtc1thdWRpb05vZGVJZF0uY2xvc2UoKTtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnByaXZTdHJlYW1zW2F1ZGlvTm9kZUlkXTtcbiAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9TdHJlYW1Ob2RlRGV0YWNoZWRFdmVudCh0aGlzLnByaXZJZCwgYXVkaW9Ob2RlSWQpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0dXJuT2ZmKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBzdHJlYW1JZCBpbiB0aGlzLnByaXZTdHJlYW1zKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN0cmVhbUlkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMucHJpdlN0cmVhbXNbc3RyZWFtSWRdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RyZWFtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJlYW0uY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9Tb3VyY2VPZmZFdmVudCh0aGlzLnByaXZJZCkpOyAvLyBubyBzdHJlYW0gbm93XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2SW5pdGlhbGl6ZURlZmVycmFsKSB7XG4gICAgICAgICAgICAgICAgLy8gQ29ycmVjdGx5IGhhbmRsZSB3aGVuIGJyb3dzZXIgZm9yY2VzIG1pYyBvZmYgYmVmb3JlIHR1cm5PbigpIGNvbXBsZXRlc1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYXdhaXQtdGhlbmFibGVcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZJbml0aWFsaXplRGVmZXJyYWw7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2SW5pdGlhbGl6ZURlZmVycmFsID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHlpZWxkIHRoaXMuZGVzdHJveUF1ZGlvQ29udGV4dCgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZ2V0IGV2ZW50cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkV2ZW50cztcbiAgICB9XG4gICAgZ2V0IGRldmljZUluZm8oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldE1pY3JvcGhvbmVMYWJlbCgpLnRoZW4oKGxhYmVsKSA9PiAoe1xuICAgICAgICAgICAgYml0c3BlcnNhbXBsZTogTWljQXVkaW9Tb3VyY2UuQVVESU9GT1JNQVQuYml0c1BlclNhbXBsZSxcbiAgICAgICAgICAgIGNoYW5uZWxjb3VudDogTWljQXVkaW9Tb3VyY2UuQVVESU9GT1JNQVQuY2hhbm5lbHMsXG4gICAgICAgICAgICBjb25uZWN0aXZpdHk6IGNvbm5lY3Rpdml0eS5Vbmtub3duLFxuICAgICAgICAgICAgbWFudWZhY3R1cmVyOiBcIlNwZWVjaCBTREtcIixcbiAgICAgICAgICAgIG1vZGVsOiBsYWJlbCxcbiAgICAgICAgICAgIHNhbXBsZXJhdGU6IE1pY0F1ZGlvU291cmNlLkFVRElPRk9STUFULnNhbXBsZXNQZXJTZWMsXG4gICAgICAgICAgICB0eXBlOiB0eXBlLk1pY3JvcGhvbmVzLFxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHNldFByb3BlcnR5KG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGlmIChuYW1lID09PSBBdWRpb1dvcmtsZXRTb3VyY2VVUkxQcm9wZXJ0eU5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlY29yZGVyLnNldFdvcmtsZXRVcmwodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUHJvcGVydHkgJ1wiICsgbmFtZSArIFwiJyBpcyBub3Qgc3VwcG9ydGVkIG9uIE1pY3JvcGhvbmUuXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldE1pY3JvcGhvbmVMYWJlbCgpIHtcbiAgICAgICAgY29uc3QgZGVmYXVsdE1pY3JvcGhvbmVOYW1lID0gXCJtaWNyb3Bob25lXCI7XG4gICAgICAgIC8vIElmIHdlIGRpZCB0aGlzIGFscmVhZHksIHJldHVybiB0aGUgdmFsdWUuXG4gICAgICAgIGlmICh0aGlzLnByaXZNaWNyb3Bob25lTGFiZWwgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLnByaXZNaWNyb3Bob25lTGFiZWwpO1xuICAgICAgICB9XG4gICAgICAgIC8vIElmIHRoZSBzdHJlYW0gaXNuJ3QgY3VycmVudGx5IHJ1bm5pbmcsIHdlIGNhbid0IHF1ZXJ5IGRldmljZXMgYmVjYXVzZSBzZWN1cml0eS5cbiAgICAgICAgaWYgKHRoaXMucHJpdk1lZGlhU3RyZWFtID09PSB1bmRlZmluZWQgfHwgIXRoaXMucHJpdk1lZGlhU3RyZWFtLmFjdGl2ZSkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShkZWZhdWx0TWljcm9waG9uZU5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFNldHVwIGEgZGVmYXVsdFxuICAgICAgICB0aGlzLnByaXZNaWNyb3Bob25lTGFiZWwgPSBkZWZhdWx0TWljcm9waG9uZU5hbWU7XG4gICAgICAgIC8vIEdldCB0aGUgaWQgb2YgdGhlIGRldmljZSBydW5uaW5nIHRoZSBhdWRpbyB0cmFjay5cbiAgICAgICAgY29uc3QgbWljcm9waG9uZURldmljZUlkID0gdGhpcy5wcml2TWVkaWFTdHJlYW0uZ2V0VHJhY2tzKClbMF0uZ2V0U2V0dGluZ3MoKS5kZXZpY2VJZDtcbiAgICAgICAgLy8gSWYgdGhlIGJyb3dzZXIgZG9lc24ndCBzdXBwb3J0IGdldHRpbmcgdGhlIGRldmljZSBJRCwgc2V0IGEgZGVmYXVsdCBhbmQgcmV0dXJuLlxuICAgICAgICBpZiAodW5kZWZpbmVkID09PSBtaWNyb3Bob25lRGV2aWNlSWQpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5wcml2TWljcm9waG9uZUxhYmVsKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBkZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICAvLyBFbnVtZXJhdGUgdGhlIG1lZGlhIGRldmljZXMuXG4gICAgICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZW51bWVyYXRlRGV2aWNlcygpLnRoZW4oKGRldmljZXMpID0+IHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZGV2aWNlIG9mIGRldmljZXMpIHtcbiAgICAgICAgICAgICAgICBpZiAoZGV2aWNlLmRldmljZUlkID09PSBtaWNyb3Bob25lRGV2aWNlSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gRm91bmQgdGhlIGRldmljZVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZNaWNyb3Bob25lTGFiZWwgPSBkZXZpY2UubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUodGhpcy5wcml2TWljcm9waG9uZUxhYmVsKTtcbiAgICAgICAgfSwgKCkgPT4gZGVmZXJyZWQucmVzb2x2ZSh0aGlzLnByaXZNaWNyb3Bob25lTGFiZWwpKTtcbiAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgfVxuICAgIGxpc3RlbihhdWRpb05vZGVJZCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgeWllbGQgdGhpcy50dXJuT24oKTtcbiAgICAgICAgICAgIGNvbnN0IHN0cmVhbSA9IG5ldyBDaHVua2VkQXJyYXlCdWZmZXJTdHJlYW0odGhpcy5wcml2T3V0cHV0Q2h1bmtTaXplLCBhdWRpb05vZGVJZCk7XG4gICAgICAgICAgICB0aGlzLnByaXZTdHJlYW1zW2F1ZGlvTm9kZUlkXSA9IHN0cmVhbTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVjb3JkZXIucmVjb3JkKHRoaXMucHJpdkNvbnRleHQsIHRoaXMucHJpdk1lZGlhU3RyZWFtLCBzdHJlYW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1N0cmVhbU5vZGVFcnJvckV2ZW50KHRoaXMucHJpdklkLCBhdWRpb05vZGVJZCwgZXJyb3IpKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN0cmVhbTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBvbkV2ZW50KGV2ZW50KSB7XG4gICAgICAgIHRoaXMucHJpdkV2ZW50cy5vbkV2ZW50KGV2ZW50KTtcbiAgICAgICAgRXZlbnRzLmluc3RhbmNlLm9uRXZlbnQoZXZlbnQpO1xuICAgIH1cbiAgICBjcmVhdGVBdWRpb0NvbnRleHQoKSB7XG4gICAgICAgIGlmICghIXRoaXMucHJpdkNvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZDb250ZXh0ID0gQXVkaW9TdHJlYW1Gb3JtYXRJbXBsLmdldEF1ZGlvQ29udGV4dChNaWNBdWRpb1NvdXJjZS5BVURJT0ZPUk1BVC5zYW1wbGVzUGVyU2VjKTtcbiAgICB9XG4gICAgZGVzdHJveUF1ZGlvQ29udGV4dCgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wcml2Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucHJpdlJlY29yZGVyLnJlbGVhc2VNZWRpYVJlc291cmNlcyh0aGlzLnByaXZDb250ZXh0KTtcbiAgICAgICAgICAgIC8vIFRoaXMgcGF0dGVybiBicm91Z2h0IHRvIHlvdSBieSBhIGJ1ZyBpbiB0aGUgVHlwZVNjcmlwdCBjb21waWxlciB3aGVyZSBpdFxuICAgICAgICAgICAgLy8gY29uZnVzZXMgdGhlIChcImNsb3NlXCIgaW4gdGhpcy5wcml2Q29udGV4dCkgd2l0aCB0aGlzLnByaXZDb250ZXh0IGFsd2F5cyBiZWluZyBudWxsIGFzIHRoZSBhbHRlcm5hdGUuXG4gICAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vTWljcm9zb2Z0L1R5cGVTY3JpcHQvaXNzdWVzLzExNDk4XG4gICAgICAgICAgICBsZXQgaGFzQ2xvc2UgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChcImNsb3NlXCIgaW4gdGhpcy5wcml2Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIGhhc0Nsb3NlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChoYXNDbG9zZSkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5wcml2SXNDbG9zaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBhdWRpbyBjb250ZXh0IGNsb3NlIG1heSB0YWtlIGVub3VnaCB0aW1lIHRoYXQgdGhlIGNsb3NlIGlzIGNhbGxlZCB0d2ljZVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZJc0Nsb3NpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZDb250ZXh0LmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnRleHQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZJc0Nsb3NpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChudWxsICE9PSB0aGlzLnByaXZDb250ZXh0ICYmIHRoaXMucHJpdkNvbnRleHQuc3RhdGUgPT09IFwicnVubmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgLy8gU3VzcGVuZCBhY3R1YWxseSB0YWtlcyBhIGNhbGxiYWNrLCBidXQgYW5hbG9nb3VzIHRvIHRoZVxuICAgICAgICAgICAgICAgIC8vIHJlc3VtZSBtZXRob2QsIGl0J2xsIGJlIG9ubHkgZmlyZWQgaWYgc3VzcGVuZCBpcyBjYWxsZWRcbiAgICAgICAgICAgICAgICAvLyBpbiBhIGRpcmVjdCByZXNwb25zZSB0byBhIHVzZXIgYWN0aW9uLiBUaGUgbGF0ZXIgaXMgbm90IGFsd2F5c1xuICAgICAgICAgICAgICAgIC8vIHRoZSBjYXNlLCBhcyBUdXJuT2ZmIGlzIGFsc28gY2FsbGVkLCB3aGVuIHdlIHJlY2VpdmUgYW5cbiAgICAgICAgICAgICAgICAvLyBlbmQtb2Ytc3BlZWNoIG1lc3NhZ2UgZnJvbSB0aGUgc2VydmljZS4gU28sIGRvaW5nIGEgYmVzdCBlZmZvcnRcbiAgICAgICAgICAgICAgICAvLyBmaXJlLWFuZC1mb3JnZXQgaGVyZS5cbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZDb250ZXh0LnN1c3BlbmQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuTWljQXVkaW9Tb3VyY2UuQVVESU9GT1JNQVQgPSBBdWRpb1N0cmVhbUZvcm1hdC5nZXREZWZhdWx0SW5wdXRGb3JtYXQoKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9TWljQXVkaW9Tb3VyY2UuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFJpZmZQY21FbmNvZGVyIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5leHBvcnQgY2xhc3MgUGNtUmVjb3JkZXIge1xuICAgIGNvbnN0cnVjdG9yKHN0b3BJbnB1dE9uUmVsZWFzZSkge1xuICAgICAgICB0aGlzLnByaXZTdG9wSW5wdXRPblJlbGVhc2UgPSBzdG9wSW5wdXRPblJlbGVhc2U7XG4gICAgfVxuICAgIHJlY29yZChjb250ZXh0LCBtZWRpYVN0cmVhbSwgb3V0cHV0U3RyZWFtKSB7XG4gICAgICAgIGNvbnN0IGRlc2lyZWRTYW1wbGVSYXRlID0gMTYwMDA7XG4gICAgICAgIGNvbnN0IHdhdmVTdHJlYW1FbmNvZGVyID0gbmV3IFJpZmZQY21FbmNvZGVyKGNvbnRleHQuc2FtcGxlUmF0ZSwgZGVzaXJlZFNhbXBsZVJhdGUpO1xuICAgICAgICBjb25zdCBtaWNJbnB1dCA9IGNvbnRleHQuY3JlYXRlTWVkaWFTdHJlYW1Tb3VyY2UobWVkaWFTdHJlYW0pO1xuICAgICAgICBjb25zdCBhdHRhY2hTY3JpcHRQcm9jZXNzb3IgPSAoKSA9PiB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2V4cGxpY2l0LWZ1bmN0aW9uLXJldHVybi10eXBlXG4gICAgICAgICAgICBjb25zdCBzY3JpcHROb2RlID0gKCgpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgYnVmZmVyU2l6ZSA9IDA7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuY3JlYXRlU2NyaXB0UHJvY2Vzc29yKGJ1ZmZlclNpemUsIDEsIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gV2Via2l0ICg8PSB2ZXJzaW9uIDMxKSByZXF1aXJlcyBhIHZhbGlkIGJ1ZmZlclNpemUuXG4gICAgICAgICAgICAgICAgICAgIGJ1ZmZlclNpemUgPSAyMDQ4O1xuICAgICAgICAgICAgICAgICAgICBsZXQgYXVkaW9TYW1wbGVSYXRlID0gY29udGV4dC5zYW1wbGVSYXRlO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoYnVmZmVyU2l6ZSA8IDE2Mzg0ICYmIGF1ZGlvU2FtcGxlUmF0ZSA+PSAoMiAqIGRlc2lyZWRTYW1wbGVSYXRlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnVmZmVyU2l6ZSA8PD0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1ZGlvU2FtcGxlUmF0ZSA+Pj0gMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5jcmVhdGVTY3JpcHRQcm9jZXNzb3IoYnVmZmVyU2l6ZSwgMSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgICAgIHNjcmlwdE5vZGUub25hdWRpb3Byb2Nlc3MgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbnB1dEZyYW1lID0gZXZlbnQuaW5wdXRCdWZmZXIuZ2V0Q2hhbm5lbERhdGEoMCk7XG4gICAgICAgICAgICAgICAgaWYgKG91dHB1dFN0cmVhbSAmJiAhb3V0cHV0U3RyZWFtLmlzQ2xvc2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHdhdmVGcmFtZSA9IHdhdmVTdHJlYW1FbmNvZGVyLmVuY29kZShpbnB1dEZyYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhd2F2ZUZyYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRTdHJlYW0ud3JpdGVTdHJlYW1DaHVuayh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVmZmVyOiB3YXZlRnJhbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNFbmQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVSZWNlaXZlZDogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIG1pY0lucHV0LmNvbm5lY3Qoc2NyaXB0Tm9kZSk7XG4gICAgICAgICAgICBzY3JpcHROb2RlLmNvbm5lY3QoY29udGV4dC5kZXN0aW5hdGlvbik7XG4gICAgICAgICAgICB0aGlzLnByaXZNZWRpYVJlc291cmNlcyA9IHtcbiAgICAgICAgICAgICAgICBzY3JpcHRQcm9jZXNzb3JOb2RlOiBzY3JpcHROb2RlLFxuICAgICAgICAgICAgICAgIHNvdXJjZTogbWljSW5wdXQsXG4gICAgICAgICAgICAgICAgc3RyZWFtOiBtZWRpYVN0cmVhbSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIC8vIGh0dHBzOi8vd2ViYXVkaW8uZ2l0aHViLmlvL3dlYi1hdWRpby1hcGkvI2F1ZGlvd29ya2xldFxuICAgICAgICAvLyBVc2luZyBBdWRpb1dvcmtsZXQgdG8gaW1wcm92ZSBhdWRpbyBxdWFsaXR5IGFuZCBhdm9pZCBhdWRpbyBnbGl0Y2hlcyBkdWUgdG8gYmxvY2tpbmcgdGhlIFVJIHRocmVhZFxuICAgICAgICBpZiAoISFjb250ZXh0LmF1ZGlvV29ya2xldCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZTcGVlY2hQcm9jZXNzb3JTY3JpcHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB3b3JrbGV0U2NyaXB0ID0gYGNsYXNzIFNQIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29yIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICBzdXBlcihvcHRpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvY2VzcyhpbnB1dHMsIG91dHB1dHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gaW5wdXRzWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3V0cHV0ID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBjaGFubmVsID0gMDsgY2hhbm5lbCA8IGlucHV0Lmxlbmd0aDsgY2hhbm5lbCArPSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dFtjaGFubmVsXSA9IGlucHV0W2NoYW5uZWxdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3J0LnBvc3RNZXNzYWdlKG91dHB1dFswXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgcmVnaXN0ZXJQcm9jZXNzb3IoJ3NwZWVjaC1wcm9jZXNzb3InLCBTUCk7YDtcbiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW3dvcmtsZXRTY3JpcHRdLCB7IHR5cGU6IFwiYXBwbGljYXRpb24vamF2YXNjcmlwdDsgY2hhcnNldD11dGYtOFwiIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaFByb2Nlc3NvclNjcmlwdCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250ZXh0LmF1ZGlvV29ya2xldFxuICAgICAgICAgICAgICAgIC5hZGRNb2R1bGUodGhpcy5wcml2U3BlZWNoUHJvY2Vzc29yU2NyaXB0KVxuICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB3b3JrbGV0Tm9kZSA9IG5ldyBBdWRpb1dvcmtsZXROb2RlKGNvbnRleHQsIFwic3BlZWNoLXByb2Nlc3NvclwiKTtcbiAgICAgICAgICAgICAgICB3b3JrbGV0Tm9kZS5wb3J0Lm9ubWVzc2FnZSA9IChldikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpbnB1dEZyYW1lID0gZXYuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG91dHB1dFN0cmVhbSAmJiAhb3V0cHV0U3RyZWFtLmlzQ2xvc2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB3YXZlRnJhbWUgPSB3YXZlU3RyZWFtRW5jb2Rlci5lbmNvZGUoaW5wdXRGcmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF3YXZlRnJhbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRTdHJlYW0ud3JpdGVTdHJlYW1DaHVuayh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1ZmZlcjogd2F2ZUZyYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0VuZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVSZWNlaXZlZDogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgbWljSW5wdXQuY29ubmVjdCh3b3JrbGV0Tm9kZSk7XG4gICAgICAgICAgICAgICAgd29ya2xldE5vZGUuY29ubmVjdChjb250ZXh0LmRlc3RpbmF0aW9uKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZNZWRpYVJlc291cmNlcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgc2NyaXB0UHJvY2Vzc29yTm9kZTogd29ya2xldE5vZGUsXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZTogbWljSW5wdXQsXG4gICAgICAgICAgICAgICAgICAgIHN0cmVhbTogbWVkaWFTdHJlYW0sXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhdGNoKCgpID0+IHtcbiAgICAgICAgICAgICAgICBhdHRhY2hTY3JpcHRQcm9jZXNzb3IoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBhdHRhY2hTY3JpcHRQcm9jZXNzb3IoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuYWJsZSB0byBzdGFydCBhdWRpbyB3b3JrbGV0IG5vZGUgZm9yIFBDTVJlY29yZGVyOiAke2Vycn1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZWxlYXNlTWVkaWFSZXNvdXJjZXMoY29udGV4dCkge1xuICAgICAgICBpZiAodGhpcy5wcml2TWVkaWFSZXNvdXJjZXMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZNZWRpYVJlc291cmNlcy5zY3JpcHRQcm9jZXNzb3JOb2RlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2TWVkaWFSZXNvdXJjZXMuc2NyaXB0UHJvY2Vzc29yTm9kZS5kaXNjb25uZWN0KGNvbnRleHQuZGVzdGluYXRpb24pO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdk1lZGlhUmVzb3VyY2VzLnNjcmlwdFByb2Nlc3Nvck5vZGUgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucHJpdk1lZGlhUmVzb3VyY2VzLnNvdXJjZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdk1lZGlhUmVzb3VyY2VzLnNvdXJjZS5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdlN0b3BJbnB1dE9uUmVsZWFzZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZNZWRpYVJlc291cmNlcy5zdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaCgodHJhY2spID0+IHRyYWNrLnN0b3AoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucHJpdk1lZGlhUmVzb3VyY2VzLnNvdXJjZSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2V0V29ya2xldFVybCh1cmwpIHtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoUHJvY2Vzc29yU2NyaXB0ID0gdXJsO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UENNUmVjb3JkZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFByb3BlcnR5SWQgfSBmcm9tIFwiLi4vc2RrL0V4cG9ydHNcIjtcbmV4cG9ydCBjbGFzcyBQcm94eUluZm8ge1xuICAgIGNvbnN0cnVjdG9yKHByb3h5SG9zdE5hbWUsIHByb3h5UG9ydCwgcHJveHlVc2VyTmFtZSwgcHJveHlQYXNzd29yZCkge1xuICAgICAgICB0aGlzLnByaXZQcm94eUhvc3ROYW1lID0gcHJveHlIb3N0TmFtZTtcbiAgICAgICAgdGhpcy5wcml2UHJveHlQb3J0ID0gcHJveHlQb3J0O1xuICAgICAgICB0aGlzLnByaXZQcm94eVVzZXJOYW1lID0gcHJveHlVc2VyTmFtZTtcbiAgICAgICAgdGhpcy5wcml2UHJveHlQYXNzd29yZCA9IHByb3h5UGFzc3dvcmQ7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tUGFyYW1ldGVycyhwYXJhbWV0ZXJzKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJveHlJbmZvKHBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Qcm94eUhvc3ROYW1lKSwgcGFyc2VJbnQocGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5UG9ydCksIDEwKSwgcGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5VXNlck5hbWUpLCBwYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUHJveHlQYXNzd29yZCkpO1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbVJlY29nbml6ZXJDb25maWcoY29uZmlnKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZyb21QYXJhbWV0ZXJzKGNvbmZpZy5wYXJhbWV0ZXJzKTtcbiAgICB9XG4gICAgZ2V0IEhvc3ROYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJveHlIb3N0TmFtZTtcbiAgICB9XG4gICAgZ2V0IFBvcnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm94eVBvcnQ7XG4gICAgfVxuICAgIGdldCBVc2VyTmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3h5VXNlck5hbWU7XG4gICAgfVxuICAgIGdldCBQYXNzd29yZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3h5UGFzc3dvcmQ7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Qcm94eUluZm8uanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmV4cG9ydCBjbGFzcyBSZXBsYXlhYmxlQXVkaW9Ob2RlIHtcbiAgICBjb25zdHJ1Y3RvcihhdWRpb1NvdXJjZSwgYnl0ZXNQZXJTZWNvbmQpIHtcbiAgICAgICAgdGhpcy5wcml2QnVmZmVycyA9IFtdO1xuICAgICAgICB0aGlzLnByaXZSZXBsYXlPZmZzZXQgPSAwO1xuICAgICAgICB0aGlzLnByaXZMYXN0U2hyaW5rT2Zmc2V0ID0gMDtcbiAgICAgICAgdGhpcy5wcml2QnVmZmVyU3RhcnRPZmZzZXQgPSAwO1xuICAgICAgICB0aGlzLnByaXZCdWZmZXJTZXJpYWwgPSAwO1xuICAgICAgICB0aGlzLnByaXZCdWZmZXJlZEJ5dGVzID0gMDtcbiAgICAgICAgdGhpcy5wcml2UmVwbGF5ID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdkxhc3RDaHVua0FjcXVpcmVkVGltZSA9IDA7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvTm9kZSA9IGF1ZGlvU291cmNlO1xuICAgICAgICB0aGlzLnByaXZCeXRlc1BlclNlY29uZCA9IGJ5dGVzUGVyU2Vjb25kO1xuICAgIH1cbiAgICBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvTm9kZS5pZCgpO1xuICAgIH1cbiAgICAvLyBSZWFkcyBhbmQgcmV0dXJucyB0aGUgbmV4dCBjaHVuayBvZiBhdWRpbyBidWZmZXIuXG4gICAgLy8gSWYgcmVwbGF5IG9mIGV4aXN0aW5nIGJ1ZmZlcnMgYXJlIG5lZWRlZCwgcmVhZCgpIHdpbGwgZmlyc3Qgc2VlayBhbmQgcmVwbGF5XG4gICAgLy8gZXhpc3RpbmcgY29udGVudCwgYW5kIHVwb2luIGNvbXBsZXRpb24gaXQgd2lsbCByZWFkIG5ldyBjb250ZW50IGZyb20gdGhlIHVuZGVybHlpbmdcbiAgICAvLyBhdWRpbyBub2RlLCBzYXZpbmcgdGhhdCBjb250ZW50IGludG8gdGhlIHJlcGxheWFibGUgYnVmZmVycy5cbiAgICByZWFkKCkge1xuICAgICAgICAvLyBpZiB0aGVyZSBpcyBhIHJlcGxheSByZXF1ZXN0IHRvIGhvbm9yLlxuICAgICAgICBpZiAoISF0aGlzLnByaXZSZXBsYXkgJiYgdGhpcy5wcml2QnVmZmVycy5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgIC8vIEZpbmQgdGhlIHN0YXJ0IHBvaW50IGluIHRoZSBidWZmZXJzLlxuICAgICAgICAgICAgLy8gT2Zmc2V0cyBhcmUgaW4gMTAwbnMgaW5jcmVtZW50cy5cbiAgICAgICAgICAgIC8vIFNvIGhvdyBtYW55IGJ5dGVzIGRvIHdlIG5lZWQgdG8gc2VlayB0byBnZXQgdGhlIHJpZ2h0IG9mZnNldD9cbiAgICAgICAgICAgIGNvbnN0IG9mZnNldFRvU2VlayA9IHRoaXMucHJpdlJlcGxheU9mZnNldCAtIHRoaXMucHJpdkJ1ZmZlclN0YXJ0T2Zmc2V0O1xuICAgICAgICAgICAgbGV0IGJ5dGVzVG9TZWVrID0gTWF0aC5yb3VuZChvZmZzZXRUb1NlZWsgKiB0aGlzLnByaXZCeXRlc1BlclNlY29uZCAqIDFlLTcpO1xuICAgICAgICAgICAgaWYgKDAgIT09IChieXRlc1RvU2VlayAlIDIpKSB7XG4gICAgICAgICAgICAgICAgYnl0ZXNUb1NlZWsrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgICAgIHdoaWxlIChpIDwgdGhpcy5wcml2QnVmZmVycy5sZW5ndGggJiYgYnl0ZXNUb1NlZWsgPj0gdGhpcy5wcml2QnVmZmVyc1tpXS5jaHVuay5idWZmZXIuYnl0ZUxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGJ5dGVzVG9TZWVrIC09IHRoaXMucHJpdkJ1ZmZlcnNbaSsrXS5jaHVuay5idWZmZXIuYnl0ZUxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpIDwgdGhpcy5wcml2QnVmZmVycy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXRWYWwgPSB0aGlzLnByaXZCdWZmZXJzW2ldLmNodW5rLmJ1ZmZlci5zbGljZShieXRlc1RvU2Vlayk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVwbGF5T2Zmc2V0ICs9IChyZXRWYWwuYnl0ZUxlbmd0aCAvIHRoaXMucHJpdkJ5dGVzUGVyU2Vjb25kKSAqIDFlKzc7XG4gICAgICAgICAgICAgICAgLy8gSWYgd2UndmUgcmVhY2hlZCB0aGUgZW5kIG9mIHRoZSBidWZmZXJzLCBzdG9wIHJlcGxheWluZy5cbiAgICAgICAgICAgICAgICBpZiAoaSA9PT0gdGhpcy5wcml2QnVmZmVycy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlcGxheSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgICAgICAgYnVmZmVyOiByZXRWYWwsXG4gICAgICAgICAgICAgICAgICAgIGlzRW5kOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgdGltZVJlY2VpdmVkOiB0aGlzLnByaXZCdWZmZXJzW2ldLmNodW5rLnRpbWVSZWNlaXZlZCxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXVkaW9Ob2RlLnJlYWQoKVxuICAgICAgICAgICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgaWYgKHJlc3VsdCAmJiByZXN1bHQuYnVmZmVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2QnVmZmVycy5wdXNoKG5ldyBCdWZmZXJFbnRyeShyZXN1bHQsIHRoaXMucHJpdkJ1ZmZlclNlcmlhbCsrLCB0aGlzLnByaXZCdWZmZXJlZEJ5dGVzKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2QnVmZmVyZWRCeXRlcyArPSByZXN1bHQuYnVmZmVyLmJ5dGVMZW5ndGg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZGV0YWNoKCkge1xuICAgICAgICB0aGlzLnByaXZCdWZmZXJzID0gdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXVkaW9Ob2RlLmRldGFjaCgpO1xuICAgIH1cbiAgICByZXBsYXkoKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZCdWZmZXJzICYmIDAgIT09IHRoaXMucHJpdkJ1ZmZlcnMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZSZXBsYXkgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVwbGF5T2Zmc2V0ID0gdGhpcy5wcml2TGFzdFNocmlua09mZnNldDtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBTaHJpbmtzIHRoZSBleGlzdGluZyBhdWRpbyBidWZmZXJzIHRvIHN0YXJ0IGF0IHRoZSBuZXcgb2Zmc2V0LCBvciBhdCB0aGVcbiAgICAvLyBiZWdpbm5pbmcgb2YgdGhlIGJ1ZmZlciBjbG9zZXN0IHRvIHRoZSByZXF1ZXN0ZWQgb2Zmc2V0LlxuICAgIC8vIEEgcmVwbGF5IHJlcXVlc3Qgd2lsbCBzdGFydCBmcm9tIHRoZSBsYXN0IHNocmluayBwb2ludC5cbiAgICBzaHJpbmtCdWZmZXJzKG9mZnNldCkge1xuICAgICAgICBpZiAodGhpcy5wcml2QnVmZmVycyA9PT0gdW5kZWZpbmVkIHx8IHRoaXMucHJpdkJ1ZmZlcnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2TGFzdFNocmlua09mZnNldCA9IG9mZnNldDtcbiAgICAgICAgLy8gRmluZCB0aGUgc3RhcnQgcG9pbnQgaW4gdGhlIGJ1ZmZlcnMuXG4gICAgICAgIC8vIE9mZnNldHMgYXJlIGluIDEwMG5zIGluY3JlbWVudHMuXG4gICAgICAgIC8vIFNvIGhvdyBtYW55IGJ5dGVzIGRvIHdlIG5lZWQgdG8gc2VlayB0byBnZXQgdGhlIHJpZ2h0IG9mZnNldD9cbiAgICAgICAgY29uc3Qgb2Zmc2V0VG9TZWVrID0gb2Zmc2V0IC0gdGhpcy5wcml2QnVmZmVyU3RhcnRPZmZzZXQ7XG4gICAgICAgIGxldCBieXRlc1RvU2VlayA9IE1hdGgucm91bmQob2Zmc2V0VG9TZWVrICogdGhpcy5wcml2Qnl0ZXNQZXJTZWNvbmQgKiAxZS03KTtcbiAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICB3aGlsZSAoaSA8IHRoaXMucHJpdkJ1ZmZlcnMubGVuZ3RoICYmIGJ5dGVzVG9TZWVrID49IHRoaXMucHJpdkJ1ZmZlcnNbaV0uY2h1bmsuYnVmZmVyLmJ5dGVMZW5ndGgpIHtcbiAgICAgICAgICAgIGJ5dGVzVG9TZWVrIC09IHRoaXMucHJpdkJ1ZmZlcnNbaSsrXS5jaHVuay5idWZmZXIuYnl0ZUxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZCdWZmZXJTdGFydE9mZnNldCA9IE1hdGgucm91bmQob2Zmc2V0IC0gKChieXRlc1RvU2VlayAvIHRoaXMucHJpdkJ5dGVzUGVyU2Vjb25kKSAqIDFlKzcpKTtcbiAgICAgICAgdGhpcy5wcml2QnVmZmVycyA9IHRoaXMucHJpdkJ1ZmZlcnMuc2xpY2UoaSk7XG4gICAgfVxuICAgIC8vIEZpbmRzIHRoZSB0aW1lIGEgYnVmZmVyIG9mIGF1ZGlvIHdhcyBmaXJzdCBzZWVuIGJ5IG9mZnNldC5cbiAgICBmaW5kVGltZUF0T2Zmc2V0KG9mZnNldCkge1xuICAgICAgICBpZiAob2Zmc2V0IDwgdGhpcy5wcml2QnVmZmVyU3RhcnRPZmZzZXQgfHwgdGhpcy5wcml2QnVmZmVycyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IHZhbHVlIG9mIHRoaXMucHJpdkJ1ZmZlcnMpIHtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0T2Zmc2V0ID0gKHZhbHVlLmJ5dGVPZmZzZXQgLyB0aGlzLnByaXZCeXRlc1BlclNlY29uZCkgKiAxZTc7XG4gICAgICAgICAgICBjb25zdCBlbmRPZmZzZXQgPSBzdGFydE9mZnNldCArICgodmFsdWUuY2h1bmsuYnVmZmVyLmJ5dGVMZW5ndGggLyB0aGlzLnByaXZCeXRlc1BlclNlY29uZCkgKiAxZTcpO1xuICAgICAgICAgICAgaWYgKG9mZnNldCA+PSBzdGFydE9mZnNldCAmJiBvZmZzZXQgPD0gZW5kT2Zmc2V0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlLmNodW5rLnRpbWVSZWNlaXZlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG59XG4vLyBQcmltYXJ5IHVzZSBvZiB0aGlzIGNsYXNzIGlzIHRvIGhlbHAgZGVidWdnaW5nIHByb2JsZW1zIHdpdGggdGhlIHJlcGxheVxuLy8gY29kZS4gSWYgdGhlIG1lbW9yeSBjb3N0IG9mIGFsbG9jIC8gZGVhbGxvYyBnZXRzIHRvbyBtdWNoLCBkcm9wIGl0IGFuZCBqdXN0IHVzZVxuLy8gdGhlIEFycmF5QnVmZmVyIGRpcmVjdGx5LlxuY2xhc3MgQnVmZmVyRW50cnkge1xuICAgIGNvbnN0cnVjdG9yKGNodW5rLCBzZXJpYWwsIGJ5dGVPZmZzZXQpIHtcbiAgICAgICAgdGhpcy5jaHVuayA9IGNodW5rO1xuICAgICAgICB0aGlzLnNlcmlhbCA9IHNlcmlhbDtcbiAgICAgICAgdGhpcy5ieXRlT2Zmc2V0ID0gYnl0ZU9mZnNldDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVJlcGxheWFibGVBdWRpb05vZGUuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmV4cG9ydCBjbGFzcyBSZXN0Q29uZmlnQmFzZSB7XG4gICAgc3RhdGljIGdldCByZXF1ZXN0T3B0aW9ucygpIHtcbiAgICAgICAgcmV0dXJuIFJlc3RDb25maWdCYXNlLnByaXZEZWZhdWx0UmVxdWVzdE9wdGlvbnM7XG4gICAgfVxuICAgIHN0YXRpYyBnZXQgY29uZmlnUGFyYW1zKCkge1xuICAgICAgICByZXR1cm4gUmVzdENvbmZpZ0Jhc2UucHJpdkRlZmF1bHRQYXJhbXM7XG4gICAgfVxuICAgIHN0YXRpYyBnZXQgcmVzdEVycm9ycygpIHtcbiAgICAgICAgcmV0dXJuIFJlc3RDb25maWdCYXNlLnByaXZSZXN0RXJyb3JzO1xuICAgIH1cbn1cblJlc3RDb25maWdCYXNlLnByaXZEZWZhdWx0UmVxdWVzdE9wdGlvbnMgPSB7XG4gICAgaGVhZGVyczoge1xuICAgICAgICBBY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgIH0sXG4gICAgaWdub3JlQ2FjaGU6IGZhbHNlLFxuICAgIHRpbWVvdXQ6IDEwMDAwLFxufTtcblJlc3RDb25maWdCYXNlLnByaXZSZXN0RXJyb3JzID0ge1xuICAgIGF1dGhJbnZhbGlkU3Vic2NyaXB0aW9uS2V5OiBcIllvdSBtdXN0IHNwZWNpZnkgZWl0aGVyIGFuIGF1dGhlbnRpY2F0aW9uIHRva2VuIHRvIHVzZSwgb3IgYSBDb2duaXRpdmUgU3BlZWNoIHN1YnNjcmlwdGlvbiBrZXkuXCIsXG4gICAgYXV0aEludmFsaWRTdWJzY3JpcHRpb25SZWdpb246IFwiWW91IG11c3Qgc3BlY2lmeSB0aGUgQ29nbml0aXZlIFNwZWVjaCByZWdpb24gdG8gdXNlLlwiLFxuICAgIGludmFsaWRBcmdzOiBcIlJlcXVpcmVkIGlucHV0IG5vdCBmb3VuZDoge2FyZ30uXCIsXG4gICAgaW52YWxpZENyZWF0ZUpvaW5Db252ZXJzYXRpb25SZXNwb25zZTogXCJDcmVhdGluZy9Kb2luaW5nIGNvbnZlcnNhdGlvbiBmYWlsZWQgd2l0aCBIVFRQIHtzdGF0dXN9LlwiLFxuICAgIGludmFsaWRQYXJ0aWNpcGFudFJlcXVlc3Q6IFwiVGhlIHJlcXVlc3RlZCBwYXJ0aWNpcGFudCB3YXMgbm90IGZvdW5kLlwiLFxuICAgIHBlcm1pc3Npb25EZW5pZWRDb25uZWN0OiBcIlJlcXVpcmVkIGNyZWRlbnRpYWxzIG5vdCBmb3VuZC5cIixcbiAgICBwZXJtaXNzaW9uRGVuaWVkQ29udmVyc2F0aW9uOiBcIkludmFsaWQgb3BlcmF0aW9uOiBvbmx5IHRoZSBob3N0IGNhbiB7Y29tbWFuZH0gdGhlIGNvbnZlcnNhdGlvbi5cIixcbiAgICBwZXJtaXNzaW9uRGVuaWVkUGFydGljaXBhbnQ6IFwiSW52YWxpZCBvcGVyYXRpb246IG9ubHkgdGhlIGhvc3QgY2FuIHtjb21tYW5kfSBhIHBhcnRpY2lwYW50LlwiLFxuICAgIHBlcm1pc3Npb25EZW5pZWRTZW5kOiBcIkludmFsaWQgb3BlcmF0aW9uOiB0aGUgY29udmVyc2F0aW9uIGlzIG5vdCBpbiBhIGNvbm5lY3RlZCBzdGF0ZS5cIixcbiAgICBwZXJtaXNzaW9uRGVuaWVkU3RhcnQ6IFwiSW52YWxpZCBvcGVyYXRpb246IHRoZXJlIGlzIGFscmVhZHkgYW4gYWN0aXZlIGNvbnZlcnNhdGlvbi5cIixcbn07XG5SZXN0Q29uZmlnQmFzZS5wcml2RGVmYXVsdFBhcmFtcyA9IHtcbiAgICBhcGlWZXJzaW9uOiBcImFwaS12ZXJzaW9uXCIsXG4gICAgYXV0aG9yaXphdGlvbjogXCJBdXRob3JpemF0aW9uXCIsXG4gICAgY2xpZW50QXBwSWQ6IFwiWC1DbGllbnRBcHBJZFwiLFxuICAgIGNvbnRlbnRUeXBlS2V5OiBcIkNvbnRlbnQtVHlwZVwiLFxuICAgIGNvcnJlbGF0aW9uSWQ6IFwiWC1Db3JyZWxhdGlvbklkXCIsXG4gICAgbGFuZ3VhZ2VDb2RlOiBcImxhbmd1YWdlXCIsXG4gICAgbmlja25hbWU6IFwibmlja25hbWVcIixcbiAgICBwcm9mYW5pdHk6IFwicHJvZmFuaXR5XCIsXG4gICAgcmVxdWVzdElkOiBcIlgtUmVxdWVzdElkXCIsXG4gICAgcm9vbUlkOiBcInJvb21pZFwiLFxuICAgIHNlc3Npb25Ub2tlbjogXCJ0b2tlblwiLFxuICAgIHN1YnNjcmlwdGlvbktleTogXCJPY3AtQXBpbS1TdWJzY3JpcHRpb24tS2V5XCIsXG4gICAgc3Vic2NyaXB0aW9uUmVnaW9uOiBcIk9jcC1BcGltLVN1YnNjcmlwdGlvbi1SZWdpb25cIixcbiAgICB0b2tlbjogXCJYLUNhcGl0b1Rva2VuXCIsXG59O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1SZXN0Q29uZmlnQmFzZS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgYmVudCBmcm9tIFwiYmVudFwiO1xuaW1wb3J0IHsgQXJndW1lbnROdWxsRXJyb3IsIERlZmVycmVkIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5leHBvcnQgdmFyIFJlc3RSZXF1ZXN0VHlwZTtcbihmdW5jdGlvbiAoUmVzdFJlcXVlc3RUeXBlKSB7XG4gICAgUmVzdFJlcXVlc3RUeXBlW1wiR2V0XCJdID0gXCJHRVRcIjtcbiAgICBSZXN0UmVxdWVzdFR5cGVbXCJQb3N0XCJdID0gXCJQT1NUXCI7XG4gICAgUmVzdFJlcXVlc3RUeXBlW1wiRGVsZXRlXCJdID0gXCJERUxFVEVcIjtcbiAgICBSZXN0UmVxdWVzdFR5cGVbXCJGaWxlXCJdID0gXCJmaWxlXCI7XG59KShSZXN0UmVxdWVzdFR5cGUgfHwgKFJlc3RSZXF1ZXN0VHlwZSA9IHt9KSk7XG4vLyBhY2NlcHQgcmVzdCBvcGVyYXRpb25zIHZpYSByZXF1ZXN0IG1ldGhvZCBhbmQgcmV0dXJuIGFic3RyYWN0ZWQgb2JqZWN0cyBmcm9tIHNlcnZlciByZXNwb25zZVxuZXhwb3J0IGNsYXNzIFJlc3RNZXNzYWdlQWRhcHRlciB7XG4gICAgY29uc3RydWN0b3IoY29uZmlnUGFyYW1zKSB7XG4gICAgICAgIGlmICghY29uZmlnUGFyYW1zKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXJyb3IoXCJjb25maWdQYXJhbXNcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2SGVhZGVycyA9IGNvbmZpZ1BhcmFtcy5oZWFkZXJzO1xuICAgICAgICB0aGlzLnByaXZJZ25vcmVDYWNoZSA9IGNvbmZpZ1BhcmFtcy5pZ25vcmVDYWNoZTtcbiAgICB9XG4gICAgc3RhdGljIGV4dHJhY3RIZWFkZXJWYWx1ZShoZWFkZXJLZXksIGhlYWRlcnMpIHtcbiAgICAgICAgbGV0IGhlYWRlclZhbHVlID0gXCJcIjtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGFyciA9IGhlYWRlcnMudHJpbSgpLnNwbGl0KC9bXFxyXFxuXSsvKTtcbiAgICAgICAgICAgIGNvbnN0IGhlYWRlck1hcCA9IHt9O1xuICAgICAgICAgICAgYXJyLmZvckVhY2goKGxpbmUpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJ0cyA9IGxpbmUuc3BsaXQoXCI6IFwiKTtcbiAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXIgPSBwYXJ0cy5zaGlmdCgpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBwYXJ0cy5qb2luKFwiOiBcIik7XG4gICAgICAgICAgICAgICAgaGVhZGVyTWFwW2hlYWRlcl0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaGVhZGVyVmFsdWUgPSBoZWFkZXJNYXBbaGVhZGVyS2V5LnRvTG93ZXJDYXNlKCldO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAvLyBpZ25vcmUgdGhlIGVycm9yXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGhlYWRlclZhbHVlO1xuICAgIH1cbiAgICBzZXQgb3B0aW9ucyhjb25maWdQYXJhbXMpIHtcbiAgICAgICAgdGhpcy5wcml2SGVhZGVycyA9IGNvbmZpZ1BhcmFtcy5oZWFkZXJzO1xuICAgICAgICB0aGlzLnByaXZJZ25vcmVDYWNoZSA9IGNvbmZpZ1BhcmFtcy5pZ25vcmVDYWNoZTtcbiAgICB9XG4gICAgc2V0SGVhZGVycyhrZXksIHZhbHVlKSB7XG4gICAgICAgIHRoaXMucHJpdkhlYWRlcnNba2V5XSA9IHZhbHVlO1xuICAgIH1cbiAgICByZXF1ZXN0KG1ldGhvZCwgdXJpLCBxdWVyeVBhcmFtcyA9IHt9LCBib2R5ID0gbnVsbCkge1xuICAgICAgICBjb25zdCByZXNwb25zZVJlY2VpdmVkRGVmZXJyYWwgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgY29uc3QgcmVxdWVzdENvbW1hbmQgPSBtZXRob2QgPT09IFJlc3RSZXF1ZXN0VHlwZS5GaWxlID8gXCJQT1NUXCIgOiBtZXRob2Q7XG4gICAgICAgIGNvbnN0IGhhbmRsZVJlc3RSZXNwb25zZSA9IChkYXRhLCBqID0ge30pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGQgPSBkYXRhO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeShqKSxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiBKU09OLnN0cmluZ2lmeShkYXRhLmhlYWRlcnMpLFxuICAgICAgICAgICAgICAgIGpzb246IGosXG4gICAgICAgICAgICAgICAgb2s6IGRhdGEuc3RhdHVzQ29kZSA+PSAyMDAgJiYgZGF0YS5zdGF0dXNDb2RlIDwgMzAwLFxuICAgICAgICAgICAgICAgIHN0YXR1czogZGF0YS5zdGF0dXNDb2RlLFxuICAgICAgICAgICAgICAgIHN0YXR1c1RleHQ6IGouZXJyb3IgPyBqLmVycm9yLm1lc3NhZ2UgOiBkLnN0YXR1c1RleHQgPyBkLnN0YXR1c1RleHQgOiBkLnN0YXR1c01lc3NhZ2VcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHNlbmQgPSAocG9zdERhdGEpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNlbmRSZXF1ZXN0ID0gYmVudCh1cmksIHJlcXVlc3RDb21tYW5kLCB0aGlzLnByaXZIZWFkZXJzLCAyMDAsIDIwMSwgMjAyLCAyMDQsIDQwMCwgNDAxLCA0MDIsIDQwMywgNDA0KTtcbiAgICAgICAgICAgIGNvbnN0IHBhcmFtcyA9IHRoaXMucXVlcnlQYXJhbXMocXVlcnlQYXJhbXMpID09PSBcIlwiID8gXCJcIiA6IGA/JHt0aGlzLnF1ZXJ5UGFyYW1zKHF1ZXJ5UGFyYW1zKX1gO1xuICAgICAgICAgICAgc2VuZFJlcXVlc3QocGFyYW1zLCBwb3N0RGF0YSkudGhlbigoZGF0YSkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgICAgIGlmIChtZXRob2QgPT09IFJlc3RSZXF1ZXN0VHlwZS5EZWxldGUgfHwgZGF0YS5zdGF0dXNDb2RlID09PSAyMDQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTm8gSlNPTiBmcm9tIERlbGV0ZSBhbmQgcmVzZXQgKDIwNCkgb3BlcmF0aW9uc1xuICAgICAgICAgICAgICAgICAgICByZXNwb25zZVJlY2VpdmVkRGVmZXJyYWwucmVzb2x2ZShoYW5kbGVSZXN0UmVzcG9uc2UoZGF0YSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGogPSB5aWVsZCBkYXRhLmpzb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlUmVjZWl2ZWREZWZlcnJhbC5yZXNvbHZlKGhhbmRsZVJlc3RSZXNwb25zZShkYXRhLCBqKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZVJlY2VpdmVkRGVmZXJyYWwucmVzb2x2ZShoYW5kbGVSZXN0UmVzcG9uc2UoZGF0YSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIHJlc3BvbnNlUmVjZWl2ZWREZWZlcnJhbC5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLnByaXZJZ25vcmVDYWNoZSkge1xuICAgICAgICAgICAgdGhpcy5wcml2SGVhZGVyc1tcIkNhY2hlLUNvbnRyb2xcIl0gPSBcIm5vLWNhY2hlXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1ldGhvZCA9PT0gUmVzdFJlcXVlc3RUeXBlLlBvc3QgJiYgYm9keSkge1xuICAgICAgICAgICAgdGhpcy5wcml2SGVhZGVyc1tcImNvbnRlbnQtdHlwZVwiXSA9IFwiYXBwbGljYXRpb24vanNvblwiO1xuICAgICAgICAgICAgdGhpcy5wcml2SGVhZGVyc1tcIkNvbnRlbnQtVHlwZVwiXSA9IFwiYXBwbGljYXRpb24vanNvblwiO1xuICAgICAgICB9XG4gICAgICAgIHNlbmQoYm9keSk7XG4gICAgICAgIHJldHVybiByZXNwb25zZVJlY2VpdmVkRGVmZXJyYWwucHJvbWlzZTtcbiAgICB9XG4gICAgcXVlcnlQYXJhbXMocGFyYW1zID0ge30pIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHBhcmFtcylcbiAgICAgICAgICAgIC5tYXAoKGspID0+IGVuY29kZVVSSUNvbXBvbmVudChrKSArIFwiPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KHBhcmFtc1trXSkpXG4gICAgICAgICAgICAuam9pbihcIiZcIik7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1SZXN0TWVzc2FnZUFkYXB0ZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgQXJndW1lbnROdWxsRXJyb3IsIGNyZWF0ZU5vRGFzaEd1aWQsIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBXZWJzb2NrZXRNZXNzYWdlQWRhcHRlciB9IGZyb20gXCIuL1dlYnNvY2tldE1lc3NhZ2VBZGFwdGVyXCI7XG5leHBvcnQgY2xhc3MgV2Vic29ja2V0Q29ubmVjdGlvbiB7XG4gICAgY29uc3RydWN0b3IodXJpLCBxdWVyeVBhcmFtZXRlcnMsIGhlYWRlcnMsIG1lc3NhZ2VGb3JtYXR0ZXIsIHByb3h5SW5mbywgZW5hYmxlQ29tcHJlc3Npb24gPSBmYWxzZSwgY29ubmVjdGlvbklkKSB7XG4gICAgICAgIHRoaXMucHJpdklzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICAgICAgaWYgKCF1cmkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBcmd1bWVudE51bGxFcnJvcihcInVyaVwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW1lc3NhZ2VGb3JtYXR0ZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBcmd1bWVudE51bGxFcnJvcihcIm1lc3NhZ2VGb3JtYXR0ZXJcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2TWVzc2FnZUZvcm1hdHRlciA9IG1lc3NhZ2VGb3JtYXR0ZXI7XG4gICAgICAgIGxldCBxdWVyeVBhcmFtcyA9IFwiXCI7XG4gICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgaWYgKHF1ZXJ5UGFyYW1ldGVycykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBwYXJhbU5hbWUgaW4gcXVlcnlQYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcmFtTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBxdWVyeVBhcmFtcyArPSAoKGkgPT09IDApICYmICh1cmkuaW5kZXhPZihcIj9cIikgPT09IC0xKSkgPyBcIj9cIiA6IFwiJlwiO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBlbmNvZGVVUklDb21wb25lbnQocGFyYW1OYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlQYXJhbXMgKz0ga2V5O1xuICAgICAgICAgICAgICAgICAgICBsZXQgdmFsID0gcXVlcnlQYXJhbWV0ZXJzW3BhcmFtTmFtZV07XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbCA9IGVuY29kZVVSSUNvbXBvbmVudCh2YWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlQYXJhbXMgKz0gYD0ke3ZhbH1gO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhlYWRlcnMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgaGVhZGVyTmFtZSBpbiBoZWFkZXJzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGhlYWRlck5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlQYXJhbXMgKz0gKChpID09PSAwKSAmJiAodXJpLmluZGV4T2YoXCI/XCIpID09PSAtMSkpID8gXCI/XCIgOiBcIiZcIjtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsID0gZW5jb2RlVVJJQ29tcG9uZW50KGhlYWRlcnNbaGVhZGVyTmFtZV0pO1xuICAgICAgICAgICAgICAgICAgICBxdWVyeVBhcmFtcyArPSBgJHtoZWFkZXJOYW1lfT0ke3ZhbH1gO1xuICAgICAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdlVyaSA9IHVyaSArIHF1ZXJ5UGFyYW1zO1xuICAgICAgICB0aGlzLnByaXZJZCA9IGNvbm5lY3Rpb25JZCA/IGNvbm5lY3Rpb25JZCA6IGNyZWF0ZU5vRGFzaEd1aWQoKTtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbk1lc3NhZ2VBZGFwdGVyID0gbmV3IFdlYnNvY2tldE1lc3NhZ2VBZGFwdGVyKHRoaXMucHJpdlVyaSwgdGhpcy5pZCwgdGhpcy5wcml2TWVzc2FnZUZvcm1hdHRlciwgcHJveHlJbmZvLCBoZWFkZXJzLCBlbmFibGVDb21wcmVzc2lvbik7XG4gICAgfVxuICAgIGRpc3Bvc2UoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZDb25uZWN0aW9uTWVzc2FnZUFkYXB0ZXIpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZDb25uZWN0aW9uTWVzc2FnZUFkYXB0ZXIuY2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGlzRGlzcG9zZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJc0Rpc3Bvc2VkO1xuICAgIH1cbiAgICBnZXQgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJZDtcbiAgICB9XG4gICAgZ2V0IHVyaSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlVyaTtcbiAgICB9XG4gICAgc3RhdGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uTWVzc2FnZUFkYXB0ZXIuc3RhdGU7XG4gICAgfVxuICAgIG9wZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uTWVzc2FnZUFkYXB0ZXIub3BlbigpO1xuICAgIH1cbiAgICBzZW5kKG1lc3NhZ2UpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25NZXNzYWdlQWRhcHRlci5zZW5kKG1lc3NhZ2UpO1xuICAgIH1cbiAgICByZWFkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvbk1lc3NhZ2VBZGFwdGVyLnJlYWQoKTtcbiAgICB9XG4gICAgZ2V0IGV2ZW50cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25NZXNzYWdlQWRhcHRlci5ldmVudHM7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1XZWJzb2NrZXRDb25uZWN0aW9uLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCAqIGFzIG5ldCBmcm9tIFwibmV0XCI7XG5pbXBvcnQgKiBhcyB0bHMgZnJvbSBcInRsc1wiO1xuaW1wb3J0IEFnZW50IGZyb20gXCJhZ2VudC1iYXNlXCI7XG5pbXBvcnQgSHR0cHNQcm94eUFnZW50IGZyb20gXCJodHRwcy1wcm94eS1hZ2VudFwiO1xuaW1wb3J0IHdzIGZyb20gXCJ3c1wiO1xuaW1wb3J0IHsgSGVhZGVyTmFtZXMgfSBmcm9tIFwiLi4vY29tbW9uLnNwZWVjaC9IZWFkZXJOYW1lc1wiO1xuaW1wb3J0IHsgQXJndW1lbnROdWxsRXJyb3IsIEJhY2tncm91bmRFdmVudCwgQ29ubmVjdGlvbkNsb3NlZEV2ZW50LCBDb25uZWN0aW9uRXJyb3JFdmVudCwgQ29ubmVjdGlvbkVzdGFibGlzaGVkRXZlbnQsIENvbm5lY3Rpb25NZXNzYWdlUmVjZWl2ZWRFdmVudCwgQ29ubmVjdGlvbk1lc3NhZ2VTZW50RXZlbnQsIENvbm5lY3Rpb25PcGVuUmVzcG9uc2UsIENvbm5lY3Rpb25TdGFydEV2ZW50LCBDb25uZWN0aW9uU3RhdGUsIERlZmVycmVkLCBFdmVudHMsIEV2ZW50U291cmNlLCBNZXNzYWdlVHlwZSwgUXVldWUsIFJhd1dlYnNvY2tldE1lc3NhZ2UsIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5leHBvcnQgY2xhc3MgV2Vic29ja2V0TWVzc2FnZUFkYXB0ZXIge1xuICAgIGNvbnN0cnVjdG9yKHVyaSwgY29ubmVjdGlvbklkLCBtZXNzYWdlRm9ybWF0dGVyLCBwcm94eUluZm8sIGhlYWRlcnMsIGVuYWJsZUNvbXByZXNzaW9uKSB7XG4gICAgICAgIGlmICghdXJpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXJyb3IoXCJ1cmlcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFtZXNzYWdlRm9ybWF0dGVyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXJyb3IoXCJtZXNzYWdlRm9ybWF0dGVyXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJveHlJbmZvID0gcHJveHlJbmZvO1xuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uRXZlbnRzID0gbmV3IEV2ZW50U291cmNlKCk7XG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25JZCA9IGNvbm5lY3Rpb25JZDtcbiAgICAgICAgdGhpcy5wcml2TWVzc2FnZUZvcm1hdHRlciA9IG1lc3NhZ2VGb3JtYXR0ZXI7XG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25TdGF0ZSA9IENvbm5lY3Rpb25TdGF0ZS5Ob25lO1xuICAgICAgICB0aGlzLnByaXZVcmkgPSB1cmk7XG4gICAgICAgIHRoaXMucHJpdkhlYWRlcnMgPSBoZWFkZXJzO1xuICAgICAgICB0aGlzLnByaXZFbmFibGVDb21wcmVzc2lvbiA9IGVuYWJsZUNvbXByZXNzaW9uO1xuICAgICAgICAvLyBBZGQgdGhlIGNvbm5lY3Rpb24gSUQgdG8gdGhlIGhlYWRlcnNcbiAgICAgICAgdGhpcy5wcml2SGVhZGVyc1tIZWFkZXJOYW1lcy5Db25uZWN0aW9uSWRdID0gdGhpcy5wcml2Q29ubmVjdGlvbklkO1xuICAgICAgICB0aGlzLnByaXZMYXN0RXJyb3JSZWNlaXZlZCA9IFwiXCI7XG4gICAgfVxuICAgIGdldCBzdGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25TdGF0ZTtcbiAgICB9XG4gICAgb3BlbigpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdkNvbm5lY3Rpb25TdGF0ZSA9PT0gQ29ubmVjdGlvblN0YXRlLkRpc2Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBDYW5ub3Qgb3BlbiBhIGNvbm5lY3Rpb24gdGhhdCBpcyBpbiAke3RoaXMucHJpdkNvbm5lY3Rpb25TdGF0ZX0gc3RhdGVgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wcml2Q29ubmVjdGlvbkVzdGFibGlzaERlZmVycmFsKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvbkVzdGFibGlzaERlZmVycmFsLnByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkVzdGFibGlzaERlZmVycmFsID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgIHRoaXMucHJpdkNlcnRpZmljYXRlVmFsaWRhdGVkRGVmZXJyYWwgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvblN0YXRlID0gQ29ubmVjdGlvblN0YXRlLkNvbm5lY3Rpbmc7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIFdlYlNvY2tldCAhPT0gXCJ1bmRlZmluZWRcIiAmJiAhV2Vic29ja2V0TWVzc2FnZUFkYXB0ZXIuZm9yY2VOcG1XZWJTb2NrZXQpIHtcbiAgICAgICAgICAgICAgICAvLyBCcm93c2VyIGhhbmRsZXMgY2VydCBjaGVja3MuXG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q2VydGlmaWNhdGVWYWxpZGF0ZWREZWZlcnJhbC5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2V2Vic29ja2V0Q2xpZW50ID0gbmV3IFdlYlNvY2tldCh0aGlzLnByaXZVcmkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHsgaGVhZGVyczogdGhpcy5wcml2SGVhZGVycywgcGVyTWVzc2FnZURlZmxhdGU6IHRoaXMucHJpdkVuYWJsZUNvbXByZXNzaW9uIH07XG4gICAgICAgICAgICAgICAgLy8gVGhlIG9jc3AgbGlicmFyeSB3aWxsIGhhbmRsZSB2YWxpZGF0aW9uIGZvciB1cyBhbmQgZmFpbCB0aGUgY29ubmVjdGlvbiBpZiBuZWVkZWQuXG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q2VydGlmaWNhdGVWYWxpZGF0ZWREZWZlcnJhbC5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgb3B0aW9ucy5hZ2VudCA9IHRoaXMuZ2V0QWdlbnQoKTtcbiAgICAgICAgICAgICAgICAvLyBXb3JrYXJvdW5kIGZvciBodHRwczovL2dpdGh1Yi5jb20vbWljcm9zb2Z0L2NvZ25pdGl2ZS1zZXJ2aWNlcy1zcGVlY2gtc2RrLWpzL2lzc3Vlcy80NjVcbiAgICAgICAgICAgICAgICAvLyBXaGljaCBpcyByb290IGNhdXNlZCBieSBodHRwczovL2dpdGh1Yi5jb20vVG9vVGFsbE5hdGUvbm9kZS1hZ2VudC1iYXNlL2lzc3Vlcy82MVxuICAgICAgICAgICAgICAgIGNvbnN0IHVyaSA9IG5ldyBVUkwodGhpcy5wcml2VXJpKTtcbiAgICAgICAgICAgICAgICBsZXQgcHJvdG9jb2wgPSB1cmkucHJvdG9jb2w7XG4gICAgICAgICAgICAgICAgaWYgKChwcm90b2NvbCA9PT0gbnVsbCB8fCBwcm90b2NvbCA9PT0gdm9pZCAwID8gdm9pZCAwIDogcHJvdG9jb2wudG9Mb2NhbGVMb3dlckNhc2UoKSkgPT09IFwid3NzOlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb3RvY29sID0gXCJodHRwczpcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoKHByb3RvY29sID09PSBudWxsIHx8IHByb3RvY29sID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwcm90b2NvbC50b0xvY2FsZUxvd2VyQ2FzZSgpKSA9PT0gXCJ3czpcIikge1xuICAgICAgICAgICAgICAgICAgICBwcm90b2NvbCA9IFwiaHR0cDpcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtbWVtYmVyLWFjY2Vzc1xuICAgICAgICAgICAgICAgIG9wdGlvbnMuYWdlbnQucHJvdG9jb2wgPSBwcm90b2NvbDtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZXZWJzb2NrZXRDbGllbnQgPSBuZXcgd3ModGhpcy5wcml2VXJpLCBvcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucHJpdldlYnNvY2tldENsaWVudC5iaW5hcnlUeXBlID0gXCJhcnJheWJ1ZmZlclwiO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVjZWl2aW5nTWVzc2FnZVF1ZXVlID0gbmV3IFF1ZXVlKCk7XG4gICAgICAgICAgICB0aGlzLnByaXZEaXNjb25uZWN0RGVmZXJyYWwgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgICAgIHRoaXMucHJpdlNlbmRNZXNzYWdlUXVldWUgPSBuZXcgUXVldWUoKTtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc1NlbmRRdWV1ZSgpLmNhdGNoKChyZWFzb24pID0+IHtcbiAgICAgICAgICAgICAgICBFdmVudHMuaW5zdGFuY2Uub25FdmVudChuZXcgQmFja2dyb3VuZEV2ZW50KHJlYXNvbikpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uRXN0YWJsaXNoRGVmZXJyYWwucmVzb2x2ZShuZXcgQ29ubmVjdGlvbk9wZW5SZXNwb25zZSg1MDAsIGVycm9yKSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvbkVzdGFibGlzaERlZmVycmFsLnByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBDb25uZWN0aW9uU3RhcnRFdmVudCh0aGlzLnByaXZDb25uZWN0aW9uSWQsIHRoaXMucHJpdlVyaSkpO1xuICAgICAgICB0aGlzLnByaXZXZWJzb2NrZXRDbGllbnQub25vcGVuID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcml2Q2VydGlmaWNhdGVWYWxpZGF0ZWREZWZlcnJhbC5wcm9taXNlLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25TdGF0ZSA9IENvbm5lY3Rpb25TdGF0ZS5Db25uZWN0ZWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBDb25uZWN0aW9uRXN0YWJsaXNoZWRFdmVudCh0aGlzLnByaXZDb25uZWN0aW9uSWQpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uRXN0YWJsaXNoRGVmZXJyYWwucmVzb2x2ZShuZXcgQ29ubmVjdGlvbk9wZW5SZXNwb25zZSgyMDAsIFwiXCIpKTtcbiAgICAgICAgICAgIH0sIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Fc3RhYmxpc2hEZWZlcnJhbC5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucHJpdldlYnNvY2tldENsaWVudC5vbmVycm9yID0gKGUpID0+IHtcbiAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgQ29ubmVjdGlvbkVycm9yRXZlbnQodGhpcy5wcml2Q29ubmVjdGlvbklkLCBlLm1lc3NhZ2UsIGUudHlwZSkpO1xuICAgICAgICAgICAgdGhpcy5wcml2TGFzdEVycm9yUmVjZWl2ZWQgPSBlLm1lc3NhZ2U7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucHJpdldlYnNvY2tldENsaWVudC5vbmNsb3NlID0gKGUpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZDb25uZWN0aW9uU3RhdGUgPT09IENvbm5lY3Rpb25TdGF0ZS5Db25uZWN0aW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvblN0YXRlID0gQ29ubmVjdGlvblN0YXRlLkRpc2Nvbm5lY3RlZDtcbiAgICAgICAgICAgICAgICAvLyB0aGlzLm9uRXZlbnQobmV3IENvbm5lY3Rpb25Fc3RhYmxpc2hFcnJvckV2ZW50KHRoaXMuY29ubmVjdGlvbklkLCBlLmNvZGUsIGUucmVhc29uKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkVzdGFibGlzaERlZmVycmFsLnJlc29sdmUobmV3IENvbm5lY3Rpb25PcGVuUmVzcG9uc2UoZS5jb2RlLCBlLnJlYXNvbiArIFwiIFwiICsgdGhpcy5wcml2TGFzdEVycm9yUmVjZWl2ZWQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25TdGF0ZSA9IENvbm5lY3Rpb25TdGF0ZS5EaXNjb25uZWN0ZWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2V2Vic29ja2V0Q2xpZW50ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLm9uRXZlbnQobmV3IENvbm5lY3Rpb25DbG9zZWRFdmVudCh0aGlzLnByaXZDb25uZWN0aW9uSWQsIGUuY29kZSwgZS5yZWFzb24pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMub25DbG9zZShlLmNvZGUsIGUucmVhc29uKS5jYXRjaCgocmVhc29uKSA9PiB7XG4gICAgICAgICAgICAgICAgRXZlbnRzLmluc3RhbmNlLm9uRXZlbnQobmV3IEJhY2tncm91bmRFdmVudChyZWFzb24pKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnByaXZXZWJzb2NrZXRDbGllbnQub25tZXNzYWdlID0gKGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5ldHdvcmtSZWNlaXZlZFRpbWUgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2Q29ubmVjdGlvblN0YXRlID09PSBDb25uZWN0aW9uU3RhdGUuQ29ubmVjdGVkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgICAgICAgICAvLyBsZXQgaWQgPSArK3RoaXMuaWRDb3VudGVyO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlY2VpdmluZ01lc3NhZ2VRdWV1ZS5lbnF1ZXVlRnJvbVByb21pc2UoZGVmZXJyZWQucHJvbWlzZSk7XG4gICAgICAgICAgICAgICAgaWYgKGUuZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJhd01lc3NhZ2UgPSBuZXcgUmF3V2Vic29ja2V0TWVzc2FnZShNZXNzYWdlVHlwZS5CaW5hcnksIGUuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdk1lc3NhZ2VGb3JtYXR0ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50b0Nvbm5lY3Rpb25NZXNzYWdlKHJhd01lc3NhZ2UpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbigoY29ubmVjdGlvbk1lc3NhZ2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgQ29ubmVjdGlvbk1lc3NhZ2VSZWNlaXZlZEV2ZW50KHRoaXMucHJpdkNvbm5lY3Rpb25JZCwgbmV0d29ya1JlY2VpdmVkVGltZSwgY29ubmVjdGlvbk1lc3NhZ2UpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoY29ubmVjdGlvbk1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICB9LCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IEV2ZW50cyBmb3IgdGhlc2UgP1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGBJbnZhbGlkIGJpbmFyeSBtZXNzYWdlIGZvcm1hdC4gRXJyb3I6ICR7ZXJyb3J9YCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmF3TWVzc2FnZSA9IG5ldyBSYXdXZWJzb2NrZXRNZXNzYWdlKE1lc3NhZ2VUeXBlLlRleHQsIGUuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdk1lc3NhZ2VGb3JtYXR0ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50b0Nvbm5lY3Rpb25NZXNzYWdlKHJhd01lc3NhZ2UpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbigoY29ubmVjdGlvbk1lc3NhZ2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgQ29ubmVjdGlvbk1lc3NhZ2VSZWNlaXZlZEV2ZW50KHRoaXMucHJpdkNvbm5lY3Rpb25JZCwgbmV0d29ya1JlY2VpdmVkVGltZSwgY29ubmVjdGlvbk1lc3NhZ2UpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoY29ubmVjdGlvbk1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICB9LCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IEV2ZW50cyBmb3IgdGhlc2UgP1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGBJbnZhbGlkIHRleHQgbWVzc2FnZSBmb3JtYXQuIEVycm9yOiAke2Vycm9yfWApO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uRXN0YWJsaXNoRGVmZXJyYWwucHJvbWlzZTtcbiAgICB9XG4gICAgc2VuZChtZXNzYWdlKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZDb25uZWN0aW9uU3RhdGUgIT09IENvbm5lY3Rpb25TdGF0ZS5Db25uZWN0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgQ2Fubm90IHNlbmQgb24gY29ubmVjdGlvbiB0aGF0IGlzIGluICR7Q29ubmVjdGlvblN0YXRlW3RoaXMucHJpdkNvbm5lY3Rpb25TdGF0ZV19IHN0YXRlYCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbWVzc2FnZVNlbmRTdGF0dXNEZWZlcnJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICBjb25zdCBtZXNzYWdlU2VuZERlZmVycmFsID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgIHRoaXMucHJpdlNlbmRNZXNzYWdlUXVldWUuZW5xdWV1ZUZyb21Qcm9taXNlKG1lc3NhZ2VTZW5kRGVmZXJyYWwucHJvbWlzZSk7XG4gICAgICAgIHRoaXMucHJpdk1lc3NhZ2VGb3JtYXR0ZXJcbiAgICAgICAgICAgIC5mcm9tQ29ubmVjdGlvbk1lc3NhZ2UobWVzc2FnZSlcbiAgICAgICAgICAgIC50aGVuKChyYXdNZXNzYWdlKSA9PiB7XG4gICAgICAgICAgICBtZXNzYWdlU2VuZERlZmVycmFsLnJlc29sdmUoe1xuICAgICAgICAgICAgICAgIE1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgUmF3V2Vic29ja2V0TWVzc2FnZTogcmF3TWVzc2FnZSxcbiAgICAgICAgICAgICAgICBzZW5kU3RhdHVzRGVmZXJyYWw6IG1lc3NhZ2VTZW5kU3RhdHVzRGVmZXJyYWwsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSwgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBtZXNzYWdlU2VuZERlZmVycmFsLnJlamVjdChgRXJyb3IgZm9ybWF0dGluZyB0aGUgbWVzc2FnZS4gJHtlcnJvcn1gKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBtZXNzYWdlU2VuZFN0YXR1c0RlZmVycmFsLnByb21pc2U7XG4gICAgfVxuICAgIHJlYWQoKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZDb25uZWN0aW9uU3RhdGUgIT09IENvbm5lY3Rpb25TdGF0ZS5Db25uZWN0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgQ2Fubm90IHJlYWQgb24gY29ubmVjdGlvbiB0aGF0IGlzIGluICR7dGhpcy5wcml2Q29ubmVjdGlvblN0YXRlfSBzdGF0ZWApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZWNlaXZpbmdNZXNzYWdlUXVldWUuZGVxdWV1ZSgpO1xuICAgIH1cbiAgICBjbG9zZShyZWFzb24pIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdldlYnNvY2tldENsaWVudCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdkNvbm5lY3Rpb25TdGF0ZSAhPT0gQ29ubmVjdGlvblN0YXRlLkRpc2Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdldlYnNvY2tldENsaWVudC5jbG9zZSgxMDAwLCByZWFzb24gPyByZWFzb24gOiBcIk5vcm1hbCBjbG9zdXJlIGJ5IGNsaWVudFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5wcml2RGlzY29ubmVjdERlZmVycmFsLnByb21pc2U7XG4gICAgfVxuICAgIGdldCBldmVudHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uRXZlbnRzO1xuICAgIH1cbiAgICBzZW5kUmF3TWVzc2FnZShzZW5kSXRlbSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gaW5kaWNhdGVzIHdlIGFyZSBkcmFpbmluZyB0aGUgcXVldWUgYW5kIGl0IGNhbWUgd2l0aCBubyBtZXNzYWdlO1xuICAgICAgICAgICAgaWYgKCFzZW5kSXRlbSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgQ29ubmVjdGlvbk1lc3NhZ2VTZW50RXZlbnQodGhpcy5wcml2Q29ubmVjdGlvbklkLCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksIHNlbmRJdGVtLk1lc3NhZ2UpKTtcbiAgICAgICAgICAgIC8vIGFkZCBhIGNoZWNrIGZvciB0aGUgd3MgcmVhZHlzdGF0ZSBpbiBvcmRlciB0byBzdG9wIHRoZSByZWQgY29uc29sZSBlcnJvciAnV2ViU29ja2V0IGlzIGFscmVhZHkgaW4gQ0xPU0lORyBvciBDTE9TRUQgc3RhdGUnIGFwcGVhcmluZ1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNXZWJzb2NrZXRPcGVuKSB7XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtYXJndW1lbnRcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZXZWJzb2NrZXRDbGllbnQuc2VuZChzZW5kSXRlbS5SYXdXZWJzb2NrZXRNZXNzYWdlLnBheWxvYWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KFwid2Vic29ja2V0IHNlbmQgZXJyb3I6IFdlYnNvY2tldCBub3QgcmVhZHkgXCIgKyB0aGlzLnByaXZDb25uZWN0aW9uSWQgKyBcIiBcIiArIHNlbmRJdGVtLk1lc3NhZ2UuaWQgKyBcIiBcIiArIG5ldyBFcnJvcigpLnN0YWNrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGB3ZWJzb2NrZXQgc2VuZCBlcnJvcjogJHtlfWApO1xuICAgICAgICB9XG4gICAgfVxuICAgIG9uQ2xvc2UoY29kZSwgcmVhc29uKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBjb25zdCBjbG9zZVJlYXNvbiA9IGBDb25uZWN0aW9uIGNsb3NlZC4gJHtjb2RlfTogJHtyZWFzb259YDtcbiAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25TdGF0ZSA9IENvbm5lY3Rpb25TdGF0ZS5EaXNjb25uZWN0ZWQ7XG4gICAgICAgICAgICB0aGlzLnByaXZEaXNjb25uZWN0RGVmZXJyYWwucmVzb2x2ZSgpO1xuICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2UmVjZWl2aW5nTWVzc2FnZVF1ZXVlLmRyYWluQW5kRGlzcG9zZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gVE9ETzogRXZlbnRzIGZvciB0aGVzZSA/XG4gICAgICAgICAgICAgICAgLy8gTG9nZ2VyLmluc3RhbmNlLm9uRXZlbnQobmV3IExvZ2dpbmdFdmVudChMb2dUeXBlLldhcm5pbmcsIG51bGwsIGBGYWlsZWQgdG8gcHJvY2VzcyByZWNlaXZlZCBtZXNzYWdlLiBSZWFzb246ICR7Y2xvc2VSZWFzb259LCBNZXNzYWdlOiAke0pTT04uc3RyaW5naWZ5KHBlbmRpbmdSZWNlaXZlSXRlbSl9YCkpO1xuICAgICAgICAgICAgfSwgY2xvc2VSZWFzb24pO1xuICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2U2VuZE1lc3NhZ2VRdWV1ZS5kcmFpbkFuZERpc3Bvc2UoKHBlbmRpbmdTZW5kSXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIHBlbmRpbmdTZW5kSXRlbS5zZW5kU3RhdHVzRGVmZXJyYWwucmVqZWN0KGNsb3NlUmVhc29uKTtcbiAgICAgICAgICAgIH0sIGNsb3NlUmVhc29uKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHByb2Nlc3NTZW5kUXVldWUoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW1Ub1NlbmQgPSB0aGlzLnByaXZTZW5kTWVzc2FnZVF1ZXVlLmRlcXVldWUoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBzZW5kSXRlbSA9IHlpZWxkIGl0ZW1Ub1NlbmQ7XG4gICAgICAgICAgICAgICAgLy8gaW5kaWNhdGVzIHdlIGFyZSBkcmFpbmluZyB0aGUgcXVldWUgYW5kIGl0IGNhbWUgd2l0aCBubyBtZXNzYWdlO1xuICAgICAgICAgICAgICAgIGlmICghc2VuZEl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnNlbmRSYXdNZXNzYWdlKHNlbmRJdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgc2VuZEl0ZW0uc2VuZFN0YXR1c0RlZmVycmFsLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKHNlbmRFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBzZW5kSXRlbS5zZW5kU3RhdHVzRGVmZXJyYWwucmVqZWN0KHNlbmRFcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgb25FdmVudChldmVudCkge1xuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uRXZlbnRzLm9uRXZlbnQoZXZlbnQpO1xuICAgICAgICBFdmVudHMuaW5zdGFuY2Uub25FdmVudChldmVudCk7XG4gICAgfVxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICBnZXRBZ2VudCgpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC91bmJvdW5kLW1ldGhvZFxuICAgICAgICBjb25zdCBhZ2VudCA9IG5ldyBBZ2VudC5BZ2VudCh0aGlzLmNyZWF0ZUNvbm5lY3Rpb24pO1xuICAgICAgICBpZiAodGhpcy5wcm94eUluZm8gIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgdGhpcy5wcm94eUluZm8uSG9zdE5hbWUgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgdGhpcy5wcm94eUluZm8uUG9ydCA+IDApIHtcbiAgICAgICAgICAgIGFnZW50LnByb3h5SW5mbyA9IHRoaXMucHJveHlJbmZvO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhZ2VudDtcbiAgICB9XG4gICAgc3RhdGljIEdldFByb3h5QWdlbnQocHJveHlJbmZvKSB7XG4gICAgICAgIGNvbnN0IGh0dHBQcm94eU9wdGlvbnMgPSB7XG4gICAgICAgICAgICBob3N0OiBwcm94eUluZm8uSG9zdE5hbWUsXG4gICAgICAgICAgICBwb3J0OiBwcm94eUluZm8uUG9ydCxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCEhcHJveHlJbmZvLlVzZXJOYW1lKSB7XG4gICAgICAgICAgICBodHRwUHJveHlPcHRpb25zLmhlYWRlcnMgPSB7XG4gICAgICAgICAgICAgICAgXCJQcm94eS1BdXRoZW50aWNhdGlvblwiOiBcIkJhc2ljIFwiICsgbmV3IEJ1ZmZlcihgJHtwcm94eUluZm8uVXNlck5hbWV9OiR7KHByb3h5SW5mby5QYXNzd29yZCA9PT0gdW5kZWZpbmVkKSA/IFwiXCIgOiBwcm94eUluZm8uUGFzc3dvcmR9YCkudG9TdHJpbmcoXCJiYXNlNjRcIiksXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaHR0cFByb3h5T3B0aW9ucy5oZWFkZXJzID0ge307XG4gICAgICAgIH1cbiAgICAgICAgaHR0cFByb3h5T3B0aW9ucy5oZWFkZXJzLnJlcXVlc3RPQ1NQID0gXCJ0cnVlXCI7XG4gICAgICAgIGNvbnN0IGh0dHBQcm94eUFnZW50ID0gbmV3IEh0dHBzUHJveHlBZ2VudChodHRwUHJveHlPcHRpb25zKTtcbiAgICAgICAgcmV0dXJuIGh0dHBQcm94eUFnZW50O1xuICAgIH1cbiAgICBjcmVhdGVDb25uZWN0aW9uKHJlcXVlc3QsIG9wdGlvbnMpIHtcbiAgICAgICAgbGV0IHNvY2tldFByb21pc2U7XG4gICAgICAgIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMpLCB7XG4gICAgICAgICAgICByZXF1ZXN0T0NTUDogdHJ1ZSxcbiAgICAgICAgICAgIHNlcnZlcm5hbWU6IG9wdGlvbnMuaG9zdFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKCEhdGhpcy5wcm94eUluZm8pIHtcbiAgICAgICAgICAgIGNvbnN0IGh0dHBQcm94eUFnZW50ID0gV2Vic29ja2V0TWVzc2FnZUFkYXB0ZXIuR2V0UHJveHlBZ2VudCh0aGlzLnByb3h5SW5mbyk7XG4gICAgICAgICAgICBjb25zdCBiYXNlQWdlbnQgPSBodHRwUHJveHlBZ2VudDtcbiAgICAgICAgICAgIHNvY2tldFByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgYmFzZUFnZW50LmNhbGxiYWNrKHJlcXVlc3QsIG9wdGlvbnMsIChlcnJvciwgc29ja2V0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghIWVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzb2NrZXQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICghIW9wdGlvbnMuc2VjdXJlRW5kcG9pbnQpIHtcbiAgICAgICAgICAgICAgICBzb2NrZXRQcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKHRscy5jb25uZWN0KG9wdGlvbnMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHNvY2tldFByb21pc2UgPSBQcm9taXNlLnJlc29sdmUobmV0LmNvbm5lY3Qob3B0aW9ucykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzb2NrZXRQcm9taXNlO1xuICAgIH1cbiAgICBnZXQgaXNXZWJzb2NrZXRPcGVuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2V2Vic29ja2V0Q2xpZW50ICYmIHRoaXMucHJpdldlYnNvY2tldENsaWVudC5yZWFkeVN0YXRlID09PSB0aGlzLnByaXZXZWJzb2NrZXRDbGllbnQuT1BFTjtcbiAgICB9XG59XG5XZWJzb2NrZXRNZXNzYWdlQWRhcHRlci5mb3JjZU5wbVdlYlNvY2tldCA9IGZhbHNlO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1XZWJzb2NrZXRNZXNzYWdlQWRhcHRlci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBAY2xhc3MgQWRkZWRMbUludGVudFxuICovXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWNsYXNzZXMtcGVyLWZpbGVcbmV4cG9ydCBjbGFzcyBBZGRlZExtSW50ZW50IHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSBtb2RlbEltcGwgLSBUaGUgbW9kZWwuXG4gICAgICogQHBhcmFtIGludGVudE5hbWUgLSBUaGUgaW50ZW50IG5hbWUuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IobW9kZWxJbXBsLCBpbnRlbnROYW1lKSB7XG4gICAgICAgIHRoaXMubW9kZWxJbXBsID0gbW9kZWxJbXBsO1xuICAgICAgICB0aGlzLmludGVudE5hbWUgPSBpbnRlbnROYW1lO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QWRkZWRMbUludGVudC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBSZXByZXNlbnRzIHRoZSBKU09OIHVzZWQgaW4gdGhlIGFnZW50LmNvbmZpZyBtZXNzYWdlIHNlbnQgdG8gdGhlIHNwZWVjaCBzZXJ2aWNlLlxuICovXG5leHBvcnQgY2xhc3MgQWdlbnRDb25maWcge1xuICAgIHRvSnNvblN0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMuaVByaXZDb25maWcpO1xuICAgIH1cbiAgICBnZXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlQcml2Q29uZmlnO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXR0ZXIgZm9yIHRoZSBhZ2VudC5jb25maWcgb2JqZWN0LlxuICAgICAqIEBwYXJhbSB2YWx1ZSBhIEpTT04gc2VyaWFsaXphYmxlIG9iamVjdC5cbiAgICAgKi9cbiAgICBzZXQodmFsdWUpIHtcbiAgICAgICAgdGhpcy5pUHJpdkNvbmZpZyA9IHZhbHVlO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QWdlbnRDb25maWcuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IEFyZ3VtZW50TnVsbEVycm9yLCB9IGZyb20gXCIuLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgSGVhZGVyTmFtZXMgfSBmcm9tIFwiLi9IZWFkZXJOYW1lc1wiO1xuaW1wb3J0IHsgQXV0aEluZm8gfSBmcm9tIFwiLi9JQXV0aGVudGljYXRpb25cIjtcbi8qKlxuICogQGNsYXNzXG4gKi9cbmV4cG9ydCBjbGFzcyBDb2duaXRpdmVTdWJzY3JpcHRpb25LZXlBdXRoZW50aWNhdGlvbiB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhlIENvZ25pdGl2ZVN1YnNjcmlwdGlvbktleUF1dGhlbnRpY2F0aW9uIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzdWJzY3JpcHRpb25LZXkgLSBUaGUgc3Vic2NyaXB0aW9uIGtleVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHN1YnNjcmlwdGlvbktleSkge1xuICAgICAgICBpZiAoIXN1YnNjcmlwdGlvbktleSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50TnVsbEVycm9yKFwic3Vic2NyaXB0aW9uS2V5XCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdkF1dGhJbmZvID0gbmV3IEF1dGhJbmZvKEhlYWRlck5hbWVzLkF1dGhLZXksIHN1YnNjcmlwdGlvbktleSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZldGNoZXMgdGhlIHN1YnNjcmlwdGlvbiBrZXkuXG4gICAgICogQG1lbWJlclxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gYXV0aEZldGNoRXZlbnRJZCAtIFRoZSBpZCB0byBmZXRjaC5cbiAgICAgKi9cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gICAgZmV0Y2goYXV0aEZldGNoRXZlbnRJZCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMucHJpdkF1dGhJbmZvKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRmV0Y2hlcyB0aGUgc3Vic2NyaXB0aW9uIGtleS5cbiAgICAgKiBAbWVtYmVyXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhdXRoRmV0Y2hFdmVudElkIC0gVGhlIGlkIHRvIGZldGNoLlxuICAgICAqL1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICBmZXRjaE9uRXhwaXJ5KGF1dGhGZXRjaEV2ZW50SWQpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLnByaXZBdXRoSW5mbyk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db2duaXRpdmVTdWJzY3JpcHRpb25LZXlBdXRoZW50aWNhdGlvbi5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgQXJndW1lbnROdWxsRXJyb3IgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IEF1dGhJbmZvIH0gZnJvbSBcIi4vSUF1dGhlbnRpY2F0aW9uXCI7XG5pbXBvcnQgeyBIZWFkZXJOYW1lcyB9IGZyb20gXCIuL0hlYWRlck5hbWVzXCI7XG5leHBvcnQgY2xhc3MgQ29nbml0aXZlVG9rZW5BdXRoZW50aWNhdGlvbiB7XG4gICAgY29uc3RydWN0b3IoZmV0Y2hDYWxsYmFjaywgZmV0Y2hPbkV4cGlyeUNhbGxiYWNrKSB7XG4gICAgICAgIGlmICghZmV0Y2hDYWxsYmFjaykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50TnVsbEVycm9yKFwiZmV0Y2hDYWxsYmFja1wiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWZldGNoT25FeHBpcnlDYWxsYmFjaykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50TnVsbEVycm9yKFwiZmV0Y2hPbkV4cGlyeUNhbGxiYWNrXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdkZldGNoQ2FsbGJhY2sgPSBmZXRjaENhbGxiYWNrO1xuICAgICAgICB0aGlzLnByaXZGZXRjaE9uRXhwaXJ5Q2FsbGJhY2sgPSBmZXRjaE9uRXhwaXJ5Q2FsbGJhY2s7XG4gICAgfVxuICAgIGZldGNoKGF1dGhGZXRjaEV2ZW50SWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkZldGNoQ2FsbGJhY2soYXV0aEZldGNoRXZlbnRJZCkudGhlbigodG9rZW4pID0+IG5ldyBBdXRoSW5mbyhIZWFkZXJOYW1lcy5BdXRob3JpemF0aW9uLCB0b2tlbiA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogQ29nbml0aXZlVG9rZW5BdXRoZW50aWNhdGlvbi5wcml2VG9rZW5QcmVmaXggKyB0b2tlbikpO1xuICAgIH1cbiAgICBmZXRjaE9uRXhwaXJ5KGF1dGhGZXRjaEV2ZW50SWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkZldGNoT25FeHBpcnlDYWxsYmFjayhhdXRoRmV0Y2hFdmVudElkKS50aGVuKCh0b2tlbikgPT4gbmV3IEF1dGhJbmZvKEhlYWRlck5hbWVzLkF1dGhvcml6YXRpb24sIHRva2VuID09PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiBDb2duaXRpdmVUb2tlbkF1dGhlbnRpY2F0aW9uLnByaXZUb2tlblByZWZpeCArIHRva2VuKSk7XG4gICAgfVxufVxuQ29nbml0aXZlVG9rZW5BdXRoZW50aWNhdGlvbi5wcml2VG9rZW5QcmVmaXggPSBcImJlYXJlciBcIjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29nbml0aXZlVG9rZW5BdXRoZW50aWNhdGlvbi5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgU2VydmljZVByb3BlcnRpZXNQcm9wZXJ0eU5hbWUsIH0gZnJvbSBcIi4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgUHJvcGVydHlJZCB9IGZyb20gXCIuLi9zZGsvRXhwb3J0c1wiO1xuaW1wb3J0IHsgUXVlcnlQYXJhbWV0ZXJOYW1lcyB9IGZyb20gXCIuL1F1ZXJ5UGFyYW1ldGVyTmFtZXNcIjtcbmV4cG9ydCBjbGFzcyBDb25uZWN0aW9uRmFjdG9yeUJhc2Uge1xuICAgIHN0YXRpYyBnZXRIb3N0U3VmZml4KHJlZ2lvbikge1xuICAgICAgICBpZiAoISFyZWdpb24pIHtcbiAgICAgICAgICAgIGlmIChyZWdpb24udG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKFwiY2hpbmFcIikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCIuYXp1cmUuY25cIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZWdpb24udG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKFwidXNnb3ZcIikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCIuYXp1cmUudXNcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXCIubWljcm9zb2Z0LmNvbVwiO1xuICAgIH1cbiAgICBzZXRDb21tb25VcmxQYXJhbXMoY29uZmlnLCBxdWVyeVBhcmFtcywgZW5kcG9pbnQpIHtcbiAgICAgICAgY29uc3QgcHJvcGVydHlJZFRvUGFyYW1ldGVyTWFwID0gbmV3IE1hcChbXG4gICAgICAgICAgICBbUHJvcGVydHlJZC5TcGVlY2hfU2VnbWVudGF0aW9uU2lsZW5jZVRpbWVvdXRNcywgUXVlcnlQYXJhbWV0ZXJOYW1lcy5TZWdtZW50YXRpb25TaWxlbmNlVGltZW91dE1zXSxcbiAgICAgICAgICAgIFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuYWJsZUF1ZGlvTG9nZ2luZywgUXVlcnlQYXJhbWV0ZXJOYW1lcy5FbmFibGVBdWRpb0xvZ2dpbmddLFxuICAgICAgICAgICAgW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kU2lsZW5jZVRpbWVvdXRNcywgUXVlcnlQYXJhbWV0ZXJOYW1lcy5FbmRTaWxlbmNlVGltZW91dE1zXSxcbiAgICAgICAgICAgIFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0luaXRpYWxTaWxlbmNlVGltZW91dE1zLCBRdWVyeVBhcmFtZXRlck5hbWVzLkluaXRpYWxTaWxlbmNlVGltZW91dE1zXSxcbiAgICAgICAgICAgIFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9Qb3N0UHJvY2Vzc2luZ09wdGlvbiwgUXVlcnlQYXJhbWV0ZXJOYW1lcy5Qb3N0cHJvY2Vzc2luZ10sXG4gICAgICAgICAgICBbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUHJvZmFuaXR5T3B0aW9uLCBRdWVyeVBhcmFtZXRlck5hbWVzLlByb2Zhbml0eV0sXG4gICAgICAgICAgICBbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUmVxdWVzdFdvcmRMZXZlbFRpbWVzdGFtcHMsIFF1ZXJ5UGFyYW1ldGVyTmFtZXMuRW5hYmxlV29yZExldmVsVGltZXN0YW1wc10sXG4gICAgICAgICAgICBbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfU3RhYmxlUGFydGlhbFJlc3VsdFRocmVzaG9sZCwgUXVlcnlQYXJhbWV0ZXJOYW1lcy5TdGFibGVJbnRlcm1lZGlhdGVUaHJlc2hvbGRdLFxuICAgICAgICBdKTtcbiAgICAgICAgcHJvcGVydHlJZFRvUGFyYW1ldGVyTWFwLmZvckVhY2goKHBhcmFtZXRlck5hbWUsIHByb3BlcnR5SWQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2V0VXJsUGFyYW1ldGVyKHByb3BlcnR5SWQsIHBhcmFtZXRlck5hbWUsIGNvbmZpZywgcXVlcnlQYXJhbXMsIGVuZHBvaW50KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHNlcnZpY2VQcm9wZXJ0aWVzID0gSlNPTi5wYXJzZShjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShTZXJ2aWNlUHJvcGVydGllc1Byb3BlcnR5TmFtZSwgXCJ7fVwiKSk7XG4gICAgICAgIE9iamVjdC5rZXlzKHNlcnZpY2VQcm9wZXJ0aWVzKS5mb3JFYWNoKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgcXVlcnlQYXJhbXNbdmFsdWVdID0gc2VydmljZVByb3BlcnRpZXNbdmFsdWVdO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2V0VXJsUGFyYW1ldGVyKHByb3BJZCwgcGFyYW1ldGVyTmFtZSwgY29uZmlnLCBxdWVyeVBhcmFtcywgZW5kcG9pbnQpIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShwcm9wSWQsIHVuZGVmaW5lZCk7XG4gICAgICAgIC8vIEZJWE1FOiBUaGUgLnNlYXJjaCgpIGNoZWNrIHdpbGwgaW5jb3JyZWN0bHkgbWF0Y2ggcGFyYW1ldGVyIG5hbWUgYW55d2hlcmUgaW4gdGhlIHN0cmluZ1xuICAgICAgICAvLyAgICAgICAgaW5jbHVkaW5nIGUuZy4gdGhlIHBhdGggcG9ydGlvbiwgb3IgZXZlbiBhcyBhIHN1YnN0cmluZyBvZiBvdGhlciBxdWVyeSBwYXJhbWV0ZXJzXG4gICAgICAgIGlmICh2YWx1ZSAmJiAoIWVuZHBvaW50IHx8IGVuZHBvaW50LnNlYXJjaChwYXJhbWV0ZXJOYW1lKSA9PT0gLTEpKSB7XG4gICAgICAgICAgICBxdWVyeVBhcmFtc1twYXJhbWV0ZXJOYW1lXSA9IHZhbHVlLnRvTG9jYWxlTG93ZXJDYXNlKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbm5lY3Rpb25GYWN0b3J5QmFzZS5qcy5tYXBcbiIsInZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgT3V0cHV0Rm9ybWF0LCBQcm9wZXJ0eUNvbGxlY3Rpb24sIFByb3BlcnR5SWQsIFJlc3VsdFJlYXNvbiwgU3BlZWNoUmVjb2duaXRpb25SZXN1bHQgfSBmcm9tIFwiLi4vc2RrL0V4cG9ydHNcIjtcbmltcG9ydCB7IERldGFpbGVkU3BlZWNoUGhyYXNlLCBFbnVtVHJhbnNsYXRpb24sIE91dHB1dEZvcm1hdFByb3BlcnR5TmFtZSwgUmVjb2duaXRpb25TdGF0dXMsIFNlcnZpY2VSZWNvZ25pemVyQmFzZSwgU2ltcGxlU3BlZWNoUGhyYXNlLCBTcGVlY2hIeXBvdGhlc2lzIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvblNlcnZpY2VSZWNvZ25pemVyIGV4dGVuZHMgU2VydmljZVJlY29nbml6ZXJCYXNlIHtcbiAgICBjb25zdHJ1Y3RvcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvU291cmNlLCByZWNvZ25pemVyQ29uZmlnLCByZWNvZ25pemVyKSB7XG4gICAgICAgIHN1cGVyKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Tb3VyY2UsIHJlY29nbml6ZXJDb25maWcsIHJlY29nbml6ZXIpO1xuICAgICAgICB0aGlzLmhhbmRsZVNwZWVjaFBocmFzZU1lc3NhZ2UgPSAodGV4dEJvZHkpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHsgcmV0dXJuIHRoaXMuaGFuZGxlU3BlZWNoUGhyYXNlKHRleHRCb2R5KTsgfSk7XG4gICAgICAgIHRoaXMuaGFuZGxlU3BlZWNoSHlwb3RoZXNpc01lc3NhZ2UgPSAodGV4dEJvZHkpID0+IHRoaXMuaGFuZGxlU3BlZWNoSHlwb3RoZXNpcyh0ZXh0Qm9keSk7XG4gICAgfVxuICAgIHByb2Nlc3NUeXBlU3BlY2lmaWNNZXNzYWdlcyhjb25uZWN0aW9uTWVzc2FnZSkge1xuICAgICAgICB2b2lkIGNvbm5lY3Rpb25NZXNzYWdlO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGhhbmRsZVJlY29nbml6ZWRDYWxsYmFjayhyZXN1bHQsIG9mZnNldCwgc2Vzc2lvbklkKSB7XG4gICAgICAgIHZvaWQgcmVzdWx0O1xuICAgICAgICB2b2lkIG9mZnNldDtcbiAgICAgICAgdm9pZCBzZXNzaW9uSWQ7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaGFuZGxlUmVjb2duaXppbmdDYWxsYmFjayhyZXN1bHQsIGR1cmF0aW9uLCBzZXNzaW9uSWQpIHtcbiAgICAgICAgdm9pZCByZXN1bHQ7XG4gICAgICAgIHZvaWQgZHVyYXRpb247XG4gICAgICAgIHZvaWQgc2Vzc2lvbklkO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHByb2Nlc3NTcGVlY2hNZXNzYWdlcyhjb25uZWN0aW9uTWVzc2FnZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgbGV0IHByb2Nlc3NlZCA9IGZhbHNlO1xuICAgICAgICAgICAgc3dpdGNoIChjb25uZWN0aW9uTWVzc2FnZS5wYXRoLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwic3BlZWNoLmh5cG90aGVzaXNcIjpcbiAgICAgICAgICAgICAgICBjYXNlIFwic3BlZWNoLmZyYWdtZW50XCI6XG4gICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMuaGFuZGxlU3BlZWNoSHlwb3RoZXNpc01lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlU3BlZWNoSHlwb3RoZXNpc01lc3NhZ2UoY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJzcGVlY2gucGhyYXNlXCI6XG4gICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMuaGFuZGxlU3BlZWNoUGhyYXNlTWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5oYW5kbGVTcGVlY2hQaHJhc2VNZXNzYWdlKGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBwcm9jZXNzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBwcm9jZXNzZWQ7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjYW5jZWxSZWNvZ25pdGlvbihzZXNzaW9uSWQsIHJlcXVlc3RJZCwgY2FuY2VsbGF0aW9uUmVhc29uLCBlcnJvckNvZGUsIGVycm9yKSB7XG4gICAgICAgIC8vIEltcGxlbWVudGluZyB0byBhbGxvdyBpbmhlcml0YW5jZVxuICAgICAgICB2b2lkIHNlc3Npb25JZDtcbiAgICAgICAgdm9pZCByZXF1ZXN0SWQ7XG4gICAgICAgIHZvaWQgY2FuY2VsbGF0aW9uUmVhc29uO1xuICAgICAgICB2b2lkIGVycm9yQ29kZTtcbiAgICAgICAgdm9pZCBlcnJvcjtcbiAgICB9XG4gICAgaGFuZGxlU3BlZWNoUGhyYXNlKHRleHRCb2R5KSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBjb25zdCBzaW1wbGUgPSBTaW1wbGVTcGVlY2hQaHJhc2UuZnJvbUpTT04odGV4dEJvZHkpO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0UmVhc29uID0gRW51bVRyYW5zbGF0aW9uLmltcGxUcmFuc2xhdGVSZWNvZ25pdGlvblJlc3VsdChzaW1wbGUuUmVjb2duaXRpb25TdGF0dXMpO1xuICAgICAgICAgICAgbGV0IHJlc3VsdDtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdFByb3BzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICAgICAgcmVzdWx0UHJvcHMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfSnNvblJlc3VsdCwgdGV4dEJvZHkpO1xuICAgICAgICAgICAgY29uc3Qgc2ltcGxlT2Zmc2V0ID0gc2ltcGxlLk9mZnNldCArIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmN1cnJlbnRUdXJuQXVkaW9PZmZzZXQ7XG4gICAgICAgICAgICBsZXQgb2Zmc2V0ID0gc2ltcGxlT2Zmc2V0O1xuICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25QaHJhc2VSZWNvZ25pemVkKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmN1cnJlbnRUdXJuQXVkaW9PZmZzZXQgKyBzaW1wbGUuT2Zmc2V0ICsgc2ltcGxlLkR1cmF0aW9uKTtcbiAgICAgICAgICAgIGlmIChSZXN1bHRSZWFzb24uQ2FuY2VsZWQgPT09IHJlc3VsdFJlYXNvbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNhbmNlbFJlYXNvbiA9IEVudW1UcmFuc2xhdGlvbi5pbXBsVHJhbnNsYXRlQ2FuY2VsUmVzdWx0KHNpbXBsZS5SZWNvZ25pdGlvblN0YXR1cyk7XG4gICAgICAgICAgICAgICAgY29uc3QgY2FuY2VsbGF0aW9uRXJyb3JDb2RlID0gRW51bVRyYW5zbGF0aW9uLmltcGxUcmFuc2xhdGVDYW5jZWxFcnJvckNvZGUoc2ltcGxlLlJlY29nbml0aW9uU3RhdHVzKTtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmNhbmNlbFJlY29nbml0aW9uTG9jYWwoY2FuY2VsUmVhc29uLCBjYW5jZWxsYXRpb25FcnJvckNvZGUsIEVudW1UcmFuc2xhdGlvbi5pbXBsVHJhbnNsYXRlRXJyb3JEZXRhaWxzKGNhbmNlbGxhdGlvbkVycm9yQ29kZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKCEodGhpcy5wcml2UmVxdWVzdFNlc3Npb24uaXNTcGVlY2hFbmRlZCAmJiByZXN1bHRSZWFzb24gPT09IFJlc3VsdFJlYXNvbi5Ob01hdGNoICYmIHNpbXBsZS5SZWNvZ25pdGlvblN0YXR1cyAhPT0gUmVjb2duaXRpb25TdGF0dXMuSW5pdGlhbFNpbGVuY2VUaW1lb3V0KSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KE91dHB1dEZvcm1hdFByb3BlcnR5TmFtZSkgPT09IE91dHB1dEZvcm1hdFtPdXRwdXRGb3JtYXQuU2ltcGxlXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gbmV3IFNwZWVjaFJlY29nbml0aW9uUmVzdWx0KHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgcmVzdWx0UmVhc29uLCBzaW1wbGUuRGlzcGxheVRleHQsIHNpbXBsZS5EdXJhdGlvbiwgc2ltcGxlT2Zmc2V0LCBzaW1wbGUuTGFuZ3VhZ2UsIHNpbXBsZS5MYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UsIHNpbXBsZS5TcGVha2VySWQsIHVuZGVmaW5lZCwgdGV4dEJvZHksIHJlc3VsdFByb3BzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRldGFpbGVkID0gRGV0YWlsZWRTcGVlY2hQaHJhc2UuZnJvbUpTT04odGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdG90YWxPZmZzZXQgPSBkZXRhaWxlZC5PZmZzZXQgKyB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5jdXJyZW50VHVybkF1ZGlvT2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2V0Q29ycmVjdGVkSnNvbiA9IGRldGFpbGVkLmdldEpzb25XaXRoQ29ycmVjdGVkT2Zmc2V0cyh0b3RhbE9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBuZXcgU3BlZWNoUmVjb2duaXRpb25SZXN1bHQodGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCByZXN1bHRSZWFzb24sIGRldGFpbGVkLlRleHQsIGRldGFpbGVkLkR1cmF0aW9uLCB0b3RhbE9mZnNldCwgZGV0YWlsZWQuTGFuZ3VhZ2UsIGRldGFpbGVkLkxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSwgZGV0YWlsZWQuU3BlYWtlcklkLCB1bmRlZmluZWQsIG9mZnNldENvcnJlY3RlZEpzb24sIHJlc3VsdFByb3BzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IHJlc3VsdC5vZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVSZWNvZ25pemVkQ2FsbGJhY2socmVzdWx0LCBvZmZzZXQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgaGFuZGxlU3BlZWNoSHlwb3RoZXNpcyh0ZXh0Qm9keSkge1xuICAgICAgICBjb25zdCBoeXBvdGhlc2lzID0gU3BlZWNoSHlwb3RoZXNpcy5mcm9tSlNPTih0ZXh0Qm9keSk7XG4gICAgICAgIGNvbnN0IG9mZnNldCA9IGh5cG90aGVzaXMuT2Zmc2V0ICsgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uY3VycmVudFR1cm5BdWRpb09mZnNldDtcbiAgICAgICAgY29uc3QgcmVzdWx0UHJvcHMgPSBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCk7XG4gICAgICAgIHJlc3VsdFByb3BzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZVJlc3BvbnNlX0pzb25SZXN1bHQsIHRleHRCb2R5KTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IFNwZWVjaFJlY29nbml0aW9uUmVzdWx0KHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgUmVzdWx0UmVhc29uLlJlY29nbml6aW5nU3BlZWNoLCBoeXBvdGhlc2lzLlRleHQsIGh5cG90aGVzaXMuRHVyYXRpb24sIG9mZnNldCwgaHlwb3RoZXNpcy5MYW5ndWFnZSwgaHlwb3RoZXNpcy5MYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UsIGh5cG90aGVzaXMuU3BlYWtlcklkLCB1bmRlZmluZWQsIHRleHRCb2R5LCByZXN1bHRQcm9wcyk7XG4gICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uSHlwb3RoZXNpcyhvZmZzZXQpO1xuICAgICAgICB0aGlzLmhhbmRsZVJlY29nbml6aW5nQ2FsbGJhY2socmVzdWx0LCBoeXBvdGhlc2lzLkR1cmF0aW9uLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29udmVyc2F0aW9uU2VydmljZVJlY29nbml6ZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qIGVzbGludC1kaXNhYmxlIG1heC1jbGFzc2VzLXBlci1maWxlICovXG5pbXBvcnQgeyBQcm94eUluZm8sIFdlYnNvY2tldENvbm5lY3Rpb24sIH0gZnJvbSBcIi4uL2NvbW1vbi5icm93c2VyL0V4cG9ydHNcIjtcbmltcG9ydCB7IE91dHB1dEZvcm1hdFByb3BlcnR5TmFtZSB9IGZyb20gXCIuLi9jb21tb24uc3BlZWNoL0V4cG9ydHNcIjtcbmltcG9ydCB7IERpYWxvZ1NlcnZpY2VDb25maWcsIE91dHB1dEZvcm1hdCwgUHJvcGVydHlJZCB9IGZyb20gXCIuLi9zZGsvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29ubmVjdGlvbkZhY3RvcnlCYXNlIH0gZnJvbSBcIi4vQ29ubmVjdGlvbkZhY3RvcnlCYXNlXCI7XG5pbXBvcnQgeyBXZWJzb2NrZXRNZXNzYWdlRm9ybWF0dGVyIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuaW1wb3J0IHsgSGVhZGVyTmFtZXMgfSBmcm9tIFwiLi9IZWFkZXJOYW1lc1wiO1xuaW1wb3J0IHsgUXVlcnlQYXJhbWV0ZXJOYW1lcyB9IGZyb20gXCIuL1F1ZXJ5UGFyYW1ldGVyTmFtZXNcIjtcbmV4cG9ydCBjbGFzcyBEaWFsb2dDb25uZWN0aW9uRmFjdG9yeSBleHRlbmRzIENvbm5lY3Rpb25GYWN0b3J5QmFzZSB7XG4gICAgY3JlYXRlKGNvbmZpZywgYXV0aEluZm8sIGNvbm5lY3Rpb25JZCkge1xuICAgICAgICBjb25zdCBhcHBsaWNhdGlvbklkID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25fQXBwbGljYXRpb25JZCwgXCJcIik7XG4gICAgICAgIGNvbnN0IGRpYWxvZ1R5cGUgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvbl9EaWFsb2dUeXBlKTtcbiAgICAgICAgY29uc3QgcmVnaW9uID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWdpb24pO1xuICAgICAgICBjb25zdCBsYW5ndWFnZSA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlLCBcImVuLVVTXCIpO1xuICAgICAgICBjb25zdCByZXF1ZXN0VHVyblN0YXR1cyA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uX1JlcXVlc3RfQm90X1N0YXR1c19NZXNzYWdlcywgXCJ0cnVlXCIpO1xuICAgICAgICBjb25zdCBxdWVyeVBhcmFtcyA9IHt9O1xuICAgICAgICBxdWVyeVBhcmFtc1tIZWFkZXJOYW1lcy5Db25uZWN0aW9uSWRdID0gY29ubmVjdGlvbklkO1xuICAgICAgICBxdWVyeVBhcmFtc1tRdWVyeVBhcmFtZXRlck5hbWVzLkZvcm1hdF0gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShPdXRwdXRGb3JtYXRQcm9wZXJ0eU5hbWUsIE91dHB1dEZvcm1hdFtPdXRwdXRGb3JtYXQuU2ltcGxlXSkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgcXVlcnlQYXJhbXNbUXVlcnlQYXJhbWV0ZXJOYW1lcy5MYW5ndWFnZV0gPSBsYW5ndWFnZTtcbiAgICAgICAgcXVlcnlQYXJhbXNbUXVlcnlQYXJhbWV0ZXJOYW1lcy5SZXF1ZXN0Qm90U3RhdHVzTWVzc2FnZXNdID0gcmVxdWVzdFR1cm5TdGF0dXM7XG4gICAgICAgIGlmIChhcHBsaWNhdGlvbklkKSB7XG4gICAgICAgICAgICBxdWVyeVBhcmFtc1tRdWVyeVBhcmFtZXRlck5hbWVzLkJvdElkXSA9IGFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICBpZiAoZGlhbG9nVHlwZSA9PT0gRGlhbG9nU2VydmljZUNvbmZpZy5EaWFsb2dUeXBlcy5DdXN0b21Db21tYW5kcykge1xuICAgICAgICAgICAgICAgIHF1ZXJ5UGFyYW1zW0hlYWRlck5hbWVzLkN1c3RvbUNvbW1hbmRzQXBwSWRdID0gYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZXNvdXJjZUluZml4ID0gZGlhbG9nVHlwZSA9PT0gRGlhbG9nU2VydmljZUNvbmZpZy5EaWFsb2dUeXBlcy5DdXN0b21Db21tYW5kcyA/IFwiY29tbWFuZHMvXCJcbiAgICAgICAgICAgIDogXCJcIjtcbiAgICAgICAgY29uc3QgdmVyc2lvbiA9IGRpYWxvZ1R5cGUgPT09IERpYWxvZ1NlcnZpY2VDb25maWcuRGlhbG9nVHlwZXMuQ3VzdG9tQ29tbWFuZHMgPyBcInYxXCJcbiAgICAgICAgICAgIDogZGlhbG9nVHlwZSA9PT0gRGlhbG9nU2VydmljZUNvbmZpZy5EaWFsb2dUeXBlcy5Cb3RGcmFtZXdvcmsgPyBcInYzXCJcbiAgICAgICAgICAgICAgICA6IFwidjBcIjtcbiAgICAgICAgY29uc3QgaGVhZGVycyA9IHt9O1xuICAgICAgICBpZiAoYXV0aEluZm8udG9rZW4gIT0gbnVsbCAmJiBhdXRoSW5mby50b2tlbiAhPT0gXCJcIikge1xuICAgICAgICAgICAgaGVhZGVyc1thdXRoSW5mby5oZWFkZXJOYW1lXSA9IGF1dGhJbmZvLnRva2VuO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRoZSBVUkwgdXNlZCBmb3IgY29ubmVjdGlvbiBpcyBjaG9zZW4gaW4gYSBwcmlvcml0eSBvcmRlciBvZiBzcGVjaWZpY2F0aW9uOlxuICAgICAgICAvLyAgMS4gSWYgYSBjdXN0b20gZW5kcG9pbnQgaXMgcHJvdmlkZWQsIHRoYXQgVVJMIGlzIHVzZWQgdmVyYmF0aW0uXG4gICAgICAgIC8vICAyLiBJZiBhIGN1c3RvbSBob3N0IGlzIHByb3ZpZGVkIChlLmcuIFwid3NzOi8vbXkuY3VzdG9tLmVuZHBvaW50LmNvbToxMTIzXCIpLCBhIFVSTCBpcyBjb25zdHJ1Y3RlZCBmcm9tIGl0LlxuICAgICAgICAvLyAgMy4gSWYgbm8gY3VzdG9tIGNvbm5lY3Rpb24gZGV0YWlscyBhcmUgcHJvdmlkZWQsIGEgVVJMIGlzIGNvbnN0cnVjdGVkIGZyb20gZGVmYXVsdCB2YWx1ZXMuXG4gICAgICAgIGxldCBlbmRwb2ludCA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnQsIFwiXCIpO1xuICAgICAgICBpZiAoIWVuZHBvaW50KSB7XG4gICAgICAgICAgICBjb25zdCBob3N0U3VmZml4ID0gQ29ubmVjdGlvbkZhY3RvcnlCYXNlLmdldEhvc3RTdWZmaXgocmVnaW9uKTtcbiAgICAgICAgICAgIGNvbnN0IGhvc3QgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0hvc3QsIGB3c3M6Ly8ke3JlZ2lvbn0uJHtEaWFsb2dDb25uZWN0aW9uRmFjdG9yeS5CYXNlVXJsfSR7aG9zdFN1ZmZpeH1gKTtcbiAgICAgICAgICAgIGNvbnN0IHN0YW5kYXJkaXplZEhvc3QgPSBob3N0LmVuZHNXaXRoKFwiL1wiKSA/IGhvc3QgOiBob3N0ICsgXCIvXCI7XG4gICAgICAgICAgICBlbmRwb2ludCA9IGAke3N0YW5kYXJkaXplZEhvc3R9JHtyZXNvdXJjZUluZml4fSR7RGlhbG9nQ29ubmVjdGlvbkZhY3RvcnkuQXBpS2V5fS8ke3ZlcnNpb259YDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldENvbW1vblVybFBhcmFtcyhjb25maWcsIHF1ZXJ5UGFyYW1zLCBlbmRwb2ludCk7XG4gICAgICAgIGNvbnN0IGVuYWJsZUNvbXByZXNzaW9uID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoXCJTUEVFQ0gtRW5hYmxlV2Vic29ja2V0Q29tcHJlc3Npb25cIiwgXCJmYWxzZVwiKSA9PT0gXCJ0cnVlXCI7XG4gICAgICAgIHJldHVybiBuZXcgV2Vic29ja2V0Q29ubmVjdGlvbihlbmRwb2ludCwgcXVlcnlQYXJhbXMsIGhlYWRlcnMsIG5ldyBXZWJzb2NrZXRNZXNzYWdlRm9ybWF0dGVyKCksIFByb3h5SW5mby5mcm9tUmVjb2duaXplckNvbmZpZyhjb25maWcpLCBlbmFibGVDb21wcmVzc2lvbiwgY29ubmVjdGlvbklkKTtcbiAgICB9XG59XG5EaWFsb2dDb25uZWN0aW9uRmFjdG9yeS5BcGlLZXkgPSBcImFwaVwiO1xuRGlhbG9nQ29ubmVjdGlvbkZhY3RvcnkuQmFzZVVybCA9IFwiY29udmFpLnNwZWVjaFwiO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1EaWFsb2dDb25uZWN0b3JGYWN0b3J5LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCB7IFJlcGxheWFibGVBdWRpb05vZGUgfSBmcm9tIFwiLi4vY29tbW9uLmJyb3dzZXIvRXhwb3J0c1wiO1xuaW1wb3J0IHsgU2VuZGluZ0FnZW50Q29udGV4dE1lc3NhZ2VFdmVudCB9IGZyb20gXCIuLi9jb21tb24vRGlhbG9nRXZlbnRzXCI7XG5pbXBvcnQgeyBCYWNrZ3JvdW5kRXZlbnQsIGNyZWF0ZUd1aWQsIGNyZWF0ZU5vRGFzaEd1aWQsIERlZmVycmVkLCBFdmVudHMsIEV2ZW50U291cmNlLCBNZXNzYWdlVHlwZSwgU2VydmljZUV2ZW50LCB9IGZyb20gXCIuLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQXVkaW9PdXRwdXRGb3JtYXRJbXBsIH0gZnJvbSBcIi4uL3Nkay9BdWRpby9BdWRpb091dHB1dEZvcm1hdFwiO1xuaW1wb3J0IHsgQWN0aXZpdHlSZWNlaXZlZEV2ZW50QXJncywgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLCBDYW5jZWxsYXRpb25SZWFzb24sIERpYWxvZ1NlcnZpY2VDb25maWcsIFByb3BlcnR5Q29sbGVjdGlvbiwgUHJvcGVydHlJZCwgUmVjb2duaXRpb25FdmVudEFyZ3MsIFJlc3VsdFJlYXNvbiwgU2Vzc2lvbkV2ZW50QXJncywgU3BlZWNoUmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJncywgU3BlZWNoUmVjb2duaXRpb25FdmVudEFyZ3MsIFNwZWVjaFJlY29nbml0aW9uUmVzdWx0LCBUdXJuU3RhdHVzUmVjZWl2ZWRFdmVudEFyZ3MsIH0gZnJvbSBcIi4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBEaWFsb2dTZXJ2aWNlVHVyblN0YXRlTWFuYWdlciB9IGZyb20gXCIuL0RpYWxvZ1NlcnZpY2VUdXJuU3RhdGVNYW5hZ2VyXCI7XG5pbXBvcnQgeyBDYW5jZWxsYXRpb25FcnJvckNvZGVQcm9wZXJ0eU5hbWUsIEVudW1UcmFuc2xhdGlvbiwgUmVjb2duaXRpb25TdGF0dXMsIFNlcnZpY2VSZWNvZ25pemVyQmFzZSwgU2ltcGxlU3BlZWNoUGhyYXNlLCBTcGVlY2hEZXRlY3RlZCwgU3BlZWNoSHlwb3RoZXNpcywgU3BlZWNoS2V5d29yZCwgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBBY3Rpdml0eVBheWxvYWRSZXNwb25zZSB9IGZyb20gXCIuL1NlcnZpY2VNZXNzYWdlcy9BY3Rpdml0eVJlc3BvbnNlUGF5bG9hZFwiO1xuaW1wb3J0IHsgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UgfSBmcm9tIFwiLi9TcGVlY2hDb25uZWN0aW9uTWVzc2FnZS5JbnRlcm5hbFwiO1xuZXhwb3J0IGNsYXNzIERpYWxvZ1NlcnZpY2VBZGFwdGVyIGV4dGVuZHMgU2VydmljZVJlY29nbml6ZXJCYXNlIHtcbiAgICBjb25zdHJ1Y3RvcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvU291cmNlLCByZWNvZ25pemVyQ29uZmlnLCBkaWFsb2dTZXJ2aWNlQ29ubmVjdG9yKSB7XG4gICAgICAgIHN1cGVyKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Tb3VyY2UsIHJlY29nbml6ZXJDb25maWcsIGRpYWxvZ1NlcnZpY2VDb25uZWN0b3IpO1xuICAgICAgICB0aGlzLnByaXZFdmVudHMgPSBuZXcgRXZlbnRTb3VyY2UoKTtcbiAgICAgICAgdGhpcy5wcml2RGlhbG9nU2VydmljZUNvbm5lY3RvciA9IGRpYWxvZ1NlcnZpY2VDb25uZWN0b3I7XG4gICAgICAgIHRoaXMucmVjZWl2ZU1lc3NhZ2VPdmVycmlkZSA9ICgpID0+IHRoaXMucmVjZWl2ZURpYWxvZ01lc3NhZ2VPdmVycmlkZSgpO1xuICAgICAgICB0aGlzLnByaXZUdXJuU3RhdGVNYW5hZ2VyID0gbmV3IERpYWxvZ1NlcnZpY2VUdXJuU3RhdGVNYW5hZ2VyKCk7XG4gICAgICAgIHRoaXMucmVjb2duaXplT3ZlcnJpZGUgPVxuICAgICAgICAgICAgKHJlY29Nb2RlLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spID0+IHRoaXMubGlzdGVuT25jZShyZWNvTW9kZSwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKTtcbiAgICAgICAgdGhpcy5wb3N0Q29ubmVjdEltcGxPdmVycmlkZSA9IChjb25uZWN0aW9uKSA9PiB0aGlzLmRpYWxvZ0Nvbm5lY3RJbXBsKGNvbm5lY3Rpb24pO1xuICAgICAgICB0aGlzLmNvbmZpZ0Nvbm5lY3Rpb25PdmVycmlkZSA9IChjb25uZWN0aW9uKSA9PiB0aGlzLmNvbmZpZ0Nvbm5lY3Rpb24oY29ubmVjdGlvbik7XG4gICAgICAgIHRoaXMuZGlzY29ubmVjdE92ZXJyaWRlID0gKCkgPT4gdGhpcy5wcml2RGlzY29ubmVjdCgpO1xuICAgICAgICB0aGlzLnByaXZEaWFsb2dBdWRpb1NvdXJjZSA9IGF1ZGlvU291cmNlO1xuICAgICAgICB0aGlzLmFnZW50Q29uZmlnU2VudCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZMYXN0UmVzdWx0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5jb25uZWN0aW9uRXZlbnRzLmF0dGFjaCgoY29ubmVjdGlvbkV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoY29ubmVjdGlvbkV2ZW50Lm5hbWUgPT09IFwiQ29ubmVjdGlvbkNsb3NlZEV2ZW50XCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZU1lc3NhZ2VMb29wID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNlbmRNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IGludGVyYWN0aW9uR3VpZCA9IGNyZWF0ZUd1aWQoKTtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RJZCA9IGNyZWF0ZU5vRGFzaEd1aWQoKTtcbiAgICAgICAgICAgIGNvbnN0IGFnZW50TWVzc2FnZSA9IHtcbiAgICAgICAgICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgICAgICAgICAgIGludGVyYWN0aW9uSWQ6IGludGVyYWN0aW9uR3VpZFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtYXNzaWdubWVudFxuICAgICAgICAgICAgICAgIG1lc3NhZ2VQYXlsb2FkOiBKU09OLnBhcnNlKG1lc3NhZ2UpLFxuICAgICAgICAgICAgICAgIHZlcnNpb246IDAuNVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNvbnN0IGFnZW50TWVzc2FnZUpzb24gPSBKU09OLnN0cmluZ2lmeShhZ2VudE1lc3NhZ2UpO1xuICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHlpZWxkIHRoaXMuZmV0Y2hDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICB5aWVsZCBjb25uZWN0aW9uLnNlbmQobmV3IFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlKE1lc3NhZ2VUeXBlLlRleHQsIFwiYWdlbnRcIiwgcmVxdWVzdElkLCBcImFwcGxpY2F0aW9uL2pzb25cIiwgYWdlbnRNZXNzYWdlSnNvbikpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcHJpdkRpc2Nvbm5lY3QoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLmNhbmNlbFJlY29nbml0aW9uKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBDYW5jZWxsYXRpb25SZWFzb24uRXJyb3IsIENhbmNlbGxhdGlvbkVycm9yQ29kZS5Ob0Vycm9yLCBcIkRpc2Nvbm5lY3RpbmdcIik7XG4gICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZU1lc3NhZ2VMb29wID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuYWdlbnRDb25maWdTZW50ID0gZmFsc2U7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBwcm9jZXNzVHlwZVNwZWNpZmljTWVzc2FnZXMoY29ubmVjdGlvbk1lc3NhZ2UpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0UHJvcHMgPSBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCk7XG4gICAgICAgIGlmIChjb25uZWN0aW9uTWVzc2FnZS5tZXNzYWdlVHlwZSA9PT0gTWVzc2FnZVR5cGUuVGV4dCkge1xuICAgICAgICAgICAgcmVzdWx0UHJvcHMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfSnNvblJlc3VsdCwgY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICB9XG4gICAgICAgIGxldCByZXN1bHQ7XG4gICAgICAgIGxldCBwcm9jZXNzZWQ7XG4gICAgICAgIHN3aXRjaCAoY29ubmVjdGlvbk1lc3NhZ2UucGF0aC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICBjYXNlIFwic3BlZWNoLnBocmFzZVwiOlxuICAgICAgICAgICAgICAgIGNvbnN0IHNwZWVjaFBocmFzZSA9IFNpbXBsZVNwZWVjaFBocmFzZS5mcm9tSlNPTihjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25QaHJhc2VSZWNvZ25pemVkKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmN1cnJlbnRUdXJuQXVkaW9PZmZzZXQgKyBzcGVlY2hQaHJhc2UuT2Zmc2V0ICsgc3BlZWNoUGhyYXNlLkR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICBpZiAoc3BlZWNoUGhyYXNlLlJlY29nbml0aW9uU3RhdHVzICE9PSBSZWNvZ25pdGlvblN0YXR1cy5Ub29NYW55UmVxdWVzdHMgJiYgc3BlZWNoUGhyYXNlLlJlY29nbml0aW9uU3RhdHVzICE9PSBSZWNvZ25pdGlvblN0YXR1cy5FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBhcmdzID0gdGhpcy5maXJlRXZlbnRGb3JSZXN1bHQoc3BlZWNoUGhyYXNlLCByZXN1bHRQcm9wcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkxhc3RSZXN1bHQgPSBhcmdzLnJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2RGlhbG9nU2VydmljZUNvbm5lY3Rvci5yZWNvZ25pemVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkRpYWxvZ1NlcnZpY2VDb25uZWN0b3IucmVjb2duaXplZCh0aGlzLnByaXZEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yLCBhcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90IGdvaW5nIHRvIGxldCBlcnJvcnMgaW4gdGhlIGV2ZW50IGhhbmRsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0cmlwIHRoaW5ncyB1cC5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcm9jZXNzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInNwZWVjaC5oeXBvdGhlc2lzXCI6XG4gICAgICAgICAgICAgICAgY29uc3QgaHlwb3RoZXNpcyA9IFNwZWVjaEh5cG90aGVzaXMuZnJvbUpTT04oY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG9mZnNldCA9IGh5cG90aGVzaXMuT2Zmc2V0ICsgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uY3VycmVudFR1cm5BdWRpb09mZnNldDtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBuZXcgU3BlZWNoUmVjb2duaXRpb25SZXN1bHQodGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBSZXN1bHRSZWFzb24uUmVjb2duaXppbmdTcGVlY2gsIGh5cG90aGVzaXMuVGV4dCwgaHlwb3RoZXNpcy5EdXJhdGlvbiwgb2Zmc2V0LCBoeXBvdGhlc2lzLkxhbmd1YWdlLCBoeXBvdGhlc2lzLkxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5LCByZXN1bHRQcm9wcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25IeXBvdGhlc2lzKG9mZnNldCk7XG4gICAgICAgICAgICAgICAgY29uc3QgZXYgPSBuZXcgU3BlZWNoUmVjb2duaXRpb25FdmVudEFyZ3MocmVzdWx0LCBoeXBvdGhlc2lzLkR1cmF0aW9uLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQpO1xuICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkRpYWxvZ1NlcnZpY2VDb25uZWN0b3IucmVjb2duaXppbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkRpYWxvZ1NlcnZpY2VDb25uZWN0b3IucmVjb2duaXppbmcodGhpcy5wcml2RGlhbG9nU2VydmljZUNvbm5lY3RvciwgZXYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdCBnb2luZyB0byBsZXQgZXJyb3JzIGluIHRoZSBldmVudCBoYW5kbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0cmlwIHRoaW5ncyB1cC5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcm9jZXNzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInNwZWVjaC5rZXl3b3JkXCI6XG4gICAgICAgICAgICAgICAgY29uc3Qga2V5d29yZCA9IFNwZWVjaEtleXdvcmQuZnJvbUpTT04oY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBTcGVlY2hSZWNvZ25pdGlvblJlc3VsdCh0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIGtleXdvcmQuU3RhdHVzID09PSBcIkFjY2VwdGVkXCIgPyBSZXN1bHRSZWFzb24uUmVjb2duaXplZEtleXdvcmQgOiBSZXN1bHRSZWFzb24uTm9NYXRjaCwga2V5d29yZC5UZXh0LCBrZXl3b3JkLkR1cmF0aW9uLCBrZXl3b3JkLk9mZnNldCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSwgcmVzdWx0UHJvcHMpO1xuICAgICAgICAgICAgICAgIGlmIChrZXl3b3JkLlN0YXR1cyAhPT0gXCJBY2NlcHRlZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkxhc3RSZXN1bHQgPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IFNwZWVjaFJlY29nbml0aW9uRXZlbnRBcmdzKHJlc3VsdCwgcmVzdWx0LmR1cmF0aW9uLCByZXN1bHQucmVzdWx0SWQpO1xuICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkRpYWxvZ1NlcnZpY2VDb25uZWN0b3IucmVjb2duaXplZCkge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2RGlhbG9nU2VydmljZUNvbm5lY3Rvci5yZWNvZ25pemVkKHRoaXMucHJpdkRpYWxvZ1NlcnZpY2VDb25uZWN0b3IsIGV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgZ29pbmcgdG8gbGV0IGVycm9ycyBpbiB0aGUgZXZlbnQgaGFuZGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcHJvY2Vzc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJhdWRpb1wiOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXVkaW9SZXF1ZXN0SWQgPSBjb25uZWN0aW9uTWVzc2FnZS5yZXF1ZXN0SWQudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdHVybiA9IHRoaXMucHJpdlR1cm5TdGF0ZU1hbmFnZXIuR2V0VHVybihhdWRpb1JlcXVlc3RJZCk7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBFbXB0eSBiaW5hcnkgbWVzc2FnZSBzaWduYWxzIGVuZCBvZiBzdHJlYW0uXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNvbm5lY3Rpb25NZXNzYWdlLmJpbmFyeUJvZHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0dXJuLmVuZEF1ZGlvU3RyZWFtKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0dXJuLmF1ZGlvU3RyZWFtLndyaXRlKGNvbm5lY3Rpb25NZXNzYWdlLmJpbmFyeUJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90IGdvaW5nIHRvIGxldCBlcnJvcnMgaW4gdGhlIGV2ZW50IGhhbmRsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRyaXAgdGhpbmdzIHVwLlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHByb2Nlc3NlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwicmVzcG9uc2VcIjpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlUmVzcG9uc2VNZXNzYWdlKGNvbm5lY3Rpb25NZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcHJvY2Vzc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGVmZmVyYWwgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgZGVmZmVyYWwucmVzb2x2ZShwcm9jZXNzZWQpO1xuICAgICAgICByZXR1cm4gZGVmZmVyYWwucHJvbWlzZTtcbiAgICB9XG4gICAgLy8gQ2FuY2VscyByZWNvZ25pdGlvbi5cbiAgICBjYW5jZWxSZWNvZ25pdGlvbihzZXNzaW9uSWQsIHJlcXVlc3RJZCwgY2FuY2VsbGF0aW9uUmVhc29uLCBlcnJvckNvZGUsIGVycm9yKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZU1lc3NhZ2VMb29wID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmlzUmVjb2duaXppbmcpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblN0b3BSZWNvZ25pemluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2RGlhbG9nU2VydmljZUNvbm5lY3Rvci5jYW5jZWxlZCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHByb3BlcnRpZXMgPSBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgcHJvcGVydGllcy5zZXRQcm9wZXJ0eShDYW5jZWxsYXRpb25FcnJvckNvZGVQcm9wZXJ0eU5hbWUsIENhbmNlbGxhdGlvbkVycm9yQ29kZVtlcnJvckNvZGVdKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjYW5jZWxFdmVudCA9IG5ldyBTcGVlY2hSZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzKGNhbmNlbGxhdGlvblJlYXNvbiwgZXJyb3IsIGVycm9yQ29kZSwgdW5kZWZpbmVkLCBzZXNzaW9uSWQpO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkRpYWxvZ1NlcnZpY2VDb25uZWN0b3IuY2FuY2VsZWQodGhpcy5wcml2RGlhbG9nU2VydmljZUNvbm5lY3RvciwgY2FuY2VsRXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoX2EpIHsgfVxuICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgU3BlZWNoUmVjb2duaXRpb25SZXN1bHQodW5kZWZpbmVkLCAvLyBSZXN1bHRJZFxuICAgICAgICAgICAgICAgICAgICBSZXN1bHRSZWFzb24uQ2FuY2VsZWQsIHVuZGVmaW5lZCwgLy8gVGV4dFxuICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQsIC8vIER1cmF0aW9uXG4gICAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZCwgLy8gT2Zmc2V0XG4gICAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZCwgLy8gTGFuZ3VhZ2VcbiAgICAgICAgICAgICAgICAgICAgdW5kZWZpbmVkLCAvLyBMYW5ndWFnZSBEZXRlY3Rpb24gQ29uZmlkZW5jZVxuICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQsIC8vIFNwZWFrZXIgSWRcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IsIHVuZGVmaW5lZCwgLy8gSnNvblxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzKTtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoX2IpIHsgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGxpc3Rlbk9uY2UocmVjb01vZGUsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5yZWNvZ25pdGlvbk1vZGUgPSByZWNvTW9kZTtcbiAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayA9IHN1Y2Nlc3NDYWxsYmFjaztcbiAgICAgICAgICAgIHRoaXMucHJpdkVycm9yQ2FsbGJhY2sgPSBlcnJvckNhbGxiYWNrO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc3RhcnROZXdSZWNvZ25pdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ubGlzdGVuRm9yU2VydmljZVRlbGVtZXRyeSh0aGlzLnByaXZEaWFsb2dBdWRpb1NvdXJjZS5ldmVudHMpO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5wYXJhbWV0ZXJzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoX1Nlc3Npb25JZCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkKTtcbiAgICAgICAgICAgIC8vIFN0YXJ0IHRoZSBjb25uZWN0aW9uIHRvIHRoZSBzZXJ2aWNlLiBUaGUgcHJvbWlzZSB0aGlzIHdpbGwgY3JlYXRlIGlzIHN0b3JlZCBhbmQgd2lsbCBiZSB1c2VkIGJ5IGNvbmZpZ3VyZUNvbm5lY3Rpb24oKS5cbiAgICAgICAgICAgIGNvbnN0IGNvblByb21pc2UgPSB0aGlzLmNvbm5lY3RJbXBsKCk7XG4gICAgICAgICAgICBjb25zdCBwcmVBdWRpb1Byb21pc2UgPSB0aGlzLnNlbmRQcmVBdWRpb01lc3NhZ2VzKCk7XG4gICAgICAgICAgICBjb25zdCBub2RlID0geWllbGQgdGhpcy5wcml2RGlhbG9nQXVkaW9Tb3VyY2UuYXR0YWNoKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmF1ZGlvTm9kZUlkKTtcbiAgICAgICAgICAgIGNvbnN0IGZvcm1hdCA9IHlpZWxkIHRoaXMucHJpdkRpYWxvZ0F1ZGlvU291cmNlLmZvcm1hdDtcbiAgICAgICAgICAgIGNvbnN0IGRldmljZUluZm8gPSB5aWVsZCB0aGlzLnByaXZEaWFsb2dBdWRpb1NvdXJjZS5kZXZpY2VJbmZvO1xuICAgICAgICAgICAgY29uc3QgYXVkaW9Ob2RlID0gbmV3IFJlcGxheWFibGVBdWRpb05vZGUobm9kZSwgZm9ybWF0LmF2Z0J5dGVzUGVyU2VjKTtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uQXVkaW9Tb3VyY2VBdHRhY2hDb21wbGV0ZWQoYXVkaW9Ob2RlLCBmYWxzZSk7XG4gICAgICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLlNwZWVjaFNlcnZpY2VDb25maWcuQ29udGV4dC5hdWRpbyA9IHsgc291cmNlOiBkZXZpY2VJbmZvIH07XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHlpZWxkIGNvblByb21pc2U7XG4gICAgICAgICAgICAgICAgeWllbGQgcHJlQXVkaW9Qcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5jYW5jZWxSZWNvZ25pdGlvbih0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgQ2FuY2VsbGF0aW9uUmVhc29uLkVycm9yLCBDYW5jZWxsYXRpb25FcnJvckNvZGUuQ29ubmVjdGlvbkZhaWx1cmUsIGVycm9yKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBzZXNzaW9uU3RhcnRFdmVudEFyZ3MgPSBuZXcgU2Vzc2lvbkV2ZW50QXJncyh0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQpO1xuICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2UmVjb2duaXplci5zZXNzaW9uU3RhcnRlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXIuc2Vzc2lvblN0YXJ0ZWQodGhpcy5wcml2UmVjb2duaXplciwgc2Vzc2lvblN0YXJ0RXZlbnRBcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGF1ZGlvU2VuZFByb21pc2UgPSB0aGlzLnNlbmRBdWRpbyhhdWRpb05vZGUpO1xuICAgICAgICAgICAgLy8gLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgIGF1ZGlvU2VuZFByb21pc2UudGhlbigoKSA9PiB7IH0sIChlcnJvcikgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuY2FuY2VsUmVjb2duaXRpb24odGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIENhbmNlbGxhdGlvblJlYXNvbi5FcnJvciwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLlJ1bnRpbWVFcnJvciwgZXJyb3IpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLy8gRXN0YWJsaXNoZXMgYSB3ZWJzb2NrZXQgY29ubmVjdGlvbiB0byB0aGUgZW5kIHBvaW50LlxuICAgIGRpYWxvZ0Nvbm5lY3RJbXBsKGNvbm5lY3Rpb24pIHtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkxvb3AgPSB0aGlzLnN0YXJ0TWVzc2FnZUxvb3AoKTtcbiAgICAgICAgcmV0dXJuIGNvbm5lY3Rpb247XG4gICAgfVxuICAgIHJlY2VpdmVEaWFsb2dNZXNzYWdlT3ZlcnJpZGUoKSB7XG4gICAgICAgIC8vIHdlIHdvbid0IHJlbHkgb24gdGhlIGNhc2NhZGluZyBwcm9taXNlcyBvZiB0aGUgY29ubmVjdGlvbiBzaW5jZSB3ZSB3YW50IHRvIGNvbnRpbnVhbGx5IGJlIGF2YWlsYWJsZSB0byByZWNlaXZlIG1lc3NhZ2VzXG4gICAgICAgIGNvbnN0IGNvbW11bmljYXRpb25DdXN0b2RpYW4gPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgY29uc3QgbG9vcCA9ICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaXNEaXNwb3NlZCA9IHRoaXMuaXNEaXNwb3NlZCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRlcm1pbmF0ZU1lc3NhZ2VMb29wID0gKCF0aGlzLmlzRGlzcG9zZWQoKSAmJiB0aGlzLnRlcm1pbmF0ZU1lc3NhZ2VMb29wKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNEaXNwb3NlZCB8fCB0ZXJtaW5hdGVNZXNzYWdlTG9vcCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBXZSdyZSBkb25lLlxuICAgICAgICAgICAgICAgICAgICBjb21tdW5pY2F0aW9uQ3VzdG9kaWFuLnJlc29sdmUodW5kZWZpbmVkKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0geWllbGQgdGhpcy5mZXRjaENvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlID0geWllbGQgY29ubmVjdGlvbi5yZWFkKCk7XG4gICAgICAgICAgICAgICAgaWYgKCFtZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsb29wKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb25NZXNzYWdlID0gU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UuZnJvbUNvbm5lY3Rpb25NZXNzYWdlKG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoY29ubmVjdGlvbk1lc3NhZ2UucGF0aC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJ0dXJuLnN0YXJ0XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdHVyblJlcXVlc3RJZCA9IGNvbm5lY3Rpb25NZXNzYWdlLnJlcXVlc3RJZC50b1VwcGVyQ2FzZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGF1ZGlvU2Vzc2lvblJlcUlkID0gdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHVybiBzdGFydGVkIGJ5IHRoZSBzZXJ2aWNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR1cm5SZXF1ZXN0SWQgIT09IGF1ZGlvU2Vzc2lvblJlcUlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlR1cm5TdGF0ZU1hbmFnZXIuU3RhcnRUdXJuKHR1cm5SZXF1ZXN0SWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25TZXJ2aWNlVHVyblN0YXJ0UmVzcG9uc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInNwZWVjaC5zdGFydGRldGVjdGVkXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzcGVlY2hTdGFydERldGVjdGVkID0gU3BlZWNoRGV0ZWN0ZWQuZnJvbUpTT04oY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3BlZWNoU3RhcnRFdmVudEFyZ3MgPSBuZXcgUmVjb2duaXRpb25FdmVudEFyZ3Moc3BlZWNoU3RhcnREZXRlY3RlZC5PZmZzZXQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZSZWNvZ25pemVyLnNwZWVjaFN0YXJ0RGV0ZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyLnNwZWVjaFN0YXJ0RGV0ZWN0ZWQodGhpcy5wcml2UmVjb2duaXplciwgc3BlZWNoU3RhcnRFdmVudEFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzcGVlY2guZW5kZGV0ZWN0ZWRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBqc29uO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uID0gY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcmVxdWVzdCB3YXMgZW1wdHksIHRoZSBKU09OIHJldHVybmVkIGlzIGVtcHR5LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb24gPSBcInsgT2Zmc2V0OiAwIH1cIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNwZWVjaFN0b3BEZXRlY3RlZCA9IFNwZWVjaERldGVjdGVkLmZyb21KU09OKGpzb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25TZXJ2aWNlUmVjb2duaXplZChzcGVlY2hTdG9wRGV0ZWN0ZWQuT2Zmc2V0ICsgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uY3VycmVudFR1cm5BdWRpb09mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzcGVlY2hTdG9wRXZlbnRBcmdzID0gbmV3IFJlY29nbml0aW9uRXZlbnRBcmdzKHNwZWVjaFN0b3BEZXRlY3RlZC5PZmZzZXQgKyB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5jdXJyZW50VHVybkF1ZGlvT2Zmc2V0LCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2UmVjb2duaXplci5zcGVlY2hFbmREZXRlY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXIuc3BlZWNoRW5kRGV0ZWN0ZWQodGhpcy5wcml2UmVjb2duaXplciwgc3BlZWNoU3RvcEV2ZW50QXJncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInR1cm4uZW5kXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdHVybkVuZFJlcXVlc3RJZCA9IGNvbm5lY3Rpb25NZXNzYWdlLnJlcXVlc3RJZC50b1VwcGVyQ2FzZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGF1ZGlvU2Vzc2lvblJlcUlkID0gdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHVybiBzdGFydGVkIGJ5IHRoZSBzZXJ2aWNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR1cm5FbmRSZXF1ZXN0SWQgIT09IGF1ZGlvU2Vzc2lvblJlcUlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlR1cm5TdGF0ZU1hbmFnZXIuQ29tcGxldGVUdXJuKHR1cm5FbmRSZXF1ZXN0SWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXVkaW8gc2Vzc2lvbiB0dXJuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlc3Npb25TdG9wRXZlbnRBcmdzID0gbmV3IFNlc3Npb25FdmVudEFyZ3ModGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25TZXJ2aWNlVHVybkVuZFJlc3BvbnNlKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLmlzQ29udGludW91c1JlY29nbml0aW9uIHx8IHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmlzU3BlZWNoRW5kZWQgfHwgIXRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmlzUmVjb2duaXppbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlJlY29nbml6ZXIuc2Vzc2lvblN0b3BwZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyLnNlc3Npb25TdG9wcGVkKHRoaXMucHJpdlJlY29nbml6ZXIsIHNlc3Npb25TdG9wRXZlbnRBcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZXBvcnQgcmVzdWx0IHRvIHByb21pc2UuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayAmJiB0aGlzLnByaXZMYXN0UmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayh0aGlzLnByaXZMYXN0UmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZMYXN0UmVzdWx0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2RXJyb3JDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZFcnJvckNhbGxiYWNrKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgaW52b2tlIHRoZSBjYWxsIGJhY2sgb25jZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFuZCBpZiBpdCdzIHN1Y2Nlc3NmdWwgZG9uJ3QgaW52b2tlIHRoZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXJyb3IgYWZ0ZXIgdGhhdC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkVycm9yQ2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJvY2Vzc2VkID0geWllbGQgdGhpcy5wcm9jZXNzVHlwZVNwZWNpZmljTWVzc2FnZXMoY29ubmVjdGlvbk1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcHJvY2Vzc2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMuc2VydmljZUV2ZW50cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXJ2aWNlRXZlbnRzLm9uRXZlbnQobmV3IFNlcnZpY2VFdmVudChjb25uZWN0aW9uTWVzc2FnZS5wYXRoLnRvTG93ZXJDYXNlKCksIGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHJldCA9IGxvb3AoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50ZXJtaW5hdGVNZXNzYWdlTG9vcCA9IHRydWU7XG4gICAgICAgICAgICAgICAgY29tbXVuaWNhdGlvbkN1c3RvZGlhbi5yZXNvbHZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBsb29wKCkuY2F0Y2goKHJlYXNvbikgPT4ge1xuICAgICAgICAgICAgRXZlbnRzLmluc3RhbmNlLm9uRXZlbnQobmV3IEJhY2tncm91bmRFdmVudChyZWFzb24pKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBjb21tdW5pY2F0aW9uQ3VzdG9kaWFuLnByb21pc2U7XG4gICAgfVxuICAgIHN0YXJ0TWVzc2FnZUxvb3AoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZU1lc3NhZ2VMb29wID0gZmFsc2U7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucmVjZWl2ZURpYWxvZ01lc3NhZ2VPdmVycmlkZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5jYW5jZWxSZWNvZ25pdGlvbih0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgQ2FuY2VsbGF0aW9uUmVhc29uLkVycm9yLCBDYW5jZWxsYXRpb25FcnJvckNvZGUuUnVudGltZUVycm9yLCBlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvLyBUYWtlcyBhbiBlc3RhYmxpc2hlZCB3ZWJzb2NrZXQgY29ubmVjdGlvbiB0byB0aGUgZW5kcG9pbnQgYW5kIHNlbmRzIHNwZWVjaCBjb25maWd1cmF0aW9uIGluZm9ybWF0aW9uLlxuICAgIGNvbmZpZ0Nvbm5lY3Rpb24oY29ubmVjdGlvbikge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMudGVybWluYXRlTWVzc2FnZUxvb3ApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZU1lc3NhZ2VMb29wID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KFwiQ29ubmVjdGlvbiB0byBzZXJ2aWNlIHRlcm1pbmF0ZWQuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeWllbGQgdGhpcy5zZW5kU3BlZWNoU2VydmljZUNvbmZpZyhjb25uZWN0aW9uLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbiwgdGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5TcGVlY2hTZXJ2aWNlQ29uZmlnLnNlcmlhbGl6ZSgpKTtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuc2VuZEFnZW50Q29uZmlnKGNvbm5lY3Rpb24pO1xuICAgICAgICAgICAgcmV0dXJuIGNvbm5lY3Rpb247XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZW5kUHJlQXVkaW9NZXNzYWdlcygpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSB5aWVsZCB0aGlzLmZldGNoQ29ubmVjdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5hZGRLZXl3b3JkQ29udGV4dERhdGEoKTtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuc2VuZFNwZWVjaENvbnRleHQoY29ubmVjdGlvbiwgdHJ1ZSk7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnNlbmRBZ2VudENvbnRleHQoY29ubmVjdGlvbik7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnNlbmRXYXZlSGVhZGVyKGNvbm5lY3Rpb24pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2VuZEFnZW50Q29uZmlnKGNvbm5lY3Rpb24pIHtcbiAgICAgICAgaWYgKHRoaXMuYWdlbnRDb25maWcgJiYgIXRoaXMuYWdlbnRDb25maWdTZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2UmVjb2duaXplckNvbmZpZ1xuICAgICAgICAgICAgICAgIC5wYXJhbWV0ZXJzXG4gICAgICAgICAgICAgICAgLmdldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uX0RpYWxvZ1R5cGUpID09PSBEaWFsb2dTZXJ2aWNlQ29uZmlnLkRpYWxvZ1R5cGVzLkN1c3RvbUNvbW1hbmRzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29uZmlnID0gdGhpcy5hZ2VudENvbmZpZy5nZXQoKTtcbiAgICAgICAgICAgICAgICBjb25maWcuYm90SW5mby5jb21tYW5kc0N1bHR1cmUgPSB0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTGFuZ3VhZ2UsIFwiZW4tdXNcIik7XG4gICAgICAgICAgICAgICAgdGhpcy5hZ2VudENvbmZpZy5zZXQoY29uZmlnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgU2VuZGluZ0FnZW50Q29udGV4dE1lc3NhZ2VFdmVudCh0aGlzLmFnZW50Q29uZmlnKSk7XG4gICAgICAgICAgICBjb25zdCBhZ2VudENvbmZpZ0pzb24gPSB0aGlzLmFnZW50Q29uZmlnLnRvSnNvblN0cmluZygpO1xuICAgICAgICAgICAgLy8gZ3VhcmQgYWdhaW5zdCBzZW5kaW5nIHRoaXMgbXVsdGlwbGUgdGltZXMgb24gb25lIGNvbm5lY3Rpb25cbiAgICAgICAgICAgIHRoaXMuYWdlbnRDb25maWdTZW50ID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiBjb25uZWN0aW9uLnNlbmQobmV3IFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlKE1lc3NhZ2VUeXBlLlRleHQsIFwiYWdlbnQuY29uZmlnXCIsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgXCJhcHBsaWNhdGlvbi9qc29uXCIsIGFnZW50Q29uZmlnSnNvbikpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc2VuZEFnZW50Q29udGV4dChjb25uZWN0aW9uKSB7XG4gICAgICAgIGNvbnN0IGd1aWQgPSBjcmVhdGVHdWlkKCk7XG4gICAgICAgIGNvbnN0IHNwZWVjaEFjdGl2aXR5VGVtcGxhdGUgPSB0aGlzLnByaXZEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25fU3BlZWNoX0FjdGl2aXR5X1RlbXBsYXRlKTtcbiAgICAgICAgY29uc3QgYWdlbnRDb250ZXh0ID0ge1xuICAgICAgICAgICAgY2hhbm5lbERhdGE6IFwiXCIsXG4gICAgICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgICAgICAgaW50ZXJhY3Rpb25JZDogZ3VpZFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG1lc3NhZ2VQYXlsb2FkOiB0eXBlb2Ygc3BlZWNoQWN0aXZpdHlUZW1wbGF0ZSA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogc3BlZWNoQWN0aXZpdHlUZW1wbGF0ZSxcbiAgICAgICAgICAgIHZlcnNpb246IDAuNVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBhZ2VudENvbnRleHRKc29uID0gSlNPTi5zdHJpbmdpZnkoYWdlbnRDb250ZXh0KTtcbiAgICAgICAgcmV0dXJuIGNvbm5lY3Rpb24uc2VuZChuZXcgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UoTWVzc2FnZVR5cGUuVGV4dCwgXCJzcGVlY2guYWdlbnQuY29udGV4dFwiLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIFwiYXBwbGljYXRpb24vanNvblwiLCBhZ2VudENvbnRleHRKc29uKSk7XG4gICAgfVxuICAgIGZpcmVFdmVudEZvclJlc3VsdChzZXJ2aWNlUmVzdWx0LCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdFJlYXNvbiA9IEVudW1UcmFuc2xhdGlvbi5pbXBsVHJhbnNsYXRlUmVjb2duaXRpb25SZXN1bHQoc2VydmljZVJlc3VsdC5SZWNvZ25pdGlvblN0YXR1cyk7XG4gICAgICAgIGNvbnN0IG9mZnNldCA9IHNlcnZpY2VSZXN1bHQuT2Zmc2V0ICsgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uY3VycmVudFR1cm5BdWRpb09mZnNldDtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IFNwZWVjaFJlY29nbml0aW9uUmVzdWx0KHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgcmVzdWx0UmVhc29uLCBzZXJ2aWNlUmVzdWx0LkRpc3BsYXlUZXh0LCBzZXJ2aWNlUmVzdWx0LkR1cmF0aW9uLCBvZmZzZXQsIHNlcnZpY2VSZXN1bHQuTGFuZ3VhZ2UsIHNlcnZpY2VSZXN1bHQuTGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgSlNPTi5zdHJpbmdpZnkoc2VydmljZVJlc3VsdCksIHByb3BlcnRpZXMpO1xuICAgICAgICBjb25zdCBldiA9IG5ldyBTcGVlY2hSZWNvZ25pdGlvbkV2ZW50QXJncyhyZXN1bHQsIG9mZnNldCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkKTtcbiAgICAgICAgcmV0dXJuIGV2O1xuICAgIH1cbiAgICBoYW5kbGVSZXNwb25zZU1lc3NhZ2UocmVzcG9uc2VNZXNzYWdlKSB7XG4gICAgICAgIC8vIFwicmVzcG9uc2VcIiBtZXNzYWdlcyBjYW4gY29udGFpbiBlaXRoZXIgXCJtZXNzYWdlXCIgKGFjdGl2aXR5KSBvciBcIk1lc3NhZ2VTdGF0dXNcIiBkYXRhLiBGaXJlIHRoZSBhcHByb3ByaWF0ZVxuICAgICAgICAvLyBldmVudCBhY2NvcmRpbmcgdG8gdGhlIG1lc3NhZ2UgdHlwZSB0aGF0J3Mgc3BlY2lmaWVkLlxuICAgICAgICBjb25zdCByZXNwb25zZVBheWxvYWQgPSBKU09OLnBhcnNlKHJlc3BvbnNlTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgIHN3aXRjaCAocmVzcG9uc2VQYXlsb2FkLm1lc3NhZ2VUeXBlLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgIGNhc2UgXCJtZXNzYWdlXCI6XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VSZXF1ZXN0SWQgPSByZXNwb25zZU1lc3NhZ2UucmVxdWVzdElkLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgYWN0aXZpdHlQYXlsb2FkID0gQWN0aXZpdHlQYXlsb2FkUmVzcG9uc2UuZnJvbUpTT04ocmVzcG9uc2VNZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgICAgICAgICBjb25zdCB0dXJuID0gdGhpcy5wcml2VHVyblN0YXRlTWFuYWdlci5HZXRUdXJuKHJlc3BvbnNlUmVxdWVzdElkKTtcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgdGhlIGNvbnZlcnNhdGlvbiBJZFxuICAgICAgICAgICAgICAgIGlmIChhY3Rpdml0eVBheWxvYWQuY29udmVyc2F0aW9uSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXBkYXRlQWdlbnRDb25maWcgPSB0aGlzLmFnZW50Q29uZmlnLmdldCgpO1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVBZ2VudENvbmZpZy5ib3RJbmZvLmNvbnZlcnNhdGlvbklkID0gYWN0aXZpdHlQYXlsb2FkLmNvbnZlcnNhdGlvbklkO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFnZW50Q29uZmlnLnNldCh1cGRhdGVBZ2VudENvbmZpZyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHB1bGxBdWRpb091dHB1dFN0cmVhbSA9IHR1cm4ucHJvY2Vzc0FjdGl2aXR5UGF5bG9hZChhY3Rpdml0eVBheWxvYWQsIEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbC5mcm9tU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nKHRoaXMucHJpdkRpYWxvZ1NlcnZpY2VDb25uZWN0b3IucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1N5bnRoT3V0cHV0Rm9ybWF0LCB1bmRlZmluZWQpKSk7XG4gICAgICAgICAgICAgICAgY29uc3QgYWN0aXZpdHkgPSBuZXcgQWN0aXZpdHlSZWNlaXZlZEV2ZW50QXJncyhhY3Rpdml0eVBheWxvYWQubWVzc2FnZVBheWxvYWQsIHB1bGxBdWRpb091dHB1dFN0cmVhbSk7XG4gICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2RGlhbG9nU2VydmljZUNvbm5lY3Rvci5hY3Rpdml0eVJlY2VpdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yLmFjdGl2aXR5UmVjZWl2ZWQodGhpcy5wcml2RGlhbG9nU2VydmljZUNvbm5lY3RvciwgYWN0aXZpdHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWVtcHR5ICovXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgZ29pbmcgdG8gbGV0IGVycm9ycyBpbiB0aGUgZXZlbnQgaGFuZGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibWVzc2FnZXN0YXR1c1wiOlxuICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkRpYWxvZ1NlcnZpY2VDb25uZWN0b3IudHVyblN0YXR1c1JlY2VpdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yLnR1cm5TdGF0dXNSZWNlaXZlZCh0aGlzLnByaXZEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yLCBuZXcgVHVyblN0YXR1c1JlY2VpdmVkRXZlbnRBcmdzKHJlc3BvbnNlTWVzc2FnZS50ZXh0Qm9keSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWVtcHR5ICovXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgZ29pbmcgdG8gbGV0IGVycm9ycyBpbiB0aGUgZXZlbnQgaGFuZGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIEV2ZW50cy5pbnN0YW5jZS5vbkV2ZW50KG5ldyBCYWNrZ3JvdW5kRXZlbnQoYFVuZXhwZWN0ZWQgcmVzcG9uc2Ugb2YgdHlwZSAke3Jlc3BvbnNlUGF5bG9hZC5tZXNzYWdlVHlwZX0uIElnbm9yaW5nLmApKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICBvbkV2ZW50KGV2ZW50KSB7XG4gICAgICAgIHRoaXMucHJpdkV2ZW50cy5vbkV2ZW50KGV2ZW50KTtcbiAgICAgICAgRXZlbnRzLmluc3RhbmNlLm9uRXZlbnQoZXZlbnQpO1xuICAgIH1cbiAgICBhZGRLZXl3b3JkQ29udGV4dERhdGEoKSB7XG4gICAgICAgIGNvbnN0IGtleXdvcmRQcm9wZXJ0eVZhbHVlID0gdGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFwiU1BFRUNILUtleXdvcmRzVG9EZXRlY3RcIik7XG4gICAgICAgIGlmIChrZXl3b3JkUHJvcGVydHlWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qga2V5d29yZE9mZnNldFByb3BlcnR5VmFsdWUgPSB0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLnBhcmFtZXRlcnNcbiAgICAgICAgICAgIC5nZXRQcm9wZXJ0eShcIlNQRUVDSC1LZXl3b3Jkc1RvRGV0ZWN0LU9mZnNldHNcIik7XG4gICAgICAgIGNvbnN0IGtleXdvcmREdXJhdGlvblByb3BlcnR5VmFsdWUgPSB0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLnBhcmFtZXRlcnNcbiAgICAgICAgICAgIC5nZXRQcm9wZXJ0eShcIlNQRUVDSC1LZXl3b3Jkc1RvRGV0ZWN0LUR1cmF0aW9uc1wiKTtcbiAgICAgICAgY29uc3Qga2V5d29yZHMgPSBrZXl3b3JkUHJvcGVydHlWYWx1ZS5zcGxpdChcIjtcIik7XG4gICAgICAgIGNvbnN0IGtleXdvcmRPZmZzZXRzID0ga2V5d29yZE9mZnNldFByb3BlcnR5VmFsdWUgPT09IHVuZGVmaW5lZCA/IFtdIDoga2V5d29yZE9mZnNldFByb3BlcnR5VmFsdWUuc3BsaXQoXCI7XCIpO1xuICAgICAgICBjb25zdCBrZXl3b3JkRHVyYXRpb25zID0ga2V5d29yZER1cmF0aW9uUHJvcGVydHlWYWx1ZSA9PT0gdW5kZWZpbmVkID8gW10gOiBrZXl3b3JkRHVyYXRpb25Qcm9wZXJ0eVZhbHVlLnNwbGl0KFwiO1wiKTtcbiAgICAgICAgY29uc3Qga2V5d29yZERlZmluaXRpb25BcnJheSA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGtleXdvcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBkZWZpbml0aW9uID0ge307XG4gICAgICAgICAgICBkZWZpbml0aW9uLnRleHQgPSBrZXl3b3Jkc1tpXTtcbiAgICAgICAgICAgIGlmIChpIDwga2V5d29yZE9mZnNldHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZGVmaW5pdGlvbi5vZmZzZXQgPSBOdW1iZXIoa2V5d29yZE9mZnNldHNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGkgPCBrZXl3b3JkRHVyYXRpb25zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGRlZmluaXRpb24uZHVyYXRpb24gPSBOdW1iZXIoa2V5d29yZER1cmF0aW9uc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBrZXl3b3JkRGVmaW5pdGlvbkFycmF5LnB1c2goZGVmaW5pdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zcGVlY2hDb250ZXh0LnNldFNlY3Rpb24oXCJpbnZvY2F0aW9uU291cmNlXCIsIFwiVm9pY2VBY3RpdmF0aW9uV2l0aEtleXdvcmRcIik7XG4gICAgICAgIHRoaXMuc3BlZWNoQ29udGV4dC5zZXRTZWN0aW9uKFwia2V5d29yZERldGVjdGlvblwiLCBbe1xuICAgICAgICAgICAgICAgIGNsaWVudERldGVjdGVkS2V5d29yZHM6IGtleXdvcmREZWZpbml0aW9uQXJyYXksXG4gICAgICAgICAgICAgICAgb25SZWplY3Q6IHsgYWN0aW9uOiBcIkVuZE9mVHVyblwiIH0sXG4gICAgICAgICAgICAgICAgdHlwZTogXCJzdGFydFRyaWdnZXJcIlxuICAgICAgICAgICAgfV0pO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9RGlhbG9nU2VydmljZUFkYXB0ZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbCB9IGZyb20gXCIuLi9zZGsvQXVkaW8vQXVkaW9PdXRwdXRGb3JtYXRcIjtcbmltcG9ydCB7IEF1ZGlvT3V0cHV0U3RyZWFtIH0gZnJvbSBcIi4uL3Nkay9BdWRpby9BdWRpb091dHB1dFN0cmVhbVwiO1xuaW1wb3J0IHsgTWVzc2FnZURhdGFTdHJlYW1UeXBlIH0gZnJvbSBcIi4vU2VydmljZU1lc3NhZ2VzL0FjdGl2aXR5UmVzcG9uc2VQYXlsb2FkXCI7XG5leHBvcnQgY2xhc3MgRGlhbG9nU2VydmljZVR1cm5TdGF0ZSB7XG4gICAgY29uc3RydWN0b3IobWFuYWdlciwgcmVxdWVzdElkKSB7XG4gICAgICAgIHRoaXMucHJpdlJlcXVlc3RJZCA9IHJlcXVlc3RJZDtcbiAgICAgICAgdGhpcy5wcml2SXNDb21wbGV0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9TdHJlYW0gPSBudWxsO1xuICAgICAgICB0aGlzLnByaXZUdXJuTWFuYWdlciA9IG1hbmFnZXI7XG4gICAgICAgIHRoaXMucmVzZXRUdXJuRW5kVGltZW91dCgpO1xuICAgIH1cbiAgICBnZXQgYXVkaW9TdHJlYW0oKSB7XG4gICAgICAgIC8vIENhbGxlZCB3aGVuIGlzIG5lZWRlZCB0byBzdHJlYW0uXG4gICAgICAgIHRoaXMucmVzZXRUdXJuRW5kVGltZW91dCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXVkaW9TdHJlYW07XG4gICAgfVxuICAgIHByb2Nlc3NBY3Rpdml0eVBheWxvYWQocGF5bG9hZCwgYXVkaW9Gb3JtYXQpIHtcbiAgICAgICAgaWYgKHBheWxvYWQubWVzc2FnZURhdGFTdHJlYW1UeXBlID09PSBNZXNzYWdlRGF0YVN0cmVhbVR5cGUuVGV4dFRvU3BlZWNoQXVkaW8pIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvU3RyZWFtID0gQXVkaW9PdXRwdXRTdHJlYW0uY3JlYXRlUHVsbFN0cmVhbSgpO1xuICAgICAgICAgICAgdGhpcy5wcml2QXVkaW9TdHJlYW0uZm9ybWF0ID0gKGF1ZGlvRm9ybWF0ICE9PSB1bmRlZmluZWQpID8gYXVkaW9Gb3JtYXQgOiBBdWRpb091dHB1dEZvcm1hdEltcGwuZ2V0RGVmYXVsdE91dHB1dEZvcm1hdCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb1N0cmVhbTtcbiAgICB9XG4gICAgZW5kQXVkaW9TdHJlYW0oKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZBdWRpb1N0cmVhbSAhPT0gbnVsbCAmJiAhdGhpcy5wcml2QXVkaW9TdHJlYW0uaXNDbG9zZWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvU3RyZWFtLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29tcGxldGUoKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZUaW1lb3V0VG9rZW4gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtYXJndW1lbnRcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnByaXZUaW1lb3V0VG9rZW4pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZW5kQXVkaW9TdHJlYW0oKTtcbiAgICB9XG4gICAgcmVzZXRUdXJuRW5kVGltZW91dCgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdlRpbWVvdXRUb2tlbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1hcmd1bWVudFxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMucHJpdlRpbWVvdXRUb2tlbik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2VGltZW91dFRva2VuID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnByaXZUdXJuTWFuYWdlci5Db21wbGV0ZVR1cm4odGhpcy5wcml2UmVxdWVzdElkKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSwgMjAwMCk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1EaWFsb2dTZXJ2aWNlVHVyblN0YXRlLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBJbnZhbGlkT3BlcmF0aW9uRXJyb3IgfSBmcm9tIFwiLi4vY29tbW9uL0Vycm9yXCI7XG5pbXBvcnQgeyBEaWFsb2dTZXJ2aWNlVHVyblN0YXRlIH0gZnJvbSBcIi4vRGlhbG9nU2VydmljZVR1cm5TdGF0ZVwiO1xuZXhwb3J0IGNsYXNzIERpYWxvZ1NlcnZpY2VUdXJuU3RhdGVNYW5hZ2VyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5wcml2VHVybk1hcCA9IG5ldyBNYXAoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBTdGFydFR1cm4oaWQpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdlR1cm5NYXAuaGFzKGlkKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRPcGVyYXRpb25FcnJvcihcIlNlcnZpY2UgZXJyb3I6IFRoZXJlIGlzIGFscmVhZHkgYSB0dXJuIHdpdGggaWQ6XCIgKyBpZCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdHVyblN0YXRlID0gbmV3IERpYWxvZ1NlcnZpY2VUdXJuU3RhdGUodGhpcywgaWQpO1xuICAgICAgICB0aGlzLnByaXZUdXJuTWFwLnNldChpZCwgdHVyblN0YXRlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlR1cm5NYXAuZ2V0KGlkKTtcbiAgICB9XG4gICAgR2V0VHVybihpZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VHVybk1hcC5nZXQoaWQpO1xuICAgIH1cbiAgICBDb21wbGV0ZVR1cm4oaWQpIHtcbiAgICAgICAgaWYgKCF0aGlzLnByaXZUdXJuTWFwLmhhcyhpZCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXJyb3IoXCJTZXJ2aWNlIGVycm9yOiBSZWNlaXZlZCB0dXJuIGVuZCBmb3IgYW4gdW5rbm93biB0dXJuIGlkOlwiICsgaWQpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHR1cm5TdGF0ZSA9IHRoaXMucHJpdlR1cm5NYXAuZ2V0KGlkKTtcbiAgICAgICAgdHVyblN0YXRlLmNvbXBsZXRlKCk7XG4gICAgICAgIHRoaXMucHJpdlR1cm5NYXAuZGVsZXRlKGlkKTtcbiAgICAgICAgcmV0dXJuIHR1cm5TdGF0ZTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPURpYWxvZ1NlcnZpY2VUdXJuU3RhdGVNYW5hZ2VyLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIFJlc3BvbnNpYmxlIGZvciBidWlsZGluZyB0aGUgb2JqZWN0IHRvIGJlIHNlbnQgdG8gdGhlIHNwZWVjaCBzZXJ2aWNlIHRvIHN1cHBvcnQgZHluYW1pYyBncmFtbWFycy5cbiAqIEBjbGFzcyBEeW5hbWljR3JhbW1hckJ1aWxkZXJcbiAqL1xuZXhwb3J0IGNsYXNzIER5bmFtaWNHcmFtbWFyQnVpbGRlciB7XG4gICAgLy8gQWRkcyBvbmUgbW9yZSByZWZlcmVuY2UgcGhyYXNlcyB0byB0aGUgZHluYW1pYyBncmFtbWFyIHRvIHNlbmQuXG4gICAgLy8gQWxsIGFkZGVkIHBocmFzZXMgYXJlIGdlbmVyaWMgcGhyYXNlcy5cbiAgICBhZGRQaHJhc2UocGhyYXNlKSB7XG4gICAgICAgIGlmICghdGhpcy5wcml2UGhyYXNlcykge1xuICAgICAgICAgICAgdGhpcy5wcml2UGhyYXNlcyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwaHJhc2UgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgdGhpcy5wcml2UGhyYXNlcyA9IHRoaXMucHJpdlBocmFzZXMuY29uY2F0KHBocmFzZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnByaXZQaHJhc2VzLnB1c2gocGhyYXNlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBDbGVhcnMgYWxsIHBocmFzZXMgc3RvcmVkIGluIHRoZSBjdXJyZW50IG9iamVjdC5cbiAgICBjbGVhclBocmFzZXMoKSB7XG4gICAgICAgIHRoaXMucHJpdlBocmFzZXMgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIC8vIEFkZHMgb25lIG9yIG1vcmUgcmVmZXJlbmNlIGdyYW1tYXJzIHRvIHRoZSBjdXJyZW50IGdyYW1tYXIuXG4gICAgYWRkUmVmZXJlbmNlR3JhbW1hcihncmFtbWFyKSB7XG4gICAgICAgIGlmICghdGhpcy5wcml2R3JhbW1hcnMpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkdyYW1tYXJzID0gW107XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGdyYW1tYXIgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgdGhpcy5wcml2R3JhbW1hcnMgPSB0aGlzLnByaXZHcmFtbWFycy5jb25jYXQoZ3JhbW1hcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnByaXZHcmFtbWFycy5wdXNoKGdyYW1tYXIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8vIGNsZWFycyBhbGwgZ3JhbW1hcnMgc3RvcmVkIG9uIHRoZSByZWNvZ25pemVyLlxuICAgIGNsZWFyR3JhbW1hcnMoKSB7XG4gICAgICAgIHRoaXMucHJpdkdyYW1tYXJzID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICAvLyBHZW5lcmF0ZXMgYW4gb2JqZWN0IHRoYXQgcmVwcmVzZW50cyB0aGUgZHluYW1pYyBncmFtbWFyIHVzZWQgYnkgdGhlIFNwZWVjaCBTZXJ2aWNlLlxuICAgIC8vIFRoaXMgaXMgZG9uZSBieSBidWlsZGluZyBhbiBvYmplY3Qgd2l0aCB0aGUgY29ycmVjdCBsYXlvdXQgYmFzZWQgb24gdGhlIHBocmFzZXMgYW5kIHJlZmVyZW5jZSBncmFtbWFycyBhZGRlZCB0byB0aGlzIGluc3RhbmNlXG4gICAgLy8gb2YgYSBEeW5hbWljR3JhbW1hckJ1aWxkZXJcbiAgICBnZW5lcmF0ZUdyYW1tYXJPYmplY3QoKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZHcmFtbWFycyA9PT0gdW5kZWZpbmVkICYmIHRoaXMucHJpdlBocmFzZXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZXRPYmogPSB7fTtcbiAgICAgICAgcmV0T2JqLlJlZmVyZW5jZUdyYW1tYXJzID0gdGhpcy5wcml2R3JhbW1hcnM7XG4gICAgICAgIGlmICh1bmRlZmluZWQgIT09IHRoaXMucHJpdlBocmFzZXMgJiYgMCAhPT0gdGhpcy5wcml2UGhyYXNlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IHJldFBocmFzZXMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMucHJpdlBocmFzZXMuZm9yRWFjaCgodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICByZXRQaHJhc2VzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBUZXh0OiB2YWx1ZSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0T2JqLkdyb3VwcyA9IFt7IFR5cGU6IFwiR2VuZXJpY1wiLCBJdGVtczogcmV0UGhyYXNlcyB9XTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmV0T2JqO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9RHluYW1pY0dyYW1tYXJCdWlsZGVyLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUR5bmFtaWNHcmFtbWFySW50ZXJmYWNlcy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLCBDYW5jZWxsYXRpb25SZWFzb24sIFJlc3VsdFJlYXNvbiB9IGZyb20gXCIuLi9zZGsvRXhwb3J0c1wiO1xuaW1wb3J0IHsgUmVjb2duaXRpb25TdGF0dXMgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG5leHBvcnQgY2xhc3MgRW51bVRyYW5zbGF0aW9uIHtcbiAgICBzdGF0aWMgaW1wbFRyYW5zbGF0ZVJlY29nbml0aW9uUmVzdWx0KHJlY29nbml0aW9uU3RhdHVzKSB7XG4gICAgICAgIGxldCByZWFzb24gPSBSZXN1bHRSZWFzb24uQ2FuY2VsZWQ7XG4gICAgICAgIHN3aXRjaCAocmVjb2duaXRpb25TdGF0dXMpIHtcbiAgICAgICAgICAgIGNhc2UgUmVjb2duaXRpb25TdGF0dXMuU3VjY2VzczpcbiAgICAgICAgICAgICAgICByZWFzb24gPSBSZXN1bHRSZWFzb24uUmVjb2duaXplZFNwZWVjaDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgUmVjb2duaXRpb25TdGF0dXMuTm9NYXRjaDpcbiAgICAgICAgICAgIGNhc2UgUmVjb2duaXRpb25TdGF0dXMuSW5pdGlhbFNpbGVuY2VUaW1lb3V0OlxuICAgICAgICAgICAgY2FzZSBSZWNvZ25pdGlvblN0YXR1cy5CYWJibGVUaW1lb3V0OlxuICAgICAgICAgICAgY2FzZSBSZWNvZ25pdGlvblN0YXR1cy5FbmRPZkRpY3RhdGlvbjpcbiAgICAgICAgICAgICAgICByZWFzb24gPSBSZXN1bHRSZWFzb24uTm9NYXRjaDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgUmVjb2duaXRpb25TdGF0dXMuRXJyb3I6XG4gICAgICAgICAgICBjYXNlIFJlY29nbml0aW9uU3RhdHVzLkJhZFJlcXVlc3Q6XG4gICAgICAgICAgICBjYXNlIFJlY29nbml0aW9uU3RhdHVzLkZvcmJpZGRlbjpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmVhc29uID0gUmVzdWx0UmVhc29uLkNhbmNlbGVkO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZWFzb247XG4gICAgfVxuICAgIHN0YXRpYyBpbXBsVHJhbnNsYXRlQ2FuY2VsUmVzdWx0KHJlY29nbml0aW9uU3RhdHVzKSB7XG4gICAgICAgIGxldCByZWFzb24gPSBDYW5jZWxsYXRpb25SZWFzb24uRW5kT2ZTdHJlYW07XG4gICAgICAgIHN3aXRjaCAocmVjb2duaXRpb25TdGF0dXMpIHtcbiAgICAgICAgICAgIGNhc2UgUmVjb2duaXRpb25TdGF0dXMuU3VjY2VzczpcbiAgICAgICAgICAgIGNhc2UgUmVjb2duaXRpb25TdGF0dXMuRW5kT2ZEaWN0YXRpb246XG4gICAgICAgICAgICBjYXNlIFJlY29nbml0aW9uU3RhdHVzLk5vTWF0Y2g6XG4gICAgICAgICAgICAgICAgcmVhc29uID0gQ2FuY2VsbGF0aW9uUmVhc29uLkVuZE9mU3RyZWFtO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBSZWNvZ25pdGlvblN0YXR1cy5Jbml0aWFsU2lsZW5jZVRpbWVvdXQ6XG4gICAgICAgICAgICBjYXNlIFJlY29nbml0aW9uU3RhdHVzLkJhYmJsZVRpbWVvdXQ6XG4gICAgICAgICAgICBjYXNlIFJlY29nbml0aW9uU3RhdHVzLkVycm9yOlxuICAgICAgICAgICAgY2FzZSBSZWNvZ25pdGlvblN0YXR1cy5CYWRSZXF1ZXN0OlxuICAgICAgICAgICAgY2FzZSBSZWNvZ25pdGlvblN0YXR1cy5Gb3JiaWRkZW46XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJlYXNvbiA9IENhbmNlbGxhdGlvblJlYXNvbi5FcnJvcjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVhc29uO1xuICAgIH1cbiAgICBzdGF0aWMgaW1wbFRyYW5zbGF0ZUNhbmNlbEVycm9yQ29kZShyZWNvZ25pdGlvblN0YXR1cykge1xuICAgICAgICBsZXQgcmVhc29uID0gQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLk5vRXJyb3I7XG4gICAgICAgIHN3aXRjaCAocmVjb2duaXRpb25TdGF0dXMpIHtcbiAgICAgICAgICAgIGNhc2UgUmVjb2duaXRpb25TdGF0dXMuRXJyb3I6XG4gICAgICAgICAgICAgICAgcmVhc29uID0gQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLlNlcnZpY2VFcnJvcjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgUmVjb2duaXRpb25TdGF0dXMuVG9vTWFueVJlcXVlc3RzOlxuICAgICAgICAgICAgICAgIHJlYXNvbiA9IENhbmNlbGxhdGlvbkVycm9yQ29kZS5Ub29NYW55UmVxdWVzdHM7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFJlY29nbml0aW9uU3RhdHVzLkJhZFJlcXVlc3Q6XG4gICAgICAgICAgICAgICAgcmVhc29uID0gQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLkJhZFJlcXVlc3RQYXJhbWV0ZXJzO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBSZWNvZ25pdGlvblN0YXR1cy5Gb3JiaWRkZW46XG4gICAgICAgICAgICAgICAgcmVhc29uID0gQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLkZvcmJpZGRlbjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmVhc29uID0gQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLk5vRXJyb3I7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlYXNvbjtcbiAgICB9XG4gICAgc3RhdGljIGltcGxUcmFuc2xhdGVFcnJvckRldGFpbHMoY2FuY2VsbGF0aW9uRXJyb3JDb2RlKSB7XG4gICAgICAgIGxldCBlcnJvckRldGFpbHMgPSBcIlRoZSBzcGVlY2ggc2VydmljZSBlbmNvdW50ZXJlZCBhbiBpbnRlcm5hbCBlcnJvciBhbmQgY291bGQgbm90IGNvbnRpbnVlLlwiO1xuICAgICAgICBzd2l0Y2ggKGNhbmNlbGxhdGlvbkVycm9yQ29kZSkge1xuICAgICAgICAgICAgY2FzZSBDYW5jZWxsYXRpb25FcnJvckNvZGUuRm9yYmlkZGVuOlxuICAgICAgICAgICAgICAgIGVycm9yRGV0YWlscyA9IFwiVGhlIHJlY29nbml6ZXIgaXMgdXNpbmcgYSBmcmVlIHN1YnNjcmlwdGlvbiB0aGF0IHJhbiBvdXQgb2YgcXVvdGEuXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIENhbmNlbGxhdGlvbkVycm9yQ29kZS5CYWRSZXF1ZXN0UGFyYW1ldGVyczpcbiAgICAgICAgICAgICAgICBlcnJvckRldGFpbHMgPSBcIkludmFsaWQgcGFyYW1ldGVyIG9yIHVuc3VwcG9ydGVkIGF1ZGlvIGZvcm1hdCBpbiB0aGUgcmVxdWVzdC5cIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLlRvb01hbnlSZXF1ZXN0czpcbiAgICAgICAgICAgICAgICBlcnJvckRldGFpbHMgPSBcIlRoZSBudW1iZXIgb2YgcGFyYWxsZWwgcmVxdWVzdHMgZXhjZWVkZWQgdGhlIG51bWJlciBvZiBhbGxvd2VkIGNvbmN1cnJlbnQgdHJhbnNjcmlwdGlvbnMuXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlcnJvckRldGFpbHM7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1FbnVtVHJhbnNsYXRpb24uanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8vIE1ha2Ugc3VyZSBub3QgdG8gZXhwb3J0IGludGVybmFsIG1vZHVsZXMuXG4vL1xuZXhwb3J0ICogZnJvbSBcIi4vQ29nbml0aXZlU3Vic2NyaXB0aW9uS2V5QXV0aGVudGljYXRpb25cIjtcbmV4cG9ydCAqIGZyb20gXCIuL0NvZ25pdGl2ZVRva2VuQXV0aGVudGljYXRpb25cIjtcbmV4cG9ydCAqIGZyb20gXCIuL0lBdXRoZW50aWNhdGlvblwiO1xuZXhwb3J0ICogZnJvbSBcIi4vSUNvbm5lY3Rpb25GYWN0b3J5XCI7XG5leHBvcnQgKiBmcm9tIFwiLi9JU3ludGhlc2lzQ29ubmVjdGlvbkZhY3RvcnlcIjtcbmV4cG9ydCAqIGZyb20gXCIuL0ludGVudENvbm5lY3Rpb25GYWN0b3J5XCI7XG5leHBvcnQgKiBmcm9tIFwiLi9TcGVha2VyUmVjb2duaXRpb25Db25uZWN0aW9uRmFjdG9yeVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vUmVjb2duaXRpb25FdmVudHNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1NlcnZpY2VSZWNvZ25pemVyQmFzZVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vQ29udmVyc2F0aW9uU2VydmljZVJlY29nbml6ZXJcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1JlY29nbml6ZXJDb25maWdcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1NwZWVjaFNlcnZpY2VJbnRlcmZhY2VzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9XZWJzb2NrZXRNZXNzYWdlRm9ybWF0dGVyXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9TcGVlY2hDb25uZWN0aW9uRmFjdG9yeVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vVHJhbnNjcmliZXJDb25uZWN0aW9uRmFjdG9yeVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vVHJhbnNsYXRpb25Db25uZWN0aW9uRmFjdG9yeVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vU3BlZWNoU3ludGhlc2lzQ29ubmVjdGlvbkZhY3RvcnlcIjtcbmV4cG9ydCAqIGZyb20gXCIuL0VudW1UcmFuc2xhdGlvblwiO1xuZXhwb3J0ICogZnJvbSBcIi4vU2VydmljZU1lc3NhZ2VzL0VudW1zXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9TZXJ2aWNlTWVzc2FnZXMvVHJhbnNsYXRpb25TeW50aGVzaXNFbmRcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1NlcnZpY2VNZXNzYWdlcy9UcmFuc2xhdGlvbkh5cG90aGVzaXNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1NlcnZpY2VNZXNzYWdlcy9UcmFuc2xhdGlvblBocmFzZVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vVHJhbnNsYXRpb25TZXJ2aWNlUmVjb2duaXplclwiO1xuZXhwb3J0ICogZnJvbSBcIi4vU2VydmljZU1lc3NhZ2VzL1NwZWVjaERldGVjdGVkXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9TZXJ2aWNlTWVzc2FnZXMvU3BlZWNoSHlwb3RoZXNpc1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vU2VydmljZU1lc3NhZ2VzL1NwZWVjaEtleXdvcmRcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1NwZWVjaFNlcnZpY2VSZWNvZ25pemVyXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9UcmFuc2NyaXB0aW9uU2VydmljZVJlY29nbml6ZXJcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1NlcnZpY2VNZXNzYWdlcy9EZXRhaWxlZFNwZWVjaFBocmFzZVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vU2VydmljZU1lc3NhZ2VzL1NpbXBsZVNwZWVjaFBocmFzZVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vQWRkZWRMbUludGVudFwiO1xuZXhwb3J0ICogZnJvbSBcIi4vSW50ZW50U2VydmljZVJlY29nbml6ZXJcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1NlcnZpY2VNZXNzYWdlcy9JbnRlbnRSZXNwb25zZVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vU2VydmljZU1lc3NhZ2VzL1NwZWFrZXJSZXNwb25zZVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vUmVxdWVzdFNlc3Npb25cIjtcbmV4cG9ydCAqIGZyb20gXCIuL1NwZWVjaENvbnRleHRcIjtcbmV4cG9ydCAqIGZyb20gXCIuL0R5bmFtaWNHcmFtbWFyQnVpbGRlclwiO1xuZXhwb3J0ICogZnJvbSBcIi4vRHluYW1pY0dyYW1tYXJJbnRlcmZhY2VzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9EaWFsb2dTZXJ2aWNlQWRhcHRlclwiO1xuZXhwb3J0ICogZnJvbSBcIi4vQWdlbnRDb25maWdcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1RyYW5zY3JpcHRpb24vRXhwb3J0c1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vU2VydmljZU1lc3NhZ2VzL1N5bnRoZXNpc0F1ZGlvTWV0YWRhdGFcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1N5bnRoZXNpc1R1cm5cIjtcbmV4cG9ydCAqIGZyb20gXCIuL1N5bnRoZXNpc0FkYXB0ZXJCYXNlXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9TeW50aGVzaXNSZXN0QWRhcHRlclwiO1xuZXhwb3J0ICogZnJvbSBcIi4vU3ludGhlc2l6ZXJDb25maWdcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1N5bnRoZXNpc0NvbnRleHRcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1NwZWFrZXJSZWNvZ25pdGlvbkNvbmZpZ1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vU3BlYWtlclNlcnZpY2VSZWNvZ25pemVyXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9Wb2ljZVNlcnZpY2VSZWNvZ25pemVyXCI7XG5leHBvcnQgY29uc3QgT3V0cHV0Rm9ybWF0UHJvcGVydHlOYW1lID0gXCJPdXRwdXRGb3JtYXRcIjtcbmV4cG9ydCBjb25zdCBDYW5jZWxsYXRpb25FcnJvckNvZGVQcm9wZXJ0eU5hbWUgPSBcIkNhbmNlbGxhdGlvbkVycm9yQ29kZVwiO1xuZXhwb3J0IGNvbnN0IFNlcnZpY2VQcm9wZXJ0aWVzUHJvcGVydHlOYW1lID0gXCJTZXJ2aWNlUHJvcGVydGllc1wiO1xuZXhwb3J0IGNvbnN0IEZvcmNlRGljdGF0aW9uUHJvcGVydHlOYW1lID0gXCJGb3JjZURpY3RhdGlvblwiO1xuZXhwb3J0IGNvbnN0IEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXNPcGVuUmFuZ2VPcHRpb25OYW1lID0gXCJPcGVuUmFuZ2VcIjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9RXhwb3J0cy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuZXhwb3J0IGNsYXNzIEhlYWRlck5hbWVzIHtcbn1cbkhlYWRlck5hbWVzLkF1dGhLZXkgPSBcIk9jcC1BcGltLVN1YnNjcmlwdGlvbi1LZXlcIjtcbkhlYWRlck5hbWVzLkF1dGhvcml6YXRpb24gPSBcIkF1dGhvcml6YXRpb25cIjtcbkhlYWRlck5hbWVzLlNwSURBdXRoS2V5ID0gXCJBcGltLVN1YnNjcmlwdGlvbi1JZFwiO1xuSGVhZGVyTmFtZXMuQ29ubmVjdGlvbklkID0gXCJYLUNvbm5lY3Rpb25JZFwiO1xuSGVhZGVyTmFtZXMuQ29udGVudFR5cGUgPSBcIkNvbnRlbnQtVHlwZVwiO1xuSGVhZGVyTmFtZXMuQ3VzdG9tQ29tbWFuZHNBcHBJZCA9IFwiWC1Db21tYW5kc0FwcElkXCI7XG5IZWFkZXJOYW1lcy5QYXRoID0gXCJQYXRoXCI7XG5IZWFkZXJOYW1lcy5SZXF1ZXN0SWQgPSBcIlgtUmVxdWVzdElkXCI7XG5IZWFkZXJOYW1lcy5SZXF1ZXN0U3RyZWFtSWQgPSBcIlgtU3RyZWFtSWRcIjtcbkhlYWRlck5hbWVzLlJlcXVlc3RUaW1lc3RhbXAgPSBcIlgtVGltZXN0YW1wXCI7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUhlYWRlck5hbWVzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5leHBvcnQgY2xhc3MgQXV0aEluZm8ge1xuICAgIGNvbnN0cnVjdG9yKGhlYWRlck5hbWUsIHRva2VuKSB7XG4gICAgICAgIHRoaXMucHJpdkhlYWRlck5hbWUgPSBoZWFkZXJOYW1lO1xuICAgICAgICB0aGlzLnByaXZUb2tlbiA9IHRva2VuO1xuICAgIH1cbiAgICBnZXQgaGVhZGVyTmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkhlYWRlck5hbWU7XG4gICAgfVxuICAgIGdldCB0b2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRva2VuO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9SUF1dGhlbnRpY2F0aW9uLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUlDb25uZWN0aW9uRmFjdG9yeS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1JU3ludGhlc2lzQ29ubmVjdGlvbkZhY3RvcnkuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFByb3h5SW5mbywgV2Vic29ja2V0Q29ubmVjdGlvbiwgfSBmcm9tIFwiLi4vY29tbW9uLmJyb3dzZXIvRXhwb3J0c1wiO1xuaW1wb3J0IHsgUHJvcGVydHlJZCB9IGZyb20gXCIuLi9zZGsvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29ubmVjdGlvbkZhY3RvcnlCYXNlIH0gZnJvbSBcIi4vQ29ubmVjdGlvbkZhY3RvcnlCYXNlXCI7XG5pbXBvcnQgeyBXZWJzb2NrZXRNZXNzYWdlRm9ybWF0dGVyLCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbmltcG9ydCB7IEhlYWRlck5hbWVzIH0gZnJvbSBcIi4vSGVhZGVyTmFtZXNcIjtcbmV4cG9ydCBjbGFzcyBJbnRlbnRDb25uZWN0aW9uRmFjdG9yeSBleHRlbmRzIENvbm5lY3Rpb25GYWN0b3J5QmFzZSB7XG4gICAgY3JlYXRlKGNvbmZpZywgYXV0aEluZm8sIGNvbm5lY3Rpb25JZCkge1xuICAgICAgICBsZXQgZW5kcG9pbnQgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50KTtcbiAgICAgICAgaWYgKCFlbmRwb2ludCkge1xuICAgICAgICAgICAgY29uc3QgcmVnaW9uID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9JbnRlbnRSZWdpb24pO1xuICAgICAgICAgICAgY29uc3QgaG9zdFN1ZmZpeCA9IENvbm5lY3Rpb25GYWN0b3J5QmFzZS5nZXRIb3N0U3VmZml4KHJlZ2lvbik7XG4gICAgICAgICAgICBjb25zdCBob3N0ID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Ib3N0LCBcIndzczovL1wiICsgcmVnaW9uICsgXCIuc3Iuc3BlZWNoXCIgKyBob3N0U3VmZml4KTtcbiAgICAgICAgICAgIGVuZHBvaW50ID0gaG9zdCArIFwiL3NwZWVjaC9yZWNvZ25pdGlvbi9pbnRlcmFjdGl2ZS9jb2duaXRpdmVzZXJ2aWNlcy92MVwiO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHF1ZXJ5UGFyYW1zID0ge1xuICAgICAgICAgICAgZm9ybWF0OiBcInNpbXBsZVwiLFxuICAgICAgICAgICAgbGFuZ3VhZ2U6IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlKSxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zZXRDb21tb25VcmxQYXJhbXMoY29uZmlnLCBxdWVyeVBhcmFtcywgZW5kcG9pbnQpO1xuICAgICAgICBjb25zdCBoZWFkZXJzID0ge307XG4gICAgICAgIGlmIChhdXRoSW5mby50b2tlbiAhPT0gdW5kZWZpbmVkICYmIGF1dGhJbmZvLnRva2VuICE9PSBcIlwiKSB7XG4gICAgICAgICAgICBoZWFkZXJzW2F1dGhJbmZvLmhlYWRlck5hbWVdID0gYXV0aEluZm8udG9rZW47XG4gICAgICAgIH1cbiAgICAgICAgaGVhZGVyc1tIZWFkZXJOYW1lcy5Db25uZWN0aW9uSWRdID0gY29ubmVjdGlvbklkO1xuICAgICAgICBjb25maWcucGFyYW1ldGVycy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1VybCwgZW5kcG9pbnQpO1xuICAgICAgICBjb25zdCBlbmFibGVDb21wcmVzc2lvbiA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFwiU1BFRUNILUVuYWJsZVdlYnNvY2tldENvbXByZXNzaW9uXCIsIFwiZmFsc2VcIikgPT09IFwidHJ1ZVwiO1xuICAgICAgICByZXR1cm4gbmV3IFdlYnNvY2tldENvbm5lY3Rpb24oZW5kcG9pbnQsIHF1ZXJ5UGFyYW1zLCBoZWFkZXJzLCBuZXcgV2Vic29ja2V0TWVzc2FnZUZvcm1hdHRlcigpLCBQcm94eUluZm8uZnJvbVJlY29nbml6ZXJDb25maWcoY29uZmlnKSwgZW5hYmxlQ29tcHJlc3Npb24sIGNvbm5lY3Rpb25JZCk7XG4gICAgfVxuICAgIGdldFNwZWVjaFJlZ2lvbkZyb21JbnRlbnRSZWdpb24oaW50ZW50UmVnaW9uKSB7XG4gICAgICAgIHN3aXRjaCAoaW50ZW50UmVnaW9uKSB7XG4gICAgICAgICAgICBjYXNlIFwiV2VzdCBVU1wiOlxuICAgICAgICAgICAgY2FzZSBcIlVTIFdlc3RcIjpcbiAgICAgICAgICAgIGNhc2UgXCJ3ZXN0dXNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJ1c3dlc3RcIjtcbiAgICAgICAgICAgIGNhc2UgXCJXZXN0IFVTIDJcIjpcbiAgICAgICAgICAgIGNhc2UgXCJVUyBXZXN0IDJcIjpcbiAgICAgICAgICAgIGNhc2UgXCJ3ZXN0dXMyXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwidXN3ZXN0MlwiO1xuICAgICAgICAgICAgY2FzZSBcIlNvdXRoIENlbnRyYWwgVVNcIjpcbiAgICAgICAgICAgIGNhc2UgXCJVUyBTb3V0aCBDZW50cmFsXCI6XG4gICAgICAgICAgICBjYXNlIFwic291dGhjZW50cmFsdXNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJ1c3NvdXRoY2VudHJhbFwiO1xuICAgICAgICAgICAgY2FzZSBcIldlc3QgQ2VudHJhbCBVU1wiOlxuICAgICAgICAgICAgY2FzZSBcIlVTIFdlc3QgQ2VudHJhbFwiOlxuICAgICAgICAgICAgY2FzZSBcIndlc3RjZW50cmFsdXNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJ1c3dlc3RjZW50cmFsXCI7XG4gICAgICAgICAgICBjYXNlIFwiRWFzdCBVU1wiOlxuICAgICAgICAgICAgY2FzZSBcIlVTIEVhc3RcIjpcbiAgICAgICAgICAgIGNhc2UgXCJlYXN0dXNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJ1c2Vhc3RcIjtcbiAgICAgICAgICAgIGNhc2UgXCJFYXN0IFVTIDJcIjpcbiAgICAgICAgICAgIGNhc2UgXCJVUyBFYXN0IDJcIjpcbiAgICAgICAgICAgIGNhc2UgXCJlYXN0dXMyXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwidXNlYXN0MlwiO1xuICAgICAgICAgICAgY2FzZSBcIldlc3QgRXVyb3BlXCI6XG4gICAgICAgICAgICBjYXNlIFwiRXVyb3BlIFdlc3RcIjpcbiAgICAgICAgICAgIGNhc2UgXCJ3ZXN0ZXVyb3BlXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiZXVyb3Bld2VzdFwiO1xuICAgICAgICAgICAgY2FzZSBcIk5vcnRoIEV1cm9wZVwiOlxuICAgICAgICAgICAgY2FzZSBcIkV1cm9wZSBOb3J0aFwiOlxuICAgICAgICAgICAgY2FzZSBcIm5vcnRoZXVyb3BlXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiZXVyb3Blbm9ydGhcIjtcbiAgICAgICAgICAgIGNhc2UgXCJCcmF6aWwgU291dGhcIjpcbiAgICAgICAgICAgIGNhc2UgXCJTb3V0aCBCcmF6aWxcIjpcbiAgICAgICAgICAgIGNhc2UgXCJzb3V0aGJyYXppbFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcImJyYXppbHNvdXRoXCI7XG4gICAgICAgICAgICBjYXNlIFwiQXVzdHJhbGlhIEVhc3RcIjpcbiAgICAgICAgICAgIGNhc2UgXCJFYXN0IEF1c3RyYWxpYVwiOlxuICAgICAgICAgICAgY2FzZSBcImVhc3RhdXN0cmFsaWFcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJhdXN0cmFsaWFlYXN0XCI7XG4gICAgICAgICAgICBjYXNlIFwiU291dGhlYXN0IEFzaWFcIjpcbiAgICAgICAgICAgIGNhc2UgXCJBc2lhIFNvdXRoZWFzdFwiOlxuICAgICAgICAgICAgY2FzZSBcInNvdXRoZWFzdGFzaWFcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJhc2lhc291dGhlYXN0XCI7XG4gICAgICAgICAgICBjYXNlIFwiRWFzdCBBc2lhXCI6XG4gICAgICAgICAgICBjYXNlIFwiQXNpYSBFYXN0XCI6XG4gICAgICAgICAgICBjYXNlIFwiZWFzdGFzaWFcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJhc2lhZWFzdFwiO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gaW50ZW50UmVnaW9uO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1JbnRlbnRDb25uZWN0aW9uRmFjdG9yeS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgRGVmZXJyZWQsIE1lc3NhZ2VUeXBlLCB9IGZyb20gXCIuLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLCBJbnRlbnRSZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzLCBJbnRlbnRSZWNvZ25pdGlvbkV2ZW50QXJncywgSW50ZW50UmVjb2duaXRpb25SZXN1bHQsIFByb3BlcnR5Q29sbGVjdGlvbiwgUHJvcGVydHlJZCwgUmVzdWx0UmVhc29uLCB9IGZyb20gXCIuLi9zZGsvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlUHJvcGVydHlOYW1lLCBFbnVtVHJhbnNsYXRpb24sIEludGVudFJlc3BvbnNlLCBTZXJ2aWNlUmVjb2duaXplckJhc2UsIFNpbXBsZVNwZWVjaFBocmFzZSwgU3BlZWNoSHlwb3RoZXNpcywgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWNsYXNzZXMtcGVyLWZpbGVcbmV4cG9ydCBjbGFzcyBJbnRlbnRTZXJ2aWNlUmVjb2duaXplciBleHRlbmRzIFNlcnZpY2VSZWNvZ25pemVyQmFzZSB7XG4gICAgY29uc3RydWN0b3IoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb1NvdXJjZSwgcmVjb2duaXplckNvbmZpZywgcmVjb2duaXplcikge1xuICAgICAgICBzdXBlcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvU291cmNlLCByZWNvZ25pemVyQ29uZmlnLCByZWNvZ25pemVyKTtcbiAgICAgICAgdGhpcy5wcml2SW50ZW50UmVjb2duaXplciA9IHJlY29nbml6ZXI7XG4gICAgICAgIHRoaXMucHJpdkludGVudERhdGFTZW50ID0gZmFsc2U7XG4gICAgfVxuICAgIHNldEludGVudHMoYWRkZWRJbnRlbnRzLCB1bWJyZWxsYUludGVudCkge1xuICAgICAgICB0aGlzLnByaXZBZGRlZExtSW50ZW50cyA9IGFkZGVkSW50ZW50cztcbiAgICAgICAgdGhpcy5wcml2VW1icmVsbGFJbnRlbnQgPSB1bWJyZWxsYUludGVudDtcbiAgICAgICAgdGhpcy5wcml2SW50ZW50RGF0YVNlbnQgPSB0cnVlO1xuICAgIH1cbiAgICBwcm9jZXNzVHlwZVNwZWNpZmljTWVzc2FnZXMoY29ubmVjdGlvbk1lc3NhZ2UpIHtcbiAgICAgICAgbGV0IHJlc3VsdDtcbiAgICAgICAgbGV0IGV2O1xuICAgICAgICBsZXQgcHJvY2Vzc2VkID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IHJlc3VsdFByb3BzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICBpZiAoY29ubmVjdGlvbk1lc3NhZ2UubWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLlRleHQpIHtcbiAgICAgICAgICAgIHJlc3VsdFByb3BzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZVJlc3BvbnNlX0pzb25SZXN1bHQsIGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKGNvbm5lY3Rpb25NZXNzYWdlLnBhdGgudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgY2FzZSBcInNwZWVjaC5oeXBvdGhlc2lzXCI6XG4gICAgICAgICAgICAgICAgY29uc3Qgc3BlZWNoSHlwb3RoZXNpcyA9IFNwZWVjaEh5cG90aGVzaXMuZnJvbUpTT04oY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBJbnRlbnRSZWNvZ25pdGlvblJlc3VsdCh1bmRlZmluZWQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgUmVzdWx0UmVhc29uLlJlY29nbml6aW5nSW50ZW50LCBzcGVlY2hIeXBvdGhlc2lzLlRleHQsIHNwZWVjaEh5cG90aGVzaXMuRHVyYXRpb24sIHNwZWVjaEh5cG90aGVzaXMuT2Zmc2V0ICsgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uY3VycmVudFR1cm5BdWRpb09mZnNldCwgc3BlZWNoSHlwb3RoZXNpcy5MYW5ndWFnZSwgc3BlZWNoSHlwb3RoZXNpcy5MYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UsIHVuZGVmaW5lZCwgY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHksIHJlc3VsdFByb3BzKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vbkh5cG90aGVzaXMocmVzdWx0Lm9mZnNldCk7XG4gICAgICAgICAgICAgICAgZXYgPSBuZXcgSW50ZW50UmVjb2duaXRpb25FdmVudEFyZ3MocmVzdWx0LCBzcGVlY2hIeXBvdGhlc2lzLk9mZnNldCArIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmN1cnJlbnRUdXJuQXVkaW9PZmZzZXQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2SW50ZW50UmVjb2duaXplci5yZWNvZ25pemluZykge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2SW50ZW50UmVjb2duaXplci5yZWNvZ25pemluZyh0aGlzLnByaXZJbnRlbnRSZWNvZ25pemVyLCBldik7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90IGdvaW5nIHRvIGxldCBlcnJvcnMgaW4gdGhlIGV2ZW50IGhhbmRsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRyaXAgdGhpbmdzIHVwLlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHByb2Nlc3NlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwic3BlZWNoLnBocmFzZVwiOlxuICAgICAgICAgICAgICAgIGNvbnN0IHNpbXBsZSA9IFNpbXBsZVNwZWVjaFBocmFzZS5mcm9tSlNPTihjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gbmV3IEludGVudFJlY29nbml0aW9uUmVzdWx0KHVuZGVmaW5lZCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBFbnVtVHJhbnNsYXRpb24uaW1wbFRyYW5zbGF0ZVJlY29nbml0aW9uUmVzdWx0KHNpbXBsZS5SZWNvZ25pdGlvblN0YXR1cyksIHNpbXBsZS5EaXNwbGF5VGV4dCwgc2ltcGxlLkR1cmF0aW9uLCBzaW1wbGUuT2Zmc2V0ICsgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uY3VycmVudFR1cm5BdWRpb09mZnNldCwgc2ltcGxlLkxhbmd1YWdlLCBzaW1wbGUuTGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlLCB1bmRlZmluZWQsIGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5LCByZXN1bHRQcm9wcyk7XG4gICAgICAgICAgICAgICAgZXYgPSBuZXcgSW50ZW50UmVjb2duaXRpb25FdmVudEFyZ3MocmVzdWx0LCByZXN1bHQub2Zmc2V0LCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlbmRFdmVudCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2SW50ZW50UmVjb2duaXplci5yZWNvZ25pemVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkludGVudFJlY29nbml6ZXIucmVjb2duaXplZCh0aGlzLnByaXZJbnRlbnRSZWNvZ25pemVyLCBldik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdCBnb2luZyB0byBsZXQgZXJyb3JzIGluIHRoZSBldmVudCBoYW5kbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gcmVwb3J0IHJlc3VsdCB0byBwcm9taXNlLlxuICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkVycm9yQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2RXJyb3JDYWxsYmFjayhlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IGludm9rZSB0aGUgY2FsbCBiYWNrIG9uY2UuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhbmQgaWYgaXQncyBzdWNjZXNzZnVsIGRvbid0IGludm9rZSB0aGVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVycm9yIGFmdGVyIHRoYXQuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZFcnJvckNhbGxiYWNrID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAvLyBJZiBpbnRlbnQgZGF0YSB3YXMgc2VudCwgdGhlIHRlcm1pbmFsIHJlc3VsdCBmb3IgdGhpcyByZWNvZ25pemVyIGlzIGFuIGludGVudCBiZWluZyBmb3VuZC5cbiAgICAgICAgICAgICAgICAvLyBJZiBubyBpbnRlbnQgZGF0YSB3YXMgc2VudCwgdGhlIHRlcm1pbmFsIGV2ZW50IGlzIHNwZWVjaCByZWNvZ25pdGlvbiBiZWluZyBzdWNjZXNzZnVsLlxuICAgICAgICAgICAgICAgIGlmIChmYWxzZSA9PT0gdGhpcy5wcml2SW50ZW50RGF0YVNlbnQgfHwgUmVzdWx0UmVhc29uLk5vTWF0Y2ggPT09IGV2LnJlc3VsdC5yZWFzb24pIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQWR2YW5jZSB0aGUgYnVmZmVycy5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25QaHJhc2VSZWNvZ25pemVkKGV2Lm9mZnNldCArIGV2LnJlc3VsdC5kdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHNlbmRFdmVudCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gU3F1aXJyZWwgYXdheSB0aGUgYXJncywgd2hlbiB0aGUgcmVzcG9uc2UgZXZlbnQgYXJyaXZlcyBpdCB3aWxsIGJ1aWxkIHVwb24gdGhlbVxuICAgICAgICAgICAgICAgICAgICAvLyBhbmQgdGhlbiByZXR1cm5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UGVuZGluZ0ludGVudEFyZ3MgPSBldjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcHJvY2Vzc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJyZXNwb25zZVwiOlxuICAgICAgICAgICAgICAgIC8vIFJlc3BvbnNlIGZyb20gTFVJU1xuICAgICAgICAgICAgICAgIGV2ID0gdGhpcy5wcml2UGVuZGluZ0ludGVudEFyZ3M7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UGVuZGluZ0ludGVudEFyZ3MgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gZXYpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKFwiXCIgPT09IGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGNvbmRpdGlvbiBoYXBwZW5zIGlmIHRoZXJlIGlzIG5vdGhpbmcgYnV0IHNpbGVuY2UgaW4gdGhlXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhdWRpbyBzZW50IHRvIHRoZSBzZXJ2aWNlLlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIE9kZC4uLiBOb3Qgc3VyZSB0aGlzIGNhbiBoYXBwZW5cbiAgICAgICAgICAgICAgICAgICAgZXYgPSBuZXcgSW50ZW50UmVjb2duaXRpb25FdmVudEFyZ3MobmV3IEludGVudFJlY29nbml0aW9uUmVzdWx0KCksIDAsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGludGVudFJlc3BvbnNlID0gSW50ZW50UmVzcG9uc2UuZnJvbUpTT04oY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgIC8vIElmIExVSVMgZGlkbid0IHJldHVybiBhbnl0aGluZywgc2VuZCB0aGUgZXhpc3RpbmcgZXZlbnQsIGVsc2VcbiAgICAgICAgICAgICAgICAvLyBtb2RpZnkgaXQgdG8gc2hvdyB0aGUgbWF0Y2guXG4gICAgICAgICAgICAgICAgLy8gU2VlIGlmIHRoZSBpbnRlbnQgZm91bmQgaXMgaW4gdGhlIGxpc3Qgb2YgaW50ZW50cyBhc2tlZCBmb3IuXG4gICAgICAgICAgICAgICAgaWYgKG51bGwgIT09IGludGVudFJlc3BvbnNlICYmICEhaW50ZW50UmVzcG9uc2UudG9wU2NvcmluZ0ludGVudCAmJiAhIWludGVudFJlc3BvbnNlLnRvcFNjb3JpbmdJbnRlbnQuaW50ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBhZGRlZEludGVudCA9IHRoaXMucHJpdkFkZGVkTG1JbnRlbnRzW2ludGVudFJlc3BvbnNlLnRvcFNjb3JpbmdJbnRlbnQuaW50ZW50XTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdlVtYnJlbGxhSW50ZW50ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZGVkSW50ZW50ID0gdGhpcy5wcml2VW1icmVsbGFJbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhYWRkZWRJbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGludGVudElkID0gYWRkZWRJbnRlbnQgPT09IHVuZGVmaW5lZCB8fCBhZGRlZEludGVudC5pbnRlbnROYW1lID09PSB1bmRlZmluZWQgPyBpbnRlbnRSZXNwb25zZS50b3BTY29yaW5nSW50ZW50LmludGVudCA6IGFkZGVkSW50ZW50LmludGVudE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVhc29uID0gZXYucmVzdWx0LnJlYXNvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1bmRlZmluZWQgIT09IGludGVudElkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uID0gUmVzdWx0UmVhc29uLlJlY29nbml6ZWRJbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBtYWtlIHN1cmUsIHByb3BlcnRpZXMgaXMgc2V0LlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJvcGVydGllcyA9ICh1bmRlZmluZWQgIT09IGV2LnJlc3VsdC5wcm9wZXJ0aWVzKSA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXYucmVzdWx0LnByb3BlcnRpZXMgOiBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuTGFuZ3VhZ2VVbmRlcnN0YW5kaW5nU2VydmljZVJlc3BvbnNlX0pzb25SZXN1bHQsIGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ID0gbmV3IEludGVudFJlY29nbml0aW9uRXZlbnRBcmdzKG5ldyBJbnRlbnRSZWNvZ25pdGlvblJlc3VsdChpbnRlbnRJZCwgZXYucmVzdWx0LnJlc3VsdElkLCByZWFzb24sIGV2LnJlc3VsdC50ZXh0LCBldi5yZXN1bHQuZHVyYXRpb24sIGV2LnJlc3VsdC5vZmZzZXQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBldi5yZXN1bHQuZXJyb3JEZXRhaWxzLCBldi5yZXN1bHQuanNvbiwgcHJvcGVydGllcyksIGV2Lm9mZnNldCwgZXYuc2Vzc2lvbklkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblBocmFzZVJlY29nbml6ZWQoZXYub2Zmc2V0ICsgZXYucmVzdWx0LmR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZJbnRlbnRSZWNvZ25pemVyLnJlY29nbml6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkludGVudFJlY29nbml6ZXIucmVjb2duaXplZCh0aGlzLnByaXZJbnRlbnRSZWNvZ25pemVyLCBldik7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90IGdvaW5nIHRvIGxldCBlcnJvcnMgaW4gdGhlIGV2ZW50IGhhbmRsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRyaXAgdGhpbmdzIHVwLlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIHJlcG9ydCByZXN1bHQgdG8gcHJvbWlzZS5cbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayhldi5yZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZFcnJvckNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2RXJyb3JDYWxsYmFjayhlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IGludm9rZSB0aGUgY2FsbCBiYWNrIG9uY2UuXG4gICAgICAgICAgICAgICAgICAgIC8vIGFuZCBpZiBpdCdzIHN1Y2Nlc3NmdWwgZG9uJ3QgaW52b2tlIHRoZVxuICAgICAgICAgICAgICAgICAgICAvLyBlcnJvciBhZnRlciB0aGF0LlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkVycm9yQ2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHByb2Nlc3NlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRlZmZlcmFsID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgIGRlZmZlcmFsLnJlc29sdmUocHJvY2Vzc2VkKTtcbiAgICAgICAgcmV0dXJuIGRlZmZlcmFsLnByb21pc2U7XG4gICAgfVxuICAgIC8vIENhbmNlbHMgcmVjb2duaXRpb24uXG4gICAgY2FuY2VsUmVjb2duaXRpb24oc2Vzc2lvbklkLCByZXF1ZXN0SWQsIGNhbmNlbGxhdGlvblJlYXNvbiwgZXJyb3JDb2RlLCBlcnJvcikge1xuICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICBwcm9wZXJ0aWVzLnNldFByb3BlcnR5KENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW2Vycm9yQ29kZV0pO1xuICAgICAgICBpZiAoISF0aGlzLnByaXZJbnRlbnRSZWNvZ25pemVyLmNhbmNlbGVkKSB7XG4gICAgICAgICAgICBjb25zdCBjYW5jZWxFdmVudCA9IG5ldyBJbnRlbnRSZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzKGNhbmNlbGxhdGlvblJlYXNvbiwgZXJyb3IsIGVycm9yQ29kZSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHNlc3Npb25JZCk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkludGVudFJlY29nbml6ZXIuY2FuY2VsZWQodGhpcy5wcml2SW50ZW50UmVjb2duaXplciwgY2FuY2VsRXZlbnQpO1xuICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoX2EpIHsgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghIXRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjaykge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IEludGVudFJlY29nbml0aW9uUmVzdWx0KHVuZGVmaW5lZCwgLy8gSW50ZW50IElkXG4gICAgICAgICAgICByZXF1ZXN0SWQsIFJlc3VsdFJlYXNvbi5DYW5jZWxlZCwgdW5kZWZpbmVkLCAvLyBUZXh0XG4gICAgICAgICAgICB1bmRlZmluZWQsIC8vIER1cmF0aW9uXG4gICAgICAgICAgICB1bmRlZmluZWQsIC8vIE9mZnNldFxuICAgICAgICAgICAgdW5kZWZpbmVkLCAvLyBMYW5ndWFnZVxuICAgICAgICAgICAgdW5kZWZpbmVkLCAvLyBMYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2VcbiAgICAgICAgICAgIGVycm9yLCB1bmRlZmluZWQsIC8vIEpzb25cbiAgICAgICAgICAgIHByb3BlcnRpZXMpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2socmVzdWx0KTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChfYikgeyB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUludGVudFNlcnZpY2VSZWNvZ25pemVyLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5leHBvcnQgY2xhc3MgUXVlcnlQYXJhbWV0ZXJOYW1lcyB7XG59XG5RdWVyeVBhcmFtZXRlck5hbWVzLkJvdElkID0gXCJib3RpZFwiO1xuUXVlcnlQYXJhbWV0ZXJOYW1lcy5DdXN0b21TcGVlY2hEZXBsb3ltZW50SWQgPSBcImNpZFwiO1xuUXVlcnlQYXJhbWV0ZXJOYW1lcy5DdXN0b21Wb2ljZURlcGxveW1lbnRJZCA9IFwiZGVwbG95bWVudElkXCI7XG5RdWVyeVBhcmFtZXRlck5hbWVzLkVuYWJsZUF1ZGlvTG9nZ2luZyA9IFwic3RvcmVBdWRpb1wiO1xuUXVlcnlQYXJhbWV0ZXJOYW1lcy5FbmFibGVMYW5ndWFnZUlkID0gXCJsaWRFbmFibGVkXCI7XG5RdWVyeVBhcmFtZXRlck5hbWVzLkVuYWJsZVdvcmRMZXZlbFRpbWVzdGFtcHMgPSBcIndvcmRMZXZlbFRpbWVzdGFtcHNcIjtcblF1ZXJ5UGFyYW1ldGVyTmFtZXMuRW5kU2lsZW5jZVRpbWVvdXRNcyA9IFwiZW5kU2lsZW5jZVRpbWVvdXRNc1wiO1xuUXVlcnlQYXJhbWV0ZXJOYW1lcy5TZWdtZW50YXRpb25TaWxlbmNlVGltZW91dE1zID0gXCJzZWdtZW50YXRpb25TaWxlbmNlVGltZW91dE1zXCI7XG5RdWVyeVBhcmFtZXRlck5hbWVzLkZvcm1hdCA9IFwiZm9ybWF0XCI7XG5RdWVyeVBhcmFtZXRlck5hbWVzLkluaXRpYWxTaWxlbmNlVGltZW91dE1zID0gXCJpbml0aWFsU2lsZW5jZVRpbWVvdXRNc1wiO1xuUXVlcnlQYXJhbWV0ZXJOYW1lcy5MYW5ndWFnZSA9IFwibGFuZ3VhZ2VcIjtcblF1ZXJ5UGFyYW1ldGVyTmFtZXMuUHJvZmFuaXR5ID0gXCJwcm9mYW5pdHlcIjtcblF1ZXJ5UGFyYW1ldGVyTmFtZXMuUmVxdWVzdEJvdFN0YXR1c01lc3NhZ2VzID0gXCJlbmFibGVCb3RNZXNzYWdlU3RhdHVzXCI7XG5RdWVyeVBhcmFtZXRlck5hbWVzLlN0YWJsZUludGVybWVkaWF0ZVRocmVzaG9sZCA9IFwic3RhYmxlSW50ZXJtZWRpYXRlVGhyZXNob2xkXCI7XG5RdWVyeVBhcmFtZXRlck5hbWVzLlN0YWJsZVRyYW5zbGF0aW9uID0gXCJzdGFibGVUcmFuc2xhdGlvblwiO1xuUXVlcnlQYXJhbWV0ZXJOYW1lcy5UZXN0SG9va3MgPSBcInRlc3Rob29rc1wiO1xuUXVlcnlQYXJhbWV0ZXJOYW1lcy5Qb3N0cHJvY2Vzc2luZyA9IFwicG9zdHByb2Nlc3NpbmdcIjtcblF1ZXJ5UGFyYW1ldGVyTmFtZXMuQ3RzTWVldGluZ0lkID0gXCJtZWV0aW5nSWRcIjtcblF1ZXJ5UGFyYW1ldGVyTmFtZXMuQ3RzRGV2aWNlSWQgPSBcImRldmljZUlkXCI7XG5RdWVyeVBhcmFtZXRlck5hbWVzLkN0c0lzUGFydGljaXBhbnQgPSBcImlzUGFydGljaXBhbnRcIjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UXVlcnlQYXJhbWV0ZXJOYW1lcy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyogZXNsaW50LWRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGUgKi9cbmltcG9ydCB7IEV2ZW50VHlwZSwgUGxhdGZvcm1FdmVudCB9IGZyb20gXCIuLi9jb21tb24vRXhwb3J0c1wiO1xuZXhwb3J0IGNsYXNzIFNwZWVjaFJlY29nbml0aW9uRXZlbnQgZXh0ZW5kcyBQbGF0Zm9ybUV2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihldmVudE5hbWUsIHJlcXVlc3RJZCwgc2Vzc2lvbklkLCBldmVudFR5cGUgPSBFdmVudFR5cGUuSW5mbykge1xuICAgICAgICBzdXBlcihldmVudE5hbWUsIGV2ZW50VHlwZSk7XG4gICAgICAgIHRoaXMucHJpdlJlcXVlc3RJZCA9IHJlcXVlc3RJZDtcbiAgICAgICAgdGhpcy5wcml2U2Vzc2lvbklkID0gc2Vzc2lvbklkO1xuICAgIH1cbiAgICBnZXQgcmVxdWVzdElkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVxdWVzdElkO1xuICAgIH1cbiAgICBnZXQgc2Vzc2lvbklkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U2Vzc2lvbklkO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBSZWNvZ25pdGlvblRyaWdnZXJlZEV2ZW50IGV4dGVuZHMgU3BlZWNoUmVjb2duaXRpb25FdmVudCB7XG4gICAgY29uc3RydWN0b3IocmVxdWVzdElkLCBzZXNzaW9uSWQsIGF1ZGlvU291cmNlSWQsIGF1ZGlvTm9kZUlkKSB7XG4gICAgICAgIHN1cGVyKFwiUmVjb2duaXRpb25UcmlnZ2VyZWRFdmVudFwiLCByZXF1ZXN0SWQsIHNlc3Npb25JZCk7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvU291cmNlSWQgPSBhdWRpb1NvdXJjZUlkO1xuICAgICAgICB0aGlzLnByaXZBdWRpb05vZGVJZCA9IGF1ZGlvTm9kZUlkO1xuICAgIH1cbiAgICBnZXQgYXVkaW9Tb3VyY2VJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvU291cmNlSWQ7XG4gICAgfVxuICAgIGdldCBhdWRpb05vZGVJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvTm9kZUlkO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBMaXN0ZW5pbmdTdGFydGVkRXZlbnQgZXh0ZW5kcyBTcGVlY2hSZWNvZ25pdGlvbkV2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihyZXF1ZXN0SWQsIHNlc3Npb25JZCwgYXVkaW9Tb3VyY2VJZCwgYXVkaW9Ob2RlSWQpIHtcbiAgICAgICAgc3VwZXIoXCJMaXN0ZW5pbmdTdGFydGVkRXZlbnRcIiwgcmVxdWVzdElkLCBzZXNzaW9uSWQpO1xuICAgICAgICB0aGlzLnByaXZBdWRpb1NvdXJjZUlkID0gYXVkaW9Tb3VyY2VJZDtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9Ob2RlSWQgPSBhdWRpb05vZGVJZDtcbiAgICB9XG4gICAgZ2V0IGF1ZGlvU291cmNlSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb1NvdXJjZUlkO1xuICAgIH1cbiAgICBnZXQgYXVkaW9Ob2RlSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb05vZGVJZDtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgQ29ubmVjdGluZ1RvU2VydmljZUV2ZW50IGV4dGVuZHMgU3BlZWNoUmVjb2duaXRpb25FdmVudCB7XG4gICAgY29uc3RydWN0b3IocmVxdWVzdElkLCBhdXRoRmV0Y2hFdmVudGlkLCBzZXNzaW9uSWQpIHtcbiAgICAgICAgc3VwZXIoXCJDb25uZWN0aW5nVG9TZXJ2aWNlRXZlbnRcIiwgcmVxdWVzdElkLCBzZXNzaW9uSWQpO1xuICAgICAgICB0aGlzLnByaXZBdXRoRmV0Y2hFdmVudGlkID0gYXV0aEZldGNoRXZlbnRpZDtcbiAgICB9XG4gICAgZ2V0IGF1dGhGZXRjaEV2ZW50aWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdXRoRmV0Y2hFdmVudGlkO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBSZWNvZ25pdGlvblN0YXJ0ZWRFdmVudCBleHRlbmRzIFNwZWVjaFJlY29nbml0aW9uRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKHJlcXVlc3RJZCwgYXVkaW9Tb3VyY2VJZCwgYXVkaW9Ob2RlSWQsIGF1dGhGZXRjaEV2ZW50SWQsIHNlc3Npb25JZCkge1xuICAgICAgICBzdXBlcihcIlJlY29nbml0aW9uU3RhcnRlZEV2ZW50XCIsIHJlcXVlc3RJZCwgc2Vzc2lvbklkKTtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9Tb3VyY2VJZCA9IGF1ZGlvU291cmNlSWQ7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvTm9kZUlkID0gYXVkaW9Ob2RlSWQ7XG4gICAgICAgIHRoaXMucHJpdkF1dGhGZXRjaEV2ZW50SWQgPSBhdXRoRmV0Y2hFdmVudElkO1xuICAgIH1cbiAgICBnZXQgYXVkaW9Tb3VyY2VJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvU291cmNlSWQ7XG4gICAgfVxuICAgIGdldCBhdWRpb05vZGVJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvTm9kZUlkO1xuICAgIH1cbiAgICBnZXQgYXV0aEZldGNoRXZlbnRJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1dGhGZXRjaEV2ZW50SWQ7XG4gICAgfVxufVxuZXhwb3J0IHZhciBSZWNvZ25pdGlvbkNvbXBsZXRpb25TdGF0dXM7XG4oZnVuY3Rpb24gKFJlY29nbml0aW9uQ29tcGxldGlvblN0YXR1cykge1xuICAgIFJlY29nbml0aW9uQ29tcGxldGlvblN0YXR1c1tSZWNvZ25pdGlvbkNvbXBsZXRpb25TdGF0dXNbXCJTdWNjZXNzXCJdID0gMF0gPSBcIlN1Y2Nlc3NcIjtcbiAgICBSZWNvZ25pdGlvbkNvbXBsZXRpb25TdGF0dXNbUmVjb2duaXRpb25Db21wbGV0aW9uU3RhdHVzW1wiQXVkaW9Tb3VyY2VFcnJvclwiXSA9IDFdID0gXCJBdWRpb1NvdXJjZUVycm9yXCI7XG4gICAgUmVjb2duaXRpb25Db21wbGV0aW9uU3RhdHVzW1JlY29nbml0aW9uQ29tcGxldGlvblN0YXR1c1tcIkF1ZGlvU291cmNlVGltZW91dFwiXSA9IDJdID0gXCJBdWRpb1NvdXJjZVRpbWVvdXRcIjtcbiAgICBSZWNvZ25pdGlvbkNvbXBsZXRpb25TdGF0dXNbUmVjb2duaXRpb25Db21wbGV0aW9uU3RhdHVzW1wiQXV0aFRva2VuRmV0Y2hFcnJvclwiXSA9IDNdID0gXCJBdXRoVG9rZW5GZXRjaEVycm9yXCI7XG4gICAgUmVjb2duaXRpb25Db21wbGV0aW9uU3RhdHVzW1JlY29nbml0aW9uQ29tcGxldGlvblN0YXR1c1tcIkF1dGhUb2tlbkZldGNoVGltZW91dFwiXSA9IDRdID0gXCJBdXRoVG9rZW5GZXRjaFRpbWVvdXRcIjtcbiAgICBSZWNvZ25pdGlvbkNvbXBsZXRpb25TdGF0dXNbUmVjb2duaXRpb25Db21wbGV0aW9uU3RhdHVzW1wiVW5BdXRob3JpemVkXCJdID0gNV0gPSBcIlVuQXV0aG9yaXplZFwiO1xuICAgIFJlY29nbml0aW9uQ29tcGxldGlvblN0YXR1c1tSZWNvZ25pdGlvbkNvbXBsZXRpb25TdGF0dXNbXCJDb25uZWN0VGltZW91dFwiXSA9IDZdID0gXCJDb25uZWN0VGltZW91dFwiO1xuICAgIFJlY29nbml0aW9uQ29tcGxldGlvblN0YXR1c1tSZWNvZ25pdGlvbkNvbXBsZXRpb25TdGF0dXNbXCJDb25uZWN0RXJyb3JcIl0gPSA3XSA9IFwiQ29ubmVjdEVycm9yXCI7XG4gICAgUmVjb2duaXRpb25Db21wbGV0aW9uU3RhdHVzW1JlY29nbml0aW9uQ29tcGxldGlvblN0YXR1c1tcIkNsaWVudFJlY29nbml0aW9uQWN0aXZpdHlUaW1lb3V0XCJdID0gOF0gPSBcIkNsaWVudFJlY29nbml0aW9uQWN0aXZpdHlUaW1lb3V0XCI7XG4gICAgUmVjb2duaXRpb25Db21wbGV0aW9uU3RhdHVzW1JlY29nbml0aW9uQ29tcGxldGlvblN0YXR1c1tcIlVua25vd25FcnJvclwiXSA9IDldID0gXCJVbmtub3duRXJyb3JcIjtcbn0pKFJlY29nbml0aW9uQ29tcGxldGlvblN0YXR1cyB8fCAoUmVjb2duaXRpb25Db21wbGV0aW9uU3RhdHVzID0ge30pKTtcbmV4cG9ydCBjbGFzcyBSZWNvZ25pdGlvbkVuZGVkRXZlbnQgZXh0ZW5kcyBTcGVlY2hSZWNvZ25pdGlvbkV2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihyZXF1ZXN0SWQsIGF1ZGlvU291cmNlSWQsIGF1ZGlvTm9kZUlkLCBhdXRoRmV0Y2hFdmVudElkLCBzZXNzaW9uSWQsIHNlcnZpY2VUYWcsIHN0YXR1cywgZXJyb3IpIHtcbiAgICAgICAgc3VwZXIoXCJSZWNvZ25pdGlvbkVuZGVkRXZlbnRcIiwgcmVxdWVzdElkLCBzZXNzaW9uSWQsIHN0YXR1cyA9PT0gUmVjb2duaXRpb25Db21wbGV0aW9uU3RhdHVzLlN1Y2Nlc3MgPyBFdmVudFR5cGUuSW5mbyA6IEV2ZW50VHlwZS5FcnJvcik7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvU291cmNlSWQgPSBhdWRpb1NvdXJjZUlkO1xuICAgICAgICB0aGlzLnByaXZBdWRpb05vZGVJZCA9IGF1ZGlvTm9kZUlkO1xuICAgICAgICB0aGlzLnByaXZBdXRoRmV0Y2hFdmVudElkID0gYXV0aEZldGNoRXZlbnRJZDtcbiAgICAgICAgdGhpcy5wcml2U3RhdHVzID0gc3RhdHVzO1xuICAgICAgICB0aGlzLnByaXZFcnJvciA9IGVycm9yO1xuICAgICAgICB0aGlzLnByaXZTZXJ2aWNlVGFnID0gc2VydmljZVRhZztcbiAgICB9XG4gICAgZ2V0IGF1ZGlvU291cmNlSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb1NvdXJjZUlkO1xuICAgIH1cbiAgICBnZXQgYXVkaW9Ob2RlSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb05vZGVJZDtcbiAgICB9XG4gICAgZ2V0IGF1dGhGZXRjaEV2ZW50SWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdXRoRmV0Y2hFdmVudElkO1xuICAgIH1cbiAgICBnZXQgc2VydmljZVRhZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNlcnZpY2VUYWc7XG4gICAgfVxuICAgIGdldCBzdGF0dXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTdGF0dXM7XG4gICAgfVxuICAgIGdldCBlcnJvcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkVycm9yO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UmVjb2duaXRpb25FdmVudHMuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qIGVzbGludC1kaXNhYmxlIG1heC1jbGFzc2VzLXBlci1maWxlICovXG5pbXBvcnQgeyBQcm9wZXJ0eUlkIH0gZnJvbSBcIi4uL3Nkay9FeHBvcnRzXCI7XG5leHBvcnQgdmFyIFJlY29nbml0aW9uTW9kZTtcbihmdW5jdGlvbiAoUmVjb2duaXRpb25Nb2RlKSB7XG4gICAgUmVjb2duaXRpb25Nb2RlW1JlY29nbml0aW9uTW9kZVtcIkludGVyYWN0aXZlXCJdID0gMF0gPSBcIkludGVyYWN0aXZlXCI7XG4gICAgUmVjb2duaXRpb25Nb2RlW1JlY29nbml0aW9uTW9kZVtcIkNvbnZlcnNhdGlvblwiXSA9IDFdID0gXCJDb252ZXJzYXRpb25cIjtcbiAgICBSZWNvZ25pdGlvbk1vZGVbUmVjb2duaXRpb25Nb2RlW1wiRGljdGF0aW9uXCJdID0gMl0gPSBcIkRpY3RhdGlvblwiO1xufSkoUmVjb2duaXRpb25Nb2RlIHx8IChSZWNvZ25pdGlvbk1vZGUgPSB7fSkpO1xuZXhwb3J0IHZhciBTcGVlY2hSZXN1bHRGb3JtYXQ7XG4oZnVuY3Rpb24gKFNwZWVjaFJlc3VsdEZvcm1hdCkge1xuICAgIFNwZWVjaFJlc3VsdEZvcm1hdFtTcGVlY2hSZXN1bHRGb3JtYXRbXCJTaW1wbGVcIl0gPSAwXSA9IFwiU2ltcGxlXCI7XG4gICAgU3BlZWNoUmVzdWx0Rm9ybWF0W1NwZWVjaFJlc3VsdEZvcm1hdFtcIkRldGFpbGVkXCJdID0gMV0gPSBcIkRldGFpbGVkXCI7XG59KShTcGVlY2hSZXN1bHRGb3JtYXQgfHwgKFNwZWVjaFJlc3VsdEZvcm1hdCA9IHt9KSk7XG5leHBvcnQgY2xhc3MgUmVjb2duaXplckNvbmZpZyB7XG4gICAgY29uc3RydWN0b3Ioc3BlZWNoU2VydmljZUNvbmZpZywgcGFyYW1ldGVycykge1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hTZXJ2aWNlQ29uZmlnID0gc3BlZWNoU2VydmljZUNvbmZpZyA/IHNwZWVjaFNlcnZpY2VDb25maWcgOiBuZXcgU3BlZWNoU2VydmljZUNvbmZpZyhuZXcgQ29udGV4dChudWxsKSk7XG4gICAgICAgIHRoaXMucHJpdlBhcmFtZXRlcnMgPSBwYXJhbWV0ZXJzO1xuICAgICAgICB0aGlzLnByaXZNYXhSZXRyeUNvdW50ID0gcGFyc2VJbnQocGFyYW1ldGVycy5nZXRQcm9wZXJ0eShcIlNQRUVDSC1FcnJvci1NYXhSZXRyeUNvdW50XCIsIFwiNFwiKSwgMTApO1xuICAgICAgICB0aGlzLnByaXZMYW5ndWFnZUlkTW9kZSA9IHBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9MYW5ndWFnZUlkTW9kZSwgdW5kZWZpbmVkKTtcbiAgICB9XG4gICAgZ2V0IHBhcmFtZXRlcnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQYXJhbWV0ZXJzO1xuICAgIH1cbiAgICBnZXQgcmVjb2duaXRpb25Nb2RlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVjb2duaXRpb25Nb2RlO1xuICAgIH1cbiAgICBzZXQgcmVjb2duaXRpb25Nb2RlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMucHJpdlJlY29nbml0aW9uTW9kZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLnByaXZSZWNvZ25pdGlvbkFjdGl2aXR5VGltZW91dCA9IHZhbHVlID09PSBSZWNvZ25pdGlvbk1vZGUuSW50ZXJhY3RpdmUgPyA4MDAwIDogMjUwMDA7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaFNlcnZpY2VDb25maWcuUmVjb2duaXRpb24gPSBSZWNvZ25pdGlvbk1vZGVbdmFsdWVdO1xuICAgIH1cbiAgICBnZXQgU3BlZWNoU2VydmljZUNvbmZpZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaFNlcnZpY2VDb25maWc7XG4gICAgfVxuICAgIGdldCByZWNvZ25pdGlvbkFjdGl2aXR5VGltZW91dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlY29nbml0aW9uQWN0aXZpdHlUaW1lb3V0O1xuICAgIH1cbiAgICBnZXQgaXNDb250aW51b3VzUmVjb2duaXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZWNvZ25pdGlvbk1vZGUgIT09IFJlY29nbml0aW9uTW9kZS5JbnRlcmFjdGl2ZTtcbiAgICB9XG4gICAgZ2V0IGxhbmd1YWdlSWRNb2RlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TGFuZ3VhZ2VJZE1vZGU7XG4gICAgfVxuICAgIGdldCBhdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlcywgdW5kZWZpbmVkKTtcbiAgICB9XG4gICAgZ2V0IHJlY29nbml0aW9uRW5kcG9pbnRWZXJzaW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb2duaXRpb25FbmRwb2ludFZlcnNpb24sIHVuZGVmaW5lZCk7XG4gICAgfVxuICAgIGdldCBzb3VyY2VMYW5ndWFnZU1vZGVscygpIHtcbiAgICAgICAgY29uc3QgbW9kZWxzID0gW107XG4gICAgICAgIGxldCBtb2RlbHNFeGlzdCA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5hdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbGFuZ3VhZ2Ugb2YgdGhpcy5hdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VzLnNwbGl0KFwiLFwiKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1c3RvbVByb3BlcnR5ID0gbGFuZ3VhZ2UgKyBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50SWQudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBtb2RlbElkID0gdGhpcy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KGN1c3RvbVByb3BlcnR5LCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgICAgIGlmIChtb2RlbElkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxzLnB1c2goeyBsYW5ndWFnZSwgZW5kcG9pbnQ6IG1vZGVsSWQgfSk7XG4gICAgICAgICAgICAgICAgICAgIG1vZGVsc0V4aXN0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG1vZGVscy5wdXNoKHsgbGFuZ3VhZ2UsIGVuZHBvaW50OiBcIlwiIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbW9kZWxzRXhpc3QgPyBtb2RlbHMgOiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGdldCBtYXhSZXRyeUNvdW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TWF4UmV0cnlDb3VudDtcbiAgICB9XG59XG4vLyBUaGUgY29uZmlnIGlzIHNlcmlhbGl6ZWQgYW5kIHNlbnQgYXMgdGhlIFNwZWVjaC5Db25maWdcbmV4cG9ydCBjbGFzcyBTcGVlY2hTZXJ2aWNlQ29uZmlnIHtcbiAgICBjb25zdHJ1Y3Rvcihjb250ZXh0KSB7XG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgfVxuICAgIHNlcmlhbGl6ZSgpIHtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMsIChrZXksIHZhbHVlKSA9PiB7XG4gICAgICAgICAgICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVwbGFjZW1lbnQgPSB7fTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGsgaW4gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHZhbHVlLCBrKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtYXNzaWdubWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZW1lbnRbayAmJiBrLmNoYXJBdCgwKS50b0xvd2VyQ2FzZSgpICsgay5zdWJzdHJpbmcoMSldID0gdmFsdWVba107XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcGxhY2VtZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZ2V0IENvbnRleHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQ7XG4gICAgfVxuICAgIGdldCBSZWNvZ25pdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVjb2duaXRpb247XG4gICAgfVxuICAgIHNldCBSZWNvZ25pdGlvbih2YWx1ZSkge1xuICAgICAgICB0aGlzLnJlY29nbml0aW9uID0gdmFsdWUudG9Mb3dlckNhc2UoKTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgQ29udGV4dCB7XG4gICAgY29uc3RydWN0b3Iob3MpIHtcbiAgICAgICAgdGhpcy5zeXN0ZW0gPSBuZXcgU3lzdGVtKCk7XG4gICAgICAgIHRoaXMub3MgPSBvcztcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgU3lzdGVtIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLy8gTm90ZTogYmVsb3cgd2lsbCBiZSBwYXRjaGVkIGZvciBvZmZpY2lhbCBidWlsZHMuXG4gICAgICAgIGNvbnN0IFNQRUVDSFNES19DTElFTlRTREtfVkVSU0lPTiA9IFwiMS4zMC4xXCI7XG4gICAgICAgIHRoaXMubmFtZSA9IFwiU3BlZWNoU0RLXCI7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IFNQRUVDSFNES19DTElFTlRTREtfVkVSU0lPTjtcbiAgICAgICAgdGhpcy5idWlsZCA9IFwiSmF2YVNjcmlwdFwiO1xuICAgICAgICB0aGlzLmxhbmcgPSBcIkphdmFTY3JpcHRcIjtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgT1Mge1xuICAgIGNvbnN0cnVjdG9yKHBsYXRmb3JtLCBuYW1lLCB2ZXJzaW9uKSB7XG4gICAgICAgIHRoaXMucGxhdGZvcm0gPSBwbGF0Zm9ybTtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gdmVyc2lvbjtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgRGV2aWNlIHtcbiAgICBjb25zdHJ1Y3RvcihtYW51ZmFjdHVyZXIsIG1vZGVsLCB2ZXJzaW9uKSB7XG4gICAgICAgIHRoaXMubWFudWZhY3R1cmVyID0gbWFudWZhY3R1cmVyO1xuICAgICAgICB0aGlzLm1vZGVsID0gbW9kZWw7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHZlcnNpb247XG4gICAgfVxufVxuZXhwb3J0IHZhciBjb25uZWN0aXZpdHk7XG4oZnVuY3Rpb24gKGNvbm5lY3Rpdml0eSkge1xuICAgIGNvbm5lY3Rpdml0eVtcIkJsdWV0b290aFwiXSA9IFwiQmx1ZXRvb3RoXCI7XG4gICAgY29ubmVjdGl2aXR5W1wiV2lyZWRcIl0gPSBcIldpcmVkXCI7XG4gICAgY29ubmVjdGl2aXR5W1wiV2lGaVwiXSA9IFwiV2lGaVwiO1xuICAgIGNvbm5lY3Rpdml0eVtcIkNlbGx1bGFyXCJdID0gXCJDZWxsdWxhclwiO1xuICAgIGNvbm5lY3Rpdml0eVtcIkluQnVpbHRcIl0gPSBcIkluQnVpbHRcIjtcbiAgICBjb25uZWN0aXZpdHlbXCJVbmtub3duXCJdID0gXCJVbmtub3duXCI7XG59KShjb25uZWN0aXZpdHkgfHwgKGNvbm5lY3Rpdml0eSA9IHt9KSk7XG5leHBvcnQgdmFyIHR5cGU7XG4oZnVuY3Rpb24gKHR5cGUpIHtcbiAgICB0eXBlW1wiUGhvbmVcIl0gPSBcIlBob25lXCI7XG4gICAgdHlwZVtcIlNwZWFrZXJcIl0gPSBcIlNwZWFrZXJcIjtcbiAgICB0eXBlW1wiQ2FyXCJdID0gXCJDYXJcIjtcbiAgICB0eXBlW1wiSGVhZHNldFwiXSA9IFwiSGVhZHNldFwiO1xuICAgIHR5cGVbXCJUaGVybW9zdGF0XCJdID0gXCJUaGVybW9zdGF0XCI7XG4gICAgdHlwZVtcIk1pY3JvcGhvbmVzXCJdID0gXCJNaWNyb3Bob25lc1wiO1xuICAgIHR5cGVbXCJEZXNrcGhvbmVcIl0gPSBcIkRlc2twaG9uZVwiO1xuICAgIHR5cGVbXCJSZW1vdGVDb250cm9sXCJdID0gXCJSZW1vdGVDb250cm9sXCI7XG4gICAgdHlwZVtcIlVua25vd25cIl0gPSBcIlVua25vd25cIjtcbiAgICB0eXBlW1wiRmlsZVwiXSA9IFwiRmlsZVwiO1xuICAgIHR5cGVbXCJTdHJlYW1cIl0gPSBcIlN0cmVhbVwiO1xufSkodHlwZSB8fCAodHlwZSA9IHt9KSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVJlY29nbml6ZXJDb25maWcuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgY3JlYXRlTm9EYXNoR3VpZCwgRGVmZXJyZWQsIEV2ZW50cyB9IGZyb20gXCIuLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29ubmVjdGluZ1RvU2VydmljZUV2ZW50LCBMaXN0ZW5pbmdTdGFydGVkRXZlbnQsIFJlY29nbml0aW9uU3RhcnRlZEV2ZW50LCBSZWNvZ25pdGlvblRyaWdnZXJlZEV2ZW50LCB9IGZyb20gXCIuL1JlY29nbml0aW9uRXZlbnRzXCI7XG5pbXBvcnQgeyBTZXJ2aWNlVGVsZW1ldHJ5TGlzdGVuZXIgfSBmcm9tIFwiLi9TZXJ2aWNlVGVsZW1ldHJ5TGlzdGVuZXIuSW50ZXJuYWxcIjtcbmV4cG9ydCBjbGFzcyBSZXF1ZXN0U2Vzc2lvbiB7XG4gICAgY29uc3RydWN0b3IoYXVkaW9Tb3VyY2VJZCkge1xuICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdkRldGFjaGFibGVzID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHRoaXMucHJpdklzQXVkaW9Ob2RlRGV0YWNoZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2SXNSZWNvZ25pemluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZJc1NwZWVjaEVuZGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdlR1cm5TdGFydEF1ZGlvT2Zmc2V0ID0gMDtcbiAgICAgICAgdGhpcy5wcml2TGFzdFJlY29PZmZzZXQgPSAwO1xuICAgICAgICB0aGlzLnByaXZIeXBvdGhlc2lzUmVjZWl2ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2Qnl0ZXNTZW50ID0gMDtcbiAgICAgICAgdGhpcy5wcml2UmVjb2dOdW1iZXIgPSAwO1xuICAgICAgICB0aGlzLnByaXZJblR1cm4gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkF0dGVtcHRzID0gMDtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9Tb3VyY2VJZCA9IGF1ZGlvU291cmNlSWQ7XG4gICAgICAgIHRoaXMucHJpdlJlcXVlc3RJZCA9IGNyZWF0ZU5vRGFzaEd1aWQoKTtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9Ob2RlSWQgPSBjcmVhdGVOb0Rhc2hHdWlkKCk7XG4gICAgICAgIHRoaXMucHJpdlR1cm5EZWZlcnJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICAvLyBXZSdyZSBub3QgaW4gYSB0dXJuLCBzbyByZXNvbHZlLlxuICAgICAgICB0aGlzLnByaXZUdXJuRGVmZXJyYWwucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBnZXQgc2Vzc2lvbklkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U2Vzc2lvbklkO1xuICAgIH1cbiAgICBnZXQgcmVxdWVzdElkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVxdWVzdElkO1xuICAgIH1cbiAgICBnZXQgYXVkaW9Ob2RlSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb05vZGVJZDtcbiAgICB9XG4gICAgZ2V0IHR1cm5Db21wbGV0aW9uUHJvbWlzZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlR1cm5EZWZlcnJhbC5wcm9taXNlO1xuICAgIH1cbiAgICBnZXQgaXNTcGVlY2hFbmRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzU3BlZWNoRW5kZWQ7XG4gICAgfVxuICAgIGdldCBpc1JlY29nbml6aW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SXNSZWNvZ25pemluZztcbiAgICB9XG4gICAgZ2V0IGN1cnJlbnRUdXJuQXVkaW9PZmZzZXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUdXJuU3RhcnRBdWRpb09mZnNldDtcbiAgICB9XG4gICAgZ2V0IHJlY29nTnVtYmVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVjb2dOdW1iZXI7XG4gICAgfVxuICAgIGdldCBudW1Db25uZWN0aW9uQXR0ZW1wdHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uQXR0ZW1wdHM7XG4gICAgfVxuICAgIC8vIFRoZSBudW1iZXIgb2YgYnl0ZXMgc2VudCBmb3IgdGhlIGN1cnJlbnQgY29ubmVjdGlvbi5cbiAgICAvLyBDb3VudGVyIGlzIHJlc2V0IHRvIDAgZWFjaCB0aW1lIGEgY29ubmVjdGlvbiBpcyBlc3RhYmxpc2hlZC5cbiAgICBnZXQgYnl0ZXNTZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Qnl0ZXNTZW50O1xuICAgIH1cbiAgICBsaXN0ZW5Gb3JTZXJ2aWNlVGVsZW1ldHJ5KGV2ZW50U291cmNlKSB7XG4gICAgICAgIGlmICghIXRoaXMucHJpdlNlcnZpY2VUZWxlbWV0cnlMaXN0ZW5lcikge1xuICAgICAgICAgICAgdGhpcy5wcml2RGV0YWNoYWJsZXMucHVzaChldmVudFNvdXJjZS5hdHRhY2hMaXN0ZW5lcih0aGlzLnByaXZTZXJ2aWNlVGVsZW1ldHJ5TGlzdGVuZXIpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGFydE5ld1JlY29nbml0aW9uKCkge1xuICAgICAgICB0aGlzLnByaXZJc1NwZWVjaEVuZGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdklzUmVjb2duaXppbmcgPSB0cnVlO1xuICAgICAgICB0aGlzLnByaXZUdXJuU3RhcnRBdWRpb09mZnNldCA9IDA7XG4gICAgICAgIHRoaXMucHJpdkxhc3RSZWNvT2Zmc2V0ID0gMDtcbiAgICAgICAgdGhpcy5wcml2UmVjb2dOdW1iZXIrKztcbiAgICAgICAgdGhpcy5wcml2U2VydmljZVRlbGVtZXRyeUxpc3RlbmVyID0gbmV3IFNlcnZpY2VUZWxlbWV0cnlMaXN0ZW5lcih0aGlzLnByaXZSZXF1ZXN0SWQsIHRoaXMucHJpdkF1ZGlvU291cmNlSWQsIHRoaXMucHJpdkF1ZGlvTm9kZUlkKTtcbiAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBSZWNvZ25pdGlvblRyaWdnZXJlZEV2ZW50KHRoaXMucmVxdWVzdElkLCB0aGlzLnByaXZTZXNzaW9uSWQsIHRoaXMucHJpdkF1ZGlvU291cmNlSWQsIHRoaXMucHJpdkF1ZGlvTm9kZUlkKSk7XG4gICAgfVxuICAgIG9uQXVkaW9Tb3VyY2VBdHRhY2hDb21wbGV0ZWQoYXVkaW9Ob2RlLCBpc0Vycm9yKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZBdWRpb05vZGUgPSBhdWRpb05vZGU7XG4gICAgICAgICAgICB0aGlzLnByaXZJc0F1ZGlvTm9kZURldGFjaGVkID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAoaXNFcnJvcikge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMub25Db21wbGV0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBMaXN0ZW5pbmdTdGFydGVkRXZlbnQodGhpcy5wcml2UmVxdWVzdElkLCB0aGlzLnByaXZTZXNzaW9uSWQsIHRoaXMucHJpdkF1ZGlvU291cmNlSWQsIHRoaXMucHJpdkF1ZGlvTm9kZUlkKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBvblByZUNvbm5lY3Rpb25TdGFydChhdXRoRmV0Y2hFdmVudElkLCBjb25uZWN0aW9uSWQpIHtcbiAgICAgICAgdGhpcy5wcml2QXV0aEZldGNoRXZlbnRJZCA9IGF1dGhGZXRjaEV2ZW50SWQ7XG4gICAgICAgIHRoaXMucHJpdlNlc3Npb25JZCA9IGNvbm5lY3Rpb25JZDtcbiAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBDb25uZWN0aW5nVG9TZXJ2aWNlRXZlbnQodGhpcy5wcml2UmVxdWVzdElkLCB0aGlzLnByaXZBdXRoRmV0Y2hFdmVudElkLCB0aGlzLnByaXZTZXNzaW9uSWQpKTtcbiAgICB9XG4gICAgb25BdXRoQ29tcGxldGVkKGlzRXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmIChpc0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5vbkNvbXBsZXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gICAgb25Db25uZWN0aW9uRXN0YWJsaXNoQ29tcGxldGVkKHN0YXR1c0NvZGUsIHJlYXNvbikge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKHN0YXR1c0NvZGUgPT09IDIwMCkge1xuICAgICAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgUmVjb2duaXRpb25TdGFydGVkRXZlbnQodGhpcy5yZXF1ZXN0SWQsIHRoaXMucHJpdkF1ZGlvU291cmNlSWQsIHRoaXMucHJpdkF1ZGlvTm9kZUlkLCB0aGlzLnByaXZBdXRoRmV0Y2hFdmVudElkLCB0aGlzLnByaXZTZXNzaW9uSWQpKTtcbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZBdWRpb05vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2QXVkaW9Ob2RlLnJlcGxheSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnByaXZUdXJuU3RhcnRBdWRpb09mZnNldCA9IHRoaXMucHJpdkxhc3RSZWNvT2Zmc2V0O1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkJ5dGVzU2VudCA9IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc3RhdHVzQ29kZSA9PT0gNDAzKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5vbkNvbXBsZXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBvblNlcnZpY2VUdXJuRW5kUmVzcG9uc2UoY29udGludW91c1JlY29nbml0aW9uKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZUdXJuRGVmZXJyYWwucmVzb2x2ZSgpO1xuICAgICAgICAgICAgaWYgKCFjb250aW51b3VzUmVjb2duaXRpb24gfHwgdGhpcy5pc1NwZWVjaEVuZGVkKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5vbkNvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2SW5UdXJuID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBTdGFydCBhIG5ldyByZXF1ZXN0IHNldC5cbiAgICAgICAgICAgICAgICB0aGlzLnByaXZUdXJuU3RhcnRBdWRpb09mZnNldCA9IHRoaXMucHJpdkxhc3RSZWNvT2Zmc2V0O1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvTm9kZS5yZXBsYXkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIG9uU3BlZWNoQ29udGV4dCgpIHtcbiAgICAgICAgdGhpcy5wcml2UmVxdWVzdElkID0gY3JlYXRlTm9EYXNoR3VpZCgpO1xuICAgIH1cbiAgICBvblNlcnZpY2VUdXJuU3RhcnRSZXNwb25zZSgpIHtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2VHVybkRlZmVycmFsICYmICEhdGhpcy5wcml2SW5UdXJuKSB7XG4gICAgICAgICAgICAvLyBXaGF0PyBIb3cgYXJlIHdlIHN0YXJ0aW5nIGEgdHVybiB3aXRoIGFub3RoZXIgbm90IGRvbmU/XG4gICAgICAgICAgICB0aGlzLnByaXZUdXJuRGVmZXJyYWwucmVqZWN0KFwiQW5vdGhlciB0dXJuIHN0YXJ0ZWQgYmVmb3JlIGN1cnJlbnQgY29tcGxldGVkLlwiKTtcbiAgICAgICAgICAgIC8vIEF2b2lkIFVuaGFuZGxlZFByb21pc2VSZWplY3Rpb24gaWYgcHJpdlR1cm5EZWZlcnJhbCBpcyBub3QgYmVpbmcgYXdhaXRlZFxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvblxuICAgICAgICAgICAgdGhpcy5wcml2VHVybkRlZmVycmFsLnByb21pc2UudGhlbigpLmNhdGNoKCgpID0+IHsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2SW5UdXJuID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5wcml2VHVybkRlZmVycmFsID0gbmV3IERlZmVycmVkKCk7XG4gICAgfVxuICAgIG9uSHlwb3RoZXNpcyhvZmZzZXQpIHtcbiAgICAgICAgaWYgKCF0aGlzLnByaXZIeXBvdGhlc2lzUmVjZWl2ZWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkh5cG90aGVzaXNSZWNlaXZlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnByaXZTZXJ2aWNlVGVsZW1ldHJ5TGlzdGVuZXIuaHlwb3RoZXNpc1JlY2VpdmVkKHRoaXMucHJpdkF1ZGlvTm9kZS5maW5kVGltZUF0T2Zmc2V0KG9mZnNldCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIG9uUGhyYXNlUmVjb2duaXplZChvZmZzZXQpIHtcbiAgICAgICAgdGhpcy5wcml2U2VydmljZVRlbGVtZXRyeUxpc3RlbmVyLnBocmFzZVJlY2VpdmVkKHRoaXMucHJpdkF1ZGlvTm9kZS5maW5kVGltZUF0T2Zmc2V0KG9mZnNldCkpO1xuICAgICAgICB0aGlzLm9uU2VydmljZVJlY29nbml6ZWQob2Zmc2V0KTtcbiAgICB9XG4gICAgb25TZXJ2aWNlUmVjb2duaXplZChvZmZzZXQpIHtcbiAgICAgICAgdGhpcy5wcml2TGFzdFJlY29PZmZzZXQgPSBvZmZzZXQ7XG4gICAgICAgIHRoaXMucHJpdkh5cG90aGVzaXNSZWNlaXZlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZBdWRpb05vZGUuc2hyaW5rQnVmZmVycyhvZmZzZXQpO1xuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uQXR0ZW1wdHMgPSAwO1xuICAgIH1cbiAgICBvbkF1ZGlvU2VudChieXRlc1NlbnQpIHtcbiAgICAgICAgdGhpcy5wcml2Qnl0ZXNTZW50ICs9IGJ5dGVzU2VudDtcbiAgICB9XG4gICAgb25SZXRyeUNvbm5lY3Rpb24oKSB7XG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25BdHRlbXB0cysrO1xuICAgIH1cbiAgICBkaXNwb3NlKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZJc0Rpc3Bvc2VkKSB7XG4gICAgICAgICAgICAgICAgLy8gd2Ugc2hvdWxkIGhhdmUgY29tcGxldGVkIGJ5IG5vdy4gSWYgd2UgZGlkIG5vdCBpdHMgYW4gdW5rbm93biBlcnJvci5cbiAgICAgICAgICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGRldGFjaGFibGUgb2YgdGhpcy5wcml2RGV0YWNoYWJsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgZGV0YWNoYWJsZS5kZXRhY2goKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2U2VydmljZVRlbGVtZXRyeUxpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlNlcnZpY2VUZWxlbWV0cnlMaXN0ZW5lci5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucHJpdklzUmVjb2duaXppbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldFRlbGVtZXRyeSgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdlNlcnZpY2VUZWxlbWV0cnlMaXN0ZW5lci5oYXNUZWxlbWV0cnkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZTZXJ2aWNlVGVsZW1ldHJ5TGlzdGVuZXIuZ2V0VGVsZW1ldHJ5KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvblN0b3BSZWNvZ25pemluZygpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMub25Db21wbGV0ZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLy8gU2hvdWxkIGJlIGNhbGxlZCB3aXRoIHRoZSBhdWRpb05vZGUgZm9yIHRoaXMgc2Vzc2lvbiBoYXMgaW5kaWNhdGVkIHRoYXQgaXQgaXMgb3V0IG9mIHNwZWVjaC5cbiAgICBvblNwZWVjaEVuZGVkKCkge1xuICAgICAgICB0aGlzLnByaXZJc1NwZWVjaEVuZGVkID0gdHJ1ZTtcbiAgICB9XG4gICAgb25FdmVudChldmVudCkge1xuICAgICAgICBpZiAoISF0aGlzLnByaXZTZXJ2aWNlVGVsZW1ldHJ5TGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlNlcnZpY2VUZWxlbWV0cnlMaXN0ZW5lci5vbkV2ZW50KGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgICBFdmVudHMuaW5zdGFuY2Uub25FdmVudChldmVudCk7XG4gICAgfVxuICAgIG9uQ29tcGxldGUoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZJc1JlY29nbml6aW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2SXNSZWNvZ25pemluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuZGV0YWNoQXVkaW9Ob2RlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBkZXRhY2hBdWRpb05vZGUoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMucHJpdklzQXVkaW9Ob2RlRGV0YWNoZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZJc0F1ZGlvTm9kZURldGFjaGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2QXVkaW9Ob2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdkF1ZGlvTm9kZS5kZXRhY2goKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UmVxdWVzdFNlc3Npb24uanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8vIHJlc3BvbnNlXG5leHBvcnQgY2xhc3MgQWN0aXZpdHlQYXlsb2FkUmVzcG9uc2Uge1xuICAgIGNvbnN0cnVjdG9yKGpzb24pIHtcbiAgICAgICAgdGhpcy5wcml2QWN0aXZpdHlSZXNwb25zZSA9IEpTT04ucGFyc2UoanNvbik7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIHJldHVybiBuZXcgQWN0aXZpdHlQYXlsb2FkUmVzcG9uc2UoanNvbik7XG4gICAgfVxuICAgIGdldCBjb252ZXJzYXRpb25JZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkFjdGl2aXR5UmVzcG9uc2UuY29udmVyc2F0aW9uSWQ7XG4gICAgfVxuICAgIGdldCBtZXNzYWdlRGF0YVN0cmVhbVR5cGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBY3Rpdml0eVJlc3BvbnNlLm1lc3NhZ2VEYXRhU3RyZWFtVHlwZTtcbiAgICB9XG4gICAgZ2V0IG1lc3NhZ2VQYXlsb2FkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QWN0aXZpdHlSZXNwb25zZS5tZXNzYWdlUGF5bG9hZDtcbiAgICB9XG4gICAgZ2V0IHZlcnNpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBY3Rpdml0eVJlc3BvbnNlLnZlcnNpb247XG4gICAgfVxufVxuZXhwb3J0IHZhciBNZXNzYWdlRGF0YVN0cmVhbVR5cGU7XG4oZnVuY3Rpb24gKE1lc3NhZ2VEYXRhU3RyZWFtVHlwZSkge1xuICAgIE1lc3NhZ2VEYXRhU3RyZWFtVHlwZVtNZXNzYWdlRGF0YVN0cmVhbVR5cGVbXCJOb25lXCJdID0gMF0gPSBcIk5vbmVcIjtcbiAgICBNZXNzYWdlRGF0YVN0cmVhbVR5cGVbTWVzc2FnZURhdGFTdHJlYW1UeXBlW1wiVGV4dFRvU3BlZWNoQXVkaW9cIl0gPSAxXSA9IFwiVGV4dFRvU3BlZWNoQXVkaW9cIjtcbn0pKE1lc3NhZ2VEYXRhU3RyZWFtVHlwZSB8fCAoTWVzc2FnZURhdGFTdHJlYW1UeXBlID0ge30pKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QWN0aXZpdHlSZXNwb25zZVBheWxvYWQuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFJlY29nbml0aW9uU3RhdHVzIH0gZnJvbSBcIi4uL0V4cG9ydHNcIjtcbmV4cG9ydCBjbGFzcyBEZXRhaWxlZFNwZWVjaFBocmFzZSB7XG4gICAgY29uc3RydWN0b3IoanNvbikge1xuICAgICAgICB0aGlzLnByaXZEZXRhaWxlZFNwZWVjaFBocmFzZSA9IEpTT04ucGFyc2UoanNvbik7XG4gICAgICAgIHRoaXMucHJpdkRldGFpbGVkU3BlZWNoUGhyYXNlLlJlY29nbml0aW9uU3RhdHVzID0gUmVjb2duaXRpb25TdGF0dXNbdGhpcy5wcml2RGV0YWlsZWRTcGVlY2hQaHJhc2UuUmVjb2duaXRpb25TdGF0dXNdO1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbUpTT04oanNvbikge1xuICAgICAgICByZXR1cm4gbmV3IERldGFpbGVkU3BlZWNoUGhyYXNlKGpzb24pO1xuICAgIH1cbiAgICBnZXRKc29uV2l0aENvcnJlY3RlZE9mZnNldHMoYmFzZU9mZnNldCkge1xuICAgICAgICBpZiAoISF0aGlzLnByaXZEZXRhaWxlZFNwZWVjaFBocmFzZS5OQmVzdCkge1xuICAgICAgICAgICAgbGV0IGZpcnN0V29yZE9mZnNldDtcbiAgICAgICAgICAgIGZvciAoY29uc3QgcGhyYXNlIG9mIHRoaXMucHJpdkRldGFpbGVkU3BlZWNoUGhyYXNlLk5CZXN0KSB7XG4gICAgICAgICAgICAgICAgaWYgKCEhcGhyYXNlLldvcmRzICYmICEhcGhyYXNlLldvcmRzWzBdKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpcnN0V29yZE9mZnNldCA9IHBocmFzZS5Xb3Jkc1swXS5PZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghIWZpcnN0V29yZE9mZnNldCAmJiBmaXJzdFdvcmRPZmZzZXQgPCBiYXNlT2Zmc2V0KSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2V0ID0gYmFzZU9mZnNldCAtIGZpcnN0V29yZE9mZnNldDtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGRldGFpbHMgb2YgdGhpcy5wcml2RGV0YWlsZWRTcGVlY2hQaHJhc2UuTkJlc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhZGV0YWlscy5Xb3Jkcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB3b3JkIG9mIGRldGFpbHMuV29yZHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JkLk9mZnNldCArPSBvZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhZGV0YWlscy5EaXNwbGF5V29yZHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgd29yZCBvZiBkZXRhaWxzLkRpc3BsYXlXb3Jkcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmQuT2Zmc2V0ICs9IG9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcy5wcml2RGV0YWlsZWRTcGVlY2hQaHJhc2UpO1xuICAgIH1cbiAgICBnZXQgUmVjb2duaXRpb25TdGF0dXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZEZXRhaWxlZFNwZWVjaFBocmFzZS5SZWNvZ25pdGlvblN0YXR1cztcbiAgICB9XG4gICAgZ2V0IE5CZXN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RGV0YWlsZWRTcGVlY2hQaHJhc2UuTkJlc3Q7XG4gICAgfVxuICAgIGdldCBEdXJhdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkRldGFpbGVkU3BlZWNoUGhyYXNlLkR1cmF0aW9uO1xuICAgIH1cbiAgICBnZXQgT2Zmc2V0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RGV0YWlsZWRTcGVlY2hQaHJhc2UuT2Zmc2V0O1xuICAgIH1cbiAgICBnZXQgTGFuZ3VhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZEZXRhaWxlZFNwZWVjaFBocmFzZS5QcmltYXJ5TGFuZ3VhZ2UgPT09IHVuZGVmaW5lZCA/IHVuZGVmaW5lZCA6IHRoaXMucHJpdkRldGFpbGVkU3BlZWNoUGhyYXNlLlByaW1hcnlMYW5ndWFnZS5MYW5ndWFnZTtcbiAgICB9XG4gICAgZ2V0IExhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkRldGFpbGVkU3BlZWNoUGhyYXNlLlByaW1hcnlMYW5ndWFnZSA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogdGhpcy5wcml2RGV0YWlsZWRTcGVlY2hQaHJhc2UuUHJpbWFyeUxhbmd1YWdlLkNvbmZpZGVuY2U7XG4gICAgfVxuICAgIGdldCBUZXh0KCkge1xuICAgICAgICBpZiAoISF0aGlzLnByaXZEZXRhaWxlZFNwZWVjaFBocmFzZS5OQmVzdCAmJiB0aGlzLnByaXZEZXRhaWxlZFNwZWVjaFBocmFzZS5OQmVzdFswXSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdkRldGFpbGVkU3BlZWNoUGhyYXNlLk5CZXN0WzBdLkRpc3BsYXkgfHwgdGhpcy5wcml2RGV0YWlsZWRTcGVlY2hQaHJhc2UuTkJlc3RbMF0uRGlzcGxheVRleHQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkRldGFpbGVkU3BlZWNoUGhyYXNlLkRpc3BsYXlUZXh0O1xuICAgIH1cbiAgICBnZXQgU3BlYWtlcklkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RGV0YWlsZWRTcGVlY2hQaHJhc2UuU3BlYWtlcklkO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9RGV0YWlsZWRTcGVlY2hQaHJhc2UuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogQGNsYXNzIFN5bnRoZXNpc1N0YXR1c1xuICogQHByaXZhdGVcbiAqL1xuZXhwb3J0IHZhciBTeW50aGVzaXNTdGF0dXM7XG4oZnVuY3Rpb24gKFN5bnRoZXNpc1N0YXR1cykge1xuICAgIC8qKlxuICAgICAqIFRoZSByZXNwb25zZSBjb250YWlucyB2YWxpZCBhdWRpbyBkYXRhLlxuICAgICAqIEBtZW1iZXIgU3ludGhlc2lzU3RhdHVzLlN1Y2Nlc3NcbiAgICAgKi9cbiAgICBTeW50aGVzaXNTdGF0dXNbU3ludGhlc2lzU3RhdHVzW1wiU3VjY2Vzc1wiXSA9IDBdID0gXCJTdWNjZXNzXCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIHRoZSBlbmQgb2YgYXVkaW8gZGF0YS4gTm8gdmFsaWQgYXVkaW8gZGF0YSBpcyBpbmNsdWRlZCBpbiB0aGUgbWVzc2FnZS5cbiAgICAgKiBAbWVtYmVyIFN5bnRoZXNpc1N0YXR1cy5TeW50aGVzaXNFbmRcbiAgICAgKi9cbiAgICBTeW50aGVzaXNTdGF0dXNbU3ludGhlc2lzU3RhdHVzW1wiU3ludGhlc2lzRW5kXCJdID0gMV0gPSBcIlN5bnRoZXNpc0VuZFwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyBhbiBlcnJvciBvY2N1cnJlZCBkdXJpbmcgc3ludGhlc2lzIGRhdGEgcHJvY2Vzc2luZy5cbiAgICAgKiBAbWVtYmVyIFN5bnRoZXNpc1N0YXR1cy5FcnJvclxuICAgICAqL1xuICAgIFN5bnRoZXNpc1N0YXR1c1tTeW50aGVzaXNTdGF0dXNbXCJFcnJvclwiXSA9IDJdID0gXCJFcnJvclwiO1xufSkoU3ludGhlc2lzU3RhdHVzIHx8IChTeW50aGVzaXNTdGF0dXMgPSB7fSkpO1xuZXhwb3J0IHZhciBSZWNvZ25pdGlvblN0YXR1cztcbihmdW5jdGlvbiAoUmVjb2duaXRpb25TdGF0dXMpIHtcbiAgICBSZWNvZ25pdGlvblN0YXR1c1tSZWNvZ25pdGlvblN0YXR1c1tcIlN1Y2Nlc3NcIl0gPSAwXSA9IFwiU3VjY2Vzc1wiO1xuICAgIFJlY29nbml0aW9uU3RhdHVzW1JlY29nbml0aW9uU3RhdHVzW1wiTm9NYXRjaFwiXSA9IDFdID0gXCJOb01hdGNoXCI7XG4gICAgUmVjb2duaXRpb25TdGF0dXNbUmVjb2duaXRpb25TdGF0dXNbXCJJbml0aWFsU2lsZW5jZVRpbWVvdXRcIl0gPSAyXSA9IFwiSW5pdGlhbFNpbGVuY2VUaW1lb3V0XCI7XG4gICAgUmVjb2duaXRpb25TdGF0dXNbUmVjb2duaXRpb25TdGF0dXNbXCJCYWJibGVUaW1lb3V0XCJdID0gM10gPSBcIkJhYmJsZVRpbWVvdXRcIjtcbiAgICBSZWNvZ25pdGlvblN0YXR1c1tSZWNvZ25pdGlvblN0YXR1c1tcIkVycm9yXCJdID0gNF0gPSBcIkVycm9yXCI7XG4gICAgUmVjb2duaXRpb25TdGF0dXNbUmVjb2duaXRpb25TdGF0dXNbXCJFbmRPZkRpY3RhdGlvblwiXSA9IDVdID0gXCJFbmRPZkRpY3RhdGlvblwiO1xuICAgIFJlY29nbml0aW9uU3RhdHVzW1JlY29nbml0aW9uU3RhdHVzW1wiVG9vTWFueVJlcXVlc3RzXCJdID0gNl0gPSBcIlRvb01hbnlSZXF1ZXN0c1wiO1xuICAgIFJlY29nbml0aW9uU3RhdHVzW1JlY29nbml0aW9uU3RhdHVzW1wiQmFkUmVxdWVzdFwiXSA9IDddID0gXCJCYWRSZXF1ZXN0XCI7XG4gICAgUmVjb2duaXRpb25TdGF0dXNbUmVjb2duaXRpb25TdGF0dXNbXCJGb3JiaWRkZW5cIl0gPSA4XSA9IFwiRm9yYmlkZGVuXCI7XG59KShSZWNvZ25pdGlvblN0YXR1cyB8fCAoUmVjb2duaXRpb25TdGF0dXMgPSB7fSkpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1FbnVtcy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLy8gcmVzcG9uc2VcbmV4cG9ydCBjbGFzcyBJbnRlbnRSZXNwb25zZSB7XG4gICAgY29uc3RydWN0b3IoanNvbikge1xuICAgICAgICBpZiAoanNvbiA9PT0gXCJcIikge1xuICAgICAgICAgICAgdGhpcy5wcml2SW50ZW50UmVzcG9uc2UgPSB7fTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkludGVudFJlc3BvbnNlID0gSlNPTi5wYXJzZShqc29uKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZnJvbUpTT04oanNvbikge1xuICAgICAgICByZXR1cm4gbmV3IEludGVudFJlc3BvbnNlKGpzb24pO1xuICAgIH1cbiAgICBnZXQgcXVlcnkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJbnRlbnRSZXNwb25zZS5xdWVyeTtcbiAgICB9XG4gICAgZ2V0IHRvcFNjb3JpbmdJbnRlbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJbnRlbnRSZXNwb25zZS50b3BTY29yaW5nSW50ZW50O1xuICAgIH1cbiAgICBnZXQgZW50aXRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJbnRlbnRSZXNwb25zZS5lbnRpdGllcztcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUludGVudFJlc3BvbnNlLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBSZWNvZ25pdGlvblN0YXR1cyB9IGZyb20gXCIuLi9FeHBvcnRzXCI7XG5leHBvcnQgY2xhc3MgU2ltcGxlU3BlZWNoUGhyYXNlIHtcbiAgICBjb25zdHJ1Y3Rvcihqc29uKSB7XG4gICAgICAgIHRoaXMucHJpdlNpbXBsZVNwZWVjaFBocmFzZSA9IEpTT04ucGFyc2UoanNvbik7XG4gICAgICAgIHRoaXMucHJpdlNpbXBsZVNwZWVjaFBocmFzZS5SZWNvZ25pdGlvblN0YXR1cyA9IFJlY29nbml0aW9uU3RhdHVzW3RoaXMucHJpdlNpbXBsZVNwZWVjaFBocmFzZS5SZWNvZ25pdGlvblN0YXR1c107XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIHJldHVybiBuZXcgU2ltcGxlU3BlZWNoUGhyYXNlKGpzb24pO1xuICAgIH1cbiAgICBnZXQgUmVjb2duaXRpb25TdGF0dXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTaW1wbGVTcGVlY2hQaHJhc2UuUmVjb2duaXRpb25TdGF0dXM7XG4gICAgfVxuICAgIGdldCBEaXNwbGF5VGV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNpbXBsZVNwZWVjaFBocmFzZS5EaXNwbGF5VGV4dDtcbiAgICB9XG4gICAgZ2V0IE9mZnNldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNpbXBsZVNwZWVjaFBocmFzZS5PZmZzZXQ7XG4gICAgfVxuICAgIGdldCBEdXJhdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNpbXBsZVNwZWVjaFBocmFzZS5EdXJhdGlvbjtcbiAgICB9XG4gICAgZ2V0IExhbmd1YWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U2ltcGxlU3BlZWNoUGhyYXNlLlByaW1hcnlMYW5ndWFnZSA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogdGhpcy5wcml2U2ltcGxlU3BlZWNoUGhyYXNlLlByaW1hcnlMYW5ndWFnZS5MYW5ndWFnZTtcbiAgICB9XG4gICAgZ2V0IExhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNpbXBsZVNwZWVjaFBocmFzZS5QcmltYXJ5TGFuZ3VhZ2UgPT09IHVuZGVmaW5lZCA/IHVuZGVmaW5lZCA6IHRoaXMucHJpdlNpbXBsZVNwZWVjaFBocmFzZS5QcmltYXJ5TGFuZ3VhZ2UuQ29uZmlkZW5jZTtcbiAgICB9XG4gICAgZ2V0IFNwZWFrZXJJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNpbXBsZVNwZWVjaFBocmFzZS5TcGVha2VySWQ7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TaW1wbGVTcGVlY2hQaHJhc2UuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qIGVzbGludC1kaXNhYmxlIG1heC1jbGFzc2VzLXBlci1maWxlICovXG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWFrZXJSZXNwb25zZS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuZXhwb3J0IGNsYXNzIFNwZWVjaERldGVjdGVkIHtcbiAgICBjb25zdHJ1Y3Rvcihqc29uKSB7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaFN0YXJ0RGV0ZWN0ZWQgPSBKU09OLnBhcnNlKGpzb24pO1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbUpTT04oanNvbikge1xuICAgICAgICByZXR1cm4gbmV3IFNwZWVjaERldGVjdGVkKGpzb24pO1xuICAgIH1cbiAgICBnZXQgT2Zmc2V0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoU3RhcnREZXRlY3RlZC5PZmZzZXQ7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TcGVlY2hEZXRlY3RlZC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuZXhwb3J0IGNsYXNzIFNwZWVjaEh5cG90aGVzaXMge1xuICAgIGNvbnN0cnVjdG9yKGpzb24pIHtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoSHlwb3RoZXNpcyA9IEpTT04ucGFyc2UoanNvbik7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIHJldHVybiBuZXcgU3BlZWNoSHlwb3RoZXNpcyhqc29uKTtcbiAgICB9XG4gICAgZ2V0IFRleHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hIeXBvdGhlc2lzLlRleHQ7XG4gICAgfVxuICAgIGdldCBPZmZzZXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hIeXBvdGhlc2lzLk9mZnNldDtcbiAgICB9XG4gICAgZ2V0IER1cmF0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoSHlwb3RoZXNpcy5EdXJhdGlvbjtcbiAgICB9XG4gICAgZ2V0IExhbmd1YWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoSHlwb3RoZXNpcy5QcmltYXJ5TGFuZ3VhZ2UgPT09IHVuZGVmaW5lZCA/IHVuZGVmaW5lZCA6IHRoaXMucHJpdlNwZWVjaEh5cG90aGVzaXMuUHJpbWFyeUxhbmd1YWdlLkxhbmd1YWdlO1xuICAgIH1cbiAgICBnZXQgTGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoSHlwb3RoZXNpcy5QcmltYXJ5TGFuZ3VhZ2UgPT09IHVuZGVmaW5lZCA/IHVuZGVmaW5lZCA6IHRoaXMucHJpdlNwZWVjaEh5cG90aGVzaXMuUHJpbWFyeUxhbmd1YWdlLkNvbmZpZGVuY2U7XG4gICAgfVxuICAgIGdldCBTcGVha2VySWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hIeXBvdGhlc2lzLlNwZWFrZXJJZDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWVjaEh5cG90aGVzaXMuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmV4cG9ydCBjbGFzcyBTcGVlY2hLZXl3b3JkIHtcbiAgICBjb25zdHJ1Y3Rvcihqc29uKSB7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaEtleXdvcmQgPSBKU09OLnBhcnNlKGpzb24pO1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbUpTT04oanNvbikge1xuICAgICAgICByZXR1cm4gbmV3IFNwZWVjaEtleXdvcmQoanNvbik7XG4gICAgfVxuICAgIGdldCBTdGF0dXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hLZXl3b3JkLlN0YXR1cztcbiAgICB9XG4gICAgZ2V0IFRleHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hLZXl3b3JkLlRleHQ7XG4gICAgfVxuICAgIGdldCBPZmZzZXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hLZXl3b3JkLk9mZnNldDtcbiAgICB9XG4gICAgZ2V0IER1cmF0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoS2V5d29yZC5EdXJhdGlvbjtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWVjaEtleXdvcmQuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmV4cG9ydCB2YXIgTWV0YWRhdGFUeXBlO1xuKGZ1bmN0aW9uIChNZXRhZGF0YVR5cGUpIHtcbiAgICBNZXRhZGF0YVR5cGVbXCJXb3JkQm91bmRhcnlcIl0gPSBcIldvcmRCb3VuZGFyeVwiO1xuICAgIE1ldGFkYXRhVHlwZVtcIkJvb2ttYXJrXCJdID0gXCJCb29rbWFya1wiO1xuICAgIE1ldGFkYXRhVHlwZVtcIlZpc2VtZVwiXSA9IFwiVmlzZW1lXCI7XG4gICAgTWV0YWRhdGFUeXBlW1wiU2VudGVuY2VCb3VuZGFyeVwiXSA9IFwiU2VudGVuY2VCb3VuZGFyeVwiO1xuICAgIE1ldGFkYXRhVHlwZVtcIlNlc3Npb25FbmRcIl0gPSBcIlNlc3Npb25FbmRcIjtcbn0pKE1ldGFkYXRhVHlwZSB8fCAoTWV0YWRhdGFUeXBlID0ge30pKTtcbmV4cG9ydCBjbGFzcyBTeW50aGVzaXNBdWRpb01ldGFkYXRhIHtcbiAgICBjb25zdHJ1Y3Rvcihqc29uKSB7XG4gICAgICAgIHRoaXMucHJpdlN5bnRoZXNpc0F1ZGlvTWV0YWRhdGEgPSBKU09OLnBhcnNlKGpzb24pO1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbUpTT04oanNvbikge1xuICAgICAgICByZXR1cm4gbmV3IFN5bnRoZXNpc0F1ZGlvTWV0YWRhdGEoanNvbik7XG4gICAgfVxuICAgIGdldCBNZXRhZGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlN5bnRoZXNpc0F1ZGlvTWV0YWRhdGEuTWV0YWRhdGE7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TeW50aGVzaXNBdWRpb01ldGFkYXRhLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBUcmFuc2xhdGlvblN0YXR1cyB9IGZyb20gXCIuLi9UcmFuc2xhdGlvblN0YXR1c1wiO1xuZXhwb3J0IGNsYXNzIFRyYW5zbGF0aW9uSHlwb3RoZXNpcyB7XG4gICAgY29uc3RydWN0b3IoanNvbikge1xuICAgICAgICB0aGlzLnByaXZUcmFuc2xhdGlvbkh5cG90aGVzaXMgPSBKU09OLnBhcnNlKGpzb24pO1xuICAgICAgICB0aGlzLnByaXZUcmFuc2xhdGlvbkh5cG90aGVzaXMuVHJhbnNsYXRpb24uVHJhbnNsYXRpb25TdGF0dXMgPSBUcmFuc2xhdGlvblN0YXR1c1t0aGlzLnByaXZUcmFuc2xhdGlvbkh5cG90aGVzaXMuVHJhbnNsYXRpb24uVHJhbnNsYXRpb25TdGF0dXNdO1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbUpTT04oanNvbikge1xuICAgICAgICByZXR1cm4gbmV3IFRyYW5zbGF0aW9uSHlwb3RoZXNpcyhqc29uKTtcbiAgICB9XG4gICAgZ2V0IER1cmF0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VHJhbnNsYXRpb25IeXBvdGhlc2lzLkR1cmF0aW9uO1xuICAgIH1cbiAgICBnZXQgT2Zmc2V0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VHJhbnNsYXRpb25IeXBvdGhlc2lzLk9mZnNldDtcbiAgICB9XG4gICAgZ2V0IFRleHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUcmFuc2xhdGlvbkh5cG90aGVzaXMuVGV4dDtcbiAgICB9XG4gICAgZ2V0IFRyYW5zbGF0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VHJhbnNsYXRpb25IeXBvdGhlc2lzLlRyYW5zbGF0aW9uO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VHJhbnNsYXRpb25IeXBvdGhlc2lzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi4vLi4vc2RrL0NvbnRyYWN0c1wiO1xuaW1wb3J0IHsgUmVjb2duaXRpb25TdGF0dXMgfSBmcm9tIFwiLi4vRXhwb3J0c1wiO1xuaW1wb3J0IHsgVHJhbnNsYXRpb25TdGF0dXMgfSBmcm9tIFwiLi4vVHJhbnNsYXRpb25TdGF0dXNcIjtcbmV4cG9ydCBjbGFzcyBUcmFuc2xhdGlvblBocmFzZSB7XG4gICAgY29uc3RydWN0b3IocGhyYXNlKSB7XG4gICAgICAgIHRoaXMucHJpdlRyYW5zbGF0aW9uUGhyYXNlID0gcGhyYXNlO1xuICAgICAgICB0aGlzLnByaXZUcmFuc2xhdGlvblBocmFzZS5SZWNvZ25pdGlvblN0YXR1cyA9IFJlY29nbml0aW9uU3RhdHVzW3RoaXMucHJpdlRyYW5zbGF0aW9uUGhyYXNlLlJlY29nbml0aW9uU3RhdHVzXTtcbiAgICAgICAgaWYgKHRoaXMucHJpdlRyYW5zbGF0aW9uUGhyYXNlLlRyYW5zbGF0aW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlRyYW5zbGF0aW9uUGhyYXNlLlRyYW5zbGF0aW9uLlRyYW5zbGF0aW9uU3RhdHVzID0gVHJhbnNsYXRpb25TdGF0dXNbdGhpcy5wcml2VHJhbnNsYXRpb25QaHJhc2UuVHJhbnNsYXRpb24uVHJhbnNsYXRpb25TdGF0dXNdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIHJldHVybiBuZXcgVHJhbnNsYXRpb25QaHJhc2UoSlNPTi5wYXJzZShqc29uKSk7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tVHJhbnNsYXRpb25SZXNwb25zZSh0cmFuc2xhdGlvblJlc3BvbnNlKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHRyYW5zbGF0aW9uUmVzcG9uc2UsIFwidHJhbnNsYXRpb25SZXNwb25zZVwiKTtcbiAgICAgICAgY29uc3QgcGhyYXNlID0gdHJhbnNsYXRpb25SZXNwb25zZS5TcGVlY2hQaHJhc2U7XG4gICAgICAgIHRyYW5zbGF0aW9uUmVzcG9uc2UuU3BlZWNoUGhyYXNlID0gdW5kZWZpbmVkO1xuICAgICAgICBwaHJhc2UuVHJhbnNsYXRpb24gPSB0cmFuc2xhdGlvblJlc3BvbnNlO1xuICAgICAgICBwaHJhc2UuVGV4dCA9IHBocmFzZS5EaXNwbGF5VGV4dDtcbiAgICAgICAgcmV0dXJuIG5ldyBUcmFuc2xhdGlvblBocmFzZShwaHJhc2UpO1xuICAgIH1cbiAgICBnZXQgUmVjb2duaXRpb25TdGF0dXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUcmFuc2xhdGlvblBocmFzZS5SZWNvZ25pdGlvblN0YXR1cztcbiAgICB9XG4gICAgZ2V0IE9mZnNldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRyYW5zbGF0aW9uUGhyYXNlLk9mZnNldDtcbiAgICB9XG4gICAgZ2V0IER1cmF0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VHJhbnNsYXRpb25QaHJhc2UuRHVyYXRpb247XG4gICAgfVxuICAgIGdldCBUZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VHJhbnNsYXRpb25QaHJhc2UuVGV4dDtcbiAgICB9XG4gICAgZ2V0IExhbmd1YWdlKCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiAoX2EgPSB0aGlzLnByaXZUcmFuc2xhdGlvblBocmFzZS5QcmltYXJ5TGFuZ3VhZ2UpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5MYW5ndWFnZTtcbiAgICB9XG4gICAgZ2V0IENvbmZpZGVuY2UoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIChfYSA9IHRoaXMucHJpdlRyYW5zbGF0aW9uUGhyYXNlLlByaW1hcnlMYW5ndWFnZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLkNvbmZpZGVuY2U7XG4gICAgfVxuICAgIGdldCBUcmFuc2xhdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRyYW5zbGF0aW9uUGhyYXNlLlRyYW5zbGF0aW9uO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VHJhbnNsYXRpb25QaHJhc2UuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFN5bnRoZXNpc1N0YXR1cyB9IGZyb20gXCIuLi9FeHBvcnRzXCI7XG5leHBvcnQgY2xhc3MgVHJhbnNsYXRpb25TeW50aGVzaXNFbmQge1xuICAgIGNvbnN0cnVjdG9yKGpzb24pIHtcbiAgICAgICAgdGhpcy5wcml2U3ludGhlc2lzRW5kID0gSlNPTi5wYXJzZShqc29uKTtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2U3ludGhlc2lzRW5kLlN5bnRoZXNpc1N0YXR1cykge1xuICAgICAgICAgICAgdGhpcy5wcml2U3ludGhlc2lzRW5kLlN5bnRoZXNpc1N0YXR1cyA9IFN5bnRoZXNpc1N0YXR1c1t0aGlzLnByaXZTeW50aGVzaXNFbmQuU3ludGhlc2lzU3RhdHVzXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoISF0aGlzLnByaXZTeW50aGVzaXNFbmQuU3RhdHVzKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZTeW50aGVzaXNFbmQuU3ludGhlc2lzU3RhdHVzID0gU3ludGhlc2lzU3RhdHVzW3RoaXMucHJpdlN5bnRoZXNpc0VuZC5TdGF0dXNdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIHJldHVybiBuZXcgVHJhbnNsYXRpb25TeW50aGVzaXNFbmQoanNvbik7XG4gICAgfVxuICAgIGdldCBTeW50aGVzaXNTdGF0dXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTeW50aGVzaXNFbmQuU3ludGhlc2lzU3RhdHVzO1xuICAgIH1cbiAgICBnZXQgRmFpbHVyZVJlYXNvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlN5bnRoZXNpc0VuZC5GYWlsdXJlUmVhc29uO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VHJhbnNsYXRpb25TeW50aGVzaXNFbmQuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmV4cG9ydCBjbGFzcyBUdXJuU3RhdHVzUmVzcG9uc2VQYXlsb2FkIHtcbiAgICBjb25zdHJ1Y3Rvcihqc29uKSB7XG4gICAgICAgIHRoaXMucHJpdk1lc3NhZ2VTdGF0dXNSZXNwb25zZSA9IEpTT04ucGFyc2UoanNvbik7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIHJldHVybiBuZXcgVHVyblN0YXR1c1Jlc3BvbnNlUGF5bG9hZChqc29uKTtcbiAgICB9XG4gICAgZ2V0IGludGVyYWN0aW9uSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZNZXNzYWdlU3RhdHVzUmVzcG9uc2UuaW50ZXJhY3Rpb25JZDtcbiAgICB9XG4gICAgZ2V0IGNvbnZlcnNhdGlvbklkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TWVzc2FnZVN0YXR1c1Jlc3BvbnNlLmNvbnZlcnNhdGlvbklkO1xuICAgIH1cbiAgICBnZXQgc3RhdHVzQ29kZSgpIHtcbiAgICAgICAgLy8gUGF5bG9hZHMgbWF5IGNvbnRhaW4gYSBsaW1pdGVkIHNldCBvZiB0ZXh0dWFsIHJlcHJlc2VudGF0aW9ucyBvciBhIG51bWVyaWMgc3RhdHVzXG4gICAgICAgIC8vIGNvZGUuIFRoZSB0ZXh0dWFsIHZhbHVlcyBhcmUgaGVyZSBjb252ZXJ0ZWQgaW50byBudW1lcmljIG9uZXMuXG4gICAgICAgIHN3aXRjaCAodGhpcy5wcml2TWVzc2FnZVN0YXR1c1Jlc3BvbnNlLnN0YXR1c0NvZGUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJTdWNjZXNzXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDIwMDtcbiAgICAgICAgICAgIGNhc2UgXCJGYWlsZWRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gNDAwO1xuICAgICAgICAgICAgY2FzZSBcIlRpbWVkT3V0XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDQyOTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtcmV0dXJuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdk1lc3NhZ2VTdGF0dXNSZXNwb25zZS5zdGF0dXNDb2RlO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1UdXJuU3RhdHVzUGF5bG9hZC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBSZXBsYXlhYmxlQXVkaW9Ob2RlIH0gZnJvbSBcIi4uL2NvbW1vbi5icm93c2VyL0V4cG9ydHNcIjtcbmltcG9ydCB7IEFyZ3VtZW50TnVsbEVycm9yLCBDb25uZWN0aW9uU3RhdGUsIGNyZWF0ZU5vRGFzaEd1aWQsIEV2ZW50U291cmNlLCBNZXNzYWdlVHlwZSwgU2VydmljZUV2ZW50LCBUaW1lb3V0IH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDYW5jZWxsYXRpb25FcnJvckNvZGUsIENhbmNlbGxhdGlvblJlYXNvbiwgUHJvcGVydHlJZCwgUmVjb2duaXRpb25FdmVudEFyZ3MsIFNlc3Npb25FdmVudEFyZ3MsIH0gZnJvbSBcIi4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBBZ2VudENvbmZpZywgRHluYW1pY0dyYW1tYXJCdWlsZGVyLCBSZWNvZ25pdGlvbk1vZGUsIFJlcXVlc3RTZXNzaW9uLCBTcGVlY2hDb250ZXh0LCBTcGVlY2hEZXRlY3RlZCwgdHlwZSB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbmltcG9ydCB7IFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlIH0gZnJvbSBcIi4vU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UuSW50ZXJuYWxcIjtcbmV4cG9ydCBjbGFzcyBTZXJ2aWNlUmVjb2duaXplckJhc2Uge1xuICAgIGNvbnN0cnVjdG9yKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Tb3VyY2UsIHJlY29nbml6ZXJDb25maWcsIHJlY29nbml6ZXIpIHtcbiAgICAgICAgLy8gQSBwcm9taXNlIGZvciBhIGNvbmZpZ3VyZWQgY29ubmVjdGlvbi5cbiAgICAgICAgLy8gRG8gbm90IGNvbnN1bWUgZGlyZWN0bHksIGNhbGwgZmV0Y2hDb25uZWN0aW9uIGluc3RlYWQuXG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWd1cmF0aW9uUHJvbWlzZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgLy8gQSBwcm9taXNlIGZvciBhIGNvbm5lY3Rpb24sIGJ1dCBvbmUgdGhhdCBoYXMgbm90IGhhZCB0aGUgc3BlZWNoIGNvbnRleHQgc2VudCB5ZXQuXG4gICAgICAgIC8vIERvIG5vdCBjb25zdW1lIGRpcmVjdGx5LCBjYWxsIGZldGNoQ29ubmVjdGlvbiBpbnN0ZWFkLlxuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uUHJvbWlzZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5wcml2U2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIHRoaXMucHJpdklzTGl2ZUF1ZGlvID0gZmFsc2U7XG4gICAgICAgIHRoaXMucmVjb2duaXplT3ZlcnJpZGUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucmVjb2duaXplU3BlYWtlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5kaXNjb25uZWN0T3ZlcnJpZGUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucmVjZWl2ZU1lc3NhZ2VPdmVycmlkZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zZW5kUHJlUGF5bG9hZEpTT05PdmVycmlkZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5wb3N0Q29ubmVjdEltcGxPdmVycmlkZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5jb25maWdDb25uZWN0aW9uT3ZlcnJpZGUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuaGFuZGxlU3BlZWNoUGhyYXNlTWVzc2FnZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5oYW5kbGVTcGVlY2hIeXBvdGhlc2lzTWVzc2FnZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKCFhdXRoZW50aWNhdGlvbikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50TnVsbEVycm9yKFwiYXV0aGVudGljYXRpb25cIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFjb25uZWN0aW9uRmFjdG9yeSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50TnVsbEVycm9yKFwiY29ubmVjdGlvbkZhY3RvcnlcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFhdWRpb1NvdXJjZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50TnVsbEVycm9yKFwiYXVkaW9Tb3VyY2VcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFyZWNvZ25pemVyQ29uZmlnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXJyb3IoXCJyZWNvZ25pemVyQ29uZmlnXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdk11c3RSZXBvcnRFbmRPZlN0cmVhbSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZBdXRoZW50aWNhdGlvbiA9IGF1dGhlbnRpY2F0aW9uO1xuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uRmFjdG9yeSA9IGNvbm5lY3Rpb25GYWN0b3J5O1xuICAgICAgICB0aGlzLnByaXZBdWRpb1NvdXJjZSA9IGF1ZGlvU291cmNlO1xuICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnID0gcmVjb2duaXplckNvbmZpZztcbiAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyID0gcmVjb2duaXplcjtcbiAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24gPSBuZXcgUmVxdWVzdFNlc3Npb24odGhpcy5wcml2QXVkaW9Tb3VyY2UuaWQoKSk7XG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25FdmVudHMgPSBuZXcgRXZlbnRTb3VyY2UoKTtcbiAgICAgICAgdGhpcy5wcml2U2VydmljZUV2ZW50cyA9IG5ldyBFdmVudFNvdXJjZSgpO1xuICAgICAgICB0aGlzLnByaXZEeW5hbWljR3JhbW1hciA9IG5ldyBEeW5hbWljR3JhbW1hckJ1aWxkZXIoKTtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoQ29udGV4dCA9IG5ldyBTcGVlY2hDb250ZXh0KHRoaXMucHJpdkR5bmFtaWNHcmFtbWFyKTtcbiAgICAgICAgdGhpcy5wcml2QWdlbnRDb25maWcgPSBuZXcgQWdlbnRDb25maWcoKTtcbiAgICAgICAgaWYgKHR5cGVvZiAoQmxvYikgIT09IFwidW5kZWZpbmVkXCIgJiYgdHlwZW9mIChXb3JrZXIpICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZTZXRUaW1lb3V0ID0gVGltZW91dC5zZXRUaW1lb3V0O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29ubmVjdGlvbkV2ZW50cy5hdHRhY2goKGNvbm5lY3Rpb25FdmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb25FdmVudC5uYW1lID09PSBcIkNvbm5lY3Rpb25DbG9zZWRFdmVudFwiKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbkNsb3NlZEV2ZW50ID0gY29ubmVjdGlvbkV2ZW50O1xuICAgICAgICAgICAgICAgIGlmIChjb25uZWN0aW9uQ2xvc2VkRXZlbnQuc3RhdHVzQ29kZSA9PT0gMTAwMyB8fFxuICAgICAgICAgICAgICAgICAgICBjb25uZWN0aW9uQ2xvc2VkRXZlbnQuc3RhdHVzQ29kZSA9PT0gMTAwNyB8fFxuICAgICAgICAgICAgICAgICAgICBjb25uZWN0aW9uQ2xvc2VkRXZlbnQuc3RhdHVzQ29kZSA9PT0gMTAwMiB8fFxuICAgICAgICAgICAgICAgICAgICBjb25uZWN0aW9uQ2xvc2VkRXZlbnQuc3RhdHVzQ29kZSA9PT0gNDAwMCB8fFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5udW1Db25uZWN0aW9uQXR0ZW1wdHMgPiB0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLm1heFJldHJ5Q291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdm9pZCB0aGlzLmNhbmNlbFJlY29nbml0aW9uTG9jYWwoQ2FuY2VsbGF0aW9uUmVhc29uLkVycm9yLCBjb25uZWN0aW9uQ2xvc2VkRXZlbnQuc3RhdHVzQ29kZSA9PT0gMTAwNyA/IENhbmNlbGxhdGlvbkVycm9yQ29kZS5CYWRSZXF1ZXN0UGFyYW1ldGVycyA6IENhbmNlbGxhdGlvbkVycm9yQ29kZS5Db25uZWN0aW9uRmFpbHVyZSwgYCR7Y29ubmVjdGlvbkNsb3NlZEV2ZW50LnJlYXNvbn0gd2Vic29ja2V0IGVycm9yIGNvZGU6ICR7Y29ubmVjdGlvbkNsb3NlZEV2ZW50LnN0YXR1c0NvZGV9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgcGhyYXNlRGV0ZWN0aW9uID0ge307XG4gICAgICAgIGlmIChyZWNvZ25pemVyQ29uZmlnLmF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29uc3Qgc291cmNlTGFuZ3VhZ2VzID0gcmVjb2duaXplckNvbmZpZy5hdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VzLnNwbGl0KFwiLFwiKTtcbiAgICAgICAgICAgIGxldCBzcGVlY2hDb250ZXh0TGlkTW9kZTtcbiAgICAgICAgICAgIGlmIChyZWNvZ25pemVyQ29uZmlnLmxhbmd1YWdlSWRNb2RlID09PSBcIkNvbnRpbnVvdXNcIikge1xuICAgICAgICAgICAgICAgIHNwZWVjaENvbnRleHRMaWRNb2RlID0gXCJEZXRlY3RDb250aW51b3VzXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHsgLy8gcmVjb2duaXplckNvbmZpZy5sYW5ndWFnZUlkTW9kZSA9PT0gXCJBdFN0YXJ0XCJcbiAgICAgICAgICAgICAgICBzcGVlY2hDb250ZXh0TGlkTW9kZSA9IFwiRGV0ZWN0QXRBdWRpb1N0YXJ0XCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hDb250ZXh0LnNldFNlY3Rpb24oXCJsYW5ndWFnZUlkXCIsIHtcbiAgICAgICAgICAgICAgICBQcmlvcml0eTogXCJQcmlvcml0aXplTGF0ZW5jeVwiLFxuICAgICAgICAgICAgICAgIGxhbmd1YWdlczogc291cmNlTGFuZ3VhZ2VzLFxuICAgICAgICAgICAgICAgIG1vZGU6IHNwZWVjaENvbnRleHRMaWRNb2RlLFxuICAgICAgICAgICAgICAgIG9uU3VjY2VzczogeyBhY3Rpb246IFwiUmVjb2duaXplXCIgfSxcbiAgICAgICAgICAgICAgICBvblVua25vd246IHsgYWN0aW9uOiBcIk5vbmVcIiB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaENvbnRleHQuc2V0U2VjdGlvbihcInBocmFzZU91dHB1dFwiLCB7XG4gICAgICAgICAgICAgICAgaW50ZXJpbVJlc3VsdHM6IHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0VHlwZTogXCJBdXRvXCJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHBocmFzZVJlc3VsdHM6IHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0VHlwZTogXCJBbHdheXNcIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3QgY3VzdG9tTW9kZWxzID0gcmVjb2duaXplckNvbmZpZy5zb3VyY2VMYW5ndWFnZU1vZGVscztcbiAgICAgICAgICAgIGlmIChjdXN0b21Nb2RlbHMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHBocmFzZURldGVjdGlvbi5jdXN0b21Nb2RlbHMgPSBjdXN0b21Nb2RlbHM7XG4gICAgICAgICAgICAgICAgcGhyYXNlRGV0ZWN0aW9uLm9uSW50ZXJpbSA9IHsgYWN0aW9uOiBcIk5vbmVcIiB9O1xuICAgICAgICAgICAgICAgIHBocmFzZURldGVjdGlvbi5vblN1Y2Nlc3MgPSB7IGFjdGlvbjogXCJOb25lXCIgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpc0VtcHR5ID0gKG9iaikgPT4ge1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGd1YXJkLWZvci1pbiwgYnJhY2Utc3R5bGVcbiAgICAgICAgICAgIGZvciAoY29uc3QgeCBpbiBvYmopIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCFpc0VtcHR5KHBocmFzZURldGVjdGlvbikpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaENvbnRleHQuc2V0U2VjdGlvbihcInBocmFzZURldGVjdGlvblwiLCBwaHJhc2VEZXRlY3Rpb24pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNldFNwZWVjaFNlZ21lbnRhdGlvblRpbWVvdXQoKSB7XG4gICAgICAgIGNvbnN0IHNwZWVjaFNlZ21lbnRhdGlvblRpbWVvdXQgPSB0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hfU2VnbWVudGF0aW9uU2lsZW5jZVRpbWVvdXRNcywgdW5kZWZpbmVkKTtcbiAgICAgICAgaWYgKHNwZWVjaFNlZ21lbnRhdGlvblRpbWVvdXQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29uc3QgbW9kZSA9IHRoaXMucmVjb2duaXRpb25Nb2RlID09PSBSZWNvZ25pdGlvbk1vZGUuQ29udmVyc2F0aW9uID8gXCJDT05WRVJTQVRJT05cIiA6XG4gICAgICAgICAgICAgICAgdGhpcy5yZWNvZ25pdGlvbk1vZGUgPT09IFJlY29nbml0aW9uTW9kZS5EaWN0YXRpb24gPyBcIkRJQ1RBVElPTlwiIDogXCJJTlRFUkFDVElWRVwiO1xuICAgICAgICAgICAgY29uc3Qgc2VnbWVudGF0aW9uU2lsZW5jZVRpbWVvdXRNcyA9IHBhcnNlSW50KHNwZWVjaFNlZ21lbnRhdGlvblRpbWVvdXQsIDEwKTtcbiAgICAgICAgICAgIGNvbnN0IHBocmFzZURldGVjdGlvbiA9IHRoaXMucHJpdlNwZWVjaENvbnRleHQuZ2V0U2VjdGlvbihcInBocmFzZURldGVjdGlvblwiKTtcbiAgICAgICAgICAgIHBocmFzZURldGVjdGlvbi5tb2RlID0gbW9kZTtcbiAgICAgICAgICAgIHBocmFzZURldGVjdGlvblttb2RlXSA9IHtcbiAgICAgICAgICAgICAgICBzZWdtZW50YXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZTogXCJDdXN0b21cIixcbiAgICAgICAgICAgICAgICAgICAgc2VnbWVudGF0aW9uU2lsZW5jZVRpbWVvdXRNc1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hDb250ZXh0LnNldFNlY3Rpb24oXCJwaHJhc2VEZXRlY3Rpb25cIiwgcGhyYXNlRGV0ZWN0aW9uKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgYXVkaW9Tb3VyY2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb1NvdXJjZTtcbiAgICB9XG4gICAgZ2V0IHNwZWVjaENvbnRleHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hDb250ZXh0O1xuICAgIH1cbiAgICBnZXQgZHluYW1pY0dyYW1tYXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZEeW5hbWljR3JhbW1hcjtcbiAgICB9XG4gICAgZ2V0IGFnZW50Q29uZmlnKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QWdlbnRDb25maWc7XG4gICAgfVxuICAgIHNldCBjb252ZXJzYXRpb25UcmFuc2xhdG9yVG9rZW4odG9rZW4pIHtcbiAgICAgICAgdGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5wYXJhbWV0ZXJzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9Ub2tlbiwgdG9rZW4pO1xuICAgIH1cbiAgICBzZXQgdm9pY2VQcm9maWxlVHlwZSh0eXBlKSB7XG4gICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcucGFyYW1ldGVycy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1NwZWFrZXJJZE1vZGUsIHR5cGUpO1xuICAgIH1cbiAgICBzZXQgYXV0aGVudGljYXRpb24oYXV0aCkge1xuICAgICAgICB0aGlzLnByaXZBdXRoZW50aWNhdGlvbiA9IHRoaXMuYXV0aGVudGljYXRpb247XG4gICAgfVxuICAgIGlzRGlzcG9zZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJc0Rpc3Bvc2VkO1xuICAgIH1cbiAgICBkaXNwb3NlKHJlYXNvbikge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ3VyYXRpb25Qcm9taXNlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0geWllbGQgdGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ3VyYXRpb25Qcm9taXNlO1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCBjb25uZWN0aW9uLmRpc3Bvc2UocmVhc29uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBjb25uZWN0aW9uIGlzIGluIGEgYmFkIHN0YXRlLiBCdXQgd2UncmUgdHJ5aW5nIHRvIGtpbGwgaXQsIHNvLi4uXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXQgY29ubmVjdGlvbkV2ZW50cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25FdmVudHM7XG4gICAgfVxuICAgIGdldCBzZXJ2aWNlRXZlbnRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U2VydmljZUV2ZW50cztcbiAgICB9XG4gICAgZ2V0IHJlY29nbml0aW9uTW9kZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcucmVjb2duaXRpb25Nb2RlO1xuICAgIH1cbiAgICByZWNvZ25pemUocmVjb01vZGUsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsQmFjaykge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucmVjb2duaXplT3ZlcnJpZGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucmVjb2duaXplT3ZlcnJpZGUocmVjb01vZGUsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsQmFjayk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gQ2xlYXIgdGhlIGV4aXN0aW5nIGNvbmZpZ3VyYXRpb24gcHJvbWlzZSB0byBmb3JjZSBhIHJlLXRyYW5zbWlzc2lvbiBvZiBjb25maWcgYW5kIGNvbnRleHQuXG4gICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlndXJhdGlvblByb21pc2UgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLnJlY29nbml0aW9uTW9kZSA9IHJlY29Nb2RlO1xuICAgICAgICAgICAgdGhpcy5zZXRTcGVlY2hTZWdtZW50YXRpb25UaW1lb3V0KCk7XG4gICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2sgPSBzdWNjZXNzQ2FsbGJhY2s7XG4gICAgICAgICAgICB0aGlzLnByaXZFcnJvckNhbGxiYWNrID0gZXJyb3JDYWxsQmFjaztcbiAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnN0YXJ0TmV3UmVjb2duaXRpb24oKTtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmxpc3RlbkZvclNlcnZpY2VUZWxlbWV0cnkodGhpcy5wcml2QXVkaW9Tb3VyY2UuZXZlbnRzKTtcbiAgICAgICAgICAgIC8vIFN0YXJ0IHRoZSBjb25uZWN0aW9uIHRvIHRoZSBzZXJ2aWNlLiBUaGUgcHJvbWlzZSB0aGlzIHdpbGwgY3JlYXRlIGlzIHN0b3JlZCBhbmQgd2lsbCBiZSB1c2VkIGJ5IGNvbmZpZ3VyZUNvbm5lY3Rpb24oKS5cbiAgICAgICAgICAgIGNvbnN0IGNvblByb21pc2UgPSB0aGlzLmNvbm5lY3RJbXBsKCk7XG4gICAgICAgICAgICBsZXQgYXVkaW9Ob2RlO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBhdWRpb1N0cmVhbU5vZGUgPSB5aWVsZCB0aGlzLmF1ZGlvU291cmNlLmF0dGFjaCh0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5hdWRpb05vZGVJZCk7XG4gICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0ID0geWllbGQgdGhpcy5hdWRpb1NvdXJjZS5mb3JtYXQ7XG4gICAgICAgICAgICAgICAgY29uc3QgZGV2aWNlSW5mbyA9IHlpZWxkIHRoaXMuYXVkaW9Tb3VyY2UuZGV2aWNlSW5mbztcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZJc0xpdmVBdWRpbyA9IGRldmljZUluZm8udHlwZSAmJiBkZXZpY2VJbmZvLnR5cGUgPT09IHR5cGUuTWljcm9waG9uZXM7XG4gICAgICAgICAgICAgICAgYXVkaW9Ob2RlID0gbmV3IFJlcGxheWFibGVBdWRpb05vZGUoYXVkaW9TdHJlYW1Ob2RlLCBmb3JtYXQuYXZnQnl0ZXNQZXJTZWMpO1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uQXVkaW9Tb3VyY2VBdHRhY2hDb21wbGV0ZWQoYXVkaW9Ob2RlLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5TcGVlY2hTZXJ2aWNlQ29uZmlnLkNvbnRleHQuYXVkaW8gPSB7IHNvdXJjZTogZGV2aWNlSW5mbyB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25TdG9wUmVjb2duaXppbmcoKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgeWllbGQgY29uUHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuY2FuY2VsUmVjb2duaXRpb25Mb2NhbChDYW5jZWxsYXRpb25SZWFzb24uRXJyb3IsIENhbmNlbGxhdGlvbkVycm9yQ29kZS5Db25uZWN0aW9uRmFpbHVyZSwgZXJyb3IpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb25TdGFydEV2ZW50QXJncyA9IG5ldyBTZXNzaW9uRXZlbnRBcmdzKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZSZWNvZ25pemVyLnNlc3Npb25TdGFydGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVjb2duaXplci5zZXNzaW9uU3RhcnRlZCh0aGlzLnByaXZSZWNvZ25pemVyLCBzZXNzaW9uU3RhcnRFdmVudEFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdm9pZCB0aGlzLnJlY2VpdmVNZXNzYWdlKCk7XG4gICAgICAgICAgICBjb25zdCBhdWRpb1NlbmRQcm9taXNlID0gdGhpcy5zZW5kQXVkaW8oYXVkaW9Ob2RlKTtcbiAgICAgICAgICAgIGF1ZGlvU2VuZFByb21pc2UuY2F0Y2goKGVycm9yKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5jYW5jZWxSZWNvZ25pdGlvbkxvY2FsKENhbmNlbGxhdGlvblJlYXNvbi5FcnJvciwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLlJ1bnRpbWVFcnJvciwgZXJyb3IpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc3RvcFJlY29nbml6aW5nKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmlzUmVjb2duaXppbmcpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmF1ZGlvU291cmNlLnR1cm5PZmYoKTtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5zZW5kRmluYWxBdWRpbygpO1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblN0b3BSZWNvZ25pemluZygpO1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi50dXJuQ29tcGxldGlvblByb21pc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgY29ubmVjdCgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuY29ubmVjdEltcGwoKTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNvbm5lY3RBc3luYyhjYiwgZXJyKSB7XG4gICAgICAgIHRoaXMuY29ubmVjdEltcGwoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKCEhY2IpIHtcbiAgICAgICAgICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgICAgICBlcnIoZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LCAocmVhc29uKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgICAgICBlcnIocmVhc29uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZGlzY29ubmVjdCgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuY2FuY2VsUmVjb2duaXRpb25Mb2NhbChDYW5jZWxsYXRpb25SZWFzb24uRXJyb3IsIENhbmNlbGxhdGlvbkVycm9yQ29kZS5Ob0Vycm9yLCBcIkRpc2Nvbm5lY3RpbmdcIik7XG4gICAgICAgICAgICBpZiAodGhpcy5kaXNjb25uZWN0T3ZlcnJpZGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuZGlzY29ubmVjdE92ZXJyaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2Q29ubmVjdGlvblByb21pc2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkICh5aWVsZCB0aGlzLnByaXZDb25uZWN0aW9uUHJvbWlzZSkuZGlzcG9zZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uUHJvbWlzZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICBzZW5kTWVzc2FnZShtZXNzYWdlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc2VuZE5ldHdvcmtNZXNzYWdlKHBhdGgsIHBheWxvYWQpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IHR5cGUgPSB0eXBlb2YgcGF5bG9hZCA9PT0gXCJzdHJpbmdcIiA/IE1lc3NhZ2VUeXBlLlRleHQgOiBNZXNzYWdlVHlwZS5CaW5hcnk7XG4gICAgICAgICAgICBjb25zdCBjb250ZW50VHlwZSA9IHR5cGVvZiBwYXlsb2FkID09PSBcInN0cmluZ1wiID8gXCJhcHBsaWNhdGlvbi9qc29uXCIgOiBcIlwiO1xuICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHlpZWxkIHRoaXMuZmV0Y2hDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICByZXR1cm4gY29ubmVjdGlvbi5zZW5kKG5ldyBTcGVlY2hDb25uZWN0aW9uTWVzc2FnZSh0eXBlLCBwYXRoLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIGNvbnRlbnRUeXBlLCBwYXlsb2FkKSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZXQgYWN0aXZpdHlUZW1wbGF0ZShtZXNzYWdlUGF5bG9hZCkge1xuICAgICAgICB0aGlzLnByaXZBY3Rpdml0eVRlbXBsYXRlID0gbWVzc2FnZVBheWxvYWQ7XG4gICAgfVxuICAgIGdldCBhY3Rpdml0eVRlbXBsYXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QWN0aXZpdHlUZW1wbGF0ZTtcbiAgICB9XG4gICAgc2VuZFRlbGVtZXRyeURhdGEoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBjb25zdCB0ZWxlbWV0cnlEYXRhID0gdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uZ2V0VGVsZW1ldHJ5KCk7XG4gICAgICAgICAgICBpZiAoU2VydmljZVJlY29nbml6ZXJCYXNlLnRlbGVtZXRyeURhdGFFbmFibGVkICE9PSB0cnVlIHx8XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCB8fFxuICAgICAgICAgICAgICAgIG51bGwgPT09IHRlbGVtZXRyeURhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoISFTZXJ2aWNlUmVjb2duaXplckJhc2UudGVsZW1ldHJ5RGF0YSkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIFNlcnZpY2VSZWNvZ25pemVyQmFzZS50ZWxlbWV0cnlEYXRhKHRlbGVtZXRyeURhdGEpO1xuICAgICAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoX2EpIHsgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHlpZWxkIHRoaXMuZmV0Y2hDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICB5aWVsZCBjb25uZWN0aW9uLnNlbmQobmV3IFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlKE1lc3NhZ2VUeXBlLlRleHQsIFwidGVsZW1ldHJ5XCIsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgXCJhcHBsaWNhdGlvbi9qc29uXCIsIHRlbGVtZXRyeURhdGEpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8vIENhbmNlbHMgcmVjb2duaXRpb24uXG4gICAgY2FuY2VsUmVjb2duaXRpb25Mb2NhbChjYW5jZWxsYXRpb25SZWFzb24sIGVycm9yQ29kZSwgZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmlzUmVjb2duaXppbmcpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblN0b3BSZWNvZ25pemluZygpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2FuY2VsUmVjb2duaXRpb24odGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIGNhbmNlbGxhdGlvblJlYXNvbiwgZXJyb3JDb2RlLCBlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZWNlaXZlTWVzc2FnZSgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdklzRGlzcG9zZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UncmUgZG9uZS5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsZXQgY29ubmVjdGlvbiA9IHlpZWxkIHRoaXMuZmV0Y2hDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IHlpZWxkIGNvbm5lY3Rpb24ucmVhZCgpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlY2VpdmVNZXNzYWdlT3ZlcnJpZGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZWNlaXZlTWVzc2FnZU92ZXJyaWRlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGluZGljYXRlcyB3ZSBhcmUgZHJhaW5pbmcgdGhlIHF1ZXVlIGFuZCBpdCBjYW1lIHdpdGggbm8gbWVzc2FnZTtcbiAgICAgICAgICAgICAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5pc1JlY29nbml6aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZWNlaXZlTWVzc2FnZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucHJpdlNlcnZpY2VIYXNTZW50TWVzc2FnZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbk1lc3NhZ2UgPSBTcGVlY2hDb25uZWN0aW9uTWVzc2FnZS5mcm9tQ29ubmVjdGlvbk1lc3NhZ2UobWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb25NZXNzYWdlLnJlcXVlc3RJZC50b0xvd2VyQ2FzZSgpID09PSB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGNvbm5lY3Rpb25NZXNzYWdlLnBhdGgudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInR1cm4uc3RhcnRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZNdXN0UmVwb3J0RW5kT2ZTdHJlYW0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uU2VydmljZVR1cm5TdGFydFJlc3BvbnNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwic3BlZWNoLnN0YXJ0ZGV0ZWN0ZWRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzcGVlY2hTdGFydERldGVjdGVkID0gU3BlZWNoRGV0ZWN0ZWQuZnJvbUpTT04oY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNwZWVjaFN0YXJ0RXZlbnRBcmdzID0gbmV3IFJlY29nbml0aW9uRXZlbnRBcmdzKHNwZWVjaFN0YXJ0RGV0ZWN0ZWQuT2Zmc2V0LCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlJlY29nbml6ZXIuc3BlZWNoU3RhcnREZXRlY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyLnNwZWVjaFN0YXJ0RGV0ZWN0ZWQodGhpcy5wcml2UmVjb2duaXplciwgc3BlZWNoU3RhcnRFdmVudEFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzcGVlY2guZW5kZGV0ZWN0ZWRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQganNvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uID0gY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcmVxdWVzdCB3YXMgZW1wdHksIHRoZSBKU09OIHJldHVybmVkIGlzIGVtcHR5LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uID0gXCJ7IE9mZnNldDogMCB9XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNwZWVjaFN0b3BEZXRlY3RlZCA9IFNwZWVjaERldGVjdGVkLmZyb21KU09OKGpzb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNwZWVjaFN0b3BFdmVudEFyZ3MgPSBuZXcgUmVjb2duaXRpb25FdmVudEFyZ3Moc3BlZWNoU3RvcERldGVjdGVkLk9mZnNldCArIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmN1cnJlbnRUdXJuQXVkaW9PZmZzZXQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2UmVjb2duaXplci5zcGVlY2hFbmREZXRlY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyLnNwZWVjaEVuZERldGVjdGVkKHRoaXMucHJpdlJlY29nbml6ZXIsIHNwZWVjaFN0b3BFdmVudEFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJ0dXJuLmVuZFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuc2VuZFRlbGVtZXRyeURhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2UmVxdWVzdFNlc3Npb24uaXNTcGVlY2hFbmRlZCAmJiB0aGlzLnByaXZNdXN0UmVwb3J0RW5kT2ZTdHJlYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2TXVzdFJlcG9ydEVuZE9mU3RyZWFtID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuY2FuY2VsUmVjb2duaXRpb25Mb2NhbChDYW5jZWxsYXRpb25SZWFzb24uRW5kT2ZTdHJlYW0sIENhbmNlbGxhdGlvbkVycm9yQ29kZS5Ob0Vycm9yLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZXNzaW9uU3RvcEV2ZW50QXJncyA9IG5ldyBTZXNzaW9uRXZlbnRBcmdzKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25TZXJ2aWNlVHVybkVuZFJlc3BvbnNlKHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcuaXNDb250aW51b3VzUmVjb2duaXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5pc0NvbnRpbnVvdXNSZWNvZ25pdGlvbiB8fCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5pc1NwZWVjaEVuZGVkIHx8ICF0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5pc1JlY29nbml6aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlJlY29nbml6ZXIuc2Vzc2lvblN0b3BwZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXIuc2Vzc2lvblN0b3BwZWQodGhpcy5wcml2UmVjb2duaXplciwgc2Vzc2lvblN0b3BFdmVudEFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3Rpb24gPSB5aWVsZCB0aGlzLmZldGNoQ29ubmVjdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnNlbmRQcmVQYXlsb2FkSlNPTihjb25uZWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHlpZWxkIHRoaXMucHJvY2Vzc1R5cGVTcGVjaWZpY01lc3NhZ2VzKGNvbm5lY3Rpb25NZXNzYWdlKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaGVyZSBhcmUgc29tZSBtZXNzYWdlcyB0aGF0IHRoZSBkZXJpdmVkIGNsYXNzIGhhcyBub3QgcHJvY2Vzc2VkLCBkaXNwYXRjaCB0aGVtIHRvIGNvbm5lY3QgY2xhc3NcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2U2VydmljZUV2ZW50cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXJ2aWNlRXZlbnRzLm9uRXZlbnQobmV3IFNlcnZpY2VFdmVudChjb25uZWN0aW9uTWVzc2FnZS5wYXRoLnRvTG93ZXJDYXNlKCksIGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVjZWl2ZU1lc3NhZ2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2VuZFNwZWVjaENvbnRleHQoY29ubmVjdGlvbiwgZ2VuZXJhdGVOZXdSZXF1ZXN0SWQpIHtcbiAgICAgICAgY29uc3Qgc3BlZWNoQ29udGV4dEpzb24gPSB0aGlzLnNwZWVjaENvbnRleHQudG9KU09OKCk7XG4gICAgICAgIGlmIChnZW5lcmF0ZU5ld1JlcXVlc3RJZCkge1xuICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25TcGVlY2hDb250ZXh0KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNwZWVjaENvbnRleHRKc29uKSB7XG4gICAgICAgICAgICByZXR1cm4gY29ubmVjdGlvbi5zZW5kKG5ldyBTcGVlY2hDb25uZWN0aW9uTWVzc2FnZShNZXNzYWdlVHlwZS5UZXh0LCBcInNwZWVjaC5jb250ZXh0XCIsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgXCJhcHBsaWNhdGlvbi9qc29uXCIsIHNwZWVjaENvbnRleHRKc29uKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBub09wKCkge1xuICAgICAgICAvLyBvcGVyYXRpb24gbm90IHN1cHBvcnRlZFxuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIC8vIEVuY2Fwc3VsYXRlZCBmb3IgZGVyaXZlZCBzZXJ2aWNlIHJlY29nbml6ZXJzIHRoYXQgbmVlZCB0byBzZW5kIGFkZGl0aW9uYWwgSlNPTlxuICAgIHNlbmRQcmVQYXlsb2FkSlNPTihjb25uZWN0aW9uLCBnZW5lcmF0ZU5ld1JlcXVlc3RJZCA9IHRydWUpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbmRQcmVQYXlsb2FkSlNPTk92ZXJyaWRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zZW5kUHJlUGF5bG9hZEpTT05PdmVycmlkZShjb25uZWN0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHlpZWxkIHRoaXMuc2VuZFNwZWVjaENvbnRleHQoY29ubmVjdGlvbiwgZ2VuZXJhdGVOZXdSZXF1ZXN0SWQpO1xuICAgICAgICAgICAgeWllbGQgdGhpcy5zZW5kV2F2ZUhlYWRlcihjb25uZWN0aW9uKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNlbmRXYXZlSGVhZGVyKGNvbm5lY3Rpb24pIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IGZvcm1hdCA9IHlpZWxkIHRoaXMuYXVkaW9Tb3VyY2UuZm9ybWF0O1xuICAgICAgICAgICAgLy8gdGhpcy53cml0ZUJ1ZmZlclRvQ29uc29sZShmb3JtYXQuaGVhZGVyKTtcbiAgICAgICAgICAgIHJldHVybiBjb25uZWN0aW9uLnNlbmQobmV3IFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlKE1lc3NhZ2VUeXBlLkJpbmFyeSwgXCJhdWRpb1wiLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIFwiYXVkaW8veC13YXZcIiwgZm9ybWF0LmhlYWRlcikpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLy8gRXN0YWJsaXNoZXMgYSB3ZWJzb2NrZXQgY29ubmVjdGlvbiB0byB0aGUgZW5kIHBvaW50LlxuICAgIGNvbm5lY3RJbXBsKCkge1xuICAgICAgICBpZiAodGhpcy5wcml2Q29ubmVjdGlvblByb21pc2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25Qcm9taXNlLnRoZW4oKGNvbm5lY3Rpb24pID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbi5zdGF0ZSgpID09PSBDb25uZWN0aW9uU3RhdGUuRGlzY29ubmVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25JZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Qcm9taXNlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTZXJ2aWNlSGFzU2VudE1lc3NhZ2UgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29ubmVjdEltcGwoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25Qcm9taXNlO1xuICAgICAgICAgICAgfSwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25JZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvblByb21pc2UgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U2VydmljZUhhc1NlbnRNZXNzYWdlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29ubmVjdEltcGwoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Qcm9taXNlID0gdGhpcy5yZXRyeWFibGVDb25uZWN0KCk7XG4gICAgICAgIC8vIEF0dGFjaCBhbiBlbXB0eSBoYW5kbGVyIHRvIGFsbG93IHRoZSBwcm9taXNlIHRvIHJ1biBpbiB0aGUgYmFja2dyb3VuZCB3aGlsZVxuICAgICAgICAvLyBvdGhlciBzdGFydHVwIGV2ZW50cyBoYXBwZW4uIEl0J2xsIGV2ZW50dWFsbHkgYmUgYXdhaXRlZCBvbi5cbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvblxuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uUHJvbWlzZS5jYXRjaCgoKSA9PiB7IH0pO1xuICAgICAgICBpZiAodGhpcy5wb3N0Q29ubmVjdEltcGxPdmVycmlkZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wb3N0Q29ubmVjdEltcGxPdmVycmlkZSh0aGlzLnByaXZDb25uZWN0aW9uUHJvbWlzZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25Qcm9taXNlO1xuICAgIH1cbiAgICBzZW5kU3BlZWNoU2VydmljZUNvbmZpZyhjb25uZWN0aW9uLCByZXF1ZXN0U2Vzc2lvbiwgU3BlZWNoU2VydmljZUNvbmZpZ0pzb24pIHtcbiAgICAgICAgcmVxdWVzdFNlc3Npb24ub25TcGVlY2hDb250ZXh0KCk7XG4gICAgICAgIC8vIGZpbHRlciBvdXQgYW55dGhpbmcgdGhhdCBpcyBub3QgcmVxdWlyZWQgZm9yIHRoZSBzZXJ2aWNlIHRvIHdvcmsuXG4gICAgICAgIGlmIChTZXJ2aWNlUmVjb2duaXplckJhc2UudGVsZW1ldHJ5RGF0YUVuYWJsZWQgIT09IHRydWUpIHtcbiAgICAgICAgICAgIGNvbnN0IHdpdGhUZWxlbWV0cnkgPSBKU09OLnBhcnNlKFNwZWVjaFNlcnZpY2VDb25maWdKc29uKTtcbiAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VtZW50ID0ge1xuICAgICAgICAgICAgICAgIGNvbnRleHQ6IHtcbiAgICAgICAgICAgICAgICAgICAgc3lzdGVtOiB3aXRoVGVsZW1ldHJ5LmNvbnRleHQuc3lzdGVtLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgU3BlZWNoU2VydmljZUNvbmZpZ0pzb24gPSBKU09OLnN0cmluZ2lmeShyZXBsYWNlbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShcImYwZjVkZWJjLWY4YzktNDg5Mi1hYzRiLTkwYTdhYjM1OWZkMlwiLCBcImZhbHNlXCIpLnRvTG93ZXJDYXNlKCkgPT09IFwidHJ1ZVwiKSB7XG4gICAgICAgICAgICBjb25zdCBqc29uID0gSlNPTi5wYXJzZShTcGVlY2hTZXJ2aWNlQ29uZmlnSnNvbik7XG4gICAgICAgICAgICBqc29uLmNvbnRleHQuRGlzYWJsZVJlZmVyZW5jZUNoYW5uZWwgPSBcIlRydWVcIjtcbiAgICAgICAgICAgIGpzb24uY29udGV4dC5NaWNTcGVjID0gXCIxXzBfMFwiO1xuICAgICAgICAgICAgU3BlZWNoU2VydmljZUNvbmZpZ0pzb24gPSBKU09OLnN0cmluZ2lmeShqc29uKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoU3BlZWNoU2VydmljZUNvbmZpZ0pzb24pIHtcbiAgICAgICAgICAgIHJldHVybiBjb25uZWN0aW9uLnNlbmQobmV3IFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlKE1lc3NhZ2VUeXBlLlRleHQsIFwic3BlZWNoLmNvbmZpZ1wiLCByZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIFwiYXBwbGljYXRpb24vanNvblwiLCBTcGVlY2hTZXJ2aWNlQ29uZmlnSnNvbikpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZmV0Y2hDb25uZWN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWd1cmF0aW9uUHJvbWlzZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWd1cmF0aW9uUHJvbWlzZS50aGVuKChjb25uZWN0aW9uKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb25uZWN0aW9uLnN0YXRlKCkgPT09IENvbm5lY3Rpb25TdGF0ZS5EaXNjb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25JZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlndXJhdGlvblByb21pc2UgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTZXJ2aWNlSGFzU2VudE1lc3NhZ2UgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZldGNoQ29ubmVjdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlndXJhdGlvblByb21pc2U7XG4gICAgICAgICAgICAgICAgfSwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uSWQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlndXJhdGlvblByb21pc2UgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlNlcnZpY2VIYXNTZW50TWVzc2FnZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5mZXRjaENvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWd1cmF0aW9uUHJvbWlzZSA9IHRoaXMuY29uZmlndXJlQ29ubmVjdGlvbigpO1xuICAgICAgICAgICAgcmV0dXJuIHlpZWxkIHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWd1cmF0aW9uUHJvbWlzZTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNlbmRBdWRpbyhhdWRpb1N0cmVhbU5vZGUpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IGF1ZGlvRm9ybWF0ID0geWllbGQgdGhpcy5hdWRpb1NvdXJjZS5mb3JtYXQ7XG4gICAgICAgICAgICAvLyBUaGUgdGltZSB3ZSBsYXN0IHNlbnQgZGF0YSB0byB0aGUgc2VydmljZS5cbiAgICAgICAgICAgIGxldCBuZXh0U2VuZFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgLy8gTWF4IGFtb3VudCB0byBzZW5kIGJlZm9yZSB3ZSBzdGFydCB0byB0aHJvdHRsZVxuICAgICAgICAgICAgY29uc3QgZmFzdExhbmVTaXplTXMgPSB0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoXCJTUEVFQ0gtVHJhbnNtaXRMZW5ndGhCZWZvclRocm90dGxlTXNcIiwgXCI1MDAwXCIpO1xuICAgICAgICAgICAgY29uc3QgbWF4U2VuZFVudGhyb3R0bGVkQnl0ZXMgPSBhdWRpb0Zvcm1hdC5hdmdCeXRlc1BlclNlYyAvIDEwMDAgKiBwYXJzZUludChmYXN0TGFuZVNpemVNcywgMTApO1xuICAgICAgICAgICAgY29uc3Qgc3RhcnRSZWNvZ051bWJlciA9IHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlY29nTnVtYmVyO1xuICAgICAgICAgICAgY29uc3QgcmVhZEFuZFVwbG9hZEN5Y2xlID0gKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgICAgIC8vIElmIHNwZWVjaCBpcyBkb25lLCBzdG9wIHNlbmRpbmcgYXVkaW8uXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZJc0Rpc3Bvc2VkICYmXG4gICAgICAgICAgICAgICAgICAgICF0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5pc1NwZWVjaEVuZGVkICYmXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmlzUmVjb2duaXppbmcgJiZcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVjb2dOdW1iZXIgPT09IHN0YXJ0UmVjb2dOdW1iZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHlpZWxkIHRoaXMuZmV0Y2hDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGF1ZGlvU3RyZWFtQ2h1bmsgPSB5aWVsZCBhdWRpb1N0cmVhbU5vZGUucmVhZCgpO1xuICAgICAgICAgICAgICAgICAgICAvLyB3ZSBoYXZlIGEgbmV3IGF1ZGlvIGNodW5rIHRvIHVwbG9hZC5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmlzU3BlZWNoRW5kZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHNlcnZpY2UgYWxyZWFkeSByZWNvZ25pemVkIGF1ZGlvIGVuZCB0aGVuIGRvbid0IHNlbmQgYW55IG1vcmUgYXVkaW9cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsZXQgcGF5bG9hZDtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHNlbmREZWxheTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFhdWRpb1N0cmVhbUNodW5rIHx8IGF1ZGlvU3RyZWFtQ2h1bmsuaXNFbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheWxvYWQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VuZERlbGF5ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheWxvYWQgPSBhdWRpb1N0cmVhbUNodW5rLmJ1ZmZlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uQXVkaW9TZW50KHBheWxvYWQuYnl0ZUxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWF4U2VuZFVudGhyb3R0bGVkQnl0ZXMgPj0gdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uYnl0ZXNTZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VuZERlbGF5ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbmREZWxheSA9IE1hdGgubWF4KDAsIG5leHRTZW5kVGltZSAtIERhdGUubm93KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICgwICE9PSBzZW5kRGVsYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuZGVsYXkoc2VuZERlbGF5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAocGF5bG9hZCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFNlbmRUaW1lID0gRGF0ZS5ub3coKSArIChwYXlsb2FkLmJ5dGVMZW5ndGggKiAxMDAwIC8gKGF1ZGlvRm9ybWF0LmF2Z0J5dGVzUGVyU2VjICogMikpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIEFyZSB3ZSBzdGlsbCBhbGl2ZT9cbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZJc0Rpc3Bvc2VkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAhdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uaXNTcGVlY2hFbmRlZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uaXNSZWNvZ25pemluZyAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVjb2dOdW1iZXIgPT09IHN0YXJ0UmVjb2dOdW1iZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3Rpb24uc2VuZChuZXcgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UoTWVzc2FnZVR5cGUuQmluYXJ5LCBcImF1ZGlvXCIsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgbnVsbCwgcGF5bG9hZCkpLmNhdGNoKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25TZXJ2aWNlVHVybkVuZFJlc3BvbnNlKHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcuaXNDb250aW51b3VzUmVjb2duaXRpb24pLmNhdGNoKCgpID0+IHsgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGF1ZGlvU3RyZWFtQ2h1bmsgPT09IG51bGwgfHwgYXVkaW9TdHJlYW1DaHVuayA9PT0gdm9pZCAwID8gdm9pZCAwIDogYXVkaW9TdHJlYW1DaHVuay5pc0VuZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLndyaXRlQnVmZmVyVG9Db25zb2xlKHBheWxvYWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlZ2FyZGxlc3Mgb2Ygc3VjY2VzcyBvciBmYWlsdXJlLCBzY2hlZHVsZSB0aGUgbmV4dCB1cGxvYWQuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIHVuZGVybHlpbmcgY29ubmVjdGlvbiB3YXMgYnJva2VuLCB0aGUgbmV4dCBjeWNsZSB3aWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGEgbmV3IGNvbm5lY3Rpb24gYW5kIHJlLXRyYW5zbWl0IG1pc3NpbmcgYXVkaW8gYXV0b21hdGljYWxseS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVhZEFuZFVwbG9hZEN5Y2xlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgYXVkaW8gc3RyZWFtIGhhcyBiZWVuIGNsb3NlZCwgbm8gbmVlZCB0byBzY2hlZHVsZSBuZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVhZC11cGxvYWQgY3ljbGUuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZJc0xpdmVBdWRpbykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblNwZWVjaEVuZGVkKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcmVhZEFuZFVwbG9hZEN5Y2xlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXRyeWFibGVDb25uZWN0KCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgbGV0IGlzVW5BdXRob3JpemVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnByaXZBdXRoRmV0Y2hFdmVudElkID0gY3JlYXRlTm9EYXNoR3VpZCgpO1xuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvbklkID0gdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkO1xuICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbklkID0gKHNlc3Npb25JZCAhPT0gdW5kZWZpbmVkKSA/IHNlc3Npb25JZCA6IGNyZWF0ZU5vRGFzaEd1aWQoKTtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uUHJlQ29ubmVjdGlvblN0YXJ0KHRoaXMucHJpdkF1dGhGZXRjaEV2ZW50SWQsIHRoaXMucHJpdkNvbm5lY3Rpb25JZCk7XG4gICAgICAgICAgICBsZXQgbGFzdFN0YXR1c0NvZGUgPSAwO1xuICAgICAgICAgICAgbGV0IGxhc3RSZWFzb24gPSBcIlwiO1xuICAgICAgICAgICAgd2hpbGUgKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm51bUNvbm5lY3Rpb25BdHRlbXB0cyA8PSB0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLm1heFJldHJ5Q291bnQpIHtcbiAgICAgICAgICAgICAgICAvLyBHZXQgdGhlIGF1dGggaW5mb3JtYXRpb24gZm9yIHRoZSBjb25uZWN0aW9uLiBUaGlzIGlzIGEgYml0IG9mIG92ZXJraWxsIGZvciB0aGUgY3VycmVudCBBUEkgc3VyZmFjZSwgYnV0IGxlYXZpbmcgdGhlIHBsdW1iaW5nIGluIHBsYWNlIHRvIGJlIGFibGUgdG8gcmFpc2UgYSBkZXZlbG9wZXItY3VzdG9tZXJcbiAgICAgICAgICAgICAgICAvLyBmYWNpbmcgZXZlbnQgd2hlbiBhIGNvbm5lY3Rpb24gZmFpbHMgdG8gbGV0IHRoZW0gdHJ5IGFuZCBwcm92aWRlIG5ldyBhdXRoIGluZm9ybWF0aW9uLlxuICAgICAgICAgICAgICAgIGNvbnN0IGF1dGhQcm9taXNlID0gaXNVbkF1dGhvcml6ZWQgPyB0aGlzLnByaXZBdXRoZW50aWNhdGlvbi5mZXRjaE9uRXhwaXJ5KHRoaXMucHJpdkF1dGhGZXRjaEV2ZW50SWQpIDogdGhpcy5wcml2QXV0aGVudGljYXRpb24uZmV0Y2godGhpcy5wcml2QXV0aEZldGNoRXZlbnRJZCk7XG4gICAgICAgICAgICAgICAgY29uc3QgYXV0aCA9IHlpZWxkIGF1dGhQcm9taXNlO1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uQXV0aENvbXBsZXRlZChmYWxzZSk7XG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSBjb25uZWN0aW9uXG4gICAgICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHRoaXMucHJpdkNvbm5lY3Rpb25GYWN0b3J5LmNyZWF0ZSh0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLCBhdXRoLCB0aGlzLnByaXZDb25uZWN0aW9uSWQpO1xuICAgICAgICAgICAgICAgIC8vIEF0dGFjaCB0aGUgdGVsZW1ldHJ5IGhhbmRsZXJzLlxuICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmxpc3RlbkZvclNlcnZpY2VUZWxlbWV0cnkoY29ubmVjdGlvbi5ldmVudHMpO1xuICAgICAgICAgICAgICAgIC8vIEF0dGFjaCB0byB0aGUgdW5kZXJseWluZyBldmVudC4gTm8gbmVlZCB0byBob2xkIG9udG8gdGhlIGRldGFjaCBwb2ludGVycyBhcyBpbiB0aGUgZXZlbnQgdGhlIGNvbm5lY3Rpb24gZ29lcyBhd2F5LFxuICAgICAgICAgICAgICAgIC8vIGl0J2xsIHN0b3Agc2VuZGluZyBldmVudHMuXG4gICAgICAgICAgICAgICAgY29ubmVjdGlvbi5ldmVudHMuYXR0YWNoKChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbm5lY3Rpb25FdmVudHMub25FdmVudChldmVudCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSB5aWVsZCBjb25uZWN0aW9uLm9wZW4oKTtcbiAgICAgICAgICAgICAgICAvLyAyMDAgPT0gZXZlcnl0aGluZyBpcyBmaW5lLlxuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNDb2RlID09PSAyMDApIHtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25Db25uZWN0aW9uRXN0YWJsaXNoQ29tcGxldGVkKHJlc3BvbnNlLnN0YXR1c0NvZGUpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGNvbm5lY3Rpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChyZXNwb25zZS5zdGF0dXNDb2RlID09PSAxMDA2KSB7XG4gICAgICAgICAgICAgICAgICAgIGlzVW5BdXRob3JpemVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGFzdFN0YXR1c0NvZGUgPSByZXNwb25zZS5zdGF0dXNDb2RlO1xuICAgICAgICAgICAgICAgIGxhc3RSZWFzb24gPSByZXNwb25zZS5yZWFzb247XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25SZXRyeUNvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uQ29ubmVjdGlvbkVzdGFibGlzaENvbXBsZXRlZChsYXN0U3RhdHVzQ29kZSwgbGFzdFJlYXNvbik7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYFVuYWJsZSB0byBjb250YWN0IHNlcnZlci4gU3RhdHVzQ29kZTogJHtsYXN0U3RhdHVzQ29kZX0sICR7dGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnQpfSBSZWFzb246ICR7bGFzdFJlYXNvbn1gKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGRlbGF5KGRlbGF5TXMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB0aGlzLnByaXZTZXRUaW1lb3V0KHJlc29sdmUsIGRlbGF5TXMpKTtcbiAgICB9XG4gICAgd3JpdGVCdWZmZXJUb0NvbnNvbGUoYnVmZmVyKSB7XG4gICAgICAgIGxldCBvdXQgPSBcIkJ1ZmZlciBTaXplOiBcIjtcbiAgICAgICAgaWYgKG51bGwgPT09IGJ1ZmZlcikge1xuICAgICAgICAgICAgb3V0ICs9IFwibnVsbFwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgcmVhZFZpZXcgPSBuZXcgVWludDhBcnJheShidWZmZXIpO1xuICAgICAgICAgICAgb3V0ICs9IGAke2J1ZmZlci5ieXRlTGVuZ3RofVxcclxcbmA7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ1ZmZlci5ieXRlTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBvdXQgKz0gcmVhZFZpZXdbaV0udG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsIFwiMFwiKSArIFwiIFwiO1xuICAgICAgICAgICAgICAgIGlmICgoKGkgKyAxKSAlIDE2KSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8ob3V0KTtcbiAgICAgICAgICAgICAgICAgICAgb3V0ID0gXCJcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgY29uc29sZS5pbmZvKG91dCk7XG4gICAgfVxuICAgIHNlbmRGaW5hbEF1ZGlvKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHlpZWxkIHRoaXMuZmV0Y2hDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICB5aWVsZCBjb25uZWN0aW9uLnNlbmQobmV3IFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlKE1lc3NhZ2VUeXBlLkJpbmFyeSwgXCJhdWRpb1wiLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIG51bGwsIG51bGwpKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8vIFRha2VzIGFuIGVzdGFibGlzaGVkIHdlYnNvY2tldCBjb25uZWN0aW9uIHRvIHRoZSBlbmRwb2ludCBhbmQgc2VuZHMgc3BlZWNoIGNvbmZpZ3VyYXRpb24gaW5mb3JtYXRpb24uXG4gICAgY29uZmlndXJlQ29ubmVjdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSB5aWVsZCB0aGlzLmNvbm5lY3RJbXBsKCk7XG4gICAgICAgICAgICBpZiAodGhpcy5jb25maWdDb25uZWN0aW9uT3ZlcnJpZGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbmZpZ0Nvbm5lY3Rpb25PdmVycmlkZShjb25uZWN0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHlpZWxkIHRoaXMuc2VuZFNwZWVjaFNlcnZpY2VDb25maWcoY29ubmVjdGlvbiwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24sIHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcuU3BlZWNoU2VydmljZUNvbmZpZy5zZXJpYWxpemUoKSk7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnNlbmRQcmVQYXlsb2FkSlNPTihjb25uZWN0aW9uLCBmYWxzZSk7XG4gICAgICAgICAgICByZXR1cm4gY29ubmVjdGlvbjtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuU2VydmljZVJlY29nbml6ZXJCYXNlLnRlbGVtZXRyeURhdGFFbmFibGVkID0gdHJ1ZTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U2VydmljZVJlY29nbml6ZXJCYXNlLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKiBlc2xpbnQtZGlzYWJsZSBtYXgtY2xhc3Nlcy1wZXItZmlsZSAqL1xuaW1wb3J0IHsgQXVkaW9Tb3VyY2VFcnJvckV2ZW50LCBBdWRpb1N0cmVhbU5vZGVBdHRhY2hlZEV2ZW50LCBBdWRpb1N0cmVhbU5vZGVBdHRhY2hpbmdFdmVudCwgQXVkaW9TdHJlYW1Ob2RlRGV0YWNoZWRFdmVudCwgQXVkaW9TdHJlYW1Ob2RlRXJyb3JFdmVudCwgQ29ubmVjdGlvbkVzdGFibGlzaGVkRXZlbnQsIENvbm5lY3Rpb25Fc3RhYmxpc2hFcnJvckV2ZW50LCBDb25uZWN0aW9uTWVzc2FnZVJlY2VpdmVkRXZlbnQsIENvbm5lY3Rpb25TdGFydEV2ZW50LCB9IGZyb20gXCIuLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29ubmVjdGluZ1RvU2VydmljZUV2ZW50LCBSZWNvZ25pdGlvblRyaWdnZXJlZEV2ZW50IH0gZnJvbSBcIi4vUmVjb2duaXRpb25FdmVudHNcIjtcbmV4cG9ydCBjbGFzcyBTZXJ2aWNlVGVsZW1ldHJ5TGlzdGVuZXIge1xuICAgIGNvbnN0cnVjdG9yKHJlcXVlc3RJZCwgYXVkaW9Tb3VyY2VJZCwgYXVkaW9Ob2RlSWQpIHtcbiAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZMaXN0ZW5pbmdUcmlnZ2VyTWV0cmljID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcml2TWljTWV0cmljID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkVzdGFibGlzaE1ldHJpYyA9IG51bGw7XG4gICAgICAgIHRoaXMucHJpdlJlcXVlc3RJZCA9IHJlcXVlc3RJZDtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9Tb3VyY2VJZCA9IGF1ZGlvU291cmNlSWQ7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvTm9kZUlkID0gYXVkaW9Ob2RlSWQ7XG4gICAgICAgIHRoaXMucHJpdlJlY2VpdmVkTWVzc2FnZXMgPSB7fTtcbiAgICAgICAgdGhpcy5wcml2UGhyYXNlTGF0ZW5jaWVzID0gW107XG4gICAgICAgIHRoaXMucHJpdkh5cG90aGVzaXNMYXRlbmNpZXMgPSBbXTtcbiAgICB9XG4gICAgcGhyYXNlUmVjZWl2ZWQoYXVkaW9SZWNlaXZlZFRpbWUpIHtcbiAgICAgICAgaWYgKGF1ZGlvUmVjZWl2ZWRUaW1lID4gMCkgeyAvLyAwIGluZGljYXRlcyB0aGUgdGltZSBpcyB1bmtub3duLiBEcm9wIGl0LlxuICAgICAgICAgICAgdGhpcy5wcml2UGhyYXNlTGF0ZW5jaWVzLnB1c2goRGF0ZS5ub3coKSAtIGF1ZGlvUmVjZWl2ZWRUaW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoeXBvdGhlc2lzUmVjZWl2ZWQoYXVkaW9SZWNlaXZlZFRpbWUpIHtcbiAgICAgICAgaWYgKGF1ZGlvUmVjZWl2ZWRUaW1lID4gMCkgeyAvLyAwIGluZGljYXRlcyB0aGUgdGltZSBpcyB1bmtub3duLiBEcm9wIGl0LlxuICAgICAgICAgICAgdGhpcy5wcml2SHlwb3RoZXNpc0xhdGVuY2llcy5wdXNoKERhdGUubm93KCkgLSBhdWRpb1JlY2VpdmVkVGltZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25FdmVudChlKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZJc0Rpc3Bvc2VkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBSZWNvZ25pdGlvblRyaWdnZXJlZEV2ZW50ICYmIGUucmVxdWVzdElkID09PSB0aGlzLnByaXZSZXF1ZXN0SWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkxpc3RlbmluZ1RyaWdnZXJNZXRyaWMgPSB7XG4gICAgICAgICAgICAgICAgRW5kOiBlLmV2ZW50VGltZSxcbiAgICAgICAgICAgICAgICBOYW1lOiBcIkxpc3RlbmluZ1RyaWdnZXJcIixcbiAgICAgICAgICAgICAgICBTdGFydDogZS5ldmVudFRpbWUsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgQXVkaW9TdHJlYW1Ob2RlQXR0YWNoaW5nRXZlbnQgJiYgZS5hdWRpb1NvdXJjZUlkID09PSB0aGlzLnByaXZBdWRpb1NvdXJjZUlkICYmIGUuYXVkaW9Ob2RlSWQgPT09IHRoaXMucHJpdkF1ZGlvTm9kZUlkKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZNaWNTdGFydFRpbWUgPSBlLmV2ZW50VGltZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEF1ZGlvU3RyZWFtTm9kZUF0dGFjaGVkRXZlbnQgJiYgZS5hdWRpb1NvdXJjZUlkID09PSB0aGlzLnByaXZBdWRpb1NvdXJjZUlkICYmIGUuYXVkaW9Ob2RlSWQgPT09IHRoaXMucHJpdkF1ZGlvTm9kZUlkKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZNaWNTdGFydFRpbWUgPSBlLmV2ZW50VGltZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEF1ZGlvU291cmNlRXJyb3JFdmVudCAmJiBlLmF1ZGlvU291cmNlSWQgPT09IHRoaXMucHJpdkF1ZGlvU291cmNlSWQpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wcml2TWljTWV0cmljKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2TWljTWV0cmljID0ge1xuICAgICAgICAgICAgICAgICAgICBFbmQ6IGUuZXZlbnRUaW1lLFxuICAgICAgICAgICAgICAgICAgICBFcnJvcjogZS5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgTmFtZTogXCJNaWNyb3Bob25lXCIsXG4gICAgICAgICAgICAgICAgICAgIFN0YXJ0OiB0aGlzLnByaXZNaWNTdGFydFRpbWUsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEF1ZGlvU3RyZWFtTm9kZUVycm9yRXZlbnQgJiYgZS5hdWRpb1NvdXJjZUlkID09PSB0aGlzLnByaXZBdWRpb1NvdXJjZUlkICYmIGUuYXVkaW9Ob2RlSWQgPT09IHRoaXMucHJpdkF1ZGlvTm9kZUlkKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMucHJpdk1pY01ldHJpYykge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdk1pY01ldHJpYyA9IHtcbiAgICAgICAgICAgICAgICAgICAgRW5kOiBlLmV2ZW50VGltZSxcbiAgICAgICAgICAgICAgICAgICAgRXJyb3I6IGUuZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgIE5hbWU6IFwiTWljcm9waG9uZVwiLFxuICAgICAgICAgICAgICAgICAgICBTdGFydDogdGhpcy5wcml2TWljU3RhcnRUaW1lLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBBdWRpb1N0cmVhbU5vZGVEZXRhY2hlZEV2ZW50ICYmIGUuYXVkaW9Tb3VyY2VJZCA9PT0gdGhpcy5wcml2QXVkaW9Tb3VyY2VJZCAmJiBlLmF1ZGlvTm9kZUlkID09PSB0aGlzLnByaXZBdWRpb05vZGVJZCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZNaWNNZXRyaWMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZNaWNNZXRyaWMgPSB7XG4gICAgICAgICAgICAgICAgICAgIEVuZDogZS5ldmVudFRpbWUsXG4gICAgICAgICAgICAgICAgICAgIE5hbWU6IFwiTWljcm9waG9uZVwiLFxuICAgICAgICAgICAgICAgICAgICBTdGFydDogdGhpcy5wcml2TWljU3RhcnRUaW1lLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBDb25uZWN0aW5nVG9TZXJ2aWNlRXZlbnQgJiYgZS5yZXF1ZXN0SWQgPT09IHRoaXMucHJpdlJlcXVlc3RJZCkge1xuICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbklkID0gZS5zZXNzaW9uSWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBDb25uZWN0aW9uU3RhcnRFdmVudCAmJiBlLmNvbm5lY3Rpb25JZCA9PT0gdGhpcy5wcml2Q29ubmVjdGlvbklkKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uU3RhcnRUaW1lID0gZS5ldmVudFRpbWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBDb25uZWN0aW9uRXN0YWJsaXNoZWRFdmVudCAmJiBlLmNvbm5lY3Rpb25JZCA9PT0gdGhpcy5wcml2Q29ubmVjdGlvbklkKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMucHJpdkNvbm5lY3Rpb25Fc3RhYmxpc2hNZXRyaWMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uRXN0YWJsaXNoTWV0cmljID0ge1xuICAgICAgICAgICAgICAgICAgICBFbmQ6IGUuZXZlbnRUaW1lLFxuICAgICAgICAgICAgICAgICAgICBJZDogdGhpcy5wcml2Q29ubmVjdGlvbklkLFxuICAgICAgICAgICAgICAgICAgICBOYW1lOiBcIkNvbm5lY3Rpb25cIixcbiAgICAgICAgICAgICAgICAgICAgU3RhcnQ6IHRoaXMucHJpdkNvbm5lY3Rpb25TdGFydFRpbWUsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIENvbm5lY3Rpb25Fc3RhYmxpc2hFcnJvckV2ZW50ICYmIGUuY29ubmVjdGlvbklkID09PSB0aGlzLnByaXZDb25uZWN0aW9uSWQpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wcml2Q29ubmVjdGlvbkVzdGFibGlzaE1ldHJpYykge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Fc3RhYmxpc2hNZXRyaWMgPSB7XG4gICAgICAgICAgICAgICAgICAgIEVuZDogZS5ldmVudFRpbWUsXG4gICAgICAgICAgICAgICAgICAgIEVycm9yOiB0aGlzLmdldENvbm5lY3Rpb25FcnJvcihlLnN0YXR1c0NvZGUpLFxuICAgICAgICAgICAgICAgICAgICBJZDogdGhpcy5wcml2Q29ubmVjdGlvbklkLFxuICAgICAgICAgICAgICAgICAgICBOYW1lOiBcIkNvbm5lY3Rpb25cIixcbiAgICAgICAgICAgICAgICAgICAgU3RhcnQ6IHRoaXMucHJpdkNvbm5lY3Rpb25TdGFydFRpbWUsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIENvbm5lY3Rpb25NZXNzYWdlUmVjZWl2ZWRFdmVudCAmJiBlLmNvbm5lY3Rpb25JZCA9PT0gdGhpcy5wcml2Q29ubmVjdGlvbklkKSB7XG4gICAgICAgICAgICBpZiAoZS5tZXNzYWdlICYmIGUubWVzc2FnZS5oZWFkZXJzICYmIGUubWVzc2FnZS5oZWFkZXJzLnBhdGgpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMucHJpdlJlY2VpdmVkTWVzc2FnZXNbZS5tZXNzYWdlLmhlYWRlcnMucGF0aF0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVjZWl2ZWRNZXNzYWdlc1tlLm1lc3NhZ2UuaGVhZGVycy5wYXRoXSA9IG5ldyBBcnJheSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBtYXhNZXNzYWdlc1RvU2VuZCA9IDUwO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnByaXZSZWNlaXZlZE1lc3NhZ2VzW2UubWVzc2FnZS5oZWFkZXJzLnBhdGhdLmxlbmd0aCA8IG1heE1lc3NhZ2VzVG9TZW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlY2VpdmVkTWVzc2FnZXNbZS5tZXNzYWdlLmhlYWRlcnMucGF0aF0ucHVzaChlLm5ldHdvcmtSZWNlaXZlZFRpbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRUZWxlbWV0cnkoKSB7XG4gICAgICAgIGNvbnN0IG1ldHJpY3MgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgaWYgKHRoaXMucHJpdkxpc3RlbmluZ1RyaWdnZXJNZXRyaWMpIHtcbiAgICAgICAgICAgIG1ldHJpY3MucHVzaCh0aGlzLnByaXZMaXN0ZW5pbmdUcmlnZ2VyTWV0cmljKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wcml2TWljTWV0cmljKSB7XG4gICAgICAgICAgICBtZXRyaWNzLnB1c2godGhpcy5wcml2TWljTWV0cmljKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wcml2Q29ubmVjdGlvbkVzdGFibGlzaE1ldHJpYykge1xuICAgICAgICAgICAgbWV0cmljcy5wdXNoKHRoaXMucHJpdkNvbm5lY3Rpb25Fc3RhYmxpc2hNZXRyaWMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnByaXZQaHJhc2VMYXRlbmNpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbWV0cmljcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBQaHJhc2VMYXRlbmN5TXM6IHRoaXMucHJpdlBocmFzZUxhdGVuY2llcyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnByaXZIeXBvdGhlc2lzTGF0ZW5jaWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIG1ldHJpY3MucHVzaCh7XG4gICAgICAgICAgICAgICAgRmlyc3RIeXBvdGhlc2lzTGF0ZW5jeU1zOiB0aGlzLnByaXZIeXBvdGhlc2lzTGF0ZW5jaWVzLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdGVsZW1ldHJ5ID0ge1xuICAgICAgICAgICAgTWV0cmljczogbWV0cmljcyxcbiAgICAgICAgICAgIFJlY2VpdmVkTWVzc2FnZXM6IHRoaXMucHJpdlJlY2VpdmVkTWVzc2FnZXMsXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGpzb24gPSBKU09OLnN0cmluZ2lmeSh0ZWxlbWV0cnkpO1xuICAgICAgICAvLyBXZSBkb250IHdhbnQgdG8gc2VuZCB0aGUgc2FtZSB0ZWxlbWV0cnkgYWdhaW4uIFNvIGNsZWFuIHRob3NlIG91dC5cbiAgICAgICAgdGhpcy5wcml2UmVjZWl2ZWRNZXNzYWdlcyA9IHt9O1xuICAgICAgICB0aGlzLnByaXZMaXN0ZW5pbmdUcmlnZ2VyTWV0cmljID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcml2TWljTWV0cmljID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkVzdGFibGlzaE1ldHJpYyA9IG51bGw7XG4gICAgICAgIHRoaXMucHJpdlBocmFzZUxhdGVuY2llcyA9IFtdO1xuICAgICAgICB0aGlzLnByaXZIeXBvdGhlc2lzTGF0ZW5jaWVzID0gW107XG4gICAgICAgIHJldHVybiBqc29uO1xuICAgIH1cbiAgICAvLyBEZXRlcm1pbmVzIGlmIHRoZXJlIGFyZSBhbnkgdGVsZW1ldHJ5IGV2ZW50cyB0byBzZW5kIHRvIHRoZSBzZXJ2aWNlLlxuICAgIGdldCBoYXNUZWxlbWV0cnkoKSB7XG4gICAgICAgIHJldHVybiAoT2JqZWN0LmtleXModGhpcy5wcml2UmVjZWl2ZWRNZXNzYWdlcykubGVuZ3RoICE9PSAwIHx8XG4gICAgICAgICAgICB0aGlzLnByaXZMaXN0ZW5pbmdUcmlnZ2VyTWV0cmljICE9PSBudWxsIHx8XG4gICAgICAgICAgICB0aGlzLnByaXZNaWNNZXRyaWMgIT09IG51bGwgfHxcbiAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Fc3RhYmxpc2hNZXRyaWMgIT09IG51bGwgfHxcbiAgICAgICAgICAgIHRoaXMucHJpdlBocmFzZUxhdGVuY2llcy5sZW5ndGggIT09IDAgfHxcbiAgICAgICAgICAgIHRoaXMucHJpdkh5cG90aGVzaXNMYXRlbmNpZXMubGVuZ3RoICE9PSAwKTtcbiAgICB9XG4gICAgZGlzcG9zZSgpIHtcbiAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCA9IHRydWU7XG4gICAgfVxuICAgIGdldENvbm5lY3Rpb25FcnJvcihzdGF0dXNDb2RlKSB7XG4gICAgICAgIC8qXG4gICAgICAgIC0tIFdlYnNvY2tldCBzdGF0dXMgY29kZXMgLS1cbiAgICAgICAgTm9ybWFsQ2xvc3VyZSA9IDEwMDAsXG4gICAgICAgIEVuZHBvaW50VW5hdmFpbGFibGUgPSAxMDAxLFxuICAgICAgICBQcm90b2NvbEVycm9yID0gMTAwMixcbiAgICAgICAgSW52YWxpZE1lc3NhZ2VUeXBlID0gMTAwMyxcbiAgICAgICAgRW1wdHkgPSAxMDA1LFxuICAgICAgICBJbnZhbGlkUGF5bG9hZERhdGEgPSAxMDA3LFxuICAgICAgICBQb2xpY3lWaW9sYXRpb24gPSAxMDA4LFxuICAgICAgICBNZXNzYWdlVG9vQmlnID0gMTAwOSxcbiAgICAgICAgTWFuZGF0b3J5RXh0ZW5zaW9uID0gMTAxMCxcbiAgICAgICAgSW50ZXJuYWxTZXJ2ZXJFcnJvciA9IDEwMTFcbiAgICAgICAgKi9cbiAgICAgICAgc3dpdGNoIChzdGF0dXNDb2RlKSB7XG4gICAgICAgICAgICBjYXNlIDQwMDpcbiAgICAgICAgICAgIGNhc2UgMTAwMjpcbiAgICAgICAgICAgIGNhc2UgMTAwMzpcbiAgICAgICAgICAgIGNhc2UgMTAwNTpcbiAgICAgICAgICAgIGNhc2UgMTAwNzpcbiAgICAgICAgICAgIGNhc2UgMTAwODpcbiAgICAgICAgICAgIGNhc2UgMTAwOTogcmV0dXJuIFwiQmFkUmVxdWVzdFwiO1xuICAgICAgICAgICAgY2FzZSA0MDE6IHJldHVybiBcIlVuYXV0aG9yaXplZFwiO1xuICAgICAgICAgICAgY2FzZSA0MDM6IHJldHVybiBcIkZvcmJpZGRlblwiO1xuICAgICAgICAgICAgY2FzZSA1MDM6XG4gICAgICAgICAgICBjYXNlIDEwMDE6IHJldHVybiBcIlNlcnZlclVuYXZhaWxhYmxlXCI7XG4gICAgICAgICAgICBjYXNlIDUwMDpcbiAgICAgICAgICAgIGNhc2UgMTAxMTogcmV0dXJuIFwiU2VydmVyRXJyb3JcIjtcbiAgICAgICAgICAgIGNhc2UgNDA4OlxuICAgICAgICAgICAgY2FzZSA1MDQ6IHJldHVybiBcIlRpbWVvdXRcIjtcbiAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiBcInN0YXR1c2NvZGU6XCIgKyBzdGF0dXNDb2RlLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNlcnZpY2VUZWxlbWV0cnlMaXN0ZW5lci5JbnRlcm5hbC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgQ29udGV4dCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbmV4cG9ydCBjbGFzcyBTcGVha2VyUmVjb2duaXRpb25Db25maWcge1xuICAgIGNvbnN0cnVjdG9yKGNvbnRleHQsIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgdGhpcy5wcml2Q29udGV4dCA9IGNvbnRleHQgPyBjb250ZXh0IDogbmV3IENvbnRleHQobnVsbCk7XG4gICAgICAgIHRoaXMucHJpdlBhcmFtZXRlcnMgPSBwYXJhbWV0ZXJzO1xuICAgIH1cbiAgICBnZXQgcGFyYW1ldGVycygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhcmFtZXRlcnM7XG4gICAgfVxuICAgIGdldCBDb250ZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29udGV4dDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWFrZXJSZWNvZ25pdGlvbkNvbmZpZy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyogZXNsaW50LWRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGUgKi9cbmltcG9ydCB7IFByb3h5SW5mbywgV2Vic29ja2V0Q29ubmVjdGlvbiwgfSBmcm9tIFwiLi4vY29tbW9uLmJyb3dzZXIvRXhwb3J0c1wiO1xuaW1wb3J0IHsgUHJvcGVydHlJZCB9IGZyb20gXCIuLi9zZGsvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29ubmVjdGlvbkZhY3RvcnlCYXNlIH0gZnJvbSBcIi4vQ29ubmVjdGlvbkZhY3RvcnlCYXNlXCI7XG5pbXBvcnQgeyBXZWJzb2NrZXRNZXNzYWdlRm9ybWF0dGVyLCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbmltcG9ydCB7IEhlYWRlck5hbWVzIH0gZnJvbSBcIi4vSGVhZGVyTmFtZXNcIjtcbmNsYXNzIFNwZWFrZXJSZWNvZ25pdGlvbkNvbm5lY3Rpb25GYWN0b3J5QmFzZSBleHRlbmRzIENvbm5lY3Rpb25GYWN0b3J5QmFzZSB7XG4gICAgY3JlYXRlKGNvbmZpZywgYXV0aEluZm8sIGVuZHBvaW50UGF0aCwgY29ubmVjdGlvbklkKSB7XG4gICAgICAgIGxldCBlbmRwb2ludCA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnQpO1xuICAgICAgICBpZiAoIWVuZHBvaW50KSB7XG4gICAgICAgICAgICBjb25zdCByZWdpb24gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlZ2lvbik7XG4gICAgICAgICAgICBjb25zdCBob3N0U3VmZml4ID0gQ29ubmVjdGlvbkZhY3RvcnlCYXNlLmdldEhvc3RTdWZmaXgocmVnaW9uKTtcbiAgICAgICAgICAgIGNvbnN0IGhvc3QgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0hvc3QsIGB3c3M6Ly8ke3JlZ2lvbn0uc3ByLWZyb250ZW5kLnNwZWVjaCR7aG9zdFN1ZmZpeH1gKTtcbiAgICAgICAgICAgIGNvbnN0IHNjZW5hcmlvID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9TcGVha2VySWRNb2RlLCBcIlRleHRJbmRlcGVuZGVudElkZW50aWZpY2F0aW9uXCIpO1xuICAgICAgICAgICAgZW5kcG9pbnQgPSBgJHtob3N0fS9zcGVha2VyL3dzLyR7dGhpcy5zY2VuYXJpb1RvUGF0aChzY2VuYXJpbyl9LyR7ZW5kcG9pbnRQYXRofWA7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcXVlcnlQYXJhbXMgPSB7XG4gICAgICAgICAgICBmb3JtYXQ6IFwic2ltcGxlXCIsXG4gICAgICAgICAgICBsYW5ndWFnZTogY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTGFuZ3VhZ2UpLFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnNldENvbW1vblVybFBhcmFtcyhjb25maWcsIHF1ZXJ5UGFyYW1zLCBlbmRwb2ludCk7XG4gICAgICAgIGNvbnN0IGhlYWRlcnMgPSB7fTtcbiAgICAgICAgaWYgKGF1dGhJbmZvLnRva2VuICE9PSB1bmRlZmluZWQgJiYgYXV0aEluZm8udG9rZW4gIT09IFwiXCIpIHtcbiAgICAgICAgICAgIGhlYWRlcnNbYXV0aEluZm8uaGVhZGVyTmFtZV0gPSBhdXRoSW5mby50b2tlbjtcbiAgICAgICAgfVxuICAgICAgICBoZWFkZXJzW0hlYWRlck5hbWVzLkNvbm5lY3Rpb25JZF0gPSBjb25uZWN0aW9uSWQ7XG4gICAgICAgIGhlYWRlcnNbSGVhZGVyTmFtZXMuU3BJREF1dGhLZXldID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9LZXkpO1xuICAgICAgICBjb25maWcucGFyYW1ldGVycy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1VybCwgZW5kcG9pbnQpO1xuICAgICAgICBjb25zdCBlbmFibGVDb21wcmVzc2lvbiA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFwiU1BFRUNILUVuYWJsZVdlYnNvY2tldENvbXByZXNzaW9uXCIsIFwiZmFsc2VcIikgPT09IFwidHJ1ZVwiO1xuICAgICAgICByZXR1cm4gbmV3IFdlYnNvY2tldENvbm5lY3Rpb24oZW5kcG9pbnQsIHF1ZXJ5UGFyYW1zLCBoZWFkZXJzLCBuZXcgV2Vic29ja2V0TWVzc2FnZUZvcm1hdHRlcigpLCBQcm94eUluZm8uZnJvbVJlY29nbml6ZXJDb25maWcoY29uZmlnKSwgZW5hYmxlQ29tcHJlc3Npb24sIGNvbm5lY3Rpb25JZCk7XG4gICAgfVxuICAgIHNjZW5hcmlvVG9QYXRoKG1vZGUpIHtcbiAgICAgICAgc3dpdGNoIChtb2RlKSB7XG4gICAgICAgICAgICBjYXNlIFwiVGV4dEluZGVwZW5kZW50VmVyaWZpY2F0aW9uXCI6XG4gICAgICAgICAgICBjYXNlIFwiMlwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcInZlcmlmaWNhdGlvbi90ZXh0LWluZGVwZW5kZW50XCI7XG4gICAgICAgICAgICBjYXNlIFwiVGV4dERlcGVuZGVudFZlcmlmaWNhdGlvblwiOlxuICAgICAgICAgICAgY2FzZSBcIjFcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJ2ZXJpZmljYXRpb24vdGV4dC1kZXBlbmRlbnRcIjtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiaWRlbnRpZmljYXRpb24vdGV4dC1pbmRlcGVuZGVudFwiO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFNwZWFrZXJSZWNvZ25pdGlvbkNvbm5lY3Rpb25GYWN0b3J5IGV4dGVuZHMgU3BlYWtlclJlY29nbml0aW9uQ29ubmVjdGlvbkZhY3RvcnlCYXNlIHtcbiAgICBjcmVhdGUoY29uZmlnLCBhdXRoSW5mbywgY29ubmVjdGlvbklkKSB7XG4gICAgICAgIHJldHVybiBzdXBlci5jcmVhdGUoY29uZmlnLCBhdXRoSW5mbywgXCJyZWNvZ25pdGlvblwiLCBjb25uZWN0aW9uSWQpO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBWb2ljZVByb2ZpbGVDb25uZWN0aW9uRmFjdG9yeSBleHRlbmRzIFNwZWFrZXJSZWNvZ25pdGlvbkNvbm5lY3Rpb25GYWN0b3J5QmFzZSB7XG4gICAgY3JlYXRlKGNvbmZpZywgYXV0aEluZm8sIGNvbm5lY3Rpb25JZCkge1xuICAgICAgICByZXR1cm4gc3VwZXIuY3JlYXRlKGNvbmZpZywgYXV0aEluZm8sIFwicHJvZmlsZVwiLCBjb25uZWN0aW9uSWQpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlYWtlclJlY29nbml0aW9uQ29ubmVjdGlvbkZhY3RvcnkuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgUmVwbGF5YWJsZUF1ZGlvTm9kZSB9IGZyb20gXCIuLi9jb21tb24uYnJvd3Nlci9FeHBvcnRzXCI7XG5pbXBvcnQgeyBEZWZlcnJlZCwgTWVzc2FnZVR5cGUsIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDYW5jZWxsYXRpb25FcnJvckNvZGUsIENhbmNlbGxhdGlvblJlYXNvbiwgU3BlYWtlclJlY29nbml0aW9uUmVzdWx0LCBQcm9wZXJ0eUNvbGxlY3Rpb24sIFByb3BlcnR5SWQsIFJlc3VsdFJlYXNvbiwgU2Vzc2lvbkV2ZW50QXJncywgfSBmcm9tIFwiLi4vc2RrL0V4cG9ydHNcIjtcbmltcG9ydCB7IENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgU2VydmljZVJlY29nbml6ZXJCYXNlLCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbmltcG9ydCB7IFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlIH0gZnJvbSBcIi4vU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UuSW50ZXJuYWxcIjtcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtY2xhc3Nlcy1wZXItZmlsZVxuZXhwb3J0IGNsYXNzIFNwZWFrZXJTZXJ2aWNlUmVjb2duaXplciBleHRlbmRzIFNlcnZpY2VSZWNvZ25pemVyQmFzZSB7XG4gICAgY29uc3RydWN0b3IoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb1NvdXJjZSwgcmVjb2duaXplckNvbmZpZywgcmVjb2duaXplcikge1xuICAgICAgICBzdXBlcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvU291cmNlLCByZWNvZ25pemVyQ29uZmlnLCByZWNvZ25pemVyKTtcbiAgICAgICAgdGhpcy5wcml2U3BlYWtlclJlY29nbml6ZXIgPSByZWNvZ25pemVyO1xuICAgICAgICB0aGlzLnByaXZTcGVha2VyQXVkaW9Tb3VyY2UgPSBhdWRpb1NvdXJjZTtcbiAgICAgICAgdGhpcy5yZWNvZ25pemVTcGVha2VyID0gKG1vZGVsKSA9PiB0aGlzLnJlY29nbml6ZVNwZWFrZXJPbmNlKG1vZGVsKTtcbiAgICAgICAgdGhpcy5zZW5kUHJlUGF5bG9hZEpTT05PdmVycmlkZSA9ICgpID0+IHRoaXMubm9PcCgpO1xuICAgIH1cbiAgICBwcm9jZXNzVHlwZVNwZWNpZmljTWVzc2FnZXMoY29ubmVjdGlvbk1lc3NhZ2UpIHtcbiAgICAgICAgbGV0IHByb2Nlc3NlZCA9IGZhbHNlO1xuICAgICAgICBjb25zdCByZXN1bHRQcm9wcyA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICAgICAgaWYgKGNvbm5lY3Rpb25NZXNzYWdlLm1lc3NhZ2VUeXBlID09PSBNZXNzYWdlVHlwZS5UZXh0KSB7XG4gICAgICAgICAgICByZXN1bHRQcm9wcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9Kc29uUmVzdWx0LCBjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgIH1cbiAgICAgICAgc3dpdGNoIChjb25uZWN0aW9uTWVzc2FnZS5wYXRoLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgIGNhc2UgXCJzcGVha2VyLnJlc3BvbnNlXCI6XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBKU09OLnBhcnNlKGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0O1xuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMuc3RhdHVzQ29kZS50b0xvd2VyQ2FzZSgpICE9PSBcInN1Y2Nlc3NcIikge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBuZXcgU3BlYWtlclJlY29nbml0aW9uUmVzdWx0KHJlc3BvbnNlLCBSZXN1bHRSZWFzb24uQ2FuY2VsZWQsIENhbmNlbGxhdGlvbkVycm9yQ29kZS5TZXJ2aWNlRXJyb3IsIHJlc3BvbnNlLnN0YXR1cy5yZWFzb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gbmV3IFNwZWFrZXJSZWNvZ25pdGlvblJlc3VsdChyZXNwb25zZSwgUmVzdWx0UmVhc29uLlJlY29nbml6ZWRTcGVha2VyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2UmVzdWx0RGVmZXJyYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVzdWx0RGVmZXJyYWwucmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcm9jZXNzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBkZWZmZXJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICBkZWZmZXJhbC5yZXNvbHZlKHByb2Nlc3NlZCk7XG4gICAgICAgIHJldHVybiBkZWZmZXJhbC5wcm9taXNlO1xuICAgIH1cbiAgICAvLyBDYW5jZWxzIHJlY29nbml0aW9uLlxuICAgIGNhbmNlbFJlY29nbml0aW9uKHNlc3Npb25JZCwgcmVxdWVzdElkLCBjYW5jZWxsYXRpb25SZWFzb24sIGVycm9yQ29kZSwgZXJyb3IpIHtcbiAgICAgICAgY29uc3QgcHJvcGVydGllcyA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICAgICAgcHJvcGVydGllcy5zZXRQcm9wZXJ0eShDYW5jZWxsYXRpb25FcnJvckNvZGVQcm9wZXJ0eU5hbWUsIENhbmNlbGxhdGlvbkVycm9yQ29kZVtlcnJvckNvZGVdKTtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2UmVzdWx0RGVmZXJyYWwpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBTcGVha2VyUmVjb2duaXRpb25SZXN1bHQoe1xuICAgICAgICAgICAgICAgIHNjZW5hcmlvOiB0aGlzLnByaXZTcGVha2VyTW9kZWwuc2NlbmFyaW8sXG4gICAgICAgICAgICAgICAgc3RhdHVzOiB7IHN0YXR1c0NvZGU6IGVycm9yLCByZWFzb246IGVycm9yIH1cbiAgICAgICAgICAgIH0sIFJlc3VsdFJlYXNvbi5DYW5jZWxlZCwgZXJyb3JDb2RlLCBlcnJvcik7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlc3VsdERlZmVycmFsLnJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlc3VsdERlZmVycmFsLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVjb2duaXplU3BlYWtlck9uY2UobW9kZWwpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlNwZWFrZXJNb2RlbCA9IG1vZGVsO1xuICAgICAgICAgICAgdGhpcy52b2ljZVByb2ZpbGVUeXBlID0gbW9kZWwuc2NlbmFyaW87XG4gICAgICAgICAgICBpZiAoIXRoaXMucHJpdlJlc3VsdERlZmVycmFsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVzdWx0RGVmZXJyYWwgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnN0YXJ0TmV3UmVjb2duaXRpb24oKTtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmxpc3RlbkZvclNlcnZpY2VUZWxlbWV0cnkodGhpcy5wcml2U3BlYWtlckF1ZGlvU291cmNlLmV2ZW50cyk7XG4gICAgICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLnBhcmFtZXRlcnMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hfU2Vzc2lvbklkLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQpO1xuICAgICAgICAgICAgLy8gU3RhcnQgdGhlIGNvbm5lY3Rpb24gdG8gdGhlIHNlcnZpY2UuIFRoZSBwcm9taXNlIHRoaXMgd2lsbCBjcmVhdGUgaXMgc3RvcmVkIGFuZCB3aWxsIGJlIHVzZWQgYnkgY29uZmlndXJlQ29ubmVjdGlvbigpLlxuICAgICAgICAgICAgY29uc3QgY29uUHJvbWlzZSA9IHRoaXMuY29ubmVjdEltcGwoKTtcbiAgICAgICAgICAgIGNvbnN0IHByZUF1ZGlvUHJvbWlzZSA9IHRoaXMuc2VuZFByZUF1ZGlvTWVzc2FnZXModGhpcy5leHRyYWN0U3BlYWtlckNvbnRleHQobW9kZWwpKTtcbiAgICAgICAgICAgIGNvbnN0IG5vZGUgPSB5aWVsZCB0aGlzLnByaXZTcGVha2VyQXVkaW9Tb3VyY2UuYXR0YWNoKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmF1ZGlvTm9kZUlkKTtcbiAgICAgICAgICAgIGNvbnN0IGZvcm1hdCA9IHlpZWxkIHRoaXMucHJpdlNwZWFrZXJBdWRpb1NvdXJjZS5mb3JtYXQ7XG4gICAgICAgICAgICBjb25zdCBkZXZpY2VJbmZvID0geWllbGQgdGhpcy5wcml2U3BlYWtlckF1ZGlvU291cmNlLmRldmljZUluZm87XG4gICAgICAgICAgICBjb25zdCBhdWRpb05vZGUgPSBuZXcgUmVwbGF5YWJsZUF1ZGlvTm9kZShub2RlLCBmb3JtYXQuYXZnQnl0ZXNQZXJTZWMpO1xuICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25BdWRpb1NvdXJjZUF0dGFjaENvbXBsZXRlZChhdWRpb05vZGUsIGZhbHNlKTtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcuU3BlZWNoU2VydmljZUNvbmZpZy5Db250ZXh0LmF1ZGlvID0geyBzb3VyY2U6IGRldmljZUluZm8gfTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgeWllbGQgY29uUHJvbWlzZTtcbiAgICAgICAgICAgICAgICB5aWVsZCBwcmVBdWRpb1Byb21pc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYW5jZWxSZWNvZ25pdGlvbih0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgQ2FuY2VsbGF0aW9uUmVhc29uLkVycm9yLCBDYW5jZWxsYXRpb25FcnJvckNvZGUuQ29ubmVjdGlvbkZhaWx1cmUsIGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBzZXNzaW9uU3RhcnRFdmVudEFyZ3MgPSBuZXcgU2Vzc2lvbkV2ZW50QXJncyh0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQpO1xuICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2UmVjb2duaXplci5zZXNzaW9uU3RhcnRlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXIuc2Vzc2lvblN0YXJ0ZWQodGhpcy5wcml2UmVjb2duaXplciwgc2Vzc2lvblN0YXJ0RXZlbnRBcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZvaWQgdGhpcy5yZWNlaXZlTWVzc2FnZSgpO1xuICAgICAgICAgICAgY29uc3QgYXVkaW9TZW5kUHJvbWlzZSA9IHRoaXMuc2VuZEF1ZGlvKGF1ZGlvTm9kZSk7XG4gICAgICAgICAgICAvLyAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgYXVkaW9TZW5kUHJvbWlzZS50aGVuKCgpID0+IHsgfSwgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYW5jZWxSZWNvZ25pdGlvbih0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgQ2FuY2VsbGF0aW9uUmVhc29uLkVycm9yLCBDYW5jZWxsYXRpb25FcnJvckNvZGUuUnVudGltZUVycm9yLCBlcnJvcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZSZXN1bHREZWZlcnJhbC5wcm9taXNlO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2VuZFByZUF1ZGlvTWVzc2FnZXMoY29udGV4dCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHlpZWxkIHRoaXMuZmV0Y2hDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnNlbmRTcGVha2VyUmVjb2duaXRpb24oY29ubmVjdGlvbiwgY29udGV4dCk7XG4gICAgICAgICAgICAvLyBhd2FpdCB0aGlzLnNlbmRXYXZlSGVhZGVyKGNvbm5lY3Rpb24pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2VuZFNwZWFrZXJSZWNvZ25pdGlvbihjb25uZWN0aW9uLCBjb250ZXh0KSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBjb25zdCBzcGVha2VyQ29udGV4dEpzb24gPSBKU09OLnN0cmluZ2lmeShjb250ZXh0KTtcbiAgICAgICAgICAgIHJldHVybiBjb25uZWN0aW9uLnNlbmQobmV3IFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlKE1lc3NhZ2VUeXBlLlRleHQsIFwic3BlYWtlci5jb250ZXh0XCIsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgXCJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04XCIsIHNwZWFrZXJDb250ZXh0SnNvbikpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZXh0cmFjdFNwZWFrZXJDb250ZXh0KG1vZGVsKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBmZWF0dXJlczoge1xuICAgICAgICAgICAgICAgIGludGVyaW1SZXN1bHQ6IFwiZW5hYmxlZFwiLFxuICAgICAgICAgICAgICAgIHByb2dyZXNzaXZlRGV0ZWN0aW9uOiBcImRpc2FibGVkXCIsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcHJvZmlsZUlkczogbW9kZWwucHJvZmlsZUlkcyxcbiAgICAgICAgICAgIHNjZW5hcmlvOiBtb2RlbC5zY2VuYXJpbyxcbiAgICAgICAgfTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWFrZXJTZXJ2aWNlUmVjb2duaXplci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgUHJveHlJbmZvLCBXZWJzb2NrZXRDb25uZWN0aW9uLCB9IGZyb20gXCIuLi9jb21tb24uYnJvd3Nlci9FeHBvcnRzXCI7XG5pbXBvcnQgeyBGb3JjZURpY3RhdGlvblByb3BlcnR5TmFtZSwgT3V0cHV0Rm9ybWF0UHJvcGVydHlOYW1lLCB9IGZyb20gXCIuLi9jb21tb24uc3BlZWNoL0V4cG9ydHNcIjtcbmltcG9ydCB7IE91dHB1dEZvcm1hdCwgUHJvcGVydHlJZCB9IGZyb20gXCIuLi9zZGsvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29ubmVjdGlvbkZhY3RvcnlCYXNlIH0gZnJvbSBcIi4vQ29ubmVjdGlvbkZhY3RvcnlCYXNlXCI7XG5pbXBvcnQgeyBSZWNvZ25pdGlvbk1vZGUsIFdlYnNvY2tldE1lc3NhZ2VGb3JtYXR0ZXIgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBIZWFkZXJOYW1lcyB9IGZyb20gXCIuL0hlYWRlck5hbWVzXCI7XG5pbXBvcnQgeyBRdWVyeVBhcmFtZXRlck5hbWVzIH0gZnJvbSBcIi4vUXVlcnlQYXJhbWV0ZXJOYW1lc1wiO1xuZXhwb3J0IGNsYXNzIFNwZWVjaENvbm5lY3Rpb25GYWN0b3J5IGV4dGVuZHMgQ29ubmVjdGlvbkZhY3RvcnlCYXNlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICAgICAgdGhpcy5pbnRlcmFjdGl2ZVJlbGF0aXZlVXJpID0gXCIvc3BlZWNoL3JlY29nbml0aW9uL2ludGVyYWN0aXZlL2NvZ25pdGl2ZXNlcnZpY2VzL3YxXCI7XG4gICAgICAgIHRoaXMuY29udmVyc2F0aW9uUmVsYXRpdmVVcmkgPSBcIi9zcGVlY2gvcmVjb2duaXRpb24vY29udmVyc2F0aW9uL2NvZ25pdGl2ZXNlcnZpY2VzL3YxXCI7XG4gICAgICAgIHRoaXMuZGljdGF0aW9uUmVsYXRpdmVVcmkgPSBcIi9zcGVlY2gvcmVjb2duaXRpb24vZGljdGF0aW9uL2NvZ25pdGl2ZXNlcnZpY2VzL3YxXCI7XG4gICAgICAgIHRoaXMudW5pdmVyc2FsVXJpID0gXCIvc3BlZWNoL3VuaXZlcnNhbC92XCI7XG4gICAgfVxuICAgIGNyZWF0ZShjb25maWcsIGF1dGhJbmZvLCBjb25uZWN0aW9uSWQpIHtcbiAgICAgICAgbGV0IGVuZHBvaW50ID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludCwgdW5kZWZpbmVkKTtcbiAgICAgICAgY29uc3QgcmVnaW9uID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWdpb24sIHVuZGVmaW5lZCk7XG4gICAgICAgIGNvbnN0IGhvc3RTdWZmaXggPSBDb25uZWN0aW9uRmFjdG9yeUJhc2UuZ2V0SG9zdFN1ZmZpeChyZWdpb24pO1xuICAgICAgICBjb25zdCBob3N0ID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Ib3N0LCBcIndzczovL1wiICsgcmVnaW9uICsgXCIuc3R0LnNwZWVjaFwiICsgaG9zdFN1ZmZpeCk7XG4gICAgICAgIGNvbnN0IHF1ZXJ5UGFyYW1zID0ge307XG4gICAgICAgIGNvbnN0IGVuZHBvaW50SWQgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50SWQsIHVuZGVmaW5lZCk7XG4gICAgICAgIGNvbnN0IGxhbmd1YWdlID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTGFuZ3VhZ2UsIHVuZGVmaW5lZCk7XG4gICAgICAgIGlmIChlbmRwb2ludElkKSB7XG4gICAgICAgICAgICBpZiAoIWVuZHBvaW50IHx8IGVuZHBvaW50LnNlYXJjaChRdWVyeVBhcmFtZXRlck5hbWVzLkN1c3RvbVNwZWVjaERlcGxveW1lbnRJZCkgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgcXVlcnlQYXJhbXNbUXVlcnlQYXJhbWV0ZXJOYW1lcy5DdXN0b21TcGVlY2hEZXBsb3ltZW50SWRdID0gZW5kcG9pbnRJZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChsYW5ndWFnZSkge1xuICAgICAgICAgICAgaWYgKCFlbmRwb2ludCB8fCBlbmRwb2ludC5zZWFyY2goUXVlcnlQYXJhbWV0ZXJOYW1lcy5MYW5ndWFnZSkgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgcXVlcnlQYXJhbXNbUXVlcnlQYXJhbWV0ZXJOYW1lcy5MYW5ndWFnZV0gPSBsYW5ndWFnZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIWVuZHBvaW50IHx8IGVuZHBvaW50LnNlYXJjaChRdWVyeVBhcmFtZXRlck5hbWVzLkZvcm1hdCkgPT09IC0xKSB7XG4gICAgICAgICAgICBxdWVyeVBhcmFtc1tRdWVyeVBhcmFtZXRlck5hbWVzLkZvcm1hdF0gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShPdXRwdXRGb3JtYXRQcm9wZXJ0eU5hbWUsIE91dHB1dEZvcm1hdFtPdXRwdXRGb3JtYXQuU2ltcGxlXSkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29uZmlnLmF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcXVlcnlQYXJhbXNbUXVlcnlQYXJhbWV0ZXJOYW1lcy5FbmFibGVMYW5ndWFnZUlkXSA9IFwidHJ1ZVwiO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0Q29tbW9uVXJsUGFyYW1zKGNvbmZpZywgcXVlcnlQYXJhbXMsIGVuZHBvaW50KTtcbiAgICAgICAgaWYgKCFlbmRwb2ludCkge1xuICAgICAgICAgICAgc3dpdGNoIChjb25maWcucmVjb2duaXRpb25Nb2RlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBSZWNvZ25pdGlvbk1vZGUuQ29udmVyc2F0aW9uOlxuICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoRm9yY2VEaWN0YXRpb25Qcm9wZXJ0eU5hbWUsIFwiZmFsc2VcIikgPT09IFwidHJ1ZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRwb2ludCA9IGhvc3QgKyB0aGlzLmRpY3RhdGlvblJlbGF0aXZlVXJpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpZy5yZWNvZ25pdGlvbkVuZHBvaW50VmVyc2lvbiAhPT0gdW5kZWZpbmVkICYmIHBhcnNlSW50KGNvbmZpZy5yZWNvZ25pdGlvbkVuZHBvaW50VmVyc2lvbiwgMTApID4gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZHBvaW50ID0gYCR7aG9zdH0ke3RoaXMudW5pdmVyc2FsVXJpfSR7Y29uZmlnLnJlY29nbml0aW9uRW5kcG9pbnRWZXJzaW9ufWA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRwb2ludCA9IGhvc3QgKyB0aGlzLmNvbnZlcnNhdGlvblJlbGF0aXZlVXJpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgUmVjb2duaXRpb25Nb2RlLkRpY3RhdGlvbjpcbiAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQgPSBob3N0ICsgdGhpcy5kaWN0YXRpb25SZWxhdGl2ZVVyaTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpZy5yZWNvZ25pdGlvbkVuZHBvaW50VmVyc2lvbiAhPT0gdW5kZWZpbmVkICYmIHBhcnNlSW50KGNvbmZpZy5yZWNvZ25pdGlvbkVuZHBvaW50VmVyc2lvbiwgMTApID4gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQgPSBgJHtob3N0fSR7dGhpcy51bml2ZXJzYWxVcml9JHtjb25maWcucmVjb2duaXRpb25FbmRwb2ludFZlcnNpb259YDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZHBvaW50ID0gaG9zdCArIHRoaXMuaW50ZXJhY3RpdmVSZWxhdGl2ZVVyaTsgLy8gZGVmYXVsdCBpcyBpbnRlcmFjdGl2ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGhlYWRlcnMgPSB7fTtcbiAgICAgICAgaWYgKGF1dGhJbmZvLnRva2VuICE9PSB1bmRlZmluZWQgJiYgYXV0aEluZm8udG9rZW4gIT09IFwiXCIpIHtcbiAgICAgICAgICAgIGhlYWRlcnNbYXV0aEluZm8uaGVhZGVyTmFtZV0gPSBhdXRoSW5mby50b2tlbjtcbiAgICAgICAgfVxuICAgICAgICBoZWFkZXJzW0hlYWRlck5hbWVzLkNvbm5lY3Rpb25JZF0gPSBjb25uZWN0aW9uSWQ7XG4gICAgICAgIGNvbnN0IGVuYWJsZUNvbXByZXNzaW9uID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoXCJTUEVFQ0gtRW5hYmxlV2Vic29ja2V0Q29tcHJlc3Npb25cIiwgXCJmYWxzZVwiKSA9PT0gXCJ0cnVlXCI7XG4gICAgICAgIGNvbnN0IHdlYlNvY2tldENvbm5lY3Rpb24gPSBuZXcgV2Vic29ja2V0Q29ubmVjdGlvbihlbmRwb2ludCwgcXVlcnlQYXJhbXMsIGhlYWRlcnMsIG5ldyBXZWJzb2NrZXRNZXNzYWdlRm9ybWF0dGVyKCksIFByb3h5SW5mby5mcm9tUmVjb2duaXplckNvbmZpZyhjb25maWcpLCBlbmFibGVDb21wcmVzc2lvbiwgY29ubmVjdGlvbklkKTtcbiAgICAgICAgLy8gU2V0IHRoZSB2YWx1ZSBvZiBTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9VcmwgdG8gd2ViU29ja2V0Q29ubmVjdGlvbi51cmkgKGFuZCBub3QgdG8gYGVuZHBvaW50YCksIHNpbmNlIHRoaXMgdmFsdWUgaXMgdGhlIGZpbmFsXG4gICAgICAgIC8vIFVSSSB0aGF0IHdhcyB1c2VkIHRvIG1ha2UgdGhlIGNvbm5lY3Rpb24gKGluY2x1ZGluZyBxdWVyeSBwYXJhbWV0ZXJzKS5cbiAgICAgICAgY29uc3QgdXJpID0gd2ViU29ja2V0Q29ubmVjdGlvbi51cmk7XG4gICAgICAgIGNvbmZpZy5wYXJhbWV0ZXJzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVXJsLCB1cmkpO1xuICAgICAgICByZXR1cm4gd2ViU29ja2V0Q29ubmVjdGlvbjtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWVjaENvbm5lY3Rpb25GYWN0b3J5LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBBcmd1bWVudE51bGxFcnJvciwgQ29ubmVjdGlvbk1lc3NhZ2UgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IEhlYWRlck5hbWVzIH0gZnJvbSBcIi4vSGVhZGVyTmFtZXNcIjtcbmV4cG9ydCBjbGFzcyBTcGVlY2hDb25uZWN0aW9uTWVzc2FnZSBleHRlbmRzIENvbm5lY3Rpb25NZXNzYWdlIHtcbiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlVHlwZSwgcGF0aCwgcmVxdWVzdElkLCBjb250ZW50VHlwZSwgYm9keSwgc3RyZWFtSWQsIGFkZGl0aW9uYWxIZWFkZXJzLCBpZCkge1xuICAgICAgICBpZiAoIXBhdGgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBcmd1bWVudE51bGxFcnJvcihcInBhdGhcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFyZXF1ZXN0SWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBcmd1bWVudE51bGxFcnJvcihcInJlcXVlc3RJZFwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBoZWFkZXJzID0ge307XG4gICAgICAgIGhlYWRlcnNbSGVhZGVyTmFtZXMuUGF0aF0gPSBwYXRoO1xuICAgICAgICBoZWFkZXJzW0hlYWRlck5hbWVzLlJlcXVlc3RJZF0gPSByZXF1ZXN0SWQ7XG4gICAgICAgIGhlYWRlcnNbSGVhZGVyTmFtZXMuUmVxdWVzdFRpbWVzdGFtcF0gPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gICAgICAgIGlmIChjb250ZW50VHlwZSkge1xuICAgICAgICAgICAgaGVhZGVyc1tIZWFkZXJOYW1lcy5Db250ZW50VHlwZV0gPSBjb250ZW50VHlwZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RyZWFtSWQpIHtcbiAgICAgICAgICAgIGhlYWRlcnNbSGVhZGVyTmFtZXMuUmVxdWVzdFN0cmVhbUlkXSA9IHN0cmVhbUlkO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhZGRpdGlvbmFsSGVhZGVycykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBoZWFkZXJOYW1lIGluIGFkZGl0aW9uYWxIZWFkZXJzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGhlYWRlck5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1toZWFkZXJOYW1lXSA9IGFkZGl0aW9uYWxIZWFkZXJzW2hlYWRlck5hbWVdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaWQpIHtcbiAgICAgICAgICAgIHN1cGVyKG1lc3NhZ2VUeXBlLCBib2R5LCBoZWFkZXJzLCBpZCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzdXBlcihtZXNzYWdlVHlwZSwgYm9keSwgaGVhZGVycyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2UGF0aCA9IHBhdGg7XG4gICAgICAgIHRoaXMucHJpdlJlcXVlc3RJZCA9IHJlcXVlc3RJZDtcbiAgICAgICAgdGhpcy5wcml2Q29udGVudFR5cGUgPSBjb250ZW50VHlwZTtcbiAgICAgICAgdGhpcy5wcml2U3RyZWFtSWQgPSBzdHJlYW1JZDtcbiAgICAgICAgdGhpcy5wcml2QWRkaXRpb25hbEhlYWRlcnMgPSBhZGRpdGlvbmFsSGVhZGVycztcbiAgICB9XG4gICAgZ2V0IHBhdGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQYXRoO1xuICAgIH1cbiAgICBnZXQgcmVxdWVzdElkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVxdWVzdElkO1xuICAgIH1cbiAgICBnZXQgY29udGVudFR5cGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb250ZW50VHlwZTtcbiAgICB9XG4gICAgZ2V0IHN0cmVhbUlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3RyZWFtSWQ7XG4gICAgfVxuICAgIGdldCBhZGRpdGlvbmFsSGVhZGVycygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkFkZGl0aW9uYWxIZWFkZXJzO1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbUNvbm5lY3Rpb25NZXNzYWdlKG1lc3NhZ2UpIHtcbiAgICAgICAgbGV0IHBhdGggPSBudWxsO1xuICAgICAgICBsZXQgcmVxdWVzdElkID0gbnVsbDtcbiAgICAgICAgbGV0IGNvbnRlbnRUeXBlID0gbnVsbDtcbiAgICAgICAgLy8gbGV0IHJlcXVlc3RUaW1lc3RhbXAgPSBudWxsO1xuICAgICAgICBsZXQgc3RyZWFtSWQgPSBudWxsO1xuICAgICAgICBjb25zdCBhZGRpdGlvbmFsSGVhZGVycyA9IHt9O1xuICAgICAgICBpZiAobWVzc2FnZS5oZWFkZXJzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGhlYWRlck5hbWUgaW4gbWVzc2FnZS5oZWFkZXJzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGhlYWRlck5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGhlYWRlck5hbWUudG9Mb3dlckNhc2UoKSA9PT0gSGVhZGVyTmFtZXMuUGF0aC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gbWVzc2FnZS5oZWFkZXJzW2hlYWRlck5hbWVdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGhlYWRlck5hbWUudG9Mb3dlckNhc2UoKSA9PT0gSGVhZGVyTmFtZXMuUmVxdWVzdElkLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RJZCA9IG1lc3NhZ2UuaGVhZGVyc1toZWFkZXJOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIH0gZWxzZSBpZiAoaGVhZGVyTmFtZS50b0xvd2VyQ2FzZSgpID09PSBIZWFkZXJOYW1lcy5SZXF1ZXN0VGltZXN0YW1wLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICByZXF1ZXN0VGltZXN0YW1wID0gbWVzc2FnZS5oZWFkZXJzW2hlYWRlck5hbWVdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGhlYWRlck5hbWUudG9Mb3dlckNhc2UoKSA9PT0gSGVhZGVyTmFtZXMuQ29udGVudFR5cGUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFR5cGUgPSBtZXNzYWdlLmhlYWRlcnNbaGVhZGVyTmFtZV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaGVhZGVyTmFtZS50b0xvd2VyQ2FzZSgpID09PSBIZWFkZXJOYW1lcy5SZXF1ZXN0U3RyZWFtSWQudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RyZWFtSWQgPSBtZXNzYWdlLmhlYWRlcnNbaGVhZGVyTmFtZV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRpdGlvbmFsSGVhZGVyc1toZWFkZXJOYW1lXSA9IG1lc3NhZ2UuaGVhZGVyc1toZWFkZXJOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlKG1lc3NhZ2UubWVzc2FnZVR5cGUsIHBhdGgsIHJlcXVlc3RJZCwgY29udGVudFR5cGUsIG1lc3NhZ2UuYm9keSwgc3RyZWFtSWQsIGFkZGl0aW9uYWxIZWFkZXJzLCBtZXNzYWdlLmlkKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWVjaENvbm5lY3Rpb25NZXNzYWdlLkludGVybmFsLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIEpTT04gdXNlZCBpbiB0aGUgc3BlZWNoLmNvbnRleHQgbWVzc2FnZSBzZW50IHRvIHRoZSBzcGVlY2ggc2VydmljZS5cbiAqIFRoZSBkeW5hbWljIGdyYW1tYXIgaXMgYWx3YXlzIHJlZnJlc2hlZCBmcm9tIHRoZSBlbmNhcHN1bGF0ZWQgZHluYW1pYyBncmFtbWFyIG9iamVjdC5cbiAqL1xuZXhwb3J0IGNsYXNzIFNwZWVjaENvbnRleHQge1xuICAgIGNvbnN0cnVjdG9yKGR5bmFtaWNHcmFtbWFyKSB7XG4gICAgICAgIHRoaXMucHJpdkNvbnRleHQgPSB7fTtcbiAgICAgICAgdGhpcy5wcml2RHluYW1pY0dyYW1tYXIgPSBkeW5hbWljR3JhbW1hcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyBhIHNlY3Rpb24gb2YgdGhlIHNwZWVjaC5jb250ZXh0IG9iamVjdC5cbiAgICAgKiBAcGFyYW0gc2VjdGlvbk5hbWUgTmFtZSBvZiB0aGUgc2VjdGlvbiB0byBnZXQuXG4gICAgICogQHJldHVybiBzdHJpbmcgb3IgQ29udGV4dCBKU09OIHNlcmlhbGl6YWJsZSBvYmplY3QgdGhhdCByZXByZXNlbnRzIHRoZSB2YWx1ZS5cbiAgICAgKi9cbiAgICBnZXRTZWN0aW9uKHNlY3Rpb25OYW1lKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5wcml2Q29udGV4dFtzZWN0aW9uTmFtZV0gfHwge30pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgc2VjdGlvbiB0byB0aGUgc3BlZWNoLmNvbnRleHQgb2JqZWN0LlxuICAgICAqIEBwYXJhbSBzZWN0aW9uTmFtZSBOYW1lIG9mIHRoZSBzZWN0aW9uIHRvIGFkZC5cbiAgICAgKiBAcGFyYW0gdmFsdWUgSlNPTiBzZXJpYWxpemFibGUgb2JqZWN0IHRoYXQgcmVwcmVzZW50cyB0aGUgdmFsdWUuXG4gICAgICovXG4gICAgc2V0U2VjdGlvbihzZWN0aW9uTmFtZSwgdmFsdWUpIHtcbiAgICAgICAgdGhpcy5wcml2Q29udGV4dFtzZWN0aW9uTmFtZV0gPSB2YWx1ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQEludGVybmFsXG4gICAgICogVGhpcyBpcyBvbmx5IHVzZWQgYnkgcHJvbnVuY2lhdGlvbiBhc3Nlc3NtZW50IGNvbmZpZy5cbiAgICAgKiBEbyBub3QgdXNlIGV4dGVybmFsbHksIG9iamVjdCByZXR1cm5lZCB3aWxsIGNoYW5nZSB3aXRob3V0IHdhcm5pbmcgb3Igbm90aWNlLlxuICAgICAqL1xuICAgIHNldFByb251bmNpYXRpb25Bc3Nlc3NtZW50UGFyYW1zKHBhcmFtcykge1xuICAgICAgICBpZiAodGhpcy5wcml2Q29udGV4dC5waHJhc2VEZXRlY3Rpb24gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5wcml2Q29udGV4dC5waHJhc2VEZXRlY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgZW5yaWNobWVudDoge1xuICAgICAgICAgICAgICAgICAgICBwcm9udW5jaWF0aW9uQXNzZXNzbWVudDoge31cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdkNvbnRleHQucGhyYXNlRGV0ZWN0aW9uLmVucmljaG1lbnQucHJvbnVuY2lhdGlvbkFzc2Vzc21lbnQgPSBKU09OLnBhcnNlKHBhcmFtcyk7XG4gICAgICAgIHRoaXMuc2V0V29yZExldmVsVGltaW5ncygpO1xuICAgICAgICB0aGlzLnByaXZDb250ZXh0LnBocmFzZU91dHB1dC5kZXRhaWxlZC5vcHRpb25zLnB1c2goXCJQcm9udW5jaWF0aW9uQXNzZXNzbWVudFwiKTtcbiAgICAgICAgaWYgKHRoaXMucHJpdkNvbnRleHQucGhyYXNlT3V0cHV0LmRldGFpbGVkLm9wdGlvbnMuaW5kZXhPZihcIlNOUlwiKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkNvbnRleHQucGhyYXNlT3V0cHV0LmRldGFpbGVkLm9wdGlvbnMucHVzaChcIlNOUlwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRXb3JkTGV2ZWxUaW1pbmdzKCkge1xuICAgICAgICBpZiAodGhpcy5wcml2Q29udGV4dC5waHJhc2VPdXRwdXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5wcml2Q29udGV4dC5waHJhc2VPdXRwdXQgPSB7XG4gICAgICAgICAgICAgICAgZGV0YWlsZWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogW11cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGZvcm1hdDoge31cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucHJpdkNvbnRleHQucGhyYXNlT3V0cHV0LmRldGFpbGVkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkNvbnRleHQucGhyYXNlT3V0cHV0LmRldGFpbGVkID0ge1xuICAgICAgICAgICAgICAgIG9wdGlvbnM6IFtdXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdkNvbnRleHQucGhyYXNlT3V0cHV0LmZvcm1hdCA9IFwiRGV0YWlsZWRcIjtcbiAgICAgICAgaWYgKHRoaXMucHJpdkNvbnRleHQucGhyYXNlT3V0cHV0LmRldGFpbGVkLm9wdGlvbnMuaW5kZXhPZihcIldvcmRUaW1pbmdzXCIpID09PSAtMSkge1xuICAgICAgICAgICAgdGhpcy5wcml2Q29udGV4dC5waHJhc2VPdXRwdXQuZGV0YWlsZWQub3B0aW9ucy5wdXNoKFwiV29yZFRpbWluZ3NcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCBkZ2kgPSB0aGlzLnByaXZEeW5hbWljR3JhbW1hci5nZW5lcmF0ZUdyYW1tYXJPYmplY3QoKTtcbiAgICAgICAgdGhpcy5zZXRTZWN0aW9uKFwiZGdpXCIsIGRnaSk7XG4gICAgICAgIGNvbnN0IHJldCA9IEpTT04uc3RyaW5naWZ5KHRoaXMucHJpdkNvbnRleHQpO1xuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlZWNoQ29udGV4dC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TcGVlY2hTZXJ2aWNlSW50ZXJmYWNlcy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBDYW5jZWxsYXRpb25FcnJvckNvZGUsIE91dHB1dEZvcm1hdCwgUHJvcGVydHlDb2xsZWN0aW9uLCBQcm9wZXJ0eUlkLCBSZXN1bHRSZWFzb24sIFNwZWVjaFJlY29nbml0aW9uQ2FuY2VsZWRFdmVudEFyZ3MsIFNwZWVjaFJlY29nbml0aW9uRXZlbnRBcmdzLCBTcGVlY2hSZWNvZ25pdGlvblJlc3VsdCwgfSBmcm9tIFwiLi4vc2RrL0V4cG9ydHNcIjtcbmltcG9ydCB7IENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgRGV0YWlsZWRTcGVlY2hQaHJhc2UsIEVudW1UcmFuc2xhdGlvbiwgT3V0cHV0Rm9ybWF0UHJvcGVydHlOYW1lLCBSZWNvZ25pdGlvblN0YXR1cywgU2VydmljZVJlY29nbml6ZXJCYXNlLCBTaW1wbGVTcGVlY2hQaHJhc2UsIFNwZWVjaEh5cG90aGVzaXMsIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1jbGFzc2VzLXBlci1maWxlXG5leHBvcnQgY2xhc3MgU3BlZWNoU2VydmljZVJlY29nbml6ZXIgZXh0ZW5kcyBTZXJ2aWNlUmVjb2duaXplckJhc2Uge1xuICAgIGNvbnN0cnVjdG9yKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Tb3VyY2UsIHJlY29nbml6ZXJDb25maWcsIHNwZWVjaFJlY29nbml6ZXIpIHtcbiAgICAgICAgc3VwZXIoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb1NvdXJjZSwgcmVjb2duaXplckNvbmZpZywgc3BlZWNoUmVjb2duaXplcik7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaFJlY29nbml6ZXIgPSBzcGVlY2hSZWNvZ25pemVyO1xuICAgIH1cbiAgICBwcm9jZXNzVHlwZVNwZWNpZmljTWVzc2FnZXMoY29ubmVjdGlvbk1lc3NhZ2UpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGxldCByZXN1bHQ7XG4gICAgICAgICAgICBjb25zdCByZXN1bHRQcm9wcyA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICAgICAgICAgIHJlc3VsdFByb3BzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZVJlc3BvbnNlX0pzb25SZXN1bHQsIGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgICAgIGxldCBwcm9jZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHN3aXRjaCAoY29ubmVjdGlvbk1lc3NhZ2UucGF0aC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcInNwZWVjaC5oeXBvdGhlc2lzXCI6XG4gICAgICAgICAgICAgICAgY2FzZSBcInNwZWVjaC5mcmFnbWVudFwiOlxuICAgICAgICAgICAgICAgICAgICBjb25zdCBoeXBvdGhlc2lzID0gU3BlZWNoSHlwb3RoZXNpcy5mcm9tSlNPTihjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG9mZnNldCA9IGh5cG90aGVzaXMuT2Zmc2V0ICsgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uY3VycmVudFR1cm5BdWRpb09mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gbmV3IFNwZWVjaFJlY29nbml0aW9uUmVzdWx0KHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgUmVzdWx0UmVhc29uLlJlY29nbml6aW5nU3BlZWNoLCBoeXBvdGhlc2lzLlRleHQsIGh5cG90aGVzaXMuRHVyYXRpb24sIG9mZnNldCwgaHlwb3RoZXNpcy5MYW5ndWFnZSwgaHlwb3RoZXNpcy5MYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UsIHVuZGVmaW5lZCwgLy8gU3BlYWtlciBJZFxuICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQsIGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5LCByZXN1bHRQcm9wcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uSHlwb3RoZXNpcyhvZmZzZXQpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBldiA9IG5ldyBTcGVlY2hSZWNvZ25pdGlvbkV2ZW50QXJncyhyZXN1bHQsIGh5cG90aGVzaXMuRHVyYXRpb24sIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlNwZWVjaFJlY29nbml6ZXIucmVjb2duaXppbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoUmVjb2duaXplci5yZWNvZ25pemluZyh0aGlzLnByaXZTcGVlY2hSZWNvZ25pemVyLCBldik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdCBnb2luZyB0byBsZXQgZXJyb3JzIGluIHRoZSBldmVudCBoYW5kbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcInNwZWVjaC5waHJhc2VcIjpcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2ltcGxlID0gU2ltcGxlU3BlZWNoUGhyYXNlLmZyb21KU09OKGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0UmVhc29uID0gRW51bVRyYW5zbGF0aW9uLmltcGxUcmFuc2xhdGVSZWNvZ25pdGlvblJlc3VsdChzaW1wbGUuUmVjb2duaXRpb25TdGF0dXMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblBocmFzZVJlY29nbml6ZWQodGhpcy5wcml2UmVxdWVzdFNlc3Npb24uY3VycmVudFR1cm5BdWRpb09mZnNldCArIHNpbXBsZS5PZmZzZXQgKyBzaW1wbGUuRHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoUmVzdWx0UmVhc29uLkNhbmNlbGVkID09PSByZXN1bHRSZWFzb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhbmNlbFJlYXNvbiA9IEVudW1UcmFuc2xhdGlvbi5pbXBsVHJhbnNsYXRlQ2FuY2VsUmVzdWx0KHNpbXBsZS5SZWNvZ25pdGlvblN0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYW5jZWxsYXRpb25FcnJvckNvZGUgPSBFbnVtVHJhbnNsYXRpb24uaW1wbFRyYW5zbGF0ZUNhbmNlbEVycm9yQ29kZShzaW1wbGUuUmVjb2duaXRpb25TdGF0dXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5jYW5jZWxSZWNvZ25pdGlvbkxvY2FsKGNhbmNlbFJlYXNvbiwgY2FuY2VsbGF0aW9uRXJyb3JDb2RlLCBFbnVtVHJhbnNsYXRpb24uaW1wbFRyYW5zbGF0ZUVycm9yRGV0YWlscyhjYW5jZWxsYXRpb25FcnJvckNvZGUpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmlzU3BlZWNoRW5kZWQgJiYgcmVzdWx0UmVhc29uID09PSBSZXN1bHRSZWFzb24uTm9NYXRjaCAmJiBzaW1wbGUuUmVjb2duaXRpb25TdGF0dXMgIT09IFJlY29nbml0aW9uU3RhdHVzLkluaXRpYWxTaWxlbmNlVGltZW91dCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KE91dHB1dEZvcm1hdFByb3BlcnR5TmFtZSkgPT09IE91dHB1dEZvcm1hdFtPdXRwdXRGb3JtYXQuU2ltcGxlXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBuZXcgU3BlZWNoUmVjb2duaXRpb25SZXN1bHQodGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCByZXN1bHRSZWFzb24sIHNpbXBsZS5EaXNwbGF5VGV4dCwgc2ltcGxlLkR1cmF0aW9uLCBzaW1wbGUuT2Zmc2V0ICsgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uY3VycmVudFR1cm5BdWRpb09mZnNldCwgc2ltcGxlLkxhbmd1YWdlLCBzaW1wbGUuTGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlLCB1bmRlZmluZWQsIC8vIFNwZWFrZXIgSWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5kZWZpbmVkLCBjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSwgcmVzdWx0UHJvcHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGV0YWlsZWQgPSBEZXRhaWxlZFNwZWVjaFBocmFzZS5mcm9tSlNPTihjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRvdGFsT2Zmc2V0ID0gZGV0YWlsZWQuT2Zmc2V0ICsgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uY3VycmVudFR1cm5BdWRpb09mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2V0Q29ycmVjdGVkSnNvbiA9IGRldGFpbGVkLmdldEpzb25XaXRoQ29ycmVjdGVkT2Zmc2V0cyh0b3RhbE9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBTcGVlY2hSZWNvZ25pdGlvblJlc3VsdCh0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIHJlc3VsdFJlYXNvbiwgZGV0YWlsZWQuUmVjb2duaXRpb25TdGF0dXMgPT09IFJlY29nbml0aW9uU3RhdHVzLlN1Y2Nlc3MgPyBkZXRhaWxlZC5OQmVzdFswXS5EaXNwbGF5IDogdW5kZWZpbmVkLCBkZXRhaWxlZC5EdXJhdGlvbiwgdG90YWxPZmZzZXQsIGRldGFpbGVkLkxhbmd1YWdlLCBkZXRhaWxlZC5MYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UsIHVuZGVmaW5lZCwgLy8gU3BlYWtlciBJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQsIG9mZnNldENvcnJlY3RlZEpzb24sIHJlc3VsdFByb3BzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBuZXcgU3BlZWNoUmVjb2duaXRpb25FdmVudEFyZ3MocmVzdWx0LCByZXN1bHQub2Zmc2V0LCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlNwZWVjaFJlY29nbml6ZXIucmVjb2duaXplZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoUmVjb2duaXplci5yZWNvZ25pemVkKHRoaXMucHJpdlNwZWVjaFJlY29nbml6ZXIsIGV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgZ29pbmcgdG8gbGV0IGVycm9ycyBpbiB0aGUgZXZlbnQgaGFuZGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2socmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2RXJyb3JDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2RXJyb3JDYWxsYmFjayhlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IGludm9rZSB0aGUgY2FsbCBiYWNrIG9uY2UuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIGlmIGl0J3Mgc3VjY2Vzc2Z1bCBkb24ndCBpbnZva2UgdGhlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXJyb3IgYWZ0ZXIgdGhhdC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2RXJyb3JDYWxsYmFjayA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBwcm9jZXNzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBwcm9jZXNzZWQ7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvLyBDYW5jZWxzIHJlY29nbml0aW9uLlxuICAgIGNhbmNlbFJlY29nbml0aW9uKHNlc3Npb25JZCwgcmVxdWVzdElkLCBjYW5jZWxsYXRpb25SZWFzb24sIGVycm9yQ29kZSwgZXJyb3IpIHtcbiAgICAgICAgY29uc3QgcHJvcGVydGllcyA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICAgICAgcHJvcGVydGllcy5zZXRQcm9wZXJ0eShDYW5jZWxsYXRpb25FcnJvckNvZGVQcm9wZXJ0eU5hbWUsIENhbmNlbGxhdGlvbkVycm9yQ29kZVtlcnJvckNvZGVdKTtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2U3BlZWNoUmVjb2duaXplci5jYW5jZWxlZCkge1xuICAgICAgICAgICAgY29uc3QgY2FuY2VsRXZlbnQgPSBuZXcgU3BlZWNoUmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJncyhjYW5jZWxsYXRpb25SZWFzb24sIGVycm9yLCBlcnJvckNvZGUsIHVuZGVmaW5lZCwgc2Vzc2lvbklkKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoUmVjb2duaXplci5jYW5jZWxlZCh0aGlzLnByaXZTcGVlY2hSZWNvZ25pemVyLCBjYW5jZWxFdmVudCk7XG4gICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChfYSkgeyB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCEhdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrKSB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgU3BlZWNoUmVjb2duaXRpb25SZXN1bHQocmVxdWVzdElkLCBSZXN1bHRSZWFzb24uQ2FuY2VsZWQsIHVuZGVmaW5lZCwgLy8gVGV4dFxuICAgICAgICAgICAgdW5kZWZpbmVkLCAvLyBEdXJhdGlvblxuICAgICAgICAgICAgdW5kZWZpbmVkLCAvLyBPZmZzZXRcbiAgICAgICAgICAgIHVuZGVmaW5lZCwgLy8gTGFuZ3VhZ2VcbiAgICAgICAgICAgIHVuZGVmaW5lZCwgLy8gTGFuZ3VhZ2UgRGV0ZWN0aW9uIENvbmZpZGVuY2VcbiAgICAgICAgICAgIHVuZGVmaW5lZCwgLy8gU3BlYWtlciBJZFxuICAgICAgICAgICAgZXJyb3IsIHVuZGVmaW5lZCwgLy8gSnNvblxuICAgICAgICAgICAgcHJvcGVydGllcyk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKF9iKSB7IH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlZWNoU2VydmljZVJlY29nbml6ZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFByb3h5SW5mbywgV2Vic29ja2V0Q29ubmVjdGlvbiB9IGZyb20gXCIuLi9jb21tb24uYnJvd3Nlci9FeHBvcnRzXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eUlkIH0gZnJvbSBcIi4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb25uZWN0aW9uRmFjdG9yeUJhc2UgfSBmcm9tIFwiLi9Db25uZWN0aW9uRmFjdG9yeUJhc2VcIjtcbmltcG9ydCB7IFdlYnNvY2tldE1lc3NhZ2VGb3JtYXR0ZXIgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBIZWFkZXJOYW1lcyB9IGZyb20gXCIuL0hlYWRlck5hbWVzXCI7XG5pbXBvcnQgeyBRdWVyeVBhcmFtZXRlck5hbWVzIH0gZnJvbSBcIi4vUXVlcnlQYXJhbWV0ZXJOYW1lc1wiO1xuZXhwb3J0IGNsYXNzIFNwZWVjaFN5bnRoZXNpc0Nvbm5lY3Rpb25GYWN0b3J5IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5zeW50aGVzaXNVcmkgPSBcIi9jb2duaXRpdmVzZXJ2aWNlcy93ZWJzb2NrZXQvdjFcIjtcbiAgICB9XG4gICAgY3JlYXRlKGNvbmZpZywgYXV0aEluZm8sIGNvbm5lY3Rpb25JZCkge1xuICAgICAgICBsZXQgZW5kcG9pbnQgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50LCB1bmRlZmluZWQpO1xuICAgICAgICBjb25zdCByZWdpb24gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlZ2lvbiwgdW5kZWZpbmVkKTtcbiAgICAgICAgY29uc3QgaG9zdFN1ZmZpeCA9IENvbm5lY3Rpb25GYWN0b3J5QmFzZS5nZXRIb3N0U3VmZml4KHJlZ2lvbik7XG4gICAgICAgIGNvbnN0IGVuZHBvaW50SWQgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50SWQsIHVuZGVmaW5lZCk7XG4gICAgICAgIGNvbnN0IGhvc3RQcmVmaXggPSAoZW5kcG9pbnRJZCA9PT0gdW5kZWZpbmVkKSA/IFwidHRzXCIgOiBcInZvaWNlXCI7XG4gICAgICAgIGNvbnN0IGhvc3QgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0hvc3QsIFwid3NzOi8vXCIgKyByZWdpb24gKyBcIi5cIiArIGhvc3RQcmVmaXggKyBcIi5zcGVlY2hcIiArIGhvc3RTdWZmaXgpO1xuICAgICAgICBjb25zdCBxdWVyeVBhcmFtcyA9IHt9O1xuICAgICAgICBpZiAoIWVuZHBvaW50KSB7XG4gICAgICAgICAgICBlbmRwb2ludCA9IGhvc3QgKyB0aGlzLnN5bnRoZXNpc1VyaTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBoZWFkZXJzID0ge307XG4gICAgICAgIGlmIChhdXRoSW5mby50b2tlbiAhPT0gdW5kZWZpbmVkICYmIGF1dGhJbmZvLnRva2VuICE9PSBcIlwiKSB7XG4gICAgICAgICAgICBoZWFkZXJzW2F1dGhJbmZvLmhlYWRlck5hbWVdID0gYXV0aEluZm8udG9rZW47XG4gICAgICAgIH1cbiAgICAgICAgaGVhZGVyc1tIZWFkZXJOYW1lcy5Db25uZWN0aW9uSWRdID0gY29ubmVjdGlvbklkO1xuICAgICAgICBpZiAoZW5kcG9pbnRJZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBoZWFkZXJzW1F1ZXJ5UGFyYW1ldGVyTmFtZXMuQ3VzdG9tVm9pY2VEZXBsb3ltZW50SWRdID0gZW5kcG9pbnRJZDtcbiAgICAgICAgfVxuICAgICAgICBjb25maWcucGFyYW1ldGVycy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1VybCwgZW5kcG9pbnQpO1xuICAgICAgICBjb25zdCBlbmFibGVDb21wcmVzc2lvbiA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFwiU1BFRUNILUVuYWJsZVdlYnNvY2tldENvbXByZXNzaW9uXCIsIFwiZmFsc2VcIikgPT09IFwidHJ1ZVwiO1xuICAgICAgICByZXR1cm4gbmV3IFdlYnNvY2tldENvbm5lY3Rpb24oZW5kcG9pbnQsIHF1ZXJ5UGFyYW1zLCBoZWFkZXJzLCBuZXcgV2Vic29ja2V0TWVzc2FnZUZvcm1hdHRlcigpLCBQcm94eUluZm8uZnJvbVBhcmFtZXRlcnMoY29uZmlnLnBhcmFtZXRlcnMpLCBlbmFibGVDb21wcmVzc2lvbiwgY29ubmVjdGlvbklkKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWVjaFN5bnRoZXNpc0Nvbm5lY3Rpb25GYWN0b3J5LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCB7IEFyZ3VtZW50TnVsbEVycm9yLCBDb25uZWN0aW9uU3RhdGUsIGNyZWF0ZU5vRGFzaEd1aWQsIEV2ZW50U291cmNlLCBNZXNzYWdlVHlwZSwgU2VydmljZUV2ZW50LCB9IGZyb20gXCIuLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLCBDYW5jZWxsYXRpb25SZWFzb24sIFByb3BlcnR5Q29sbGVjdGlvbiwgUHJvcGVydHlJZCwgUmVzdWx0UmVhc29uLCBTcGVlY2hTeW50aGVzaXNCb29rbWFya0V2ZW50QXJncywgU3BlZWNoU3ludGhlc2lzRXZlbnRBcmdzLCBTcGVlY2hTeW50aGVzaXNSZXN1bHQsIFNwZWVjaFN5bnRoZXNpc1Zpc2VtZUV2ZW50QXJncywgU3BlZWNoU3ludGhlc2lzV29yZEJvdW5kYXJ5RXZlbnRBcmdzLCB9IGZyb20gXCIuLi9zZGsvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQWdlbnRDb25maWcsIENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgTWV0YWRhdGFUeXBlLCBTeW50aGVzaXNBdWRpb01ldGFkYXRhLCBTeW50aGVzaXNDb250ZXh0LCBTeW50aGVzaXNUdXJuIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuaW1wb3J0IHsgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UgfSBmcm9tIFwiLi9TcGVlY2hDb25uZWN0aW9uTWVzc2FnZS5JbnRlcm5hbFwiO1xuZXhwb3J0IGNsYXNzIFN5bnRoZXNpc0FkYXB0ZXJCYXNlIHtcbiAgICBjb25zdHJ1Y3RvcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIHN5bnRoZXNpemVyQ29uZmlnLCBzcGVlY2hTeW50aGVzaXplciwgYXVkaW9EZXN0aW5hdGlvbikge1xuICAgICAgICB0aGlzLnNwZWFrT3ZlcnJpZGUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucmVjZWl2ZU1lc3NhZ2VPdmVycmlkZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5jb25uZWN0SW1wbE92ZXJyaWRlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmNvbmZpZ0Nvbm5lY3Rpb25PdmVycmlkZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgLy8gQSBwcm9taXNlIGZvciBhIGNvbmZpZ3VyZWQgY29ubmVjdGlvbi5cbiAgICAgICAgLy8gRG8gbm90IGNvbnN1bWUgZGlyZWN0bHksIGNhbGwgZmV0Y2hDb25uZWN0aW9uIGluc3RlYWQuXG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWd1cmF0aW9uUHJvbWlzZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKCFhdXRoZW50aWNhdGlvbikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50TnVsbEVycm9yKFwiYXV0aGVudGljYXRpb25cIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFjb25uZWN0aW9uRmFjdG9yeSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50TnVsbEVycm9yKFwiY29ubmVjdGlvbkZhY3RvcnlcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzeW50aGVzaXplckNvbmZpZykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50TnVsbEVycm9yKFwic3ludGhlc2l6ZXJDb25maWdcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2QXV0aGVudGljYXRpb24gPSBhdXRoZW50aWNhdGlvbjtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkZhY3RvcnkgPSBjb25uZWN0aW9uRmFjdG9yeTtcbiAgICAgICAgdGhpcy5wcml2U3ludGhlc2l6ZXJDb25maWcgPSBzeW50aGVzaXplckNvbmZpZztcbiAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplciA9IHNwZWVjaFN5bnRoZXNpemVyO1xuICAgICAgICB0aGlzLnByaXZTZXNzaW9uQXVkaW9EZXN0aW5hdGlvbiA9IGF1ZGlvRGVzdGluYXRpb247XG4gICAgICAgIHRoaXMucHJpdlN5bnRoZXNpc1R1cm4gPSBuZXcgU3ludGhlc2lzVHVybigpO1xuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uRXZlbnRzID0gbmV3IEV2ZW50U291cmNlKCk7XG4gICAgICAgIHRoaXMucHJpdlNlcnZpY2VFdmVudHMgPSBuZXcgRXZlbnRTb3VyY2UoKTtcbiAgICAgICAgdGhpcy5wcml2U3ludGhlc2lzQ29udGV4dCA9IG5ldyBTeW50aGVzaXNDb250ZXh0KHRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyKTtcbiAgICAgICAgdGhpcy5wcml2QWdlbnRDb25maWcgPSBuZXcgQWdlbnRDb25maWcoKTtcbiAgICAgICAgdGhpcy5jb25uZWN0aW9uRXZlbnRzLmF0dGFjaCgoY29ubmVjdGlvbkV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoY29ubmVjdGlvbkV2ZW50Lm5hbWUgPT09IFwiQ29ubmVjdGlvbkNsb3NlZEV2ZW50XCIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uQ2xvc2VkRXZlbnQgPSBjb25uZWN0aW9uRXZlbnQ7XG4gICAgICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb25DbG9zZWRFdmVudC5zdGF0dXNDb2RlICE9PSAxMDAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2FuY2VsU3ludGhlc2lzTG9jYWwoQ2FuY2VsbGF0aW9uUmVhc29uLkVycm9yLCBjb25uZWN0aW9uQ2xvc2VkRXZlbnQuc3RhdHVzQ29kZSA9PT0gMTAwNyA/IENhbmNlbGxhdGlvbkVycm9yQ29kZS5CYWRSZXF1ZXN0UGFyYW1ldGVycyA6IENhbmNlbGxhdGlvbkVycm9yQ29kZS5Db25uZWN0aW9uRmFpbHVyZSwgYCR7Y29ubmVjdGlvbkNsb3NlZEV2ZW50LnJlYXNvbn0gd2Vic29ja2V0IGVycm9yIGNvZGU6ICR7Y29ubmVjdGlvbkNsb3NlZEV2ZW50LnN0YXR1c0NvZGV9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZ2V0IHN5bnRoZXNpc0NvbnRleHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTeW50aGVzaXNDb250ZXh0O1xuICAgIH1cbiAgICBnZXQgYWdlbnRDb25maWcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBZ2VudENvbmZpZztcbiAgICB9XG4gICAgZ2V0IGNvbm5lY3Rpb25FdmVudHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uRXZlbnRzO1xuICAgIH1cbiAgICBnZXQgc2VydmljZUV2ZW50cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNlcnZpY2VFdmVudHM7XG4gICAgfVxuICAgIHNldCBhY3Rpdml0eVRlbXBsYXRlKG1lc3NhZ2VQYXlsb2FkKSB7XG4gICAgICAgIHRoaXMucHJpdkFjdGl2aXR5VGVtcGxhdGUgPSBtZXNzYWdlUGF5bG9hZDtcbiAgICB9XG4gICAgZ2V0IGFjdGl2aXR5VGVtcGxhdGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBY3Rpdml0eVRlbXBsYXRlO1xuICAgIH1cbiAgICBzZXQgYXVkaW9PdXRwdXRGb3JtYXQoZm9ybWF0KSB7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvT3V0cHV0Rm9ybWF0ID0gZm9ybWF0O1xuICAgICAgICB0aGlzLnByaXZTeW50aGVzaXNUdXJuLmF1ZGlvT3V0cHV0Rm9ybWF0ID0gZm9ybWF0O1xuICAgICAgICBpZiAodGhpcy5wcml2U2Vzc2lvbkF1ZGlvRGVzdGluYXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5wcml2U2Vzc2lvbkF1ZGlvRGVzdGluYXRpb24uZm9ybWF0ID0gZm9ybWF0O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnN5bnRoZXNpc0NvbnRleHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5zeW50aGVzaXNDb250ZXh0LmF1ZGlvT3V0cHV0Rm9ybWF0ID0gZm9ybWF0O1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBhZGRIZWFkZXIoYXVkaW8sIGZvcm1hdCkge1xuICAgICAgICBpZiAoIWZvcm1hdC5oYXNIZWFkZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBhdWRpbztcbiAgICAgICAgfVxuICAgICAgICBmb3JtYXQudXBkYXRlSGVhZGVyKGF1ZGlvLmJ5dGVMZW5ndGgpO1xuICAgICAgICBjb25zdCB0bXAgPSBuZXcgVWludDhBcnJheShhdWRpby5ieXRlTGVuZ3RoICsgZm9ybWF0LmhlYWRlci5ieXRlTGVuZ3RoKTtcbiAgICAgICAgdG1wLnNldChuZXcgVWludDhBcnJheShmb3JtYXQuaGVhZGVyKSwgMCk7XG4gICAgICAgIHRtcC5zZXQobmV3IFVpbnQ4QXJyYXkoYXVkaW8pLCBmb3JtYXQuaGVhZGVyLmJ5dGVMZW5ndGgpO1xuICAgICAgICByZXR1cm4gdG1wLmJ1ZmZlcjtcbiAgICB9XG4gICAgaXNEaXNwb3NlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzRGlzcG9zZWQ7XG4gICAgfVxuICAgIGRpc3Bvc2UocmVhc29uKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZTZXNzaW9uQXVkaW9EZXN0aW5hdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U2Vzc2lvbkF1ZGlvRGVzdGluYXRpb24uY2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlndXJhdGlvblByb21pc2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSB5aWVsZCB0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlndXJhdGlvblByb21pc2U7XG4gICAgICAgICAgICAgICAgeWllbGQgY29ubmVjdGlvbi5kaXNwb3NlKHJlYXNvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjb25uZWN0KCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgeWllbGQgdGhpcy5jb25uZWN0SW1wbCgpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2VuZE5ldHdvcmtNZXNzYWdlKHBhdGgsIHBheWxvYWQpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IHR5cGUgPSB0eXBlb2YgcGF5bG9hZCA9PT0gXCJzdHJpbmdcIiA/IE1lc3NhZ2VUeXBlLlRleHQgOiBNZXNzYWdlVHlwZS5CaW5hcnk7XG4gICAgICAgICAgICBjb25zdCBjb250ZW50VHlwZSA9IHR5cGVvZiBwYXlsb2FkID09PSBcInN0cmluZ1wiID8gXCJhcHBsaWNhdGlvbi9qc29uXCIgOiBcIlwiO1xuICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHlpZWxkIHRoaXMuZmV0Y2hDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICByZXR1cm4gY29ubmVjdGlvbi5zZW5kKG5ldyBTcGVlY2hDb25uZWN0aW9uTWVzc2FnZSh0eXBlLCBwYXRoLCB0aGlzLnByaXZTeW50aGVzaXNUdXJuLnJlcXVlc3RJZCwgY29udGVudFR5cGUsIHBheWxvYWQpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIFNwZWFrKHRleHQsIGlzU1NNTCwgcmVxdWVzdElkLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbEJhY2ssIGF1ZGlvRGVzdGluYXRpb24pIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGxldCBzc21sO1xuICAgICAgICAgICAgaWYgKGlzU1NNTCkge1xuICAgICAgICAgICAgICAgIHNzbWwgPSB0ZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc3NtbCA9IHRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLmJ1aWxkU3NtbCh0ZXh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnNwZWFrT3ZlcnJpZGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNwZWFrT3ZlcnJpZGUoc3NtbCwgcmVxdWVzdElkLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbEJhY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrID0gc3VjY2Vzc0NhbGxiYWNrO1xuICAgICAgICAgICAgdGhpcy5wcml2RXJyb3JDYWxsYmFjayA9IGVycm9yQ2FsbEJhY2s7XG4gICAgICAgICAgICB0aGlzLnByaXZTeW50aGVzaXNUdXJuLnN0YXJ0TmV3U3ludGhlc2lzKHJlcXVlc3RJZCwgdGV4dCwgaXNTU01MLCBhdWRpb0Rlc3RpbmF0aW9uKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5jb25uZWN0SW1wbCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSB5aWVsZCB0aGlzLmZldGNoQ29ubmVjdGlvbigpO1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuc2VuZFN5bnRoZXNpc0NvbnRleHQoY29ubmVjdGlvbik7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5zZW5kU3NtbE1lc3NhZ2UoY29ubmVjdGlvbiwgc3NtbCwgcmVxdWVzdElkKTtcbiAgICAgICAgICAgICAgICBjb25zdCBzeW50aGVzaXNTdGFydEV2ZW50QXJncyA9IG5ldyBTcGVlY2hTeW50aGVzaXNFdmVudEFyZ3MobmV3IFNwZWVjaFN5bnRoZXNpc1Jlc3VsdChyZXF1ZXN0SWQsIFJlc3VsdFJlYXNvbi5TeW50aGVzaXppbmdBdWRpb1N0YXJ0ZWQpKTtcbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplci5zeW50aGVzaXNTdGFydGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLnN5bnRoZXNpc1N0YXJ0ZWQodGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIsIHN5bnRoZXNpc1N0YXJ0RXZlbnRBcmdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdm9pZCB0aGlzLnJlY2VpdmVNZXNzYWdlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FuY2VsU3ludGhlc2lzTG9jYWwoQ2FuY2VsbGF0aW9uUmVhc29uLkVycm9yLCBDYW5jZWxsYXRpb25FcnJvckNvZGUuQ29ubmVjdGlvbkZhaWx1cmUsIGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8vIENhbmNlbHMgc3ludGhlc2lzLlxuICAgIGNhbmNlbFN5bnRoZXNpcyhyZXF1ZXN0SWQsIGNhbmNlbGxhdGlvblJlYXNvbiwgZXJyb3JDb2RlLCBlcnJvcikge1xuICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICBwcm9wZXJ0aWVzLnNldFByb3BlcnR5KENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW2Vycm9yQ29kZV0pO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgU3BlZWNoU3ludGhlc2lzUmVzdWx0KHJlcXVlc3RJZCwgUmVzdWx0UmVhc29uLkNhbmNlbGVkLCB1bmRlZmluZWQsIGVycm9yLCBwcm9wZXJ0aWVzKTtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIuU3ludGhlc2lzQ2FuY2VsZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGNhbmNlbEV2ZW50ID0gbmV3IFNwZWVjaFN5bnRoZXNpc0V2ZW50QXJncyhyZXN1bHQpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplci5TeW50aGVzaXNDYW5jZWxlZCh0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplciwgY2FuY2VsRXZlbnQpO1xuICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoX2EpIHsgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghIXRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjaykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2socmVzdWx0KTtcbiAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKF9iKSB7IH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBDYW5jZWxzIHN5bnRoZXNpcy5cbiAgICBjYW5jZWxTeW50aGVzaXNMb2NhbChjYW5jZWxsYXRpb25SZWFzb24sIGVycm9yQ29kZSwgZXJyb3IpIHtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2U3ludGhlc2lzVHVybi5pc1N5bnRoZXNpemluZykge1xuICAgICAgICAgICAgdGhpcy5wcml2U3ludGhlc2lzVHVybi5vblN0b3BTeW50aGVzaXppbmcoKTtcbiAgICAgICAgICAgIHRoaXMuY2FuY2VsU3ludGhlc2lzKHRoaXMucHJpdlN5bnRoZXNpc1R1cm4ucmVxdWVzdElkLCBjYW5jZWxsYXRpb25SZWFzb24sIGVycm9yQ29kZSwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICBwcm9jZXNzVHlwZVNwZWNpZmljTWVzc2FnZXMoY29ubmVjdGlvbk1lc3NhZ2UpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJlY2VpdmVNZXNzYWdlKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0geWllbGQgdGhpcy5mZXRjaENvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlID0geWllbGQgY29ubmVjdGlvbi5yZWFkKCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucmVjZWl2ZU1lc3NhZ2VPdmVycmlkZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlY2VpdmVNZXNzYWdlT3ZlcnJpZGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdklzRGlzcG9zZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UncmUgZG9uZS5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBpbmRpY2F0ZXMgd2UgYXJlIGRyYWluaW5nIHRoZSBxdWV1ZSBhbmQgaXQgY2FtZSB3aXRoIG5vIG1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgaWYgKCFtZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5wcml2U3ludGhlc2lzVHVybi5pc1N5bnRoZXNpemluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVjZWl2ZU1lc3NhZ2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uTWVzc2FnZSA9IFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlLmZyb21Db25uZWN0aW9uTWVzc2FnZShtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbk1lc3NhZ2UucmVxdWVzdElkLnRvTG93ZXJDYXNlKCkgPT09IHRoaXMucHJpdlN5bnRoZXNpc1R1cm4ucmVxdWVzdElkLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChjb25uZWN0aW9uTWVzc2FnZS5wYXRoLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJ0dXJuLnN0YXJ0XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3ludGhlc2lzVHVybi5vblNlcnZpY2VUdXJuU3RhcnRSZXNwb25zZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInJlc3BvbnNlXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3ludGhlc2lzVHVybi5vblNlcnZpY2VSZXNwb25zZU1lc3NhZ2UoY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImF1ZGlvXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdlN5bnRoZXNpc1R1cm4uc3RyZWFtSWQudG9Mb3dlckNhc2UoKSA9PT0gY29ubmVjdGlvbk1lc3NhZ2Uuc3RyZWFtSWQudG9Mb3dlckNhc2UoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiAhIWNvbm5lY3Rpb25NZXNzYWdlLmJpbmFyeUJvZHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3ludGhlc2lzVHVybi5vbkF1ZGlvQ2h1bmtSZWNlaXZlZChjb25uZWN0aW9uTWVzc2FnZS5iaW5hcnlCb2R5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIuc3ludGhlc2l6aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGF1ZGlvV2l0aEhlYWRlciA9IFN5bnRoZXNpc0FkYXB0ZXJCYXNlLmFkZEhlYWRlcihjb25uZWN0aW9uTWVzc2FnZS5iaW5hcnlCb2R5LCB0aGlzLnByaXZTeW50aGVzaXNUdXJuLmF1ZGlvT3V0cHV0Rm9ybWF0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBldiA9IG5ldyBTcGVlY2hTeW50aGVzaXNFdmVudEFyZ3MobmV3IFNwZWVjaFN5bnRoZXNpc1Jlc3VsdCh0aGlzLnByaXZTeW50aGVzaXNUdXJuLnJlcXVlc3RJZCwgUmVzdWx0UmVhc29uLlN5bnRoZXNpemluZ0F1ZGlvLCBhdWRpb1dpdGhIZWFkZXIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplci5zeW50aGVzaXppbmcodGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIsIGV2KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdCBnb2luZyB0byBsZXQgZXJyb3JzIGluIHRoZSBldmVudCBoYW5kbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdlNlc3Npb25BdWRpb0Rlc3RpbmF0aW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlNlc3Npb25BdWRpb0Rlc3RpbmF0aW9uLndyaXRlKGNvbm5lY3Rpb25NZXNzYWdlLmJpbmFyeUJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImF1ZGlvLm1ldGFkYXRhXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWV0YWRhdGFMaXN0ID0gU3ludGhlc2lzQXVkaW9NZXRhZGF0YS5mcm9tSlNPTihjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSkuTWV0YWRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBtZXRhZGF0YSBvZiBtZXRhZGF0YUxpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChtZXRhZGF0YS5UeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1ldGFkYXRhVHlwZS5Xb3JkQm91bmRhcnk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1ldGFkYXRhVHlwZS5TZW50ZW5jZUJvdW5kYXJ5OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlN5bnRoZXNpc1R1cm4ub25UZXh0Qm91bmRhcnlFdmVudChtZXRhZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgd29yZEJvdW5kYXJ5RXZlbnRBcmdzID0gbmV3IFNwZWVjaFN5bnRoZXNpc1dvcmRCb3VuZGFyeUV2ZW50QXJncyhtZXRhZGF0YS5EYXRhLk9mZnNldCwgbWV0YWRhdGEuRGF0YS5EdXJhdGlvbiwgbWV0YWRhdGEuRGF0YS50ZXh0LlRleHQsIG1ldGFkYXRhLkRhdGEudGV4dC5MZW5ndGgsIG1ldGFkYXRhLlR5cGUgPT09IE1ldGFkYXRhVHlwZS5Xb3JkQm91bmRhcnlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB0aGlzLnByaXZTeW50aGVzaXNUdXJuLmN1cnJlbnRUZXh0T2Zmc2V0IDogdGhpcy5wcml2U3ludGhlc2lzVHVybi5jdXJyZW50U2VudGVuY2VPZmZzZXQsIG1ldGFkYXRhLkRhdGEudGV4dC5Cb3VuZGFyeVR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLndvcmRCb3VuZGFyeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIud29yZEJvdW5kYXJ5KHRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLCB3b3JkQm91bmRhcnlFdmVudEFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90IGdvaW5nIHRvIGxldCBlcnJvcnMgaW4gdGhlIGV2ZW50IGhhbmRsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRyaXAgdGhpbmdzIHVwLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBNZXRhZGF0YVR5cGUuQm9va21hcms6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYm9va21hcmtFdmVudEFyZ3MgPSBuZXcgU3BlZWNoU3ludGhlc2lzQm9va21hcmtFdmVudEFyZ3MobWV0YWRhdGEuRGF0YS5PZmZzZXQsIG1ldGFkYXRhLkRhdGEuQm9va21hcmspO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLmJvb2ttYXJrUmVhY2hlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIuYm9va21hcmtSZWFjaGVkKHRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLCBib29rbWFya0V2ZW50QXJncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgZ29pbmcgdG8gbGV0IGVycm9ycyBpbiB0aGUgZXZlbnQgaGFuZGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1ldGFkYXRhVHlwZS5WaXNlbWU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3ludGhlc2lzVHVybi5vblZpc2VtZU1ldGFkYXRhUmVjZWl2ZWQobWV0YWRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZXRhZGF0YS5EYXRhLklzTGFzdEFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2aXNlbWVFdmVudEFyZ3MgPSBuZXcgU3BlZWNoU3ludGhlc2lzVmlzZW1lRXZlbnRBcmdzKG1ldGFkYXRhLkRhdGEuT2Zmc2V0LCBtZXRhZGF0YS5EYXRhLlZpc2VtZUlkLCB0aGlzLnByaXZTeW50aGVzaXNUdXJuLmdldEFuZENsZWFyVmlzZW1lQW5pbWF0aW9uKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplci52aXNlbWVSZWNlaXZlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplci52aXNlbWVSZWNlaXZlZCh0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplciwgdmlzZW1lRXZlbnRBcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdCBnb2luZyB0byBsZXQgZXJyb3JzIGluIHRoZSBldmVudCBoYW5kbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1ldGFkYXRhVHlwZS5TZXNzaW9uRW5kOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlN5bnRoZXNpc1R1cm4ub25TZXNzaW9uRW5kKG1ldGFkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJ0dXJuLmVuZFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlN5bnRoZXNpc1R1cm4ub25TZXJ2aWNlVHVybkVuZFJlc3BvbnNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhdWRpb0J1ZmZlciA9IHlpZWxkIHRoaXMucHJpdlN5bnRoZXNpc1R1cm4uZ2V0QWxsUmVjZWl2ZWRBdWRpb1dpdGhIZWFkZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gbmV3IFNwZWVjaFN5bnRoZXNpc1Jlc3VsdCh0aGlzLnByaXZTeW50aGVzaXNUdXJuLnJlcXVlc3RJZCwgUmVzdWx0UmVhc29uLlN5bnRoZXNpemluZ0F1ZGlvQ29tcGxldGVkLCBhdWRpb0J1ZmZlciwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHRoaXMucHJpdlN5bnRoZXNpc1R1cm4uYXVkaW9EdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkVycm9yQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkVycm9yQ2FsbGJhY2soZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplci5zeW50aGVzaXNDb21wbGV0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLnN5bnRoZXNpc0NvbXBsZXRlZCh0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplciwgbmV3IFNwZWVjaFN5bnRoZXNpc0V2ZW50QXJncyhyZXN1bHQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90IGdvaW5nIHRvIGxldCBlcnJvcnMgaW4gdGhlIGV2ZW50IGhhbmRsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRyaXAgdGhpbmdzIHVwLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucHJvY2Vzc1R5cGVTcGVjaWZpY01lc3NhZ2VzKGNvbm5lY3Rpb25NZXNzYWdlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBoZXJlIGFyZSBzb21lIG1lc3NhZ2VzIHRoYXQgdGhlIGRlcml2ZWQgY2xhc3MgaGFzIG5vdCBwcm9jZXNzZWQsIGRpc3BhdGNoIHRoZW0gdG8gY29ubmVjdCBjbGFzc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZTZXJ2aWNlRXZlbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlcnZpY2VFdmVudHMub25FdmVudChuZXcgU2VydmljZUV2ZW50KGNvbm5lY3Rpb25NZXNzYWdlLnBhdGgudG9Mb3dlckNhc2UoKSwgY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZWNlaXZlTWVzc2FnZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBXaGF0IGdvZXMgaGVyZT9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNlbmRTeW50aGVzaXNDb250ZXh0KGNvbm5lY3Rpb24pIHtcbiAgICAgICAgY29uc3Qgc3ludGhlc2lzQ29udGV4dEpzb24gPSB0aGlzLnN5bnRoZXNpc0NvbnRleHQudG9KU09OKCk7XG4gICAgICAgIGlmIChzeW50aGVzaXNDb250ZXh0SnNvbikge1xuICAgICAgICAgICAgcmV0dXJuIGNvbm5lY3Rpb24uc2VuZChuZXcgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UoTWVzc2FnZVR5cGUuVGV4dCwgXCJzeW50aGVzaXMuY29udGV4dFwiLCB0aGlzLnByaXZTeW50aGVzaXNUdXJuLnJlcXVlc3RJZCwgXCJhcHBsaWNhdGlvbi9qc29uXCIsIHN5bnRoZXNpc0NvbnRleHRKc29uKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25uZWN0SW1wbChpc1VuQXV0aG9yaXplZCA9IGZhbHNlKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZDb25uZWN0aW9uUHJvbWlzZSAhPSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvblByb21pc2UudGhlbigoY29ubmVjdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChjb25uZWN0aW9uLnN0YXRlKCkgPT09IENvbm5lY3Rpb25TdGF0ZS5EaXNjb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbklkID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvblByb21pc2UgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25uZWN0SW1wbCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvblByb21pc2U7XG4gICAgICAgICAgICB9LCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbklkID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uUHJvbWlzZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29ubmVjdEltcGwoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdkF1dGhGZXRjaEV2ZW50SWQgPSBjcmVhdGVOb0Rhc2hHdWlkKCk7XG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25JZCA9IGNyZWF0ZU5vRGFzaEd1aWQoKTtcbiAgICAgICAgdGhpcy5wcml2U3ludGhlc2lzVHVybi5vblByZUNvbm5lY3Rpb25TdGFydCh0aGlzLnByaXZBdXRoRmV0Y2hFdmVudElkKTtcbiAgICAgICAgY29uc3QgYXV0aFByb21pc2UgPSBpc1VuQXV0aG9yaXplZCA/IHRoaXMucHJpdkF1dGhlbnRpY2F0aW9uLmZldGNoT25FeHBpcnkodGhpcy5wcml2QXV0aEZldGNoRXZlbnRJZCkgOiB0aGlzLnByaXZBdXRoZW50aWNhdGlvbi5mZXRjaCh0aGlzLnByaXZBdXRoRmV0Y2hFdmVudElkKTtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvblByb21pc2UgPSBhdXRoUHJvbWlzZS50aGVuKChyZXN1bHQpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlN5bnRoZXNpc1R1cm4ub25BdXRoQ29tcGxldGVkKGZhbHNlKTtcbiAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSB0aGlzLnByaXZDb25uZWN0aW9uRmFjdG9yeS5jcmVhdGUodGhpcy5wcml2U3ludGhlc2l6ZXJDb25maWcsIHJlc3VsdCwgdGhpcy5wcml2Q29ubmVjdGlvbklkKTtcbiAgICAgICAgICAgIC8vIEF0dGFjaCB0byB0aGUgdW5kZXJseWluZyBldmVudC4gTm8gbmVlZCB0byBob2xkIG9udG8gdGhlIGRldGFjaCBwb2ludGVycyBhcyBpbiB0aGUgZXZlbnQgdGhlIGNvbm5lY3Rpb24gZ29lcyBhd2F5LFxuICAgICAgICAgICAgLy8gaXQnbGwgc3RvcCBzZW5kaW5nIGV2ZW50cy5cbiAgICAgICAgICAgIGNvbm5lY3Rpb24uZXZlbnRzLmF0dGFjaCgoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbm5lY3Rpb25FdmVudHMub25FdmVudChldmVudCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0geWllbGQgY29ubmVjdGlvbi5vcGVuKCk7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U3ludGhlc2lzVHVybi5vbkNvbm5lY3Rpb25Fc3RhYmxpc2hDb21wbGV0ZWQocmVzcG9uc2Uuc3RhdHVzQ29kZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShjb25uZWN0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPT09IDQwMyAmJiAhaXNVbkF1dGhvcml6ZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25uZWN0SW1wbCh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlN5bnRoZXNpc1R1cm4ub25Db25uZWN0aW9uRXN0YWJsaXNoQ29tcGxldGVkKHJlc3BvbnNlLnN0YXR1c0NvZGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgVW5hYmxlIHRvIGNvbnRhY3Qgc2VydmVyLiBTdGF0dXNDb2RlOiAke3Jlc3BvbnNlLnN0YXR1c0NvZGV9LCAke3RoaXMucHJpdlN5bnRoZXNpemVyQ29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludCl9IFJlYXNvbjogJHtyZXNwb25zZS5yZWFzb259YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIHRoaXMucHJpdlN5bnRoZXNpc1R1cm4ub25BdXRoQ29tcGxldGVkKHRydWUpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIEF0dGFjaCBhbiBlbXB0eSBoYW5kbGVyIHRvIGFsbG93IHRoZSBwcm9taXNlIHRvIHJ1biBpbiB0aGUgYmFja2dyb3VuZCB3aGlsZVxuICAgICAgICAvLyBvdGhlciBzdGFydHVwIGV2ZW50cyBoYXBwZW4uIEl0J2xsIGV2ZW50dWFsbHkgYmUgYXdhaXRlZCBvbi5cbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvblxuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uUHJvbWlzZS5jYXRjaCgoKSA9PiB7IH0pO1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvblByb21pc2U7XG4gICAgfVxuICAgIHNlbmRTcGVlY2hTZXJ2aWNlQ29uZmlnKGNvbm5lY3Rpb24sIFNwZWVjaFNlcnZpY2VDb25maWdKc29uKSB7XG4gICAgICAgIGlmIChTcGVlY2hTZXJ2aWNlQ29uZmlnSnNvbikge1xuICAgICAgICAgICAgcmV0dXJuIGNvbm5lY3Rpb24uc2VuZChuZXcgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UoTWVzc2FnZVR5cGUuVGV4dCwgXCJzcGVlY2guY29uZmlnXCIsIHRoaXMucHJpdlN5bnRoZXNpc1R1cm4ucmVxdWVzdElkLCBcImFwcGxpY2F0aW9uL2pzb25cIiwgU3BlZWNoU2VydmljZUNvbmZpZ0pzb24pKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZW5kU3NtbE1lc3NhZ2UoY29ubmVjdGlvbiwgc3NtbCwgcmVxdWVzdElkKSB7XG4gICAgICAgIHJldHVybiBjb25uZWN0aW9uLnNlbmQobmV3IFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlKE1lc3NhZ2VUeXBlLlRleHQsIFwic3NtbFwiLCByZXF1ZXN0SWQsIFwiYXBwbGljYXRpb24vc3NtbCt4bWxcIiwgc3NtbCkpO1xuICAgIH1cbiAgICBmZXRjaENvbm5lY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ3VyYXRpb25Qcm9taXNlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ3VyYXRpb25Qcm9taXNlLnRoZW4oKGNvbm5lY3Rpb24pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb24uc3RhdGUoKSA9PT0gQ29ubmVjdGlvblN0YXRlLkRpc2Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbklkID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWd1cmF0aW9uUHJvbWlzZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZldGNoQ29ubmVjdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlndXJhdGlvblByb21pc2U7XG4gICAgICAgICAgICAgICAgfSwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uSWQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlndXJhdGlvblByb21pc2UgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZldGNoQ29ubmVjdGlvbigpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ3VyYXRpb25Qcm9taXNlID0gdGhpcy5jb25maWd1cmVDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICByZXR1cm4geWllbGQgdGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ3VyYXRpb25Qcm9taXNlO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLy8gVGFrZXMgYW4gZXN0YWJsaXNoZWQgd2Vic29ja2V0IGNvbm5lY3Rpb24gdG8gdGhlIGVuZHBvaW50IGFuZCBzZW5kcyBzcGVlY2ggY29uZmlndXJhdGlvbiBpbmZvcm1hdGlvbi5cbiAgICBjb25maWd1cmVDb25uZWN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHlpZWxkIHRoaXMuY29ubmVjdEltcGwoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbmZpZ0Nvbm5lY3Rpb25PdmVycmlkZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uZmlnQ29ubmVjdGlvbk92ZXJyaWRlKGNvbm5lY3Rpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeWllbGQgdGhpcy5zZW5kU3BlZWNoU2VydmljZUNvbmZpZyhjb25uZWN0aW9uLCB0aGlzLnByaXZTeW50aGVzaXplckNvbmZpZy5TcGVlY2hTZXJ2aWNlQ29uZmlnLnNlcmlhbGl6ZSgpKTtcbiAgICAgICAgICAgIHJldHVybiBjb25uZWN0aW9uO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5TeW50aGVzaXNBZGFwdGVyQmFzZS50ZWxlbWV0cnlEYXRhRW5hYmxlZCA9IHRydWU7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVN5bnRoZXNpc0FkYXB0ZXJCYXNlLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBQcm9wZXJ0eUlkIH0gZnJvbSBcIi4uL3Nkay9FeHBvcnRzXCI7XG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIEpTT04gdXNlZCBpbiB0aGUgc3ludGhlc2lzLmNvbnRleHQgbWVzc2FnZSBzZW50IHRvIHRoZSBzcGVlY2ggc2VydmljZS5cbiAqIFRoZSBkeW5hbWljIGdyYW1tYXIgaXMgYWx3YXlzIHJlZnJlc2hlZCBmcm9tIHRoZSBlbmNhcHN1bGF0ZWQgZHluYW1pYyBncmFtbWFyIG9iamVjdC5cbiAqL1xuZXhwb3J0IGNsYXNzIFN5bnRoZXNpc0NvbnRleHQge1xuICAgIGNvbnN0cnVjdG9yKHNwZWVjaFN5bnRoZXNpemVyKSB7XG4gICAgICAgIHRoaXMucHJpdkNvbnRleHQgPSB7fTtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIgPSBzcGVlY2hTeW50aGVzaXplcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhIHNlY3Rpb24gdG8gdGhlIHN5bnRoZXNpcy5jb250ZXh0IG9iamVjdC5cbiAgICAgKiBAcGFyYW0gc2VjdGlvbk5hbWUgTmFtZSBvZiB0aGUgc2VjdGlvbiB0byBhZGQuXG4gICAgICogQHBhcmFtIHZhbHVlIEpTT04gc2VyaWFsaXphYmxlIG9iamVjdCB0aGF0IHJlcHJlc2VudHMgdGhlIHZhbHVlLlxuICAgICAqL1xuICAgIHNldFNlY3Rpb24oc2VjdGlvbk5hbWUsIHZhbHVlKSB7XG4gICAgICAgIHRoaXMucHJpdkNvbnRleHRbc2VjdGlvbk5hbWVdID0gdmFsdWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIGF1ZGlvIG91dHB1dCBmb3JtYXQgZm9yIHN5bnRoZXNpcyBjb250ZXh0IGdlbmVyYXRpb24uXG4gICAgICogQHBhcmFtIGZvcm1hdCB7QXVkaW9PdXRwdXRGb3JtYXRJbXBsfSB0aGUgb3V0cHV0IGZvcm1hdFxuICAgICAqL1xuICAgIHNldCBhdWRpb091dHB1dEZvcm1hdChmb3JtYXQpIHtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9PdXRwdXRGb3JtYXQgPSBmb3JtYXQ7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3Qgc3ludGhlc2lzU2VjdGlvbiA9IHRoaXMuYnVpbGRTeW50aGVzaXNDb250ZXh0KCk7XG4gICAgICAgIHRoaXMuc2V0U2VjdGlvbihcInN5bnRoZXNpc1wiLCBzeW50aGVzaXNTZWN0aW9uKTtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMucHJpdkNvbnRleHQpO1xuICAgIH1cbiAgICBidWlsZFN5bnRoZXNpc0NvbnRleHQoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhdWRpbzoge1xuICAgICAgICAgICAgICAgIG1ldGFkYXRhT3B0aW9uczoge1xuICAgICAgICAgICAgICAgICAgICBib29rbWFya0VuYWJsZWQ6ICghIXRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLmJvb2ttYXJrUmVhY2hlZCksXG4gICAgICAgICAgICAgICAgICAgIHB1bmN0dWF0aW9uQm91bmRhcnlFbmFibGVkOiB0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplci5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZVJlc3BvbnNlX1JlcXVlc3RQdW5jdHVhdGlvbkJvdW5kYXJ5LCAoISF0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplci53b3JkQm91bmRhcnkpKSxcbiAgICAgICAgICAgICAgICAgICAgc2VudGVuY2VCb3VuZGFyeUVuYWJsZWQ6IHRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUmVxdWVzdFNlbnRlbmNlQm91bmRhcnksIGZhbHNlKSxcbiAgICAgICAgICAgICAgICAgICAgc2Vzc2lvbkVuZEVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHZpc2VtZUVuYWJsZWQ6ICghIXRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLnZpc2VtZVJlY2VpdmVkKSxcbiAgICAgICAgICAgICAgICAgICAgd29yZEJvdW5kYXJ5RW5hYmxlZDogdGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9SZXF1ZXN0V29yZEJvdW5kYXJ5LCAoISF0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplci53b3JkQm91bmRhcnkpKSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG91dHB1dEZvcm1hdDogdGhpcy5wcml2QXVkaW9PdXRwdXRGb3JtYXQucmVxdWVzdEF1ZGlvRm9ybWF0U3RyaW5nLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxhbmd1YWdlOiB7XG4gICAgICAgICAgICAgICAgYXV0b0RldGVjdGlvbjogdGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIuYXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TeW50aGVzaXNDb250ZXh0LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKiBlc2xpbnQtZGlzYWJsZSBtYXgtY2xhc3Nlcy1wZXItZmlsZSAqL1xuaW1wb3J0IHsgRXZlbnRUeXBlLCBQbGF0Zm9ybUV2ZW50IH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5leHBvcnQgY2xhc3MgU3BlZWNoU3ludGhlc2lzRXZlbnQgZXh0ZW5kcyBQbGF0Zm9ybUV2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihldmVudE5hbWUsIHJlcXVlc3RJZCwgZXZlbnRUeXBlID0gRXZlbnRUeXBlLkluZm8pIHtcbiAgICAgICAgc3VwZXIoZXZlbnROYW1lLCBldmVudFR5cGUpO1xuICAgICAgICB0aGlzLnByaXZSZXF1ZXN0SWQgPSByZXF1ZXN0SWQ7XG4gICAgfVxuICAgIGdldCByZXF1ZXN0SWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZXF1ZXN0SWQ7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFN5bnRoZXNpc1RyaWdnZXJlZEV2ZW50IGV4dGVuZHMgU3BlZWNoU3ludGhlc2lzRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKHJlcXVlc3RJZCwgc2Vzc2lvbkF1ZGlvRGVzdGluYXRpb25JZCwgdHVybkF1ZGlvRGVzdGluYXRpb25JZCkge1xuICAgICAgICBzdXBlcihcIlN5bnRoZXNpc1RyaWdnZXJlZEV2ZW50XCIsIHJlcXVlc3RJZCk7XG4gICAgICAgIHRoaXMucHJpdlNlc3Npb25BdWRpb0Rlc3RpbmF0aW9uSWQgPSBzZXNzaW9uQXVkaW9EZXN0aW5hdGlvbklkO1xuICAgICAgICB0aGlzLnByaXZUdXJuQXVkaW9EZXN0aW5hdGlvbklkID0gdHVybkF1ZGlvRGVzdGluYXRpb25JZDtcbiAgICB9XG4gICAgZ2V0IGF1ZGlvU2Vzc2lvbkRlc3RpbmF0aW9uSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTZXNzaW9uQXVkaW9EZXN0aW5hdGlvbklkO1xuICAgIH1cbiAgICBnZXQgYXVkaW9UdXJuRGVzdGluYXRpb25JZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlR1cm5BdWRpb0Rlc3RpbmF0aW9uSWQ7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIENvbm5lY3RpbmdUb1N5bnRoZXNpc1NlcnZpY2VFdmVudCBleHRlbmRzIFNwZWVjaFN5bnRoZXNpc0V2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihyZXF1ZXN0SWQsIGF1dGhGZXRjaEV2ZW50SWQpIHtcbiAgICAgICAgc3VwZXIoXCJDb25uZWN0aW5nVG9TeW50aGVzaXNTZXJ2aWNlRXZlbnRcIiwgcmVxdWVzdElkKTtcbiAgICAgICAgdGhpcy5wcml2QXV0aEZldGNoRXZlbnRJZCA9IGF1dGhGZXRjaEV2ZW50SWQ7XG4gICAgfVxuICAgIGdldCBhdXRoRmV0Y2hFdmVudElkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXV0aEZldGNoRXZlbnRJZDtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgU3ludGhlc2lzU3RhcnRlZEV2ZW50IGV4dGVuZHMgU3BlZWNoU3ludGhlc2lzRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKHJlcXVlc3RJZCwgYXV0aEZldGNoRXZlbnRJZCkge1xuICAgICAgICBzdXBlcihcIlN5bnRoZXNpc1N0YXJ0ZWRFdmVudFwiLCByZXF1ZXN0SWQpO1xuICAgICAgICB0aGlzLnByaXZBdXRoRmV0Y2hFdmVudElkID0gYXV0aEZldGNoRXZlbnRJZDtcbiAgICB9XG4gICAgZ2V0IGF1dGhGZXRjaEV2ZW50SWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdXRoRmV0Y2hFdmVudElkO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3ludGhlc2lzRXZlbnRzLmpzLm1hcFxuIiwiaW1wb3J0IHsgUmVzdENvbmZpZ0Jhc2UsIFJlc3RNZXNzYWdlQWRhcHRlciwgUmVzdFJlcXVlc3RUeXBlLCB9IGZyb20gXCIuLi9jb21tb24uYnJvd3Nlci9FeHBvcnRzXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eUlkLCB9IGZyb20gXCIuLi9zZGsvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29ubmVjdGlvbkZhY3RvcnlCYXNlIH0gZnJvbSBcIi4vQ29ubmVjdGlvbkZhY3RvcnlCYXNlXCI7XG5pbXBvcnQgeyBIZWFkZXJOYW1lcyB9IGZyb20gXCIuL0hlYWRlck5hbWVzXCI7XG4vKipcbiAqIEltcGxlbWVudHMgbWV0aG9kcyBmb3Igc3BlYWtlciByZWNvZ25pdGlvbiBjbGFzc2VzLCBzZW5kaW5nIHJlcXVlc3RzIHRvIGVuZHBvaW50XG4gKiBhbmQgcGFyc2luZyByZXNwb25zZSBpbnRvIGV4cGVjdGVkIGZvcm1hdFxuICogQGNsYXNzIFN5bnRoZXNpc1Jlc3RBZGFwdGVyXG4gKi9cbmV4cG9ydCBjbGFzcyBTeW50aGVzaXNSZXN0QWRhcHRlciB7XG4gICAgY29uc3RydWN0b3IoY29uZmlnLCBhdXRoZW50aWNhdGlvbikge1xuICAgICAgICBsZXQgZW5kcG9pbnQgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50LCB1bmRlZmluZWQpO1xuICAgICAgICBpZiAoIWVuZHBvaW50KSB7XG4gICAgICAgICAgICBjb25zdCByZWdpb24gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlZ2lvbiwgXCJ3ZXN0dXNcIik7XG4gICAgICAgICAgICBjb25zdCBob3N0U3VmZml4ID0gQ29ubmVjdGlvbkZhY3RvcnlCYXNlLmdldEhvc3RTdWZmaXgocmVnaW9uKTtcbiAgICAgICAgICAgIGVuZHBvaW50ID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Ib3N0LCBgaHR0cHM6Ly8ke3JlZ2lvbn0udHRzLnNwZWVjaCR7aG9zdFN1ZmZpeH1gKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZVcmkgPSBgJHtlbmRwb2ludH0vY29nbml0aXZlc2VydmljZXMvdm9pY2VzL2xpc3RgO1xuICAgICAgICBjb25zdCBvcHRpb25zID0gUmVzdENvbmZpZ0Jhc2UucmVxdWVzdE9wdGlvbnM7XG4gICAgICAgIHRoaXMucHJpdlJlc3RBZGFwdGVyID0gbmV3IFJlc3RNZXNzYWdlQWRhcHRlcihvcHRpb25zKTtcbiAgICAgICAgdGhpcy5wcml2QXV0aGVudGljYXRpb24gPSBhdXRoZW50aWNhdGlvbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgbGlzdCB2b2ljZXMgcmVxdWVzdCB0byBlbmRwb2ludC5cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIGNvbm5lY3Rpb25JZCAtIGd1aWQgZm9yIGNvbm5lY3Rpb25JZFxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPElSZXN0UmVzcG9uc2U+fSByZXN0IHJlc3BvbnNlIHRvIHN0YXR1cyByZXF1ZXN0XG4gICAgICovXG4gICAgZ2V0Vm9pY2VzTGlzdChjb25uZWN0aW9uSWQpIHtcbiAgICAgICAgdGhpcy5wcml2UmVzdEFkYXB0ZXIuc2V0SGVhZGVycyhIZWFkZXJOYW1lcy5Db25uZWN0aW9uSWQsIGNvbm5lY3Rpb25JZCk7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdXRoZW50aWNhdGlvbi5mZXRjaChjb25uZWN0aW9uSWQpLnRoZW4oKGF1dGhJbmZvKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnByaXZSZXN0QWRhcHRlci5zZXRIZWFkZXJzKGF1dGhJbmZvLmhlYWRlck5hbWUsIGF1dGhJbmZvLnRva2VuKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZSZXN0QWRhcHRlci5yZXF1ZXN0KFJlc3RSZXF1ZXN0VHlwZS5HZXQsIHRoaXMucHJpdlVyaSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3ludGhlc2lzUmVzdEFkYXB0ZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgY3JlYXRlTm9EYXNoR3VpZCwgRGVmZXJyZWQsIEV2ZW50cyB9IGZyb20gXCIuLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgUHVsbEF1ZGlvT3V0cHV0U3RyZWFtSW1wbCB9IGZyb20gXCIuLi9zZGsvQXVkaW8vQXVkaW9PdXRwdXRTdHJlYW1cIjtcbmltcG9ydCB7IE1ldGFkYXRhVHlwZSB9IGZyb20gXCIuL1NlcnZpY2VNZXNzYWdlcy9TeW50aGVzaXNBdWRpb01ldGFkYXRhXCI7XG5pbXBvcnQgeyBTeW50aGVzaXNBZGFwdGVyQmFzZSB9IGZyb20gXCIuL1N5bnRoZXNpc0FkYXB0ZXJCYXNlXCI7XG5pbXBvcnQgeyBDb25uZWN0aW5nVG9TeW50aGVzaXNTZXJ2aWNlRXZlbnQsIFN5bnRoZXNpc1N0YXJ0ZWRFdmVudCwgU3ludGhlc2lzVHJpZ2dlcmVkRXZlbnQsIH0gZnJvbSBcIi4vU3ludGhlc2lzRXZlbnRzXCI7XG5leHBvcnQgY2xhc3MgU3ludGhlc2lzVHVybiB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMucHJpdklzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2SXNTeW50aGVzaXppbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2SXNTeW50aGVzaXNFbmRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZCeXRlc1JlY2VpdmVkID0gMDtcbiAgICAgICAgdGhpcy5wcml2SW5UdXJuID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdlRleHRPZmZzZXQgPSAwO1xuICAgICAgICB0aGlzLnByaXZOZXh0U2VhcmNoVGV4dEluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5wcml2U2VudGVuY2VPZmZzZXQgPSAwO1xuICAgICAgICB0aGlzLnByaXZOZXh0U2VhcmNoU2VudGVuY2VJbmRleCA9IDA7XG4gICAgICAgIHRoaXMucHJpdlJlcXVlc3RJZCA9IGNyZWF0ZU5vRGFzaEd1aWQoKTtcbiAgICAgICAgdGhpcy5wcml2VHVybkRlZmVycmFsID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgIC8vIFdlJ3JlIG5vdCBpbiBhIHR1cm4sIHNvIHJlc29sdmUuXG4gICAgICAgIHRoaXMucHJpdlR1cm5EZWZlcnJhbC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldCByZXF1ZXN0SWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZXF1ZXN0SWQ7XG4gICAgfVxuICAgIGdldCBzdHJlYW1JZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlN0cmVhbUlkO1xuICAgIH1cbiAgICBzZXQgc3RyZWFtSWQodmFsdWUpIHtcbiAgICAgICAgdGhpcy5wcml2U3RyZWFtSWQgPSB2YWx1ZTtcbiAgICB9XG4gICAgZ2V0IGF1ZGlvT3V0cHV0Rm9ybWF0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXVkaW9PdXRwdXRGb3JtYXQ7XG4gICAgfVxuICAgIHNldCBhdWRpb091dHB1dEZvcm1hdChmb3JtYXQpIHtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9PdXRwdXRGb3JtYXQgPSBmb3JtYXQ7XG4gICAgfVxuICAgIGdldCB0dXJuQ29tcGxldGlvblByb21pc2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUdXJuRGVmZXJyYWwucHJvbWlzZTtcbiAgICB9XG4gICAgZ2V0IGlzU3ludGhlc2lzRW5kZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJc1N5bnRoZXNpc0VuZGVkO1xuICAgIH1cbiAgICBnZXQgaXNTeW50aGVzaXppbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJc1N5bnRoZXNpemluZztcbiAgICB9XG4gICAgZ2V0IGN1cnJlbnRUZXh0T2Zmc2V0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VGV4dE9mZnNldDtcbiAgICB9XG4gICAgZ2V0IGN1cnJlbnRTZW50ZW5jZU9mZnNldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNlbnRlbmNlT2Zmc2V0O1xuICAgIH1cbiAgICAvLyBUaGUgbnVtYmVyIG9mIGJ5dGVzIHJlY2VpdmVkIGZvciBjdXJyZW50IHR1cm5cbiAgICBnZXQgYnl0ZXNSZWNlaXZlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkJ5dGVzUmVjZWl2ZWQ7XG4gICAgfVxuICAgIGdldCBhdWRpb0R1cmF0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXVkaW9EdXJhdGlvbjtcbiAgICB9XG4gICAgZ2V0QWxsUmVjZWl2ZWRBdWRpbygpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlJlY2VpdmVkQXVkaW8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMucHJpdlJlY2VpdmVkQXVkaW8pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZJc1N5bnRoZXNpc0VuZGVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnJlYWRBbGxBdWRpb0Zyb21TdHJlYW0oKTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5wcml2UmVjZWl2ZWRBdWRpbyk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXRBbGxSZWNlaXZlZEF1ZGlvV2l0aEhlYWRlcigpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlJlY2VpdmVkQXVkaW9XaXRoSGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlY2VpdmVkQXVkaW9XaXRoSGVhZGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZJc1N5bnRoZXNpc0VuZGVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5hdWRpb091dHB1dEZvcm1hdC5oYXNIZWFkZXIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBhdWRpbyA9IHlpZWxkIHRoaXMuZ2V0QWxsUmVjZWl2ZWRBdWRpbygpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlY2VpdmVkQXVkaW9XaXRoSGVhZGVyID0gU3ludGhlc2lzQWRhcHRlckJhc2UuYWRkSGVhZGVyKGF1ZGlvLCB0aGlzLmF1ZGlvT3V0cHV0Rm9ybWF0KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVjZWl2ZWRBdWRpb1dpdGhIZWFkZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRBbGxSZWNlaXZlZEF1ZGlvKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzdGFydE5ld1N5bnRoZXNpcyhyZXF1ZXN0SWQsIHJhd1RleHQsIGlzU1NNTCwgYXVkaW9EZXN0aW5hdGlvbikge1xuICAgICAgICB0aGlzLnByaXZJc1N5bnRoZXNpc0VuZGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdklzU3ludGhlc2l6aW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5wcml2UmVxdWVzdElkID0gcmVxdWVzdElkO1xuICAgICAgICB0aGlzLnByaXZSYXdUZXh0ID0gcmF3VGV4dDtcbiAgICAgICAgdGhpcy5wcml2SXNTU01MID0gaXNTU01MO1xuICAgICAgICB0aGlzLnByaXZBdWRpb091dHB1dFN0cmVhbSA9IG5ldyBQdWxsQXVkaW9PdXRwdXRTdHJlYW1JbXBsKCk7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvT3V0cHV0U3RyZWFtLmZvcm1hdCA9IHRoaXMucHJpdkF1ZGlvT3V0cHV0Rm9ybWF0O1xuICAgICAgICB0aGlzLnByaXZSZWNlaXZlZEF1ZGlvID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcml2UmVjZWl2ZWRBdWRpb1dpdGhIZWFkZXIgPSBudWxsO1xuICAgICAgICB0aGlzLnByaXZCeXRlc1JlY2VpdmVkID0gMDtcbiAgICAgICAgdGhpcy5wcml2VGV4dE9mZnNldCA9IDA7XG4gICAgICAgIHRoaXMucHJpdk5leHRTZWFyY2hUZXh0SW5kZXggPSAwO1xuICAgICAgICB0aGlzLnByaXZTZW50ZW5jZU9mZnNldCA9IDA7XG4gICAgICAgIHRoaXMucHJpdk5leHRTZWFyY2hTZW50ZW5jZUluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5wcml2UGFydGlhbFZpc2VtZUFuaW1hdGlvbiA9IFwiXCI7XG4gICAgICAgIGlmIChhdWRpb0Rlc3RpbmF0aW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlR1cm5BdWRpb0Rlc3RpbmF0aW9uID0gYXVkaW9EZXN0aW5hdGlvbjtcbiAgICAgICAgICAgIHRoaXMucHJpdlR1cm5BdWRpb0Rlc3RpbmF0aW9uLmZvcm1hdCA9IHRoaXMucHJpdkF1ZGlvT3V0cHV0Rm9ybWF0O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMub25FdmVudChuZXcgU3ludGhlc2lzVHJpZ2dlcmVkRXZlbnQodGhpcy5yZXF1ZXN0SWQsIHVuZGVmaW5lZCwgYXVkaW9EZXN0aW5hdGlvbiA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogYXVkaW9EZXN0aW5hdGlvbi5pZCgpKSk7XG4gICAgfVxuICAgIG9uUHJlQ29ubmVjdGlvblN0YXJ0KGF1dGhGZXRjaEV2ZW50SWQpIHtcbiAgICAgICAgdGhpcy5wcml2QXV0aEZldGNoRXZlbnRJZCA9IGF1dGhGZXRjaEV2ZW50SWQ7XG4gICAgICAgIHRoaXMub25FdmVudChuZXcgQ29ubmVjdGluZ1RvU3ludGhlc2lzU2VydmljZUV2ZW50KHRoaXMucHJpdlJlcXVlc3RJZCwgdGhpcy5wcml2QXV0aEZldGNoRXZlbnRJZCkpO1xuICAgIH1cbiAgICBvbkF1dGhDb21wbGV0ZWQoaXNFcnJvcikge1xuICAgICAgICBpZiAoaXNFcnJvcikge1xuICAgICAgICAgICAgdGhpcy5vbkNvbXBsZXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25Db25uZWN0aW9uRXN0YWJsaXNoQ29tcGxldGVkKHN0YXR1c0NvZGUpIHtcbiAgICAgICAgaWYgKHN0YXR1c0NvZGUgPT09IDIwMCkge1xuICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBTeW50aGVzaXNTdGFydGVkRXZlbnQodGhpcy5yZXF1ZXN0SWQsIHRoaXMucHJpdkF1dGhGZXRjaEV2ZW50SWQpKTtcbiAgICAgICAgICAgIHRoaXMucHJpdkJ5dGVzUmVjZWl2ZWQgPSAwO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHN0YXR1c0NvZGUgPT09IDQwMykge1xuICAgICAgICAgICAgdGhpcy5vbkNvbXBsZXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25TZXJ2aWNlUmVzcG9uc2VNZXNzYWdlKHJlc3BvbnNlSnNvbikge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IEpTT04ucGFyc2UocmVzcG9uc2VKc29uKTtcbiAgICAgICAgdGhpcy5zdHJlYW1JZCA9IHJlc3BvbnNlLmF1ZGlvLnN0cmVhbUlkO1xuICAgIH1cbiAgICBvblNlcnZpY2VUdXJuRW5kUmVzcG9uc2UoKSB7XG4gICAgICAgIHRoaXMucHJpdkluVHVybiA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZUdXJuRGVmZXJyYWwucmVzb2x2ZSgpO1xuICAgICAgICB0aGlzLm9uQ29tcGxldGUoKTtcbiAgICB9XG4gICAgb25TZXJ2aWNlVHVyblN0YXJ0UmVzcG9uc2UoKSB7XG4gICAgICAgIGlmICghIXRoaXMucHJpdlR1cm5EZWZlcnJhbCAmJiAhIXRoaXMucHJpdkluVHVybikge1xuICAgICAgICAgICAgLy8gV2hhdD8gSG93IGFyZSB3ZSBzdGFydGluZyBhIHR1cm4gd2l0aCBhbm90aGVyIG5vdCBkb25lP1xuICAgICAgICAgICAgdGhpcy5wcml2VHVybkRlZmVycmFsLnJlamVjdChcIkFub3RoZXIgdHVybiBzdGFydGVkIGJlZm9yZSBjdXJyZW50IGNvbXBsZXRlZC5cIik7XG4gICAgICAgICAgICAvLyBBdm9pZCBVbmhhbmRsZWRQcm9taXNlUmVqZWN0aW9uIGlmIHByaXZUdXJuRGVmZXJyYWwgaXMgbm90IGJlaW5nIGF3YWl0ZWRcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb25cbiAgICAgICAgICAgIHRoaXMucHJpdlR1cm5EZWZlcnJhbC5wcm9taXNlLnRoZW4oKS5jYXRjaCgoKSA9PiB7IH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdkluVHVybiA9IHRydWU7XG4gICAgICAgIHRoaXMucHJpdlR1cm5EZWZlcnJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgIH1cbiAgICBvbkF1ZGlvQ2h1bmtSZWNlaXZlZChkYXRhKSB7XG4gICAgICAgIGlmICh0aGlzLmlzU3ludGhlc2l6aW5nKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZBdWRpb091dHB1dFN0cmVhbS53cml0ZShkYXRhKTtcbiAgICAgICAgICAgIHRoaXMucHJpdkJ5dGVzUmVjZWl2ZWQgKz0gZGF0YS5ieXRlTGVuZ3RoO1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdlR1cm5BdWRpb0Rlc3RpbmF0aW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZUdXJuQXVkaW9EZXN0aW5hdGlvbi53cml0ZShkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBvblRleHRCb3VuZGFyeUV2ZW50KG1ldGFkYXRhKSB7XG4gICAgICAgIHRoaXMudXBkYXRlVGV4dE9mZnNldChtZXRhZGF0YS5EYXRhLnRleHQuVGV4dCwgbWV0YWRhdGEuVHlwZSk7XG4gICAgfVxuICAgIG9uVmlzZW1lTWV0YWRhdGFSZWNlaXZlZChtZXRhZGF0YSkge1xuICAgICAgICBpZiAobWV0YWRhdGEuRGF0YS5BbmltYXRpb25DaHVuayAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZQYXJ0aWFsVmlzZW1lQW5pbWF0aW9uICs9IG1ldGFkYXRhLkRhdGEuQW5pbWF0aW9uQ2h1bms7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25TZXNzaW9uRW5kKG1ldGFkYXRhKSB7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvRHVyYXRpb24gPSBtZXRhZGF0YS5EYXRhLk9mZnNldDtcbiAgICB9XG4gICAgZGlzcG9zZSgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnByaXZJc0Rpc3Bvc2VkKSB7XG4gICAgICAgICAgICAvLyB3ZSBzaG91bGQgaGF2ZSBjb21wbGV0ZWQgYnkgbm93LiBJZiB3ZSBkaWQgbm90IGl0cyBhbiB1bmtub3duIGVycm9yLlxuICAgICAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25TdG9wU3ludGhlc2l6aW5nKCkge1xuICAgICAgICB0aGlzLm9uQ29tcGxldGUoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgdmlzZW1lIGFuaW1hdGlvbiBzdHJpbmcgKG1lcmdlZCBmcm9tIGFuaW1hdGlvbiBjaHVuayksIGFuZCBjbGVhcnMgdGhlIGludGVybmFsXG4gICAgICogcGFydGlhbCBhbmltYXRpb24uXG4gICAgICovXG4gICAgZ2V0QW5kQ2xlYXJWaXNlbWVBbmltYXRpb24oKSB7XG4gICAgICAgIGNvbnN0IGFuaW1hdGlvbiA9IHRoaXMucHJpdlBhcnRpYWxWaXNlbWVBbmltYXRpb247XG4gICAgICAgIHRoaXMucHJpdlBhcnRpYWxWaXNlbWVBbmltYXRpb24gPSBcIlwiO1xuICAgICAgICByZXR1cm4gYW5pbWF0aW9uO1xuICAgIH1cbiAgICBvbkV2ZW50KGV2ZW50KSB7XG4gICAgICAgIEV2ZW50cy5pbnN0YW5jZS5vbkV2ZW50KGV2ZW50KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgdGhlIHRleHQgaXMgYW4gWE1MKFNTTUwpIHRhZ1xuICAgICAqIEBwYXJhbSB0ZXh0XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBzdGF0aWMgaXNYbWxUYWcodGV4dCkge1xuICAgICAgICByZXR1cm4gdGV4dC5sZW5ndGggPj0gMiAmJiB0ZXh0WzBdID09PSBcIjxcIiAmJiB0ZXh0W3RleHQubGVuZ3RoIC0gMV0gPT09IFwiPlwiO1xuICAgIH1cbiAgICB1cGRhdGVUZXh0T2Zmc2V0KHRleHQsIHR5cGUpIHtcbiAgICAgICAgaWYgKHR5cGUgPT09IE1ldGFkYXRhVHlwZS5Xb3JkQm91bmRhcnkpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlRleHRPZmZzZXQgPSB0aGlzLnByaXZSYXdUZXh0LmluZGV4T2YodGV4dCwgdGhpcy5wcml2TmV4dFNlYXJjaFRleHRJbmRleCk7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2VGV4dE9mZnNldCA+PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2TmV4dFNlYXJjaFRleHRJbmRleCA9IHRoaXMucHJpdlRleHRPZmZzZXQgKyB0ZXh0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2SXNTU01MKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLndpdGhpblhtbFRhZyh0aGlzLnByaXZUZXh0T2Zmc2V0KSAmJiAhU3ludGhlc2lzVHVybi5pc1htbFRhZyh0ZXh0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVUZXh0T2Zmc2V0KHRleHQsIHR5cGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wcml2U2VudGVuY2VPZmZzZXQgPSB0aGlzLnByaXZSYXdUZXh0LmluZGV4T2YodGV4dCwgdGhpcy5wcml2TmV4dFNlYXJjaFNlbnRlbmNlSW5kZXgpO1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdlNlbnRlbmNlT2Zmc2V0ID49IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZOZXh0U2VhcmNoU2VudGVuY2VJbmRleCA9IHRoaXMucHJpdlNlbnRlbmNlT2Zmc2V0ICsgdGV4dC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdklzU1NNTCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy53aXRoaW5YbWxUYWcodGhpcy5wcml2U2VudGVuY2VPZmZzZXQpICYmICFTeW50aGVzaXNUdXJuLmlzWG1sVGFnKHRleHQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRleHRPZmZzZXQodGV4dCwgdHlwZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25Db21wbGV0ZSgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdklzU3ludGhlc2l6aW5nKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZJc1N5bnRoZXNpemluZyA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5wcml2SXNTeW50aGVzaXNFbmRlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnByaXZBdWRpb091dHB1dFN0cmVhbS5jbG9zZSgpO1xuICAgICAgICAgICAgdGhpcy5wcml2SW5UdXJuID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2VHVybkF1ZGlvRGVzdGluYXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlR1cm5BdWRpb0Rlc3RpbmF0aW9uLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2VHVybkF1ZGlvRGVzdGluYXRpb24gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVhZEFsbEF1ZGlvRnJvbVN0cmVhbSgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZJc1N5bnRoZXNpc0VuZGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVjZWl2ZWRBdWRpbyA9IG5ldyBBcnJheUJ1ZmZlcih0aGlzLmJ5dGVzUmVjZWl2ZWQpO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdkF1ZGlvT3V0cHV0U3RyZWFtLnJlYWQodGhpcy5wcml2UmVjZWl2ZWRBdWRpbyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlY2VpdmVkQXVkaW8gPSBuZXcgQXJyYXlCdWZmZXIoMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgY3VycmVudCBpZHggaXMgaW4gWE1MKFNTTUwpIHRhZ1xuICAgICAqIEBwYXJhbSBpZHhcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHdpdGhpblhtbFRhZyhpZHgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJhd1RleHQuaW5kZXhPZihcIjxcIiwgaWR4ICsgMSkgPiB0aGlzLnByaXZSYXdUZXh0LmluZGV4T2YoXCI+XCIsIGlkeCArIDEpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3ludGhlc2lzVHVybi5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgQ29udGV4dCwgU3BlZWNoU2VydmljZUNvbmZpZyB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbmV4cG9ydCB2YXIgU3ludGhlc2lzU2VydmljZVR5cGU7XG4oZnVuY3Rpb24gKFN5bnRoZXNpc1NlcnZpY2VUeXBlKSB7XG4gICAgU3ludGhlc2lzU2VydmljZVR5cGVbU3ludGhlc2lzU2VydmljZVR5cGVbXCJTdGFuZGFyZFwiXSA9IDBdID0gXCJTdGFuZGFyZFwiO1xuICAgIFN5bnRoZXNpc1NlcnZpY2VUeXBlW1N5bnRoZXNpc1NlcnZpY2VUeXBlW1wiQ3VzdG9tXCJdID0gMV0gPSBcIkN1c3RvbVwiO1xufSkoU3ludGhlc2lzU2VydmljZVR5cGUgfHwgKFN5bnRoZXNpc1NlcnZpY2VUeXBlID0ge30pKTtcbmV4cG9ydCBjbGFzcyBTeW50aGVzaXplckNvbmZpZyB7XG4gICAgY29uc3RydWN0b3Ioc3BlZWNoU2VydmljZUNvbmZpZywgcGFyYW1ldGVycykge1xuICAgICAgICB0aGlzLnByaXZTeW50aGVzaXNTZXJ2aWNlVHlwZSA9IFN5bnRoZXNpc1NlcnZpY2VUeXBlLlN0YW5kYXJkO1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hTZXJ2aWNlQ29uZmlnID0gc3BlZWNoU2VydmljZUNvbmZpZyA/IHNwZWVjaFNlcnZpY2VDb25maWcgOiBuZXcgU3BlZWNoU2VydmljZUNvbmZpZyhuZXcgQ29udGV4dChudWxsKSk7XG4gICAgICAgIHRoaXMucHJpdlBhcmFtZXRlcnMgPSBwYXJhbWV0ZXJzO1xuICAgIH1cbiAgICBnZXQgcGFyYW1ldGVycygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhcmFtZXRlcnM7XG4gICAgfVxuICAgIGdldCBzeW50aGVzaXNTZXJ2aWNlVHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlN5bnRoZXNpc1NlcnZpY2VUeXBlO1xuICAgIH1cbiAgICBzZXQgc3ludGhlc2lzU2VydmljZVR5cGUodmFsdWUpIHtcbiAgICAgICAgdGhpcy5wcml2U3ludGhlc2lzU2VydmljZVR5cGUgPSB2YWx1ZTtcbiAgICB9XG4gICAgZ2V0IFNwZWVjaFNlcnZpY2VDb25maWcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hTZXJ2aWNlQ29uZmlnO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3ludGhlc2l6ZXJDb25maWcuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFByb3h5SW5mbywgV2Vic29ja2V0Q29ubmVjdGlvbiwgfSBmcm9tIFwiLi4vY29tbW9uLmJyb3dzZXIvRXhwb3J0c1wiO1xuaW1wb3J0IHsgT3V0cHV0Rm9ybWF0LCBQcm9wZXJ0eUlkIH0gZnJvbSBcIi4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb25uZWN0aW9uRmFjdG9yeUJhc2UgfSBmcm9tIFwiLi9Db25uZWN0aW9uRmFjdG9yeUJhc2VcIjtcbmltcG9ydCB7IE91dHB1dEZvcm1hdFByb3BlcnR5TmFtZSwgV2Vic29ja2V0TWVzc2FnZUZvcm1hdHRlciB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbmltcG9ydCB7IEhlYWRlck5hbWVzIH0gZnJvbSBcIi4vSGVhZGVyTmFtZXNcIjtcbmltcG9ydCB7IFF1ZXJ5UGFyYW1ldGVyTmFtZXMgfSBmcm9tIFwiLi9RdWVyeVBhcmFtZXRlck5hbWVzXCI7XG5leHBvcnQgY2xhc3MgVHJhbnNjcmliZXJDb25uZWN0aW9uRmFjdG9yeSBleHRlbmRzIENvbm5lY3Rpb25GYWN0b3J5QmFzZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKC4uLmFyZ3VtZW50cyk7XG4gICAgICAgIHRoaXMubXVsdGlhdWRpb1JlbGF0aXZlVXJpID0gXCIvc3BlZWNoL3JlY29nbml0aW9uL211bHRpYXVkaW9cIjtcbiAgICB9XG4gICAgY3JlYXRlKGNvbmZpZywgYXV0aEluZm8sIGNvbm5lY3Rpb25JZCkge1xuICAgICAgICBsZXQgZW5kcG9pbnQgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50LCB1bmRlZmluZWQpO1xuICAgICAgICBjb25zdCByZWdpb24gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlZ2lvbiwgXCJjZW50cmFsdXNcIik7XG4gICAgICAgIGNvbnN0IGhvc3RTdWZmaXggPSBDb25uZWN0aW9uRmFjdG9yeUJhc2UuZ2V0SG9zdFN1ZmZpeChyZWdpb24pO1xuICAgICAgICBjb25zdCBob3N0RGVmYXVsdCA9IFwid3NzOi8vdHJhbnNjcmliZS5cIiArIHJlZ2lvbiArIFwiLmN0cy5zcGVlY2hcIiArIGhvc3RTdWZmaXggKyB0aGlzLm11bHRpYXVkaW9SZWxhdGl2ZVVyaTtcbiAgICAgICAgY29uc3QgaG9zdCA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fSG9zdCwgaG9zdERlZmF1bHQpO1xuICAgICAgICBjb25zdCBxdWVyeVBhcmFtcyA9IHt9O1xuICAgICAgICB0aGlzLnNldFF1ZXJ5UGFyYW1zKHF1ZXJ5UGFyYW1zLCBjb25maWcsIGVuZHBvaW50KTtcbiAgICAgICAgaWYgKCFlbmRwb2ludCkge1xuICAgICAgICAgICAgZW5kcG9pbnQgPSBob3N0O1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGhlYWRlcnMgPSB7fTtcbiAgICAgICAgaWYgKGF1dGhJbmZvLnRva2VuICE9PSB1bmRlZmluZWQgJiYgYXV0aEluZm8udG9rZW4gIT09IFwiXCIpIHtcbiAgICAgICAgICAgIGhlYWRlcnNbYXV0aEluZm8uaGVhZGVyTmFtZV0gPSBhdXRoSW5mby50b2tlbjtcbiAgICAgICAgfVxuICAgICAgICBoZWFkZXJzW0hlYWRlck5hbWVzLkNvbm5lY3Rpb25JZF0gPSBjb25uZWN0aW9uSWQ7XG4gICAgICAgIGNvbmZpZy5wYXJhbWV0ZXJzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVXJsLCBlbmRwb2ludCk7XG4gICAgICAgIGNvbnN0IGVuYWJsZUNvbXByZXNzaW9uID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoXCJTUEVFQ0gtRW5hYmxlV2Vic29ja2V0Q29tcHJlc3Npb25cIiwgXCJmYWxzZVwiKSA9PT0gXCJ0cnVlXCI7XG4gICAgICAgIHJldHVybiBuZXcgV2Vic29ja2V0Q29ubmVjdGlvbihlbmRwb2ludCwgcXVlcnlQYXJhbXMsIGhlYWRlcnMsIG5ldyBXZWJzb2NrZXRNZXNzYWdlRm9ybWF0dGVyKCksIFByb3h5SW5mby5mcm9tUmVjb2duaXplckNvbmZpZyhjb25maWcpLCBlbmFibGVDb21wcmVzc2lvbiwgY29ubmVjdGlvbklkKTtcbiAgICB9XG4gICAgc2V0UXVlcnlQYXJhbXMocXVlcnlQYXJhbXMsIGNvbmZpZywgZW5kcG9pbnRVcmwpIHtcbiAgICAgICAgY29uc3QgZW5kcG9pbnRJZCA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnRJZCwgdW5kZWZpbmVkKTtcbiAgICAgICAgY29uc3QgbGFuZ3VhZ2UgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZSwgdW5kZWZpbmVkKTtcbiAgICAgICAgaWYgKGVuZHBvaW50SWQgJiYgIShRdWVyeVBhcmFtZXRlck5hbWVzLkN1c3RvbVNwZWVjaERlcGxveW1lbnRJZCBpbiBxdWVyeVBhcmFtcykpIHtcbiAgICAgICAgICAgIHF1ZXJ5UGFyYW1zW1F1ZXJ5UGFyYW1ldGVyTmFtZXMuQ3VzdG9tU3BlZWNoRGVwbG95bWVudElkXSA9IGVuZHBvaW50SWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxhbmd1YWdlICYmICEoUXVlcnlQYXJhbWV0ZXJOYW1lcy5MYW5ndWFnZSBpbiBxdWVyeVBhcmFtcykpIHtcbiAgICAgICAgICAgIHF1ZXJ5UGFyYW1zW1F1ZXJ5UGFyYW1ldGVyTmFtZXMuTGFuZ3VhZ2VdID0gbGFuZ3VhZ2U7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgd29yZExldmVsVGltaW5ncyA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZVJlc3BvbnNlX1JlcXVlc3RXb3JkTGV2ZWxUaW1lc3RhbXBzLCBcImZhbHNlXCIpLnRvTG93ZXJDYXNlKCkgPT09IFwidHJ1ZVwiO1xuICAgICAgICBjb25zdCBkZXRhaWxlZCA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KE91dHB1dEZvcm1hdFByb3BlcnR5TmFtZSwgT3V0cHV0Rm9ybWF0W091dHB1dEZvcm1hdC5TaW1wbGVdKSAhPT0gT3V0cHV0Rm9ybWF0W091dHB1dEZvcm1hdC5TaW1wbGVdO1xuICAgICAgICBpZiAod29yZExldmVsVGltaW5ncyB8fCBkZXRhaWxlZCkge1xuICAgICAgICAgICAgcXVlcnlQYXJhbXNbUXVlcnlQYXJhbWV0ZXJOYW1lcy5Gb3JtYXRdID0gT3V0cHV0Rm9ybWF0W091dHB1dEZvcm1hdC5EZXRhaWxlZF0udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldENvbW1vblVybFBhcmFtcyhjb25maWcsIHF1ZXJ5UGFyYW1zLCBlbmRwb2ludFVybCk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1UcmFuc2NyaWJlckNvbm5lY3Rpb25GYWN0b3J5LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBSZXN0Q29uZmlnQmFzZSB9IGZyb20gXCIuLi8uLi9jb21tb24uYnJvd3Nlci9SZXN0Q29uZmlnQmFzZVwiO1xuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcgZXh0ZW5kcyBSZXN0Q29uZmlnQmFzZSB7XG4gICAgc3RhdGljIGdldCBob3N0KCkge1xuICAgICAgICByZXR1cm4gQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5wcml2SG9zdDtcbiAgICB9XG4gICAgc3RhdGljIGdldCBhcGlWZXJzaW9uKCkge1xuICAgICAgICByZXR1cm4gQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5wcml2QXBpVmVyc2lvbjtcbiAgICB9XG4gICAgc3RhdGljIGdldCBjbGllbnRBcHBJZCgpIHtcbiAgICAgICAgcmV0dXJuIENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcucHJpdkNsaWVudEFwcElkO1xuICAgIH1cbiAgICBzdGF0aWMgZ2V0IGRlZmF1bHRMYW5ndWFnZUNvZGUoKSB7XG4gICAgICAgIHJldHVybiBDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLnByaXZEZWZhdWx0TGFuZ3VhZ2VDb2RlO1xuICAgIH1cbiAgICBzdGF0aWMgZ2V0IHJlc3RQYXRoKCkge1xuICAgICAgICByZXR1cm4gQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5wcml2UmVzdFBhdGg7XG4gICAgfVxuICAgIHN0YXRpYyBnZXQgd2ViU29ja2V0UGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcucHJpdldlYlNvY2tldFBhdGg7XG4gICAgfVxuICAgIHN0YXRpYyBnZXQgdHJhbnNjcmlwdGlvbkV2ZW50S2V5cygpIHtcbiAgICAgICAgcmV0dXJuIENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcucHJpdlRyYW5zY3JpcHRpb25FdmVudEtleXM7XG4gICAgfVxufVxuQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5wcml2SG9zdCA9IFwiZGV2Lm1pY3Jvc29mdHRyYW5zbGF0b3IuY29tXCI7XG5Db252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLnByaXZSZXN0UGF0aCA9IFwiL2NhcGl0by9yb29tXCI7XG5Db252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLnByaXZBcGlWZXJzaW9uID0gXCIyLjBcIjtcbkNvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcucHJpdkRlZmF1bHRMYW5ndWFnZUNvZGUgPSBcImVuLVVTXCI7XG5Db252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLnByaXZDbGllbnRBcHBJZCA9IFwiRkM1MzlDMjItMTc2Ny00RjFGLTg0QkMtQjREODExMTE0RjE1XCI7XG5Db252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLnByaXZXZWJTb2NrZXRQYXRoID0gXCIvY2FwaXRvL3RyYW5zbGF0ZVwiO1xuQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5wcml2VHJhbnNjcmlwdGlvbkV2ZW50S2V5cyA9IFtcImlDYWxVaWRcIiwgXCJjYWxsSWRcIiwgXCJvcmdhbml6ZXJcIiwgXCJGTEFDXCIsIFwiTVRVcmlcIiwgXCJEaWZmZXJlbnRpYXRlR3Vlc3RTcGVha2Vyc1wiLCBcImF1ZGlvcmVjb3JkaW5nXCIsIFwiVGhyZWFkaWRcIiwgXCJPcmdhbml6ZXJNcmlcIiwgXCJPcmdhbml6ZXJUZW5hbnRJZFwiLCBcIlVzZXJUb2tlblwiXTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgUHJveHlJbmZvLCBXZWJzb2NrZXRDb25uZWN0aW9uIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi5icm93c2VyL0V4cG9ydHNcIjtcbmltcG9ydCB7IGNyZWF0ZUd1aWQgfSBmcm9tIFwiLi4vLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuLi8uLi9zZGsvQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eUlkIH0gZnJvbSBcIi4uLy4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb25uZWN0aW9uRmFjdG9yeUJhc2UgfSBmcm9tIFwiLi4vQ29ubmVjdGlvbkZhY3RvcnlCYXNlXCI7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnIH0gZnJvbSBcIi4vQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZ1wiO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uV2Vic29ja2V0TWVzc2FnZUZvcm1hdHRlciB9IGZyb20gXCIuL0NvbnZlcnNhdGlvbldlYnNvY2tldE1lc3NhZ2VGb3JtYXR0ZXJcIjtcbi8qKlxuICogQ3JlYXRlIGEgY29ubmVjdGlvbiB0byB0aGUgQ29udmVyc2F0aW9uIFRyYW5zbGF0b3Igd2Vic29ja2V0IGZvciBzZW5kaW5nIGluc3RhbnQgbWVzc2FnZXMgYW5kIGNvbW1hbmRzLCBhbmQgZm9yIHJlY2VpdmluZyB0cmFuc2xhdGVkIG1lc3NhZ2VzLlxuICogVGhlIGNvbnZlcnNhdGlvbiBtdXN0IGFscmVhZHkgaGF2ZSBiZWVuIHN0YXJ0ZWQgb3Igam9pbmVkLlxuICovXG5leHBvcnQgY2xhc3MgQ29udmVyc2F0aW9uQ29ubmVjdGlvbkZhY3RvcnkgZXh0ZW5kcyBDb25uZWN0aW9uRmFjdG9yeUJhc2Uge1xuICAgIGNyZWF0ZShjb25maWcsIGF1dGhJbmZvLCBjb25uZWN0aW9uSWQpIHtcbiAgICAgICAgY29uc3QgZW5kcG9pbnRIb3N0ID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25UcmFuc2xhdG9yX0hvc3QsIENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcuaG9zdCk7XG4gICAgICAgIGNvbnN0IGNvcnJlbGF0aW9uSWQgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvblRyYW5zbGF0b3JfQ29ycmVsYXRpb25JZCwgY3JlYXRlR3VpZCgpKTtcbiAgICAgICAgY29uc3QgZW5kcG9pbnQgPSBgd3NzOi8vJHtlbmRwb2ludEhvc3R9JHtDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLndlYlNvY2tldFBhdGh9YDtcbiAgICAgICAgY29uc3QgdG9rZW4gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvblRyYW5zbGF0b3JfVG9rZW4sIHVuZGVmaW5lZCk7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHRva2VuLCBcInRva2VuXCIpO1xuICAgICAgICBjb25zdCBxdWVyeVBhcmFtcyA9IHt9O1xuICAgICAgICBxdWVyeVBhcmFtc1tDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLmNvbmZpZ1BhcmFtcy5hcGlWZXJzaW9uXSA9IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcuYXBpVmVyc2lvbjtcbiAgICAgICAgcXVlcnlQYXJhbXNbQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5jb25maWdQYXJhbXMudG9rZW5dID0gdG9rZW47XG4gICAgICAgIHF1ZXJ5UGFyYW1zW0NvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcuY29uZmlnUGFyYW1zLmNvcnJlbGF0aW9uSWRdID0gY29ycmVsYXRpb25JZDtcbiAgICAgICAgY29uc3QgZW5hYmxlQ29tcHJlc3Npb24gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShcIlNQRUVDSC1FbmFibGVXZWJzb2NrZXRDb21wcmVzc2lvblwiLCBcImZhbHNlXCIpID09PSBcInRydWVcIjtcbiAgICAgICAgcmV0dXJuIG5ldyBXZWJzb2NrZXRDb25uZWN0aW9uKGVuZHBvaW50LCBxdWVyeVBhcmFtcywge30sIG5ldyBDb252ZXJzYXRpb25XZWJzb2NrZXRNZXNzYWdlRm9ybWF0dGVyKCksIFByb3h5SW5mby5mcm9tUmVjb2duaXplckNvbmZpZyhjb25maWcpLCBlbmFibGVDb21wcmVzc2lvbiwgY29ubmVjdGlvbklkKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbnZlcnNhdGlvbkNvbm5lY3Rpb25GYWN0b3J5LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBDb25uZWN0aW9uTWVzc2FnZSB9IGZyb20gXCIuLi8uLi9jb21tb24vRXhwb3J0c1wiO1xuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvbkNvbm5lY3Rpb25NZXNzYWdlIGV4dGVuZHMgQ29ubmVjdGlvbk1lc3NhZ2Uge1xuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2VUeXBlLCBib2R5LCBoZWFkZXJzLCBpZCkge1xuICAgICAgICBzdXBlcihtZXNzYWdlVHlwZSwgYm9keSwgaGVhZGVycywgaWQpO1xuICAgICAgICBjb25zdCBqc29uID0gSlNPTi5wYXJzZSh0aGlzLnRleHRCb2R5KTtcbiAgICAgICAgaWYgKGpzb24udHlwZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25NZXNzYWdlVHlwZSA9IGpzb24udHlwZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgY29udmVyc2F0aW9uTWVzc2FnZVR5cGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb252ZXJzYXRpb25NZXNzYWdlVHlwZTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbnZlcnNhdGlvbkNvbm5lY3Rpb25NZXNzYWdlLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBSZXN0TWVzc2FnZUFkYXB0ZXIsIFJlc3RSZXF1ZXN0VHlwZSB9IGZyb20gXCIuLi8uLi9jb21tb24uYnJvd3Nlci9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi4vLi4vc2RrL0NvbnRyYWN0c1wiO1xuaW1wb3J0IHsgUHJvcGVydHlJZCB9IGZyb20gXCIuLi8uLi9zZGsvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZyB9IGZyb20gXCIuL0NvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWdcIjtcbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25NYW5hZ2VyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLy9cbiAgICAgICAgdGhpcy5wcml2UmVxdWVzdFBhcmFtcyA9IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcuY29uZmlnUGFyYW1zO1xuICAgICAgICB0aGlzLnByaXZFcnJvcnMgPSBDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLnJlc3RFcnJvcnM7XG4gICAgICAgIHRoaXMucHJpdkhvc3QgPSBDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLmhvc3Q7XG4gICAgICAgIHRoaXMucHJpdkFwaVZlcnNpb24gPSBDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLmFwaVZlcnNpb247XG4gICAgICAgIHRoaXMucHJpdlJlc3RQYXRoID0gQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5yZXN0UGF0aDtcbiAgICAgICAgdGhpcy5wcml2UmVzdEFkYXB0ZXIgPSBuZXcgUmVzdE1lc3NhZ2VBZGFwdGVyKHt9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTWFrZSBhIFBPU1QgcmVxdWVzdCB0byB0aGUgQ29udmVyc2F0aW9uIE1hbmFnZXIgc2VydmljZSBlbmRwb2ludCB0byBjcmVhdGUgb3Igam9pbiBhIGNvbnZlcnNhdGlvbi5cbiAgICAgKiBAcGFyYW0gYXJnc1xuICAgICAqIEBwYXJhbSBjb252ZXJzYXRpb25Db2RlXG4gICAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAgICogQHBhcmFtIGVycm9yQ2FsbGJhY2tcbiAgICAgKi9cbiAgICBjcmVhdGVPckpvaW4oYXJncywgY29udmVyc2F0aW9uQ29kZSwgY2IsIGVycikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQoYXJncywgXCJhcmdzXCIpO1xuICAgICAgICAgICAgY29uc3QgbGFuZ3VhZ2VDb2RlID0gYXJncy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZSwgQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5kZWZhdWx0TGFuZ3VhZ2VDb2RlKTtcbiAgICAgICAgICAgIGNvbnN0IG5pY2tuYW1lID0gYXJncy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvblRyYW5zbGF0b3JfTmFtZSwgXCJjb252ZXJzYXRpb25faG9zdFwiKTtcbiAgICAgICAgICAgIGNvbnN0IGVuZHBvaW50SG9zdCA9IGFyZ3MuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25UcmFuc2xhdG9yX0hvc3QsIHRoaXMucHJpdkhvc3QpO1xuICAgICAgICAgICAgY29uc3QgY29ycmVsYXRpb25JZCA9IGFyZ3MuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25UcmFuc2xhdG9yX0NvcnJlbGF0aW9uSWQpO1xuICAgICAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uS2V5ID0gYXJncy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0tleSk7XG4gICAgICAgICAgICBjb25zdCBzdWJzY3JpcHRpb25SZWdpb24gPSBhcmdzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVnaW9uKTtcbiAgICAgICAgICAgIGNvbnN0IGF1dGhUb2tlbiA9IGFyZ3MuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbik7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UobGFuZ3VhZ2VDb2RlLCBcImxhbmd1YWdlQ29kZVwiKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShuaWNrbmFtZSwgXCJuaWNrbmFtZVwiKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShlbmRwb2ludEhvc3QsIFwiZW5kcG9pbnRIb3N0XCIpO1xuICAgICAgICAgICAgY29uc3QgcXVlcnlQYXJhbXMgPSB7fTtcbiAgICAgICAgICAgIHF1ZXJ5UGFyYW1zW3RoaXMucHJpdlJlcXVlc3RQYXJhbXMuYXBpVmVyc2lvbl0gPSB0aGlzLnByaXZBcGlWZXJzaW9uO1xuICAgICAgICAgICAgcXVlcnlQYXJhbXNbdGhpcy5wcml2UmVxdWVzdFBhcmFtcy5sYW5ndWFnZUNvZGVdID0gbGFuZ3VhZ2VDb2RlO1xuICAgICAgICAgICAgcXVlcnlQYXJhbXNbdGhpcy5wcml2UmVxdWVzdFBhcmFtcy5uaWNrbmFtZV0gPSBuaWNrbmFtZTtcbiAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSB7fTtcbiAgICAgICAgICAgIGlmIChjb3JyZWxhdGlvbklkKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVyc1t0aGlzLnByaXZSZXF1ZXN0UGFyYW1zLmNvcnJlbGF0aW9uSWRdID0gY29ycmVsYXRpb25JZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGhlYWRlcnNbdGhpcy5wcml2UmVxdWVzdFBhcmFtcy5jbGllbnRBcHBJZF0gPSBDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLmNsaWVudEFwcElkO1xuICAgICAgICAgICAgaWYgKGNvbnZlcnNhdGlvbkNvZGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHF1ZXJ5UGFyYW1zW3RoaXMucHJpdlJlcXVlc3RQYXJhbXMucm9vbUlkXSA9IGNvbnZlcnNhdGlvbkNvZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChzdWJzY3JpcHRpb25SZWdpb24sIHRoaXMucHJpdkVycm9ycy5hdXRoSW52YWxpZFN1YnNjcmlwdGlvblJlZ2lvbik7XG4gICAgICAgICAgICAgICAgaGVhZGVyc1t0aGlzLnByaXZSZXF1ZXN0UGFyYW1zLnN1YnNjcmlwdGlvblJlZ2lvbl0gPSBzdWJzY3JpcHRpb25SZWdpb247XG4gICAgICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbktleSkge1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzW3RoaXMucHJpdlJlcXVlc3RQYXJhbXMuc3Vic2NyaXB0aW9uS2V5XSA9IHN1YnNjcmlwdGlvbktleTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoYXV0aFRva2VuKSB7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnNbdGhpcy5wcml2UmVxdWVzdFBhcmFtcy5hdXRob3JpemF0aW9uXSA9IGBCZWFyZXIgJHthdXRoVG9rZW59YDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHN1YnNjcmlwdGlvbktleSwgdGhpcy5wcml2RXJyb3JzLmF1dGhJbnZhbGlkU3Vic2NyaXB0aW9uS2V5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBjb25maWcgPSB7fTtcbiAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzID0gaGVhZGVycztcbiAgICAgICAgICAgIHRoaXMucHJpdlJlc3RBZGFwdGVyLm9wdGlvbnMgPSBjb25maWc7XG4gICAgICAgICAgICBjb25zdCBlbmRwb2ludCA9IGBodHRwczovLyR7ZW5kcG9pbnRIb3N0fSR7dGhpcy5wcml2UmVzdFBhdGh9YDtcbiAgICAgICAgICAgIC8vIFRPRE86IHN1cHBvcnQgYSBwcm94eSBhbmQgY2VydGlmaWNhdGUgdmFsaWRhdGlvblxuICAgICAgICAgICAgdGhpcy5wcml2UmVzdEFkYXB0ZXIucmVxdWVzdChSZXN0UmVxdWVzdFR5cGUuUG9zdCwgZW5kcG9pbnQsIHF1ZXJ5UGFyYW1zLCBudWxsKS50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RJZCA9IFJlc3RNZXNzYWdlQWRhcHRlci5leHRyYWN0SGVhZGVyVmFsdWUodGhpcy5wcml2UmVxdWVzdFBhcmFtcy5yZXF1ZXN0SWQsIHJlc3BvbnNlLmhlYWRlcnMpO1xuICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBnZXQgdGhlIGVycm9yXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZXJyb3JNZXNzYWdlID0gdGhpcy5wcml2RXJyb3JzLmludmFsaWRDcmVhdGVKb2luQ29udmVyc2F0aW9uUmVzcG9uc2UucmVwbGFjZShcIntzdGF0dXN9XCIsIHJlc3BvbnNlLnN0YXR1cy50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlcnJNZXNzYWdlUmF3O1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJNZXNzYWdlUmF3ID0gSlNPTi5wYXJzZShyZXNwb25zZS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgKz0gYCBbJHtlcnJNZXNzYWdlUmF3LmVycm9yLmNvZGV9OiAke2Vyck1lc3NhZ2VSYXcuZXJyb3IubWVzc2FnZX1dYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlICs9IGAgWyR7cmVzcG9uc2UuZGF0YX1dYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXF1ZXN0SWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgKz0gYCAke3JlcXVlc3RJZH1gO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyKGVycm9yTWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSBKU09OLnBhcnNlKHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICAgICAgICAgIGlmIChjb252ZXJzYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29udmVyc2F0aW9uLnJlcXVlc3RJZCA9IHJlcXVlc3RJZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCEhY2IpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNiKGNvbnZlcnNhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycihlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYiA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvblxuICAgICAgICAgICAgfSkuY2F0Y2goKCkgPT4geyB9KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHR5cGVkRXJyb3IgPSBlcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgZXJyKHR5cGVkRXJyb3IubmFtZSArIFwiOiBcIiArIHR5cGVkRXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlcnIoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBNYWtlIGEgREVMRVRFIHJlcXVlc3QgdG8gdGhlIENvbnZlcnNhdGlvbiBNYW5hZ2VyIHNlcnZpY2UgZW5kcG9pbnQgdG8gbGVhdmUgdGhlIGNvbnZlcnNhdGlvbi5cbiAgICAgKiBAcGFyYW0gYXJnc1xuICAgICAqIEBwYXJhbSBzZXNzaW9uVG9rZW5cbiAgICAgKiBAcGFyYW0gY2FsbGJhY2tcbiAgICAgKi9cbiAgICBsZWF2ZShhcmdzLCBzZXNzaW9uVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQoYXJncywgdGhpcy5wcml2RXJyb3JzLmludmFsaWRBcmdzLnJlcGxhY2UoXCJ7YXJnfVwiLCBcImNvbmZpZ1wiKSk7XG4gICAgICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHNlc3Npb25Ub2tlbiwgdGhpcy5wcml2RXJyb3JzLmludmFsaWRBcmdzLnJlcGxhY2UoXCJ7YXJnfVwiLCBcInRva2VuXCIpKTtcbiAgICAgICAgICAgICAgICBjb25zdCBlbmRwb2ludEhvc3QgPSBhcmdzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9Ib3N0LCB0aGlzLnByaXZIb3N0KTtcbiAgICAgICAgICAgICAgICBjb25zdCBjb3JyZWxhdGlvbklkID0gYXJncy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvblRyYW5zbGF0b3JfQ29ycmVsYXRpb25JZCk7XG4gICAgICAgICAgICAgICAgY29uc3QgcXVlcnlQYXJhbXMgPSB7fTtcbiAgICAgICAgICAgICAgICBxdWVyeVBhcmFtc1t0aGlzLnByaXZSZXF1ZXN0UGFyYW1zLmFwaVZlcnNpb25dID0gdGhpcy5wcml2QXBpVmVyc2lvbjtcbiAgICAgICAgICAgICAgICBxdWVyeVBhcmFtc1t0aGlzLnByaXZSZXF1ZXN0UGFyYW1zLnNlc3Npb25Ub2tlbl0gPSBzZXNzaW9uVG9rZW47XG4gICAgICAgICAgICAgICAgY29uc3QgaGVhZGVycyA9IHt9O1xuICAgICAgICAgICAgICAgIGlmIChjb3JyZWxhdGlvbklkKSB7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnNbdGhpcy5wcml2UmVxdWVzdFBhcmFtcy5jb3JyZWxhdGlvbklkXSA9IGNvcnJlbGF0aW9uSWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IHt9O1xuICAgICAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzID0gaGVhZGVycztcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXN0QWRhcHRlci5vcHRpb25zID0gY29uZmlnO1xuICAgICAgICAgICAgICAgIGNvbnN0IGVuZHBvaW50ID0gYGh0dHBzOi8vJHtlbmRwb2ludEhvc3R9JHt0aGlzLnByaXZSZXN0UGF0aH1gO1xuICAgICAgICAgICAgICAgIC8vIFRPRE86IHN1cHBvcnQgYSBwcm94eSBhbmQgY2VydGlmaWNhdGUgdmFsaWRhdGlvblxuICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlc3RBZGFwdGVyLnJlcXVlc3QoUmVzdFJlcXVlc3RUeXBlLkRlbGV0ZSwgZW5kcG9pbnQsIHF1ZXJ5UGFyYW1zLCBudWxsKS50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZ25vcmUgZXJyb3JzIG9uIGRlbGV0ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvblxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHsgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0eXBlZEVycm9yID0gZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh0eXBlZEVycm9yLm5hbWUgKyBcIjogXCIgKyB0eXBlZEVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29udmVyc2F0aW9uTWFuYWdlci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBjcmVhdGVOb0Rhc2hHdWlkLCBEZWZlcnJlZCwgfSBmcm9tIFwiLi4vLi4vY29tbW9uL0V4cG9ydHNcIjtcbi8qKlxuICogUGxhY2Vob2xkZXIgY2xhc3MgZm9yIHRoZSBDb252ZXJzYXRpb24gUmVxdWVzdCBTZXNzaW9uLiBCYXNlZCBvZmYgUmVxdWVzdFNlc3Npb24uXG4gKiBUT0RPOiBkZWZpbmUgd2hhdCB0ZWxlbWV0cnkgaXMgcmVxdWlyZWQuXG4gKi9cbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25SZXF1ZXN0U2Vzc2lvbiB7XG4gICAgY29uc3RydWN0b3Ioc2Vzc2lvbklkKSB7XG4gICAgICAgIHRoaXMucHJpdklzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2RGV0YWNoYWJsZXMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgdGhpcy5wcml2U2Vzc2lvbklkID0gc2Vzc2lvbklkO1xuICAgICAgICB0aGlzLnByaXZSZXF1ZXN0SWQgPSBjcmVhdGVOb0Rhc2hHdWlkKCk7XG4gICAgICAgIHRoaXMucHJpdlJlcXVlc3RDb21wbGV0aW9uRGVmZXJyYWwgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICB9XG4gICAgZ2V0IHNlc3Npb25JZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNlc3Npb25JZDtcbiAgICB9XG4gICAgZ2V0IHJlcXVlc3RJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlcXVlc3RJZDtcbiAgICB9XG4gICAgZ2V0IGNvbXBsZXRpb25Qcm9taXNlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVxdWVzdENvbXBsZXRpb25EZWZlcnJhbC5wcm9taXNlO1xuICAgIH1cbiAgICBvblByZUNvbm5lY3Rpb25TdGFydChhdXRoRmV0Y2hFdmVudElkLCBjb25uZWN0aW9uSWQpIHtcbiAgICAgICAgdGhpcy5wcml2U2Vzc2lvbklkID0gY29ubmVjdGlvbklkO1xuICAgIH1cbiAgICBvbkF1dGhDb21wbGV0ZWQoaXNFcnJvcikge1xuICAgICAgICBpZiAoaXNFcnJvcikge1xuICAgICAgICAgICAgdGhpcy5vbkNvbXBsZXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25Db25uZWN0aW9uRXN0YWJsaXNoQ29tcGxldGVkKHN0YXR1c0NvZGUpIHtcbiAgICAgICAgaWYgKHN0YXR1c0NvZGUgPT09IDIwMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHN0YXR1c0NvZGUgPT09IDQwMykge1xuICAgICAgICAgICAgdGhpcy5vbkNvbXBsZXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25TZXJ2aWNlVHVybkVuZFJlc3BvbnNlKGNvbnRpbnVvdXNSZWNvZ25pdGlvbikge1xuICAgICAgICBpZiAoIWNvbnRpbnVvdXNSZWNvZ25pdGlvbikge1xuICAgICAgICAgICAgdGhpcy5vbkNvbXBsZXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0SWQgPSBjcmVhdGVOb0Rhc2hHdWlkKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGlzcG9zZSgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wcml2SXNEaXNwb3NlZCkge1xuICAgICAgICAgICAgICAgIC8vIHdlIHNob3VsZCBoYXZlIGNvbXBsZXRlZCBieSBub3cuIElmIHdlIGRpZCBub3QgaXRzIGFuIHVua25vd24gZXJyb3IuXG4gICAgICAgICAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBkZXRhY2hhYmxlIG9mIHRoaXMucHJpdkRldGFjaGFibGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIGRldGFjaGFibGUuZGV0YWNoKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgb25Db21wbGV0ZSgpIHtcbiAgICAgICAgLy9cbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbnZlcnNhdGlvblJlcXVlc3RTZXNzaW9uLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCB7IENvbm5lY3Rpb25TdGF0ZSwgY3JlYXRlTm9EYXNoR3VpZCwgRGVmZXJyZWQsIE1lc3NhZ2VUeXBlLCB9IGZyb20gXCIuLi8uLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLCBDYW5jZWxsYXRpb25SZWFzb24sIENvbnZlcnNhdGlvbkV4cGlyYXRpb25FdmVudEFyZ3MsIENvbnZlcnNhdGlvblRyYW5zbGF0aW9uQ2FuY2VsZWRFdmVudEFyZ3MsIENvbnZlcnNhdGlvblRyYW5zbGF0aW9uUmVzdWx0LCBSZXN1bHRSZWFzb24sIFRyYW5zbGF0aW9ucyB9IGZyb20gXCIuLi8uLi9zZGsvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29nbml0aXZlVG9rZW5BdXRoZW50aWNhdGlvbiwgU2VydmljZVJlY29nbml6ZXJCYXNlIH0gZnJvbSBcIi4uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25NZXNzYWdlIH0gZnJvbSBcIi4vQ29udmVyc2F0aW9uQ29ubmVjdGlvbk1lc3NhZ2VcIjtcbmltcG9ydCB7IENvbnZlcnNhdGlvblJlcXVlc3RTZXNzaW9uIH0gZnJvbSBcIi4vQ29udmVyc2F0aW9uUmVxdWVzdFNlc3Npb25cIjtcbmltcG9ydCB7IENvbnZlcnNhdGlvblJlY2VpdmVkVHJhbnNsYXRpb25FdmVudEFyZ3MsIExvY2tSb29tRXZlbnRBcmdzLCBNdXRlQWxsRXZlbnRBcmdzLCBQYXJ0aWNpcGFudEF0dHJpYnV0ZUV2ZW50QXJncywgUGFydGljaXBhbnRFdmVudEFyZ3MsIFBhcnRpY2lwYW50c0xpc3RFdmVudEFyZ3MgfSBmcm9tIFwiLi9Db252ZXJzYXRpb25UcmFuc2xhdG9yRXZlbnRBcmdzXCI7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25UcmFuc2xhdG9yQ29tbWFuZFR5cGVzLCBDb252ZXJzYXRpb25UcmFuc2xhdG9yTWVzc2FnZVR5cGVzIH0gZnJvbSBcIi4vQ29udmVyc2F0aW9uVHJhbnNsYXRvckludGVyZmFjZXNcIjtcbmltcG9ydCB7IENvbW1hbmRSZXNwb25zZVBheWxvYWQsIFBhcnRpY2lwYW50UGF5bG9hZFJlc3BvbnNlLCBQYXJ0aWNpcGFudHNMaXN0UGF5bG9hZFJlc3BvbnNlLCBTcGVlY2hSZXNwb25zZVBheWxvYWQsIFRleHRSZXNwb25zZVBheWxvYWQgfSBmcm9tIFwiLi9TZXJ2aWNlTWVzc2FnZXMvRXhwb3J0c1wiO1xuLyoqXG4gKiBUaGUgc2VydmljZSBhZGFwdGVyIGhhbmRsZXMgc2VuZGluZyBhbmQgcmVjZWl2aW5nIG1lc3NhZ2VzIHRvIHRoZSBDb252ZXJzYXRpb24gVHJhbnNsYXRvciB3ZWJzb2NrZXQuXG4gKi9cbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25TZXJ2aWNlQWRhcHRlciBleHRlbmRzIFNlcnZpY2VSZWNvZ25pemVyQmFzZSB7XG4gICAgY29uc3RydWN0b3IoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb1NvdXJjZSwgcmVjb2duaXplckNvbmZpZywgY29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvcikge1xuICAgICAgICBzdXBlcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvU291cmNlLCByZWNvZ25pemVyQ29uZmlnLCBjb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yKTtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ1Byb21pc2UgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucHJpdkxhc3RQYXJ0aWFsVXR0ZXJhbmNlSWQgPSBcIlwiO1xuICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yID0gY29udmVyc2F0aW9uU2VydmljZUNvbm5lY3RvcjtcbiAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uQXV0aGVudGljYXRpb24gPSBhdXRoZW50aWNhdGlvbjtcbiAgICAgICAgdGhpcy5yZWNlaXZlTWVzc2FnZU92ZXJyaWRlID0gKCkgPT4gdGhpcy5yZWNlaXZlQ29udmVyc2F0aW9uTWVzc2FnZU92ZXJyaWRlKCk7XG4gICAgICAgIHRoaXMucmVjb2duaXplT3ZlcnJpZGUgPSAoKSA9PiB0aGlzLm5vT3AoKTtcbiAgICAgICAgdGhpcy5wb3N0Q29ubmVjdEltcGxPdmVycmlkZSA9IChjb25uZWN0aW9uKSA9PiB0aGlzLmNvbnZlcnNhdGlvbkNvbm5lY3RJbXBsKGNvbm5lY3Rpb24pO1xuICAgICAgICB0aGlzLmNvbmZpZ0Nvbm5lY3Rpb25PdmVycmlkZSA9ICgpID0+IHRoaXMuY29uZmlnQ29ubmVjdGlvbigpO1xuICAgICAgICB0aGlzLmRpc2Nvbm5lY3RPdmVycmlkZSA9ICgpID0+IHRoaXMucHJpdkRpc2Nvbm5lY3QoKTtcbiAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVxdWVzdFNlc3Npb24gPSBuZXcgQ29udmVyc2F0aW9uUmVxdWVzdFNlc3Npb24oY3JlYXRlTm9EYXNoR3VpZCgpKTtcbiAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uQ29ubmVjdGlvbkZhY3RvcnkgPSBjb25uZWN0aW9uRmFjdG9yeTtcbiAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uSXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgIH1cbiAgICBpc0Rpc3Bvc2VkKCkge1xuICAgICAgICByZXR1cm4gc3VwZXIuaXNEaXNwb3NlZCgpIHx8IHRoaXMucHJpdkNvbnZlcnNhdGlvbklzRGlzcG9zZWQ7XG4gICAgfVxuICAgIGRpc3Bvc2UocmVhc29uKSB7XG4gICAgICAgIGNvbnN0IF9zdXBlciA9IE9iamVjdC5jcmVhdGUobnVsbCwge1xuICAgICAgICAgICAgZGlzcG9zZTogeyBnZXQ6ICgpID0+IHN1cGVyLmRpc3Bvc2UgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvbklzRGlzcG9zZWQgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWdQcm9taXNlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0geWllbGQgdGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ1Byb21pc2U7XG4gICAgICAgICAgICAgICAgeWllbGQgY29ubmVjdGlvbi5kaXNwb3NlKHJlYXNvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB5aWVsZCBfc3VwZXIuZGlzcG9zZS5jYWxsKHRoaXMsIHJlYXNvbik7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZW5kTWVzc2FnZShtZXNzYWdlKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0geWllbGQgdGhpcy5mZXRjaENvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgIHJldHVybiBjb25uZWN0aW9uLnNlbmQobmV3IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25NZXNzYWdlKE1lc3NhZ2VUeXBlLlRleHQsIG1lc3NhZ2UpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNlbmRNZXNzYWdlQXN5bmMobWVzc2FnZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHlpZWxkIHRoaXMuZmV0Y2hDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICB5aWVsZCBjb25uZWN0aW9uLnNlbmQobmV3IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25NZXNzYWdlKE1lc3NhZ2VUeXBlLlRleHQsIG1lc3NhZ2UpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHByaXZEaXNjb25uZWN0KCkge1xuICAgICAgICBpZiAodGhpcy50ZXJtaW5hdGVNZXNzYWdlTG9vcCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2FuY2VsUmVjb2duaXRpb24odGhpcy5wcml2Q29udmVyc2F0aW9uUmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkLCB0aGlzLnByaXZDb252ZXJzYXRpb25SZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIENhbmNlbGxhdGlvblJlYXNvbi5FcnJvciwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLk5vRXJyb3IsIFwiRGlzY29ubmVjdGluZ1wiKTtcbiAgICAgICAgdGhpcy50ZXJtaW5hdGVNZXNzYWdlTG9vcCA9IHRydWU7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9yZXF1aXJlLWF3YWl0XG4gICAgcHJvY2Vzc1R5cGVTcGVjaWZpY01lc3NhZ2VzKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvLyBDYW5jZWxzIHJlY29nbml0aW9uLlxuICAgIGNhbmNlbFJlY29nbml0aW9uKHNlc3Npb25JZCwgcmVxdWVzdElkLCBjYW5jZWxsYXRpb25SZWFzb24sIGVycm9yQ29kZSwgZXJyb3IpIHtcbiAgICAgICAgdGhpcy50ZXJtaW5hdGVNZXNzYWdlTG9vcCA9IHRydWU7XG4gICAgICAgIGNvbnN0IGNhbmNlbEV2ZW50ID0gbmV3IENvbnZlcnNhdGlvblRyYW5zbGF0aW9uQ2FuY2VsZWRFdmVudEFyZ3MoY2FuY2VsbGF0aW9uUmVhc29uLCBlcnJvciwgZXJyb3JDb2RlLCB1bmRlZmluZWQsIHNlc3Npb25JZCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLmNhbmNlbGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci5jYW5jZWxlZCh0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLCBjYW5jZWxFdmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKF9hKSB7XG4gICAgICAgICAgICAvLyBjb250aW51ZSBvbiBlcnJvclxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVzdGFibGlzaGVzIGEgd2Vic29ja2V0IGNvbm5lY3Rpb24gdG8gdGhlIGVuZCBwb2ludC5cbiAgICAgKi9cbiAgICBjb252ZXJzYXRpb25Db25uZWN0SW1wbChjb25uZWN0aW9uKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uTG9vcCA9IHRoaXMuc3RhcnRNZXNzYWdlTG9vcCgpO1xuICAgICAgICAgICAgcmV0dXJuIGNvbm5lY3Rpb247XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcm9jZXNzIGluY29taW5nIHdlYnNvY2tldCBtZXNzYWdlc1xuICAgICAqL1xuICAgIHJlY2VpdmVDb252ZXJzYXRpb25NZXNzYWdlT3ZlcnJpZGUoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0Rpc3Bvc2VkKCkgfHwgdGhpcy50ZXJtaW5hdGVNZXNzYWdlTG9vcCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHdlIHdvbid0IHJlbHkgb24gdGhlIGNhc2NhZGluZyBwcm9taXNlcyBvZiB0aGUgY29ubmVjdGlvbiBzaW5jZSB3ZSB3YW50IHRvIGNvbnRpbnVhbGx5IGJlIGF2YWlsYWJsZSB0byByZWNlaXZlIG1lc3NhZ2VzXG4gICAgICAgICAgICBjb25zdCBjb21tdW5pY2F0aW9uQ3VzdG9kaWFuID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSB5aWVsZCB0aGlzLmZldGNoQ29ubmVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB5aWVsZCBjb25uZWN0aW9uLnJlYWQoKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0Rpc3Bvc2VkKCkgfHwgdGhpcy50ZXJtaW5hdGVNZXNzYWdlTG9vcCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBXZSdyZSBkb25lLlxuICAgICAgICAgICAgICAgICAgICBjb21tdW5pY2F0aW9uQ3VzdG9kaWFuLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVjZWl2ZUNvbnZlcnNhdGlvbk1lc3NhZ2VPdmVycmlkZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBzZXNzaW9uSWQgPSB0aGlzLnByaXZDb252ZXJzYXRpb25SZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQ7XG4gICAgICAgICAgICAgICAgY29uc3QgY29udmVyc2F0aW9uTWVzc2FnZVR5cGUgPSBtZXNzYWdlLmNvbnZlcnNhdGlvbk1lc3NhZ2VUeXBlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgbGV0IHNlbmRGaW5hbCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoY29udmVyc2F0aW9uTWVzc2FnZVR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJpbmZvXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwicGFydGljaXBhbnRfY29tbWFuZFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImNvbW1hbmRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb21tYW5kUGF5bG9hZCA9IENvbW1hbmRSZXNwb25zZVBheWxvYWQuZnJvbUpTT04obWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChjb21tYW5kUGF5bG9hZC5jb21tYW5kLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICdQYXJ0aWNwYW50TGlzdCcgaXMgdGhlIGZpcnN0IG1lc3NhZ2Ugc2VudCB0byB0aGUgdXNlciBhZnRlciB0aGUgd2Vic29ja2V0IGNvbm5lY3Rpb24gaGFzIG9wZW5lZC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVGhlIGNvbnN1bWluZyBjbGllbnQgbXVzdCB3YWl0IGZvciB0aGlzIG1lc3NhZ2UgdG8gYXJyaXZlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGJlZm9yZSBzdGFydGluZyB0byBzZW5kIHRoZWlyIG93biBkYXRhLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInBhcnRpY2lwYW50bGlzdFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFydGljaXBhbnRzUGF5bG9hZCA9IFBhcnRpY2lwYW50c0xpc3RQYXlsb2FkUmVzcG9uc2UuZnJvbUpTT04obWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJ0aWNpcGFudHNSZXN1bHQgPSBwYXJ0aWNpcGFudHNQYXlsb2FkLnBhcnRpY2lwYW50cy5tYXAoKHApID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJ0aWNpcGFudCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXZhdGFyOiBwLmF2YXRhcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6IHAubmlja25hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBwLnBhcnRpY2lwYW50SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzSG9zdDogcC5pc2hvc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzTXV0ZWQ6IHAuaXNtdXRlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNVc2luZ1R0czogcC51c2V0dHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWZlcnJlZExhbmd1YWdlOiBwLmxvY2FsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnRpY2lwYW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLnBhcnRpY2lwYW50c0xpc3RSZWNlaXZlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IucGFydGljaXBhbnRzTGlzdFJlY2VpdmVkKHRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IsIG5ldyBQYXJ0aWNpcGFudHNMaXN0RXZlbnRBcmdzKHBhcnRpY2lwYW50c1BheWxvYWQucm9vbWlkLCBwYXJ0aWNpcGFudHNQYXlsb2FkLnRva2VuLCBwYXJ0aWNpcGFudHNQYXlsb2FkLnRyYW5zbGF0ZVRvLCBwYXJ0aWNpcGFudHNQYXlsb2FkLnByb2Zhbml0eUZpbHRlciwgcGFydGljaXBhbnRzUGF5bG9hZC5yb29tUHJvZmFuaXR5RmlsdGVyLCBwYXJ0aWNpcGFudHNQYXlsb2FkLnJvb21Mb2NrZWQsIHBhcnRpY2lwYW50c1BheWxvYWQubXV0ZUFsbCwgcGFydGljaXBhbnRzUmVzdWx0LCBzZXNzaW9uSWQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogJ1NldFRyYW5zbGF0ZVRvTGFuZ3VhZ2VzJyByZXByZXNlbnRzIHRoZSBsaXN0IG9mIGxhbmd1YWdlcyBiZWluZyB1c2VkIGluIHRoZSBDb252ZXJzYXRpb24gYnkgYWxsIHVzZXJzKD8pLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBUaGlzIGlzIHNlbnQgYXQgdGhlIHN0YXJ0IG9mIHRoZSBDb252ZXJzYXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzZXR0cmFuc2xhdGV0b2xhbmd1YWdlc1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci5wYXJ0aWNpcGFudFVwZGF0ZUNvbW1hbmRSZWNlaXZlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IucGFydGljaXBhbnRVcGRhdGVDb21tYW5kUmVjZWl2ZWQodGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3RvciwgbmV3IFBhcnRpY2lwYW50QXR0cmlidXRlRXZlbnRBcmdzKGNvbW1hbmRQYXlsb2FkLnBhcnRpY2lwYW50SWQsIENvbnZlcnNhdGlvblRyYW5zbGF0b3JDb21tYW5kVHlwZXMuc2V0VHJhbnNsYXRlVG9MYW5ndWFnZXMsIGNvbW1hbmRQYXlsb2FkLnZhbHVlLCBzZXNzaW9uSWQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogJ1NldFByb2Zhbml0eUZpbHRlcmluZycgbGV0cyB0aGUgY2xpZW50IHNldCB0aGUgbGV2ZWwgb2YgcHJvZmFuaXR5IGZpbHRlcmluZy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogSWYgc2VudCBieSB0aGUgcGFydGljaXBhbnQgdGhlIHNldHRpbmcgd2lsbCBlZmZlY3Qgb25seSB0aGVpciBvd24gcHJvZmFuaXR5IGxldmVsLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBJZiBzZW50IGJ5IHRoZSBob3N0LCB0aGUgc2V0dGluZyB3aWxsIGVmZmVjdCBhbGwgcGFydGljaXBhbnRzIGluY2x1ZGluZyB0aGUgaG9zdC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTm90ZTogdGhlIHByb2Zhbml0eSBmaWx0ZXJzIGRpZmZlciBmcm9tIFNwZWVjaCBTZXJ2aWNlICg/KTogJ21hcmtlZCcsICdyYXcnLCAncmVtb3ZlZCcsICd0YWdnZWQnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwic2V0cHJvZmFuaXR5ZmlsdGVyaW5nXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLnBhcnRpY2lwYW50VXBkYXRlQ29tbWFuZFJlY2VpdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci5wYXJ0aWNpcGFudFVwZGF0ZUNvbW1hbmRSZWNlaXZlZCh0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLCBuZXcgUGFydGljaXBhbnRBdHRyaWJ1dGVFdmVudEFyZ3MoY29tbWFuZFBheWxvYWQucGFydGljaXBhbnRJZCwgQ29udmVyc2F0aW9uVHJhbnNsYXRvckNvbW1hbmRUeXBlcy5zZXRQcm9mYW5pdHlGaWx0ZXJpbmcsIGNvbW1hbmRQYXlsb2FkLnZhbHVlLCBzZXNzaW9uSWQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogJ1NldE11dGUnIGlzIHNlbnQgaWYgdGhlIHBhcnRpY2lwYW50IGhhcyBiZWVuIG11dGVkIGJ5IHRoZSBob3N0LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDaGVjayB0aGUgJ3BhcnRpY2lwYW50SWQnIHRvIGRldGVybWluZSBpZiB0aGUgY3VycmVudCB1c2VyIGhhcyBiZWVuIG11dGVkLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInNldG11dGVcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IucGFydGljaXBhbnRVcGRhdGVDb21tYW5kUmVjZWl2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLnBhcnRpY2lwYW50VXBkYXRlQ29tbWFuZFJlY2VpdmVkKHRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IsIG5ldyBQYXJ0aWNpcGFudEF0dHJpYnV0ZUV2ZW50QXJncyhjb21tYW5kUGF5bG9hZC5wYXJ0aWNpcGFudElkLCBDb252ZXJzYXRpb25UcmFuc2xhdG9yQ29tbWFuZFR5cGVzLnNldE11dGUsIGNvbW1hbmRQYXlsb2FkLnZhbHVlLCBzZXNzaW9uSWQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogJ1NldE11dGVBbGwnIGlzIHNlbnQgaWYgdGhlIENvbnZlcnNhdGlvbiBoYXMgYmVlbiBtdXRlZCBieSB0aGUgaG9zdC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzZXRtdXRlYWxsXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLm11dGVBbGxDb21tYW5kUmVjZWl2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLm11dGVBbGxDb21tYW5kUmVjZWl2ZWQodGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3RvciwgbmV3IE11dGVBbGxFdmVudEFyZ3MoY29tbWFuZFBheWxvYWQudmFsdWUsIHNlc3Npb25JZCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAnUm9vbUV4cGlyYXRpb25XYXJuaW5nJyBpcyBzZW50IHRvd2FyZHMgdGhlIGVuZCBvZiB0aGUgQ29udmVyc2F0aW9uIHNlc3Npb24gdG8gZ2l2ZSBhIHRpbWVvdXQgd2FybmluZy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJyb29tZXhwaXJhdGlvbndhcm5pbmdcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IuY29udmVyc2F0aW9uRXhwaXJhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IuY29udmVyc2F0aW9uRXhwaXJhdGlvbih0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLCBuZXcgQ29udmVyc2F0aW9uRXhwaXJhdGlvbkV2ZW50QXJncyhjb21tYW5kUGF5bG9hZC52YWx1ZSwgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICdTZXRVc2VUdHMnIGlzIHNlbnQgYXMgYSBjb25maXJtYXRpb24gaWYgdGhlIHVzZXIgcmVxdWVzdHMgVFRTIHRvIGJlIHR1cm5lZCBvbiBvciBvZmYuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwic2V0dXNldHRzXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLnBhcnRpY2lwYW50VXBkYXRlQ29tbWFuZFJlY2VpdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci5wYXJ0aWNpcGFudFVwZGF0ZUNvbW1hbmRSZWNlaXZlZCh0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLCBuZXcgUGFydGljaXBhbnRBdHRyaWJ1dGVFdmVudEFyZ3MoY29tbWFuZFBheWxvYWQucGFydGljaXBhbnRJZCwgQ29udmVyc2F0aW9uVHJhbnNsYXRvckNvbW1hbmRUeXBlcy5zZXRVc2VUVFMsIGNvbW1hbmRQYXlsb2FkLnZhbHVlLCBzZXNzaW9uSWQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogJ1NldExvY2tTdGF0ZScgaXMgc2V0IGlmIHRoZSBob3N0IGhhcyBsb2NrZWQgb3IgdW5sb2NrZWQgdGhlIENvbnZlcnNhdGlvbi5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzZXRsb2Nrc3RhdGVcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IubG9ja1Jvb21Db21tYW5kUmVjZWl2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLmxvY2tSb29tQ29tbWFuZFJlY2VpdmVkKHRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IsIG5ldyBMb2NrUm9vbUV2ZW50QXJncyhjb21tYW5kUGF5bG9hZC52YWx1ZSwgc2Vzc2lvbklkKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICdDaGFuZ2VOaWNrbmFtZScgaXMgcmVjZWl2ZWQgaWYgYSB1c2VyIGNoYW5nZXMgdGhlaXIgZGlzcGxheSBuYW1lLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBBbnkgY2FjaGVkIHBhcnRpY3BpYW50cyBsaXN0IHNob3VsZCBiZSB1cGRhdGVkIHRvIHJlZmxlY3QgdGhlIGRpc3BsYXkgbmFtZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJjaGFuZ2VuaWNrbmFtZVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci5wYXJ0aWNpcGFudFVwZGF0ZUNvbW1hbmRSZWNlaXZlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IucGFydGljaXBhbnRVcGRhdGVDb21tYW5kUmVjZWl2ZWQodGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3RvciwgbmV3IFBhcnRpY2lwYW50QXR0cmlidXRlRXZlbnRBcmdzKGNvbW1hbmRQYXlsb2FkLnBhcnRpY2lwYW50SWQsIENvbnZlcnNhdGlvblRyYW5zbGF0b3JDb21tYW5kVHlwZXMuY2hhbmdlTmlja25hbWUsIGNvbW1hbmRQYXlsb2FkLm5pY2tuYW1lLCBzZXNzaW9uSWQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogJ0pvaW5TZXNzaW9uJyBpcyBzZW50IHdoZW4gYSB1c2VyIGpvaW5zIHRoZSBDb252ZXJzYXRpb24uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiam9pbnNlc3Npb25cIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGpvaW5QYXJ0aWNpcGFudFBheWxvYWQgPSBQYXJ0aWNpcGFudFBheWxvYWRSZXNwb25zZS5mcm9tSlNPTihtZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGpvaW5pbmdQYXJ0aWNpcGFudCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdmF0YXI6IGpvaW5QYXJ0aWNpcGFudFBheWxvYWQuYXZhdGFyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBqb2luUGFydGljaXBhbnRQYXlsb2FkLm5pY2tuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBqb2luUGFydGljaXBhbnRQYXlsb2FkLnBhcnRpY2lwYW50SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNIb3N0OiBqb2luUGFydGljaXBhbnRQYXlsb2FkLmlzaG9zdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc011dGVkOiBqb2luUGFydGljaXBhbnRQYXlsb2FkLmlzbXV0ZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNVc2luZ1R0czogam9pblBhcnRpY2lwYW50UGF5bG9hZC51c2V0dHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlZmVycmVkTGFuZ3VhZ2U6IGpvaW5QYXJ0aWNpcGFudFBheWxvYWQubG9jYWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IucGFydGljaXBhbnRKb2luQ29tbWFuZFJlY2VpdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci5wYXJ0aWNpcGFudEpvaW5Db21tYW5kUmVjZWl2ZWQodGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3RvciwgbmV3IFBhcnRpY2lwYW50RXZlbnRBcmdzKGpvaW5pbmdQYXJ0aWNpcGFudCwgc2Vzc2lvbklkKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICdMZWF2ZVNlc3Npb24nIGlzIHNlbnQgd2hlbiBhIHVzZXIgbGVhdmVzIHRoZSBDb252ZXJzYXRpb24nLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImxlYXZlc2Vzc2lvblwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGVhdmluZ1BhcnRpY2lwYW50ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBjb21tYW5kUGF5bG9hZC5wYXJ0aWNpcGFudElkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci5wYXJ0aWNpcGFudExlYXZlQ29tbWFuZFJlY2VpdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci5wYXJ0aWNpcGFudExlYXZlQ29tbWFuZFJlY2VpdmVkKHRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IsIG5ldyBQYXJ0aWNpcGFudEV2ZW50QXJncyhsZWF2aW5nUGFydGljaXBhbnQsIHNlc3Npb25JZCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAnRGlzY29ubmVjdFNlc3Npb24nIGlzIHNlbnQgd2hlbiBhIHVzZXIgaXMgZGlzY29ubmVjdGVkIGZyb20gdGhlIHNlc3Npb24gKGUuZy4gbmV0d29yayBwcm9ibGVtKS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ2hlY2sgdGhlICdQYXJ0aWNpcGFudElkJyB0byBjaGVjayB3aGV0aGVyIHRoZSBtZXNzYWdlIGlzIGZvciB0aGUgY3VycmVudCB1c2VyLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImRpc2Nvbm5lY3RzZXNzaW9uXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkaXNjb25uZWN0UGFydGljaXBhbnQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGNvbW1hbmRQYXlsb2FkLnBhcnRpY2lwYW50SWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInRva2VuXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0b2tlbiA9IG5ldyBDb2duaXRpdmVUb2tlbkF1dGhlbnRpY2F0aW9uKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhdXRob3JpemF0aW9uVG9rZW4gPSBjb21tYW5kUGF5bG9hZC50b2tlbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGF1dGhvcml6YXRpb25Ub2tlbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXV0aG9yaXphdGlvblRva2VuID0gY29tbWFuZFBheWxvYWQudG9rZW47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShhdXRob3JpemF0aW9uVG9rZW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmF1dGhlbnRpY2F0aW9uID0gdG9rZW47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIE1lc3NhZ2Ugbm90IHJlY29nbml6ZWQuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAgICAgKiAncGFydGlhbCcgKG9yICdoeXBvdGhlc2lzJykgcmVwcmVzZW50cyBhIHVuZmluYWxpemVkIHNwZWVjaCBtZXNzYWdlLlxuICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwicGFydGlhbFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAgICAgKiAnZmluYWwnIChvciAncGhyYXNlJykgcmVwcmVzZW50cyBhIGZpbmFsaXplZCBzcGVlY2ggbWVzc2FnZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImZpbmFsXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3BlZWNoUGF5bG9hZCA9IFNwZWVjaFJlc3BvbnNlUGF5bG9hZC5mcm9tSlNPTihtZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25SZXN1bHRSZWFzb24gPSAoY29udmVyc2F0aW9uTWVzc2FnZVR5cGUgPT09IFwiZmluYWxcIikgPyBSZXN1bHRSZWFzb24uVHJhbnNsYXRlZFBhcnRpY2lwYW50U3BlZWNoIDogUmVzdWx0UmVhc29uLlRyYW5zbGF0aW5nUGFydGljaXBhbnRTcGVlY2g7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3BlZWNoUmVzdWx0ID0gbmV3IENvbnZlcnNhdGlvblRyYW5zbGF0aW9uUmVzdWx0KHNwZWVjaFBheWxvYWQucGFydGljaXBhbnRJZCwgdGhpcy5nZXRUcmFuc2xhdGlvbnMoc3BlZWNoUGF5bG9hZC50cmFuc2xhdGlvbnMpLCBzcGVlY2hQYXlsb2FkLmxhbmd1YWdlLCBzcGVlY2hQYXlsb2FkLmlkLCBjb252ZXJzYXRpb25SZXN1bHRSZWFzb24sIHNwZWVjaFBheWxvYWQucmVjb2duaXRpb24sIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBtZXNzYWdlLnRleHRCb2R5LCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzcGVlY2hQYXlsb2FkLmlzRmluYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgdGhlIGxlbmd0aCwgc29tZXRpbWVzIGVtcHR5IGZpbmFscyBhcmUgcmV0dXJuZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNwZWVjaFJlc3VsdC50ZXh0ICE9PSB1bmRlZmluZWQgJiYgc3BlZWNoUmVzdWx0LnRleHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VuZEZpbmFsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChzcGVlY2hQYXlsb2FkLmlkID09PSB0aGlzLnByaXZMYXN0UGFydGlhbFV0dGVyYW5jZUlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZW5kIGZpbmFsIGFzIG5vcm1hbC4gV2UgaGFkIGEgbm9uLWVtcHR5IHBhcnRpYWwgZm9yIHRoaXMgc2FtZSB1dHRlcmFuY2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNvIHNlbmRpbmcgdGhlIGVtcHR5IGZpbmFsIGlzIGltcG9ydGFudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VuZEZpbmFsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN1cHByZXNzIHVubmVlZGVkIGZpbmFsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbmRGaW5hbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci50cmFuc2xhdGlvblJlY2VpdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci50cmFuc2xhdGlvblJlY2VpdmVkKHRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IsIG5ldyBDb252ZXJzYXRpb25SZWNlaXZlZFRyYW5zbGF0aW9uRXZlbnRBcmdzKENvbnZlcnNhdGlvblRyYW5zbGF0b3JNZXNzYWdlVHlwZXMuZmluYWwsIHNwZWVjaFJlc3VsdCwgc2Vzc2lvbklkKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoc3BlZWNoUmVzdWx0LnRleHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZMYXN0UGFydGlhbFV0dGVyYW5jZUlkID0gc3BlZWNoUGF5bG9hZC5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci50cmFuc2xhdGlvblJlY2VpdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLnRyYW5zbGF0aW9uUmVjZWl2ZWQodGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3RvciwgbmV3IENvbnZlcnNhdGlvblJlY2VpdmVkVHJhbnNsYXRpb25FdmVudEFyZ3MoQ29udmVyc2F0aW9uVHJhbnNsYXRvck1lc3NhZ2VUeXBlcy5wYXJ0aWFsLCBzcGVlY2hSZXN1bHQsIHNlc3Npb25JZCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAgICAgKiBcInRyYW5zbGF0ZWRfbWVzc2FnZVwiIGlzIGEgdGV4dCBtZXNzYWdlIG9yIGluc3RhbnQgbWVzc2FnZSAoSU0pLlxuICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwidHJhbnNsYXRlZF9tZXNzYWdlXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dFBheWxvYWQgPSBUZXh0UmVzcG9uc2VQYXlsb2FkLmZyb21KU09OKG1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IChOYXRpdmUgcGFyaXR5KSBhIHJlc3VsdCByZWFzb24gc2hvdWxkIGJlIHNldCBiYXNlZCB3aGV0aGVyIHRoZSBwYXJ0aWNpcGFudElkIGlzIG91cnMgb3Igbm90XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dFJlc3VsdCA9IG5ldyBDb252ZXJzYXRpb25UcmFuc2xhdGlvblJlc3VsdCh0ZXh0UGF5bG9hZC5wYXJ0aWNpcGFudElkLCB0aGlzLmdldFRyYW5zbGF0aW9ucyh0ZXh0UGF5bG9hZC50cmFuc2xhdGlvbnMpLCB0ZXh0UGF5bG9hZC5sYW5ndWFnZSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHRleHRQYXlsb2FkLm9yaWdpbmFsVGV4dCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgbWVzc2FnZS50ZXh0Qm9keSwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLnRyYW5zbGF0aW9uUmVjZWl2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci50cmFuc2xhdGlvblJlY2VpdmVkKHRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IsIG5ldyBDb252ZXJzYXRpb25SZWNlaXZlZFRyYW5zbGF0aW9uRXZlbnRBcmdzKENvbnZlcnNhdGlvblRyYW5zbGF0b3JNZXNzYWdlVHlwZXMuaW5zdGFudE1lc3NhZ2UsIHRleHRSZXN1bHQsIHNlc3Npb25JZCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWdub3JlIGFueSB1bnN1cHBvcnRlZCBtZXNzYWdlIHR5cGVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY29udGludWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVjZWl2ZUNvbnZlcnNhdGlvbk1lc3NhZ2VPdmVycmlkZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZU1lc3NhZ2VMb29wID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb21tdW5pY2F0aW9uQ3VzdG9kaWFuLnByb21pc2U7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzdGFydE1lc3NhZ2VMb29wKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNEaXNwb3NlZCgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy50ZXJtaW5hdGVNZXNzYWdlTG9vcCA9IGZhbHNlO1xuICAgICAgICAgICAgY29uc3QgbWVzc2FnZVJldHJpZXZhbFByb21pc2UgPSB0aGlzLnJlY2VpdmVDb252ZXJzYXRpb25NZXNzYWdlT3ZlcnJpZGUoKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHlpZWxkIG1lc3NhZ2VSZXRyaWV2YWxQcm9taXNlO1xuICAgICAgICAgICAgICAgIHJldHVybiByO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYW5jZWxSZWNvZ25pdGlvbih0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbiA/IHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCA6IFwiXCIsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uID8gdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkIDogXCJcIiwgQ2FuY2VsbGF0aW9uUmVhc29uLkVycm9yLCBDYW5jZWxsYXRpb25FcnJvckNvZGUuUnVudGltZUVycm9yLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvLyBUYWtlcyBhbiBlc3RhYmxpc2hlZCB3ZWJzb2NrZXQgY29ubmVjdGlvbiB0byB0aGUgZW5kcG9pbnRcbiAgICBjb25maWdDb25uZWN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5pc0Rpc3Bvc2VkKCkpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodW5kZWZpbmVkKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ1Byb21pc2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWdQcm9taXNlLnRoZW4oKGNvbm5lY3Rpb24pID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbi5zdGF0ZSgpID09PSBDb25uZWN0aW9uU3RhdGUuRGlzY29ubmVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25JZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWdQcm9taXNlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25maWdDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlnUHJvbWlzZTtcbiAgICAgICAgICAgIH0sICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uSWQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWdQcm9taXNlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbmZpZ0Nvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnRlcm1pbmF0ZU1lc3NhZ2VMb29wKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHVuZGVmaW5lZCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ1Byb21pc2UgPSB0aGlzLmNvbm5lY3RJbXBsKCkudGhlbigoY29ubmVjdGlvbikgPT4gY29ubmVjdGlvbik7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlnUHJvbWlzZTtcbiAgICB9XG4gICAgZ2V0VHJhbnNsYXRpb25zKHNlcnZpY2VSZXN1bHRUcmFuc2xhdGlvbnMpIHtcbiAgICAgICAgbGV0IHRyYW5zbGF0aW9ucztcbiAgICAgICAgaWYgKHVuZGVmaW5lZCAhPT0gc2VydmljZVJlc3VsdFRyYW5zbGF0aW9ucykge1xuICAgICAgICAgICAgdHJhbnNsYXRpb25zID0gbmV3IFRyYW5zbGF0aW9ucygpO1xuICAgICAgICAgICAgZm9yIChjb25zdCB0cmFuc2xhdGlvbiBvZiBzZXJ2aWNlUmVzdWx0VHJhbnNsYXRpb25zKSB7XG4gICAgICAgICAgICAgICAgdHJhbnNsYXRpb25zLnNldCh0cmFuc2xhdGlvbi5sYW5nLCB0cmFuc2xhdGlvbi50cmFuc2xhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRyYW5zbGF0aW9ucztcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbnZlcnNhdGlvblNlcnZpY2VBZGFwdGVyLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBQcm94eUluZm8sIFJlc3RDb25maWdCYXNlLCBXZWJzb2NrZXRDb25uZWN0aW9uLCB9IGZyb20gXCIuLi8uLi9jb21tb24uYnJvd3Nlci9FeHBvcnRzXCI7XG5pbXBvcnQgeyBTdHJpbmdVdGlscyB9IGZyb20gXCIuLi8uLi9jb21tb24vU3RyaW5nVXRpbHNcIjtcbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuLi8uLi9zZGsvQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eUlkIH0gZnJvbSBcIi4uLy4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBIZWFkZXJOYW1lcyB9IGZyb20gXCIuLi9IZWFkZXJOYW1lc1wiO1xuaW1wb3J0IHsgUXVlcnlQYXJhbWV0ZXJOYW1lcyB9IGZyb20gXCIuLi9RdWVyeVBhcmFtZXRlck5hbWVzXCI7XG5pbXBvcnQgeyBDb25uZWN0aW9uRmFjdG9yeUJhc2UgfSBmcm9tIFwiLi8uLi9Db25uZWN0aW9uRmFjdG9yeUJhc2VcIjtcbmltcG9ydCB7IFRyYW5zY3JpYmVyQ29ubmVjdGlvbkZhY3RvcnksIFRyYW5zbGF0aW9uQ29ubmVjdGlvbkZhY3RvcnksIFdlYnNvY2tldE1lc3NhZ2VGb3JtYXR0ZXIsIH0gZnJvbSBcIi4vLi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBDb25uZWN0aW9uIGZhY3RvcnkgZm9yIHRoZSBjb252ZXJzYXRpb24gdHJhbnNsYXRvci4gSGFuZGxlcyBjb25uZWN0aW5nIHRvIHRoZSByZWd1bGFyIHRyYW5zbGF0b3IgZW5kcG9pbnQsXG4gKiBhcyB3ZWxsIGFzIHRoZSB2aXJ0dWFsIG1pY3JvcGhvbmUgYXJyYXkgdHJhbnNjcmlwdGlvbiBlbmRwb2ludFxuICovXG5leHBvcnQgY2xhc3MgQ29udmVyc2F0aW9uVHJhbnNsYXRvckNvbm5lY3Rpb25GYWN0b3J5IGV4dGVuZHMgQ29ubmVjdGlvbkZhY3RvcnlCYXNlIHtcbiAgICBjb25zdHJ1Y3Rvcihjb252R2V0dGVyKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKGNvbnZHZXR0ZXIsIFwiY29udkdldHRlclwiKTtcbiAgICAgICAgdGhpcy5wcml2Q29udkdldHRlciA9IGNvbnZHZXR0ZXI7XG4gICAgfVxuICAgIGNyZWF0ZShjb25maWcsIGF1dGhJbmZvLCBjb25uZWN0aW9uSWQpIHtcbiAgICAgICAgY29uc3QgaXNWaXJ0TWljQXJyYXlFbmRwb2ludCA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFwiQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9NdWx0aUNoYW5uZWxBdWRpb1wiLCBcIlwiKS50b1VwcGVyQ2FzZSgpID09PSBcIlRSVUVcIjtcbiAgICAgICAgY29uc3QgY29udkluZm8gPSB0aGlzLnByaXZDb252R2V0dGVyKCkucm9vbTtcbiAgICAgICAgY29uc3QgcmVnaW9uID0gY29udkluZm8uY29nbml0aXZlU3BlZWNoUmVnaW9uIHx8IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVnaW9uLCBcIlwiKTtcbiAgICAgICAgY29uc3QgcmVwbGFjZW1lbnRWYWx1ZXMgPSB7XG4gICAgICAgICAgICBob3N0U3VmZml4OiBDb25uZWN0aW9uRmFjdG9yeUJhc2UuZ2V0SG9zdFN1ZmZpeChyZWdpb24pLFxuICAgICAgICAgICAgcGF0aDogQ29udmVyc2F0aW9uVHJhbnNsYXRvckNvbm5lY3Rpb25GYWN0b3J5LkNUU19WSVJUX01JQ19QQVRILFxuICAgICAgICAgICAgcmVnaW9uOiBlbmNvZGVVUklDb21wb25lbnQocmVnaW9uKVxuICAgICAgICB9O1xuICAgICAgICByZXBsYWNlbWVudFZhbHVlc1tRdWVyeVBhcmFtZXRlck5hbWVzLkxhbmd1YWdlXSA9IGVuY29kZVVSSUNvbXBvbmVudChjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZSwgXCJcIikpO1xuICAgICAgICByZXBsYWNlbWVudFZhbHVlc1tRdWVyeVBhcmFtZXRlck5hbWVzLkN0c01lZXRpbmdJZF0gPSBlbmNvZGVVUklDb21wb25lbnQoY29udkluZm8ucm9vbUlkKTtcbiAgICAgICAgcmVwbGFjZW1lbnRWYWx1ZXNbUXVlcnlQYXJhbWV0ZXJOYW1lcy5DdHNEZXZpY2VJZF0gPSBlbmNvZGVVUklDb21wb25lbnQoY29udkluZm8ucGFydGljaXBhbnRJZCk7XG4gICAgICAgIHJlcGxhY2VtZW50VmFsdWVzW1F1ZXJ5UGFyYW1ldGVyTmFtZXMuQ3RzSXNQYXJ0aWNpcGFudF0gPSBjb252SW5mby5pc0hvc3QgPyBcIlwiIDogKFwiJlwiICsgUXVlcnlQYXJhbWV0ZXJOYW1lcy5DdHNJc1BhcnRpY2lwYW50KTtcbiAgICAgICAgbGV0IGVuZHBvaW50VXJsID0gXCJcIjtcbiAgICAgICAgY29uc3QgcXVlcnlQYXJhbXMgPSB7fTtcbiAgICAgICAgY29uc3QgaGVhZGVycyA9IHt9O1xuICAgICAgICBpZiAoaXNWaXJ0TWljQXJyYXlFbmRwb2ludCkge1xuICAgICAgICAgICAgLy8gY29ubmVjdGluZyB0byB0aGUgY29udmVyc2F0aW9uIHRyYW5zY3JpcHRpb24gdmlydHVhbCBtaWNyb3Bob25lIGFycmF5IGVuZHBvaW50XG4gICAgICAgICAgICBlbmRwb2ludFVybCA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnQpO1xuICAgICAgICAgICAgaWYgKCFlbmRwb2ludFVybCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGhvc3ROYW1lID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Ib3N0LCBcInRyYW5zY3JpYmUue3JlZ2lvbn0uY3RzLnNwZWVjaHtob3N0U3VmZml4fVwiKTtcbiAgICAgICAgICAgICAgICBlbmRwb2ludFVybCA9IFwid3NzOi8vXCIgKyBob3N0TmFtZSArIFwie3BhdGh9XCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBiZWNhdXNlIHRoZSByZWdpb24gY2FuIGNoYW5nZSBkdXJpbmcgYSBzZXNzaW9uLCB3ZSBzdXBwb3J0IGJlaW5nIHBhc3NlZCBhIGZvcm1hdCBzdHJpbmcgd2hpY2ggd2UgY2FuIHRoZW5cbiAgICAgICAgICAgIC8vIHJlcGxhY2Ugd2l0aCB0aGUgY29ycmVjdCBpbmZvcm1hdGlvbi5cbiAgICAgICAgICAgIGVuZHBvaW50VXJsID0gU3RyaW5nVXRpbHMuZm9ybWF0U3RyaW5nKGVuZHBvaW50VXJsLCByZXBsYWNlbWVudFZhbHVlcyk7XG4gICAgICAgICAgICBjb25zdCBwYXJzZWRVcmwgPSBuZXcgVVJMKGVuZHBvaW50VXJsKTtcbiAgICAgICAgICAgIHBhcnNlZFVybC5zZWFyY2hQYXJhbXMuZm9yRWFjaCgodmFsLCBrZXkpID0+IHtcbiAgICAgICAgICAgICAgICBxdWVyeVBhcmFtc1trZXldID0gdmFsO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBjb25uRmFjdG9yeSA9IG5ldyBUcmFuc2NyaWJlckNvbm5lY3Rpb25GYWN0b3J5KCk7XG4gICAgICAgICAgICBjb25uRmFjdG9yeS5zZXRRdWVyeVBhcmFtcyhxdWVyeVBhcmFtcywgY29uZmlnLCBlbmRwb2ludFVybCk7XG4gICAgICAgICAgICAvLyBTb21lIHF1ZXJ5IHBhcmFtZXRlcnMgYXJlIHJlcXVpcmVkIGZvciB0aGUgQ1RTIGVuZHBvaW50LCBsZXQncyBleHBsaWNpdHkgc2V0IHRoZW0gaGVyZVxuICAgICAgICAgICAgcXVlcnlQYXJhbXNbUXVlcnlQYXJhbWV0ZXJOYW1lcy5DdHNNZWV0aW5nSWRdID0gcmVwbGFjZW1lbnRWYWx1ZXNbUXVlcnlQYXJhbWV0ZXJOYW1lcy5DdHNNZWV0aW5nSWRdO1xuICAgICAgICAgICAgcXVlcnlQYXJhbXNbUXVlcnlQYXJhbWV0ZXJOYW1lcy5DdHNEZXZpY2VJZF0gPSByZXBsYWNlbWVudFZhbHVlc1tRdWVyeVBhcmFtZXRlck5hbWVzLkN0c0RldmljZUlkXTtcbiAgICAgICAgICAgIGlmICghY29udkluZm8uaXNIb3N0KSB7XG4gICAgICAgICAgICAgICAgcXVlcnlQYXJhbXNbUXVlcnlQYXJhbWV0ZXJOYW1lcy5DdHNJc1BhcnRpY2lwYW50XSA9IFwiXCI7IC8vIHRoaXMgZG9lc24ndCBoYXZlIGEgdmFsdWUgc28gc2V0IHRvIGFuIGVtcHR5IHN0cmluZ1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCEoUXVlcnlQYXJhbWV0ZXJOYW1lcy5Gb3JtYXQgaW4gcXVlcnlQYXJhbXMpKSB7XG4gICAgICAgICAgICAgICAgcXVlcnlQYXJhbXNbUXVlcnlQYXJhbWV0ZXJOYW1lcy5Gb3JtYXRdID0gXCJzaW1wbGVcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBhcnNlZFVybC5zZWFyY2hQYXJhbXMuZm9yRWFjaCgodmFsLCBrZXkpID0+IHtcbiAgICAgICAgICAgICAgICBwYXJzZWRVcmwuc2VhcmNoUGFyYW1zLnNldChrZXksIHF1ZXJ5UGFyYW1zW2tleV0pO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBxdWVyeVBhcmFtc1trZXldO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBlbmRwb2ludFVybCA9IHBhcnNlZFVybC50b1N0cmluZygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gY29ubmVjdGluZyB0byByZWd1bGFyIHRyYW5zbGF0aW9uIGVuZHBvaW50XG4gICAgICAgICAgICBjb25zdCBjb25uRmFjdG9yeSA9IG5ldyBUcmFuc2xhdGlvbkNvbm5lY3Rpb25GYWN0b3J5KCk7XG4gICAgICAgICAgICBlbmRwb2ludFVybCA9IGNvbm5GYWN0b3J5LmdldEVuZHBvaW50VXJsKGNvbmZpZywgdHJ1ZSk7XG4gICAgICAgICAgICBlbmRwb2ludFVybCA9IFN0cmluZ1V0aWxzLmZvcm1hdFN0cmluZyhlbmRwb2ludFVybCwgcmVwbGFjZW1lbnRWYWx1ZXMpO1xuICAgICAgICAgICAgY29ubkZhY3Rvcnkuc2V0UXVlcnlQYXJhbXMocXVlcnlQYXJhbXMsIGNvbmZpZywgZW5kcG9pbnRVcmwpO1xuICAgICAgICB9XG4gICAgICAgIGhlYWRlcnNbSGVhZGVyTmFtZXMuQ29ubmVjdGlvbklkXSA9IGNvbm5lY3Rpb25JZDtcbiAgICAgICAgaGVhZGVyc1tSZXN0Q29uZmlnQmFzZS5jb25maWdQYXJhbXMudG9rZW5dID0gY29udkluZm8udG9rZW47XG4gICAgICAgIGlmIChhdXRoSW5mby50b2tlbikge1xuICAgICAgICAgICAgaGVhZGVyc1thdXRoSW5mby5oZWFkZXJOYW1lXSA9IGF1dGhJbmZvLnRva2VuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGVuYWJsZUNvbXByZXNzaW9uID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoXCJTUEVFQ0gtRW5hYmxlV2Vic29ja2V0Q29tcHJlc3Npb25cIiwgXCJcIikudG9VcHBlckNhc2UoKSA9PT0gXCJUUlVFXCI7XG4gICAgICAgIHJldHVybiBuZXcgV2Vic29ja2V0Q29ubmVjdGlvbihlbmRwb2ludFVybCwgcXVlcnlQYXJhbXMsIGhlYWRlcnMsIG5ldyBXZWJzb2NrZXRNZXNzYWdlRm9ybWF0dGVyKCksIFByb3h5SW5mby5mcm9tUmVjb2duaXplckNvbmZpZyhjb25maWcpLCBlbmFibGVDb21wcmVzc2lvbiwgY29ubmVjdGlvbklkKTtcbiAgICB9XG59XG5Db252ZXJzYXRpb25UcmFuc2xhdG9yQ29ubmVjdGlvbkZhY3RvcnkuQ1RTX1ZJUlRfTUlDX1BBVEggPSBcIi9zcGVlY2gvcmVjb2duaXRpb24vZHluYW1pY2F1ZGlvXCI7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbnZlcnNhdGlvblRyYW5zbGF0b3JDb25uZWN0aW9uRmFjdG9yeS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyogZXNsaW50LWRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGUgKi9cbmltcG9ydCB7IFNlc3Npb25FdmVudEFyZ3MgfSBmcm9tIFwiLi4vLi4vc2RrL0V4cG9ydHNcIjtcbmV4cG9ydCBjbGFzcyBNdXRlQWxsRXZlbnRBcmdzIGV4dGVuZHMgU2Vzc2lvbkV2ZW50QXJncyB7XG4gICAgY29uc3RydWN0b3IoaXNNdXRlZCwgc2Vzc2lvbklkKSB7XG4gICAgICAgIHN1cGVyKHNlc3Npb25JZCk7XG4gICAgICAgIHRoaXMucHJpdklzTXV0ZWQgPSBpc011dGVkO1xuICAgIH1cbiAgICBnZXQgaXNNdXRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzTXV0ZWQ7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIExvY2tSb29tRXZlbnRBcmdzIGV4dGVuZHMgU2Vzc2lvbkV2ZW50QXJncyB7XG4gICAgY29uc3RydWN0b3IoaXNMb2NrZWQsIHNlc3Npb25JZCkge1xuICAgICAgICBzdXBlcihzZXNzaW9uSWQpO1xuICAgICAgICB0aGlzLnByaXZJc0xvY2tlZCA9IGlzTG9ja2VkO1xuICAgIH1cbiAgICBnZXQgaXNNdXRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzTG9ja2VkO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBQYXJ0aWNpcGFudEV2ZW50QXJncyBleHRlbmRzIFNlc3Npb25FdmVudEFyZ3Mge1xuICAgIGNvbnN0cnVjdG9yKHBhcnRpY2lwYW50LCBzZXNzaW9uSWQpIHtcbiAgICAgICAgc3VwZXIoc2Vzc2lvbklkKTtcbiAgICAgICAgdGhpcy5wcml2UGFydGljaXBhbnQgPSBwYXJ0aWNpcGFudDtcbiAgICB9XG4gICAgZ2V0IHBhcnRpY2lwYW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UGFydGljaXBhbnQ7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFBhcnRpY2lwYW50QXR0cmlidXRlRXZlbnRBcmdzIGV4dGVuZHMgU2Vzc2lvbkV2ZW50QXJncyB7XG4gICAgY29uc3RydWN0b3IocGFydGljaXBhbnRJZCwga2V5LCB2YWx1ZSwgc2Vzc2lvbklkKSB7XG4gICAgICAgIHN1cGVyKHNlc3Npb25JZCk7XG4gICAgICAgIHRoaXMucHJpdktleSA9IGtleTtcbiAgICAgICAgdGhpcy5wcml2VmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5wcml2UGFydGljaXBhbnRJZCA9IHBhcnRpY2lwYW50SWQ7XG4gICAgfVxuICAgIGdldCB2YWx1ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlZhbHVlO1xuICAgIH1cbiAgICBnZXQga2V5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2S2V5O1xuICAgIH1cbiAgICBnZXQgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQYXJ0aWNpcGFudElkO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBQYXJ0aWNpcGFudHNMaXN0RXZlbnRBcmdzIGV4dGVuZHMgU2Vzc2lvbkV2ZW50QXJncyB7XG4gICAgY29uc3RydWN0b3IoY29udmVyc2F0aW9uSWQsIHRva2VuLCB0cmFuc2xhdGVUbywgcHJvZmFuaXR5RmlsdGVyLCByb29tUHJvZmFuaXR5RmlsdGVyLCBpc1Jvb21Mb2NrZWQsIGlzTXV0ZUFsbCwgcGFydGljaXBhbnRzLCBzZXNzaW9uSWQpIHtcbiAgICAgICAgc3VwZXIoc2Vzc2lvbklkKTtcbiAgICAgICAgdGhpcy5wcml2Um9vbUlkID0gY29udmVyc2F0aW9uSWQ7XG4gICAgICAgIHRoaXMucHJpdlNlc3Npb25Ub2tlbiA9IHRva2VuO1xuICAgICAgICB0aGlzLnByaXZUcmFuc2xhdGVUbyA9IHRyYW5zbGF0ZVRvO1xuICAgICAgICB0aGlzLnByaXZQcm9mYW5pdHlGaWx0ZXIgPSBwcm9mYW5pdHlGaWx0ZXI7XG4gICAgICAgIHRoaXMucHJpdlJvb21Qcm9mYW5pdHlGaWx0ZXIgPSByb29tUHJvZmFuaXR5RmlsdGVyO1xuICAgICAgICB0aGlzLnByaXZJc1Jvb21Mb2NrZWQgPSBpc1Jvb21Mb2NrZWQ7XG4gICAgICAgIHRoaXMucHJpdklzUm9vbUxvY2tlZCA9IGlzTXV0ZUFsbDtcbiAgICAgICAgdGhpcy5wcml2UGFydGljaXBhbnRzID0gcGFydGljaXBhbnRzO1xuICAgIH1cbiAgICBnZXQgc2Vzc2lvblRva2VuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U2Vzc2lvblRva2VuO1xuICAgIH1cbiAgICBnZXQgY29udmVyc2F0aW9uSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSb29tSWQ7XG4gICAgfVxuICAgIGdldCB0cmFuc2xhdGVUbygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRyYW5zbGF0ZVRvO1xuICAgIH1cbiAgICBnZXQgcHJvZmFuaXR5RmlsdGVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvZmFuaXR5RmlsdGVyO1xuICAgIH1cbiAgICBnZXQgcm9vbVByb2Zhbml0eUZpbHRlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJvb21Qcm9mYW5pdHlGaWx0ZXI7XG4gICAgfVxuICAgIGdldCBpc1Jvb21Mb2NrZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJc1Jvb21Mb2NrZWQ7XG4gICAgfVxuICAgIGdldCBpc011dGVBbGwoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJc011dGVBbGw7XG4gICAgfVxuICAgIGdldCBwYXJ0aWNpcGFudHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQYXJ0aWNpcGFudHM7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvblJlY2VpdmVkVHJhbnNsYXRpb25FdmVudEFyZ3Mge1xuICAgIGNvbnN0cnVjdG9yKGNvbW1hbmQsIHBheWxvYWQsIHNlc3Npb25JZCkge1xuICAgICAgICB0aGlzLnByaXZQYXlsb2FkID0gcGF5bG9hZDtcbiAgICAgICAgdGhpcy5wcml2Q29tbWFuZCA9IGNvbW1hbmQ7XG4gICAgICAgIHRoaXMucHJpdlNlc3Npb25JZCA9IHNlc3Npb25JZDtcbiAgICB9XG4gICAgZ2V0IHBheWxvYWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQYXlsb2FkO1xuICAgIH1cbiAgICBnZXQgY29tbWFuZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbW1hbmQ7XG4gICAgfVxuICAgIGdldCBzZXNzaW9uSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTZXNzaW9uSWQ7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db252ZXJzYXRpb25UcmFuc2xhdG9yRXZlbnRBcmdzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKiogVXNlcnMgcGFydGljaXBhdGluZyBpbiB0aGUgY29udmVyc2F0aW9uICovXG5leHBvcnQgY2xhc3MgSW50ZXJuYWxQYXJ0aWNpcGFudHMge1xuICAgIGNvbnN0cnVjdG9yKHBhcnRpY2lwYW50cyA9IFtdLCBtZUlkKSB7XG4gICAgICAgIHRoaXMucGFydGljaXBhbnRzID0gcGFydGljaXBhbnRzO1xuICAgICAgICB0aGlzLm1lSWQgPSBtZUlkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGQgb3IgdXBkYXRlIGEgcGFydGljaXBhbnRcbiAgICAgKiBAcGFyYW0gdmFsdWVcbiAgICAgKi9cbiAgICBhZGRPclVwZGF0ZVBhcnRpY2lwYW50KHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZXhpc3RzID0gdGhpcy5nZXRQYXJ0aWNpcGFudEluZGV4KHZhbHVlLmlkKTtcbiAgICAgICAgaWYgKGV4aXN0cyA+IC0xKSB7XG4gICAgICAgICAgICB0aGlzLnBhcnRpY2lwYW50cy5zcGxpY2UoZXhpc3RzLCAxLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnBhcnRpY2lwYW50cy5wdXNoKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBlbnN1cmUgaXQgd2FzIGFkZGVkIG9rXG4gICAgICAgIHJldHVybiB0aGlzLmdldFBhcnRpY2lwYW50KHZhbHVlLmlkKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRmluZCB0aGUgcGFydGljaXBhbnQncyBwb3NpdGlvbiBpbiB0aGUgcGFydGljaXBhbnRzIGxpc3QuXG4gICAgICogQHBhcmFtIGlkXG4gICAgICovXG4gICAgZ2V0UGFydGljaXBhbnRJbmRleChpZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJ0aWNpcGFudHMuZmluZEluZGV4KChwKSA9PiBwLmlkID09PSBpZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZpbmQgdGhlIHBhcnRpY2lwYW50IGJ5IGlkLlxuICAgICAqIEBwYXJhbSBpZFxuICAgICAqL1xuICAgIGdldFBhcnRpY2lwYW50KGlkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcnRpY2lwYW50cy5maW5kKChwKSA9PiBwLmlkID09PSBpZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBhIHBhcnRpY2lwYW50IGZyb20gdGhlIHBhcnRpY2lwYW50cyBsaXN0LlxuICAgICAqL1xuICAgIGRlbGV0ZVBhcnRpY2lwYW50KGlkKSB7XG4gICAgICAgIHRoaXMucGFydGljaXBhbnRzID0gdGhpcy5wYXJ0aWNpcGFudHMuZmlsdGVyKChwKSA9PiBwLmlkICE9PSBpZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEhlbHBlciB0byByZXR1cm4gdGhlIGNvbnZlcnNhdGlvbiBob3N0LlxuICAgICAqL1xuICAgIGdldCBob3N0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJ0aWNpcGFudHMuZmluZCgocCkgPT4gcC5pc0hvc3QgPT09IHRydWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBIZWxwZXIgdG8gcmV0dXJuIHRoZSBjdXJyZW50IHVzZXIuXG4gICAgICovXG4gICAgZ2V0IG1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRQYXJ0aWNpcGFudCh0aGlzLm1lSWQpO1xuICAgIH1cbn1cbi8qKlxuICogTGlzdCBvZiBjb21tYW5kIG1lc3NhZ2UgdHlwZXNcbiAqL1xuZXhwb3J0IGNvbnN0IENvbnZlcnNhdGlvblRyYW5zbGF0b3JNZXNzYWdlVHlwZXMgPSB7XG4gICAgY29tbWFuZDogXCJjb21tYW5kXCIsXG4gICAgZmluYWw6IFwiZmluYWxcIixcbiAgICBpbmZvOiBcImluZm9cIixcbiAgICBpbnN0YW50TWVzc2FnZTogXCJpbnN0YW50X21lc3NhZ2VcIixcbiAgICBrZWVwQWxpdmU6IFwia2VlcF9hbGl2ZVwiLFxuICAgIHBhcnRpYWw6IFwicGFydGlhbFwiLFxuICAgIHBhcnRpY2lwYW50Q29tbWFuZDogXCJwYXJ0aWNpcGFudF9jb21tYW5kXCIsXG4gICAgdHJhbnNsYXRlZE1lc3NhZ2U6IFwidHJhbnNsYXRlZF9tZXNzYWdlXCJcbn07XG4vKipcbiAqIExpc3Qgb2YgY29tbWFuZCB0eXBlc1xuICovXG5leHBvcnQgY29uc3QgQ29udmVyc2F0aW9uVHJhbnNsYXRvckNvbW1hbmRUeXBlcyA9IHtcbiAgICBjaGFuZ2VOaWNrbmFtZTogXCJDaGFuZ2VOaWNrbmFtZVwiLFxuICAgIGRpc2Nvbm5lY3RTZXNzaW9uOiBcIkRpc2Nvbm5lY3RTZXNzaW9uXCIsXG4gICAgZWplY3RQYXJ0aWNpcGFudDogXCJFamVjdFBhcnRpY2lwYW50XCIsXG4gICAgaW5zdGFudF9tZXNzYWdlOiBcImluc3RhbnRfbWVzc2FnZVwiLFxuICAgIGpvaW5TZXNzaW9uOiBcIkpvaW5TZXNzaW9uXCIsXG4gICAgbGVhdmVTZXNzaW9uOiBcIkxlYXZlU2Vzc2lvblwiLFxuICAgIHBhcnRpY2lwYW50TGlzdDogXCJQYXJ0aWNpcGFudExpc3RcIixcbiAgICByb29tRXhwaXJhdGlvbldhcm5pbmc6IFwiUm9vbUV4cGlyYXRpb25XYXJuaW5nXCIsXG4gICAgc2V0TG9ja1N0YXRlOiBcIlNldExvY2tTdGF0ZVwiLFxuICAgIHNldE11dGU6IFwiU2V0TXV0ZVwiLFxuICAgIHNldE11dGVBbGw6IFwiU2V0TXV0ZUFsbFwiLFxuICAgIHNldFByb2Zhbml0eUZpbHRlcmluZzogXCJTZXRQcm9mYW5pdHlGaWx0ZXJpbmdcIixcbiAgICBzZXRUcmFuc2xhdGVUb0xhbmd1YWdlczogXCJTZXRUcmFuc2xhdGVUb0xhbmd1YWdlc1wiLFxuICAgIHNldFVzZVRUUzogXCJTZXRVc2VUVFNcIlxufTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29udmVyc2F0aW9uVHJhbnNsYXRvckludGVyZmFjZXMuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1jbGFzc2VzLXBlci1maWxlXG5pbXBvcnQgeyBSZWNvZ25pemVyQ29uZmlnIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQmFja2dyb3VuZEV2ZW50LCBFdmVudHMsIFRpbWVvdXQgfSBmcm9tIFwiLi4vLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuLi8uLi9zZGsvQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBDb25uZWN0aW9uLCBSZWNvZ25pemVyIH0gZnJvbSBcIi4uLy4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25Db25uZWN0aW9uRmFjdG9yeSB9IGZyb20gXCIuL0NvbnZlcnNhdGlvbkNvbm5lY3Rpb25GYWN0b3J5XCI7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25TZXJ2aWNlQWRhcHRlciB9IGZyb20gXCIuL0NvbnZlcnNhdGlvblNlcnZpY2VBZGFwdGVyXCI7XG5leHBvcnQgY2xhc3MgQ29udmVyc2F0aW9uUmVjb2duaXplckZhY3Rvcnkge1xuICAgIHN0YXRpYyBmcm9tQ29uZmlnKGNvbnZlcnNhdGlvbiwgc3BlZWNoQ29uZmlnLCBhdWRpb0NvbmZpZykge1xuICAgICAgICByZXR1cm4gbmV3IENvbnZlcnNhdGlvblRyYW5zbGF0b3JSZWNvZ25pemVyKGNvbnZlcnNhdGlvbiwgc3BlZWNoQ29uZmlnLCBhdWRpb0NvbmZpZyk7XG4gICAgfVxufVxuLyoqXG4gKiBTZW5kcyBtZXNzYWdlcyB0byB0aGUgQ29udmVyc2F0aW9uIFRyYW5zbGF0b3Igd2Vic29ja2V0IGFuZCBsaXN0ZW5zIGZvciBpbmNvbWluZyBldmVudHMgY29udGFpbmluZyB3ZWJzb2NrZXQgbWVzc2FnZXMuXG4gKiBCYXNlZCBvZmYgdGhlIHJlY29nbml6ZXJzIGluIHRoZSBTREsgZm9sZGVyLlxuICovXG5leHBvcnQgY2xhc3MgQ29udmVyc2F0aW9uVHJhbnNsYXRvclJlY29nbml6ZXIgZXh0ZW5kcyBSZWNvZ25pemVyIHtcbiAgICBjb25zdHJ1Y3Rvcihjb252ZXJzYXRpb24sIHNwZWVjaENvbmZpZywgYXVkaW9Db25maWcpIHtcbiAgICAgICAgY29uc3Qgc2VydmljZUNvbmZpZ0ltcGwgPSBzcGVlY2hDb25maWc7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbChzZXJ2aWNlQ29uZmlnSW1wbCwgXCJzcGVlY2hDb25maWdcIik7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkltcGwgPSBjb252ZXJzYXRpb247XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbChjb252ZXJzYXRpb25JbXBsLCBcImNvbnZlcnNhdGlvbkltcGxcIik7XG4gICAgICAgIHN1cGVyKGF1ZGlvQ29uZmlnLCBzZXJ2aWNlQ29uZmlnSW1wbC5wcm9wZXJ0aWVzLCBuZXcgQ29udmVyc2F0aW9uQ29ubmVjdGlvbkZhY3RvcnkoKSk7XG4gICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvbiA9IGNvbnZlcnNhdGlvbkltcGw7XG4gICAgICAgIHRoaXMucHJpdklzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcyA9IHNlcnZpY2VDb25maWdJbXBsLnByb3BlcnRpZXMuY2xvbmUoKTtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbiA9IENvbm5lY3Rpb24uZnJvbVJlY29nbml6ZXIodGhpcyk7XG4gICAgICAgIHRoaXMucHJpdlNldFRpbWVvdXQgPSAodHlwZW9mIChCbG9iKSAhPT0gXCJ1bmRlZmluZWRcIiAmJiB0eXBlb2YgKFdvcmtlcikgIT09IFwidW5kZWZpbmVkXCIpID8gVGltZW91dC5zZXRUaW1lb3V0IDogc2V0VGltZW91dDtcbiAgICAgICAgdGhpcy5wcml2Q2xlYXJUaW1lb3V0ID0gKHR5cGVvZiAoQmxvYikgIT09IFwidW5kZWZpbmVkXCIgJiYgdHlwZW9mIChXb3JrZXIpICE9PSBcInVuZGVmaW5lZFwiKSA/IFRpbWVvdXQuY2xlYXJUaW1lb3V0IDogY2xlYXJUaW1lb3V0O1xuICAgIH1cbiAgICBzZXQgY29ubmVjdGVkKGNiKSB7XG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb24uY29ubmVjdGVkID0gY2I7XG4gICAgfVxuICAgIHNldCBkaXNjb25uZWN0ZWQoY2IpIHtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbi5kaXNjb25uZWN0ZWQgPSBjYjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBzcGVlY2ggbGFuZ3VhZ2UgdXNlZCBieSB0aGUgcmVjb2duaXplclxuICAgICAqL1xuICAgIGdldCBzcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBwcm9wZXJ0aWVzIGZvciB0aGUgcmVjb2duaXplclxuICAgICAqL1xuICAgIGdldCBwcm9wZXJ0aWVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcztcbiAgICB9XG4gICAgaXNEaXNwb3NlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzRGlzcG9zZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbm5lY3QgdG8gdGhlIHJlY29nbml6ZXJcbiAgICAgKiBAcGFyYW0gdG9rZW5cbiAgICAgKi9cbiAgICBjb25uZWN0KHRva2VuLCBjYiwgZXJyKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdklzRGlzcG9zZWQpO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHRva2VuLCBcInRva2VuXCIpO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVjby5jb252ZXJzYXRpb25UcmFuc2xhdG9yVG9rZW4gPSB0b2tlbjtcbiAgICAgICAgICAgIHRoaXMucmVzZXRDb252ZXJzYXRpb25UaW1lb3V0KCk7XG4gICAgICAgICAgICB0aGlzLnByaXZSZWNvLmNvbm5lY3RBc3luYyhjYiwgZXJyKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHR5cGVkRXJyb3IgPSBlcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgZXJyKHR5cGVkRXJyb3IubmFtZSArIFwiOiBcIiArIHR5cGVkRXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlcnIoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBEaXNjb25uZWN0IGZyb20gdGhlIHJlY29nbml6ZXJcbiAgICAgKi9cbiAgICBkaXNjb25uZWN0KGNiLCBlcnIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2SXNEaXNwb3NlZCk7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2VGltZW91dFRva2VuICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1hcmd1bWVudFxuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNsZWFyVGltZW91dCh0aGlzLnByaXZUaW1lb3V0VG9rZW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wcml2UmVjby5kaXNjb25uZWN0KCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCEhY2IpIHtcbiAgICAgICAgICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoISFlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHR5cGVkRXJyb3IgPSBlcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgZXJyKHR5cGVkRXJyb3IubmFtZSArIFwiOiBcIiArIHR5cGVkRXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlcnIoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIERlc3Ryb3kgdGhlIHJlY29nbml6ZXIuXG4gICAgICAgICAgICB0aGlzLmRpc3Bvc2UodHJ1ZSkuY2F0Y2goKHJlYXNvbikgPT4ge1xuICAgICAgICAgICAgICAgIEV2ZW50cy5pbnN0YW5jZS5vbkV2ZW50KG5ldyBCYWNrZ3JvdW5kRXZlbnQocmVhc29uKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZW5kIHRoZSBtdXRlIGFsbCBwYXJ0aWNpcGFudHMgY29tbWFuZCB0byB0aGUgd2Vic29ja2V0XG4gICAgICogQHBhcmFtIGNvbnZlcnNhdGlvbklkXG4gICAgICogQHBhcmFtIHBhcnRpY2lwYW50SWRcbiAgICAgKiBAcGFyYW0gaXNNdXRlZFxuICAgICAqL1xuICAgIHNlbmRSZXF1ZXN0KGNvbW1hbmQsIGNiLCBlcnIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2SXNEaXNwb3NlZCk7XG4gICAgICAgICAgICB0aGlzLnNlbmRNZXNzYWdlKGNvbW1hbmQsIGNiLCBlcnIpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdHlwZWRFcnJvciA9IGVycm9yO1xuICAgICAgICAgICAgICAgICAgICBlcnIodHlwZWRFcnJvci5uYW1lICsgXCI6IFwiICsgdHlwZWRFcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGVycihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gRGVzdHJveSB0aGUgcmVjb2duaXplci5cbiAgICAgICAgICAgIHRoaXMuZGlzcG9zZSh0cnVlKS5jYXRjaCgocmVhc29uKSA9PiB7XG4gICAgICAgICAgICAgICAgRXZlbnRzLmluc3RhbmNlLm9uRXZlbnQobmV3IEJhY2tncm91bmRFdmVudChyZWFzb24pKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsb3NlIGFuZCBkaXNwb3NlIHRoZSByZWNvZ25pemVyXG4gICAgICovXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMucHJpdklzRGlzcG9zZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb25uZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb24uY2xvc2VDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb24uY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmRpc3Bvc2UodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEaXNwb3NlIHRoZSByZWNvZ25pemVyXG4gICAgICogQHBhcmFtIGRpc3Bvc2luZ1xuICAgICAqL1xuICAgIGRpc3Bvc2UoZGlzcG9zaW5nKSB7XG4gICAgICAgIGNvbnN0IF9zdXBlciA9IE9iamVjdC5jcmVhdGUobnVsbCwge1xuICAgICAgICAgICAgZGlzcG9zZTogeyBnZXQ6ICgpID0+IHN1cGVyLmRpc3Bvc2UgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZJc0Rpc3Bvc2VkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRpc3Bvc2luZykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnByaXZUaW1lb3V0VG9rZW4gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1hcmd1bWVudFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDbGVhclRpbWVvdXQodGhpcy5wcml2VGltZW91dFRva2VuKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29ubmVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uLmNsb3NlQ29ubmVjdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb24gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHlpZWxkIF9zdXBlci5kaXNwb3NlLmNhbGwodGhpcywgZGlzcG9zaW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZSB0aGUgY29uZmlnIGZvciB0aGUgcmVjb2duaXplclxuICAgICAqIEBwYXJhbSBzcGVlY2hDb25maWdcbiAgICAgKi9cbiAgICBjcmVhdGVSZWNvZ25pemVyQ29uZmlnKHNwZWVjaENvbmZpZykge1xuICAgICAgICByZXR1cm4gbmV3IFJlY29nbml6ZXJDb25maWcoc3BlZWNoQ29uZmlnLCB0aGlzLnByaXZQcm9wZXJ0aWVzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHRoZSBzZXJ2aWNlIHJlY29nbml6ZXIuXG4gICAgICogVGhlIGF1ZGlvIHNvdXJjZSBpcyByZWR1bmRuYW50IGhlcmUgYnV0IGlzIHJlcXVpcmVkIGJ5IHRoZSBpbXBsZW1lbnRhdGlvbi5cbiAgICAgKiBAcGFyYW0gYXV0aGVudGljYXRpb25cbiAgICAgKiBAcGFyYW0gY29ubmVjdGlvbkZhY3RvcnlcbiAgICAgKiBAcGFyYW0gYXVkaW9Db25maWdcbiAgICAgKiBAcGFyYW0gcmVjb2duaXplckNvbmZpZ1xuICAgICAqL1xuICAgIGNyZWF0ZVNlcnZpY2VSZWNvZ25pemVyKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Db25maWcsIHJlY29nbml6ZXJDb25maWcpIHtcbiAgICAgICAgY29uc3QgYXVkaW9Tb3VyY2UgPSBhdWRpb0NvbmZpZztcbiAgICAgICAgcmV0dXJuIG5ldyBDb252ZXJzYXRpb25TZXJ2aWNlQWRhcHRlcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvU291cmNlLCByZWNvZ25pemVyQ29uZmlnLCB0aGlzKTtcbiAgICB9XG4gICAgc2VuZE1lc3NhZ2UobXNnLCBjYiwgZXJyKSB7XG4gICAgICAgIGNvbnN0IHdpdGhBc3luYyA9IHRoaXMucHJpdlJlY287XG4gICAgICAgIGNvbnN0IFByb21pc2VUb0VtcHR5Q2FsbGJhY2sgPSAocHJvbWlzZSwgY2IsIGVycikgPT4ge1xuICAgICAgICAgICAgaWYgKHByb21pc2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHByb21pc2UudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISFjYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNiKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycihgJ1VuaGFuZGxlZCBlcnJvciBvbiBwcm9taXNlIGNhbGxiYWNrOiAke2V9J2ApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgKHJlYXNvbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyKHJlYXNvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZW1wdHlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHsgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycihcIk51bGwgcHJvbWlzZVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2VUb0VtcHR5Q2FsbGJhY2sod2l0aEFzeW5jLnNlbmRNZXNzYWdlQXN5bmMobXNnKSwgY2IsIGVycik7XG4gICAgICAgIHRoaXMucmVzZXRDb252ZXJzYXRpb25UaW1lb3V0KCk7XG4gICAgfVxuICAgIHJlc2V0Q29udmVyc2F0aW9uVGltZW91dCgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdlRpbWVvdXRUb2tlbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1hcmd1bWVudFxuICAgICAgICAgICAgdGhpcy5wcml2Q2xlYXJUaW1lb3V0KHRoaXMucHJpdlRpbWVvdXRUb2tlbik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2VGltZW91dFRva2VuID0gdGhpcy5wcml2U2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KHRoaXMucHJpdkNvbnZlcnNhdGlvbi5nZXRLZWVwQWxpdmUoKSk7XG4gICAgICAgIH0sIDYwMDAwKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbnZlcnNhdGlvblRyYW5zbGF0b3JSZWNvZ25pemVyLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBEZWZlcnJlZCwgTWVzc2FnZVR5cGUsIFJhd1dlYnNvY2tldE1lc3NhZ2UsIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25Db25uZWN0aW9uTWVzc2FnZSB9IGZyb20gXCIuL0NvbnZlcnNhdGlvbkNvbm5lY3Rpb25NZXNzYWdlXCI7XG4vKipcbiAqIEJhc2VkIG9mZiBXZWJzb2NrZXRNZXNzYWdlRm9ybWF0dGVyLiBUaGUgbWVzc2FnZXMgZm9yIENvbnZlcnNhdGlvbiBUcmFuc2xhdG9yIGhhdmUgc29tZSB2YXJpYXRpb25zIGZyb20gdGhlIFNwZWVjaCBtZXNzYWdlcy5cbiAqL1xuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvbldlYnNvY2tldE1lc3NhZ2VGb3JtYXR0ZXIge1xuICAgIC8qKlxuICAgICAqIEZvcm1hdCBpbmNvbWluZyBtZXNzYWdlczogdGV4dCAoc3BlZWNoIHBhcnRpYWwvZmluYWwsIElNKSBvciBiaW5hcnkgKHR0cylcbiAgICAgKi9cbiAgICB0b0Nvbm5lY3Rpb25NZXNzYWdlKG1lc3NhZ2UpIHtcbiAgICAgICAgY29uc3QgZGVmZXJyYWwgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlLm1lc3NhZ2VUeXBlID09PSBNZXNzYWdlVHlwZS5UZXh0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5jb21pbmdNZXNzYWdlID0gbmV3IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25NZXNzYWdlKG1lc3NhZ2UubWVzc2FnZVR5cGUsIG1lc3NhZ2UudGV4dENvbnRlbnQsIHt9LCBtZXNzYWdlLmlkKTtcbiAgICAgICAgICAgICAgICBkZWZlcnJhbC5yZXNvbHZlKGluY29taW5nTWVzc2FnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChtZXNzYWdlLm1lc3NhZ2VUeXBlID09PSBNZXNzYWdlVHlwZS5CaW5hcnkpIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJhbC5yZXNvbHZlKG5ldyBDb252ZXJzYXRpb25Db25uZWN0aW9uTWVzc2FnZShtZXNzYWdlLm1lc3NhZ2VUeXBlLCBtZXNzYWdlLmJpbmFyeUNvbnRlbnQsIHVuZGVmaW5lZCwgbWVzc2FnZS5pZCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBkZWZlcnJhbC5yZWplY3QoYEVycm9yIGZvcm1hdHRpbmcgdGhlIG1lc3NhZ2UuIEVycm9yOiAke2V9YCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRlZmVycmFsLnByb21pc2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvcm1hdCBvdXRnb2luZyBtZXNzYWdlczogdGV4dCAoY29tbWFuZHMgb3IgSU0pXG4gICAgICovXG4gICAgZnJvbUNvbm5lY3Rpb25NZXNzYWdlKG1lc3NhZ2UpIHtcbiAgICAgICAgY29uc3QgZGVmZXJyYWwgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlLm1lc3NhZ2VUeXBlID09PSBNZXNzYWdlVHlwZS5UZXh0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGF5bG9hZCA9IGAke21lc3NhZ2UudGV4dEJvZHkgPyBtZXNzYWdlLnRleHRCb2R5IDogXCJcIn1gO1xuICAgICAgICAgICAgICAgIGRlZmVycmFsLnJlc29sdmUobmV3IFJhd1dlYnNvY2tldE1lc3NhZ2UoTWVzc2FnZVR5cGUuVGV4dCwgcGF5bG9hZCwgbWVzc2FnZS5pZCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBkZWZlcnJhbC5yZWplY3QoYEVycm9yIGZvcm1hdHRpbmcgdGhlIG1lc3NhZ2UuICR7ZX1gKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGVmZXJyYWwucHJvbWlzZTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbnZlcnNhdGlvbldlYnNvY2tldE1lc3NhZ2VGb3JtYXR0ZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmV4cG9ydCB7IENvbnZlcnNhdGlvbk1hbmFnZXIgfSBmcm9tIFwiLi9Db252ZXJzYXRpb25NYW5hZ2VyXCI7XG5leHBvcnQgeyBDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnIH0gZnJvbSBcIi4vQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZ1wiO1xuZXhwb3J0IHsgQ29udmVyc2F0aW9uUmVjb2duaXplckZhY3RvcnkgfSBmcm9tIFwiLi9Db252ZXJzYXRpb25UcmFuc2xhdG9yUmVjb2duaXplclwiO1xuZXhwb3J0IHsgVHJhbnNjcmliZXJSZWNvZ25pemVyIH0gZnJvbSBcIi4vVHJhbnNjcmliZXJSZWNvZ25pemVyXCI7XG5leHBvcnQgeyBDb252ZXJzYXRpb25SZWNlaXZlZFRyYW5zbGF0aW9uRXZlbnRBcmdzLCBMb2NrUm9vbUV2ZW50QXJncywgTXV0ZUFsbEV2ZW50QXJncywgUGFydGljaXBhbnRBdHRyaWJ1dGVFdmVudEFyZ3MsIFBhcnRpY2lwYW50RXZlbnRBcmdzLCBQYXJ0aWNpcGFudHNMaXN0RXZlbnRBcmdzIH0gZnJvbSBcIi4vQ29udmVyc2F0aW9uVHJhbnNsYXRvckV2ZW50QXJnc1wiO1xuZXhwb3J0IHsgQ29udmVyc2F0aW9uVHJhbnNsYXRvckNvbW1hbmRUeXBlcywgQ29udmVyc2F0aW9uVHJhbnNsYXRvck1lc3NhZ2VUeXBlcywgSW50ZXJuYWxQYXJ0aWNpcGFudHMgfSBmcm9tIFwiLi9Db252ZXJzYXRpb25UcmFuc2xhdG9ySW50ZXJmYWNlc1wiO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1FeHBvcnRzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5jb25zdCBwYXJzZUNvbW1hbmRSZXNwb25zZSA9IChqc29uKSA9PiBKU09OLnBhcnNlKGpzb24pO1xuZXhwb3J0IGNsYXNzIENvbW1hbmRSZXNwb25zZVBheWxvYWQge1xuICAgIGNvbnN0cnVjdG9yKGpzb24pIHtcbiAgICAgICAgdGhpcy5wcml2Q29tbWFuZFJlc3BvbnNlID0gcGFyc2VDb21tYW5kUmVzcG9uc2UoanNvbik7XG4gICAgfVxuICAgIGdldCB0eXBlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29tbWFuZFJlc3BvbnNlLnR5cGU7XG4gICAgfVxuICAgIGdldCBjb21tYW5kKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29tbWFuZFJlc3BvbnNlLmNvbW1hbmQ7XG4gICAgfVxuICAgIGdldCBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbW1hbmRSZXNwb25zZS5pZDtcbiAgICB9XG4gICAgZ2V0IG5pY2tuYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29tbWFuZFJlc3BvbnNlLm5pY2tuYW1lO1xuICAgIH1cbiAgICBnZXQgcGFydGljaXBhbnRJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbW1hbmRSZXNwb25zZS5wYXJ0aWNpcGFudElkO1xuICAgIH1cbiAgICBnZXQgcm9vbWlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29tbWFuZFJlc3BvbnNlLnJvb21pZDtcbiAgICB9XG4gICAgZ2V0IHZhbHVlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29tbWFuZFJlc3BvbnNlLnZhbHVlO1xuICAgIH1cbiAgICBnZXQgdG9rZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb21tYW5kUmVzcG9uc2UudG9rZW47XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIHJldHVybiBuZXcgQ29tbWFuZFJlc3BvbnNlUGF5bG9hZChqc29uKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbW1hbmRSZXNwb25zZVBheWxvYWQuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmNvbnN0IHBhcnNlTGlzdFJlc3BvbnNlID0gKGpzb24pID0+IEpTT04ucGFyc2UoanNvbik7XG5jb25zdCBwYXJzZVBhcnRpY2lwYW50UmVzcG9uc2UgPSAoanNvbikgPT4gSlNPTi5wYXJzZShqc29uKTtcbmV4cG9ydCBjbGFzcyBQYXJ0aWNpcGFudHNMaXN0UGF5bG9hZFJlc3BvbnNlIHtcbiAgICBjb25zdHJ1Y3Rvcihqc29uKSB7XG4gICAgICAgIHRoaXMucHJpdlBhcnRpY2lwYW50c1BheWxvYWRSZXNwb25zZSA9IHBhcnNlTGlzdFJlc3BvbnNlKGpzb24pO1xuICAgIH1cbiAgICBnZXQgcm9vbWlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UGFydGljaXBhbnRzUGF5bG9hZFJlc3BvbnNlLnJvb21pZDtcbiAgICB9XG4gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UGFydGljaXBhbnRzUGF5bG9hZFJlc3BvbnNlLmlkO1xuICAgIH1cbiAgICBnZXQgY29tbWFuZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhcnRpY2lwYW50c1BheWxvYWRSZXNwb25zZS5jb21tYW5kO1xuICAgIH1cbiAgICBnZXQgcGFydGljaXBhbnRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UGFydGljaXBhbnRzUGF5bG9hZFJlc3BvbnNlLnBhcnRpY2lwYW50cztcbiAgICB9XG4gICAgZ2V0IHRva2VuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UGFydGljaXBhbnRzUGF5bG9hZFJlc3BvbnNlLnRva2VuO1xuICAgIH1cbiAgICBnZXQgdHJhbnNsYXRlVG8oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQYXJ0aWNpcGFudHNQYXlsb2FkUmVzcG9uc2UudHJhbnNsYXRlVG87XG4gICAgfVxuICAgIGdldCBwcm9mYW5pdHlGaWx0ZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQYXJ0aWNpcGFudHNQYXlsb2FkUmVzcG9uc2UucHJvZmFuaXR5RmlsdGVyO1xuICAgIH1cbiAgICBnZXQgcm9vbVByb2Zhbml0eUZpbHRlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhcnRpY2lwYW50c1BheWxvYWRSZXNwb25zZS5yb29tUHJvZmFuaXR5RmlsdGVyO1xuICAgIH1cbiAgICBnZXQgcm9vbUxvY2tlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhcnRpY2lwYW50c1BheWxvYWRSZXNwb25zZS5yb29tTG9ja2VkO1xuICAgIH1cbiAgICBnZXQgbXV0ZUFsbCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhcnRpY2lwYW50c1BheWxvYWRSZXNwb25zZS5tdXRlQWxsO1xuICAgIH1cbiAgICBnZXQgdHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhcnRpY2lwYW50c1BheWxvYWRSZXNwb25zZS50eXBlO1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbUpTT04oanNvbikge1xuICAgICAgICByZXR1cm4gbmV3IFBhcnRpY2lwYW50c0xpc3RQYXlsb2FkUmVzcG9uc2UoanNvbik7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFBhcnRpY2lwYW50UGF5bG9hZFJlc3BvbnNlIHtcbiAgICBjb25zdHJ1Y3Rvcihqc29uKSB7XG4gICAgICAgIHRoaXMucHJpdlBhcnRpY2lwYW50UGF5bG9hZFJlc3BvbnNlID0gcGFyc2VQYXJ0aWNpcGFudFJlc3BvbnNlKGpzb24pO1xuICAgIH1cbiAgICBnZXQgbmlja25hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQYXJ0aWNpcGFudFBheWxvYWRSZXNwb25zZS5uaWNrbmFtZTtcbiAgICB9XG4gICAgZ2V0IGxvY2FsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhcnRpY2lwYW50UGF5bG9hZFJlc3BvbnNlLmxvY2FsZTtcbiAgICB9XG4gICAgZ2V0IHVzZXR0cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhcnRpY2lwYW50UGF5bG9hZFJlc3BvbnNlLnVzZXR0cztcbiAgICB9XG4gICAgZ2V0IGlzbXV0ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQYXJ0aWNpcGFudFBheWxvYWRSZXNwb25zZS5pc211dGVkO1xuICAgIH1cbiAgICBnZXQgaXNob3N0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UGFydGljaXBhbnRQYXlsb2FkUmVzcG9uc2UuaXNob3N0O1xuICAgIH1cbiAgICBnZXQgcGFydGljaXBhbnRJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhcnRpY2lwYW50UGF5bG9hZFJlc3BvbnNlLnBhcnRpY2lwYW50SWQ7XG4gICAgfVxuICAgIGdldCBhdmF0YXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQYXJ0aWNpcGFudFBheWxvYWRSZXNwb25zZS5hdmF0YXI7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIHJldHVybiBuZXcgUGFydGljaXBhbnRQYXlsb2FkUmVzcG9uc2UoanNvbik7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1QYXJ0aWNpcGFudFJlc3BvbnNlUGF5bG9hZC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuY29uc3QgcGFyc2VTcGVlY2hSZXNwb25zZSA9IChqc29uKSA9PiBKU09OLnBhcnNlKGpzb24pO1xuY29uc3QgcGFyc2VUZXh0UmVzcG9uc2UgPSAoanNvbikgPT4gSlNPTi5wYXJzZShqc29uKTtcbmV4cG9ydCBjbGFzcyBTcGVlY2hSZXNwb25zZVBheWxvYWQge1xuICAgIGNvbnN0cnVjdG9yKGpzb24pIHtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoUmVzcG9uc2UgPSBwYXJzZVNwZWVjaFJlc3BvbnNlKGpzb24pO1xuICAgIH1cbiAgICBnZXQgcmVjb2duaXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hSZXNwb25zZS5yZWNvZ25pdGlvbjtcbiAgICB9XG4gICAgZ2V0IHRyYW5zbGF0aW9ucygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaFJlc3BvbnNlLnRyYW5zbGF0aW9ucztcbiAgICB9XG4gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoUmVzcG9uc2UuaWQ7XG4gICAgfVxuICAgIGdldCBsYW5ndWFnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaFJlc3BvbnNlLmxhbmd1YWdlO1xuICAgIH1cbiAgICBnZXQgbmlja25hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hSZXNwb25zZS5uaWNrbmFtZTtcbiAgICB9XG4gICAgZ2V0IHBhcnRpY2lwYW50SWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hSZXNwb25zZS5wYXJ0aWNpcGFudElkO1xuICAgIH1cbiAgICBnZXQgcm9vbWlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoUmVzcG9uc2Uucm9vbWlkO1xuICAgIH1cbiAgICBnZXQgdGltZXN0YW1wKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoUmVzcG9uc2UudGltZXN0YW1wO1xuICAgIH1cbiAgICBnZXQgdHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaFJlc3BvbnNlLnR5cGU7XG4gICAgfVxuICAgIGdldCBpc0ZpbmFsKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoUmVzcG9uc2UudHlwZSA9PT0gXCJmaW5hbFwiO1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbUpTT04oanNvbikge1xuICAgICAgICByZXR1cm4gbmV3IFNwZWVjaFJlc3BvbnNlUGF5bG9hZChqc29uKTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgVGV4dFJlc3BvbnNlUGF5bG9hZCB7XG4gICAgY29uc3RydWN0b3IoanNvbikge1xuICAgICAgICB0aGlzLnByaXZUZXh0UmVzcG9uc2UgPSBwYXJzZVRleHRSZXNwb25zZShqc29uKTtcbiAgICB9XG4gICAgZ2V0IG9yaWdpbmFsVGV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRleHRSZXNwb25zZS5vcmlnaW5hbFRleHQ7XG4gICAgfVxuICAgIGdldCB0cmFuc2xhdGlvbnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUZXh0UmVzcG9uc2UudHJhbnNsYXRpb25zO1xuICAgIH1cbiAgICBnZXQgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUZXh0UmVzcG9uc2UuaWQ7XG4gICAgfVxuICAgIGdldCBsYW5ndWFnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRleHRSZXNwb25zZS5sYW5ndWFnZTtcbiAgICB9XG4gICAgZ2V0IG5pY2tuYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VGV4dFJlc3BvbnNlLm5pY2tuYW1lO1xuICAgIH1cbiAgICBnZXQgcGFydGljaXBhbnRJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRleHRSZXNwb25zZS5wYXJ0aWNpcGFudElkO1xuICAgIH1cbiAgICBnZXQgcm9vbWlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VGV4dFJlc3BvbnNlLnJvb21pZDtcbiAgICB9XG4gICAgZ2V0IHRpbWVzdGFtcCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRleHRSZXNwb25zZS50aW1lc3RhbXA7XG4gICAgfVxuICAgIGdldCB0eXBlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VGV4dFJlc3BvbnNlLnR5cGU7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIHJldHVybiBuZXcgVGV4dFJlc3BvbnNlUGF5bG9hZChqc29uKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVRyYW5zbGF0aW9uUmVzcG9uc2VQYXlsb2FkLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCB7IG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3MgfSBmcm9tIFwiLi4vLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuLi8uLi9zZGsvQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eUlkLCBSZWNvZ25pemVyLCB9IGZyb20gXCIuLi8uLi9zZGsvRXhwb3J0c1wiO1xuaW1wb3J0IHsgUmVjb2duaXRpb25Nb2RlLCBSZWNvZ25pemVyQ29uZmlnLCBUcmFuc2NyaWJlckNvbm5lY3Rpb25GYWN0b3J5LCBUcmFuc2NyaXB0aW9uU2VydmljZVJlY29nbml6ZXIsIH0gZnJvbSBcIi4uL0V4cG9ydHNcIjtcbmV4cG9ydCBjbGFzcyBUcmFuc2NyaWJlclJlY29nbml6ZXIgZXh0ZW5kcyBSZWNvZ25pemVyIHtcbiAgICAvKipcbiAgICAgKiBUcmFuc2NyaWJlclJlY29nbml6ZXIgY29uc3RydWN0b3IuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ30gc3BlZWNoVHJhbnNsYXRpb25Db25maWcgLSBOb24tYXVkaW8gY29uZmlndXJhdGlvbiBhc3NvY2lhdGVkIHdpdGggdGhlIHJlY29nbml6ZXJcbiAgICAgKiBAcGFyYW0ge0F1ZGlvQ29uZmlnfSBhdWRpb0NvbmZpZyAtIEFuIGF1ZGlvIGNvbmZpZ3VyYXRpb24gYXNzb2NpYXRlZCB3aXRoIHRoZSByZWNvZ25pemVyXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc3BlZWNoVHJhbnNsYXRpb25Db25maWcsIGF1ZGlvQ29uZmlnKSB7XG4gICAgICAgIGNvbnN0IHNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbCA9IHNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGwoc3BlZWNoVHJhbnNsYXRpb25Db25maWdJbXBsLCBcInNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnXCIpO1xuICAgICAgICBjb25zdCBhdWRpb0NvbmZpZ0ltcGwgPSBhdWRpb0NvbmZpZztcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsKGF1ZGlvQ29uZmlnSW1wbCwgXCJhdWRpb0NvbmZpZ0ltcGxcIik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShzcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwuc3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZSwgUHJvcGVydHlJZFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZV0pO1xuICAgICAgICBzdXBlcihhdWRpb0NvbmZpZywgc3BlZWNoVHJhbnNsYXRpb25Db25maWdJbXBsLnByb3BlcnRpZXMsIG5ldyBUcmFuc2NyaWJlckNvbm5lY3Rpb25GYWN0b3J5KCkpO1xuICAgICAgICB0aGlzLnByaXZEaXNwb3NlZFJlY29nbml6ZXIgPSBmYWxzZTtcbiAgICB9XG4gICAgZ2V0IHNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2UoKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWRSZWNvZ25pemVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZSk7XG4gICAgfVxuICAgIGdldCBwcm9wZXJ0aWVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcztcbiAgICB9XG4gICAgZ2V0IGF1dGhvcml6YXRpb25Ub2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuKTtcbiAgICB9XG4gICAgc2V0IGF1dGhvcml6YXRpb25Ub2tlbih0b2tlbikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodG9rZW4sIFwidG9rZW5cIik7XG4gICAgICAgIHRoaXMucHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuLCB0b2tlbik7XG4gICAgfVxuICAgIHNldCBjb252ZXJzYXRpb24oYykge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChjLCBcIkNvbnZlcnNhdGlvblwiKTtcbiAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uID0gYztcbiAgICB9XG4gICAgZ2V0Q29udmVyc2F0aW9uSW5mbygpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQodGhpcy5wcml2Q29udmVyc2F0aW9uLCBcIkNvbnZlcnNhdGlvblwiKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbnZlcnNhdGlvbi5jb252ZXJzYXRpb25JbmZvO1xuICAgIH1cbiAgICBzdGFydENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLnN0YXJ0Q29udGludW91c1JlY29nbml0aW9uQXN5bmNJbXBsKFJlY29nbml0aW9uTW9kZS5Db252ZXJzYXRpb24pLCBjYiwgZXJyKTtcbiAgICB9XG4gICAgc3RvcENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLnN0b3BDb250aW51b3VzUmVjb2duaXRpb25Bc3luY0ltcGwoKSwgY2IsIGVycik7XG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZEaXNwb3NlZFJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmRpc3Bvc2UodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvLyBQdXNoIGFzeW5jIGpvaW4vbGVhdmUgY29udmVyc2F0aW9uIG1lc3NhZ2UgdmlhIHNlcnZpY2VSZWNvZ25pemVyXG4gICAgcHVzaENvbnZlcnNhdGlvbkV2ZW50KGNvbnZlcnNhdGlvbkluZm8sIGNvbW1hbmQpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlY28gPSAodGhpcy5wcml2UmVjbyk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChyZWNvLCBcInNlcnZpY2VSZWNvZ25pemVyXCIpO1xuICAgICAgICAgICAgeWllbGQgcmVjby5zZW5kU3BlZWNoRXZlbnRBc3luYyhjb252ZXJzYXRpb25JbmZvLCBjb21tYW5kKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVuZm9yY2VBdWRpb0dhdGluZygpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IGF1ZGlvQ29uZmlnSW1wbCA9IHRoaXMuYXVkaW9Db25maWc7XG4gICAgICAgICAgICBjb25zdCBmb3JtYXQgPSB5aWVsZCBhdWRpb0NvbmZpZ0ltcGwuZm9ybWF0O1xuICAgICAgICAgICAgY29uc3QgY2hhbm5lbHMgPSBmb3JtYXQuY2hhbm5lbHM7XG4gICAgICAgICAgICBpZiAoY2hhbm5lbHMgPT09IDEpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFwiZjBmNWRlYmMtZjhjOS00ODkyLWFjNGItOTBhN2FiMzU5ZmQyXCIsIFwiZmFsc2VcIikudG9Mb3dlckNhc2UoKSAhPT0gXCJ0cnVlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU2luZ2xlIGNoYW5uZWwgYXVkaW8gY29uZmlndXJhdGlvbiBmb3IgQ29udmVyc2F0aW9uVHJhbnNjcmliZXIgaXMgY3VycmVudGx5IHVuZGVyIHByaXZhdGUgcHJldmlldywgcGxlYXNlIGNvbnRhY3QgZGlhcml6YXRpb25yZXF1ZXN0QG1pY3Jvc29mdC5jb20gZm9yIG1vcmUgZGV0YWlsc1wiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjaGFubmVscyAhPT0gOCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgYXVkaW8gY29uZmlndXJhdGlvbjogRGV0ZWN0ZWQgJHtjaGFubmVsc30tY2hhbm5lbCBhdWRpb2ApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgY29ubmVjdENhbGxiYWNrcyh0cmFuc2NyaWJlcikge1xuICAgICAgICB0aGlzLmNhbmNlbGVkID0gKHMsIGUpID0+IHtcbiAgICAgICAgICAgIGlmICghIXRyYW5zY3JpYmVyLmNhbmNlbGVkKSB7XG4gICAgICAgICAgICAgICAgdHJhbnNjcmliZXIuY2FuY2VsZWQodHJhbnNjcmliZXIsIGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnJlY29nbml6aW5nID0gKHMsIGUpID0+IHtcbiAgICAgICAgICAgIGlmICghIXRyYW5zY3JpYmVyLnRyYW5zY3JpYmluZykge1xuICAgICAgICAgICAgICAgIHRyYW5zY3JpYmVyLnRyYW5zY3JpYmluZyh0cmFuc2NyaWJlciwgZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucmVjb2duaXplZCA9IChzLCBlKSA9PiB7XG4gICAgICAgICAgICBpZiAoISF0cmFuc2NyaWJlci50cmFuc2NyaWJlZCkge1xuICAgICAgICAgICAgICAgIHRyYW5zY3JpYmVyLnRyYW5zY3JpYmVkKHRyYW5zY3JpYmVyLCBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zZXNzaW9uU3RhcnRlZCA9IChzLCBlKSA9PiB7XG4gICAgICAgICAgICBpZiAoISF0cmFuc2NyaWJlci5zZXNzaW9uU3RhcnRlZCkge1xuICAgICAgICAgICAgICAgIHRyYW5zY3JpYmVyLnNlc3Npb25TdGFydGVkKHRyYW5zY3JpYmVyLCBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zZXNzaW9uU3RvcHBlZCA9IChzLCBlKSA9PiB7XG4gICAgICAgICAgICBpZiAoISF0cmFuc2NyaWJlci5zZXNzaW9uU3RvcHBlZCkge1xuICAgICAgICAgICAgICAgIHRyYW5zY3JpYmVyLnNlc3Npb25TdG9wcGVkKHRyYW5zY3JpYmVyLCBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG4gICAgZGlzY29ubmVjdENhbGxiYWNrcygpIHtcbiAgICAgICAgdGhpcy5jYW5jZWxlZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5yZWNvZ25pemluZyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5yZWNvZ25pemVkID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnNlc3Npb25TdGFydGVkID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnNlc3Npb25TdG9wcGVkID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEaXNwb3NlcyBhbnkgcmVzb3VyY2VzIGhlbGQgYnkgdGhlIG9iamVjdC5cbiAgICAgKiBAbWVtYmVyIENvbnZlcnNhdGlvblRyYW5zY3JpYmVyLnByb3RvdHlwZS5kaXNwb3NlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gZGlzcG9zaW5nIC0gdHJ1ZSBpZiBkaXNwb3NpbmcgdGhlIG9iamVjdC5cbiAgICAgKi9cbiAgICBkaXNwb3NlKGRpc3Bvc2luZykge1xuICAgICAgICBjb25zdCBfc3VwZXIgPSBPYmplY3QuY3JlYXRlKG51bGwsIHtcbiAgICAgICAgICAgIGRpc3Bvc2U6IHsgZ2V0OiAoKSA9PiBzdXBlci5kaXNwb3NlIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2RGlzcG9zZWRSZWNvZ25pemVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRpc3Bvc2luZykge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkRpc3Bvc2VkUmVjb2duaXplciA9IHRydWU7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5pbXBsUmVjb2duaXplclN0b3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHlpZWxkIF9zdXBlci5kaXNwb3NlLmNhbGwodGhpcywgZGlzcG9zaW5nKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNyZWF0ZVJlY29nbml6ZXJDb25maWcoc3BlZWNoQ29uZmlnKSB7XG4gICAgICAgIHJldHVybiBuZXcgUmVjb2duaXplckNvbmZpZyhzcGVlY2hDb25maWcsIHRoaXMucHJvcGVydGllcyk7XG4gICAgfVxuICAgIGNyZWF0ZVNlcnZpY2VSZWNvZ25pemVyKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Db25maWcsIHJlY29nbml6ZXJDb25maWcpIHtcbiAgICAgICAgY29uc3QgY29uZmlnSW1wbCA9IGF1ZGlvQ29uZmlnO1xuICAgICAgICByZXR1cm4gbmV3IFRyYW5zY3JpcHRpb25TZXJ2aWNlUmVjb2duaXplcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGNvbmZpZ0ltcGwsIHJlY29nbml6ZXJDb25maWcsIHRoaXMpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VHJhbnNjcmliZXJSZWNvZ25pemVyLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCB7IE1lc3NhZ2VUeXBlIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDYW5jZWxsYXRpb25FcnJvckNvZGUsIENvbnZlcnNhdGlvblRyYW5zY3JpcHRpb25DYW5jZWxlZEV2ZW50QXJncywgUHJvcGVydHlDb2xsZWN0aW9uLCBQcm9wZXJ0eUlkLCBSZXN1bHRSZWFzb24sIFNwZWVjaFJlY29nbml0aW9uRXZlbnRBcmdzLCBTcGVlY2hSZWNvZ25pdGlvblJlc3VsdCwgfSBmcm9tIFwiLi4vc2RrL0V4cG9ydHNcIjtcbmltcG9ydCB7IENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgQ29udmVyc2F0aW9uU2VydmljZVJlY29nbml6ZXIgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBTcGVlY2hDb25uZWN0aW9uTWVzc2FnZSB9IGZyb20gXCIuL1NwZWVjaENvbm5lY3Rpb25NZXNzYWdlLkludGVybmFsXCI7XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWNsYXNzZXMtcGVyLWZpbGVcbmV4cG9ydCBjbGFzcyBUcmFuc2NyaXB0aW9uU2VydmljZVJlY29nbml6ZXIgZXh0ZW5kcyBDb252ZXJzYXRpb25TZXJ2aWNlUmVjb2duaXplciB7XG4gICAgY29uc3RydWN0b3IoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb1NvdXJjZSwgcmVjb2duaXplckNvbmZpZywgdHJhbnNjcmliZXIpIHtcbiAgICAgICAgc3VwZXIoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb1NvdXJjZSwgcmVjb2duaXplckNvbmZpZywgdHJhbnNjcmliZXIpO1xuICAgICAgICB0aGlzLnByaXZUcmFuc2NyaWJlclJlY29nbml6ZXIgPSB0cmFuc2NyaWJlcjtcbiAgICAgICAgdGhpcy5zZW5kUHJlUGF5bG9hZEpTT05PdmVycmlkZSA9IChjb25uZWN0aW9uKSA9PiB0aGlzLnNlbmRUcmFuc2NyaXB0aW9uU3RhcnRKU09OKGNvbm5lY3Rpb24pO1xuICAgICAgICBpZiAodGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZVJlc3BvbnNlX1JlcXVlc3RXb3JkTGV2ZWxUaW1lc3RhbXBzKSA9PT0gXCJ0cnVlXCIpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaENvbnRleHQuc2V0V29yZExldmVsVGltaW5ncygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNlbmRTcGVlY2hFdmVudEFzeW5jKGluZm8sIGNvbW1hbmQpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmlzUmVjb2duaXppbmcpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0geWllbGQgdGhpcy5mZXRjaENvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnNlbmRTcGVlY2hFdmVudChjb25uZWN0aW9uLCB0aGlzLmNyZWF0ZVNwZWVjaEV2ZW50UGF5bG9hZChpbmZvLCBjb21tYW5kKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBwcm9jZXNzVHlwZVNwZWNpZmljTWVzc2FnZXMoY29ubmVjdGlvbk1lc3NhZ2UpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvY2Vzc1NwZWVjaE1lc3NhZ2VzKGNvbm5lY3Rpb25NZXNzYWdlKTtcbiAgICB9XG4gICAgaGFuZGxlUmVjb2duaXplZENhbGxiYWNrKHJlc3VsdCwgb2Zmc2V0LCBzZXNzaW9uSWQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IFNwZWVjaFJlY29nbml0aW9uRXZlbnRBcmdzKHJlc3VsdCwgb2Zmc2V0LCBzZXNzaW9uSWQpO1xuICAgICAgICAgICAgdGhpcy5wcml2VHJhbnNjcmliZXJSZWNvZ25pemVyLnJlY29nbml6ZWQodGhpcy5wcml2VHJhbnNjcmliZXJSZWNvZ25pemVyLCBldmVudCk7XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2socmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2RXJyb3JDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2RXJyb3JDYWxsYmFjayhlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBPbmx5IGludm9rZSB0aGUgY2FsbCBiYWNrIG9uY2UuXG4gICAgICAgICAgICAgICAgLy8gYW5kIGlmIGl0J3Mgc3VjY2Vzc2Z1bCBkb24ndCBpbnZva2UgdGhlXG4gICAgICAgICAgICAgICAgLy8gZXJyb3IgYWZ0ZXIgdGhhdC5cbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2RXJyb3JDYWxsYmFjayA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBOb3QgZ29pbmcgdG8gbGV0IGVycm9ycyBpbiB0aGUgZXZlbnQgaGFuZGxlclxuICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFuZGxlUmVjb2duaXppbmdDYWxsYmFjayhyZXN1bHQsIGR1cmF0aW9uLCBzZXNzaW9uSWQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGV2ID0gbmV3IFNwZWVjaFJlY29nbml0aW9uRXZlbnRBcmdzKHJlc3VsdCwgZHVyYXRpb24sIHNlc3Npb25JZCk7XG4gICAgICAgICAgICB0aGlzLnByaXZUcmFuc2NyaWJlclJlY29nbml6ZXIucmVjb2duaXppbmcodGhpcy5wcml2VHJhbnNjcmliZXJSZWNvZ25pemVyLCBldik7XG4gICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gTm90IGdvaW5nIHRvIGxldCBlcnJvcnMgaW4gdGhlIGV2ZW50IGhhbmRsZXJcbiAgICAgICAgICAgIC8vIHRyaXAgdGhpbmdzIHVwLlxuICAgICAgICB9XG4gICAgfVxuICAgIC8vIENhbmNlbHMgcmVjb2duaXRpb24uXG4gICAgY2FuY2VsUmVjb2duaXRpb24oc2Vzc2lvbklkLCByZXF1ZXN0SWQsIGNhbmNlbGxhdGlvblJlYXNvbiwgZXJyb3JDb2RlLCBlcnJvcikge1xuICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICBwcm9wZXJ0aWVzLnNldFByb3BlcnR5KENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW2Vycm9yQ29kZV0pO1xuICAgICAgICBpZiAoISF0aGlzLnByaXZUcmFuc2NyaWJlclJlY29nbml6ZXIuY2FuY2VsZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGNhbmNlbEV2ZW50ID0gbmV3IENvbnZlcnNhdGlvblRyYW5zY3JpcHRpb25DYW5jZWxlZEV2ZW50QXJncyhjYW5jZWxsYXRpb25SZWFzb24sIGVycm9yLCBlcnJvckNvZGUsIHVuZGVmaW5lZCwgc2Vzc2lvbklkKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2VHJhbnNjcmliZXJSZWNvZ25pemVyLmNhbmNlbGVkKHRoaXMucHJpdlRyYW5zY3JpYmVyUmVjb2duaXplciwgY2FuY2VsRXZlbnQpO1xuICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoX2EpIHsgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghIXRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjaykge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IFNwZWVjaFJlY29nbml0aW9uUmVzdWx0KHJlcXVlc3RJZCwgUmVzdWx0UmVhc29uLkNhbmNlbGVkLCB1bmRlZmluZWQsIC8vIFRleHRcbiAgICAgICAgICAgIHVuZGVmaW5lZCwgLy8gRHVyYXRpb25cbiAgICAgICAgICAgIHVuZGVmaW5lZCwgLy8gT2Zmc2V0XG4gICAgICAgICAgICB1bmRlZmluZWQsIC8vIExhbmd1YWdlXG4gICAgICAgICAgICB1bmRlZmluZWQsIC8vIExhbmd1YWdlIERldGVjdGlvbiBDb25maWRlbmNlXG4gICAgICAgICAgICB1bmRlZmluZWQsIC8vIFNwZWFrZXIgSWRcbiAgICAgICAgICAgIGVycm9yLCB1bmRlZmluZWQsIC8vIEpzb25cbiAgICAgICAgICAgIHByb3BlcnRpZXMpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2socmVzdWx0KTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChfYikgeyB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gRW5jYXBzdWxhdGVkIGZvciBkZXJpdmVkIHNlcnZpY2UgcmVjb2duaXplcnMgdGhhdCBuZWVkIHRvIHNlbmQgYWRkaXRpb25hbCBKU09OXG4gICAgc2VuZFRyYW5zY3JpcHRpb25TdGFydEpTT04oY29ubmVjdGlvbikge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgeWllbGQgdGhpcy5zZW5kU3BlZWNoQ29udGV4dChjb25uZWN0aW9uLCB0cnVlKTtcbiAgICAgICAgICAgIGNvbnN0IGluZm8gPSB0aGlzLnByaXZUcmFuc2NyaWJlclJlY29nbml6ZXIuZ2V0Q29udmVyc2F0aW9uSW5mbygpO1xuICAgICAgICAgICAgY29uc3QgcGF5bG9hZCA9IHRoaXMuY3JlYXRlU3BlZWNoRXZlbnRQYXlsb2FkKGluZm8sIFwic3RhcnRcIik7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnNlbmRTcGVlY2hFdmVudChjb25uZWN0aW9uLCBwYXlsb2FkKTtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuc2VuZFdhdmVIZWFkZXIoY29ubmVjdGlvbik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZW5kU3BlZWNoRXZlbnQoY29ubmVjdGlvbiwgcGF5bG9hZCkge1xuICAgICAgICBjb25zdCBzcGVlY2hFdmVudEpzb24gPSBKU09OLnN0cmluZ2lmeShwYXlsb2FkKTtcbiAgICAgICAgaWYgKHNwZWVjaEV2ZW50SnNvbikge1xuICAgICAgICAgICAgcmV0dXJuIGNvbm5lY3Rpb24uc2VuZChuZXcgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UoTWVzc2FnZVR5cGUuVGV4dCwgXCJzcGVlY2guZXZlbnRcIiwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBcImFwcGxpY2F0aW9uL2pzb25cIiwgc3BlZWNoRXZlbnRKc29uKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjcmVhdGVTcGVlY2hFdmVudFBheWxvYWQoaW5mbywgY29tbWFuZCkge1xuICAgICAgICBjb25zdCBldmVudERpY3QgPSB7IGlkOiBcIm1lZXRpbmdcIiwgbmFtZTogY29tbWFuZCwgbWVldGluZzogaW5mby5jb252ZXJzYXRpb25Qcm9wZXJ0aWVzIH07XG4gICAgICAgIGV2ZW50RGljdC5tZWV0aW5nLmlkID0gaW5mby5pZDtcbiAgICAgICAgZXZlbnREaWN0Lm1lZXRpbmcuYXR0ZW5kZWVzID0gaW5mby5wYXJ0aWNpcGFudHM7XG4gICAgICAgIGV2ZW50RGljdC5tZWV0aW5nLnJlY29yZCA9IGluZm8uY29udmVyc2F0aW9uUHJvcGVydGllcy5hdWRpb3JlY29yZGluZyA9PT0gXCJvblwiID8gXCJ0cnVlXCIgOiBcImZhbHNlXCI7XG4gICAgICAgIHJldHVybiBldmVudERpY3Q7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1UcmFuc2NyaXB0aW9uU2VydmljZVJlY29nbml6ZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFByb3h5SW5mbywgV2Vic29ja2V0Q29ubmVjdGlvbiwgfSBmcm9tIFwiLi4vY29tbW9uLmJyb3dzZXIvRXhwb3J0c1wiO1xuaW1wb3J0IHsgU3RyaW5nVXRpbHMgfSBmcm9tIFwiLi4vY29tbW9uL1N0cmluZ1V0aWxzXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eUlkIH0gZnJvbSBcIi4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb25uZWN0aW9uRmFjdG9yeUJhc2UgfSBmcm9tIFwiLi9Db25uZWN0aW9uRmFjdG9yeUJhc2VcIjtcbmltcG9ydCB7IFdlYnNvY2tldE1lc3NhZ2VGb3JtYXR0ZXIsIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuaW1wb3J0IHsgSGVhZGVyTmFtZXMgfSBmcm9tIFwiLi9IZWFkZXJOYW1lc1wiO1xuaW1wb3J0IHsgUXVlcnlQYXJhbWV0ZXJOYW1lcyB9IGZyb20gXCIuL1F1ZXJ5UGFyYW1ldGVyTmFtZXNcIjtcbmV4cG9ydCBjbGFzcyBUcmFuc2xhdGlvbkNvbm5lY3Rpb25GYWN0b3J5IGV4dGVuZHMgQ29ubmVjdGlvbkZhY3RvcnlCYXNlIHtcbiAgICBjcmVhdGUoY29uZmlnLCBhdXRoSW5mbywgY29ubmVjdGlvbklkKSB7XG4gICAgICAgIGNvbnN0IGVuZHBvaW50ID0gdGhpcy5nZXRFbmRwb2ludFVybChjb25maWcpO1xuICAgICAgICBjb25zdCBxdWVyeVBhcmFtcyA9IHt9O1xuICAgICAgICBpZiAoY29uZmlnLmF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcXVlcnlQYXJhbXNbUXVlcnlQYXJhbWV0ZXJOYW1lcy5FbmFibGVMYW5ndWFnZUlkXSA9IFwidHJ1ZVwiO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0UXVlcnlQYXJhbXMocXVlcnlQYXJhbXMsIGNvbmZpZywgZW5kcG9pbnQpO1xuICAgICAgICBjb25zdCBoZWFkZXJzID0ge307XG4gICAgICAgIGlmIChhdXRoSW5mby50b2tlbiAhPT0gdW5kZWZpbmVkICYmIGF1dGhJbmZvLnRva2VuICE9PSBcIlwiKSB7XG4gICAgICAgICAgICBoZWFkZXJzW2F1dGhJbmZvLmhlYWRlck5hbWVdID0gYXV0aEluZm8udG9rZW47XG4gICAgICAgIH1cbiAgICAgICAgaGVhZGVyc1tIZWFkZXJOYW1lcy5Db25uZWN0aW9uSWRdID0gY29ubmVjdGlvbklkO1xuICAgICAgICBjb25maWcucGFyYW1ldGVycy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1VybCwgZW5kcG9pbnQpO1xuICAgICAgICBjb25zdCBlbmFibGVDb21wcmVzc2lvbiA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFwiU1BFRUNILUVuYWJsZVdlYnNvY2tldENvbXByZXNzaW9uXCIsIFwiZmFsc2VcIikgPT09IFwidHJ1ZVwiO1xuICAgICAgICByZXR1cm4gbmV3IFdlYnNvY2tldENvbm5lY3Rpb24oZW5kcG9pbnQsIHF1ZXJ5UGFyYW1zLCBoZWFkZXJzLCBuZXcgV2Vic29ja2V0TWVzc2FnZUZvcm1hdHRlcigpLCBQcm94eUluZm8uZnJvbVJlY29nbml6ZXJDb25maWcoY29uZmlnKSwgZW5hYmxlQ29tcHJlc3Npb24sIGNvbm5lY3Rpb25JZCk7XG4gICAgfVxuICAgIGdldEVuZHBvaW50VXJsKGNvbmZpZywgcmV0dXJuUmVnaW9uUGxhY2Vob2xkZXIpIHtcbiAgICAgICAgY29uc3QgcmVnaW9uID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWdpb24pO1xuICAgICAgICBjb25zdCBob3N0U3VmZml4ID0gQ29ubmVjdGlvbkZhY3RvcnlCYXNlLmdldEhvc3RTdWZmaXgocmVnaW9uKTtcbiAgICAgICAgbGV0IGVuZHBvaW50VXJsID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludCwgdW5kZWZpbmVkKTtcbiAgICAgICAgaWYgKCFlbmRwb2ludFVybCkge1xuICAgICAgICAgICAgaWYgKGNvbmZpZy5hdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBob3N0ID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Ib3N0LCBcIndzczovL3tyZWdpb259LnN0dC5zcGVlY2hcIiArIGhvc3RTdWZmaXgpO1xuICAgICAgICAgICAgICAgIGVuZHBvaW50VXJsID0gaG9zdCArIFwiL3NwZWVjaC91bml2ZXJzYWwvdjJcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGhvc3QgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0hvc3QsIFwid3NzOi8ve3JlZ2lvbn0uczJzLnNwZWVjaFwiICsgaG9zdFN1ZmZpeCk7XG4gICAgICAgICAgICAgICAgZW5kcG9pbnRVcmwgPSBob3N0ICsgXCIvc3BlZWNoL3RyYW5zbGF0aW9uL2NvZ25pdGl2ZXNlcnZpY2VzL3YxXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJldHVyblJlZ2lvblBsYWNlaG9sZGVyID09PSB0cnVlKSB7XG4gICAgICAgICAgICByZXR1cm4gZW5kcG9pbnRVcmw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLmZvcm1hdFN0cmluZyhlbmRwb2ludFVybCwgeyByZWdpb24gfSk7XG4gICAgfVxuICAgIHNldFF1ZXJ5UGFyYW1zKHF1ZXJ5UGFyYW1zLCBjb25maWcsIGVuZHBvaW50VXJsKSB7XG4gICAgICAgIHF1ZXJ5UGFyYW1zLmZyb20gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZSk7XG4gICAgICAgIHF1ZXJ5UGFyYW1zLnRvID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvblRvTGFuZ3VhZ2VzKTtcbiAgICAgICAgdGhpcy5zZXRDb21tb25VcmxQYXJhbXMoY29uZmlnLCBxdWVyeVBhcmFtcywgZW5kcG9pbnRVcmwpO1xuICAgICAgICB0aGlzLnNldFVybFBhcmFtZXRlcihQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9UcmFuc2xhdGlvblJlcXVlc3RTdGFibGVQYXJ0aWFsUmVzdWx0LCBRdWVyeVBhcmFtZXRlck5hbWVzLlN0YWJsZVRyYW5zbGF0aW9uLCBjb25maWcsIHF1ZXJ5UGFyYW1zLCBlbmRwb2ludFVybCk7XG4gICAgICAgIGNvbnN0IHRyYW5zbGF0aW9uVm9pY2UgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uVm9pY2UsIHVuZGVmaW5lZCk7XG4gICAgICAgIGlmICh0cmFuc2xhdGlvblZvaWNlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHF1ZXJ5UGFyYW1zLnZvaWNlID0gdHJhbnNsYXRpb25Wb2ljZTtcbiAgICAgICAgICAgIHF1ZXJ5UGFyYW1zLmZlYXR1cmVzID0gXCJ0ZXh0dG9zcGVlY2hcIjtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VHJhbnNsYXRpb25Db25uZWN0aW9uRmFjdG9yeS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBNZXNzYWdlVHlwZSwgVHJhbnNsYXRpb25TdGF0dXMsIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDYW5jZWxsYXRpb25FcnJvckNvZGUsIENhbmNlbGxhdGlvblJlYXNvbiwgUHJvcGVydHlDb2xsZWN0aW9uLCBQcm9wZXJ0eUlkLCBSZXN1bHRSZWFzb24sIFRyYW5zbGF0aW9uUmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJncywgVHJhbnNsYXRpb25SZWNvZ25pdGlvbkV2ZW50QXJncywgVHJhbnNsYXRpb25SZWNvZ25pdGlvblJlc3VsdCwgVHJhbnNsYXRpb25zLCBUcmFuc2xhdGlvblN5bnRoZXNpc0V2ZW50QXJncywgVHJhbnNsYXRpb25TeW50aGVzaXNSZXN1bHQsIH0gZnJvbSBcIi4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDYW5jZWxsYXRpb25FcnJvckNvZGVQcm9wZXJ0eU5hbWUsIENvbnZlcnNhdGlvblNlcnZpY2VSZWNvZ25pemVyLCBFbnVtVHJhbnNsYXRpb24sIFJlY29nbml0aW9uU3RhdHVzLCBTeW50aGVzaXNTdGF0dXMsIFRyYW5zbGF0aW9uSHlwb3RoZXNpcywgVHJhbnNsYXRpb25QaHJhc2UsIFRyYW5zbGF0aW9uU3ludGhlc2lzRW5kLCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtY2xhc3Nlcy1wZXItZmlsZVxuZXhwb3J0IGNsYXNzIFRyYW5zbGF0aW9uU2VydmljZVJlY29nbml6ZXIgZXh0ZW5kcyBDb252ZXJzYXRpb25TZXJ2aWNlUmVjb2duaXplciB7XG4gICAgY29uc3RydWN0b3IoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb1NvdXJjZSwgcmVjb2duaXplckNvbmZpZywgdHJhbnNsYXRpb25SZWNvZ25pemVyKSB7XG4gICAgICAgIHN1cGVyKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Tb3VyY2UsIHJlY29nbml6ZXJDb25maWcsIHRyYW5zbGF0aW9uUmVjb2duaXplcik7XG4gICAgICAgIHRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplciA9IHRyYW5zbGF0aW9uUmVjb2duaXplcjtcbiAgICAgICAgdGhpcy5jb25uZWN0aW9uRXZlbnRzLmF0dGFjaCgoY29ubmVjdGlvbkV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoY29ubmVjdGlvbkV2ZW50Lm5hbWUgPT09IFwiQ29ubmVjdGlvbkVzdGFibGlzaGVkRXZlbnRcIikge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplci5vbkNvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNvbm5lY3Rpb25FdmVudC5uYW1lID09PSBcIkNvbm5lY3Rpb25DbG9zZWRFdmVudFwiKSB7XG4gICAgICAgICAgICAgICAgdm9pZCB0aGlzLnByaXZUcmFuc2xhdGlvblJlY29nbml6ZXIub25EaXNjb25uZWN0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBwcm9jZXNzVHlwZVNwZWNpZmljTWVzc2FnZXMoY29ubmVjdGlvbk1lc3NhZ2UpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdFByb3BzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICAgICAgbGV0IHByb2Nlc3NlZCA9IHlpZWxkIHRoaXMucHJvY2Vzc1NwZWVjaE1lc3NhZ2VzKGNvbm5lY3Rpb25NZXNzYWdlKTtcbiAgICAgICAgICAgIGlmIChwcm9jZXNzZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGhhbmRsZVRyYW5zbGF0aW9uUGhyYXNlID0gKHRyYW5zbGF0ZWRQaHJhc2UpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblBocmFzZVJlY29nbml6ZWQodGhpcy5wcml2UmVxdWVzdFNlc3Npb24uY3VycmVudFR1cm5BdWRpb09mZnNldCArIHRyYW5zbGF0ZWRQaHJhc2UuT2Zmc2V0ICsgdHJhbnNsYXRlZFBocmFzZS5EdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgaWYgKHRyYW5zbGF0ZWRQaHJhc2UuUmVjb2duaXRpb25TdGF0dXMgPT09IFJlY29nbml0aW9uU3RhdHVzLlN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gT0ssIHRoZSByZWNvZ25pdGlvbiB3YXMgc3VjY2Vzc2Z1bC4gSG93J2QgdGhlIHRyYW5zbGF0aW9uIGRvP1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLmZpcmVFdmVudEZvclJlc3VsdCh0cmFuc2xhdGVkUGhyYXNlLCByZXN1bHRQcm9wcyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplci5yZWNvZ25pemVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplci5yZWNvZ25pemVkKHRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplciwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90IGdvaW5nIHRvIGxldCBlcnJvcnMgaW4gdGhlIGV2ZW50IGhhbmRsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0cmlwIHRoaW5ncyB1cC5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyByZXBvcnQgcmVzdWx0IHRvIHByb21pc2UuXG4gICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2socmVzdWx0LnJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkVycm9yQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2RXJyb3JDYWxsYmFjayhlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IGludm9rZSB0aGUgY2FsbCBiYWNrIG9uY2UuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhbmQgaWYgaXQncyBzdWNjZXNzZnVsIGRvbid0IGludm9rZSB0aGVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVycm9yIGFmdGVyIHRoYXQuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZFcnJvckNhbGxiYWNrID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZWFzb24gPSBFbnVtVHJhbnNsYXRpb24uaW1wbFRyYW5zbGF0ZVJlY29nbml0aW9uUmVzdWx0KHRyYW5zbGF0ZWRQaHJhc2UuUmVjb2duaXRpb25TdGF0dXMpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgVHJhbnNsYXRpb25SZWNvZ25pdGlvblJlc3VsdCh1bmRlZmluZWQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgcmVhc29uLCB0cmFuc2xhdGVkUGhyYXNlLlRleHQsIHRyYW5zbGF0ZWRQaHJhc2UuRHVyYXRpb24sIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmN1cnJlbnRUdXJuQXVkaW9PZmZzZXQgKyB0cmFuc2xhdGVkUGhyYXNlLk9mZnNldCwgdHJhbnNsYXRlZFBocmFzZS5MYW5ndWFnZSwgdHJhbnNsYXRlZFBocmFzZS5Db25maWRlbmNlLCB1bmRlZmluZWQsIGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5LCByZXN1bHRQcm9wcyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZWFzb24gPT09IFJlc3VsdFJlYXNvbi5DYW5jZWxlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FuY2VsUmVhc29uID0gRW51bVRyYW5zbGF0aW9uLmltcGxUcmFuc2xhdGVDYW5jZWxSZXN1bHQodHJhbnNsYXRlZFBocmFzZS5SZWNvZ25pdGlvblN0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYW5jZWxsYXRpb25FcnJvckNvZGUgPSBFbnVtVHJhbnNsYXRpb24uaW1wbFRyYW5zbGF0ZUNhbmNlbEVycm9yQ29kZSh0cmFuc2xhdGVkUGhyYXNlLlJlY29nbml0aW9uU3RhdHVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuY2FuY2VsUmVjb2duaXRpb25Mb2NhbChjYW5jZWxSZWFzb24sIGNhbmNlbGxhdGlvbkVycm9yQ29kZSwgRW51bVRyYW5zbGF0aW9uLmltcGxUcmFuc2xhdGVFcnJvckRldGFpbHMoY2FuY2VsbGF0aW9uRXJyb3JDb2RlKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5pc1NwZWVjaEVuZGVkICYmIHJlYXNvbiA9PT0gUmVzdWx0UmVhc29uLk5vTWF0Y2ggJiYgdHJhbnNsYXRlZFBocmFzZS5SZWNvZ25pdGlvblN0YXR1cyAhPT0gUmVjb2duaXRpb25TdGF0dXMuSW5pdGlhbFNpbGVuY2VUaW1lb3V0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV2ID0gbmV3IFRyYW5zbGF0aW9uUmVjb2duaXRpb25FdmVudEFyZ3MocmVzdWx0LCByZXN1bHQub2Zmc2V0LCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplci5yZWNvZ25pemVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZUcmFuc2xhdGlvblJlY29nbml6ZXIucmVjb2duaXplZCh0aGlzLnByaXZUcmFuc2xhdGlvblJlY29nbml6ZXIsIGV2KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgZ29pbmcgdG8gbGV0IGVycm9ycyBpbiB0aGUgZXZlbnQgaGFuZGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyByZXBvcnQgcmVzdWx0IHRvIHByb21pc2UuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2socmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2RXJyb3JDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2RXJyb3JDYWxsYmFjayhlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IGludm9rZSB0aGUgY2FsbCBiYWNrIG9uY2UuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIGlmIGl0J3Mgc3VjY2Vzc2Z1bCBkb24ndCBpbnZva2UgdGhlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXJyb3IgYWZ0ZXIgdGhhdC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2RXJyb3JDYWxsYmFjayA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBwcm9jZXNzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb25NZXNzYWdlLm1lc3NhZ2VUeXBlID09PSBNZXNzYWdlVHlwZS5UZXh0KSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0UHJvcHMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfSnNvblJlc3VsdCwgY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3dpdGNoIChjb25uZWN0aW9uTWVzc2FnZS5wYXRoLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwidHJhbnNsYXRpb24uaHlwb3RoZXNpc1wiOlxuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLmZpcmVFdmVudEZvclJlc3VsdChUcmFuc2xhdGlvbkh5cG90aGVzaXMuZnJvbUpTT04oY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpLCByZXN1bHRQcm9wcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uSHlwb3RoZXNpcyh0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5jdXJyZW50VHVybkF1ZGlvT2Zmc2V0ICsgcmVzdWx0Lm9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplci5yZWNvZ25pemluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZUcmFuc2xhdGlvblJlY29nbml6ZXIucmVjb2duaXppbmcodGhpcy5wcml2VHJhbnNsYXRpb25SZWNvZ25pemVyLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgZ29pbmcgdG8gbGV0IGVycm9ycyBpbiB0aGUgZXZlbnQgaGFuZGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRyaXAgdGhpbmdzIHVwLlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJ0cmFuc2xhdGlvbi5yZXNwb25zZVwiOlxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwaHJhc2UgPSBKU09OLnBhcnNlKGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhcGhyYXNlLlNwZWVjaFBocmFzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgaGFuZGxlVHJhbnNsYXRpb25QaHJhc2UoVHJhbnNsYXRpb25QaHJhc2UuZnJvbVRyYW5zbGF0aW9uUmVzcG9uc2UocGhyYXNlKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcInRyYW5zbGF0aW9uLnBocmFzZVwiOlxuICAgICAgICAgICAgICAgICAgICB5aWVsZCBoYW5kbGVUcmFuc2xhdGlvblBocmFzZShUcmFuc2xhdGlvblBocmFzZS5mcm9tSlNPTihjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwidHJhbnNsYXRpb24uc3ludGhlc2lzXCI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VuZFN5bnRoZXNpc0F1ZGlvKGNvbm5lY3Rpb25NZXNzYWdlLmJpbmFyeUJvZHksIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJhdWRpby5lbmRcIjpcbiAgICAgICAgICAgICAgICBjYXNlIFwidHJhbnNsYXRpb24uc3ludGhlc2lzLmVuZFwiOlxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzeW50aEVuZCA9IFRyYW5zbGF0aW9uU3ludGhlc2lzRW5kLmZyb21KU09OKGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChzeW50aEVuZC5TeW50aGVzaXNTdGF0dXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgU3ludGhlc2lzU3RhdHVzLkVycm9yOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplci5zeW50aGVzaXppbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IFRyYW5zbGF0aW9uU3ludGhlc2lzUmVzdWx0KFJlc3VsdFJlYXNvbi5DYW5jZWxlZCwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmV0RXZlbnQgPSBuZXcgVHJhbnNsYXRpb25TeW50aGVzaXNFdmVudEFyZ3MocmVzdWx0LCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2VHJhbnNsYXRpb25SZWNvZ25pemVyLnN5bnRoZXNpemluZyh0aGlzLnByaXZUcmFuc2xhdGlvblJlY29nbml6ZXIsIHJldEV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgZ29pbmcgdG8gbGV0IGVycm9ycyBpbiB0aGUgZXZlbnQgaGFuZGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2VHJhbnNsYXRpb25SZWNvZ25pemVyLmNhbmNlbGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFuZCByYWlzZSBhIGNhbmNlbGVkIGV2ZW50IHRvIHNlbmQgdGhlIHJpY2goZXIpIGVycm9yIG1lc3NhZ2UgYmFjay5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FuY2VsZWRSZXN1bHQgPSBuZXcgVHJhbnNsYXRpb25SZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCwgQ2FuY2VsbGF0aW9uUmVhc29uLkVycm9yLCBzeW50aEVuZC5GYWlsdXJlUmVhc29uLCBDYW5jZWxsYXRpb25FcnJvckNvZGUuU2VydmljZUVycm9yLCBudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplci5jYW5jZWxlZCh0aGlzLnByaXZUcmFuc2xhdGlvblJlY29nbml6ZXIsIGNhbmNlbGVkUmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgZ29pbmcgdG8gbGV0IGVycm9ycyBpbiB0aGUgZXZlbnQgaGFuZGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFN5bnRoZXNpc1N0YXR1cy5TdWNjZXNzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VuZFN5bnRoZXNpc0F1ZGlvKHVuZGVmaW5lZCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcHJvY2Vzc2VkO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLy8gQ2FuY2VscyByZWNvZ25pdGlvbi5cbiAgICBjYW5jZWxSZWNvZ25pdGlvbihzZXNzaW9uSWQsIHJlcXVlc3RJZCwgY2FuY2VsbGF0aW9uUmVhc29uLCBlcnJvckNvZGUsIGVycm9yKSB7XG4gICAgICAgIGNvbnN0IHByb3BlcnRpZXMgPSBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCk7XG4gICAgICAgIHByb3BlcnRpZXMuc2V0UHJvcGVydHkoQ2FuY2VsbGF0aW9uRXJyb3JDb2RlUHJvcGVydHlOYW1lLCBDYW5jZWxsYXRpb25FcnJvckNvZGVbZXJyb3JDb2RlXSk7XG4gICAgICAgIGlmICghIXRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplci5jYW5jZWxlZCkge1xuICAgICAgICAgICAgY29uc3QgY2FuY2VsRXZlbnQgPSBuZXcgVHJhbnNsYXRpb25SZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzKHNlc3Npb25JZCwgY2FuY2VsbGF0aW9uUmVhc29uLCBlcnJvciwgZXJyb3JDb2RlLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZUcmFuc2xhdGlvblJlY29nbml6ZXIuY2FuY2VsZWQodGhpcy5wcml2VHJhbnNsYXRpb25SZWNvZ25pemVyLCBjYW5jZWxFdmVudCk7XG4gICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChfYSkgeyB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCEhdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrKSB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgVHJhbnNsYXRpb25SZWNvZ25pdGlvblJlc3VsdCh1bmRlZmluZWQsIC8vIFRyYW5zbGF0aW9uc1xuICAgICAgICAgICAgcmVxdWVzdElkLCBSZXN1bHRSZWFzb24uQ2FuY2VsZWQsIHVuZGVmaW5lZCwgLy8gVGV4dFxuICAgICAgICAgICAgdW5kZWZpbmVkLCAvLyBEcnVhdGlvblxuICAgICAgICAgICAgdW5kZWZpbmVkLCAvLyBPZmZzZXRcbiAgICAgICAgICAgIHVuZGVmaW5lZCwgLy8gTGFuZ3VhZ2VcbiAgICAgICAgICAgIHVuZGVmaW5lZCwgLy8gTGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlXG4gICAgICAgICAgICBlcnJvciwgdW5kZWZpbmVkLCAvLyBKc29uXG4gICAgICAgICAgICBwcm9wZXJ0aWVzKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoX2IpIHsgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGhhbmRsZVJlY29nbml6aW5nQ2FsbGJhY2socmVzdWx0LCBkdXJhdGlvbiwgc2Vzc2lvbklkKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBldiA9IG5ldyBUcmFuc2xhdGlvblJlY29nbml0aW9uRXZlbnRBcmdzKFRyYW5zbGF0aW9uUmVjb2duaXRpb25SZXN1bHQuZnJvbVNwZWVjaFJlY29nbml0aW9uUmVzdWx0KHJlc3VsdCksIGR1cmF0aW9uLCBzZXNzaW9uSWQpO1xuICAgICAgICAgICAgdGhpcy5wcml2VHJhbnNsYXRpb25SZWNvZ25pemVyLnJlY29nbml6aW5nKHRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplciwgZXYpO1xuICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIE5vdCBnb2luZyB0byBsZXQgZXJyb3JzIGluIHRoZSBldmVudCBoYW5kbGVyXG4gICAgICAgICAgICAvLyB0cmlwIHRoaW5ncyB1cC5cbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVSZWNvZ25pemVkQ2FsbGJhY2socmVzdWx0LCBvZmZzZXQsIHNlc3Npb25JZCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZXYgPSBuZXcgVHJhbnNsYXRpb25SZWNvZ25pdGlvbkV2ZW50QXJncyhUcmFuc2xhdGlvblJlY29nbml0aW9uUmVzdWx0LmZyb21TcGVlY2hSZWNvZ25pdGlvblJlc3VsdChyZXN1bHQpLCBvZmZzZXQsIHNlc3Npb25JZCk7XG4gICAgICAgICAgICB0aGlzLnByaXZUcmFuc2xhdGlvblJlY29nbml6ZXIucmVjb2duaXplZCh0aGlzLnByaXZUcmFuc2xhdGlvblJlY29nbml6ZXIsIGV2KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIE5vdCBnb2luZyB0byBsZXQgZXJyb3JzIGluIHRoZSBldmVudCBoYW5kbGVyXG4gICAgICAgICAgICAvLyB0cmlwIHRoaW5ncyB1cC5cbiAgICAgICAgfVxuICAgIH1cbiAgICBmaXJlRXZlbnRGb3JSZXN1bHQoc2VydmljZVJlc3VsdCwgcHJvcGVydGllcykge1xuICAgICAgICBsZXQgdHJhbnNsYXRpb25zO1xuICAgICAgICBpZiAodW5kZWZpbmVkICE9PSBzZXJ2aWNlUmVzdWx0LlRyYW5zbGF0aW9uLlRyYW5zbGF0aW9ucykge1xuICAgICAgICAgICAgdHJhbnNsYXRpb25zID0gbmV3IFRyYW5zbGF0aW9ucygpO1xuICAgICAgICAgICAgZm9yIChjb25zdCB0cmFuc2xhdGlvbiBvZiBzZXJ2aWNlUmVzdWx0LlRyYW5zbGF0aW9uLlRyYW5zbGF0aW9ucykge1xuICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9ucy5zZXQodHJhbnNsYXRpb24uTGFuZ3VhZ2UsIHRyYW5zbGF0aW9uLlRleHQgfHwgdHJhbnNsYXRpb24uRGlzcGxheVRleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGxldCByZXN1bHRSZWFzb247XG4gICAgICAgIGxldCBsYW5ndWFnZTtcbiAgICAgICAgbGV0IGNvbmZpZGVuY2U7XG4gICAgICAgIGlmIChzZXJ2aWNlUmVzdWx0IGluc3RhbmNlb2YgVHJhbnNsYXRpb25QaHJhc2UpIHtcbiAgICAgICAgICAgIGlmICghIXNlcnZpY2VSZXN1bHQuVHJhbnNsYXRpb24gJiYgc2VydmljZVJlc3VsdC5UcmFuc2xhdGlvbi5UcmFuc2xhdGlvblN0YXR1cyA9PT0gVHJhbnNsYXRpb25TdGF0dXMuU3VjY2Vzcykge1xuICAgICAgICAgICAgICAgIHJlc3VsdFJlYXNvbiA9IFJlc3VsdFJlYXNvbi5UcmFuc2xhdGVkU3BlZWNoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0UmVhc29uID0gUmVzdWx0UmVhc29uLlJlY29nbml6ZWRTcGVlY2g7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsYW5ndWFnZSA9IHNlcnZpY2VSZXN1bHQuTGFuZ3VhZ2U7XG4gICAgICAgICAgICBjb25maWRlbmNlID0gc2VydmljZVJlc3VsdC5Db25maWRlbmNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0UmVhc29uID0gUmVzdWx0UmVhc29uLlRyYW5zbGF0aW5nU3BlZWNoO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG9mZnNldCA9IHNlcnZpY2VSZXN1bHQuT2Zmc2V0ICsgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uY3VycmVudFR1cm5BdWRpb09mZnNldDtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IFRyYW5zbGF0aW9uUmVjb2duaXRpb25SZXN1bHQodHJhbnNsYXRpb25zLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIHJlc3VsdFJlYXNvbiwgc2VydmljZVJlc3VsdC5UZXh0LCBzZXJ2aWNlUmVzdWx0LkR1cmF0aW9uLCBvZmZzZXQsIGxhbmd1YWdlLCBjb25maWRlbmNlLCBzZXJ2aWNlUmVzdWx0LlRyYW5zbGF0aW9uLkZhaWx1cmVSZWFzb24sIEpTT04uc3RyaW5naWZ5KHNlcnZpY2VSZXN1bHQpLCBwcm9wZXJ0aWVzKTtcbiAgICAgICAgY29uc3QgZXYgPSBuZXcgVHJhbnNsYXRpb25SZWNvZ25pdGlvbkV2ZW50QXJncyhyZXN1bHQsIG9mZnNldCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkKTtcbiAgICAgICAgcmV0dXJuIGV2O1xuICAgIH1cbiAgICBzZW5kU3ludGhlc2lzQXVkaW8oYXVkaW8sIHNlc3Npb25JZCkge1xuICAgICAgICBjb25zdCByZWFzb24gPSAodW5kZWZpbmVkID09PSBhdWRpbykgPyBSZXN1bHRSZWFzb24uU3ludGhlc2l6aW5nQXVkaW9Db21wbGV0ZWQgOiBSZXN1bHRSZWFzb24uU3ludGhlc2l6aW5nQXVkaW87XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBUcmFuc2xhdGlvblN5bnRoZXNpc1Jlc3VsdChyZWFzb24sIGF1ZGlvKTtcbiAgICAgICAgY29uc3QgcmV0RXZlbnQgPSBuZXcgVHJhbnNsYXRpb25TeW50aGVzaXNFdmVudEFyZ3MocmVzdWx0LCBzZXNzaW9uSWQpO1xuICAgICAgICBpZiAoISF0aGlzLnByaXZUcmFuc2xhdGlvblJlY29nbml6ZXIuc3ludGhlc2l6aW5nKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplci5zeW50aGVzaXppbmcodGhpcy5wcml2VHJhbnNsYXRpb25SZWNvZ25pemVyLCByZXRFdmVudCk7XG4gICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIC8vIE5vdCBnb2luZyB0byBsZXQgZXJyb3JzIGluIHRoZSBldmVudCBoYW5kbGVyXG4gICAgICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVRyYW5zbGF0aW9uU2VydmljZVJlY29nbml6ZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogRGVmaW5lcyB0cmFuc2xhdGlvbiBzdGF0dXMuXG4gKiBAY2xhc3MgVHJhbnNsYXRpb25TdGF0dXNcbiAqL1xuZXhwb3J0IHZhciBUcmFuc2xhdGlvblN0YXR1cztcbihmdW5jdGlvbiAoVHJhbnNsYXRpb25TdGF0dXMpIHtcbiAgICAvKipcbiAgICAgKiBAbWVtYmVyIFRyYW5zbGF0aW9uU3RhdHVzLlN1Y2Nlc3NcbiAgICAgKi9cbiAgICBUcmFuc2xhdGlvblN0YXR1c1tUcmFuc2xhdGlvblN0YXR1c1tcIlN1Y2Nlc3NcIl0gPSAwXSA9IFwiU3VjY2Vzc1wiO1xuICAgIC8qKlxuICAgICAqIEBtZW1iZXIgVHJhbnNsYXRpb25TdGF0dXMuRXJyb3JcbiAgICAgKi9cbiAgICBUcmFuc2xhdGlvblN0YXR1c1tUcmFuc2xhdGlvblN0YXR1c1tcIkVycm9yXCJdID0gMV0gPSBcIkVycm9yXCI7XG59KShUcmFuc2xhdGlvblN0YXR1cyB8fCAoVHJhbnNsYXRpb25TdGF0dXMgPSB7fSkpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1UcmFuc2xhdGlvblN0YXR1cy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBSZXBsYXlhYmxlQXVkaW9Ob2RlIH0gZnJvbSBcIi4uL2NvbW1vbi5icm93c2VyL0V4cG9ydHNcIjtcbmltcG9ydCB7IERlZmVycmFsTWFwLCBEZWZlcnJlZCwgTWVzc2FnZVR5cGUsIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDYW5jZWxsYXRpb25FcnJvckNvZGUsIENhbmNlbGxhdGlvblJlYXNvbiwgUHJvcGVydHlDb2xsZWN0aW9uLCBQcm9wZXJ0eUlkLCBSZXN1bHRSZWFzb24sIFNlc3Npb25FdmVudEFyZ3MsIFZvaWNlUHJvZmlsZUVucm9sbG1lbnRSZXN1bHQsIFZvaWNlUHJvZmlsZVBocmFzZVJlc3VsdCwgVm9pY2VQcm9maWxlUmVzdWx0LCBWb2ljZVByb2ZpbGVUeXBlIH0gZnJvbSBcIi4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDYW5jZWxsYXRpb25FcnJvckNvZGVQcm9wZXJ0eU5hbWUsIFNlcnZpY2VSZWNvZ25pemVyQmFzZSwgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBTcGVlY2hDb25uZWN0aW9uTWVzc2FnZSB9IGZyb20gXCIuL1NwZWVjaENvbm5lY3Rpb25NZXNzYWdlLkludGVybmFsXCI7XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWNsYXNzZXMtcGVyLWZpbGVcbmV4cG9ydCBjbGFzcyBWb2ljZVNlcnZpY2VSZWNvZ25pemVyIGV4dGVuZHMgU2VydmljZVJlY29nbml6ZXJCYXNlIHtcbiAgICBjb25zdHJ1Y3RvcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvU291cmNlLCByZWNvZ25pemVyQ29uZmlnLCByZWNvZ25pemVyKSB7XG4gICAgICAgIHN1cGVyKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Tb3VyY2UsIHJlY29nbml6ZXJDb25maWcsIHJlY29nbml6ZXIpO1xuICAgICAgICB0aGlzLnByaXZEZWZlcnJhbE1hcCA9IG5ldyBEZWZlcnJhbE1hcCgpO1xuICAgICAgICB0aGlzLnByaXZTcGVha2VyQXVkaW9Tb3VyY2UgPSBhdWRpb1NvdXJjZTtcbiAgICAgICAgdGhpcy5zZW5kUHJlUGF5bG9hZEpTT05PdmVycmlkZSA9ICgpID0+IHRoaXMubm9PcCgpO1xuICAgIH1cbiAgICBzZXQgU3BlYWtlckF1ZGlvU291cmNlKGF1ZGlvU291cmNlKSB7XG4gICAgICAgIHRoaXMucHJpdlNwZWFrZXJBdWRpb1NvdXJjZSA9IGF1ZGlvU291cmNlO1xuICAgIH1cbiAgICBwcm9jZXNzVHlwZVNwZWNpZmljTWVzc2FnZXMoY29ubmVjdGlvbk1lc3NhZ2UpIHtcbiAgICAgICAgbGV0IHByb2Nlc3NlZCA9IGZhbHNlO1xuICAgICAgICBjb25zdCByZXN1bHRQcm9wcyA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICAgICAgaWYgKGNvbm5lY3Rpb25NZXNzYWdlLm1lc3NhZ2VUeXBlID09PSBNZXNzYWdlVHlwZS5UZXh0KSB7XG4gICAgICAgICAgICByZXN1bHRQcm9wcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9Kc29uUmVzdWx0LCBjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgIH1cbiAgICAgICAgc3dpdGNoIChjb25uZWN0aW9uTWVzc2FnZS5wYXRoLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgIC8vIFByb2ZpbGUgbWFuYWdlbWVudCByZXNwb25zZSBmb3IgY3JlYXRlLCBmZXRjaCwgZGVsZXRlLCByZXNldFxuICAgICAgICAgICAgY2FzZSBcInNwZWFrZXIucHJvZmlsZXNcIjpcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IEpTT04ucGFyc2UoY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgIHN3aXRjaCAocmVzcG9uc2Uub3BlcmF0aW9uLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImNyZWF0ZVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVDcmVhdGVSZXNwb25zZShyZXNwb25zZSwgY29ubmVjdGlvbk1lc3NhZ2UucmVxdWVzdElkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZGVsZXRlXCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJyZXNldFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVSZXN1bHRSZXNwb25zZShyZXNwb25zZSwgY29ubmVjdGlvbk1lc3NhZ2UucmVxdWVzdElkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZmV0Y2hcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVucm9sbG1lbnRSZXNwb25zZSA9IEpTT04ucGFyc2UoY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVGZXRjaFJlc3BvbnNlKGVucm9sbG1lbnRSZXNwb25zZSwgY29ubmVjdGlvbk1lc3NhZ2UucmVxdWVzdElkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHByb2Nlc3NlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAvLyBBY3RpdmF0aW9uIGFuZCBhdXRob3JpemF0aW9uIHBocmFzZSByZXNwb25zZVxuICAgICAgICAgICAgY2FzZSBcInNwZWFrZXIucGhyYXNlc1wiOlxuICAgICAgICAgICAgICAgIGNvbnN0IHBocmFzZVJlc3BvbnNlID0gSlNPTi5wYXJzZShjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVQaHJhc2VzUmVzcG9uc2UocGhyYXNlUmVzcG9uc2UsIGNvbm5lY3Rpb25NZXNzYWdlLnJlcXVlc3RJZCk7XG4gICAgICAgICAgICAgICAgcHJvY2Vzc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIC8vIEVucm9sbG1lbnQgcmVzcG9uc2VcbiAgICAgICAgICAgIGNhc2UgXCJzcGVha2VyLnByb2ZpbGUuZW5yb2xsbWVudFwiOlxuICAgICAgICAgICAgICAgIGNvbnN0IGVucm9sbG1lbnRSZXNwb25zZSA9IEpTT04ucGFyc2UoY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBWb2ljZVByb2ZpbGVFbnJvbGxtZW50UmVzdWx0KHRoaXMuZW5yb2xsbWVudFJlYXNvbkZyb20oISFlbnJvbGxtZW50UmVzcG9uc2UuZW5yb2xsbWVudCA/IGVucm9sbG1lbnRSZXNwb25zZS5lbnJvbGxtZW50LmVucm9sbG1lbnRTdGF0dXMgOiBlbnJvbGxtZW50UmVzcG9uc2Uuc3RhdHVzLnN0YXR1c0NvZGUpLCAhIWVucm9sbG1lbnRSZXNwb25zZS5lbnJvbGxtZW50ID8gSlNPTi5zdHJpbmdpZnkoZW5yb2xsbWVudFJlc3BvbnNlLmVucm9sbG1lbnQpIDogdW5kZWZpbmVkLCBlbnJvbGxtZW50UmVzcG9uc2Uuc3RhdHVzLnJlYXNvbik7XG4gICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2RGVmZXJyYWxNYXAuZ2V0SWQoY29ubmVjdGlvbk1lc3NhZ2UucmVxdWVzdElkKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZEZWZlcnJhbE1hcC5jb21wbGV0ZShjb25uZWN0aW9uTWVzc2FnZS5yZXF1ZXN0SWQsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uU3BlZWNoRW5kZWQoKTtcbiAgICAgICAgICAgICAgICBwcm9jZXNzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBkZWZmZXJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICBkZWZmZXJhbC5yZXNvbHZlKHByb2Nlc3NlZCk7XG4gICAgICAgIHJldHVybiBkZWZmZXJhbC5wcm9taXNlO1xuICAgIH1cbiAgICAvLyBDYW5jZWxzIHJlY29nbml0aW9uLlxuICAgIGNhbmNlbFJlY29nbml0aW9uKHNlc3Npb25JZCwgcmVxdWVzdElkLCBjYW5jZWxsYXRpb25SZWFzb24sIGVycm9yQ29kZSwgZXJyb3IpIHtcbiAgICAgICAgY29uc3QgcHJvcGVydGllcyA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICAgICAgLy8gY29uc3QgZW5yb2xsbWVudFJlc3BvbnNlOiBFbnJvbGxtZW50UmVzcG9uc2UgPSBKU09OLnBhcnNlKGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KSBhcyBFbnJvbGxtZW50UmVzcG9uc2U7XG4gICAgICAgIHByb3BlcnRpZXMuc2V0UHJvcGVydHkoQ2FuY2VsbGF0aW9uRXJyb3JDb2RlUHJvcGVydHlOYW1lLCBDYW5jZWxsYXRpb25FcnJvckNvZGVbZXJyb3JDb2RlXSk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBWb2ljZVByb2ZpbGVFbnJvbGxtZW50UmVzdWx0KFJlc3VsdFJlYXNvbi5DYW5jZWxlZCwgZXJyb3IsIGVycm9yKTtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2RGVmZXJyYWxNYXAuZ2V0SWQocmVxdWVzdElkKSkge1xuICAgICAgICAgICAgdGhpcy5wcml2RGVmZXJyYWxNYXAuY29tcGxldGUocmVxdWVzdElkLCByZXN1bHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNyZWF0ZVByb2ZpbGUocHJvZmlsZVR5cGUsIGxvY2FsZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgLy8gU3RhcnQgdGhlIGNvbm5lY3Rpb24gdG8gdGhlIHNlcnZpY2UuIFRoZSBwcm9taXNlIHRoaXMgd2lsbCBjcmVhdGUgaXMgc3RvcmVkIGFuZCB3aWxsIGJlIHVzZWQgYnkgY29uZmlndXJlQ29ubmVjdGlvbigpLlxuICAgICAgICAgICAgdGhpcy52b2ljZVByb2ZpbGVUeXBlID0gcHJvZmlsZVR5cGUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIGNvbnN0IGNvblByb21pc2UgPSB0aGlzLmNvbm5lY3RJbXBsKCk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNyZWF0ZVByb2ZpbGVEZWZlcnJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICAgICAgICAgIHlpZWxkIGNvblByb21pc2U7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5zZW5kQ3JlYXRlUHJvZmlsZShjcmVhdGVQcm9maWxlRGVmZXJyYWwsIHByb2ZpbGVUeXBlLCBsb2NhbGUpO1xuICAgICAgICAgICAgICAgIHZvaWQgdGhpcy5yZWNlaXZlTWVzc2FnZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjcmVhdGVQcm9maWxlRGVmZXJyYWwucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXNldFByb2ZpbGUocHJvZmlsZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdGhpcy52b2ljZVByb2ZpbGVUeXBlID0gcHJvZmlsZS5wcm9maWxlVHlwZS50b1N0cmluZygpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2VuZENvbW1vblJlcXVlc3QoXCJyZXNldFwiLCBwcm9maWxlLnByb2ZpbGVUeXBlLCBwcm9maWxlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGRlbGV0ZVByb2ZpbGUocHJvZmlsZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdGhpcy52b2ljZVByb2ZpbGVUeXBlID0gcHJvZmlsZS5wcm9maWxlVHlwZS50b1N0cmluZygpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2VuZENvbW1vblJlcXVlc3QoXCJkZWxldGVcIiwgcHJvZmlsZS5wcm9maWxlVHlwZSwgcHJvZmlsZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXRyaWV2ZUVucm9sbG1lbnRSZXN1bHQocHJvZmlsZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdGhpcy52b2ljZVByb2ZpbGVUeXBlID0gcHJvZmlsZS5wcm9maWxlVHlwZS50b1N0cmluZygpO1xuICAgICAgICAgICAgdGhpcy5wcml2RXhwZWN0ZWRQcm9maWxlSWQgPSBwcm9maWxlLnByb2ZpbGVJZDtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNlbmRDb21tb25SZXF1ZXN0KFwiZmV0Y2hcIiwgcHJvZmlsZS5wcm9maWxlVHlwZSwgcHJvZmlsZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXRBbGxQcm9maWxlcyhwcm9maWxlVHlwZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdGhpcy52b2ljZVByb2ZpbGVUeXBlID0gcHJvZmlsZVR5cGUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNlbmRDb21tb25SZXF1ZXN0KFwiZmV0Y2hcIiwgcHJvZmlsZVR5cGUpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZ2V0QWN0aXZhdGlvblBocmFzZXMocHJvZmlsZVR5cGUsIGxhbmcpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRoaXMudm9pY2VQcm9maWxlVHlwZSA9IHByb2ZpbGVUeXBlLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAvLyBTdGFydCB0aGUgY29ubmVjdGlvbiB0byB0aGUgc2VydmljZS4gVGhlIHByb21pc2UgdGhpcyB3aWxsIGNyZWF0ZSBpcyBzdG9yZWQgYW5kIHdpbGwgYmUgdXNlZCBieSBjb25maWd1cmVDb25uZWN0aW9uKCkuXG4gICAgICAgICAgICBjb25zdCBjb25Qcm9taXNlID0gdGhpcy5jb25uZWN0SW1wbCgpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBnZXRQaHJhc2VzRGVmZXJyYWwgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgICAgICAgICB5aWVsZCBjb25Qcm9taXNlO1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuc2VuZFBocmFzZXNSZXF1ZXN0KGdldFBocmFzZXNEZWZlcnJhbCwgcHJvZmlsZVR5cGUsIGxhbmcpO1xuICAgICAgICAgICAgICAgIHZvaWQgdGhpcy5yZWNlaXZlTWVzc2FnZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiBnZXRQaHJhc2VzRGVmZXJyYWwucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBlbnJvbGxQcm9maWxlKHByb2ZpbGUpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRoaXMudm9pY2VQcm9maWxlVHlwZSA9IHByb2ZpbGUucHJvZmlsZVR5cGUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIGNvbnN0IGVucm9sbG1lbnREZWZlcnJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc3RhcnROZXdSZWNvZ25pdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ubGlzdGVuRm9yU2VydmljZVRlbGVtZXRyeSh0aGlzLnByaXZTcGVha2VyQXVkaW9Tb3VyY2UuZXZlbnRzKTtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcucGFyYW1ldGVycy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaF9TZXNzaW9uSWQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICAvLyBTdGFydCB0aGUgY29ubmVjdGlvbiB0byB0aGUgc2VydmljZS4gVGhlIHByb21pc2UgdGhpcyB3aWxsIGNyZWF0ZSBpcyBzdG9yZWQgYW5kIHdpbGwgYmUgdXNlZCBieSBjb25maWd1cmVDb25uZWN0aW9uKCkuXG4gICAgICAgICAgICBjb25zdCBjb25Qcm9taXNlID0gdGhpcy5jb25uZWN0SW1wbCgpO1xuICAgICAgICAgICAgY29uc3QgcHJlQXVkaW9Qcm9taXNlID0gdGhpcy5zZW5kUHJlQXVkaW9NZXNzYWdlcyhwcm9maWxlLCBlbnJvbGxtZW50RGVmZXJyYWwpO1xuICAgICAgICAgICAgY29uc3Qgbm9kZSA9IHlpZWxkIHRoaXMucHJpdlNwZWFrZXJBdWRpb1NvdXJjZS5hdHRhY2godGhpcy5wcml2UmVxdWVzdFNlc3Npb24uYXVkaW9Ob2RlSWQpO1xuICAgICAgICAgICAgY29uc3QgZm9ybWF0ID0geWllbGQgdGhpcy5wcml2U3BlYWtlckF1ZGlvU291cmNlLmZvcm1hdDtcbiAgICAgICAgICAgIGNvbnN0IGRldmljZUluZm8gPSB5aWVsZCB0aGlzLnByaXZTcGVha2VyQXVkaW9Tb3VyY2UuZGV2aWNlSW5mbztcbiAgICAgICAgICAgIGNvbnN0IGF1ZGlvTm9kZSA9IG5ldyBSZXBsYXlhYmxlQXVkaW9Ob2RlKG5vZGUsIGZvcm1hdC5hdmdCeXRlc1BlclNlYyk7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vbkF1ZGlvU291cmNlQXR0YWNoQ29tcGxldGVkKGF1ZGlvTm9kZSwgZmFsc2UpO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5TcGVlY2hTZXJ2aWNlQ29uZmlnLkNvbnRleHQuYXVkaW8gPSB7IHNvdXJjZTogZGV2aWNlSW5mbyB9O1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB5aWVsZCBjb25Qcm9taXNlO1xuICAgICAgICAgICAgICAgIHlpZWxkIHByZUF1ZGlvUHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhbmNlbFJlY29nbml0aW9uKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBDYW5jZWxsYXRpb25SZWFzb24uRXJyb3IsIENhbmNlbGxhdGlvbkVycm9yQ29kZS5Db25uZWN0aW9uRmFpbHVyZSwgZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb25TdGFydEV2ZW50QXJncyA9IG5ldyBTZXNzaW9uRXZlbnRBcmdzKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZSZWNvZ25pemVyLnNlc3Npb25TdGFydGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVjb2duaXplci5zZXNzaW9uU3RhcnRlZCh0aGlzLnByaXZSZWNvZ25pemVyLCBzZXNzaW9uU3RhcnRFdmVudEFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdm9pZCB0aGlzLnJlY2VpdmVNZXNzYWdlKCk7XG4gICAgICAgICAgICBjb25zdCBhdWRpb1NlbmRQcm9taXNlID0gdGhpcy5zZW5kQXVkaW8oYXVkaW9Ob2RlKTtcbiAgICAgICAgICAgIC8vIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgICAgICBhdWRpb1NlbmRQcm9taXNlLnRoZW4oKCkgPT4geyB9LCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhbmNlbFJlY29nbml0aW9uKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBDYW5jZWxsYXRpb25SZWFzb24uRXJyb3IsIENhbmNlbGxhdGlvbkVycm9yQ29kZS5SdW50aW1lRXJyb3IsIGVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGVucm9sbG1lbnREZWZlcnJhbC5wcm9taXNlO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2VuZFByZUF1ZGlvTWVzc2FnZXMocHJvZmlsZSwgZW5yb2xsbWVudERlZmVycmFsKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0geWllbGQgdGhpcy5mZXRjaENvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uU3BlZWNoQ29udGV4dCgpO1xuICAgICAgICAgICAgdGhpcy5wcml2RGVmZXJyYWxNYXAuYWRkKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgZW5yb2xsbWVudERlZmVycmFsKTtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuc2VuZEJhc2VSZXF1ZXN0KGNvbm5lY3Rpb24sIFwiZW5yb2xsXCIsIHRoaXMuc2NlbmFyaW9Gcm9tKHByb2ZpbGUucHJvZmlsZVR5cGUpLCBwcm9maWxlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNlbmRQaHJhc2VzUmVxdWVzdChnZXRQaHJhc2VzRGVmZXJyYWwsIHByb2ZpbGVUeXBlLCBsb2NhbGUpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSB5aWVsZCB0aGlzLmZldGNoQ29ubmVjdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25TcGVlY2hDb250ZXh0KCk7XG4gICAgICAgICAgICB0aGlzLnByaXZEZWZlcnJhbE1hcC5hZGQodGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBnZXRQaHJhc2VzRGVmZXJyYWwpO1xuICAgICAgICAgICAgY29uc3Qgc2NlbmFyaW8gPSB0aGlzLnNjZW5hcmlvRnJvbShwcm9maWxlVHlwZSk7XG4gICAgICAgICAgICBjb25zdCBwcm9maWxlQ3JlYXRlUmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICBsb2NhbGUsXG4gICAgICAgICAgICAgICAgc2NlbmFyaW8sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIGNvbm5lY3Rpb24uc2VuZChuZXcgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UoTWVzc2FnZVR5cGUuVGV4dCwgXCJzcGVha2VyLnByb2ZpbGUucGhyYXNlc1wiLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIFwiYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOFwiLCBKU09OLnN0cmluZ2lmeShwcm9maWxlQ3JlYXRlUmVxdWVzdCkpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNlbmRDcmVhdGVQcm9maWxlKGNyZWF0ZVByb2ZpbGVEZWZlcnJhbCwgcHJvZmlsZVR5cGUsIGxvY2FsZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHlpZWxkIHRoaXMuZmV0Y2hDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblNwZWVjaENvbnRleHQoKTtcbiAgICAgICAgICAgIHRoaXMucHJpdkRlZmVycmFsTWFwLmFkZCh0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIGNyZWF0ZVByb2ZpbGVEZWZlcnJhbCk7XG4gICAgICAgICAgICBjb25zdCBzY2VuYXJpbyA9IHByb2ZpbGVUeXBlID09PSBWb2ljZVByb2ZpbGVUeXBlLlRleHRJbmRlcGVuZGVudElkZW50aWZpY2F0aW9uID8gXCJUZXh0SW5kZXBlbmRlbnRJZGVudGlmaWNhdGlvblwiIDpcbiAgICAgICAgICAgICAgICBwcm9maWxlVHlwZSA9PT0gVm9pY2VQcm9maWxlVHlwZS5UZXh0SW5kZXBlbmRlbnRWZXJpZmljYXRpb24gPyBcIlRleHRJbmRlcGVuZGVudFZlcmlmaWNhdGlvblwiIDogXCJUZXh0RGVwZW5kZW50VmVyaWZpY2F0aW9uXCI7XG4gICAgICAgICAgICBjb25zdCBwcm9maWxlQ3JlYXRlUmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICBsb2NhbGUsXG4gICAgICAgICAgICAgICAgbnVtYmVyOiBcIjFcIixcbiAgICAgICAgICAgICAgICBzY2VuYXJpbyxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gY29ubmVjdGlvbi5zZW5kKG5ldyBTcGVlY2hDb25uZWN0aW9uTWVzc2FnZShNZXNzYWdlVHlwZS5UZXh0LCBcInNwZWFrZXIucHJvZmlsZS5jcmVhdGVcIiwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBcImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLThcIiwgSlNPTi5zdHJpbmdpZnkocHJvZmlsZUNyZWF0ZVJlcXVlc3QpKSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZW5kQ29tbW9uUmVxdWVzdChvcGVyYXRpb24sIHByb2ZpbGVUeXBlLCBwcm9maWxlID0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICAvLyBTdGFydCB0aGUgY29ubmVjdGlvbiB0byB0aGUgc2VydmljZS4gVGhlIHByb21pc2UgdGhpcyB3aWxsIGNyZWF0ZSBpcyBzdG9yZWQgYW5kIHdpbGwgYmUgdXNlZCBieSBjb25maWd1cmVDb25uZWN0aW9uKCkuXG4gICAgICAgICAgICBjb25zdCBjb25Qcm9taXNlID0gdGhpcy5jb25uZWN0SW1wbCgpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBkZWZlcnJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uU3BlZWNoQ29udGV4dCgpO1xuICAgICAgICAgICAgICAgIHlpZWxkIGNvblByb21pc2U7XG4gICAgICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHlpZWxkIHRoaXMuZmV0Y2hDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2RGVmZXJyYWxNYXAuYWRkKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgZGVmZXJyYWwpO1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuc2VuZEJhc2VSZXF1ZXN0KGNvbm5lY3Rpb24sIG9wZXJhdGlvbiwgdGhpcy5zY2VuYXJpb0Zyb20ocHJvZmlsZVR5cGUpLCBwcm9maWxlKTtcbiAgICAgICAgICAgICAgICB2b2lkIHRoaXMucmVjZWl2ZU1lc3NhZ2UoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmZXJyYWwucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZW5kQmFzZVJlcXVlc3QoY29ubmVjdGlvbiwgb3BlcmF0aW9uLCBzY2VuYXJpbywgcHJvZmlsZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgcHJvZmlsZVJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgICAgc2NlbmFyaW9cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoISFwcm9maWxlKSB7XG4gICAgICAgICAgICAgICAgcHJvZmlsZVJlcXVlc3QucHJvZmlsZUlkcyA9IFtwcm9maWxlLnByb2ZpbGVJZF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBwcm9maWxlUmVxdWVzdC5tYXhQYWdlU2l6ZSA9IC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbm5lY3Rpb24uc2VuZChuZXcgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UoTWVzc2FnZVR5cGUuVGV4dCwgYHNwZWFrZXIucHJvZmlsZS4ke29wZXJhdGlvbn1gLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIFwiYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOFwiLCBKU09OLnN0cmluZ2lmeShwcm9maWxlUmVxdWVzdCkpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGV4dHJhY3RTcGVha2VyQ29udGV4dChtb2RlbCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZmVhdHVyZXM6IHtcbiAgICAgICAgICAgICAgICBpbnRlcmltUmVzdWx0OiBcImVuYWJsZWRcIixcbiAgICAgICAgICAgICAgICBwcm9ncmVzc2l2ZURldGVjdGlvbjogXCJkaXNhYmxlZFwiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHByb2ZpbGVJZHM6IG1vZGVsLnByb2ZpbGVJZHMsXG4gICAgICAgICAgICBzY2VuYXJpbzogbW9kZWwuc2NlbmFyaW8sXG4gICAgICAgIH07XG4gICAgfVxuICAgIGhhbmRsZVBocmFzZXNSZXNwb25zZShyZXNwb25zZSwgcmVxdWVzdElkKSB7XG4gICAgICAgIGlmICghIXRoaXMucHJpdkRlZmVycmFsTWFwLmdldElkKHJlcXVlc3RJZCkpIHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMuc3RhdHVzQ29kZS50b0xvd2VyQ2FzZSgpICE9PSBcInN1Y2Nlc3NcIikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlYXNvbiA9IFJlc3VsdFJlYXNvbi5DYW5jZWxlZDtcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgVm9pY2VQcm9maWxlUGhyYXNlUmVzdWx0KHJlYXNvbiwgcmVzcG9uc2Uuc3RhdHVzLnN0YXR1c0NvZGUsIHJlc3BvbnNlLnBhc3NQaHJhc2VUeXBlLCBbXSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2RGVmZXJyYWxNYXAuY29tcGxldGUocmVxdWVzdElkLCByZXN1bHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoISFyZXNwb25zZS5waHJhc2VzICYmIHJlc3BvbnNlLnBocmFzZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlYXNvbiA9IFJlc3VsdFJlYXNvbi5FbnJvbGxpbmdWb2ljZVByb2ZpbGU7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IFZvaWNlUHJvZmlsZVBocmFzZVJlc3VsdChyZWFzb24sIHJlc3BvbnNlLnN0YXR1cy5zdGF0dXNDb2RlLCByZXNwb25zZS5wYXNzUGhyYXNlVHlwZSwgcmVzcG9uc2UucGhyYXNlcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2RGVmZXJyYWxNYXAuY29tcGxldGUocmVxdWVzdElkLCByZXN1bHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVm9pY2UgUHJvZmlsZSBnZXQgYWN0aXZhdGlvbiBwaHJhc2VzIGZhaWxlZCwgbm8gcGhyYXNlcyByZWNlaXZlZFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVm9pY2UgUHJvZmlsZSBnZXQgYWN0aXZhdGlvbiBwaHJhc2VzIHJlcXVlc3QgZm9yIHJlcXVlc3RJRCAke3JlcXVlc3RJZH0gbm90IGZvdW5kYCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFuZGxlQ3JlYXRlUmVzcG9uc2UocmVzcG9uc2UsIHJlcXVlc3RJZCkge1xuICAgICAgICBpZiAoISFyZXNwb25zZS5wcm9maWxlcyAmJiByZXNwb25zZS5wcm9maWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZEZWZlcnJhbE1hcC5nZXRJZChyZXF1ZXN0SWQpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJvZmlsZUlkcyA9IHJlc3BvbnNlLnByb2ZpbGVzLm1hcCgocHJvZmlsZSkgPT4gcHJvZmlsZS5wcm9maWxlSWQpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkRlZmVycmFsTWFwLmNvbXBsZXRlKHJlcXVlc3RJZCwgcHJvZmlsZUlkcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFZvaWNlIFByb2ZpbGUgY3JlYXRlIHJlcXVlc3QgZm9yIHJlcXVlc3RJRCAke3JlcXVlc3RJZH0gbm90IGZvdW5kYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWb2ljZSBQcm9maWxlIGNyZWF0ZSBmYWlsZWQsIG5vIHByb2ZpbGUgaWQgcmVjZWl2ZWRcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFuZGxlUmVzdWx0UmVzcG9uc2UocmVzcG9uc2UsIHJlcXVlc3RJZCkge1xuICAgICAgICBpZiAoISF0aGlzLnByaXZEZWZlcnJhbE1hcC5nZXRJZChyZXF1ZXN0SWQpKSB7XG4gICAgICAgICAgICBjb25zdCBzdWNjZXNzUmVhc29uID0gcmVzcG9uc2Uub3BlcmF0aW9uLnRvTG93ZXJDYXNlKCkgPT09IFwiZGVsZXRlXCIgPyBSZXN1bHRSZWFzb24uRGVsZXRlZFZvaWNlUHJvZmlsZSA6IFJlc3VsdFJlYXNvbi5SZXNldFZvaWNlUHJvZmlsZTtcbiAgICAgICAgICAgIGNvbnN0IHJlYXNvbiA9IHJlc3BvbnNlLnN0YXR1cy5zdGF0dXNDb2RlLnRvTG93ZXJDYXNlKCkgPT09IFwic3VjY2Vzc1wiID8gc3VjY2Vzc1JlYXNvbiA6IFJlc3VsdFJlYXNvbi5DYW5jZWxlZDtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBWb2ljZVByb2ZpbGVSZXN1bHQocmVhc29uLCBgc3RhdHVzQ29kZTogJHtyZXNwb25zZS5zdGF0dXMuc3RhdHVzQ29kZX0sIGVycm9yRGV0YWlsczogJHtyZXNwb25zZS5zdGF0dXMucmVhc29ufWApO1xuICAgICAgICAgICAgdGhpcy5wcml2RGVmZXJyYWxNYXAuY29tcGxldGUocmVxdWVzdElkLCByZXN1bHQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBWb2ljZSBQcm9maWxlIGNyZWF0ZSByZXF1ZXN0IGZvciByZXF1ZXN0SUQgJHtyZXF1ZXN0SWR9IG5vdCBmb3VuZGApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGhhbmRsZUZldGNoUmVzcG9uc2UoZW5yb2xsbWVudFJlc3BvbnNlLCByZXF1ZXN0SWQpIHtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2RGVmZXJyYWxNYXAuZ2V0SWQocmVxdWVzdElkKSAmJiAhIWVucm9sbG1lbnRSZXNwb25zZS5wcm9maWxlc1swXSkge1xuICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2RXhwZWN0ZWRQcm9maWxlSWQgJiYgZW5yb2xsbWVudFJlc3BvbnNlLnByb2ZpbGVzLmxlbmd0aCA9PT0gMSAmJiBlbnJvbGxtZW50UmVzcG9uc2UucHJvZmlsZXNbMF0ucHJvZmlsZUlkID09PSB0aGlzLnByaXZFeHBlY3RlZFByb2ZpbGVJZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkV4cGVjdGVkUHJvZmlsZUlkID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIGNvbnN0IHByb2ZpbGVJbmZvID0gZW5yb2xsbWVudFJlc3BvbnNlLnByb2ZpbGVzWzBdO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBWb2ljZVByb2ZpbGVFbnJvbGxtZW50UmVzdWx0KHRoaXMuZW5yb2xsbWVudFJlYXNvbkZyb20ocHJvZmlsZUluZm8uZW5yb2xsbWVudFN0YXR1cyksIEpTT04uc3RyaW5naWZ5KHByb2ZpbGVJbmZvKSwgZW5yb2xsbWVudFJlc3BvbnNlLnN0YXR1cy5yZWFzb24pO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkRlZmVycmFsTWFwLmNvbXBsZXRlKHJlcXVlc3RJZCwgcmVzdWx0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGVucm9sbG1lbnRSZXNwb25zZS5wcm9maWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaVByb2ZpbGVzID0gZW5yb2xsbWVudFJlc3BvbnNlLnByb2ZpbGVzO1xuICAgICAgICAgICAgICAgIGNvbnN0IHByb2ZpbGVSZXN1bHRzID0gW107XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBwcm9maWxlIG9mIGlQcm9maWxlcykge1xuICAgICAgICAgICAgICAgICAgICBwcm9maWxlUmVzdWx0cy5wdXNoKG5ldyBWb2ljZVByb2ZpbGVFbnJvbGxtZW50UmVzdWx0KHRoaXMuZW5yb2xsbWVudFJlYXNvbkZyb20ocHJvZmlsZS5lbnJvbGxtZW50U3RhdHVzKSwgSlNPTi5zdHJpbmdpZnkocHJvZmlsZSksIGVucm9sbG1lbnRSZXNwb25zZS5zdGF0dXMucmVhc29uKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucHJpdkRlZmVycmFsTWFwLmNvbXBsZXRlKHJlcXVlc3RJZCwgcHJvZmlsZVJlc3VsdHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBWb2ljZSBQcm9maWxlIGZldGNoIHJlcXVlc3QgZm9yIHJlcXVlc3RJRCAke3JlcXVlc3RJZH0gbm90IGZvdW5kYCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZW5yb2xsbWVudFJlYXNvbkZyb20oc3RhdHVzQ29kZSkge1xuICAgICAgICBzd2l0Y2ggKHN0YXR1c0NvZGUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgY2FzZSBcImVucm9sbGVkXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFJlc3VsdFJlYXNvbi5FbnJvbGxlZFZvaWNlUHJvZmlsZTtcbiAgICAgICAgICAgIGNhc2UgXCJpbnZhbGlkbG9jYWxlXCI6XG4gICAgICAgICAgICBjYXNlIFwiaW52YWxpZHBocmFzZVwiOlxuICAgICAgICAgICAgY2FzZSBcImludmFsaWRhdWRpb2Zvcm1hdFwiOlxuICAgICAgICAgICAgY2FzZSBcImludmFsaWRzY2VuYXJpb1wiOlxuICAgICAgICAgICAgY2FzZSBcImludmFsaWRwcm9maWxlY291bnRcIjpcbiAgICAgICAgICAgIGNhc2UgXCJpbnZhbGlkb3BlcmF0aW9uXCI6XG4gICAgICAgICAgICBjYXNlIFwiYXVkaW90b29zaG9ydFwiOlxuICAgICAgICAgICAgY2FzZSBcImF1ZGlvdG9vbG9uZ1wiOlxuICAgICAgICAgICAgY2FzZSBcInRvb21hbnllbnJvbGxtZW50c1wiOlxuICAgICAgICAgICAgY2FzZSBcInN0b3JhZ2Vjb25mbGljdFwiOlxuICAgICAgICAgICAgY2FzZSBcInByb2ZpbGVub3Rmb3VuZFwiOlxuICAgICAgICAgICAgY2FzZSBcImluY29tcGF0aWJsZXByb2ZpbGVzXCI6XG4gICAgICAgICAgICBjYXNlIFwiaW5jb21wbGV0ZWVucm9sbG1lbnRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gUmVzdWx0UmVhc29uLkNhbmNlbGVkO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gUmVzdWx0UmVhc29uLkVucm9sbGluZ1ZvaWNlUHJvZmlsZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzY2VuYXJpb0Zyb20ocHJvZmlsZVR5cGUpIHtcbiAgICAgICAgcmV0dXJuIHByb2ZpbGVUeXBlID09PSBWb2ljZVByb2ZpbGVUeXBlLlRleHRJbmRlcGVuZGVudElkZW50aWZpY2F0aW9uID8gXCJUZXh0SW5kZXBlbmRlbnRJZGVudGlmaWNhdGlvblwiIDpcbiAgICAgICAgICAgIHByb2ZpbGVUeXBlID09PSBWb2ljZVByb2ZpbGVUeXBlLlRleHRJbmRlcGVuZGVudFZlcmlmaWNhdGlvbiA/IFwiVGV4dEluZGVwZW5kZW50VmVyaWZpY2F0aW9uXCIgOiBcIlRleHREZXBlbmRlbnRWZXJpZmljYXRpb25cIjtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVZvaWNlU2VydmljZVJlY29nbml6ZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IENvbm5lY3Rpb25NZXNzYWdlLCBEZWZlcnJlZCwgTWVzc2FnZVR5cGUsIFJhd1dlYnNvY2tldE1lc3NhZ2UsIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5jb25zdCBDUkxGID0gXCJcXHJcXG5cIjtcbmV4cG9ydCBjbGFzcyBXZWJzb2NrZXRNZXNzYWdlRm9ybWF0dGVyIHtcbiAgICB0b0Nvbm5lY3Rpb25NZXNzYWdlKG1lc3NhZ2UpIHtcbiAgICAgICAgY29uc3QgZGVmZXJyYWwgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlLm1lc3NhZ2VUeXBlID09PSBNZXNzYWdlVHlwZS5UZXh0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGV4dE1lc3NhZ2UgPSBtZXNzYWdlLnRleHRDb250ZW50O1xuICAgICAgICAgICAgICAgIGxldCBoZWFkZXJzID0ge307XG4gICAgICAgICAgICAgICAgbGV0IGJvZHkgPSBudWxsO1xuICAgICAgICAgICAgICAgIGlmICh0ZXh0TWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJCb2R5U3BsaXQgPSB0ZXh0TWVzc2FnZS5zcGxpdChcIlxcclxcblxcclxcblwiKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGhlYWRlckJvZHlTcGxpdCAmJiBoZWFkZXJCb2R5U3BsaXQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVycyA9IHRoaXMucGFyc2VIZWFkZXJzKGhlYWRlckJvZHlTcGxpdFswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGVhZGVyQm9keVNwbGl0Lmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib2R5ID0gaGVhZGVyQm9keVNwbGl0WzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGRlZmVycmFsLnJlc29sdmUobmV3IENvbm5lY3Rpb25NZXNzYWdlKG1lc3NhZ2UubWVzc2FnZVR5cGUsIGJvZHksIGhlYWRlcnMsIG1lc3NhZ2UuaWQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG1lc3NhZ2UubWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLkJpbmFyeSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJpbmFyeU1lc3NhZ2UgPSBtZXNzYWdlLmJpbmFyeUNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgbGV0IGhlYWRlcnMgPSB7fTtcbiAgICAgICAgICAgICAgICBsZXQgYm9keSA9IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKCFiaW5hcnlNZXNzYWdlIHx8IGJpbmFyeU1lc3NhZ2UuYnl0ZUxlbmd0aCA8IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBiaW5hcnkgbWVzc2FnZSBmb3JtYXQuIEhlYWRlciBsZW5ndGggbWlzc2luZy5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFWaWV3ID0gbmV3IERhdGFWaWV3KGJpbmFyeU1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlckxlbmd0aCA9IGRhdGFWaWV3LmdldEludDE2KDApO1xuICAgICAgICAgICAgICAgIGlmIChiaW5hcnlNZXNzYWdlLmJ5dGVMZW5ndGggPCBoZWFkZXJMZW5ndGggKyAyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgYmluYXJ5IG1lc3NhZ2UgZm9ybWF0LiBIZWFkZXIgY29udGVudCBtaXNzaW5nLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGV0IGhlYWRlcnNTdHJpbmcgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaGVhZGVyTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1N0cmluZyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKChkYXRhVmlldykuZ2V0SW50OChpICsgMikpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBoZWFkZXJzID0gdGhpcy5wYXJzZUhlYWRlcnMoaGVhZGVyc1N0cmluZyk7XG4gICAgICAgICAgICAgICAgaWYgKGJpbmFyeU1lc3NhZ2UuYnl0ZUxlbmd0aCA+IGhlYWRlckxlbmd0aCArIDIpIHtcbiAgICAgICAgICAgICAgICAgICAgYm9keSA9IGJpbmFyeU1lc3NhZ2Uuc2xpY2UoMiArIGhlYWRlckxlbmd0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGRlZmVycmFsLnJlc29sdmUobmV3IENvbm5lY3Rpb25NZXNzYWdlKG1lc3NhZ2UubWVzc2FnZVR5cGUsIGJvZHksIGhlYWRlcnMsIG1lc3NhZ2UuaWQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgZGVmZXJyYWwucmVqZWN0KGBFcnJvciBmb3JtYXR0aW5nIHRoZSBtZXNzYWdlLiBFcnJvcjogJHtlfWApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZWZlcnJhbC5wcm9taXNlO1xuICAgIH1cbiAgICBmcm9tQ29ubmVjdGlvbk1lc3NhZ2UobWVzc2FnZSkge1xuICAgICAgICBjb25zdCBkZWZlcnJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2UubWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLlRleHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXlsb2FkID0gYCR7dGhpcy5tYWtlSGVhZGVycyhtZXNzYWdlKX0ke0NSTEZ9JHttZXNzYWdlLnRleHRCb2R5ID8gbWVzc2FnZS50ZXh0Qm9keSA6IFwiXCJ9YDtcbiAgICAgICAgICAgICAgICBkZWZlcnJhbC5yZXNvbHZlKG5ldyBSYXdXZWJzb2NrZXRNZXNzYWdlKE1lc3NhZ2VUeXBlLlRleHQsIHBheWxvYWQsIG1lc3NhZ2UuaWQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG1lc3NhZ2UubWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLkJpbmFyeSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlcnNTdHJpbmcgPSB0aGlzLm1ha2VIZWFkZXJzKG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBtZXNzYWdlLmJpbmFyeUJvZHk7XG4gICAgICAgICAgICAgICAgY29uc3QgaGVhZGVyQnVmZmVyID0gdGhpcy5zdHJpbmdUb0FycmF5QnVmZmVyKGhlYWRlcnNTdHJpbmcpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlckludDhBcnJheSA9IG5ldyBJbnQ4QXJyYXkoaGVhZGVyQnVmZmVyKTtcbiAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJMZW5ndGggPSBoZWFkZXJJbnQ4QXJyYXkuYnl0ZUxlbmd0aDtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXlsb2FkSW50OEFycmF5ID0gbmV3IEludDhBcnJheSgyICsgaGVhZGVyTGVuZ3RoICsgKGNvbnRlbnQgPyBjb250ZW50LmJ5dGVMZW5ndGggOiAwKSk7XG4gICAgICAgICAgICAgICAgcGF5bG9hZEludDhBcnJheVswXSA9ICgoaGVhZGVyTGVuZ3RoID4+IDgpICYgMHhmZik7XG4gICAgICAgICAgICAgICAgcGF5bG9hZEludDhBcnJheVsxXSA9IGhlYWRlckxlbmd0aCAmIDB4ZmY7XG4gICAgICAgICAgICAgICAgcGF5bG9hZEludDhBcnJheS5zZXQoaGVhZGVySW50OEFycmF5LCAyKTtcbiAgICAgICAgICAgICAgICBpZiAoY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBib2R5SW50OEFycmF5ID0gbmV3IEludDhBcnJheShjb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgcGF5bG9hZEludDhBcnJheS5zZXQoYm9keUludDhBcnJheSwgMiArIGhlYWRlckxlbmd0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHBheWxvYWQgPSBwYXlsb2FkSW50OEFycmF5LmJ1ZmZlcjtcbiAgICAgICAgICAgICAgICBkZWZlcnJhbC5yZXNvbHZlKG5ldyBSYXdXZWJzb2NrZXRNZXNzYWdlKE1lc3NhZ2VUeXBlLkJpbmFyeSwgcGF5bG9hZCwgbWVzc2FnZS5pZCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBkZWZlcnJhbC5yZWplY3QoYEVycm9yIGZvcm1hdHRpbmcgdGhlIG1lc3NhZ2UuICR7ZX1gKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGVmZXJyYWwucHJvbWlzZTtcbiAgICB9XG4gICAgbWFrZUhlYWRlcnMobWVzc2FnZSkge1xuICAgICAgICBsZXQgaGVhZGVyc1N0cmluZyA9IFwiXCI7XG4gICAgICAgIGlmIChtZXNzYWdlLmhlYWRlcnMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgaGVhZGVyIGluIG1lc3NhZ2UuaGVhZGVycykge1xuICAgICAgICAgICAgICAgIGlmIChoZWFkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1N0cmluZyArPSBgJHtoZWFkZXJ9OiAke21lc3NhZ2UuaGVhZGVyc1toZWFkZXJdfSR7Q1JMRn1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaGVhZGVyc1N0cmluZztcbiAgICB9XG4gICAgcGFyc2VIZWFkZXJzKGhlYWRlcnNTdHJpbmcpIHtcbiAgICAgICAgY29uc3QgaGVhZGVycyA9IHt9O1xuICAgICAgICBpZiAoaGVhZGVyc1N0cmluZykge1xuICAgICAgICAgICAgY29uc3QgaGVhZGVyTWF0Y2hlcyA9IGhlYWRlcnNTdHJpbmcubWF0Y2goL1teXFxyXFxuXSsvZyk7XG4gICAgICAgICAgICBpZiAoaGVhZGVycykge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaGVhZGVyIG9mIGhlYWRlck1hdGNoZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGhlYWRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VwYXJhdG9ySW5kZXggPSBoZWFkZXIuaW5kZXhPZihcIjpcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJOYW1lID0gc2VwYXJhdG9ySW5kZXggPiAwID8gaGVhZGVyLnN1YnN0cigwLCBzZXBhcmF0b3JJbmRleCkudHJpbSgpLnRvTG93ZXJDYXNlKCkgOiBoZWFkZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJWYWx1ZSA9IHNlcGFyYXRvckluZGV4ID4gMCAmJiBoZWFkZXIubGVuZ3RoID4gKHNlcGFyYXRvckluZGV4ICsgMSkgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlci5zdWJzdHIoc2VwYXJhdG9ySW5kZXggKyAxKS50cmltKCkgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzW2hlYWRlck5hbWVdID0gaGVhZGVyVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGhlYWRlcnM7XG4gICAgfVxuICAgIHN0cmluZ1RvQXJyYXlCdWZmZXIoc3RyKSB7XG4gICAgICAgIGNvbnN0IGJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihzdHIubGVuZ3RoKTtcbiAgICAgICAgY29uc3QgdmlldyA9IG5ldyBEYXRhVmlldyhidWZmZXIpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmlldy5zZXRVaW50OChpLCBzdHIuY2hhckNvZGVBdChpKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJ1ZmZlcjtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVdlYnNvY2tldE1lc3NhZ2VGb3JtYXR0ZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qIGVzbGludC1kaXNhYmxlIG1heC1jbGFzc2VzLXBlci1maWxlICovXG5pbXBvcnQgeyBFdmVudFR5cGUsIFBsYXRmb3JtRXZlbnQgfSBmcm9tIFwiLi9QbGF0Zm9ybUV2ZW50XCI7XG5leHBvcnQgY2xhc3MgQXVkaW9Tb3VyY2VFdmVudCBleHRlbmRzIFBsYXRmb3JtRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKGV2ZW50TmFtZSwgYXVkaW9Tb3VyY2VJZCwgZXZlbnRUeXBlID0gRXZlbnRUeXBlLkluZm8pIHtcbiAgICAgICAgc3VwZXIoZXZlbnROYW1lLCBldmVudFR5cGUpO1xuICAgICAgICB0aGlzLnByaXZBdWRpb1NvdXJjZUlkID0gYXVkaW9Tb3VyY2VJZDtcbiAgICB9XG4gICAgZ2V0IGF1ZGlvU291cmNlSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb1NvdXJjZUlkO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBBdWRpb1NvdXJjZUluaXRpYWxpemluZ0V2ZW50IGV4dGVuZHMgQXVkaW9Tb3VyY2VFdmVudCB7XG4gICAgY29uc3RydWN0b3IoYXVkaW9Tb3VyY2VJZCkge1xuICAgICAgICBzdXBlcihcIkF1ZGlvU291cmNlSW5pdGlhbGl6aW5nRXZlbnRcIiwgYXVkaW9Tb3VyY2VJZCk7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIEF1ZGlvU291cmNlUmVhZHlFdmVudCBleHRlbmRzIEF1ZGlvU291cmNlRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKGF1ZGlvU291cmNlSWQpIHtcbiAgICAgICAgc3VwZXIoXCJBdWRpb1NvdXJjZVJlYWR5RXZlbnRcIiwgYXVkaW9Tb3VyY2VJZCk7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIEF1ZGlvU291cmNlT2ZmRXZlbnQgZXh0ZW5kcyBBdWRpb1NvdXJjZUV2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihhdWRpb1NvdXJjZUlkKSB7XG4gICAgICAgIHN1cGVyKFwiQXVkaW9Tb3VyY2VPZmZFdmVudFwiLCBhdWRpb1NvdXJjZUlkKTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgQXVkaW9Tb3VyY2VFcnJvckV2ZW50IGV4dGVuZHMgQXVkaW9Tb3VyY2VFdmVudCB7XG4gICAgY29uc3RydWN0b3IoYXVkaW9Tb3VyY2VJZCwgZXJyb3IpIHtcbiAgICAgICAgc3VwZXIoXCJBdWRpb1NvdXJjZUVycm9yRXZlbnRcIiwgYXVkaW9Tb3VyY2VJZCwgRXZlbnRUeXBlLkVycm9yKTtcbiAgICAgICAgdGhpcy5wcml2RXJyb3IgPSBlcnJvcjtcbiAgICB9XG4gICAgZ2V0IGVycm9yKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXJyb3I7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIEF1ZGlvU3RyZWFtTm9kZUV2ZW50IGV4dGVuZHMgQXVkaW9Tb3VyY2VFdmVudCB7XG4gICAgY29uc3RydWN0b3IoZXZlbnROYW1lLCBhdWRpb1NvdXJjZUlkLCBhdWRpb05vZGVJZCkge1xuICAgICAgICBzdXBlcihldmVudE5hbWUsIGF1ZGlvU291cmNlSWQpO1xuICAgICAgICB0aGlzLnByaXZBdWRpb05vZGVJZCA9IGF1ZGlvTm9kZUlkO1xuICAgIH1cbiAgICBnZXQgYXVkaW9Ob2RlSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb05vZGVJZDtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgQXVkaW9TdHJlYW1Ob2RlQXR0YWNoaW5nRXZlbnQgZXh0ZW5kcyBBdWRpb1N0cmVhbU5vZGVFdmVudCB7XG4gICAgY29uc3RydWN0b3IoYXVkaW9Tb3VyY2VJZCwgYXVkaW9Ob2RlSWQpIHtcbiAgICAgICAgc3VwZXIoXCJBdWRpb1N0cmVhbU5vZGVBdHRhY2hpbmdFdmVudFwiLCBhdWRpb1NvdXJjZUlkLCBhdWRpb05vZGVJZCk7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIEF1ZGlvU3RyZWFtTm9kZUF0dGFjaGVkRXZlbnQgZXh0ZW5kcyBBdWRpb1N0cmVhbU5vZGVFdmVudCB7XG4gICAgY29uc3RydWN0b3IoYXVkaW9Tb3VyY2VJZCwgYXVkaW9Ob2RlSWQpIHtcbiAgICAgICAgc3VwZXIoXCJBdWRpb1N0cmVhbU5vZGVBdHRhY2hlZEV2ZW50XCIsIGF1ZGlvU291cmNlSWQsIGF1ZGlvTm9kZUlkKTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgQXVkaW9TdHJlYW1Ob2RlRGV0YWNoZWRFdmVudCBleHRlbmRzIEF1ZGlvU3RyZWFtTm9kZUV2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihhdWRpb1NvdXJjZUlkLCBhdWRpb05vZGVJZCkge1xuICAgICAgICBzdXBlcihcIkF1ZGlvU3RyZWFtTm9kZURldGFjaGVkRXZlbnRcIiwgYXVkaW9Tb3VyY2VJZCwgYXVkaW9Ob2RlSWQpO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBBdWRpb1N0cmVhbU5vZGVFcnJvckV2ZW50IGV4dGVuZHMgQXVkaW9TdHJlYW1Ob2RlRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKGF1ZGlvU291cmNlSWQsIGF1ZGlvTm9kZUlkLCBlcnJvcikge1xuICAgICAgICBzdXBlcihcIkF1ZGlvU3RyZWFtTm9kZUVycm9yRXZlbnRcIiwgYXVkaW9Tb3VyY2VJZCwgYXVkaW9Ob2RlSWQpO1xuICAgICAgICB0aGlzLnByaXZFcnJvciA9IGVycm9yO1xuICAgIH1cbiAgICBnZXQgZXJyb3IoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZFcnJvcjtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUF1ZGlvU291cmNlRXZlbnRzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBFdmVudFR5cGUsIFBsYXRmb3JtRXZlbnQgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG5leHBvcnQgY2xhc3MgQmFja2dyb3VuZEV2ZW50IGV4dGVuZHMgUGxhdGZvcm1FdmVudCB7XG4gICAgY29uc3RydWN0b3IoZXJyb3IpIHtcbiAgICAgICAgc3VwZXIoXCJCYWNrZ3JvdW5kRXZlbnRcIiwgRXZlbnRUeXBlLkVycm9yKTtcbiAgICAgICAgdGhpcy5wcml2RXJyb3IgPSBlcnJvcjtcbiAgICB9XG4gICAgZ2V0IGVycm9yKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXJyb3I7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1CYWNrZ3JvdW5kRXJyb3IuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFN0cmVhbSB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbmV4cG9ydCBjbGFzcyBDaHVua2VkQXJyYXlCdWZmZXJTdHJlYW0gZXh0ZW5kcyBTdHJlYW0ge1xuICAgIGNvbnN0cnVjdG9yKHRhcmdldENodW5rU2l6ZSwgc3RyZWFtSWQpIHtcbiAgICAgICAgc3VwZXIoc3RyZWFtSWQpO1xuICAgICAgICB0aGlzLnByaXZUYXJnZXRDaHVua1NpemUgPSB0YXJnZXRDaHVua1NpemU7XG4gICAgICAgIHRoaXMucHJpdk5leHRCdWZmZXJSZWFkeUJ5dGVzID0gMDtcbiAgICB9XG4gICAgd3JpdGVTdHJlYW1DaHVuayhjaHVuaykge1xuICAgICAgICAvLyBObyBwZW5kaW5nIHdyaXRlLCBhbmQgdGhlIGJ1ZmZlciBpcyB0aGUgcmlnaHQgc2l6ZSBzbyB3cml0ZSBpdC5cbiAgICAgICAgaWYgKGNodW5rLmlzRW5kIHx8XG4gICAgICAgICAgICAoMCA9PT0gdGhpcy5wcml2TmV4dEJ1ZmZlclJlYWR5Qnl0ZXMgJiYgY2h1bmsuYnVmZmVyLmJ5dGVMZW5ndGggPT09IHRoaXMucHJpdlRhcmdldENodW5rU2l6ZSkpIHtcbiAgICAgICAgICAgIHN1cGVyLndyaXRlU3RyZWFtQ2h1bmsoY2h1bmspO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCBieXRlc0NvcGllZEZyb21CdWZmZXIgPSAwO1xuICAgICAgICB3aGlsZSAoYnl0ZXNDb3BpZWRGcm9tQnVmZmVyIDwgY2h1bmsuYnVmZmVyLmJ5dGVMZW5ndGgpIHtcbiAgICAgICAgICAgIC8vIEZpbGwgdGhlIG5leHQgYnVmZmVyLlxuICAgICAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gdGhpcy5wcml2TmV4dEJ1ZmZlclRvV3JpdGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZOZXh0QnVmZmVyVG9Xcml0ZSA9IG5ldyBBcnJheUJ1ZmZlcih0aGlzLnByaXZUYXJnZXRDaHVua1NpemUpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdk5leHRCdWZmZXJTdGFydFRpbWUgPSBjaHVuay50aW1lUmVjZWl2ZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBGaW5kIG91dCBob3cgbWFueSBieXRlcyB3ZSBjYW4gY29weSBpbnRvIHRoZSByZWFkIGJ1ZmZlci5cbiAgICAgICAgICAgIGNvbnN0IGJ5dGVzVG9Db3B5ID0gTWF0aC5taW4oY2h1bmsuYnVmZmVyLmJ5dGVMZW5ndGggLSBieXRlc0NvcGllZEZyb21CdWZmZXIsIHRoaXMucHJpdlRhcmdldENodW5rU2l6ZSAtIHRoaXMucHJpdk5leHRCdWZmZXJSZWFkeUJ5dGVzKTtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldFZpZXcgPSBuZXcgVWludDhBcnJheSh0aGlzLnByaXZOZXh0QnVmZmVyVG9Xcml0ZSk7XG4gICAgICAgICAgICBjb25zdCBzb3VyY2VWaWV3ID0gbmV3IFVpbnQ4QXJyYXkoY2h1bmsuYnVmZmVyLnNsaWNlKGJ5dGVzQ29waWVkRnJvbUJ1ZmZlciwgYnl0ZXNUb0NvcHkgKyBieXRlc0NvcGllZEZyb21CdWZmZXIpKTtcbiAgICAgICAgICAgIHRhcmdldFZpZXcuc2V0KHNvdXJjZVZpZXcsIHRoaXMucHJpdk5leHRCdWZmZXJSZWFkeUJ5dGVzKTtcbiAgICAgICAgICAgIHRoaXMucHJpdk5leHRCdWZmZXJSZWFkeUJ5dGVzICs9IGJ5dGVzVG9Db3B5O1xuICAgICAgICAgICAgYnl0ZXNDb3BpZWRGcm9tQnVmZmVyICs9IGJ5dGVzVG9Db3B5O1xuICAgICAgICAgICAgLy8gQXJlIHdlIHJlYWR5IHRvIHdyaXRlP1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdk5leHRCdWZmZXJSZWFkeUJ5dGVzID09PSB0aGlzLnByaXZUYXJnZXRDaHVua1NpemUpIHtcbiAgICAgICAgICAgICAgICBzdXBlci53cml0ZVN0cmVhbUNodW5rKHtcbiAgICAgICAgICAgICAgICAgICAgYnVmZmVyOiB0aGlzLnByaXZOZXh0QnVmZmVyVG9Xcml0ZSxcbiAgICAgICAgICAgICAgICAgICAgaXNFbmQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB0aW1lUmVjZWl2ZWQ6IHRoaXMucHJpdk5leHRCdWZmZXJTdGFydFRpbWUsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2TmV4dEJ1ZmZlclJlYWR5Qnl0ZXMgPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdk5leHRCdWZmZXJUb1dyaXRlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgICAvLyBTZW5kIHdoYXRldmVyIGlzIHBlbmRpbmcsIHRoZW4gY2xvc2UgdGhlIGJhc2UgY2xhc3MuXG4gICAgICAgIGlmICgwICE9PSB0aGlzLnByaXZOZXh0QnVmZmVyUmVhZHlCeXRlcyAmJiAhdGhpcy5pc0Nsb3NlZCkge1xuICAgICAgICAgICAgc3VwZXIud3JpdGVTdHJlYW1DaHVuayh7XG4gICAgICAgICAgICAgICAgYnVmZmVyOiB0aGlzLnByaXZOZXh0QnVmZmVyVG9Xcml0ZS5zbGljZSgwLCB0aGlzLnByaXZOZXh0QnVmZmVyUmVhZHlCeXRlcyksXG4gICAgICAgICAgICAgICAgaXNFbmQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRpbWVSZWNlaXZlZDogdGhpcy5wcml2TmV4dEJ1ZmZlclN0YXJ0VGltZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1DaHVua2VkQXJyYXlCdWZmZXJTdHJlYW0uanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IEV2ZW50VHlwZSwgUGxhdGZvcm1FdmVudCB9IGZyb20gXCIuL1BsYXRmb3JtRXZlbnRcIjtcbmV4cG9ydCBjbGFzcyBTZXJ2aWNlRXZlbnQgZXh0ZW5kcyBQbGF0Zm9ybUV2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihldmVudE5hbWUsIGpzb25zdHJpbmcsIGV2ZW50VHlwZSA9IEV2ZW50VHlwZS5JbmZvKSB7XG4gICAgICAgIHN1cGVyKGV2ZW50TmFtZSwgZXZlbnRUeXBlKTtcbiAgICAgICAgdGhpcy5wcml2SnNvblJlc3VsdCA9IGpzb25zdHJpbmc7XG4gICAgfVxuICAgIGdldCBqc29uU3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SnNvblJlc3VsdDtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgQ29ubmVjdGlvbkV2ZW50IGV4dGVuZHMgUGxhdGZvcm1FdmVudCB7XG4gICAgY29uc3RydWN0b3IoZXZlbnROYW1lLCBjb25uZWN0aW9uSWQsIGV2ZW50VHlwZSA9IEV2ZW50VHlwZS5JbmZvKSB7XG4gICAgICAgIHN1cGVyKGV2ZW50TmFtZSwgZXZlbnRUeXBlKTtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbklkID0gY29ubmVjdGlvbklkO1xuICAgIH1cbiAgICBnZXQgY29ubmVjdGlvbklkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvbklkO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBDb25uZWN0aW9uU3RhcnRFdmVudCBleHRlbmRzIENvbm5lY3Rpb25FdmVudCB7XG4gICAgY29uc3RydWN0b3IoY29ubmVjdGlvbklkLCB1cmksIGhlYWRlcnMpIHtcbiAgICAgICAgc3VwZXIoXCJDb25uZWN0aW9uU3RhcnRFdmVudFwiLCBjb25uZWN0aW9uSWQpO1xuICAgICAgICB0aGlzLnByaXZVcmkgPSB1cmk7XG4gICAgICAgIHRoaXMucHJpdkhlYWRlcnMgPSBoZWFkZXJzO1xuICAgIH1cbiAgICBnZXQgdXJpKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VXJpO1xuICAgIH1cbiAgICBnZXQgaGVhZGVycygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkhlYWRlcnM7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIENvbm5lY3Rpb25Fc3RhYmxpc2hlZEV2ZW50IGV4dGVuZHMgQ29ubmVjdGlvbkV2ZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihjb25uZWN0aW9uSWQpIHtcbiAgICAgICAgc3VwZXIoXCJDb25uZWN0aW9uRXN0YWJsaXNoZWRFdmVudFwiLCBjb25uZWN0aW9uSWQpO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBDb25uZWN0aW9uQ2xvc2VkRXZlbnQgZXh0ZW5kcyBDb25uZWN0aW9uRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKGNvbm5lY3Rpb25JZCwgc3RhdHVzQ29kZSwgcmVhc29uKSB7XG4gICAgICAgIHN1cGVyKFwiQ29ubmVjdGlvbkNsb3NlZEV2ZW50XCIsIGNvbm5lY3Rpb25JZCwgRXZlbnRUeXBlLkRlYnVnKTtcbiAgICAgICAgdGhpcy5wcml2UmVhc29uID0gcmVhc29uO1xuICAgICAgICB0aGlzLnByaXZTdGF0dXNDb2RlID0gc3RhdHVzQ29kZTtcbiAgICB9XG4gICAgZ2V0IHJlYXNvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlYXNvbjtcbiAgICB9XG4gICAgZ2V0IHN0YXR1c0NvZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTdGF0dXNDb2RlO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBDb25uZWN0aW9uRXJyb3JFdmVudCBleHRlbmRzIENvbm5lY3Rpb25FdmVudCB7XG4gICAgY29uc3RydWN0b3IoY29ubmVjdGlvbklkLCBtZXNzYWdlLCB0eXBlKSB7XG4gICAgICAgIHN1cGVyKFwiQ29ubmVjdGlvbkVycm9yRXZlbnRcIiwgY29ubmVjdGlvbklkLCBFdmVudFR5cGUuRGVidWcpO1xuICAgICAgICB0aGlzLnByaXZNZXNzYWdlID0gbWVzc2FnZTtcbiAgICAgICAgdGhpcy5wcml2VHlwZSA9IHR5cGU7XG4gICAgfVxuICAgIGdldCBtZXNzYWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TWVzc2FnZTtcbiAgICB9XG4gICAgZ2V0IHR5cGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUeXBlO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBDb25uZWN0aW9uRXN0YWJsaXNoRXJyb3JFdmVudCBleHRlbmRzIENvbm5lY3Rpb25FdmVudCB7XG4gICAgY29uc3RydWN0b3IoY29ubmVjdGlvbklkLCBzdGF0dXNjb2RlLCByZWFzb24pIHtcbiAgICAgICAgc3VwZXIoXCJDb25uZWN0aW9uRXN0YWJsaXNoRXJyb3JFdmVudFwiLCBjb25uZWN0aW9uSWQsIEV2ZW50VHlwZS5FcnJvcik7XG4gICAgICAgIHRoaXMucHJpdlN0YXR1c0NvZGUgPSBzdGF0dXNjb2RlO1xuICAgICAgICB0aGlzLnByaXZSZWFzb24gPSByZWFzb247XG4gICAgfVxuICAgIGdldCByZWFzb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZWFzb247XG4gICAgfVxuICAgIGdldCBzdGF0dXNDb2RlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3RhdHVzQ29kZTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgQ29ubmVjdGlvbk1lc3NhZ2VSZWNlaXZlZEV2ZW50IGV4dGVuZHMgQ29ubmVjdGlvbkV2ZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihjb25uZWN0aW9uSWQsIG5ldHdvcmtSZWNlaXZlZFRpbWVJU08sIG1lc3NhZ2UpIHtcbiAgICAgICAgc3VwZXIoXCJDb25uZWN0aW9uTWVzc2FnZVJlY2VpdmVkRXZlbnRcIiwgY29ubmVjdGlvbklkKTtcbiAgICAgICAgdGhpcy5wcml2TmV0d29ya1JlY2VpdmVkVGltZSA9IG5ldHdvcmtSZWNlaXZlZFRpbWVJU087XG4gICAgICAgIHRoaXMucHJpdk1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIH1cbiAgICBnZXQgbmV0d29ya1JlY2VpdmVkVGltZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdk5ldHdvcmtSZWNlaXZlZFRpbWU7XG4gICAgfVxuICAgIGdldCBtZXNzYWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TWVzc2FnZTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgQ29ubmVjdGlvbk1lc3NhZ2VTZW50RXZlbnQgZXh0ZW5kcyBDb25uZWN0aW9uRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKGNvbm5lY3Rpb25JZCwgbmV0d29ya1NlbnRUaW1lSVNPLCBtZXNzYWdlKSB7XG4gICAgICAgIHN1cGVyKFwiQ29ubmVjdGlvbk1lc3NhZ2VTZW50RXZlbnRcIiwgY29ubmVjdGlvbklkKTtcbiAgICAgICAgdGhpcy5wcml2TmV0d29ya1NlbnRUaW1lID0gbmV0d29ya1NlbnRUaW1lSVNPO1xuICAgICAgICB0aGlzLnByaXZNZXNzYWdlID0gbWVzc2FnZTtcbiAgICB9XG4gICAgZ2V0IG5ldHdvcmtTZW50VGltZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdk5ldHdvcmtTZW50VGltZTtcbiAgICB9XG4gICAgZ2V0IG1lc3NhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZNZXNzYWdlO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29ubmVjdGlvbkV2ZW50cy5qcy5tYXBcbiIsIi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtcmV0dXJuICovXG4vLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IEludmFsaWRPcGVyYXRpb25FcnJvciB9IGZyb20gXCIuL0Vycm9yXCI7XG5pbXBvcnQgeyBjcmVhdGVOb0Rhc2hHdWlkIH0gZnJvbSBcIi4vR3VpZFwiO1xuZXhwb3J0IHZhciBNZXNzYWdlVHlwZTtcbihmdW5jdGlvbiAoTWVzc2FnZVR5cGUpIHtcbiAgICBNZXNzYWdlVHlwZVtNZXNzYWdlVHlwZVtcIlRleHRcIl0gPSAwXSA9IFwiVGV4dFwiO1xuICAgIE1lc3NhZ2VUeXBlW01lc3NhZ2VUeXBlW1wiQmluYXJ5XCJdID0gMV0gPSBcIkJpbmFyeVwiO1xufSkoTWVzc2FnZVR5cGUgfHwgKE1lc3NhZ2VUeXBlID0ge30pKTtcbmV4cG9ydCBjbGFzcyBDb25uZWN0aW9uTWVzc2FnZSB7XG4gICAgY29uc3RydWN0b3IobWVzc2FnZVR5cGUsIGJvZHksIGhlYWRlcnMsIGlkKSB7XG4gICAgICAgIHRoaXMucHJpdkJvZHkgPSBudWxsO1xuICAgICAgICBpZiAobWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLlRleHQgJiYgYm9keSAmJiAhKHR5cGVvZiAoYm9keSkgPT09IFwic3RyaW5nXCIpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZE9wZXJhdGlvbkVycm9yKFwiUGF5bG9hZCBtdXN0IGJlIGEgc3RyaW5nXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtZXNzYWdlVHlwZSA9PT0gTWVzc2FnZVR5cGUuQmluYXJ5ICYmIGJvZHkgJiYgIShib2R5IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZE9wZXJhdGlvbkVycm9yKFwiUGF5bG9hZCBtdXN0IGJlIEFycmF5QnVmZmVyXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdk1lc3NhZ2VUeXBlID0gbWVzc2FnZVR5cGU7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFzc2lnbm1lbnRcbiAgICAgICAgdGhpcy5wcml2Qm9keSA9IGJvZHk7XG4gICAgICAgIHRoaXMucHJpdkhlYWRlcnMgPSBoZWFkZXJzID8gaGVhZGVycyA6IHt9O1xuICAgICAgICB0aGlzLnByaXZJZCA9IGlkID8gaWQgOiBjcmVhdGVOb0Rhc2hHdWlkKCk7XG4gICAgICAgIHN3aXRjaCAodGhpcy5tZXNzYWdlVHlwZSkge1xuICAgICAgICAgICAgY2FzZSBNZXNzYWdlVHlwZS5CaW5hcnk6XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U2l6ZSA9IHRoaXMuYmluYXJ5Qm9keSAhPT0gbnVsbCA/IHRoaXMuYmluYXJ5Qm9keS5ieXRlTGVuZ3RoIDogMDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgTWVzc2FnZVR5cGUuVGV4dDpcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTaXplID0gdGhpcy50ZXh0Qm9keS5sZW5ndGg7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IG1lc3NhZ2VUeXBlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TWVzc2FnZVR5cGU7XG4gICAgfVxuICAgIGdldCBoZWFkZXJzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SGVhZGVycztcbiAgICB9XG4gICAgZ2V0IGJvZHkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZCb2R5O1xuICAgIH1cbiAgICBnZXQgdGV4dEJvZHkoKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZNZXNzYWdlVHlwZSA9PT0gTWVzc2FnZVR5cGUuQmluYXJ5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZE9wZXJhdGlvbkVycm9yKFwiTm90IHN1cHBvcnRlZCBmb3IgYmluYXJ5IG1lc3NhZ2VcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkJvZHk7XG4gICAgfVxuICAgIGdldCBiaW5hcnlCb2R5KCkge1xuICAgICAgICBpZiAodGhpcy5wcml2TWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLlRleHQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXJyb3IoXCJOb3Qgc3VwcG9ydGVkIGZvciB0ZXh0IG1lc3NhZ2VcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkJvZHk7XG4gICAgfVxuICAgIGdldCBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklkO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29ubmVjdGlvbk1lc3NhZ2UuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmV4cG9ydCBjbGFzcyBDb25uZWN0aW9uT3BlblJlc3BvbnNlIHtcbiAgICBjb25zdHJ1Y3RvcihzdGF0dXNDb2RlLCByZWFzb24pIHtcbiAgICAgICAgdGhpcy5wcml2U3RhdHVzQ29kZSA9IHN0YXR1c0NvZGU7XG4gICAgICAgIHRoaXMucHJpdlJlYXNvbiA9IHJlYXNvbjtcbiAgICB9XG4gICAgZ2V0IHN0YXR1c0NvZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTdGF0dXNDb2RlO1xuICAgIH1cbiAgICBnZXQgcmVhc29uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVhc29uO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29ubmVjdGlvbk9wZW5SZXNwb25zZS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBUaGUgZXJyb3IgdGhhdCBpcyB0aHJvd24gd2hlbiBhbiBhcmd1bWVudCBwYXNzZWQgaW4gaXMgbnVsbC5cbiAqXG4gKiBAZXhwb3J0XG4gKiBAY2xhc3MgRGVmZmVyYWxNYXBcbiAqL1xuZXhwb3J0IGNsYXNzIERlZmVycmFsTWFwIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5wcml2TWFwID0ge307XG4gICAgfVxuICAgIGFkZChpZCwgZGVmZXJyYWwpIHtcbiAgICAgICAgdGhpcy5wcml2TWFwW2lkXSA9IGRlZmVycmFsO1xuICAgIH1cbiAgICBnZXRJZChpZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TWFwW2lkXTtcbiAgICB9XG4gICAgY29tcGxldGUoaWQsIHJlc3VsdCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5wcml2TWFwW2lkXS5yZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZNYXBbaWRdLnJlamVjdChlcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB0aGlzLnByaXZNYXBbaWRdID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1EZWZlcnJhbE1hcC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgRXZlbnRUeXBlLCBQbGF0Zm9ybUV2ZW50IH0gZnJvbSBcIi4vUGxhdGZvcm1FdmVudFwiO1xuZXhwb3J0IGNsYXNzIERpYWxvZ0V2ZW50IGV4dGVuZHMgUGxhdGZvcm1FdmVudCB7XG4gICAgY29uc3RydWN0b3IoZXZlbnROYW1lLCBldmVudFR5cGUgPSBFdmVudFR5cGUuSW5mbykge1xuICAgICAgICBzdXBlcihldmVudE5hbWUsIGV2ZW50VHlwZSk7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFNlbmRpbmdBZ2VudENvbnRleHRNZXNzYWdlRXZlbnQgZXh0ZW5kcyBEaWFsb2dFdmVudCB7XG4gICAgY29uc3RydWN0b3IoYWdlbnRDb25maWcpIHtcbiAgICAgICAgc3VwZXIoXCJTZW5kaW5nQWdlbnRDb250ZXh0TWVzc2FnZUV2ZW50XCIpO1xuICAgICAgICB0aGlzLnByaXZBZ2VudENvbmZpZyA9IGFnZW50Q29uZmlnO1xuICAgIH1cbiAgICBnZXQgYWdlbnRDb25maWcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBZ2VudENvbmZpZztcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPURpYWxvZ0V2ZW50cy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyogZXNsaW50LWRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGUgKi9cbi8qKlxuICogVGhlIGVycm9yIHRoYXQgaXMgdGhyb3duIHdoZW4gYW4gYXJndW1lbnQgcGFzc2VkIGluIGlzIG51bGwuXG4gKlxuICogQGV4cG9ydFxuICogQGNsYXNzIEFyZ3VtZW50TnVsbEVycm9yXG4gKiBAZXh0ZW5kcyB7RXJyb3J9XG4gKi9cbmV4cG9ydCBjbGFzcyBBcmd1bWVudE51bGxFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIEFyZ3VtZW50TnVsbEVycm9yLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGFyZ3VtZW50TmFtZSAtIE5hbWUgb2YgdGhlIGFyZ3VtZW50IHRoYXQgaXMgbnVsbFxuICAgICAqXG4gICAgICogQG1lbWJlck9mIEFyZ3VtZW50TnVsbEVycm9yXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoYXJndW1lbnROYW1lKSB7XG4gICAgICAgIHN1cGVyKGFyZ3VtZW50TmFtZSk7XG4gICAgICAgIHRoaXMubmFtZSA9IFwiQXJndW1lbnROdWxsXCI7XG4gICAgICAgIHRoaXMubWVzc2FnZSA9IGFyZ3VtZW50TmFtZTtcbiAgICB9XG59XG4vKipcbiAqIFRoZSBlcnJvciB0aGF0IGlzIHRocm93biB3aGVuIGFuIGludmFsaWQgb3BlcmF0aW9uIGlzIHBlcmZvcm1lZCBpbiB0aGUgY29kZS5cbiAqXG4gKiBAZXhwb3J0XG4gKiBAY2xhc3MgSW52YWxpZE9wZXJhdGlvbkVycm9yXG4gKiBAZXh0ZW5kcyB7RXJyb3J9XG4gKi9cbmV4cG9ydCBjbGFzcyBJbnZhbGlkT3BlcmF0aW9uRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBJbnZhbGlkT3BlcmF0aW9uRXJyb3IuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXJyb3IgLSBUaGUgZXJyb3JcbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBJbnZhbGlkT3BlcmF0aW9uRXJyb3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihlcnJvcikge1xuICAgICAgICBzdXBlcihlcnJvcik7XG4gICAgICAgIHRoaXMubmFtZSA9IFwiSW52YWxpZE9wZXJhdGlvblwiO1xuICAgICAgICB0aGlzLm1lc3NhZ2UgPSBlcnJvcjtcbiAgICB9XG59XG4vKipcbiAqIFRoZSBlcnJvciB0aGF0IGlzIHRocm93biB3aGVuIGFuIG9iamVjdCBpcyBkaXNwb3NlZC5cbiAqXG4gKiBAZXhwb3J0XG4gKiBAY2xhc3MgT2JqZWN0RGlzcG9zZWRFcnJvclxuICogQGV4dGVuZHMge0Vycm9yfVxuICovXG5leHBvcnQgY2xhc3MgT2JqZWN0RGlzcG9zZWRFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIE9iamVjdERpc3Bvc2VkRXJyb3IuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gb2JqZWN0TmFtZSAtIFRoZSBvYmplY3QgdGhhdCBpcyBkaXNwb3NlZFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBlcnJvciAtIFRoZSBlcnJvclxuICAgICAqXG4gICAgICogQG1lbWJlck9mIE9iamVjdERpc3Bvc2VkRXJyb3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihvYmplY3ROYW1lLCBlcnJvcikge1xuICAgICAgICBzdXBlcihlcnJvcik7XG4gICAgICAgIHRoaXMubmFtZSA9IG9iamVjdE5hbWUgKyBcIk9iamVjdERpc3Bvc2VkXCI7XG4gICAgICAgIHRoaXMubWVzc2FnZSA9IGVycm9yO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9RXJyb3IuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IE9iamVjdERpc3Bvc2VkRXJyb3IgfSBmcm9tIFwiLi9FcnJvclwiO1xuaW1wb3J0IHsgY3JlYXRlTm9EYXNoR3VpZCB9IGZyb20gXCIuL0d1aWRcIjtcbmV4cG9ydCBjbGFzcyBFdmVudFNvdXJjZSB7XG4gICAgY29uc3RydWN0b3IobWV0YWRhdGEpIHtcbiAgICAgICAgdGhpcy5wcml2RXZlbnRMaXN0ZW5lcnMgPSB7fTtcbiAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZDb25zb2xlTGlzdGVuZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucHJpdk1ldGFkYXRhID0gbWV0YWRhdGE7XG4gICAgfVxuICAgIG9uRXZlbnQoZXZlbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNEaXNwb3NlZCgpKSB7XG4gICAgICAgICAgICB0aHJvdyAobmV3IE9iamVjdERpc3Bvc2VkRXJyb3IoXCJFdmVudFNvdXJjZVwiKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubWV0YWRhdGEpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgcGFyYW1OYW1lIGluIHRoaXMubWV0YWRhdGEpIHtcbiAgICAgICAgICAgICAgICBpZiAocGFyYW1OYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5tZXRhZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFldmVudC5tZXRhZGF0YVtwYXJhbU5hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQubWV0YWRhdGFbcGFyYW1OYW1lXSA9IHRoaXMubWV0YWRhdGFbcGFyYW1OYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IGV2ZW50SWQgaW4gdGhpcy5wcml2RXZlbnRMaXN0ZW5lcnMpIHtcbiAgICAgICAgICAgIGlmIChldmVudElkICYmIHRoaXMucHJpdkV2ZW50TGlzdGVuZXJzW2V2ZW50SWRdKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2RXZlbnRMaXN0ZW5lcnNbZXZlbnRJZF0oZXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGF0dGFjaChvbkV2ZW50Q2FsbGJhY2spIHtcbiAgICAgICAgY29uc3QgaWQgPSBjcmVhdGVOb0Rhc2hHdWlkKCk7XG4gICAgICAgIHRoaXMucHJpdkV2ZW50TGlzdGVuZXJzW2lkXSA9IG9uRXZlbnRDYWxsYmFjaztcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGRldGFjaDogKCkgPT4ge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnByaXZFdmVudExpc3RlbmVyc1tpZF07XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgYXR0YWNoTGlzdGVuZXIobGlzdGVuZXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXR0YWNoKChlKSA9PiBsaXN0ZW5lci5vbkV2ZW50KGUpKTtcbiAgICB9XG4gICAgYXR0YWNoQ29uc29sZUxpc3RlbmVyKGxpc3RlbmVyKSB7XG4gICAgICAgIGlmICghIXRoaXMucHJpdkNvbnNvbGVMaXN0ZW5lcikge1xuICAgICAgICAgICAgdm9pZCB0aGlzLnByaXZDb25zb2xlTGlzdGVuZXIuZGV0YWNoKCk7IC8vIERldGFjaCBpbXBsZW1lbnRhdGlvbiBmb3IgZXZlbnRMaXN0ZW5lcnMgaXMgc3luY2hyb25vdXNcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZDb25zb2xlTGlzdGVuZXIgPSB0aGlzLmF0dGFjaCgoZSkgPT4gbGlzdGVuZXIub25FdmVudChlKSk7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb25zb2xlTGlzdGVuZXI7XG4gICAgfVxuICAgIGlzRGlzcG9zZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJc0Rpc3Bvc2VkO1xuICAgIH1cbiAgICBkaXNwb3NlKCkge1xuICAgICAgICB0aGlzLnByaXZFdmVudExpc3RlbmVycyA9IG51bGw7XG4gICAgICAgIHRoaXMucHJpdklzRGlzcG9zZWQgPSB0cnVlO1xuICAgIH1cbiAgICBnZXQgbWV0YWRhdGEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZNZXRhZGF0YTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUV2ZW50U291cmNlLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBBcmd1bWVudE51bGxFcnJvciB9IGZyb20gXCIuL0Vycm9yXCI7XG5pbXBvcnQgeyBFdmVudFNvdXJjZSB9IGZyb20gXCIuL0V2ZW50U291cmNlXCI7XG5leHBvcnQgY2xhc3MgRXZlbnRzIHtcbiAgICBzdGF0aWMgc2V0RXZlbnRTb3VyY2UoZXZlbnRTb3VyY2UpIHtcbiAgICAgICAgaWYgKCFldmVudFNvdXJjZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50TnVsbEVycm9yKFwiZXZlbnRTb3VyY2VcIik7XG4gICAgICAgIH1cbiAgICAgICAgRXZlbnRzLnByaXZJbnN0YW5jZSA9IGV2ZW50U291cmNlO1xuICAgIH1cbiAgICBzdGF0aWMgZ2V0IGluc3RhbmNlKCkge1xuICAgICAgICByZXR1cm4gRXZlbnRzLnByaXZJbnN0YW5jZTtcbiAgICB9XG59XG5FdmVudHMucHJpdkluc3RhbmNlID0gbmV3IEV2ZW50U291cmNlKCk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUV2ZW50cy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgdjQgYXMgdXVpZCB9IGZyb20gXCJ1dWlkXCI7XG5jb25zdCBjcmVhdGVHdWlkID0gKCkgPT4gdXVpZCgpO1xuY29uc3QgY3JlYXRlTm9EYXNoR3VpZCA9ICgpID0+IGNyZWF0ZUd1aWQoKS5yZXBsYWNlKG5ldyBSZWdFeHAoXCItXCIsIFwiZ1wiKSwgXCJcIikudG9VcHBlckNhc2UoKTtcbmV4cG9ydCB7IGNyZWF0ZUd1aWQsIGNyZWF0ZU5vRGFzaEd1aWQgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9R3VpZC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuZXhwb3J0IHZhciBDb25uZWN0aW9uU3RhdGU7XG4oZnVuY3Rpb24gKENvbm5lY3Rpb25TdGF0ZSkge1xuICAgIENvbm5lY3Rpb25TdGF0ZVtDb25uZWN0aW9uU3RhdGVbXCJOb25lXCJdID0gMF0gPSBcIk5vbmVcIjtcbiAgICBDb25uZWN0aW9uU3RhdGVbQ29ubmVjdGlvblN0YXRlW1wiQ29ubmVjdGVkXCJdID0gMV0gPSBcIkNvbm5lY3RlZFwiO1xuICAgIENvbm5lY3Rpb25TdGF0ZVtDb25uZWN0aW9uU3RhdGVbXCJDb25uZWN0aW5nXCJdID0gMl0gPSBcIkNvbm5lY3RpbmdcIjtcbiAgICBDb25uZWN0aW9uU3RhdGVbQ29ubmVjdGlvblN0YXRlW1wiRGlzY29ubmVjdGVkXCJdID0gM10gPSBcIkRpc2Nvbm5lY3RlZFwiO1xufSkoQ29ubmVjdGlvblN0YXRlIHx8IChDb25uZWN0aW9uU3RhdGUgPSB7fSkpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1JQ29ubmVjdGlvbi5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgT2JqZWN0RGlzcG9zZWRFcnJvciB9IGZyb20gXCIuL0Vycm9yXCI7XG5leHBvcnQgY2xhc3MgTGlzdCB7XG4gICAgY29uc3RydWN0b3IobGlzdCkge1xuICAgICAgICB0aGlzLnByaXZTdWJzY3JpcHRpb25JZENvdW50ZXIgPSAwO1xuICAgICAgICB0aGlzLnByaXZBZGRTdWJzY3JpcHRpb25zID0ge307XG4gICAgICAgIHRoaXMucHJpdlJlbW92ZVN1YnNjcmlwdGlvbnMgPSB7fTtcbiAgICAgICAgdGhpcy5wcml2RGlzcG9zZWRTdWJzY3JpcHRpb25zID0ge307XG4gICAgICAgIHRoaXMucHJpdkRpc3Bvc2VSZWFzb24gPSBudWxsO1xuICAgICAgICB0aGlzLnByaXZMaXN0ID0gW107XG4gICAgICAgIC8vIGNvcHkgdGhlIGxpc3QgcmF0aGVyIHRoYW4gdGFraW5nIGFzIGlzLlxuICAgICAgICBpZiAobGlzdCkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGxpc3QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZMaXN0LnB1c2goaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0KGl0ZW1JbmRleCkge1xuICAgICAgICB0aGlzLnRocm93SWZEaXNwb3NlZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TGlzdFtpdGVtSW5kZXhdO1xuICAgIH1cbiAgICBmaXJzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0KDApO1xuICAgIH1cbiAgICBsYXN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXQodGhpcy5sZW5ndGgoKSAtIDEpO1xuICAgIH1cbiAgICBhZGQoaXRlbSkge1xuICAgICAgICB0aGlzLnRocm93SWZEaXNwb3NlZCgpO1xuICAgICAgICB0aGlzLmluc2VydEF0KHRoaXMucHJpdkxpc3QubGVuZ3RoLCBpdGVtKTtcbiAgICB9XG4gICAgaW5zZXJ0QXQoaW5kZXgsIGl0ZW0pIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZWQoKTtcbiAgICAgICAgaWYgKGluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZMaXN0LnVuc2hpZnQoaXRlbSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaW5kZXggPT09IHRoaXMucHJpdkxpc3QubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZMaXN0LnB1c2goaXRlbSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnByaXZMaXN0LnNwbGljZShpbmRleCwgMCwgaXRlbSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50cmlnZ2VyU3Vic2NyaXB0aW9ucyh0aGlzLnByaXZBZGRTdWJzY3JpcHRpb25zKTtcbiAgICB9XG4gICAgcmVtb3ZlRmlyc3QoKSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkRpc3Bvc2VkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnJlbW92ZUF0KDApO1xuICAgIH1cbiAgICByZW1vdmVMYXN0KCkge1xuICAgICAgICB0aGlzLnRocm93SWZEaXNwb3NlZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmVBdCh0aGlzLmxlbmd0aCgpIC0gMSk7XG4gICAgfVxuICAgIHJlbW92ZUF0KGluZGV4KSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkRpc3Bvc2VkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnJlbW92ZShpbmRleCwgMSlbMF07XG4gICAgfVxuICAgIHJlbW92ZShpbmRleCwgY291bnQpIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZWQoKTtcbiAgICAgICAgY29uc3QgcmVtb3ZlZEVsZW1lbnRzID0gdGhpcy5wcml2TGlzdC5zcGxpY2UoaW5kZXgsIGNvdW50KTtcbiAgICAgICAgdGhpcy50cmlnZ2VyU3Vic2NyaXB0aW9ucyh0aGlzLnByaXZSZW1vdmVTdWJzY3JpcHRpb25zKTtcbiAgICAgICAgcmV0dXJuIHJlbW92ZWRFbGVtZW50cztcbiAgICB9XG4gICAgY2xlYXIoKSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkRpc3Bvc2VkKCk7XG4gICAgICAgIHRoaXMucmVtb3ZlKDAsIHRoaXMubGVuZ3RoKCkpO1xuICAgIH1cbiAgICBsZW5ndGgoKSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkRpc3Bvc2VkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZMaXN0Lmxlbmd0aDtcbiAgICB9XG4gICAgb25BZGRlZChhZGRlZENhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkRpc3Bvc2VkKCk7XG4gICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbklkID0gdGhpcy5wcml2U3Vic2NyaXB0aW9uSWRDb3VudGVyKys7XG4gICAgICAgIHRoaXMucHJpdkFkZFN1YnNjcmlwdGlvbnNbc3Vic2NyaXB0aW9uSWRdID0gYWRkZWRDYWxsYmFjaztcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGRldGFjaDogKCkgPT4ge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnByaXZBZGRTdWJzY3JpcHRpb25zW3N1YnNjcmlwdGlvbklkXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgIH1cbiAgICBvblJlbW92ZWQocmVtb3ZlZENhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkRpc3Bvc2VkKCk7XG4gICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbklkID0gdGhpcy5wcml2U3Vic2NyaXB0aW9uSWRDb3VudGVyKys7XG4gICAgICAgIHRoaXMucHJpdlJlbW92ZVN1YnNjcmlwdGlvbnNbc3Vic2NyaXB0aW9uSWRdID0gcmVtb3ZlZENhbGxiYWNrO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZGV0YWNoOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMucHJpdlJlbW92ZVN1YnNjcmlwdGlvbnNbc3Vic2NyaXB0aW9uSWRdO1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgfVxuICAgIG9uRGlzcG9zZWQoZGlzcG9zZWRDYWxsYmFjaykge1xuICAgICAgICB0aGlzLnRocm93SWZEaXNwb3NlZCgpO1xuICAgICAgICBjb25zdCBzdWJzY3JpcHRpb25JZCA9IHRoaXMucHJpdlN1YnNjcmlwdGlvbklkQ291bnRlcisrO1xuICAgICAgICB0aGlzLnByaXZEaXNwb3NlZFN1YnNjcmlwdGlvbnNbc3Vic2NyaXB0aW9uSWRdID0gZGlzcG9zZWRDYWxsYmFjaztcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGRldGFjaDogKCkgPT4ge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnByaXZEaXNwb3NlZFN1YnNjcmlwdGlvbnNbc3Vic2NyaXB0aW9uSWRdO1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgfVxuICAgIGpvaW4oc2VwZXJhdG9yKSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkRpc3Bvc2VkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZMaXN0LmpvaW4oc2VwZXJhdG9yKTtcbiAgICB9XG4gICAgdG9BcnJheSgpIHtcbiAgICAgICAgY29uc3QgY2xvbmVDb3B5ID0gQXJyYXkoKTtcbiAgICAgICAgdGhpcy5wcml2TGlzdC5mb3JFYWNoKCh2YWwpID0+IHtcbiAgICAgICAgICAgIGNsb25lQ29weS5wdXNoKHZhbCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY2xvbmVDb3B5O1xuICAgIH1cbiAgICBhbnkoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZWQoKTtcbiAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy53aGVyZShjYWxsYmFjaykubGVuZ3RoKCkgPiAwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubGVuZ3RoKCkgPiAwO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFsbChjYWxsYmFjaykge1xuICAgICAgICB0aGlzLnRocm93SWZEaXNwb3NlZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy53aGVyZShjYWxsYmFjaykubGVuZ3RoKCkgPT09IHRoaXMubGVuZ3RoKCk7XG4gICAgfVxuICAgIGZvckVhY2goY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZWQoKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aCgpOyBpKyspIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHRoaXMucHJpdkxpc3RbaV0sIGkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNlbGVjdChjYWxsYmFjaykge1xuICAgICAgICB0aGlzLnRocm93SWZEaXNwb3NlZCgpO1xuICAgICAgICBjb25zdCBzZWxlY3RMaXN0ID0gW107XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5wcml2TGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgc2VsZWN0TGlzdC5wdXNoKGNhbGxiYWNrKHRoaXMucHJpdkxpc3RbaV0sIGkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IExpc3Qoc2VsZWN0TGlzdCk7XG4gICAgfVxuICAgIHdoZXJlKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkRpc3Bvc2VkKCk7XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkTGlzdCA9IG5ldyBMaXN0KCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5wcml2TGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKHRoaXMucHJpdkxpc3RbaV0sIGkpKSB7XG4gICAgICAgICAgICAgICAgZmlsdGVyZWRMaXN0LmFkZCh0aGlzLnByaXZMaXN0W2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmlsdGVyZWRMaXN0O1xuICAgIH1cbiAgICBvcmRlckJ5KGNvbXBhcmVGbikge1xuICAgICAgICB0aGlzLnRocm93SWZEaXNwb3NlZCgpO1xuICAgICAgICBjb25zdCBjbG9uZWRBcnJheSA9IHRoaXMudG9BcnJheSgpO1xuICAgICAgICBjb25zdCBvcmRlcmVkQXJyYXkgPSBjbG9uZWRBcnJheS5zb3J0KGNvbXBhcmVGbik7XG4gICAgICAgIHJldHVybiBuZXcgTGlzdChvcmRlcmVkQXJyYXkpO1xuICAgIH1cbiAgICBvcmRlckJ5RGVzYyhjb21wYXJlRm4pIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMub3JkZXJCeSgoYSwgYikgPT4gY29tcGFyZUZuKGIsIGEpKTtcbiAgICB9XG4gICAgY2xvbmUoKSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkRpc3Bvc2VkKCk7XG4gICAgICAgIHJldHVybiBuZXcgTGlzdCh0aGlzLnRvQXJyYXkoKSk7XG4gICAgfVxuICAgIGNvbmNhdChsaXN0KSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkRpc3Bvc2VkKCk7XG4gICAgICAgIHJldHVybiBuZXcgTGlzdCh0aGlzLnByaXZMaXN0LmNvbmNhdChsaXN0LnRvQXJyYXkoKSkpO1xuICAgIH1cbiAgICBjb25jYXRBcnJheShhcnJheSkge1xuICAgICAgICB0aGlzLnRocm93SWZEaXNwb3NlZCgpO1xuICAgICAgICByZXR1cm4gbmV3IExpc3QodGhpcy5wcml2TGlzdC5jb25jYXQoYXJyYXkpKTtcbiAgICB9XG4gICAgaXNEaXNwb3NlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkxpc3QgPT0gbnVsbDtcbiAgICB9XG4gICAgZGlzcG9zZShyZWFzb24pIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQoKSkge1xuICAgICAgICAgICAgdGhpcy5wcml2RGlzcG9zZVJlYXNvbiA9IHJlYXNvbjtcbiAgICAgICAgICAgIHRoaXMucHJpdkxpc3QgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5wcml2QWRkU3Vic2NyaXB0aW9ucyA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLnByaXZSZW1vdmVTdWJzY3JpcHRpb25zID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlclN1YnNjcmlwdGlvbnModGhpcy5wcml2RGlzcG9zZWRTdWJzY3JpcHRpb25zKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0aHJvd0lmRGlzcG9zZWQoKSB7XG4gICAgICAgIGlmICh0aGlzLmlzRGlzcG9zZWQoKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IE9iamVjdERpc3Bvc2VkRXJyb3IoXCJMaXN0XCIsIHRoaXMucHJpdkRpc3Bvc2VSZWFzb24pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRyaWdnZXJTdWJzY3JpcHRpb25zKHN1YnNjcmlwdGlvbnMpIHtcbiAgICAgICAgaWYgKHN1YnNjcmlwdGlvbnMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qgc3Vic2NyaXB0aW9uSWQgaW4gc3Vic2NyaXB0aW9ucykge1xuICAgICAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb25JZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb25zW3N1YnNjcmlwdGlvbklkXSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9TGlzdC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgY3JlYXRlTm9EYXNoR3VpZCB9IGZyb20gXCIuL0d1aWRcIjtcbmV4cG9ydCB2YXIgRXZlbnRUeXBlO1xuKGZ1bmN0aW9uIChFdmVudFR5cGUpIHtcbiAgICBFdmVudFR5cGVbRXZlbnRUeXBlW1wiRGVidWdcIl0gPSAwXSA9IFwiRGVidWdcIjtcbiAgICBFdmVudFR5cGVbRXZlbnRUeXBlW1wiSW5mb1wiXSA9IDFdID0gXCJJbmZvXCI7XG4gICAgRXZlbnRUeXBlW0V2ZW50VHlwZVtcIldhcm5pbmdcIl0gPSAyXSA9IFwiV2FybmluZ1wiO1xuICAgIEV2ZW50VHlwZVtFdmVudFR5cGVbXCJFcnJvclwiXSA9IDNdID0gXCJFcnJvclwiO1xuICAgIEV2ZW50VHlwZVtFdmVudFR5cGVbXCJOb25lXCJdID0gNF0gPSBcIk5vbmVcIjtcbn0pKEV2ZW50VHlwZSB8fCAoRXZlbnRUeXBlID0ge30pKTtcbmV4cG9ydCBjbGFzcyBQbGF0Zm9ybUV2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihldmVudE5hbWUsIGV2ZW50VHlwZSkge1xuICAgICAgICB0aGlzLnByaXZOYW1lID0gZXZlbnROYW1lO1xuICAgICAgICB0aGlzLnByaXZFdmVudElkID0gY3JlYXRlTm9EYXNoR3VpZCgpO1xuICAgICAgICB0aGlzLnByaXZFdmVudFRpbWUgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gICAgICAgIHRoaXMucHJpdkV2ZW50VHlwZSA9IGV2ZW50VHlwZTtcbiAgICAgICAgdGhpcy5wcml2TWV0YWRhdGEgPSB7fTtcbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZOYW1lO1xuICAgIH1cbiAgICBnZXQgZXZlbnRJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkV2ZW50SWQ7XG4gICAgfVxuICAgIGdldCBldmVudFRpbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZFdmVudFRpbWU7XG4gICAgfVxuICAgIGdldCBldmVudFR5cGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZFdmVudFR5cGU7XG4gICAgfVxuICAgIGdldCBtZXRhZGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdk1ldGFkYXRhO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UGxhdGZvcm1FdmVudC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyogZXNsaW50LWRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGUsIEB0eXBlc2NyaXB0LWVzbGludC90eXBlZGVmICovXG5leHBvcnQgdmFyIFByb21pc2VTdGF0ZTtcbihmdW5jdGlvbiAoUHJvbWlzZVN0YXRlKSB7XG4gICAgUHJvbWlzZVN0YXRlW1Byb21pc2VTdGF0ZVtcIk5vbmVcIl0gPSAwXSA9IFwiTm9uZVwiO1xuICAgIFByb21pc2VTdGF0ZVtQcm9taXNlU3RhdGVbXCJSZXNvbHZlZFwiXSA9IDFdID0gXCJSZXNvbHZlZFwiO1xuICAgIFByb21pc2VTdGF0ZVtQcm9taXNlU3RhdGVbXCJSZWplY3RlZFwiXSA9IDJdID0gXCJSZWplY3RlZFwiO1xufSkoUHJvbWlzZVN0YXRlIHx8IChQcm9taXNlU3RhdGUgPSB7fSkpO1xuZXhwb3J0IGNsYXNzIFByb21pc2VSZXN1bHQge1xuICAgIGNvbnN0cnVjdG9yKHByb21pc2VSZXN1bHRFdmVudFNvdXJjZSkge1xuICAgICAgICB0aGlzLnRocm93SWZFcnJvciA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzRXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyB0aGlzLmVycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBwcm9taXNlUmVzdWx0RXZlbnRTb3VyY2Uub24oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZJc0NvbXBsZXRlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdklzQ29tcGxldGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZJc0Vycm9yID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVzdWx0ID0gcmVzdWx0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wcml2SXNDb21wbGV0ZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZJc0NvbXBsZXRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2SXNFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2RXJyb3IgPSBlcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldCBpc0NvbXBsZXRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzQ29tcGxldGVkO1xuICAgIH1cbiAgICBnZXQgaXNFcnJvcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzRXJyb3I7XG4gICAgfVxuICAgIGdldCBlcnJvcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkVycm9yO1xuICAgIH1cbiAgICBnZXQgcmVzdWx0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVzdWx0O1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBQcm9taXNlUmVzdWx0RXZlbnRTb3VyY2Uge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnNldFJlc3VsdCA9IChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgIHRoaXMucHJpdk9uU2V0UmVzdWx0KHJlc3VsdCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc2V0RXJyb3IgPSAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIHRoaXMucHJpdk9uU2V0RXJyb3IoZXJyb3IpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLm9uID0gKG9uU2V0UmVzdWx0LCBvblNldEVycm9yKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnByaXZPblNldFJlc3VsdCA9IG9uU2V0UmVzdWx0O1xuICAgICAgICAgICAgdGhpcy5wcml2T25TZXRFcnJvciA9IG9uU2V0RXJyb3I7XG4gICAgICAgIH07XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIERlZmVycmVkIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5yZXNvbHZlID0gKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcml2UmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucmVqZWN0ID0gKGVycm9yKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnByaXZSZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH07XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvZXhwbGljaXQtZnVuY3Rpb24tcmV0dXJuLXR5cGVcbiAgICAgICAgdGhpcy5wcml2UHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlc29sdmUgPSByZXNvbHZlO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVqZWN0ID0gcmVqZWN0O1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZ2V0IHByb21pc2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9taXNlO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBTaW5rIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5wcml2U3RhdGUgPSBQcm9taXNlU3RhdGUuTm9uZTtcbiAgICAgICAgdGhpcy5wcml2UHJvbWlzZVJlc3VsdCA9IG51bGw7XG4gICAgICAgIHRoaXMucHJpdlByb21pc2VSZXN1bHRFdmVudHMgPSBudWxsO1xuICAgICAgICB0aGlzLnByaXZTdWNjZXNzSGFuZGxlcnMgPSBbXTtcbiAgICAgICAgdGhpcy5wcml2RXJyb3JIYW5kbGVycyA9IFtdO1xuICAgICAgICB0aGlzLnByaXZQcm9taXNlUmVzdWx0RXZlbnRzID0gbmV3IFByb21pc2VSZXN1bHRFdmVudFNvdXJjZSgpO1xuICAgICAgICB0aGlzLnByaXZQcm9taXNlUmVzdWx0ID0gbmV3IFByb21pc2VSZXN1bHQodGhpcy5wcml2UHJvbWlzZVJlc3VsdEV2ZW50cyk7XG4gICAgfVxuICAgIGdldCBzdGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlN0YXRlO1xuICAgIH1cbiAgICBnZXQgcmVzdWx0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvbWlzZVJlc3VsdDtcbiAgICB9XG4gICAgcmVzb2x2ZShyZXN1bHQpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdlN0YXRlICE9PSBQcm9taXNlU3RhdGUuTm9uZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiJ0Nhbm5vdCByZXNvbHZlIGEgY29tcGxldGVkIHByb21pc2UnXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdlN0YXRlID0gUHJvbWlzZVN0YXRlLlJlc29sdmVkO1xuICAgICAgICB0aGlzLnByaXZQcm9taXNlUmVzdWx0RXZlbnRzLnNldFJlc3VsdChyZXN1bHQpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucHJpdlN1Y2Nlc3NIYW5kbGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5leGVjdXRlU3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCwgdGhpcy5wcml2U3VjY2Vzc0hhbmRsZXJzW2ldLCB0aGlzLnByaXZFcnJvckhhbmRsZXJzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRldGFjaEhhbmRsZXJzKCk7XG4gICAgfVxuICAgIHJlamVjdChlcnJvcikge1xuICAgICAgICBpZiAodGhpcy5wcml2U3RhdGUgIT09IFByb21pc2VTdGF0ZS5Ob25lKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCInQ2Fubm90IHJlamVjdCBhIGNvbXBsZXRlZCBwcm9taXNlJ1wiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZTdGF0ZSA9IFByb21pc2VTdGF0ZS5SZWplY3RlZDtcbiAgICAgICAgdGhpcy5wcml2UHJvbWlzZVJlc3VsdEV2ZW50cy5zZXRFcnJvcihlcnJvcik7XG4gICAgICAgIGZvciAoY29uc3QgZXJyb3JIYW5kbGVyIG9mIHRoaXMucHJpdkVycm9ySGFuZGxlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuZXhlY3V0ZUVycm9yQ2FsbGJhY2soZXJyb3IsIGVycm9ySGFuZGxlcik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kZXRhY2hIYW5kbGVycygpO1xuICAgIH1cbiAgICBvbihzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHtcbiAgICAgICAgaWYgKHN1Y2Nlc3NDYWxsYmFjayA9PSBudWxsKSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uXG4gICAgICAgICAgICBzdWNjZXNzQ2FsbGJhY2sgPSAoKSA9PiB7IH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucHJpdlN0YXRlID09PSBQcm9taXNlU3RhdGUuTm9uZSkge1xuICAgICAgICAgICAgdGhpcy5wcml2U3VjY2Vzc0hhbmRsZXJzLnB1c2goc3VjY2Vzc0NhbGxiYWNrKTtcbiAgICAgICAgICAgIHRoaXMucHJpdkVycm9ySGFuZGxlcnMucHVzaChlcnJvckNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZTdGF0ZSA9PT0gUHJvbWlzZVN0YXRlLlJlc29sdmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5leGVjdXRlU3VjY2Vzc0NhbGxiYWNrKHRoaXMucHJpdlByb21pc2VSZXN1bHQucmVzdWx0LCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5wcml2U3RhdGUgPT09IFByb21pc2VTdGF0ZS5SZWplY3RlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZXhlY3V0ZUVycm9yQ2FsbGJhY2sodGhpcy5wcml2UHJvbWlzZVJlc3VsdC5lcnJvciwgZXJyb3JDYWxsYmFjayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmRldGFjaEhhbmRsZXJzKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZXhlY3V0ZVN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgc3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHRoaXMuZXhlY3V0ZUVycm9yQ2FsbGJhY2soYCdVbmhhbmRsZWQgY2FsbGJhY2sgZXJyb3I6ICR7ZX0nYCwgZXJyb3JDYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZXhlY3V0ZUVycm9yQ2FsbGJhY2soZXJyb3IsIGVycm9yQ2FsbGJhY2spIHtcbiAgICAgICAgaWYgKGVycm9yQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZXJyb3JDYWxsYmFjayhlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgJ1VuaGFuZGxlZCBjYWxsYmFjayBlcnJvcjogJHtlfS4gSW5uZXJFcnJvcjogJHtlcnJvcn0nYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCdVbmhhbmRsZWQgZXJyb3I6ICR7ZXJyb3J9J2ApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRldGFjaEhhbmRsZXJzKCkge1xuICAgICAgICB0aGlzLnByaXZFcnJvckhhbmRsZXJzID0gW107XG4gICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NIYW5kbGVycyA9IFtdO1xuICAgIH1cbn1cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItYXJyb3cvcHJlZmVyLWFycm93LWZ1bmN0aW9uc1xuZXhwb3J0IGZ1bmN0aW9uIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3MocHJvbWlzZSwgY2IsIGVycikge1xuICAgIHByb21pc2UudGhlbigodmFsKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoISFjYikge1xuICAgICAgICAgICAgICAgIGNiKHZhbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBpZiAoISFlcnIpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdHlwZWRFcnJvciA9IGVycm9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXJyKHR5cGVkRXJyb3IubmFtZSArIFwiOiBcIiArIHR5cGVkRXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnIoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1lbXB0eVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHsgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwgKGVycm9yKSA9PiB7XG4gICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0eXBlZEVycm9yID0gZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIGVycih0eXBlZEVycm9yLm5hbWUgKyBcIjogXCIgKyB0eXBlZEVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWVtcHR5XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHsgfVxuICAgICAgICB9XG4gICAgfSk7XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVByb21pc2UuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgSW52YWxpZE9wZXJhdGlvbkVycm9yLCBPYmplY3REaXNwb3NlZEVycm9yIH0gZnJvbSBcIi4vRXJyb3JcIjtcbmltcG9ydCB7IExpc3QgfSBmcm9tIFwiLi9MaXN0XCI7XG5pbXBvcnQgeyBEZWZlcnJlZCwgfSBmcm9tIFwiLi9Qcm9taXNlXCI7XG52YXIgU3Vic2NyaWJlclR5cGU7XG4oZnVuY3Rpb24gKFN1YnNjcmliZXJUeXBlKSB7XG4gICAgU3Vic2NyaWJlclR5cGVbU3Vic2NyaWJlclR5cGVbXCJEZXF1ZXVlXCJdID0gMF0gPSBcIkRlcXVldWVcIjtcbiAgICBTdWJzY3JpYmVyVHlwZVtTdWJzY3JpYmVyVHlwZVtcIlBlZWtcIl0gPSAxXSA9IFwiUGVla1wiO1xufSkoU3Vic2NyaWJlclR5cGUgfHwgKFN1YnNjcmliZXJUeXBlID0ge30pKTtcbmV4cG9ydCBjbGFzcyBRdWV1ZSB7XG4gICAgY29uc3RydWN0b3IobGlzdCkge1xuICAgICAgICB0aGlzLnByaXZQcm9taXNlU3RvcmUgPSBuZXcgTGlzdCgpO1xuICAgICAgICB0aGlzLnByaXZJc0RyYWluSW5Qcm9ncmVzcyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2luZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZEaXNwb3NlUmVhc29uID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcml2TGlzdCA9IGxpc3QgPyBsaXN0IDogbmV3IExpc3QoKTtcbiAgICAgICAgdGhpcy5wcml2RGV0YWNoYWJsZXMgPSBbXTtcbiAgICAgICAgdGhpcy5wcml2U3Vic2NyaWJlcnMgPSBuZXcgTGlzdCgpO1xuICAgICAgICB0aGlzLnByaXZEZXRhY2hhYmxlcy5wdXNoKHRoaXMucHJpdkxpc3Qub25BZGRlZCgoKSA9PiB0aGlzLmRyYWluKCkpKTtcbiAgICB9XG4gICAgZW5xdWV1ZShpdGVtKSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkRpc3Bvc2UoKTtcbiAgICAgICAgdGhpcy5lbnF1ZXVlRnJvbVByb21pc2UobmV3IFByb21pc2UoKHJlc29sdmUpID0+IHJlc29sdmUoaXRlbSkpKTtcbiAgICB9XG4gICAgZW5xdWV1ZUZyb21Qcm9taXNlKHByb21pc2UpIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZSgpO1xuICAgICAgICBwcm9taXNlLnRoZW4oKHZhbCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcml2TGlzdC5hZGQodmFsKTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb25cbiAgICAgICAgfSwgKCkgPT4geyB9KTtcbiAgICB9XG4gICAgZGVxdWV1ZSgpIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZSgpO1xuICAgICAgICBjb25zdCBkZWZlcnJlZFN1YnNjcmliZXIgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgaWYgKHRoaXMucHJpdlN1YnNjcmliZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZTdWJzY3JpYmVycy5hZGQoeyBkZWZlcnJhbDogZGVmZXJyZWRTdWJzY3JpYmVyLCB0eXBlOiBTdWJzY3JpYmVyVHlwZS5EZXF1ZXVlIH0pO1xuICAgICAgICAgICAgdGhpcy5kcmFpbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZWZlcnJlZFN1YnNjcmliZXIucHJvbWlzZTtcbiAgICB9XG4gICAgcGVlaygpIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZSgpO1xuICAgICAgICBjb25zdCBkZWZlcnJlZFN1YnNjcmliZXIgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgY29uc3Qgc3VicyA9IHRoaXMucHJpdlN1YnNjcmliZXJzO1xuICAgICAgICBpZiAoc3Vicykge1xuICAgICAgICAgICAgdGhpcy5wcml2U3Vic2NyaWJlcnMuYWRkKHsgZGVmZXJyYWw6IGRlZmVycmVkU3Vic2NyaWJlciwgdHlwZTogU3Vic2NyaWJlclR5cGUuUGVlayB9KTtcbiAgICAgICAgICAgIHRoaXMuZHJhaW4oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGVmZXJyZWRTdWJzY3JpYmVyLnByb21pc2U7XG4gICAgfVxuICAgIGxlbmd0aCgpIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZSgpO1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TGlzdC5sZW5ndGgoKTtcbiAgICB9XG4gICAgaXNEaXNwb3NlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlN1YnNjcmliZXJzID09IG51bGw7XG4gICAgfVxuICAgIGRyYWluQW5kRGlzcG9zZShwZW5kaW5nSXRlbVByb2Nlc3NvciwgcmVhc29uKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCgpICYmICF0aGlzLnByaXZJc0Rpc3Bvc2luZykge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkRpc3Bvc2VSZWFzb24gPSByZWFzb247XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNvbnN0IHN1YnMgPSB0aGlzLnByaXZTdWJzY3JpYmVycztcbiAgICAgICAgICAgICAgICBpZiAoc3Vicykge1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoc3Vicy5sZW5ndGgoKSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1YnNjcmliZXIgPSBzdWJzLnJlbW92ZUZpcnN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiB0aGlzIG5lZWRzIHdvcmsgKFJlc29sdmUobnVsbCkgaW5zdGVhZD8pLlxuICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlci5kZWZlcnJhbC5yZXNvbHZlKHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzdWJzY3JpYmVyLmRlZmVycmFsLnJlamVjdChcIkRpc3Bvc2VkXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIG5vdGU6IHRoaXMgYmxvY2sgYXNzdW1lcyBjb29wZXJhdGl2ZSBtdWx0aXRhc2tpbmcsIGkuZS4sXG4gICAgICAgICAgICAgICAgICAgIC8vIGJldHdlZW4gdGhlIGlmLXN0YXRlbWVudCBhbmQgdGhlIGFzc2lnbm1lbnQgdGhlcmUgYXJlIG5vXG4gICAgICAgICAgICAgICAgICAgIC8vIHRocmVhZCBzd2l0Y2hlcy5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVhc29uIGlzIHRoYXQgYmV0d2VlbiB0aGUgaW5pdGlhbCBjb25zdCA9IHRoaXMuOyBhbmQgdGhpc1xuICAgICAgICAgICAgICAgICAgICAvLyBwb2ludCB0aGVyZSBpcyB0aGUgZGVycmFsLnJlc29sdmUoKSBvcGVyYXRpb24gdGhhdCBtaWdodCBoYXZlXG4gICAgICAgICAgICAgICAgICAgIC8vIGNhdXNlZCByZWN1cnNpdmUgY2FsbHMgdG8gdGhlIFF1ZXVlLCBlc3BlY2lhbGx5LCBjYWxsaW5nXG4gICAgICAgICAgICAgICAgICAgIC8vIERpc3Bvc2UoKSBvbiB0aGUgcXVldWUgYWxyZWR5ICh3aGljaCB3b3VsZCByZXNldCB0aGUgdmFyXG4gICAgICAgICAgICAgICAgICAgIC8vIGhlcmUgdG8gbnVsbCEpLlxuICAgICAgICAgICAgICAgICAgICAvLyBUaGF0IHNob3VsZCBnZW5lcmFsbHkgaG9sZCB0cnVlIGZvciBqYXZhc2NyaXB0Li4uXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnByaXZTdWJzY3JpYmVycyA9PT0gc3Vicykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3Vic2NyaWJlcnMgPSBzdWJzO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZGV0YWNoYWJsZSBvZiB0aGlzLnByaXZEZXRhY2hhYmxlcykge1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCBkZXRhY2hhYmxlLmRldGFjaCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2UHJvbWlzZVN0b3JlLmxlbmd0aCgpID4gMCAmJiBwZW5kaW5nSXRlbVByb2Nlc3Nvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9taXNlQXJyYXkgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UHJvbWlzZVN0b3JlLnRvQXJyYXkoKS5mb3JFYWNoKCh3cmFwcGVyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9taXNlQXJyYXkucHVzaCh3cmFwcGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChwcm9taXNlQXJyYXkpLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3Vic2NyaWJlcnMgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2TGlzdC5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ0l0ZW1Qcm9jZXNzb3IoaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkxpc3QgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9KS50aGVuKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWJzY3JpYmVycyA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkxpc3QgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGRpc3Bvc2UocmVhc29uKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLmRyYWluQW5kRGlzcG9zZShudWxsLCByZWFzb24pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZHJhaW4oKSB7XG4gICAgICAgIGlmICghdGhpcy5wcml2SXNEcmFpbkluUHJvZ3Jlc3MgJiYgIXRoaXMucHJpdklzRGlzcG9zaW5nKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZJc0RyYWluSW5Qcm9ncmVzcyA9IHRydWU7XG4gICAgICAgICAgICBjb25zdCBzdWJzID0gdGhpcy5wcml2U3Vic2NyaWJlcnM7XG4gICAgICAgICAgICBjb25zdCBsaXN0cyA9IHRoaXMucHJpdkxpc3Q7XG4gICAgICAgICAgICBpZiAoc3VicyAmJiBsaXN0cykge1xuICAgICAgICAgICAgICAgIHdoaWxlIChsaXN0cy5sZW5ndGgoKSA+IDAgJiYgc3Vicy5sZW5ndGgoKSA+IDAgJiYgIXRoaXMucHJpdklzRGlzcG9zaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1YnNjcmliZXIgPSBzdWJzLnJlbW92ZUZpcnN0KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdWJzY3JpYmVyLnR5cGUgPT09IFN1YnNjcmliZXJUeXBlLlBlZWspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmliZXIuZGVmZXJyYWwucmVzb2x2ZShsaXN0cy5maXJzdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlcXVldWVkSXRlbSA9IGxpc3RzLnJlbW92ZUZpcnN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVyLmRlZmVycmFsLnJlc29sdmUoZGVxdWV1ZWRJdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBub3RlOiB0aGlzIGJsb2NrIGFzc3VtZXMgY29vcGVyYXRpdmUgbXVsdGl0YXNraW5nLCBpLmUuLFxuICAgICAgICAgICAgICAgIC8vIGJldHdlZW4gdGhlIGlmLXN0YXRlbWVudCBhbmQgdGhlIGFzc2lnbm1lbnQgdGhlcmUgYXJlIG5vXG4gICAgICAgICAgICAgICAgLy8gdGhyZWFkIHN3aXRjaGVzLlxuICAgICAgICAgICAgICAgIC8vIFJlYXNvbiBpcyB0aGF0IGJldHdlZW4gdGhlIGluaXRpYWwgY29uc3QgPSB0aGlzLjsgYW5kIHRoaXNcbiAgICAgICAgICAgICAgICAvLyBwb2ludCB0aGVyZSBpcyB0aGUgZGVycmFsLnJlc29sdmUoKSBvcGVyYXRpb24gdGhhdCBtaWdodCBoYXZlXG4gICAgICAgICAgICAgICAgLy8gY2F1c2VkIHJlY3Vyc2l2ZSBjYWxscyB0byB0aGUgUXVldWUsIGVzcGVjaWFsbHksIGNhbGxpbmdcbiAgICAgICAgICAgICAgICAvLyBEaXNwb3NlKCkgb24gdGhlIHF1ZXVlIGFscmVkeSAod2hpY2ggd291bGQgcmVzZXQgdGhlIHZhclxuICAgICAgICAgICAgICAgIC8vIGhlcmUgdG8gbnVsbCEpLlxuICAgICAgICAgICAgICAgIC8vIFRoYXQgc2hvdWxkIGdlbmVyYWxseSBob2xkIHRydWUgZm9yIGphdmFzY3JpcHQuLi5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2U3Vic2NyaWJlcnMgPT09IHN1YnMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3Vic2NyaWJlcnMgPSBzdWJzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBub3RlOiB0aGlzIGJsb2NrIGFzc3VtZXMgY29vcGVyYXRpdmUgbXVsdGl0YXNraW5nLCBpLmUuLFxuICAgICAgICAgICAgICAgIC8vIGJldHdlZW4gdGhlIGlmLXN0YXRlbWVudCBhbmQgdGhlIGFzc2lnbm1lbnQgdGhlcmUgYXJlIG5vXG4gICAgICAgICAgICAgICAgLy8gdGhyZWFkIHN3aXRjaGVzLlxuICAgICAgICAgICAgICAgIC8vIFJlYXNvbiBpcyB0aGF0IGJldHdlZW4gdGhlIGluaXRpYWwgY29uc3QgPSB0aGlzLjsgYW5kIHRoaXNcbiAgICAgICAgICAgICAgICAvLyBwb2ludCB0aGVyZSBpcyB0aGUgZGVycmFsLnJlc29sdmUoKSBvcGVyYXRpb24gdGhhdCBtaWdodCBoYXZlXG4gICAgICAgICAgICAgICAgLy8gY2F1c2VkIHJlY3Vyc2l2ZSBjYWxscyB0byB0aGUgUXVldWUsIGVzcGVjaWFsbHksIGNhbGxpbmdcbiAgICAgICAgICAgICAgICAvLyBEaXNwb3NlKCkgb24gdGhlIHF1ZXVlIGFscmVkeSAod2hpY2ggd291bGQgcmVzZXQgdGhlIHZhclxuICAgICAgICAgICAgICAgIC8vIGhlcmUgdG8gbnVsbCEpLlxuICAgICAgICAgICAgICAgIC8vIFRoYXQgc2hvdWxkIGdlbmVyYWxseSBob2xkIHRydWUgZm9yIGphdmFzY3JpcHQuLi5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2TGlzdCA9PT0gbGlzdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2TGlzdCA9IGxpc3RzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucHJpdklzRHJhaW5JblByb2dyZXNzID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdGhyb3dJZkRpc3Bvc2UoKSB7XG4gICAgICAgIGlmICh0aGlzLmlzRGlzcG9zZWQoKSkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdkRpc3Bvc2VSZWFzb24pIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZE9wZXJhdGlvbkVycm9yKHRoaXMucHJpdkRpc3Bvc2VSZWFzb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyb3cgbmV3IE9iamVjdERpc3Bvc2VkRXJyb3IoXCJRdWV1ZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnByaXZJc0Rpc3Bvc2luZykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRPcGVyYXRpb25FcnJvcihcIlF1ZXVlIGRpc3Bvc2luZ1wiKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UXVldWUuanMubWFwXG4iLCIvKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFzc2lnbm1lbnQgKi9cbi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgTWVzc2FnZVR5cGUgfSBmcm9tIFwiLi9Db25uZWN0aW9uTWVzc2FnZVwiO1xuaW1wb3J0IHsgQXJndW1lbnROdWxsRXJyb3IsIEludmFsaWRPcGVyYXRpb25FcnJvciB9IGZyb20gXCIuL0Vycm9yXCI7XG5pbXBvcnQgeyBjcmVhdGVOb0Rhc2hHdWlkIH0gZnJvbSBcIi4vR3VpZFwiO1xuZXhwb3J0IGNsYXNzIFJhd1dlYnNvY2tldE1lc3NhZ2Uge1xuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2VUeXBlLCBwYXlsb2FkLCBpZCkge1xuICAgICAgICB0aGlzLnByaXZQYXlsb2FkID0gbnVsbDtcbiAgICAgICAgaWYgKCFwYXlsb2FkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXJyb3IoXCJwYXlsb2FkXCIpO1xuICAgICAgICB9XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLW1lbWJlci1hY2Nlc3NcbiAgICAgICAgaWYgKG1lc3NhZ2VUeXBlID09PSBNZXNzYWdlVHlwZS5CaW5hcnkgJiYgcGF5bG9hZC5fX3Byb3RvX18uY29uc3RydWN0b3IubmFtZSAhPT0gXCJBcnJheUJ1ZmZlclwiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZE9wZXJhdGlvbkVycm9yKFwiUGF5bG9hZCBtdXN0IGJlIEFycmF5QnVmZmVyXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtZXNzYWdlVHlwZSA9PT0gTWVzc2FnZVR5cGUuVGV4dCAmJiAhKHR5cGVvZiAocGF5bG9hZCkgPT09IFwic3RyaW5nXCIpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZE9wZXJhdGlvbkVycm9yKFwiUGF5bG9hZCBtdXN0IGJlIGEgc3RyaW5nXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdk1lc3NhZ2VUeXBlID0gbWVzc2FnZVR5cGU7XG4gICAgICAgIHRoaXMucHJpdlBheWxvYWQgPSBwYXlsb2FkO1xuICAgICAgICB0aGlzLnByaXZJZCA9IGlkID8gaWQgOiBjcmVhdGVOb0Rhc2hHdWlkKCk7XG4gICAgfVxuICAgIGdldCBtZXNzYWdlVHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdk1lc3NhZ2VUeXBlO1xuICAgIH1cbiAgICBnZXQgcGF5bG9hZCgpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtcmV0dXJuXG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQYXlsb2FkO1xuICAgIH1cbiAgICBnZXQgdGV4dENvbnRlbnQoKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZNZXNzYWdlVHlwZSA9PT0gTWVzc2FnZVR5cGUuQmluYXJ5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZE9wZXJhdGlvbkVycm9yKFwiTm90IHN1cHBvcnRlZCBmb3IgYmluYXJ5IG1lc3NhZ2VcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBheWxvYWQ7XG4gICAgfVxuICAgIGdldCBiaW5hcnlDb250ZW50KCkge1xuICAgICAgICBpZiAodGhpcy5wcml2TWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLlRleHQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXJyb3IoXCJOb3Qgc3VwcG9ydGVkIGZvciB0ZXh0IG1lc3NhZ2VcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBheWxvYWQ7XG4gICAgfVxuICAgIGdldCBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklkO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UmF3V2Vic29ja2V0TWVzc2FnZS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuZXhwb3J0IGNsYXNzIFJpZmZQY21FbmNvZGVyIHtcbiAgICBjb25zdHJ1Y3RvcihhY3R1YWxTYW1wbGVSYXRlLCBkZXNpcmVkU2FtcGxlUmF0ZSkge1xuICAgICAgICB0aGlzLnByaXZBY3R1YWxTYW1wbGVSYXRlID0gYWN0dWFsU2FtcGxlUmF0ZTtcbiAgICAgICAgdGhpcy5wcml2RGVzaXJlZFNhbXBsZVJhdGUgPSBkZXNpcmVkU2FtcGxlUmF0ZTtcbiAgICB9XG4gICAgZW5jb2RlKGFjdHVhbEF1ZGlvRnJhbWUpIHtcbiAgICAgICAgY29uc3QgYXVkaW9GcmFtZSA9IHRoaXMuZG93blNhbXBsZUF1ZGlvRnJhbWUoYWN0dWFsQXVkaW9GcmFtZSwgdGhpcy5wcml2QWN0dWFsU2FtcGxlUmF0ZSwgdGhpcy5wcml2RGVzaXJlZFNhbXBsZVJhdGUpO1xuICAgICAgICBpZiAoIWF1ZGlvRnJhbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGF1ZGlvTGVuZ3RoID0gYXVkaW9GcmFtZS5sZW5ndGggKiAyO1xuICAgICAgICBjb25zdCBidWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoYXVkaW9MZW5ndGgpO1xuICAgICAgICBjb25zdCB2aWV3ID0gbmV3IERhdGFWaWV3KGJ1ZmZlcik7XG4gICAgICAgIHRoaXMuZmxvYXRUbzE2Qml0UENNKHZpZXcsIDAsIGF1ZGlvRnJhbWUpO1xuICAgICAgICByZXR1cm4gYnVmZmVyO1xuICAgIH1cbiAgICBzZXRTdHJpbmcodmlldywgb2Zmc2V0LCBzdHIpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZpZXcuc2V0VWludDgob2Zmc2V0ICsgaSwgc3RyLmNoYXJDb2RlQXQoaSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZsb2F0VG8xNkJpdFBDTSh2aWV3LCBvZmZzZXQsIGlucHV0KSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW5wdXQubGVuZ3RoOyBpKyssIG9mZnNldCArPSAyKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gTWF0aC5tYXgoLTEsIE1hdGgubWluKDEsIGlucHV0W2ldKSk7XG4gICAgICAgICAgICB2aWV3LnNldEludDE2KG9mZnNldCwgcyA8IDAgPyBzICogMHg4MDAwIDogcyAqIDB4N0ZGRiwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZG93blNhbXBsZUF1ZGlvRnJhbWUoc3JjRnJhbWUsIHNyY1JhdGUsIGRzdFJhdGUpIHtcbiAgICAgICAgaWYgKCFzcmNGcmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRzdFJhdGUgPT09IHNyY1JhdGUgfHwgZHN0UmF0ZSA+IHNyY1JhdGUpIHtcbiAgICAgICAgICAgIHJldHVybiBzcmNGcmFtZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByYXRpbyA9IHNyY1JhdGUgLyBkc3RSYXRlO1xuICAgICAgICBjb25zdCBkc3RMZW5ndGggPSBNYXRoLnJvdW5kKHNyY0ZyYW1lLmxlbmd0aCAvIHJhdGlvKTtcbiAgICAgICAgY29uc3QgZHN0RnJhbWUgPSBuZXcgRmxvYXQzMkFycmF5KGRzdExlbmd0aCk7XG4gICAgICAgIGxldCBzcmNPZmZzZXQgPSAwO1xuICAgICAgICBsZXQgZHN0T2Zmc2V0ID0gMDtcbiAgICAgICAgd2hpbGUgKGRzdE9mZnNldCA8IGRzdExlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgbmV4dFNyY09mZnNldCA9IE1hdGgucm91bmQoKGRzdE9mZnNldCArIDEpICogcmF0aW8pO1xuICAgICAgICAgICAgbGV0IGFjY3VtID0gMDtcbiAgICAgICAgICAgIGxldCBjb3VudCA9IDA7XG4gICAgICAgICAgICB3aGlsZSAoc3JjT2Zmc2V0IDwgbmV4dFNyY09mZnNldCAmJiBzcmNPZmZzZXQgPCBzcmNGcmFtZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBhY2N1bSArPSBzcmNGcmFtZVtzcmNPZmZzZXQrK107XG4gICAgICAgICAgICAgICAgY291bnQrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRzdEZyYW1lW2RzdE9mZnNldCsrXSA9IGFjY3VtIC8gY291bnQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRzdEZyYW1lO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UmlmZlBjbUVuY29kZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgSW52YWxpZE9wZXJhdGlvbkVycm9yIH0gZnJvbSBcIi4vRXJyb3JcIjtcbmltcG9ydCB7IGNyZWF0ZU5vRGFzaEd1aWQgfSBmcm9tIFwiLi9HdWlkXCI7XG5pbXBvcnQgeyBRdWV1ZSB9IGZyb20gXCIuL1F1ZXVlXCI7XG5leHBvcnQgY2xhc3MgU3RyZWFtIHtcbiAgICBjb25zdHJ1Y3RvcihzdHJlYW1JZCkge1xuICAgICAgICB0aGlzLnByaXZJc1dyaXRlRW5kZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2SXNSZWFkRW5kZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2SWQgPSBzdHJlYW1JZCA/IHN0cmVhbUlkIDogY3JlYXRlTm9EYXNoR3VpZCgpO1xuICAgICAgICB0aGlzLnByaXZSZWFkZXJRdWV1ZSA9IG5ldyBRdWV1ZSgpO1xuICAgIH1cbiAgICBnZXQgaXNDbG9zZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJc1dyaXRlRW5kZWQ7XG4gICAgfVxuICAgIGdldCBpc1JlYWRFbmRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzUmVhZEVuZGVkO1xuICAgIH1cbiAgICBnZXQgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJZDtcbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIGlmICghdGhpcy5wcml2SXNXcml0ZUVuZGVkKSB7XG4gICAgICAgICAgICB0aGlzLndyaXRlU3RyZWFtQ2h1bmsoe1xuICAgICAgICAgICAgICAgIGJ1ZmZlcjogbnVsbCxcbiAgICAgICAgICAgICAgICBpc0VuZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0aW1lUmVjZWl2ZWQ6IERhdGUubm93KCksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMucHJpdklzV3JpdGVFbmRlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgd3JpdGVTdHJlYW1DaHVuayhzdHJlYW1DaHVuaykge1xuICAgICAgICB0aGlzLnRocm93SWZDbG9zZWQoKTtcbiAgICAgICAgaWYgKCF0aGlzLnByaXZSZWFkZXJRdWV1ZS5pc0Rpc3Bvc2VkKCkpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVhZGVyUXVldWUuZW5xdWV1ZShzdHJlYW1DaHVuayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vIERvIG5vdGhpbmdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZWFkKCkge1xuICAgICAgICBpZiAodGhpcy5wcml2SXNSZWFkRW5kZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXJyb3IoXCJTdHJlYW0gcmVhZCBoYXMgYWxyZWFkeSBmaW5pc2hlZFwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVhZGVyUXVldWVcbiAgICAgICAgICAgIC5kZXF1ZXVlKClcbiAgICAgICAgICAgIC50aGVuKChzdHJlYW1DaHVuaykgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKHN0cmVhbUNodW5rID09PSB1bmRlZmluZWQgfHwgc3RyZWFtQ2h1bmsuaXNFbmQpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZSZWFkZXJRdWV1ZS5kaXNwb3NlKFwiRW5kIG9mIHN0cmVhbSByZWFjaGVkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHN0cmVhbUNodW5rO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHJlYWRFbmRlZCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnByaXZJc1JlYWRFbmRlZCkge1xuICAgICAgICAgICAgdGhpcy5wcml2SXNSZWFkRW5kZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVhZGVyUXVldWUgPSBuZXcgUXVldWUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0aHJvd0lmQ2xvc2VkKCkge1xuICAgICAgICBpZiAodGhpcy5wcml2SXNXcml0ZUVuZGVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZE9wZXJhdGlvbkVycm9yKFwiU3RyZWFtIGNsb3NlZFwiKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3RyZWFtLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIFN0cmluZyBoZWxwZXIgZnVuY3Rpb25zXG4gKi9cbmV4cG9ydCBjbGFzcyBTdHJpbmdVdGlscyB7XG4gICAgLyoqXG4gICAgICogRm9ybWF0cyBhIHN0cmluZyBieSByZXBsYWNpbmcgdGhlIG5hbWVkIHtrZXlzfSBpbiB0aGUgc3RyaW5nIHdpdGggdGhlIHZhbHVlcyBjb250YWluZWQgaW4gdGhlIHJlcGxhY2VtZW50IGRpY3Rpb25hcnkuXG4gICAgICogQHBhcmFtIGZvcm1hdCBUaGUgZm9ybWF0IHN0cmluZyB0aGF0IGNvbnRhaW5zIHRoZSBwYXJ0cyB0byByZXBsYWNlIHN1cnJvdW5kZWQgYnkge30uIEZvciBleGFtcGxlOiBcIndzczovL3tyZWdpb259LmN0cy5zcGVlY2gubWljcm9zb2Z0LmNvbVwiLlxuICAgICAqIElmIHlvdXIgc3RyaW5nIG5lZWRzIHRvIGNvbnRhaW4gYSB7IG9yIH0geW91IGNhbiB1c2UgdGhlIHt7IGFuZCB9fSBlc2NhcGUgc2VxdWVuY2VzIHJlc3BlY3RpdmVseS5cbiAgICAgKiBAcGFyYW0gcmVwbGFjZW1lbnRzIFRoZSBkaWN0aW9uYXJ5IG9mIHJlcGxhY2VtZW50cy4gSWYgYSByZXBsYWNlbWVudCBpcyBub3QgZm91bmQsIGl0IGlzIHJlcGxhY2VkIHdpdGggYW4gZW1wdHkgc3RyaW5nXG4gICAgICogQHJldHVybnMgVGhlIGZvcm1hdHRlZCBzdHJpbmcuIElmIHlvdSBwYXNzIGluIGEgbnVsbCBvciB1bmRlZmluZWQgZm9ybWF0IHN0cmluZywgYW4gZW1wdHkgc3RyaW5nIHdpbGwgYmUgcmV0dXJuZWRcbiAgICAgKi9cbiAgICBzdGF0aWMgZm9ybWF0U3RyaW5nKGZvcm1hdCwgcmVwbGFjZW1lbnRzKSB7XG4gICAgICAgIGlmICghZm9ybWF0KSB7XG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXJlcGxhY2VtZW50cykge1xuICAgICAgICAgICAgcmV0dXJuIGZvcm1hdDtcbiAgICAgICAgfVxuICAgICAgICBsZXQgZm9ybWF0dGVkID0gXCJcIjtcbiAgICAgICAgbGV0IGtleSA9IFwiXCI7XG4gICAgICAgIGNvbnN0IGFwcGVuZFRvRm9ybWF0dGVkID0gKHN0cikgPT4ge1xuICAgICAgICAgICAgZm9ybWF0dGVkICs9IHN0cjtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgYXBwZW5kVG9LZXkgPSAoc3RyKSA9PiB7XG4gICAgICAgICAgICBrZXkgKz0gc3RyO1xuICAgICAgICB9O1xuICAgICAgICBsZXQgYXBwZW5kRnVuYyA9IGFwcGVuZFRvRm9ybWF0dGVkO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZvcm1hdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgYyA9IGZvcm1hdFtpXTtcbiAgICAgICAgICAgIGNvbnN0IG5leHQgPSBpICsgMSA8IGZvcm1hdC5sZW5ndGggPyBmb3JtYXRbaSArIDFdIDogXCJcIjtcbiAgICAgICAgICAgIHN3aXRjaCAoYykge1xuICAgICAgICAgICAgICAgIGNhc2UgXCJ7XCI6XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXh0ID09PSBcIntcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXBwZW5kRnVuYyhcIntcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmRGdW5jID0gYXBwZW5kVG9LZXk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcIn1cIjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5leHQgPT09IFwifVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmRGdW5jKFwifVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXBsYWNlbWVudHMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlZCArPSByZXBsYWNlbWVudHNba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFwcGVuZEZ1bmMgPSBhcHBlbmRUb0Zvcm1hdHRlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgYXBwZW5kRnVuYyhjKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZvcm1hdHRlZDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVN0cmluZ1V0aWxzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5leHBvcnQgY2xhc3MgVGltZW91dCB7XG4gICAgc3RhdGljIGxvYWQoKSB7XG4gICAgICAgIC8vIFByZWZpbGxpbmcgdGhlIE1hcHMgd2l0aCBhIGZ1bmN0aW9uIGluZGV4ZWQgYnkgemVybyBpcyBuZWNlc3NhcnkgdG8gYmUgY29tcGxpYW50IHdpdGggdGhlIHNwZWNpZmljYXRpb24uXG4gICAgICAgIGNvbnN0IHNjaGVkdWxlZFRpbWVvdXRGdW5jdGlvbnMgPSBuZXcgTWFwKFtbMCwgKCkgPT4geyB9XV0pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvblxuICAgICAgICBjb25zdCB1bmhhbmRsZWRSZXF1ZXN0cyA9IG5ldyBNYXAoKTtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gICAgICAgIGNvbnN0IHdvcmtlclNjcmlwdCA9IGAhZnVuY3Rpb24oZSl7dmFyIHQ9e307ZnVuY3Rpb24gbihyKXtpZih0W3JdKXJldHVybiB0W3JdLmV4cG9ydHM7dmFyIG89dFtyXT17aTpyLGw6ITEsZXhwb3J0czp7fX07cmV0dXJuIGVbcl0uY2FsbChvLmV4cG9ydHMsbyxvLmV4cG9ydHMsbiksby5sPSEwLG8uZXhwb3J0c31uLm09ZSxuLmM9dCxuLmQ9ZnVuY3Rpb24oZSx0LHIpe24ubyhlLHQpfHxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LHtlbnVtZXJhYmxlOiEwLGdldDpyfSl9LG4ucj1mdW5jdGlvbihlKXtcInVuZGVmaW5lZFwiIT10eXBlb2YgU3ltYm9sJiZTeW1ib2wudG9TdHJpbmdUYWcmJk9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLFN5bWJvbC50b1N0cmluZ1RhZyx7dmFsdWU6XCJNb2R1bGVcIn0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pfSxuLnQ9ZnVuY3Rpb24oZSx0KXtpZigxJnQmJihlPW4oZSkpLDgmdClyZXR1cm4gZTtpZig0JnQmJlwib2JqZWN0XCI9PXR5cGVvZiBlJiZlJiZlLl9fZXNNb2R1bGUpcmV0dXJuIGU7dmFyIHI9T2JqZWN0LmNyZWF0ZShudWxsKTtpZihuLnIociksT2JqZWN0LmRlZmluZVByb3BlcnR5KHIsXCJkZWZhdWx0XCIse2VudW1lcmFibGU6ITAsdmFsdWU6ZX0pLDImdCYmXCJzdHJpbmdcIiE9dHlwZW9mIGUpZm9yKHZhciBvIGluIGUpbi5kKHIsbyxmdW5jdGlvbih0KXtyZXR1cm4gZVt0XX0uYmluZChudWxsLG8pKTtyZXR1cm4gcn0sbi5uPWZ1bmN0aW9uKGUpe3ZhciB0PWUmJmUuX19lc01vZHVsZT9mdW5jdGlvbigpe3JldHVybiBlLmRlZmF1bHR9OmZ1bmN0aW9uKCl7cmV0dXJuIGV9O3JldHVybiBuLmQodCxcImFcIix0KSx0fSxuLm89ZnVuY3Rpb24oZSx0KXtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsdCl9LG4ucD1cIlwiLG4obi5zPTE0KX0oW2Z1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtuLmQodCxcImFcIiwoZnVuY3Rpb24oKXtyZXR1cm4gaX0pKSxuLmQodCxcImJcIiwoZnVuY3Rpb24oKXtyZXR1cm4gdX0pKSxuLmQodCxcImNcIiwoZnVuY3Rpb24oKXtyZXR1cm4gYX0pKSxuLmQodCxcImRcIiwoZnVuY3Rpb24oKXtyZXR1cm4gZH0pKTtjb25zdCByPW5ldyBNYXAsbz1uZXcgTWFwLGk9ZT0+e2NvbnN0IHQ9ci5nZXQoZSk7aWYodm9pZCAwPT09dCl0aHJvdyBuZXcgRXJyb3IoJ1RoZXJlIGlzIG5vIGludGVydmFsIHNjaGVkdWxlZCB3aXRoIHRoZSBnaXZlbiBpZCBcIicuY29uY2F0KGUsJ1wiLicpKTtjbGVhclRpbWVvdXQodCksci5kZWxldGUoZSl9LHU9ZT0+e2NvbnN0IHQ9by5nZXQoZSk7aWYodm9pZCAwPT09dCl0aHJvdyBuZXcgRXJyb3IoJ1RoZXJlIGlzIG5vIHRpbWVvdXQgc2NoZWR1bGVkIHdpdGggdGhlIGdpdmVuIGlkIFwiJy5jb25jYXQoZSwnXCIuJykpO2NsZWFyVGltZW91dCh0KSxvLmRlbGV0ZShlKX0sZj0oZSx0KT0+e2xldCBuLHI7aWYoXCJwZXJmb3JtYW5jZVwiaW4gc2VsZil7Y29uc3Qgbz1wZXJmb3JtYW5jZS5ub3coKTtuPW8scj1lLU1hdGgubWF4KDAsby10KX1lbHNlIG49RGF0ZS5ub3coKSxyPWU7cmV0dXJue2V4cGVjdGVkOm4rcixyZW1haW5pbmdEZWxheTpyfX0sYz0oZSx0LG4scik9Pntjb25zdCBvPVwicGVyZm9ybWFuY2VcImluIHNlbGY/cGVyZm9ybWFuY2Uubm93KCk6RGF0ZS5ub3coKTtvPm4/cG9zdE1lc3NhZ2Uoe2lkOm51bGwsbWV0aG9kOlwiY2FsbFwiLHBhcmFtczp7dGltZXJJZDp0fX0pOmUuc2V0KHQsc2V0VGltZW91dChjLG4tbyxlLHQsbikpfSxhPShlLHQsbik9Pntjb25zdHtleHBlY3RlZDpvLHJlbWFpbmluZ0RlbGF5Oml9PWYoZSxuKTtyLnNldCh0LHNldFRpbWVvdXQoYyxpLHIsdCxvKSl9LGQ9KGUsdCxuKT0+e2NvbnN0e2V4cGVjdGVkOnIscmVtYWluaW5nRGVsYXk6aX09ZihlLG4pO28uc2V0KHQsc2V0VGltZW91dChjLGksbyx0LHIpKX19LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtuLnIodCk7dmFyIHI9bigyKTtmb3IodmFyIG8gaW4gcilcImRlZmF1bHRcIiE9PW8mJmZ1bmN0aW9uKGUpe24uZCh0LGUsKGZ1bmN0aW9uKCl7cmV0dXJuIHJbZV19KSl9KG8pO3ZhciBpPW4oMyk7Zm9yKHZhciBvIGluIGkpXCJkZWZhdWx0XCIhPT1vJiZmdW5jdGlvbihlKXtuLmQodCxlLChmdW5jdGlvbigpe3JldHVybiBpW2VdfSkpfShvKTt2YXIgdT1uKDQpO2Zvcih2YXIgbyBpbiB1KVwiZGVmYXVsdFwiIT09byYmZnVuY3Rpb24oZSl7bi5kKHQsZSwoZnVuY3Rpb24oKXtyZXR1cm4gdVtlXX0pKX0obyk7dmFyIGY9big1KTtmb3IodmFyIG8gaW4gZilcImRlZmF1bHRcIiE9PW8mJmZ1bmN0aW9uKGUpe24uZCh0LGUsKGZ1bmN0aW9uKCl7cmV0dXJuIGZbZV19KSl9KG8pO3ZhciBjPW4oNik7Zm9yKHZhciBvIGluIGMpXCJkZWZhdWx0XCIhPT1vJiZmdW5jdGlvbihlKXtuLmQodCxlLChmdW5jdGlvbigpe3JldHVybiBjW2VdfSkpfShvKTt2YXIgYT1uKDcpO2Zvcih2YXIgbyBpbiBhKVwiZGVmYXVsdFwiIT09byYmZnVuY3Rpb24oZSl7bi5kKHQsZSwoZnVuY3Rpb24oKXtyZXR1cm4gYVtlXX0pKX0obyk7dmFyIGQ9big4KTtmb3IodmFyIG8gaW4gZClcImRlZmF1bHRcIiE9PW8mJmZ1bmN0aW9uKGUpe24uZCh0LGUsKGZ1bmN0aW9uKCl7cmV0dXJuIGRbZV19KSl9KG8pO3ZhciBzPW4oOSk7Zm9yKHZhciBvIGluIHMpXCJkZWZhdWx0XCIhPT1vJiZmdW5jdGlvbihlKXtuLmQodCxlLChmdW5jdGlvbigpe3JldHVybiBzW2VdfSkpfShvKX0sZnVuY3Rpb24oZSx0KXt9LGZ1bmN0aW9uKGUsdCl7fSxmdW5jdGlvbihlLHQpe30sZnVuY3Rpb24oZSx0KXt9LGZ1bmN0aW9uKGUsdCl7fSxmdW5jdGlvbihlLHQpe30sZnVuY3Rpb24oZSx0KXt9LGZ1bmN0aW9uKGUsdCl7fSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7bi5yKHQpO3ZhciByPW4oMTEpO2Zvcih2YXIgbyBpbiByKVwiZGVmYXVsdFwiIT09byYmZnVuY3Rpb24oZSl7bi5kKHQsZSwoZnVuY3Rpb24oKXtyZXR1cm4gcltlXX0pKX0obyk7dmFyIGk9bigxMik7Zm9yKHZhciBvIGluIGkpXCJkZWZhdWx0XCIhPT1vJiZmdW5jdGlvbihlKXtuLmQodCxlLChmdW5jdGlvbigpe3JldHVybiBpW2VdfSkpfShvKTt2YXIgdT1uKDEzKTtmb3IodmFyIG8gaW4gdSlcImRlZmF1bHRcIiE9PW8mJmZ1bmN0aW9uKGUpe24uZCh0LGUsKGZ1bmN0aW9uKCl7cmV0dXJuIHVbZV19KSl9KG8pfSxmdW5jdGlvbihlLHQpe30sZnVuY3Rpb24oZSx0KXt9LGZ1bmN0aW9uKGUsdCl7fSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7bi5yKHQpO3ZhciByPW4oMCksbz1uKDEpO2Zvcih2YXIgaSBpbiBvKVwiZGVmYXVsdFwiIT09aSYmZnVuY3Rpb24oZSl7bi5kKHQsZSwoZnVuY3Rpb24oKXtyZXR1cm4gb1tlXX0pKX0oaSk7dmFyIHU9bigxMCk7Zm9yKHZhciBpIGluIHUpXCJkZWZhdWx0XCIhPT1pJiZmdW5jdGlvbihlKXtuLmQodCxlLChmdW5jdGlvbigpe3JldHVybiB1W2VdfSkpfShpKTthZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCh7ZGF0YTplfSk9Pnt0cnl7aWYoXCJjbGVhclwiPT09ZS5tZXRob2Qpe2NvbnN0e2lkOnQscGFyYW1zOnt0aW1lcklkOm59fT1lO09iamVjdChyLmIpKG4pLHBvc3RNZXNzYWdlKHtlcnJvcjpudWxsLGlkOnR9KX1lbHNle2lmKFwic2V0XCIhPT1lLm1ldGhvZCl0aHJvdyBuZXcgRXJyb3IoJ1RoZSBnaXZlbiBtZXRob2QgXCInLmNvbmNhdChlLm1ldGhvZCwnXCIgaXMgbm90IHN1cHBvcnRlZCcpKTt7Y29uc3R7cGFyYW1zOntkZWxheTp0LG5vdzpuLHRpbWVySWQ6b319PWU7T2JqZWN0KHIuZCkodCxvLG4pfX19Y2F0Y2godCl7cG9zdE1lc3NhZ2Uoe2Vycm9yOnttZXNzYWdlOnQubWVzc2FnZX0saWQ6ZS5pZCxyZXN1bHQ6bnVsbH0pfX0pfV0pO2A7XG4gICAgICAgIGNvbnN0IHdvcmtlclVybCA9IFwiZGF0YTp0ZXh0L2phdmFzY3JpcHQ7YmFzZTY0LFwiICsgYnRvYSh3b3JrZXJTY3JpcHQpO1xuICAgICAgICBjb25zdCB3b3JrZXIgPSBuZXcgV29ya2VyKHdvcmtlclVybCk7XG4gICAgICAgIHdvcmtlci5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCAoeyBkYXRhIH0pID0+IHtcbiAgICAgICAgICAgIGlmIChUaW1lb3V0LmlzQ2FsbE5vdGlmaWNhdGlvbihkYXRhKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgcGFyYW1zOiB7IHRpbWVySWQgfSB9ID0gZGF0YTtcbiAgICAgICAgICAgICAgICBjb25zdCBpZE9yRnVuYyA9IHNjaGVkdWxlZFRpbWVvdXRGdW5jdGlvbnMuZ2V0KHRpbWVySWQpO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgaWRPckZ1bmMgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdW5oYW5kbGVkVGltZXJJZCA9IHVuaGFuZGxlZFJlcXVlc3RzLmdldChpZE9yRnVuYyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1bmhhbmRsZWRUaW1lcklkID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVuaGFuZGxlZFRpbWVySWQgIT09IHRpbWVySWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSB0aW1lciBpcyBpbiBhbiB1bmRlZmluZWQgc3RhdGUuXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBpZE9yRnVuYyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgICAgICAgICBpZE9yRnVuYygpO1xuICAgICAgICAgICAgICAgICAgICAvLyBBIHRpbWVvdXQgY2FuIGJlIHNhZmVseSBkZWxldGVkIGJlY2F1c2UgaXQgaXMgb25seSBjYWxsZWQgb25jZS5cbiAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGVkVGltZW91dEZ1bmN0aW9ucy5kZWxldGUodGltZXJJZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGUgdGltZXIgaXMgaW4gYW4gdW5kZWZpbmVkIHN0YXRlLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChUaW1lb3V0LmlzQ2xlYXJSZXNwb25zZShkYXRhKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgaWQgfSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgY29uc3QgdW5oYW5kbGVkVGltZXJJZCA9IHVuaGFuZGxlZFJlcXVlc3RzLmdldChpZCk7XG4gICAgICAgICAgICAgICAgaWYgKHVuaGFuZGxlZFRpbWVySWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGUgdGltZXIgaXMgaW4gYW4gdW5kZWZpbmVkIHN0YXRlLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdW5oYW5kbGVkUmVxdWVzdHMuZGVsZXRlKGlkKTtcbiAgICAgICAgICAgICAgICBzY2hlZHVsZWRUaW1lb3V0RnVuY3Rpb25zLmRlbGV0ZSh1bmhhbmRsZWRUaW1lcklkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgZXJyb3I6IHsgbWVzc2FnZSB9IH0gPSBkYXRhO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihtZXNzYWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGNsZWFyVGltZW91dCA9ICh0aW1lcklkKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpZCA9IE1hdGgucmFuZG9tKCk7XG4gICAgICAgICAgICB1bmhhbmRsZWRSZXF1ZXN0cy5zZXQoaWQsIHRpbWVySWQpO1xuICAgICAgICAgICAgc2NoZWR1bGVkVGltZW91dEZ1bmN0aW9ucy5zZXQodGltZXJJZCwgaWQpO1xuICAgICAgICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKHtcbiAgICAgICAgICAgICAgICBpZCxcbiAgICAgICAgICAgICAgICBtZXRob2Q6IFwiY2xlYXJcIixcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHsgdGltZXJJZCB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgc2V0VGltZW91dCA9IChmdW5jLCBkZWxheSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdGltZXJJZCA9IE1hdGgucmFuZG9tKCk7XG4gICAgICAgICAgICBzY2hlZHVsZWRUaW1lb3V0RnVuY3Rpb25zLnNldCh0aW1lcklkLCBmdW5jKTtcbiAgICAgICAgICAgIHdvcmtlci5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICAgICAgaWQ6IG51bGwsXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcInNldFwiLFxuICAgICAgICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgICAgICAgICBkZWxheSxcbiAgICAgICAgICAgICAgICAgICAgbm93OiBwZXJmb3JtYW5jZS5ub3coKSxcbiAgICAgICAgICAgICAgICAgICAgdGltZXJJZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRpbWVySWQ7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQsXG4gICAgICAgICAgICBzZXRUaW1lb3V0XG4gICAgICAgIH07XG4gICAgfVxuICAgIHN0YXRpYyBsb2FkV29ya2VyVGltZXJzKCkge1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKFRpbWVvdXQud29ya2VyVGltZXJzICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFRpbWVvdXQud29ya2VyVGltZXJzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgVGltZW91dC53b3JrZXJUaW1lcnMgPSBUaW1lb3V0LmxvYWQoKTtcbiAgICAgICAgICAgIHJldHVybiBUaW1lb3V0LndvcmtlclRpbWVycztcbiAgICAgICAgfTtcbiAgICB9XG4gICAgc3RhdGljIGlzQ2FsbE5vdGlmaWNhdGlvbihtZXNzYWdlKSB7XG4gICAgICAgIHJldHVybiBtZXNzYWdlLm1ldGhvZCAhPT0gdW5kZWZpbmVkICYmIG1lc3NhZ2UubWV0aG9kID09PSBcImNhbGxcIjtcbiAgICB9XG4gICAgc3RhdGljIGlzQ2xlYXJSZXNwb25zZShtZXNzYWdlKSB7XG4gICAgICAgIHJldHVybiBtZXNzYWdlLmVycm9yID09PSBudWxsICYmIHR5cGVvZiBtZXNzYWdlLmlkID09PSBcIm51bWJlclwiO1xuICAgIH1cbn1cblRpbWVvdXQud29ya2VyVGltZXJzID0gbnVsbDtcblRpbWVvdXQuY2xlYXJUaW1lb3V0ID0gKHRpbWVySWQpID0+IFRpbWVvdXQudGltZXJzKCkuY2xlYXJUaW1lb3V0KHRpbWVySWQpO1xuVGltZW91dC5zZXRUaW1lb3V0ID0gKGZ1bmMsIGRlbGF5KSA9PiBUaW1lb3V0LnRpbWVycygpLnNldFRpbWVvdXQoZnVuYywgZGVsYXkpO1xuVGltZW91dC50aW1lcnMgPSBUaW1lb3V0LmxvYWRXb3JrZXJUaW1lcnMoKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VGltZW91dC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBEZWZpbmVzIGNvbnRlbnRzIG9mIHJlY2VpdmVkIG1lc3NhZ2UvZXZlbnRzLlxuICogQGNsYXNzIEFjdGl2aXR5UmVjZWl2ZWRFdmVudEFyZ3NcbiAqL1xuZXhwb3J0IGNsYXNzIEFjdGl2aXR5UmVjZWl2ZWRFdmVudEFyZ3Mge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHthbnl9IGFjdGl2aXR5IC0gVGhlIGFjdGl2aXR5Li5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihhY3Rpdml0eSwgYXVkaW9TdHJlYW0pIHtcbiAgICAgICAgdGhpcy5wcml2QWN0aXZpdHkgPSBhY3Rpdml0eTtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9TdHJlYW0gPSBhdWRpb1N0cmVhbTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgcmVjZWl2ZWQgYWN0aXZpdHlcbiAgICAgKiBAbWVtYmVyIEFjdGl2aXR5UmVjZWl2ZWRFdmVudEFyZ3MucHJvdG90eXBlLmFjdGl2aXR5XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHthbnl9IHRoZSByZWNlaXZlZCBhY3Rpdml0eS5cbiAgICAgKi9cbiAgICBnZXQgYWN0aXZpdHkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBY3Rpdml0eTtcbiAgICB9XG4gICAgZ2V0IGF1ZGlvU3RyZWFtKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXVkaW9TdHJlYW07XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1BY3Rpdml0eVJlY2VpdmVkRXZlbnRBcmdzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBGaWxlQXVkaW9Tb3VyY2UsIE1pY0F1ZGlvU291cmNlLCBQY21SZWNvcmRlciwgfSBmcm9tIFwiLi4vLi4vY29tbW9uLmJyb3dzZXIvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4uL0NvbnRyYWN0c1wiO1xuaW1wb3J0IHsgQXVkaW9JbnB1dFN0cmVhbSwgUHVsbEF1ZGlvSW5wdXRTdHJlYW1DYWxsYmFjaywgUHVsbEF1ZGlvT3V0cHV0U3RyZWFtLCBQdXNoQXVkaW9PdXRwdXRTdHJlYW0sIFB1c2hBdWRpb091dHB1dFN0cmVhbUNhbGxiYWNrLCBTcGVha2VyQXVkaW9EZXN0aW5hdGlvbiB9IGZyb20gXCIuLi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBBdWRpb0ZpbGVXcml0ZXIgfSBmcm9tIFwiLi9BdWRpb0ZpbGVXcml0ZXJcIjtcbmltcG9ydCB7IFB1bGxBdWRpb0lucHV0U3RyZWFtSW1wbCB9IGZyb20gXCIuL0F1ZGlvSW5wdXRTdHJlYW1cIjtcbmltcG9ydCB7IFB1c2hBdWRpb091dHB1dFN0cmVhbUltcGwgfSBmcm9tIFwiLi9BdWRpb091dHB1dFN0cmVhbVwiO1xuLyoqXG4gKiBSZXByZXNlbnRzIGF1ZGlvIGlucHV0IGNvbmZpZ3VyYXRpb24gdXNlZCBmb3Igc3BlY2lmeWluZyB3aGF0IHR5cGUgb2YgaW5wdXQgdG8gdXNlIChtaWNyb3Bob25lLCBmaWxlLCBzdHJlYW0pLlxuICogQGNsYXNzIEF1ZGlvQ29uZmlnXG4gKiBVcGRhdGVkIGluIHZlcnNpb24gMS4xMS4wXG4gKi9cbmV4cG9ydCBjbGFzcyBBdWRpb0NvbmZpZyB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBBdWRpb0NvbmZpZyBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBkZWZhdWx0IG1pY3JvcGhvbmUgb24gdGhlIHN5c3RlbS5cbiAgICAgKiBAbWVtYmVyIEF1ZGlvQ29uZmlnLmZyb21EZWZhdWx0TWljcm9waG9uZUlucHV0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtBdWRpb0NvbmZpZ30gVGhlIGF1ZGlvIGlucHV0IGNvbmZpZ3VyYXRpb24gYmVpbmcgY3JlYXRlZC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbURlZmF1bHRNaWNyb3Bob25lSW5wdXQoKSB7XG4gICAgICAgIGNvbnN0IHBjbVJlY29yZGVyID0gbmV3IFBjbVJlY29yZGVyKHRydWUpO1xuICAgICAgICByZXR1cm4gbmV3IEF1ZGlvQ29uZmlnSW1wbChuZXcgTWljQXVkaW9Tb3VyY2UocGNtUmVjb3JkZXIpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBBdWRpb0NvbmZpZyBvYmplY3QgcmVwcmVzZW50aW5nIGEgbWljcm9waG9uZSB3aXRoIHRoZSBzcGVjaWZpZWQgZGV2aWNlIElELlxuICAgICAqIEBtZW1iZXIgQXVkaW9Db25maWcuZnJvbU1pY3JvcGhvbmVJbnB1dFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZyB8IHVuZGVmaW5lZH0gZGV2aWNlSWQgLSBTcGVjaWZpZXMgdGhlIGRldmljZSBJRCBvZiB0aGUgbWljcm9waG9uZSB0byBiZSB1c2VkLlxuICAgICAqIERlZmF1bHQgbWljcm9waG9uZSBpcyB1c2VkIHRoZSB2YWx1ZSBpcyBvbWl0dGVkLlxuICAgICAqIEByZXR1cm5zIHtBdWRpb0NvbmZpZ30gVGhlIGF1ZGlvIGlucHV0IGNvbmZpZ3VyYXRpb24gYmVpbmcgY3JlYXRlZC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbU1pY3JvcGhvbmVJbnB1dChkZXZpY2VJZCkge1xuICAgICAgICBjb25zdCBwY21SZWNvcmRlciA9IG5ldyBQY21SZWNvcmRlcih0cnVlKTtcbiAgICAgICAgcmV0dXJuIG5ldyBBdWRpb0NvbmZpZ0ltcGwobmV3IE1pY0F1ZGlvU291cmNlKHBjbVJlY29yZGVyLCBkZXZpY2VJZCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIEF1ZGlvQ29uZmlnIG9iamVjdCByZXByZXNlbnRpbmcgdGhlIHNwZWNpZmllZCBmaWxlLlxuICAgICAqIEBtZW1iZXIgQXVkaW9Db25maWcuZnJvbVdhdkZpbGVJbnB1dFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge0ZpbGV9IGZpbGVOYW1lIC0gU3BlY2lmaWVzIHRoZSBhdWRpbyBpbnB1dCBmaWxlLiBDdXJyZW50bHksIG9ubHkgV0FWIC8gUENNIGlzIHN1cHBvcnRlZC5cbiAgICAgKiBAcmV0dXJucyB7QXVkaW9Db25maWd9IFRoZSBhdWRpbyBpbnB1dCBjb25maWd1cmF0aW9uIGJlaW5nIGNyZWF0ZWQuXG4gICAgICovXG4gICAgc3RhdGljIGZyb21XYXZGaWxlSW5wdXQoZmlsZSwgbmFtZSA9IFwidW5uYW1lZEJ1ZmZlci53YXZcIikge1xuICAgICAgICByZXR1cm4gbmV3IEF1ZGlvQ29uZmlnSW1wbChuZXcgRmlsZUF1ZGlvU291cmNlKGZpbGUsIG5hbWUpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBBdWRpb0NvbmZpZyBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBzcGVjaWZpZWQgc3RyZWFtLlxuICAgICAqIEBtZW1iZXIgQXVkaW9Db25maWcuZnJvbVN0cmVhbUlucHV0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7QXVkaW9JbnB1dFN0cmVhbSB8IFB1bGxBdWRpb0lucHV0U3RyZWFtQ2FsbGJhY2sgfCBNZWRpYVN0cmVhbX0gYXVkaW9TdHJlYW0gLSBTcGVjaWZpZXMgdGhlIGN1c3RvbSBhdWRpbyBpbnB1dFxuICAgICAqIHN0cmVhbS4gQ3VycmVudGx5LCBvbmx5IFdBViAvIFBDTSBpcyBzdXBwb3J0ZWQuXG4gICAgICogQHJldHVybnMge0F1ZGlvQ29uZmlnfSBUaGUgYXVkaW8gaW5wdXQgY29uZmlndXJhdGlvbiBiZWluZyBjcmVhdGVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tU3RyZWFtSW5wdXQoYXVkaW9TdHJlYW0pIHtcbiAgICAgICAgaWYgKGF1ZGlvU3RyZWFtIGluc3RhbmNlb2YgUHVsbEF1ZGlvSW5wdXRTdHJlYW1DYWxsYmFjaykge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb0NvbmZpZ0ltcGwobmV3IFB1bGxBdWRpb0lucHV0U3RyZWFtSW1wbChhdWRpb1N0cmVhbSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhdWRpb1N0cmVhbSBpbnN0YW5jZW9mIEF1ZGlvSW5wdXRTdHJlYW0pIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9Db25maWdJbXBsKGF1ZGlvU3RyZWFtKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIE1lZGlhU3RyZWFtICE9PSBcInVuZGVmaW5lZFwiICYmIGF1ZGlvU3RyZWFtIGluc3RhbmNlb2YgTWVkaWFTdHJlYW0pIHtcbiAgICAgICAgICAgIGNvbnN0IHBjbVJlY29yZGVyID0gbmV3IFBjbVJlY29yZGVyKGZhbHNlKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9Db25maWdJbXBsKG5ldyBNaWNBdWRpb1NvdXJjZShwY21SZWNvcmRlciwgbnVsbCwgbnVsbCwgYXVkaW9TdHJlYW0pKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOb3QgU3VwcG9ydGVkIFR5cGVcIik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gQXVkaW9Db25maWcgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgZGVmYXVsdCBzcGVha2VyLlxuICAgICAqIEBtZW1iZXIgQXVkaW9Db25maWcuZnJvbURlZmF1bHRTcGVha2VyT3V0cHV0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtBdWRpb0NvbmZpZ30gVGhlIGF1ZGlvIG91dHB1dCBjb25maWd1cmF0aW9uIGJlaW5nIGNyZWF0ZWQuXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjExLjBcbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbURlZmF1bHRTcGVha2VyT3V0cHV0KCkge1xuICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Q29uZmlnSW1wbChuZXcgU3BlYWtlckF1ZGlvRGVzdGluYXRpb24oKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gQXVkaW9Db25maWcgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgY3VzdG9tIElQbGF5ZXIgb2JqZWN0LlxuICAgICAqIFlvdSBjYW4gdXNlIHRoZSBJUGxheWVyIG9iamVjdCB0byBjb250cm9sIHBhdXNlLCByZXN1bWUsIGV0Yy5cbiAgICAgKiBAbWVtYmVyIEF1ZGlvQ29uZmlnLmZyb21TcGVha2VyT3V0cHV0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7SVBsYXllcn0gcGxheWVyIC0gdGhlIElQbGF5ZXIgb2JqZWN0IGZvciBwbGF5YmFjay5cbiAgICAgKiBAcmV0dXJucyB7QXVkaW9Db25maWd9IFRoZSBhdWRpbyBvdXRwdXQgY29uZmlndXJhdGlvbiBiZWluZyBjcmVhdGVkLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xMi4wXG4gICAgICovXG4gICAgc3RhdGljIGZyb21TcGVha2VyT3V0cHV0KHBsYXllcikge1xuICAgICAgICBpZiAocGxheWVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBBdWRpb0NvbmZpZy5mcm9tRGVmYXVsdFNwZWFrZXJPdXRwdXQoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGxheWVyIGluc3RhbmNlb2YgU3BlYWtlckF1ZGlvRGVzdGluYXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRDb25maWdJbXBsKHBsYXllcik7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm90IFN1cHBvcnRlZCBUeXBlXCIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIEF1ZGlvQ29uZmlnIG9iamVjdCByZXByZXNlbnRpbmcgYSBzcGVjaWZpZWQgb3V0cHV0IGF1ZGlvIGZpbGVcbiAgICAgKiBAbWVtYmVyIEF1ZGlvQ29uZmlnLmZyb21BdWRpb0ZpbGVPdXRwdXRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtQYXRoTGlrZX0gZmlsZW5hbWUgLSB0aGUgZmlsZW5hbWUgb2YgdGhlIG91dHB1dCBhdWRpbyBmaWxlXG4gICAgICogQHJldHVybnMge0F1ZGlvQ29uZmlnfSBUaGUgYXVkaW8gb3V0cHV0IGNvbmZpZ3VyYXRpb24gYmVpbmcgY3JlYXRlZC5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTEuMFxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tQXVkaW9GaWxlT3V0cHV0KGZpbGVuYW1lKSB7XG4gICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRDb25maWdJbXBsKG5ldyBBdWRpb0ZpbGVXcml0ZXIoZmlsZW5hbWUpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBBdWRpb0NvbmZpZyBvYmplY3QgcmVwcmVzZW50aW5nIGEgc3BlY2lmaWVkIGF1ZGlvIG91dHB1dCBzdHJlYW1cbiAgICAgKiBAbWVtYmVyIEF1ZGlvQ29uZmlnLmZyb21TdHJlYW1PdXRwdXRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtBdWRpb091dHB1dFN0cmVhbSB8IFB1c2hBdWRpb091dHB1dFN0cmVhbUNhbGxiYWNrfSBhdWRpb1N0cmVhbSAtIFNwZWNpZmllcyB0aGUgY3VzdG9tIGF1ZGlvIG91dHB1dFxuICAgICAqIHN0cmVhbS5cbiAgICAgKiBAcmV0dXJucyB7QXVkaW9Db25maWd9IFRoZSBhdWRpbyBvdXRwdXQgY29uZmlndXJhdGlvbiBiZWluZyBjcmVhdGVkLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xMS4wXG4gICAgICovXG4gICAgc3RhdGljIGZyb21TdHJlYW1PdXRwdXQoYXVkaW9TdHJlYW0pIHtcbiAgICAgICAgaWYgKGF1ZGlvU3RyZWFtIGluc3RhbmNlb2YgUHVzaEF1ZGlvT3V0cHV0U3RyZWFtQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRDb25maWdJbXBsKG5ldyBQdXNoQXVkaW9PdXRwdXRTdHJlYW1JbXBsKGF1ZGlvU3RyZWFtKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGF1ZGlvU3RyZWFtIGluc3RhbmNlb2YgUHVzaEF1ZGlvT3V0cHV0U3RyZWFtKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Q29uZmlnSW1wbChhdWRpb1N0cmVhbSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGF1ZGlvU3RyZWFtIGluc3RhbmNlb2YgUHVsbEF1ZGlvT3V0cHV0U3RyZWFtKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Q29uZmlnSW1wbChhdWRpb1N0cmVhbSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm90IFN1cHBvcnRlZCBUeXBlXCIpO1xuICAgIH1cbn1cbi8qKlxuICogUmVwcmVzZW50cyBhdWRpbyBpbnB1dCBzdHJlYW0gdXNlZCBmb3IgY3VzdG9tIGF1ZGlvIGlucHV0IGNvbmZpZ3VyYXRpb25zLlxuICogQHByaXZhdGVcbiAqIEBjbGFzcyBBdWRpb0NvbmZpZ0ltcGxcbiAqL1xuZXhwb3J0IGNsYXNzIEF1ZGlvQ29uZmlnSW1wbCBleHRlbmRzIEF1ZGlvQ29uZmlnIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7SUF1ZGlvU291cmNlfSBzb3VyY2UgLSBBbiBhdWRpbyBzb3VyY2UuXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc291cmNlKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMucHJpdlNvdXJjZSA9IHNvdXJjZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRm9ybWF0IGluZm9ybWF0aW9uIGZvciB0aGUgYXVkaW9cbiAgICAgKi9cbiAgICBnZXQgZm9ybWF0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U291cmNlLmZvcm1hdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQG1lbWJlciBBdWRpb0NvbmZpZ0ltcGwucHJvdG90eXBlLmNsb3NlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGNsb3NlKGNiLCBlcnIpIHtcbiAgICAgICAgdGhpcy5wcml2U291cmNlLnR1cm5PZmYoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGlmICghIWNiKSB7XG4gICAgICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBpZiAoISFlcnIpIHtcbiAgICAgICAgICAgICAgICBlcnIoZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQG1lbWJlciBBdWRpb0NvbmZpZ0ltcGwucHJvdG90eXBlLmlkXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U291cmNlLmlkKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBtZW1iZXIgQXVkaW9Db25maWdJbXBsLnByb3RvdHlwZS50dXJuT25cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1Byb21pc2U8dm9pZD59IEEgcHJvbWlzZS5cbiAgICAgKi9cbiAgICB0dXJuT24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTb3VyY2UudHVybk9uKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBtZW1iZXIgQXVkaW9Db25maWdJbXBsLnByb3RvdHlwZS5hdHRhY2hcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGF1ZGlvTm9kZUlkIC0gVGhlIGF1ZGlvIG5vZGUgaWQuXG4gICAgICogQHJldHVybnMge1Byb21pc2U8SUF1ZGlvU3RyZWFtTm9kZT59IEEgcHJvbWlzZS5cbiAgICAgKi9cbiAgICBhdHRhY2goYXVkaW9Ob2RlSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNvdXJjZS5hdHRhY2goYXVkaW9Ob2RlSWQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAbWVtYmVyIEF1ZGlvQ29uZmlnSW1wbC5wcm90b3R5cGUuZGV0YWNoXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhdWRpb05vZGVJZCAtIFRoZSBhdWRpbyBub2RlIGlkLlxuICAgICAqL1xuICAgIGRldGFjaChhdWRpb05vZGVJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U291cmNlLmRldGFjaChhdWRpb05vZGVJZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBtZW1iZXIgQXVkaW9Db25maWdJbXBsLnByb3RvdHlwZS50dXJuT2ZmXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPHZvaWQ+fSBBIHByb21pc2UuXG4gICAgICovXG4gICAgdHVybk9mZigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNvdXJjZS50dXJuT2ZmKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBtZW1iZXIgQXVkaW9Db25maWdJbXBsLnByb3RvdHlwZS5ldmVudHNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge0V2ZW50U291cmNlPEF1ZGlvU291cmNlRXZlbnQ+fSBBbiBldmVudCBzb3VyY2UgZm9yIGF1ZGlvIGV2ZW50cy5cbiAgICAgKi9cbiAgICBnZXQgZXZlbnRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U291cmNlLmV2ZW50cztcbiAgICB9XG4gICAgc2V0UHJvcGVydHkobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsKHZhbHVlLCBcInZhbHVlXCIpO1xuICAgICAgICBpZiAodW5kZWZpbmVkICE9PSB0aGlzLnByaXZTb3VyY2Uuc2V0UHJvcGVydHkpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlNvdXJjZS5zZXRQcm9wZXJ0eShuYW1lLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGlzIEF1ZGlvQ29uZmlnIGluc3RhbmNlIGRvZXMgbm90IHN1cHBvcnQgc2V0dGluZyBwcm9wZXJ0aWVzLlwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRQcm9wZXJ0eShuYW1lLCBkZWYpIHtcbiAgICAgICAgaWYgKHVuZGVmaW5lZCAhPT0gdGhpcy5wcml2U291cmNlLmdldFByb3BlcnR5KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2U291cmNlLmdldFByb3BlcnR5KG5hbWUsIGRlZik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGlzIEF1ZGlvQ29uZmlnIGluc3RhbmNlIGRvZXMgbm90IHN1cHBvcnQgZ2V0dGluZyBwcm9wZXJ0aWVzLlwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGVmO1xuICAgIH1cbiAgICBnZXQgZGV2aWNlSW5mbygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNvdXJjZS5kZXZpY2VJbmZvO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBBdWRpb091dHB1dENvbmZpZ0ltcGwgZXh0ZW5kcyBBdWRpb0NvbmZpZyB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge0lBdWRpb0Rlc3RpbmF0aW9ufSBkZXN0aW5hdGlvbiAtIEFuIGF1ZGlvIGRlc3RpbmF0aW9uLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGRlc3RpbmF0aW9uKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMucHJpdkRlc3RpbmF0aW9uID0gZGVzdGluYXRpb247XG4gICAgfVxuICAgIHNldCBmb3JtYXQoZm9ybWF0KSB7XG4gICAgICAgIHRoaXMucHJpdkRlc3RpbmF0aW9uLmZvcm1hdCA9IGZvcm1hdDtcbiAgICB9XG4gICAgd3JpdGUoYnVmZmVyKSB7XG4gICAgICAgIHRoaXMucHJpdkRlc3RpbmF0aW9uLndyaXRlKGJ1ZmZlcik7XG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgICB0aGlzLnByaXZEZXN0aW5hdGlvbi5jbG9zZSgpO1xuICAgIH1cbiAgICBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkRlc3RpbmF0aW9uLmlkKCk7XG4gICAgfVxuICAgIHNldFByb3BlcnR5KCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGlzIEF1ZGlvQ29uZmlnIGluc3RhbmNlIGRvZXMgbm90IHN1cHBvcnQgc2V0dGluZyBwcm9wZXJ0aWVzLlwiKTtcbiAgICB9XG4gICAgZ2V0UHJvcGVydHkoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoaXMgQXVkaW9Db25maWcgaW5zdGFuY2UgZG9lcyBub3Qgc3VwcG9ydCBnZXR0aW5nIHByb3BlcnRpZXMuXCIpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QXVkaW9Db25maWcuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCAqIGFzIGZzIGZyb20gXCJmc1wiO1xuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4uL0NvbnRyYWN0c1wiO1xuZXhwb3J0IGNsYXNzIEF1ZGlvRmlsZVdyaXRlciB7XG4gICAgY29uc3RydWN0b3IoZmlsZW5hbWUpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQoZnMub3BlblN5bmMsIFwiXFxuRmlsZSBTeXN0ZW0gYWNjZXNzIG5vdCBhdmFpbGFibGUsIHBsZWFzZSB1c2UgUHVzaCBvciBQdWxsQXVkaW9PdXRwdXRTdHJlYW1cIik7XG4gICAgICAgIHRoaXMucHJpdkZkID0gZnMub3BlblN5bmMoZmlsZW5hbWUsIFwid1wiKTtcbiAgICB9XG4gICAgc2V0IGZvcm1hdChmb3JtYXQpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOb3RVbmRlZmluZWQodGhpcy5wcml2QXVkaW9Gb3JtYXQsIFwiZm9ybWF0IGlzIGFscmVhZHkgc2V0XCIpO1xuICAgICAgICB0aGlzLnByaXZBdWRpb0Zvcm1hdCA9IGZvcm1hdDtcbiAgICAgICAgbGV0IGhlYWRlck9mZnNldCA9IDA7XG4gICAgICAgIGlmICh0aGlzLnByaXZBdWRpb0Zvcm1hdC5oYXNIZWFkZXIpIHtcbiAgICAgICAgICAgIGhlYWRlck9mZnNldCA9IHRoaXMucHJpdkF1ZGlvRm9ybWF0LmhlYWRlci5ieXRlTGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnByaXZGZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZXcml0ZVN0cmVhbSA9IGZzLmNyZWF0ZVdyaXRlU3RyZWFtKFwiXCIsIHsgZmQ6IHRoaXMucHJpdkZkLCBzdGFydDogaGVhZGVyT2Zmc2V0LCBhdXRvQ2xvc2U6IGZhbHNlIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHdyaXRlKGJ1ZmZlcikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZCh0aGlzLnByaXZBdWRpb0Zvcm1hdCwgXCJtdXN0IHNldCBmb3JtYXQgYmVmb3JlIHdyaXRpbmcuXCIpO1xuICAgICAgICBpZiAodGhpcy5wcml2V3JpdGVTdHJlYW0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5wcml2V3JpdGVTdHJlYW0ud3JpdGUobmV3IFVpbnQ4QXJyYXkoYnVmZmVyLnNsaWNlKDApKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZGZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZXcml0ZVN0cmVhbS5vbihcImZpbmlzaFwiLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdkF1ZGlvRm9ybWF0Lmhhc0hlYWRlcikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZBdWRpb0Zvcm1hdC51cGRhdGVIZWFkZXIodGhpcy5wcml2V3JpdGVTdHJlYW0uYnl0ZXNXcml0dGVuKTtcbiAgICAgICAgICAgICAgICAgICAgZnMud3JpdGVTeW5jKHRoaXMucHJpdkZkLCBuZXcgSW50OEFycmF5KHRoaXMucHJpdkF1ZGlvRm9ybWF0LmhlYWRlciksIDAsIHRoaXMucHJpdkF1ZGlvRm9ybWF0LmhlYWRlci5ieXRlTGVuZ3RoLCAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZnMuY2xvc2VTeW5jKHRoaXMucHJpdkZkKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZGZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5wcml2V3JpdGVTdHJlYW0uZW5kKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJZDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUF1ZGlvRmlsZVdyaXRlci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG4vKiBlc2xpbnQtZGlzYWJsZSBtYXgtY2xhc3Nlcy1wZXItZmlsZSAqL1xuaW1wb3J0IHsgY29ubmVjdGl2aXR5LCB0eXBlLCB9IGZyb20gXCIuLi8uLi9jb21tb24uc3BlZWNoL0V4cG9ydHNcIjtcbmltcG9ydCB7IEF1ZGlvU291cmNlSW5pdGlhbGl6aW5nRXZlbnQsIEF1ZGlvU291cmNlUmVhZHlFdmVudCwgQXVkaW9TdHJlYW1Ob2RlQXR0YWNoZWRFdmVudCwgQXVkaW9TdHJlYW1Ob2RlQXR0YWNoaW5nRXZlbnQsIEF1ZGlvU3RyZWFtTm9kZURldGFjaGVkRXZlbnQsIENodW5rZWRBcnJheUJ1ZmZlclN0cmVhbSwgRXZlbnRzLCBFdmVudFNvdXJjZSwgfSBmcm9tIFwiLi4vLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IGNyZWF0ZU5vRGFzaEd1aWQgfSBmcm9tIFwiLi4vLi4vY29tbW9uL0d1aWRcIjtcbmltcG9ydCB7IEF1ZGlvU3RyZWFtRm9ybWF0IH0gZnJvbSBcIi4uL0V4cG9ydHNcIjtcbmltcG9ydCB7IEF1ZGlvU3RyZWFtRm9ybWF0SW1wbCB9IGZyb20gXCIuL0F1ZGlvU3RyZWFtRm9ybWF0XCI7XG4vKipcbiAqIFJlcHJlc2VudHMgYXVkaW8gaW5wdXQgc3RyZWFtIHVzZWQgZm9yIGN1c3RvbSBhdWRpbyBpbnB1dCBjb25maWd1cmF0aW9ucy5cbiAqIEBjbGFzcyBBdWRpb0lucHV0U3RyZWFtXG4gKi9cbmV4cG9ydCBjbGFzcyBBdWRpb0lucHV0U3RyZWFtIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZS5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbWVtb3J5IGJhY2tlZCBQdXNoQXVkaW9JbnB1dFN0cmVhbSB3aXRoIHRoZSBzcGVjaWZpZWQgYXVkaW8gZm9ybWF0LlxuICAgICAqIEBtZW1iZXIgQXVkaW9JbnB1dFN0cmVhbS5jcmVhdGVQdXNoU3RyZWFtXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7QXVkaW9TdHJlYW1Gb3JtYXR9IGZvcm1hdCAtIFRoZSBhdWRpbyBkYXRhIGZvcm1hdCBpbiB3aGljaCBhdWRpbyB3aWxsIGJlXG4gICAgICogd3JpdHRlbiB0byB0aGUgcHVzaCBhdWRpbyBzdHJlYW0ncyB3cml0ZSgpIG1ldGhvZCAoUmVxdWlyZWQgaWYgZm9ybWF0IGlzIG5vdCAxNiBrSHogMTZiaXQgbW9ubyBQQ00pLlxuICAgICAqIEByZXR1cm5zIHtQdXNoQXVkaW9JbnB1dFN0cmVhbX0gVGhlIGF1ZGlvIGlucHV0IHN0cmVhbSBiZWluZyBjcmVhdGVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVhdGVQdXNoU3RyZWFtKGZvcm1hdCkge1xuICAgICAgICByZXR1cm4gUHVzaEF1ZGlvSW5wdXRTdHJlYW0uY3JlYXRlKGZvcm1hdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBQdWxsQXVkaW9JbnB1dFN0cmVhbSB0aGF0IGRlbGVnYXRlcyB0byB0aGUgc3BlY2lmaWVkIGNhbGxiYWNrIGludGVyZmFjZSBmb3IgcmVhZCgpXG4gICAgICogYW5kIGNsb3NlKCkgbWV0aG9kcy5cbiAgICAgKiBAbWVtYmVyIEF1ZGlvSW5wdXRTdHJlYW0uY3JlYXRlUHVsbFN0cmVhbVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge1B1bGxBdWRpb0lucHV0U3RyZWFtQ2FsbGJhY2t9IGNhbGxiYWNrIC0gVGhlIGN1c3RvbSBhdWRpbyBpbnB1dCBvYmplY3QsIGRlcml2ZWQgZnJvbVxuICAgICAqIFB1bGxBdWRpb0lucHV0U3RyZWFtQ2FsbGJhY2tcbiAgICAgKiBAcGFyYW0ge0F1ZGlvU3RyZWFtRm9ybWF0fSBmb3JtYXQgLSBUaGUgYXVkaW8gZGF0YSBmb3JtYXQgaW4gd2hpY2ggYXVkaW8gd2lsbCBiZSByZXR1cm5lZCBmcm9tXG4gICAgICogdGhlIGNhbGxiYWNrJ3MgcmVhZCgpIG1ldGhvZCAoUmVxdWlyZWQgaWYgZm9ybWF0IGlzIG5vdCAxNiBrSHogMTZiaXQgbW9ubyBQQ00pLlxuICAgICAqIEByZXR1cm5zIHtQdWxsQXVkaW9JbnB1dFN0cmVhbX0gVGhlIGF1ZGlvIGlucHV0IHN0cmVhbSBiZWluZyBjcmVhdGVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVhdGVQdWxsU3RyZWFtKGNhbGxiYWNrLCBmb3JtYXQpIHtcbiAgICAgICAgcmV0dXJuIFB1bGxBdWRpb0lucHV0U3RyZWFtLmNyZWF0ZShjYWxsYmFjaywgZm9ybWF0KTtcbiAgICAgICAgLy8gdGhyb3cgbmV3IEVycm9yKFwiT29wc1wiKTtcbiAgICB9XG59XG4vKipcbiAqIFJlcHJlc2VudHMgbWVtb3J5IGJhY2tlZCBwdXNoIGF1ZGlvIGlucHV0IHN0cmVhbSB1c2VkIGZvciBjdXN0b20gYXVkaW8gaW5wdXQgY29uZmlndXJhdGlvbnMuXG4gKiBAY2xhc3MgUHVzaEF1ZGlvSW5wdXRTdHJlYW1cbiAqL1xuZXhwb3J0IGNsYXNzIFB1c2hBdWRpb0lucHV0U3RyZWFtIGV4dGVuZHMgQXVkaW9JbnB1dFN0cmVhbSB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG1lbW9yeSBiYWNrZWQgUHVzaEF1ZGlvSW5wdXRTdHJlYW0gd2l0aCB0aGUgc3BlY2lmaWVkIGF1ZGlvIGZvcm1hdC5cbiAgICAgKiBAbWVtYmVyIFB1c2hBdWRpb0lucHV0U3RyZWFtLmNyZWF0ZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge0F1ZGlvU3RyZWFtRm9ybWF0fSBmb3JtYXQgLSBUaGUgYXVkaW8gZGF0YSBmb3JtYXQgaW4gd2hpY2ggYXVkaW8gd2lsbCBiZSB3cml0dGVuIHRvIHRoZVxuICAgICAqIHB1c2ggYXVkaW8gc3RyZWFtJ3Mgd3JpdGUoKSBtZXRob2QgKFJlcXVpcmVkIGlmIGZvcm1hdCBpcyBub3QgMTYga0h6IDE2Yml0IG1vbm8gUENNKS5cbiAgICAgKiBAcmV0dXJucyB7UHVzaEF1ZGlvSW5wdXRTdHJlYW19IFRoZSBwdXNoIGF1ZGlvIGlucHV0IHN0cmVhbSBiZWluZyBjcmVhdGVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVhdGUoZm9ybWF0KSB7XG4gICAgICAgIHJldHVybiBuZXcgUHVzaEF1ZGlvSW5wdXRTdHJlYW1JbXBsKGZvcm1hdCk7XG4gICAgfVxufVxuLyoqXG4gKiBSZXByZXNlbnRzIG1lbW9yeSBiYWNrZWQgcHVzaCBhdWRpbyBpbnB1dCBzdHJlYW0gdXNlZCBmb3IgY3VzdG9tIGF1ZGlvIGlucHV0IGNvbmZpZ3VyYXRpb25zLlxuICogQHByaXZhdGVcbiAqIEBjbGFzcyBQdXNoQXVkaW9JbnB1dFN0cmVhbUltcGxcbiAqL1xuZXhwb3J0IGNsYXNzIFB1c2hBdWRpb0lucHV0U3RyZWFtSW1wbCBleHRlbmRzIFB1c2hBdWRpb0lucHV0U3RyZWFtIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0YWxpemVzIGFuIGluc3RhbmNlIHdpdGggdGhlIGdpdmVuIHZhbHVlcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge0F1ZGlvU3RyZWFtRm9ybWF0fSBmb3JtYXQgLSBUaGUgYXVkaW8gc3RyZWFtIGZvcm1hdC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcihmb3JtYXQpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgaWYgKGZvcm1hdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZGb3JtYXQgPSBBdWRpb1N0cmVhbUZvcm1hdEltcGwuZ2V0RGVmYXVsdElucHV0Rm9ybWF0KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnByaXZGb3JtYXQgPSBmb3JtYXQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2RXZlbnRzID0gbmV3IEV2ZW50U291cmNlKCk7XG4gICAgICAgIHRoaXMucHJpdklkID0gY3JlYXRlTm9EYXNoR3VpZCgpO1xuICAgICAgICB0aGlzLnByaXZTdHJlYW0gPSBuZXcgQ2h1bmtlZEFycmF5QnVmZmVyU3RyZWFtKHRoaXMucHJpdkZvcm1hdC5hdmdCeXRlc1BlclNlYyAvIDEwKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRm9ybWF0IGluZm9ybWF0aW9uIGZvciB0aGUgYXVkaW9cbiAgICAgKi9cbiAgICBnZXQgZm9ybWF0KCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMucHJpdkZvcm1hdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFdyaXRlcyB0aGUgYXVkaW8gZGF0YSBzcGVjaWZpZWQgYnkgbWFraW5nIGFuIGludGVybmFsIGNvcHkgb2YgdGhlIGRhdGEuXG4gICAgICogQG1lbWJlciBQdXNoQXVkaW9JbnB1dFN0cmVhbUltcGwucHJvdG90eXBlLndyaXRlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7QXJyYXlCdWZmZXJ9IGRhdGFCdWZmZXIgLSBUaGUgYXVkaW8gYnVmZmVyIG9mIHdoaWNoIHRoaXMgZnVuY3Rpb24gd2lsbCBtYWtlIGEgY29weS5cbiAgICAgKi9cbiAgICB3cml0ZShkYXRhQnVmZmVyKSB7XG4gICAgICAgIHRoaXMucHJpdlN0cmVhbS53cml0ZVN0cmVhbUNodW5rKHtcbiAgICAgICAgICAgIGJ1ZmZlcjogZGF0YUJ1ZmZlcixcbiAgICAgICAgICAgIGlzRW5kOiBmYWxzZSxcbiAgICAgICAgICAgIHRpbWVSZWNlaXZlZDogRGF0ZS5ub3coKVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xvc2VzIHRoZSBzdHJlYW0uXG4gICAgICogQG1lbWJlciBQdXNoQXVkaW9JbnB1dFN0cmVhbUltcGwucHJvdG90eXBlLmNsb3NlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGNsb3NlKCkge1xuICAgICAgICB0aGlzLnByaXZTdHJlYW0uY2xvc2UoKTtcbiAgICB9XG4gICAgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJZDtcbiAgICB9XG4gICAgdHVybk9uKCkge1xuICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU291cmNlSW5pdGlhbGl6aW5nRXZlbnQodGhpcy5wcml2SWQpKTsgLy8gbm8gc3RyZWFtIGlkXG4gICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9Tb3VyY2VSZWFkeUV2ZW50KHRoaXMucHJpdklkKSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgYXR0YWNoKGF1ZGlvTm9kZUlkKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU3RyZWFtTm9kZUF0dGFjaGluZ0V2ZW50KHRoaXMucHJpdklkLCBhdWRpb05vZGVJZCkpO1xuICAgICAgICAgICAgeWllbGQgdGhpcy50dXJuT24oKTtcbiAgICAgICAgICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMucHJpdlN0cmVhbTtcbiAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9TdHJlYW1Ob2RlQXR0YWNoZWRFdmVudCh0aGlzLnByaXZJZCwgYXVkaW9Ob2RlSWQpKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZGV0YWNoOiAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9TdHJlYW1Ob2RlRGV0YWNoZWRFdmVudCh0aGlzLnByaXZJZCwgYXVkaW9Ob2RlSWQpKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudHVybk9mZigpO1xuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGlkOiAoKSA9PiBhdWRpb05vZGVJZCxcbiAgICAgICAgICAgICAgICByZWFkOiAoKSA9PiBzdHJlYW0ucmVhZCgpLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGRldGFjaChhdWRpb05vZGVJZCkge1xuICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU3RyZWFtTm9kZURldGFjaGVkRXZlbnQodGhpcy5wcml2SWQsIGF1ZGlvTm9kZUlkKSk7XG4gICAgfVxuICAgIHR1cm5PZmYoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZ2V0IGV2ZW50cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkV2ZW50cztcbiAgICB9XG4gICAgZ2V0IGRldmljZUluZm8oKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgYml0c3BlcnNhbXBsZTogdGhpcy5wcml2Rm9ybWF0LmJpdHNQZXJTYW1wbGUsXG4gICAgICAgICAgICBjaGFubmVsY291bnQ6IHRoaXMucHJpdkZvcm1hdC5jaGFubmVscyxcbiAgICAgICAgICAgIGNvbm5lY3Rpdml0eTogY29ubmVjdGl2aXR5LlVua25vd24sXG4gICAgICAgICAgICBtYW51ZmFjdHVyZXI6IFwiU3BlZWNoIFNES1wiLFxuICAgICAgICAgICAgbW9kZWw6IFwiUHVzaFN0cmVhbVwiLFxuICAgICAgICAgICAgc2FtcGxlcmF0ZTogdGhpcy5wcml2Rm9ybWF0LnNhbXBsZXNQZXJTZWMsXG4gICAgICAgICAgICB0eXBlOiB0eXBlLlN0cmVhbSxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIG9uRXZlbnQoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5wcml2RXZlbnRzLm9uRXZlbnQoZXZlbnQpO1xuICAgICAgICBFdmVudHMuaW5zdGFuY2Uub25FdmVudChldmVudCk7XG4gICAgfVxuICAgIHRvQnVmZmVyKGFycmF5QnVmZmVyKSB7XG4gICAgICAgIGNvbnN0IGJ1ZiA9IEJ1ZmZlci5hbGxvYyhhcnJheUJ1ZmZlci5ieXRlTGVuZ3RoKTtcbiAgICAgICAgY29uc3QgdmlldyA9IG5ldyBVaW50OEFycmF5KGFycmF5QnVmZmVyKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBidWYubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIGJ1ZltpXSA9IHZpZXdbaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJ1ZjtcbiAgICB9XG59XG4vKlxuICogUmVwcmVzZW50cyBhdWRpbyBpbnB1dCBzdHJlYW0gdXNlZCBmb3IgY3VzdG9tIGF1ZGlvIGlucHV0IGNvbmZpZ3VyYXRpb25zLlxuICogQGNsYXNzIFB1bGxBdWRpb0lucHV0U3RyZWFtXG4gKi9cbmV4cG9ydCBjbGFzcyBQdWxsQXVkaW9JbnB1dFN0cmVhbSBleHRlbmRzIEF1ZGlvSW5wdXRTdHJlYW0ge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuZCBpbnN0YW5jZS5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIFB1bGxBdWRpb0lucHV0U3RyZWFtIHRoYXQgZGVsZWdhdGVzIHRvIHRoZSBzcGVjaWZpZWQgY2FsbGJhY2sgaW50ZXJmYWNlIGZvclxuICAgICAqIHJlYWQoKSBhbmQgY2xvc2UoKSBtZXRob2RzLCB1c2luZyB0aGUgZGVmYXVsdCBmb3JtYXQgKDE2IGtIeiAxNmJpdCBtb25vIFBDTSkuXG4gICAgICogQG1lbWJlciBQdWxsQXVkaW9JbnB1dFN0cmVhbS5jcmVhdGVcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtQdWxsQXVkaW9JbnB1dFN0cmVhbUNhbGxiYWNrfSBjYWxsYmFjayAtIFRoZSBjdXN0b20gYXVkaW8gaW5wdXQgb2JqZWN0LFxuICAgICAqIGRlcml2ZWQgZnJvbSBQdWxsQXVkaW9JbnB1dFN0cmVhbUN1c3RvbUNhbGxiYWNrXG4gICAgICogQHBhcmFtIHtBdWRpb1N0cmVhbUZvcm1hdH0gZm9ybWF0IC0gVGhlIGF1ZGlvIGRhdGEgZm9ybWF0IGluIHdoaWNoIGF1ZGlvIHdpbGwgYmVcbiAgICAgKiByZXR1cm5lZCBmcm9tIHRoZSBjYWxsYmFjaydzIHJlYWQoKSBtZXRob2QgKFJlcXVpcmVkIGlmIGZvcm1hdCBpcyBub3QgMTYga0h6IDE2Yml0IG1vbm8gUENNKS5cbiAgICAgKiBAcmV0dXJucyB7UHVsbEF1ZGlvSW5wdXRTdHJlYW19IFRoZSBwdXNoIGF1ZGlvIGlucHV0IHN0cmVhbSBiZWluZyBjcmVhdGVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVhdGUoY2FsbGJhY2ssIGZvcm1hdCkge1xuICAgICAgICByZXR1cm4gbmV3IFB1bGxBdWRpb0lucHV0U3RyZWFtSW1wbChjYWxsYmFjaywgZm9ybWF0KTtcbiAgICB9XG59XG4vKipcbiAqIFJlcHJlc2VudHMgYXVkaW8gaW5wdXQgc3RyZWFtIHVzZWQgZm9yIGN1c3RvbSBhdWRpbyBpbnB1dCBjb25maWd1cmF0aW9ucy5cbiAqIEBwcml2YXRlXG4gKiBAY2xhc3MgUHVsbEF1ZGlvSW5wdXRTdHJlYW1JbXBsXG4gKi9cbmV4cG9ydCBjbGFzcyBQdWxsQXVkaW9JbnB1dFN0cmVhbUltcGwgZXh0ZW5kcyBQdWxsQXVkaW9JbnB1dFN0cmVhbSB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIFB1bGxBdWRpb0lucHV0U3RyZWFtIHRoYXQgZGVsZWdhdGVzIHRvIHRoZSBzcGVjaWZpZWQgY2FsbGJhY2sgaW50ZXJmYWNlIGZvclxuICAgICAqIHJlYWQoKSBhbmQgY2xvc2UoKSBtZXRob2RzLCB1c2luZyB0aGUgZGVmYXVsdCBmb3JtYXQgKDE2IGtIeiAxNmJpdCBtb25vIFBDTSkuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtQdWxsQXVkaW9JbnB1dFN0cmVhbUNhbGxiYWNrfSBjYWxsYmFjayAtIFRoZSBjdXN0b20gYXVkaW8gaW5wdXQgb2JqZWN0LFxuICAgICAqIGRlcml2ZWQgZnJvbSBQdWxsQXVkaW9JbnB1dFN0cmVhbUN1c3RvbUNhbGxiYWNrXG4gICAgICogQHBhcmFtIHtBdWRpb1N0cmVhbUZvcm1hdH0gZm9ybWF0IC0gVGhlIGF1ZGlvIGRhdGEgZm9ybWF0IGluIHdoaWNoIGF1ZGlvIHdpbGwgYmVcbiAgICAgKiByZXR1cm5lZCBmcm9tIHRoZSBjYWxsYmFjaydzIHJlYWQoKSBtZXRob2QgKFJlcXVpcmVkIGlmIGZvcm1hdCBpcyBub3QgMTYga0h6IDE2Yml0IG1vbm8gUENNKS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihjYWxsYmFjaywgZm9ybWF0KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIGlmICh1bmRlZmluZWQgPT09IGZvcm1hdCkge1xuICAgICAgICAgICAgdGhpcy5wcml2Rm9ybWF0ID0gQXVkaW9TdHJlYW1Gb3JtYXQuZ2V0RGVmYXVsdElucHV0Rm9ybWF0KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnByaXZGb3JtYXQgPSBmb3JtYXQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2RXZlbnRzID0gbmV3IEV2ZW50U291cmNlKCk7XG4gICAgICAgIHRoaXMucHJpdklkID0gY3JlYXRlTm9EYXNoR3VpZCgpO1xuICAgICAgICB0aGlzLnByaXZDYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgICAgICB0aGlzLnByaXZJc0Nsb3NlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZCdWZmZXJTaXplID0gdGhpcy5wcml2Rm9ybWF0LmF2Z0J5dGVzUGVyU2VjIC8gMTA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvcm1hdCBpbmZvcm1hdGlvbiBmb3IgdGhlIGF1ZGlvXG4gICAgICovXG4gICAgZ2V0IGZvcm1hdCgpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLnByaXZGb3JtYXQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbG9zZXMgdGhlIHN0cmVhbS5cbiAgICAgKiBAbWVtYmVyIFB1bGxBdWRpb0lucHV0U3RyZWFtSW1wbC5wcm90b3R5cGUuY2xvc2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMucHJpdklzQ2xvc2VkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5wcml2Q2FsbGJhY2suY2xvc2UoKTtcbiAgICB9XG4gICAgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJZDtcbiAgICB9XG4gICAgdHVybk9uKCkge1xuICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU291cmNlSW5pdGlhbGl6aW5nRXZlbnQodGhpcy5wcml2SWQpKTsgLy8gbm8gc3RyZWFtIGlkXG4gICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9Tb3VyY2VSZWFkeUV2ZW50KHRoaXMucHJpdklkKSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgYXR0YWNoKGF1ZGlvTm9kZUlkKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU3RyZWFtTm9kZUF0dGFjaGluZ0V2ZW50KHRoaXMucHJpdklkLCBhdWRpb05vZGVJZCkpO1xuICAgICAgICAgICAgeWllbGQgdGhpcy50dXJuT24oKTtcbiAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9TdHJlYW1Ob2RlQXR0YWNoZWRFdmVudCh0aGlzLnByaXZJZCwgYXVkaW9Ob2RlSWQpKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZGV0YWNoOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNhbGxiYWNrLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9TdHJlYW1Ob2RlRGV0YWNoZWRFdmVudCh0aGlzLnByaXZJZCwgYXVkaW9Ob2RlSWQpKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudHVybk9mZigpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgaWQ6ICgpID0+IGF1ZGlvTm9kZUlkLFxuICAgICAgICAgICAgICAgIHJlYWQ6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHRvdGFsQnl0ZXMgPSAwO1xuICAgICAgICAgICAgICAgICAgICBsZXQgdHJhbnNtaXRCdWZmO1xuICAgICAgICAgICAgICAgICAgICAvLyBVbnRpbCB3ZSBoYXZlIHRoZSBtaW5pbXVtIG51bWJlciBvZiBieXRlcyB0byBzZW5kIGluIGEgdHJhbnNtaXNzaW9uLCBrZWVwIGFza2luZyBmb3IgbW9yZS5cbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHRvdGFsQnl0ZXMgPCB0aGlzLnByaXZCdWZmZXJTaXplKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTaXppbmcgdGhlIHJlYWQgYnVmZmVyIHRvIHRoZSBkZWx0YSBiZXR3ZWVuIHRoZSBwZXJmZWN0IHNpemUgYW5kIHdoYXQncyBsZWZ0IG1lYW5zIHdlIHdvbid0IGV2ZXIgZ2V0IHRvbyBtdWNoXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBkYXRhIGJhY2suXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZWFkQnVmZiA9IG5ldyBBcnJheUJ1ZmZlcih0aGlzLnByaXZCdWZmZXJTaXplIC0gdG90YWxCeXRlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwdWxsZWRCeXRlcyA9IHRoaXMucHJpdkNhbGxiYWNrLnJlYWQocmVhZEJ1ZmYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlcmUgaXMgbm8gcmV0dXJuIGJ1ZmZlciB5ZXQgZGVmaW5lZCwgc2V0IHRoZSByZXR1cm4gYnVmZmVyIHRvIHRoZSB0aGF0IHdhcyBqdXN0IHBvcHVsYXRlZC5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgd2FzLCBpZiB3ZSBoYXZlIGVub3VnaCBkYXRhIHRoZXJlJ3Mgbm8gY29weSBwZW5hbHR5LCBidXQgaWYgd2UgZG9uJ3Qgd2UgaGF2ZSBhIGJ1ZmZlciB0aGF0J3MgdGhlXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwcmVmZXJyZWQgc2l6ZSBhbGxvY2F0ZWQuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodW5kZWZpbmVkID09PSB0cmFuc21pdEJ1ZmYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc21pdEJ1ZmYgPSByZWFkQnVmZjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdCB0aGUgZmlyc3QgYml0ZSBhdCB0aGUgYXBwbGUsIHNvIGZpbGwgdGhlIHJldHVybiBidWZmZXIgd2l0aCB0aGUgZGF0YSB3ZSBnb3QgYmFjay5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpbnRWaWV3ID0gbmV3IEludDhBcnJheSh0cmFuc21pdEJ1ZmYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludFZpZXcuc2V0KG5ldyBJbnQ4QXJyYXkocmVhZEJ1ZmYpLCB0b3RhbEJ5dGVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZXJlIGFyZSBubyBieXRlcyB0byByZWFkLCBqdXN0IGJyZWFrIG91dCBhbmQgYmUgZG9uZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgwID09PSBwdWxsZWRCeXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxCeXRlcyArPSBwdWxsZWRCeXRlcztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1ZmZlcjogdHJhbnNtaXRCdWZmLnNsaWNlKDAsIHRvdGFsQnl0ZXMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXNFbmQ6IHRoaXMucHJpdklzQ2xvc2VkIHx8IHRvdGFsQnl0ZXMgPT09IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lUmVjZWl2ZWQ6IERhdGUubm93KCksXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZGV0YWNoKGF1ZGlvTm9kZUlkKSB7XG4gICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9TdHJlYW1Ob2RlRGV0YWNoZWRFdmVudCh0aGlzLnByaXZJZCwgYXVkaW9Ob2RlSWQpKTtcbiAgICB9XG4gICAgdHVybk9mZigpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBnZXQgZXZlbnRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXZlbnRzO1xuICAgIH1cbiAgICBnZXQgZGV2aWNlSW5mbygpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBiaXRzcGVyc2FtcGxlOiB0aGlzLnByaXZGb3JtYXQuYml0c1BlclNhbXBsZSxcbiAgICAgICAgICAgIGNoYW5uZWxjb3VudDogdGhpcy5wcml2Rm9ybWF0LmNoYW5uZWxzLFxuICAgICAgICAgICAgY29ubmVjdGl2aXR5OiBjb25uZWN0aXZpdHkuVW5rbm93bixcbiAgICAgICAgICAgIG1hbnVmYWN0dXJlcjogXCJTcGVlY2ggU0RLXCIsXG4gICAgICAgICAgICBtb2RlbDogXCJQdWxsU3RyZWFtXCIsXG4gICAgICAgICAgICBzYW1wbGVyYXRlOiB0aGlzLnByaXZGb3JtYXQuc2FtcGxlc1BlclNlYyxcbiAgICAgICAgICAgIHR5cGU6IHR5cGUuU3RyZWFtLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgb25FdmVudChldmVudCkge1xuICAgICAgICB0aGlzLnByaXZFdmVudHMub25FdmVudChldmVudCk7XG4gICAgICAgIEV2ZW50cy5pbnN0YW5jZS5vbkV2ZW50KGV2ZW50KTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUF1ZGlvSW5wdXRTdHJlYW0uanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdCB9IGZyb20gXCIuLi9TcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRcIjtcbmltcG9ydCB7IEF1ZGlvRm9ybWF0VGFnLCBBdWRpb1N0cmVhbUZvcm1hdEltcGwgfSBmcm9tIFwiLi9BdWRpb1N0cmVhbUZvcm1hdFwiO1xuLyoqXG4gKiBAcHJpdmF0ZVxuICogQGNsYXNzIEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbFxuICogVXBkYXRlZCBpbiB2ZXJzaW9uIDEuMTcuMFxuICovXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWNsYXNzZXMtcGVyLWZpbGVcbmV4cG9ydCBjbGFzcyBBdWRpb091dHB1dEZvcm1hdEltcGwgZXh0ZW5kcyBBdWRpb1N0cmVhbUZvcm1hdEltcGwge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugd2l0aCB0aGUgZ2l2ZW4gdmFsdWVzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSBmb3JtYXRUYWdcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gY2hhbm5lbHMgLSBOdW1iZXIgb2YgY2hhbm5lbHMuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHNhbXBsZXNQZXJTZWMgLSBTYW1wbGVzIHBlciBzZWNvbmQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGF2Z0J5dGVzUGVyU2VjIC0gQXZlcmFnZSBieXRlcyBwZXIgc2Vjb25kLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBibG9ja0FsaWduIC0gQmxvY2sgYWxpZ25tZW50LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBiaXRzUGVyU2FtcGxlIC0gQml0cyBwZXIgc2FtcGxlLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhdWRpb0Zvcm1hdFN0cmluZyAtIEF1ZGlvIGZvcm1hdCBzdHJpbmdcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcmVxdWVzdEF1ZGlvRm9ybWF0U3RyaW5nIC0gQXVkaW8gZm9ybWF0IHN0cmluZyBzZW50IHRvIHNlcnZpY2UuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBoYXNIZWFkZXIgLSBJZiB0aGUgZm9ybWF0IGhhcyBoZWFkZXIgb3Igbm90LlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGZvcm1hdFRhZywgY2hhbm5lbHMsIHNhbXBsZXNQZXJTZWMsIGF2Z0J5dGVzUGVyU2VjLCBibG9ja0FsaWduLCBiaXRzUGVyU2FtcGxlLCBhdWRpb0Zvcm1hdFN0cmluZywgcmVxdWVzdEF1ZGlvRm9ybWF0U3RyaW5nLCBoYXNIZWFkZXIpIHtcbiAgICAgICAgc3VwZXIoc2FtcGxlc1BlclNlYywgYml0c1BlclNhbXBsZSwgY2hhbm5lbHMsIGZvcm1hdFRhZyk7XG4gICAgICAgIHRoaXMuZm9ybWF0VGFnID0gZm9ybWF0VGFnO1xuICAgICAgICB0aGlzLmF2Z0J5dGVzUGVyU2VjID0gYXZnQnl0ZXNQZXJTZWM7XG4gICAgICAgIHRoaXMuYmxvY2tBbGlnbiA9IGJsb2NrQWxpZ247XG4gICAgICAgIHRoaXMucHJpQXVkaW9Gb3JtYXRTdHJpbmcgPSBhdWRpb0Zvcm1hdFN0cmluZztcbiAgICAgICAgdGhpcy5wcmlSZXF1ZXN0QXVkaW9Gb3JtYXRTdHJpbmcgPSByZXF1ZXN0QXVkaW9Gb3JtYXRTdHJpbmc7XG4gICAgICAgIHRoaXMucHJpSGFzSGVhZGVyID0gaGFzSGVhZGVyO1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbVNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdChzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQpIHtcbiAgICAgICAgaWYgKHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gQXVkaW9PdXRwdXRGb3JtYXRJbXBsLmdldERlZmF1bHRPdXRwdXRGb3JtYXQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gQXVkaW9PdXRwdXRGb3JtYXRJbXBsLmZyb21TcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcoQXVkaW9PdXRwdXRGb3JtYXRJbXBsLlNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFRvU3RyaW5nW3NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdF0pO1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbVNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZyhzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcpIHtcbiAgICAgICAgc3dpdGNoIChzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcpIHtcbiAgICAgICAgICAgIGNhc2UgXCJyYXctOGtoei04Yml0LW1vbm8tbXVsYXdcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5NdUxhdywgMSwgODAwMCwgODAwMCwgMSwgOCwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJyaWZmLTE2a2h6LTE2a2Jwcy1tb25vLXNpcmVuXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuU2lyZW4sIDEsIDE2MDAwLCAyMDAwLCA0MCwgMCwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBcImF1ZGlvLTE2a2h6LTE2a2Jwcy1tb25vLXNpcmVuXCIsIHRydWUpO1xuICAgICAgICAgICAgY2FzZSBcImF1ZGlvLTE2a2h6LTE2a2Jwcy1tb25vLXNpcmVuXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuU2lyZW4sIDEsIDE2MDAwLCAyMDAwLCA0MCwgMCwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJhdWRpby0xNmtoei0zMmtiaXRyYXRlLW1vbm8tbXAzXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuTVAzLCAxLCAxNjAwMCwgMzIgPDwgNywgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwiYXVkaW8tMTZraHotMTI4a2JpdHJhdGUtbW9uby1tcDNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5NUDMsIDEsIDE2MDAwLCAxMjggPDwgNywgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwiYXVkaW8tMTZraHotNjRrYml0cmF0ZS1tb25vLW1wM1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLk1QMywgMSwgMTYwMDAsIDY0IDw8IDcsIDIsIDE2LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgZmFsc2UpO1xuICAgICAgICAgICAgY2FzZSBcImF1ZGlvLTI0a2h6LTQ4a2JpdHJhdGUtbW9uby1tcDNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5NUDMsIDEsIDI0MDAwLCA0OCA8PCA3LCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJhdWRpby0yNGtoei05NmtiaXRyYXRlLW1vbm8tbXAzXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuTVAzLCAxLCAyNDAwMCwgOTYgPDwgNywgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwiYXVkaW8tMjRraHotMTYwa2JpdHJhdGUtbW9uby1tcDNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5NUDMsIDEsIDI0MDAwLCAxNjAgPDwgNywgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwicmF3LTE2a2h6LTE2Yml0LW1vbm8tdHJ1ZXNpbGtcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5TSUxLU2t5cGUsIDEsIDE2MDAwLCAzMjAwMCwgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwicmlmZi04a2h6LTE2Yml0LW1vbm8tcGNtXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuUENNLCAxLCA4MDAwLCAxNjAwMCwgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgXCJyYXctOGtoei0xNmJpdC1tb25vLXBjbVwiLCB0cnVlKTtcbiAgICAgICAgICAgIGNhc2UgXCJyaWZmLTI0a2h6LTE2Yml0LW1vbm8tcGNtXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuUENNLCAxLCAyNDAwMCwgNDgwMDAsIDIsIDE2LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIFwicmF3LTI0a2h6LTE2Yml0LW1vbm8tcGNtXCIsIHRydWUpO1xuICAgICAgICAgICAgY2FzZSBcInJpZmYtOGtoei04Yml0LW1vbm8tbXVsYXdcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5NdUxhdywgMSwgODAwMCwgODAwMCwgMSwgOCwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBcInJhdy04a2h6LThiaXQtbW9uby1tdWxhd1wiLCB0cnVlKTtcbiAgICAgICAgICAgIGNhc2UgXCJyYXctMTZraHotMTZiaXQtbW9uby1wY21cIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5QQ00sIDEsIDE2MDAwLCAzMjAwMCwgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgXCJyYXctMTZraHotMTZiaXQtbW9uby1wY21cIiwgZmFsc2UpO1xuICAgICAgICAgICAgY2FzZSBcInJhdy0yNGtoei0xNmJpdC1tb25vLXBjbVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLlBDTSwgMSwgMjQwMDAsIDQ4MDAwLCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBcInJhdy0yNGtoei0xNmJpdC1tb25vLXBjbVwiLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwicmF3LThraHotMTZiaXQtbW9uby1wY21cIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5QQ00sIDEsIDgwMDAsIDE2MDAwLCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBcInJhdy04a2h6LTE2Yml0LW1vbm8tcGNtXCIsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJvZ2ctMTZraHotMTZiaXQtbW9uby1vcHVzXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuT0dHX09QVVMsIDEsIDE2MDAwLCA4MTkyLCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJvZ2ctMjRraHotMTZiaXQtbW9uby1vcHVzXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuT0dHX09QVVMsIDEsIDI0MDAwLCA4MTkyLCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJyYXctNDhraHotMTZiaXQtbW9uby1wY21cIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5QQ00sIDEsIDQ4MDAwLCA5NjAwMCwgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgXCJyYXctNDhraHotMTZiaXQtbW9uby1wY21cIiwgZmFsc2UpO1xuICAgICAgICAgICAgY2FzZSBcInJpZmYtNDhraHotMTZiaXQtbW9uby1wY21cIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5QQ00sIDEsIDQ4MDAwLCA5NjAwMCwgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgXCJyYXctNDhraHotMTZiaXQtbW9uby1wY21cIiwgdHJ1ZSk7XG4gICAgICAgICAgICBjYXNlIFwiYXVkaW8tNDhraHotOTZrYml0cmF0ZS1tb25vLW1wM1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLk1QMywgMSwgNDgwMDAsIDk2IDw8IDcsIDIsIDE2LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgZmFsc2UpO1xuICAgICAgICAgICAgY2FzZSBcImF1ZGlvLTQ4a2h6LTE5MmtiaXRyYXRlLW1vbm8tbXAzXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuTVAzLCAxLCA0ODAwMCwgMTkyIDw8IDcsIDIsIDE2LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgZmFsc2UpO1xuICAgICAgICAgICAgY2FzZSBcIm9nZy00OGtoei0xNmJpdC1tb25vLW9wdXNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5PR0dfT1BVUywgMSwgNDgwMDAsIDEyMDAwLCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJ3ZWJtLTE2a2h6LTE2Yml0LW1vbm8tb3B1c1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLldFQk1fT1BVUywgMSwgMTYwMDAsIDQwMDAsIDIsIDE2LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgZmFsc2UpO1xuICAgICAgICAgICAgY2FzZSBcIndlYm0tMjRraHotMTZiaXQtbW9uby1vcHVzXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuV0VCTV9PUFVTLCAxLCAyNDAwMCwgNjAwMCwgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwid2VibS0yNGtoei0xNmJpdC0yNGticHMtbW9uby1vcHVzXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuV0VCTV9PUFVTLCAxLCAyNDAwMCwgMzAwMCwgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwiYXVkaW8tMTZraHotMTZiaXQtMzJrYnBzLW1vbm8tb3B1c1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLk9QVVMsIDEsIDE2MDAwLCA0MDAwLCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJhdWRpby0yNGtoei0xNmJpdC00OGticHMtbW9uby1vcHVzXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuT1BVUywgMSwgMjQwMDAsIDYwMDAsIDIsIDE2LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgZmFsc2UpO1xuICAgICAgICAgICAgY2FzZSBcImF1ZGlvLTI0a2h6LTE2Yml0LTI0a2Jwcy1tb25vLW9wdXNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5PUFVTLCAxLCAyNDAwMCwgMzAwMCwgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwiYXVkaW8tMjRraHotMTZiaXQtbW9uby1mbGFjXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuRkxBQywgMSwgMjQwMDAsIDI0MDAwLCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJhdWRpby00OGtoei0xNmJpdC1tb25vLWZsYWNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5GTEFDLCAxLCA0ODAwMCwgMzAwMDAsIDIsIDE2LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgZmFsc2UpO1xuICAgICAgICAgICAgY2FzZSBcInJhdy0yNGtoei0xNmJpdC1tb25vLXRydWVzaWxrXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuU0lMS1NreXBlLCAxLCAyNDAwMCwgNDgwMDAsIDIsIDE2LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgZmFsc2UpO1xuICAgICAgICAgICAgY2FzZSBcInJhdy04a2h6LThiaXQtbW9uby1hbGF3XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuQUxhdywgMSwgODAwMCwgODAwMCwgMSwgOCwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJyaWZmLThraHotOGJpdC1tb25vLWFsYXdcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5BTGF3LCAxLCA4MDAwLCA4MDAwLCAxLCA4LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIFwicmF3LThraHotOGJpdC1tb25vLWFsYXdcIiwgdHJ1ZSk7XG4gICAgICAgICAgICBjYXNlIFwicmF3LTIyMDUwaHotMTZiaXQtbW9uby1wY21cIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5QQ00sIDEsIDIyMDUwLCA0NDEwMCwgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwicmlmZi0yMjA1MGh6LTE2Yml0LW1vbm8tcGNtXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuUENNLCAxLCAyMjA1MCwgNDQxMDAsIDIsIDE2LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIFwicmF3LTIyMDUwaHotMTZiaXQtbW9uby1wY21cIiwgdHJ1ZSk7XG4gICAgICAgICAgICBjYXNlIFwicmF3LTQ0MTAwaHotMTZiaXQtbW9uby1wY21cIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5QQ00sIDEsIDQ0MTAwLCA4ODIwMCwgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwicmlmZi00NDEwMGh6LTE2Yml0LW1vbm8tcGNtXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuUENNLCAxLCA0NDEwMCwgODgyMDAsIDIsIDE2LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIFwicmF3LTQ0MTAwaHotMTZiaXQtbW9uby1wY21cIiwgdHJ1ZSk7XG4gICAgICAgICAgICBjYXNlIFwicmlmZi0xNmtoei0xNmJpdC1tb25vLXBjbVwiOlxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5QQ00sIDEsIDE2MDAwLCAzMjAwMCwgMiwgMTYsIFwicmlmZi0xNmtoei0xNmJpdC1tb25vLXBjbVwiLCBcInJhdy0xNmtoei0xNmJpdC1tb25vLXBjbVwiLCB0cnVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZ2V0RGVmYXVsdE91dHB1dEZvcm1hdCgpIHtcbiAgICAgICAgcmV0dXJuIEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbC5mcm9tU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nKCh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSA/IFwiYXVkaW8tMjRraHotNDhrYml0cmF0ZS1tb25vLW1wM1wiIDogXCJyaWZmLTE2a2h6LTE2Yml0LW1vbm8tcGNtXCIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgaWYgdGhpcyBhdWRpbyBvdXRwdXQgZm9ybWF0IGhhcyBhIGhlYWRlclxuICAgICAqIEBib29sZWFuIEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbC5wcm90b3R5cGUuaGFzSGVhZGVyXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGdldCBoYXNIZWFkZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaUhhc0hlYWRlcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3BlY2lmaWVzIHRoZSBoZWFkZXIgb2YgdGhpcyBmb3JtYXRcbiAgICAgKiBAQXJyYXlCdWZmZXIgQXVkaW9PdXRwdXRGb3JtYXRJbXBsLnByb3RvdHlwZS5oZWFkZXJcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgZ2V0IGhlYWRlcigpIHtcbiAgICAgICAgaWYgKHRoaXMuaGFzSGVhZGVyKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2SGVhZGVyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIGhlYWRlciBiYXNlZCBvbiB0aGUgYXVkaW8gbGVuZ3RoXG4gICAgICogQG1lbWJlciBBdWRpb091dHB1dEZvcm1hdEltcGwudXBkYXRlSGVhZGVyXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBhdWRpb0xlbmd0aCAtIHRoZSBhdWRpbyBsZW5ndGhcbiAgICAgKi9cbiAgICB1cGRhdGVIZWFkZXIoYXVkaW9MZW5ndGgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpSGFzSGVhZGVyKSB7XG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gbmV3IERhdGFWaWV3KHRoaXMucHJpdkhlYWRlcik7XG4gICAgICAgICAgICB2aWV3LnNldFVpbnQzMig0LCBhdWRpb0xlbmd0aCArIHRoaXMucHJpdkhlYWRlci5ieXRlTGVuZ3RoIC0gOCwgdHJ1ZSk7XG4gICAgICAgICAgICB2aWV3LnNldFVpbnQzMig0MCwgYXVkaW9MZW5ndGgsIHRydWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyB0aGUgYXVkaW8gZm9ybWF0IHN0cmluZyB0byBiZSBzZW50IHRvIHRoZSBzZXJ2aWNlXG4gICAgICogQHN0cmluZyBBdWRpb091dHB1dEZvcm1hdEltcGwucHJvdG90eXBlLnJlcXVlc3RBdWRpb0Zvcm1hdFN0cmluZ1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBnZXQgcmVxdWVzdEF1ZGlvRm9ybWF0U3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcmlSZXF1ZXN0QXVkaW9Gb3JtYXRTdHJpbmc7XG4gICAgfVxufVxuQXVkaW9PdXRwdXRGb3JtYXRJbXBsLlNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFRvU3RyaW5nID0ge1xuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmF3OEtoejhCaXRNb25vTVVMYXddOiBcInJhdy04a2h6LThiaXQtbW9uby1tdWxhd1wiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmlmZjE2S2h6MTZLYnBzTW9ub1NpcmVuXTogXCJyaWZmLTE2a2h6LTE2a2Jwcy1tb25vLXNpcmVuXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5BdWRpbzE2S2h6MTZLYnBzTW9ub1NpcmVuXTogXCJhdWRpby0xNmtoei0xNmticHMtbW9uby1zaXJlblwiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuQXVkaW8xNktoejMyS0JpdFJhdGVNb25vTXAzXTogXCJhdWRpby0xNmtoei0zMmtiaXRyYXRlLW1vbm8tbXAzXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5BdWRpbzE2S2h6MTI4S0JpdFJhdGVNb25vTXAzXTogXCJhdWRpby0xNmtoei0xMjhrYml0cmF0ZS1tb25vLW1wM1wiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuQXVkaW8xNktoejY0S0JpdFJhdGVNb25vTXAzXTogXCJhdWRpby0xNmtoei02NGtiaXRyYXRlLW1vbm8tbXAzXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5BdWRpbzI0S2h6NDhLQml0UmF0ZU1vbm9NcDNdOiBcImF1ZGlvLTI0a2h6LTQ4a2JpdHJhdGUtbW9uby1tcDNcIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LkF1ZGlvMjRLaHo5NktCaXRSYXRlTW9ub01wM106IFwiYXVkaW8tMjRraHotOTZrYml0cmF0ZS1tb25vLW1wM1wiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuQXVkaW8yNEtoejE2MEtCaXRSYXRlTW9ub01wM106IFwiYXVkaW8tMjRraHotMTYwa2JpdHJhdGUtbW9uby1tcDNcIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJhdzE2S2h6MTZCaXRNb25vVHJ1ZVNpbGtdOiBcInJhdy0xNmtoei0xNmJpdC1tb25vLXRydWVzaWxrXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SaWZmMTZLaHoxNkJpdE1vbm9QY21dOiBcInJpZmYtMTZraHotMTZiaXQtbW9uby1wY21cIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJpZmY4S2h6MTZCaXRNb25vUGNtXTogXCJyaWZmLThraHotMTZiaXQtbW9uby1wY21cIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJpZmYyNEtoejE2Qml0TW9ub1BjbV06IFwicmlmZi0yNGtoei0xNmJpdC1tb25vLXBjbVwiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmlmZjhLaHo4Qml0TW9ub01VTGF3XTogXCJyaWZmLThraHotOGJpdC1tb25vLW11bGF3XCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SYXcxNktoejE2Qml0TW9ub1BjbV06IFwicmF3LTE2a2h6LTE2Yml0LW1vbm8tcGNtXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SYXcyNEtoejE2Qml0TW9ub1BjbV06IFwicmF3LTI0a2h6LTE2Yml0LW1vbm8tcGNtXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SYXc4S2h6MTZCaXRNb25vUGNtXTogXCJyYXctOGtoei0xNmJpdC1tb25vLXBjbVwiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuT2dnMTZLaHoxNkJpdE1vbm9PcHVzXTogXCJvZ2ctMTZraHotMTZiaXQtbW9uby1vcHVzXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5PZ2cyNEtoejE2Qml0TW9ub09wdXNdOiBcIm9nZy0yNGtoei0xNmJpdC1tb25vLW9wdXNcIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJhdzQ4S2h6MTZCaXRNb25vUGNtXTogXCJyYXctNDhraHotMTZiaXQtbW9uby1wY21cIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJpZmY0OEtoejE2Qml0TW9ub1BjbV06IFwicmlmZi00OGtoei0xNmJpdC1tb25vLXBjbVwiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuQXVkaW80OEtoejk2S0JpdFJhdGVNb25vTXAzXTogXCJhdWRpby00OGtoei05NmtiaXRyYXRlLW1vbm8tbXAzXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5BdWRpbzQ4S2h6MTkyS0JpdFJhdGVNb25vTXAzXTogXCJhdWRpby00OGtoei0xOTJrYml0cmF0ZS1tb25vLW1wM1wiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuT2dnNDhLaHoxNkJpdE1vbm9PcHVzXTogXCJvZ2ctNDhraHotMTZiaXQtbW9uby1vcHVzXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5XZWJtMTZLaHoxNkJpdE1vbm9PcHVzXTogXCJ3ZWJtLTE2a2h6LTE2Yml0LW1vbm8tb3B1c1wiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuV2VibTI0S2h6MTZCaXRNb25vT3B1c106IFwid2VibS0yNGtoei0xNmJpdC1tb25vLW9wdXNcIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LldlYm0yNEtoejE2Qml0MjRLYnBzTW9ub09wdXNdOiBcIndlYm0tMjRraHotMTZiaXQtMjRrYnBzLW1vbm8tb3B1c1wiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmF3MjRLaHoxNkJpdE1vbm9UcnVlU2lsa106IFwicmF3LTI0a2h6LTE2Yml0LW1vbm8tdHJ1ZXNpbGtcIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJhdzhLaHo4Qml0TW9ub0FMYXddOiBcInJhdy04a2h6LThiaXQtbW9uby1hbGF3XCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SaWZmOEtoejhCaXRNb25vQUxhd106IFwicmlmZi04a2h6LThiaXQtbW9uby1hbGF3XCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5BdWRpbzE2S2h6MTZCaXQzMkticHNNb25vT3B1c106IFwiYXVkaW8tMTZraHotMTZiaXQtMzJrYnBzLW1vbm8tb3B1c1wiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuQXVkaW8yNEtoejE2Qml0NDhLYnBzTW9ub09wdXNdOiBcImF1ZGlvLTI0a2h6LTE2Yml0LTQ4a2Jwcy1tb25vLW9wdXNcIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LkF1ZGlvMjRLaHoxNkJpdDI0S2Jwc01vbm9PcHVzXTogXCJhdWRpby0yNGtoei0xNmJpdC0yNGticHMtbW9uby1vcHVzXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SYXcyMjA1MEh6MTZCaXRNb25vUGNtXTogXCJyYXctMjIwNTBoei0xNmJpdC1tb25vLXBjbVwiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmlmZjIyMDUwSHoxNkJpdE1vbm9QY21dOiBcInJpZmYtMjIwNTBoei0xNmJpdC1tb25vLXBjbVwiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmF3NDQxMDBIejE2Qml0TW9ub1BjbV06IFwicmF3LTQ0MTAwaHotMTZiaXQtbW9uby1wY21cIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJpZmY0NDEwMEh6MTZCaXRNb25vUGNtXTogXCJyaWZmLTQ0MTAwaHotMTZiaXQtbW9uby1wY21cIixcbn07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUF1ZGlvT3V0cHV0Rm9ybWF0LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbi8qIGVzbGludC1kaXNhYmxlIG1heC1jbGFzc2VzLXBlci1maWxlICovXG5pbXBvcnQgeyBjcmVhdGVOb0Rhc2hHdWlkLCBTdHJlYW0sIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBBdWRpb091dHB1dEZvcm1hdEltcGwgfSBmcm9tIFwiLi9BdWRpb091dHB1dEZvcm1hdFwiO1xuLyoqXG4gKiBSZXByZXNlbnRzIGF1ZGlvIG91dHB1dCBzdHJlYW0gdXNlZCBmb3IgY3VzdG9tIGF1ZGlvIG91dHB1dCBjb25maWd1cmF0aW9ucy5cbiAqIEBjbGFzcyBBdWRpb091dHB1dFN0cmVhbVxuICovXG5leHBvcnQgY2xhc3MgQXVkaW9PdXRwdXRTdHJlYW0ge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBtZW1vcnkgYmFja2VkIFB1bGxBdWRpb091dHB1dFN0cmVhbSB3aXRoIHRoZSBzcGVjaWZpZWQgYXVkaW8gZm9ybWF0LlxuICAgICAqIEBtZW1iZXIgQXVkaW9PdXRwdXRTdHJlYW0uY3JlYXRlUHVsbFN0cmVhbVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7UHVsbEF1ZGlvT3V0cHV0U3RyZWFtfSBUaGUgYXVkaW8gb3V0cHV0IHN0cmVhbSBiZWluZyBjcmVhdGVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVhdGVQdWxsU3RyZWFtKCkge1xuICAgICAgICByZXR1cm4gUHVsbEF1ZGlvT3V0cHV0U3RyZWFtLmNyZWF0ZSgpO1xuICAgIH1cbn1cbi8qKlxuICogUmVwcmVzZW50cyBtZW1vcnkgYmFja2VkIHB1c2ggYXVkaW8gb3V0cHV0IHN0cmVhbSB1c2VkIGZvciBjdXN0b20gYXVkaW8gb3V0cHV0IGNvbmZpZ3VyYXRpb25zLlxuICogQGNsYXNzIFB1bGxBdWRpb091dHB1dFN0cmVhbVxuICovXG5leHBvcnQgY2xhc3MgUHVsbEF1ZGlvT3V0cHV0U3RyZWFtIGV4dGVuZHMgQXVkaW9PdXRwdXRTdHJlYW0ge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBtZW1vcnkgYmFja2VkIFB1bGxBdWRpb091dHB1dFN0cmVhbSB3aXRoIHRoZSBzcGVjaWZpZWQgYXVkaW8gZm9ybWF0LlxuICAgICAqIEBtZW1iZXIgUHVsbEF1ZGlvT3V0cHV0U3RyZWFtLmNyZWF0ZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7UHVsbEF1ZGlvT3V0cHV0U3RyZWFtfSBUaGUgcHVzaCBhdWRpbyBvdXRwdXQgc3RyZWFtIGJlaW5nIGNyZWF0ZWQuXG4gICAgICovXG4gICAgc3RhdGljIGNyZWF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQdWxsQXVkaW9PdXRwdXRTdHJlYW1JbXBsKCk7XG4gICAgfVxufVxuLyoqXG4gKiBSZXByZXNlbnRzIG1lbW9yeSBiYWNrZWQgcHVzaCBhdWRpbyBvdXRwdXQgc3RyZWFtIHVzZWQgZm9yIGN1c3RvbSBhdWRpbyBvdXRwdXQgY29uZmlndXJhdGlvbnMuXG4gKiBAcHJpdmF0ZVxuICogQGNsYXNzIFB1bGxBdWRpb091dHB1dFN0cmVhbUltcGxcbiAqL1xuZXhwb3J0IGNsYXNzIFB1bGxBdWRpb091dHB1dFN0cmVhbUltcGwgZXh0ZW5kcyBQdWxsQXVkaW9PdXRwdXRTdHJlYW0ge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIHdpdGggdGhlIGdpdmVuIHZhbHVlcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5wcml2SWQgPSBjcmVhdGVOb0Rhc2hHdWlkKCk7XG4gICAgICAgIHRoaXMucHJpdlN0cmVhbSA9IG5ldyBTdHJlYW0oKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgZm9ybWF0IGluZm9ybWF0aW9uIHRvIHRoZSBzdHJlYW0uIEZvciBpbnRlcm5hbCB1c2Ugb25seS5cbiAgICAgKiBAcGFyYW0ge0F1ZGlvU3RyZWFtRm9ybWF0fSBmb3JtYXQgLSB0aGUgZm9ybWF0IHRvIGJlIHNldC5cbiAgICAgKi9cbiAgICBzZXQgZm9ybWF0KGZvcm1hdCkge1xuICAgICAgICBpZiAoZm9ybWF0ID09PSB1bmRlZmluZWQgfHwgZm9ybWF0ID09PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZGb3JtYXQgPSBBdWRpb091dHB1dEZvcm1hdEltcGwuZ2V0RGVmYXVsdE91dHB1dEZvcm1hdCgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdkZvcm1hdCA9IGZvcm1hdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRm9ybWF0IGluZm9ybWF0aW9uIGZvciB0aGUgYXVkaW9cbiAgICAgKi9cbiAgICBnZXQgZm9ybWF0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Rm9ybWF0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgdGhlIHN0cmVhbSBpcyBjbG9zZWRcbiAgICAgKiBAbWVtYmVyIFB1bGxBdWRpb091dHB1dFN0cmVhbUltcGwucHJvdG90eXBlLmlzQ2xvc2VkXG4gICAgICogQHByb3BlcnR5XG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGdldCBpc0Nsb3NlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlN0cmVhbS5pc0Nsb3NlZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgaWQgb2YgdGhlIHN0cmVhbVxuICAgICAqIEBtZW1iZXIgUHVsbEF1ZGlvT3V0cHV0U3RyZWFtSW1wbC5wcm90b3R5cGUuaWRcbiAgICAgKiBAcHJvcGVydHlcbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVhZHMgYXVkaW8gZGF0YSBmcm9tIHRoZSBpbnRlcm5hbCBidWZmZXIuXG4gICAgICogQG1lbWJlciBQdWxsQXVkaW9PdXRwdXRTdHJlYW1JbXBsLnByb3RvdHlwZS5yZWFkXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7QXJyYXlCdWZmZXJ9IGRhdGFCdWZmZXIgLSBBbiBBcnJheUJ1ZmZlciB0byBzdG9yZSB0aGUgcmVhZCBkYXRhLlxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPG51bWJlcj59IC0gQXVkaW8gYnVmZmVyIGxlbmd0aCBoYXMgYmVlbiByZWFkLlxuICAgICAqL1xuICAgIHJlYWQoZGF0YUJ1ZmZlcikge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgaW50VmlldyA9IG5ldyBJbnQ4QXJyYXkoZGF0YUJ1ZmZlcik7XG4gICAgICAgICAgICBsZXQgdG90YWxCeXRlcyA9IDA7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2TGFzdENodW5rVmlldyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdkxhc3RDaHVua1ZpZXcubGVuZ3RoID4gZGF0YUJ1ZmZlci5ieXRlTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGludFZpZXcuc2V0KHRoaXMucHJpdkxhc3RDaHVua1ZpZXcuc2xpY2UoMCwgZGF0YUJ1ZmZlci5ieXRlTGVuZ3RoKSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkxhc3RDaHVua1ZpZXcgPSB0aGlzLnByaXZMYXN0Q2h1bmtWaWV3LnNsaWNlKGRhdGFCdWZmZXIuYnl0ZUxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZGF0YUJ1ZmZlci5ieXRlTGVuZ3RoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaW50Vmlldy5zZXQodGhpcy5wcml2TGFzdENodW5rVmlldyk7XG4gICAgICAgICAgICAgICAgdG90YWxCeXRlcyA9IHRoaXMucHJpdkxhc3RDaHVua1ZpZXcubGVuZ3RoO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkxhc3RDaHVua1ZpZXcgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBVbnRpbCB3ZSBoYXZlIHRoZSBtaW5pbXVtIG51bWJlciBvZiBieXRlcyB0byBzZW5kIGluIGEgdHJhbnNtaXNzaW9uLCBrZWVwIGFza2luZyBmb3IgbW9yZS5cbiAgICAgICAgICAgIHdoaWxlICh0b3RhbEJ5dGVzIDwgZGF0YUJ1ZmZlci5ieXRlTGVuZ3RoICYmICF0aGlzLnByaXZTdHJlYW0uaXNSZWFkRW5kZWQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjaHVuayA9IHlpZWxkIHRoaXMucHJpdlN0cmVhbS5yZWFkKCk7XG4gICAgICAgICAgICAgICAgaWYgKGNodW5rICE9PSB1bmRlZmluZWQgJiYgIWNodW5rLmlzRW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCB0bXBCdWZmZXI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaHVuay5idWZmZXIuYnl0ZUxlbmd0aCA+IGRhdGFCdWZmZXIuYnl0ZUxlbmd0aCAtIHRvdGFsQnl0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRtcEJ1ZmZlciA9IGNodW5rLmJ1ZmZlci5zbGljZSgwLCBkYXRhQnVmZmVyLmJ5dGVMZW5ndGggLSB0b3RhbEJ5dGVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkxhc3RDaHVua1ZpZXcgPSBuZXcgSW50OEFycmF5KGNodW5rLmJ1ZmZlci5zbGljZShkYXRhQnVmZmVyLmJ5dGVMZW5ndGggLSB0b3RhbEJ5dGVzKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0bXBCdWZmZXIgPSBjaHVuay5idWZmZXI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaW50Vmlldy5zZXQobmV3IEludDhBcnJheSh0bXBCdWZmZXIpLCB0b3RhbEJ5dGVzKTtcbiAgICAgICAgICAgICAgICAgICAgdG90YWxCeXRlcyArPSB0bXBCdWZmZXIuYnl0ZUxlbmd0aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlN0cmVhbS5yZWFkRW5kZWQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdG90YWxCeXRlcztcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFdyaXRlcyB0aGUgYXVkaW8gZGF0YSBzcGVjaWZpZWQgYnkgbWFraW5nIGFuIGludGVybmFsIGNvcHkgb2YgdGhlIGRhdGEuXG4gICAgICogQG1lbWJlciBQdWxsQXVkaW9PdXRwdXRTdHJlYW1JbXBsLnByb3RvdHlwZS53cml0ZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge0FycmF5QnVmZmVyfSBkYXRhQnVmZmVyIC0gVGhlIGF1ZGlvIGJ1ZmZlciBvZiB3aGljaCB0aGlzIGZ1bmN0aW9uIHdpbGwgbWFrZSBhIGNvcHkuXG4gICAgICovXG4gICAgd3JpdGUoZGF0YUJ1ZmZlcikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZCh0aGlzLnByaXZTdHJlYW0sIFwibXVzdCBzZXQgZm9ybWF0IGJlZm9yZSB3cml0aW5nXCIpO1xuICAgICAgICB0aGlzLnByaXZTdHJlYW0ud3JpdGVTdHJlYW1DaHVuayh7XG4gICAgICAgICAgICBidWZmZXI6IGRhdGFCdWZmZXIsXG4gICAgICAgICAgICBpc0VuZDogZmFsc2UsXG4gICAgICAgICAgICB0aW1lUmVjZWl2ZWQ6IERhdGUubm93KClcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsb3NlcyB0aGUgc3RyZWFtLlxuICAgICAqIEBtZW1iZXIgUHVsbEF1ZGlvT3V0cHV0U3RyZWFtSW1wbC5wcm90b3R5cGUuY2xvc2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMucHJpdlN0cmVhbS5jbG9zZSgpO1xuICAgIH1cbn1cbi8qXG4gKiBSZXByZXNlbnRzIGF1ZGlvIG91dHB1dCBzdHJlYW0gdXNlZCBmb3IgY3VzdG9tIGF1ZGlvIG91dHB1dCBjb25maWd1cmF0aW9ucy5cbiAqIEBjbGFzcyBQdXNoQXVkaW9PdXRwdXRTdHJlYW1cbiAqL1xuZXhwb3J0IGNsYXNzIFB1c2hBdWRpb091dHB1dFN0cmVhbSBleHRlbmRzIEF1ZGlvT3V0cHV0U3RyZWFtIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbmQgaW5zdGFuY2UuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBQdXNoQXVkaW9PdXRwdXRTdHJlYW0gdGhhdCBkZWxlZ2F0ZXMgdG8gdGhlIHNwZWNpZmllZCBjYWxsYmFjayBpbnRlcmZhY2UgZm9yXG4gICAgICogd3JpdGUoKSBhbmQgY2xvc2UoKSBtZXRob2RzLlxuICAgICAqIEBtZW1iZXIgUHVzaEF1ZGlvT3V0cHV0U3RyZWFtLmNyZWF0ZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge1B1c2hBdWRpb091dHB1dFN0cmVhbUNhbGxiYWNrfSBjYWxsYmFjayAtIFRoZSBjdXN0b20gYXVkaW8gb3V0cHV0IG9iamVjdCxcbiAgICAgKiBkZXJpdmVkIGZyb20gUHVzaEF1ZGlvT3V0cHV0U3RyZWFtQ2FsbGJhY2tcbiAgICAgKiBAcmV0dXJucyB7UHVzaEF1ZGlvT3V0cHV0U3RyZWFtfSBUaGUgcHVzaCBhdWRpbyBvdXRwdXQgc3RyZWFtIGJlaW5nIGNyZWF0ZWQuXG4gICAgICovXG4gICAgc3RhdGljIGNyZWF0ZShjYWxsYmFjaykge1xuICAgICAgICByZXR1cm4gbmV3IFB1c2hBdWRpb091dHB1dFN0cmVhbUltcGwoY2FsbGJhY2spO1xuICAgIH1cbn1cbi8qKlxuICogUmVwcmVzZW50cyBhdWRpbyBvdXRwdXQgc3RyZWFtIHVzZWQgZm9yIGN1c3RvbSBhdWRpbyBvdXRwdXQgY29uZmlndXJhdGlvbnMuXG4gKiBAcHJpdmF0ZVxuICogQGNsYXNzIFB1c2hBdWRpb091dHB1dFN0cmVhbUltcGxcbiAqL1xuZXhwb3J0IGNsYXNzIFB1c2hBdWRpb091dHB1dFN0cmVhbUltcGwgZXh0ZW5kcyBQdXNoQXVkaW9PdXRwdXRTdHJlYW0ge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBQdXNoQXVkaW9PdXRwdXRTdHJlYW0gdGhhdCBkZWxlZ2F0ZXMgdG8gdGhlIHNwZWNpZmllZCBjYWxsYmFjayBpbnRlcmZhY2UgZm9yXG4gICAgICogcmVhZCgpIGFuZCBjbG9zZSgpIG1ldGhvZHMuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtQdXNoQXVkaW9PdXRwdXRTdHJlYW1DYWxsYmFja30gY2FsbGJhY2sgLSBUaGUgY3VzdG9tIGF1ZGlvIG91dHB1dCBvYmplY3QsXG4gICAgICogZGVyaXZlZCBmcm9tIFB1c2hBdWRpb091dHB1dFN0cmVhbUNhbGxiYWNrXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoY2FsbGJhY2spIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5wcml2SWQgPSBjcmVhdGVOb0Rhc2hHdWlkKCk7XG4gICAgICAgIHRoaXMucHJpdkNhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgfVxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb25cbiAgICBzZXQgZm9ybWF0KGZvcm1hdCkgeyB9XG4gICAgd3JpdGUoYnVmZmVyKSB7XG4gICAgICAgIGlmICghIXRoaXMucHJpdkNhbGxiYWNrLndyaXRlKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZDYWxsYmFjay53cml0ZShidWZmZXIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgICBpZiAoISF0aGlzLnByaXZDYWxsYmFjay5jbG9zZSkge1xuICAgICAgICAgICAgdGhpcy5wcml2Q2FsbGJhY2suY2xvc2UoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklkO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QXVkaW9PdXRwdXRTdHJlYW0uanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtY2xhc3Nlcy1wZXItZmlsZVxuZXhwb3J0IHZhciBBdWRpb0Zvcm1hdFRhZztcbihmdW5jdGlvbiAoQXVkaW9Gb3JtYXRUYWcpIHtcbiAgICBBdWRpb0Zvcm1hdFRhZ1tBdWRpb0Zvcm1hdFRhZ1tcIlBDTVwiXSA9IDFdID0gXCJQQ01cIjtcbiAgICBBdWRpb0Zvcm1hdFRhZ1tBdWRpb0Zvcm1hdFRhZ1tcIk11TGF3XCJdID0gMl0gPSBcIk11TGF3XCI7XG4gICAgQXVkaW9Gb3JtYXRUYWdbQXVkaW9Gb3JtYXRUYWdbXCJTaXJlblwiXSA9IDNdID0gXCJTaXJlblwiO1xuICAgIEF1ZGlvRm9ybWF0VGFnW0F1ZGlvRm9ybWF0VGFnW1wiTVAzXCJdID0gNF0gPSBcIk1QM1wiO1xuICAgIEF1ZGlvRm9ybWF0VGFnW0F1ZGlvRm9ybWF0VGFnW1wiU0lMS1NreXBlXCJdID0gNV0gPSBcIlNJTEtTa3lwZVwiO1xuICAgIEF1ZGlvRm9ybWF0VGFnW0F1ZGlvRm9ybWF0VGFnW1wiT0dHX09QVVNcIl0gPSA2XSA9IFwiT0dHX09QVVNcIjtcbiAgICBBdWRpb0Zvcm1hdFRhZ1tBdWRpb0Zvcm1hdFRhZ1tcIldFQk1fT1BVU1wiXSA9IDddID0gXCJXRUJNX09QVVNcIjtcbiAgICBBdWRpb0Zvcm1hdFRhZ1tBdWRpb0Zvcm1hdFRhZ1tcIkFMYXdcIl0gPSA4XSA9IFwiQUxhd1wiO1xuICAgIEF1ZGlvRm9ybWF0VGFnW0F1ZGlvRm9ybWF0VGFnW1wiRkxBQ1wiXSA9IDldID0gXCJGTEFDXCI7XG4gICAgQXVkaW9Gb3JtYXRUYWdbQXVkaW9Gb3JtYXRUYWdbXCJPUFVTXCJdID0gMTBdID0gXCJPUFVTXCI7XG59KShBdWRpb0Zvcm1hdFRhZyB8fCAoQXVkaW9Gb3JtYXRUYWcgPSB7fSkpO1xuLyoqXG4gKiBSZXByZXNlbnRzIGF1ZGlvIHN0cmVhbSBmb3JtYXQgdXNlZCBmb3IgY3VzdG9tIGF1ZGlvIGlucHV0IGNvbmZpZ3VyYXRpb25zLlxuICogQGNsYXNzIEF1ZGlvU3RyZWFtRm9ybWF0XG4gKi9cbmV4cG9ydCBjbGFzcyBBdWRpb1N0cmVhbUZvcm1hdCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBhdWRpbyBzdHJlYW0gZm9ybWF0IG9iamVjdCByZXByZXNlbnRpbmcgdGhlIGRlZmF1bHQgYXVkaW8gc3RyZWFtXG4gICAgICogZm9ybWF0ICgxNktIeiAxNmJpdCBtb25vIFBDTSkuXG4gICAgICogQG1lbWJlciBBdWRpb1N0cmVhbUZvcm1hdC5nZXREZWZhdWx0SW5wdXRGb3JtYXRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge0F1ZGlvU3RyZWFtRm9ybWF0fSBUaGUgYXVkaW8gc3RyZWFtIGZvcm1hdCBiZWluZyBjcmVhdGVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBnZXREZWZhdWx0SW5wdXRGb3JtYXQoKSB7XG4gICAgICAgIHJldHVybiBBdWRpb1N0cmVhbUZvcm1hdEltcGwuZ2V0RGVmYXVsdElucHV0Rm9ybWF0KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gYXVkaW8gc3RyZWFtIGZvcm1hdCBvYmplY3Qgd2l0aCB0aGUgc3BlY2lmaWVkIGZvcm1hdCBjaGFyYWN0ZXJpc3RpY3MuXG4gICAgICogQG1lbWJlciBBdWRpb1N0cmVhbUZvcm1hdC5nZXRXYXZlRm9ybWF0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzYW1wbGVzUGVyU2Vjb25kIC0gU2FtcGxlIHJhdGUsIGluIHNhbXBsZXMgcGVyIHNlY29uZCAoSGVydHopLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBiaXRzUGVyU2FtcGxlIC0gQml0cyBwZXIgc2FtcGxlLCB0eXBpY2FsbHkgMTYuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGNoYW5uZWxzIC0gTnVtYmVyIG9mIGNoYW5uZWxzIGluIHRoZSB3YXZlZm9ybS1hdWRpbyBkYXRhLiBNb25hdXJhbCBkYXRhXG4gICAgICogdXNlcyBvbmUgY2hhbm5lbCBhbmQgc3RlcmVvIGRhdGEgdXNlcyB0d28gY2hhbm5lbHMuXG4gICAgICogQHBhcmFtIHtBdWRpb0Zvcm1hdFRhZ30gZm9ybWF0IC0gQXVkaW8gZm9ybWF0IChQQ00sIGFsYXcgb3IgbXVsYXcpLlxuICAgICAqIEByZXR1cm5zIHtBdWRpb1N0cmVhbUZvcm1hdH0gVGhlIGF1ZGlvIHN0cmVhbSBmb3JtYXQgYmVpbmcgY3JlYXRlZC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZ2V0V2F2ZUZvcm1hdChzYW1wbGVzUGVyU2Vjb25kLCBiaXRzUGVyU2FtcGxlLCBjaGFubmVscywgZm9ybWF0KSB7XG4gICAgICAgIHJldHVybiBuZXcgQXVkaW9TdHJlYW1Gb3JtYXRJbXBsKHNhbXBsZXNQZXJTZWNvbmQsIGJpdHNQZXJTYW1wbGUsIGNoYW5uZWxzLCBmb3JtYXQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGF1ZGlvIHN0cmVhbSBmb3JtYXQgb2JqZWN0IHdpdGggdGhlIHNwZWNpZmllZCBwY20gd2F2ZWZvcm1hdCBjaGFyYWN0ZXJpc3RpY3MuXG4gICAgICogQG1lbWJlciBBdWRpb1N0cmVhbUZvcm1hdC5nZXRXYXZlRm9ybWF0UENNXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzYW1wbGVzUGVyU2Vjb25kIC0gU2FtcGxlIHJhdGUsIGluIHNhbXBsZXMgcGVyIHNlY29uZCAoSGVydHopLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBiaXRzUGVyU2FtcGxlIC0gQml0cyBwZXIgc2FtcGxlLCB0eXBpY2FsbHkgMTYuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGNoYW5uZWxzIC0gTnVtYmVyIG9mIGNoYW5uZWxzIGluIHRoZSB3YXZlZm9ybS1hdWRpbyBkYXRhLiBNb25hdXJhbCBkYXRhXG4gICAgICogdXNlcyBvbmUgY2hhbm5lbCBhbmQgc3RlcmVvIGRhdGEgdXNlcyB0d28gY2hhbm5lbHMuXG4gICAgICogQHJldHVybnMge0F1ZGlvU3RyZWFtRm9ybWF0fSBUaGUgYXVkaW8gc3RyZWFtIGZvcm1hdCBiZWluZyBjcmVhdGVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBnZXRXYXZlRm9ybWF0UENNKHNhbXBsZXNQZXJTZWNvbmQsIGJpdHNQZXJTYW1wbGUsIGNoYW5uZWxzKSB7XG4gICAgICAgIHJldHVybiBuZXcgQXVkaW9TdHJlYW1Gb3JtYXRJbXBsKHNhbXBsZXNQZXJTZWNvbmQsIGJpdHNQZXJTYW1wbGUsIGNoYW5uZWxzKTtcbiAgICB9XG59XG4vKipcbiAqIEBwcml2YXRlXG4gKiBAY2xhc3MgQXVkaW9TdHJlYW1Gb3JtYXRJbXBsXG4gKi9cbmV4cG9ydCBjbGFzcyBBdWRpb1N0cmVhbUZvcm1hdEltcGwgZXh0ZW5kcyBBdWRpb1N0cmVhbUZvcm1hdCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSB3aXRoIHRoZSBnaXZlbiB2YWx1ZXMuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHNhbXBsZXNQZXJTZWMgLSBTYW1wbGVzIHBlciBzZWNvbmQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGJpdHNQZXJTYW1wbGUgLSBCaXRzIHBlciBzYW1wbGUuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGNoYW5uZWxzIC0gTnVtYmVyIG9mIGNoYW5uZWxzLlxuICAgICAqIEBwYXJhbSB7QXVkaW9Gb3JtYXRUYWd9IGZvcm1hdCAtIEF1ZGlvIGZvcm1hdCAoUENNLCBhbGF3IG9yIG11bGF3KS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihzYW1wbGVzUGVyU2VjID0gMTYwMDAsIGJpdHNQZXJTYW1wbGUgPSAxNiwgY2hhbm5lbHMgPSAxLCBmb3JtYXQgPSBBdWRpb0Zvcm1hdFRhZy5QQ00pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgbGV0IGlzV2F2Rm9ybWF0ID0gdHJ1ZTtcbiAgICAgICAgLyogMSBmb3IgUENNOyA2IGZvciBhbGF3OyA3IGZvciBtdWxhdyAqL1xuICAgICAgICBzd2l0Y2ggKGZvcm1hdCkge1xuICAgICAgICAgICAgY2FzZSBBdWRpb0Zvcm1hdFRhZy5QQ006XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtYXRUYWcgPSAxO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBBdWRpb0Zvcm1hdFRhZy5BTGF3OlxuICAgICAgICAgICAgICAgIHRoaXMuZm9ybWF0VGFnID0gNjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgQXVkaW9Gb3JtYXRUYWcuTXVMYXc6XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtYXRUYWcgPSA3O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBpc1dhdkZvcm1hdCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYml0c1BlclNhbXBsZSA9IGJpdHNQZXJTYW1wbGU7XG4gICAgICAgIHRoaXMuc2FtcGxlc1BlclNlYyA9IHNhbXBsZXNQZXJTZWM7XG4gICAgICAgIHRoaXMuY2hhbm5lbHMgPSBjaGFubmVscztcbiAgICAgICAgdGhpcy5hdmdCeXRlc1BlclNlYyA9IHRoaXMuc2FtcGxlc1BlclNlYyAqIHRoaXMuY2hhbm5lbHMgKiAodGhpcy5iaXRzUGVyU2FtcGxlIC8gOCk7XG4gICAgICAgIHRoaXMuYmxvY2tBbGlnbiA9IHRoaXMuY2hhbm5lbHMgKiBNYXRoLm1heCh0aGlzLmJpdHNQZXJTYW1wbGUsIDgpO1xuICAgICAgICBpZiAoaXNXYXZGb3JtYXQpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkhlYWRlciA9IG5ldyBBcnJheUJ1ZmZlcig0NCk7XG4gICAgICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9EYXRhVmlld1xuICAgICAgICAgICAgY29uc3QgdmlldyA9IG5ldyBEYXRhVmlldyh0aGlzLnByaXZIZWFkZXIpO1xuICAgICAgICAgICAgLyogUklGRiBpZGVudGlmaWVyICovXG4gICAgICAgICAgICB0aGlzLnNldFN0cmluZyh2aWV3LCAwLCBcIlJJRkZcIik7XG4gICAgICAgICAgICAvKiBmaWxlIGxlbmd0aCAqL1xuICAgICAgICAgICAgdmlldy5zZXRVaW50MzIoNCwgMCwgdHJ1ZSk7XG4gICAgICAgICAgICAvKiBSSUZGIHR5cGUgJiBGb3JtYXQgKi9cbiAgICAgICAgICAgIHRoaXMuc2V0U3RyaW5nKHZpZXcsIDgsIFwiV0FWRWZtdCBcIik7XG4gICAgICAgICAgICAvKiBmb3JtYXQgY2h1bmsgbGVuZ3RoICovXG4gICAgICAgICAgICB2aWV3LnNldFVpbnQzMigxNiwgMTYsIHRydWUpO1xuICAgICAgICAgICAgLyogYXVkaW8gZm9ybWF0ICovXG4gICAgICAgICAgICB2aWV3LnNldFVpbnQxNigyMCwgdGhpcy5mb3JtYXRUYWcsIHRydWUpO1xuICAgICAgICAgICAgLyogY2hhbm5lbCBjb3VudCAqL1xuICAgICAgICAgICAgdmlldy5zZXRVaW50MTYoMjIsIHRoaXMuY2hhbm5lbHMsIHRydWUpO1xuICAgICAgICAgICAgLyogc2FtcGxlIHJhdGUgKi9cbiAgICAgICAgICAgIHZpZXcuc2V0VWludDMyKDI0LCB0aGlzLnNhbXBsZXNQZXJTZWMsIHRydWUpO1xuICAgICAgICAgICAgLyogYnl0ZSByYXRlIChzYW1wbGUgcmF0ZSAqIGJsb2NrIGFsaWduKSAqL1xuICAgICAgICAgICAgdmlldy5zZXRVaW50MzIoMjgsIHRoaXMuYXZnQnl0ZXNQZXJTZWMsIHRydWUpO1xuICAgICAgICAgICAgLyogYmxvY2sgYWxpZ24gKGNoYW5uZWwgY291bnQgKiBieXRlcyBwZXIgc2FtcGxlKSAqL1xuICAgICAgICAgICAgdmlldy5zZXRVaW50MTYoMzIsIHRoaXMuY2hhbm5lbHMgKiAodGhpcy5iaXRzUGVyU2FtcGxlIC8gOCksIHRydWUpO1xuICAgICAgICAgICAgLyogYml0cyBwZXIgc2FtcGxlICovXG4gICAgICAgICAgICB2aWV3LnNldFVpbnQxNigzNCwgdGhpcy5iaXRzUGVyU2FtcGxlLCB0cnVlKTtcbiAgICAgICAgICAgIC8qIGRhdGEgY2h1bmsgaWRlbnRpZmllciAqL1xuICAgICAgICAgICAgdGhpcy5zZXRTdHJpbmcodmlldywgMzYsIFwiZGF0YVwiKTtcbiAgICAgICAgICAgIC8qIGRhdGEgY2h1bmsgbGVuZ3RoICovXG4gICAgICAgICAgICB2aWV3LnNldFVpbnQzMig0MCwgMCwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIHRoZSBkZWZhdWx0IGlucHV0IGZvcm1hdC5cbiAgICAgKiBAbWVtYmVyIEF1ZGlvU3RyZWFtRm9ybWF0SW1wbC5nZXREZWZhdWx0SW5wdXRGb3JtYXRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge0F1ZGlvU3RyZWFtRm9ybWF0SW1wbH0gVGhlIGRlZmF1bHQgaW5wdXQgZm9ybWF0LlxuICAgICAqL1xuICAgIHN0YXRpYyBnZXREZWZhdWx0SW5wdXRGb3JtYXQoKSB7XG4gICAgICAgIHJldHVybiBuZXcgQXVkaW9TdHJlYW1Gb3JtYXRJbXBsKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gYXVkaW8gY29udGV4dCBhcHByb3ByaWF0ZSB0byBjdXJyZW50IGJyb3dzZXJcbiAgICAgKiBAbWVtYmVyIEF1ZGlvU3RyZWFtRm9ybWF0SW1wbC5nZXRBdWRpb0NvbnRleHRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge0F1ZGlvQ29udGV4dH0gQW4gYXVkaW8gY29udGV4dCBpbnN0YW5jZVxuICAgICAqL1xuICAgIC8qIGVzbGludC1kaXNhYmxlICovXG4gICAgc3RhdGljIGdldEF1ZGlvQ29udGV4dChzYW1wbGVSYXRlKSB7XG4gICAgICAgIC8vIFdvcmthcm91bmQgZm9yIFNwZWVjaCBTREsgYnVnIGluIFNhZmFyaS5cbiAgICAgICAgY29uc3QgQXVkaW9Db250ZXh0ID0gd2luZG93LkF1ZGlvQ29udGV4dCAvLyBvdXIgcHJlZmVycmVkIGltcGxcbiAgICAgICAgICAgIHx8IHdpbmRvdy53ZWJraXRBdWRpb0NvbnRleHQgLy8gZmFsbGJhY2ssIG1vc3RseSB3aGVuIG9uIFNhZmFyaVxuICAgICAgICAgICAgfHwgZmFsc2U7IC8vIGNvdWxkIG5vdCBmaW5kLlxuICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvQXVkaW9Db250ZXh0XG4gICAgICAgIGlmICghIUF1ZGlvQ29udGV4dCkge1xuICAgICAgICAgICAgaWYgKHNhbXBsZVJhdGUgIT09IHVuZGVmaW5lZCAmJiBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFN1cHBvcnRlZENvbnN0cmFpbnRzKCkuc2FtcGxlUmF0ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9Db250ZXh0KHsgc2FtcGxlUmF0ZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9Db250ZXh0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJCcm93c2VyIGRvZXMgbm90IHN1cHBvcnQgV2ViIEF1ZGlvIEFQSSAoQXVkaW9Db250ZXh0IGlzIG5vdCBhdmFpbGFibGUpLlwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKiBlc2xpbnQtZW5hYmxlICovXG4gICAgLyoqXG4gICAgICogQ2xvc2VzIHRoZSBjb25maWd1cmF0aW9uIG9iamVjdC5cbiAgICAgKiBAbWVtYmVyIEF1ZGlvU3RyZWFtRm9ybWF0SW1wbC5wcm90b3R5cGUuY2xvc2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZ2V0IGhlYWRlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkhlYWRlcjtcbiAgICB9XG4gICAgc2V0U3RyaW5nKHZpZXcsIG9mZnNldCwgc3RyKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2aWV3LnNldFVpbnQ4KG9mZnNldCArIGksIHN0ci5jaGFyQ29kZUF0KGkpKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QXVkaW9TdHJlYW1Gb3JtYXQuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgSW52YWxpZE9wZXJhdGlvbkVycm9yIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9FcnJvclwiO1xuaW1wb3J0IHsgQXVkaW9TdHJlYW1Gb3JtYXQgfSBmcm9tIFwiLi4vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQXVkaW9TdHJlYW1Gb3JtYXRJbXBsIH0gZnJvbSBcIi4vQXVkaW9TdHJlYW1Gb3JtYXRcIjtcbi8qKlxuICogQmFzZSBhdWRpbyBwbGF5ZXIgY2xhc3NcbiAqIFRPRE86IFBsYXlzIG9ubHkgUENNIGZvciBub3cuXG4gKiBAY2xhc3NcbiAqL1xuZXhwb3J0IGNsYXNzIEJhc2VBdWRpb1BsYXllciB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge0F1ZGlvU3RyZWFtRm9ybWF0fSBhdWRpb0Zvcm1hdCBhdWRpbyBzdHJlYW0gZm9ybWF0IHJlY29nbml6ZWQgYnkgdGhlIHBsYXllci5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihhdWRpb0Zvcm1hdCkge1xuICAgICAgICB0aGlzLmF1ZGlvQ29udGV4dCA9IG51bGw7XG4gICAgICAgIHRoaXMuZ2Fpbk5vZGUgPSBudWxsO1xuICAgICAgICB0aGlzLmF1dG9VcGRhdGVCdWZmZXJUaW1lciA9IDA7XG4gICAgICAgIGlmIChhdWRpb0Zvcm1hdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBhdWRpb0Zvcm1hdCA9IEF1ZGlvU3RyZWFtRm9ybWF0LmdldERlZmF1bHRJbnB1dEZvcm1hdCgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW5pdChhdWRpb0Zvcm1hdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIHBsYXkgQXVkaW8gc2FtcGxlXG4gICAgICogQHBhcmFtIG5ld0F1ZGlvRGF0YSBhdWRpbyBkYXRhIHRvIGJlIHBsYXllZC5cbiAgICAgKi9cbiAgICBwbGF5QXVkaW9TYW1wbGUobmV3QXVkaW9EYXRhLCBjYiwgZXJyKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLmVuc3VyZUluaXRpYWxpemVkQ29udGV4dCgpO1xuICAgICAgICAgICAgY29uc3QgYXVkaW9EYXRhID0gdGhpcy5mb3JtYXRBdWRpb0RhdGEobmV3QXVkaW9EYXRhKTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1NhbXBsZXNEYXRhID0gbmV3IEZsb2F0MzJBcnJheSh0aGlzLnNhbXBsZXMubGVuZ3RoICsgYXVkaW9EYXRhLmxlbmd0aCk7XG4gICAgICAgICAgICBuZXdTYW1wbGVzRGF0YS5zZXQodGhpcy5zYW1wbGVzLCAwKTtcbiAgICAgICAgICAgIG5ld1NhbXBsZXNEYXRhLnNldChhdWRpb0RhdGEsIHRoaXMuc2FtcGxlcy5sZW5ndGgpO1xuICAgICAgICAgICAgdGhpcy5zYW1wbGVzID0gbmV3U2FtcGxlc0RhdGE7XG4gICAgICAgICAgICBpZiAoISFjYikge1xuICAgICAgICAgICAgICAgIGNiKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgIGVycihlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBzdG9wcyBhdWRpbyBhbmQgY2xlYXJzIHRoZSBidWZmZXJzXG4gICAgICovXG4gICAgc3RvcEF1ZGlvKGNiLCBlcnIpIHtcbiAgICAgICAgaWYgKHRoaXMuYXVkaW9Db250ZXh0ICE9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLnNhbXBsZXMgPSBuZXcgRmxvYXQzMkFycmF5KCk7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1hcmd1bWVudFxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmF1dG9VcGRhdGVCdWZmZXJUaW1lcik7XG4gICAgICAgICAgICB0aGlzLmF1ZGlvQ29udGV4dC5jbG9zZSgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghIWNiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNiKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmF1ZGlvQ29udGV4dCA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaW5pdChhdWRpb0Zvcm1hdCkge1xuICAgICAgICB0aGlzLmF1ZGlvRm9ybWF0ID0gYXVkaW9Gb3JtYXQ7XG4gICAgICAgIHRoaXMuc2FtcGxlcyA9IG5ldyBGbG9hdDMyQXJyYXkoKTtcbiAgICB9XG4gICAgZW5zdXJlSW5pdGlhbGl6ZWRDb250ZXh0KCkge1xuICAgICAgICBpZiAodGhpcy5hdWRpb0NvbnRleHQgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlQXVkaW9Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCB0aW1lclBlcmlvZCA9IDIwMDtcbiAgICAgICAgICAgIHRoaXMuYXV0b1VwZGF0ZUJ1ZmZlclRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQXVkaW9CdWZmZXIoKTtcbiAgICAgICAgICAgIH0sIHRpbWVyUGVyaW9kKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjcmVhdGVBdWRpb0NvbnRleHQoKSB7XG4gICAgICAgIC8vIG5ldyAoKHdpbmRvdyBhcyBhbnkpLkF1ZGlvQ29udGV4dCB8fCAod2luZG93IGFzIGFueSkud2Via2l0QXVkaW9Db250ZXh0KSgpO1xuICAgICAgICB0aGlzLmF1ZGlvQ29udGV4dCA9IEF1ZGlvU3RyZWFtRm9ybWF0SW1wbC5nZXRBdWRpb0NvbnRleHQoKTtcbiAgICAgICAgLy8gVE9ETzogVmFyaW91cyBleGFtcGxlcyBzaG93cyB0aGlzIGdhaW4gbm9kZSwgaXQgZG9lcyBub3Qgc2VlbSB0byBiZSBuZWVkZWQgdW5sZXNzIHdlIHBsYW5cbiAgICAgICAgLy8gdG8gY29udHJvbCB0aGUgdm9sdW1lLCBub3QgbGlrZWx5XG4gICAgICAgIHRoaXMuZ2Fpbk5vZGUgPSB0aGlzLmF1ZGlvQ29udGV4dC5jcmVhdGVHYWluKCk7XG4gICAgICAgIHRoaXMuZ2Fpbk5vZGUuZ2Fpbi52YWx1ZSA9IDE7XG4gICAgICAgIHRoaXMuZ2Fpbk5vZGUuY29ubmVjdCh0aGlzLmF1ZGlvQ29udGV4dC5kZXN0aW5hdGlvbik7XG4gICAgICAgIHRoaXMuc3RhcnRUaW1lID0gdGhpcy5hdWRpb0NvbnRleHQuY3VycmVudFRpbWU7XG4gICAgfVxuICAgIGZvcm1hdEF1ZGlvRGF0YShhdWRpb0RhdGEpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLmF1ZGlvRm9ybWF0LmJpdHNQZXJTYW1wbGUpIHtcbiAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXRBcnJheUJ1ZmZlcihuZXcgSW50OEFycmF5KGF1ZGlvRGF0YSksIDEyOCk7XG4gICAgICAgICAgICBjYXNlIDE2OlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZvcm1hdEFycmF5QnVmZmVyKG5ldyBJbnQxNkFycmF5KGF1ZGlvRGF0YSksIDMyNzY4KTtcbiAgICAgICAgICAgIGNhc2UgMzI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0QXJyYXlCdWZmZXIobmV3IEludDMyQXJyYXkoYXVkaW9EYXRhKSwgMjE0NzQ4MzY0OCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXJyb3IoXCJPbmx5IFdBVkVfRk9STUFUX1BDTSAoOC8xNi8zMiBicHMpIGZvcm1hdCBzdXBwb3J0ZWQgYXQgdGhpcyB0aW1lXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZvcm1hdEFycmF5QnVmZmVyKGF1ZGlvRGF0YSwgbWF4VmFsdWUpIHtcbiAgICAgICAgY29uc3QgZmxvYXQzMkRhdGEgPSBuZXcgRmxvYXQzMkFycmF5KGF1ZGlvRGF0YS5sZW5ndGgpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGF1ZGlvRGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZmxvYXQzMkRhdGFbaV0gPSBhdWRpb0RhdGFbaV0gLyBtYXhWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmxvYXQzMkRhdGE7XG4gICAgfVxuICAgIHVwZGF0ZUF1ZGlvQnVmZmVyKCkge1xuICAgICAgICBpZiAodGhpcy5zYW1wbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNoYW5uZWxDb3VudCA9IHRoaXMuYXVkaW9Gb3JtYXQuY2hhbm5lbHM7XG4gICAgICAgIGNvbnN0IGJ1ZmZlclNvdXJjZSA9IHRoaXMuYXVkaW9Db250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO1xuICAgICAgICBjb25zdCBmcmFtZUNvdW50ID0gdGhpcy5zYW1wbGVzLmxlbmd0aCAvIGNoYW5uZWxDb3VudDtcbiAgICAgICAgY29uc3QgYXVkaW9CdWZmZXIgPSB0aGlzLmF1ZGlvQ29udGV4dC5jcmVhdGVCdWZmZXIoY2hhbm5lbENvdW50LCBmcmFtZUNvdW50LCB0aGlzLmF1ZGlvRm9ybWF0LnNhbXBsZXNQZXJTZWMpO1xuICAgICAgICAvLyBUT0RPOiBTaG91bGQgd2UgZG8gdGhlIGNvbnZlcnNpb24gaW4gdGhlIHB1c2hBdWRpb1NhbXBsZSBpbnN0ZWFkP1xuICAgICAgICBmb3IgKGxldCBjaGFubmVsID0gMDsgY2hhbm5lbCA8IGNoYW5uZWxDb3VudDsgY2hhbm5lbCsrKSB7XG4gICAgICAgICAgICAvLyBGaWxsIGluIGluZGl2aWR1YWwgY2hhbm5lbCBkYXRhXG4gICAgICAgICAgICBsZXQgY2hhbm5lbE9mZnNldCA9IGNoYW5uZWw7XG4gICAgICAgICAgICBjb25zdCBhdWRpb0RhdGEgPSBhdWRpb0J1ZmZlci5nZXRDaGFubmVsRGF0YShjaGFubmVsKTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5zYW1wbGVzLmxlbmd0aDsgaSsrLCBjaGFubmVsT2Zmc2V0ICs9IGNoYW5uZWxDb3VudCkge1xuICAgICAgICAgICAgICAgIGF1ZGlvRGF0YVtpXSA9IHRoaXMuc2FtcGxlc1tjaGFubmVsT2Zmc2V0XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zdGFydFRpbWUgPCB0aGlzLmF1ZGlvQ29udGV4dC5jdXJyZW50VGltZSkge1xuICAgICAgICAgICAgdGhpcy5zdGFydFRpbWUgPSB0aGlzLmF1ZGlvQ29udGV4dC5jdXJyZW50VGltZTtcbiAgICAgICAgfVxuICAgICAgICBidWZmZXJTb3VyY2UuYnVmZmVyID0gYXVkaW9CdWZmZXI7XG4gICAgICAgIGJ1ZmZlclNvdXJjZS5jb25uZWN0KHRoaXMuZ2Fpbk5vZGUpO1xuICAgICAgICBidWZmZXJTb3VyY2Uuc3RhcnQodGhpcy5zdGFydFRpbWUpO1xuICAgICAgICAvLyBNYWtlIHN1cmUgd2UgcGxheSB0aGUgbmV4dCBzYW1wbGUgYWZ0ZXIgdGhlIGN1cnJlbnQgb25lLlxuICAgICAgICB0aGlzLnN0YXJ0VGltZSArPSBhdWRpb0J1ZmZlci5kdXJhdGlvbjtcbiAgICAgICAgLy8gQ2xlYXIgdGhlIHNhbXBsZXMgZm9yIHRoZSBuZXh0IHB1c2hlZCBkYXRhLlxuICAgICAgICB0aGlzLnNhbXBsZXMgPSBuZXcgRmxvYXQzMkFycmF5KCk7XG4gICAgfVxuICAgIHBsYXlBdWRpbyhhdWRpb0RhdGEpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmF1ZGlvQ29udGV4dCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlQXVkaW9Db250ZXh0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBzb3VyY2UgPSB0aGlzLmF1ZGlvQ29udGV4dC5jcmVhdGVCdWZmZXJTb3VyY2UoKTtcbiAgICAgICAgICAgIGNvbnN0IGRlc3RpbmF0aW9uID0gdGhpcy5hdWRpb0NvbnRleHQuZGVzdGluYXRpb247XG4gICAgICAgICAgICB5aWVsZCB0aGlzLmF1ZGlvQ29udGV4dC5kZWNvZGVBdWRpb0RhdGEoYXVkaW9EYXRhLCAobmV3QnVmZmVyKSA9PiB7XG4gICAgICAgICAgICAgICAgc291cmNlLmJ1ZmZlciA9IG5ld0J1ZmZlcjtcbiAgICAgICAgICAgICAgICBzb3VyY2UuY29ubmVjdChkZXN0aW5hdGlvbik7XG4gICAgICAgICAgICAgICAgc291cmNlLnN0YXJ0KDApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QmFzZUF1ZGlvUGxheWVyLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIEFuIGFic3RyYWN0IGJhc2UgY2xhc3MgdGhhdCBkZWZpbmVzIGNhbGxiYWNrIG1ldGhvZHMgKHJlYWQoKSBhbmQgY2xvc2UoKSkgZm9yXG4gKiBjdXN0b20gYXVkaW8gaW5wdXQgc3RyZWFtcykuXG4gKiBAY2xhc3MgUHVsbEF1ZGlvSW5wdXRTdHJlYW1DYWxsYmFja1xuICovXG5leHBvcnQgY2xhc3MgUHVsbEF1ZGlvSW5wdXRTdHJlYW1DYWxsYmFjayB7XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVB1bGxBdWRpb0lucHV0U3RyZWFtQ2FsbGJhY2suanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogQW4gYWJzdHJhY3QgYmFzZSBjbGFzcyB0aGF0IGRlZmluZXMgY2FsbGJhY2sgbWV0aG9kcyAod3JpdGUoKSBhbmQgY2xvc2UoKSkgZm9yXG4gKiBjdXN0b20gYXVkaW8gb3V0cHV0IHN0cmVhbXMpLlxuICogQGNsYXNzIFB1c2hBdWRpb091dHB1dFN0cmVhbUNhbGxiYWNrXG4gKi9cbmV4cG9ydCBjbGFzcyBQdXNoQXVkaW9PdXRwdXRTdHJlYW1DYWxsYmFjayB7XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVB1c2hBdWRpb091dHB1dFN0cmVhbUNhbGxiYWNrLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCB7IFN5bnRoZXNpc0FkYXB0ZXJCYXNlIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQmFja2dyb3VuZEV2ZW50LCBjcmVhdGVOb0Rhc2hHdWlkLCBFdmVudHMgfSBmcm9tIFwiLi4vLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IFB1bGxBdWRpb091dHB1dFN0cmVhbUltcGwgfSBmcm9tIFwiLi9BdWRpb091dHB1dFN0cmVhbVwiO1xuaW1wb3J0IHsgQXVkaW9Gb3JtYXRUYWcgfSBmcm9tIFwiLi9BdWRpb1N0cmVhbUZvcm1hdFwiO1xuY29uc3QgTWVkaWFEdXJhdGlvblBsYWNlaG9sZGVyU2Vjb25kcyA9IDYwICogMzA7XG5jb25zdCBBdWRpb0Zvcm1hdFRvTWltZVR5cGUgPSB7XG4gICAgW0F1ZGlvRm9ybWF0VGFnLlBDTV06IFwiYXVkaW8vd2F2XCIsXG4gICAgW0F1ZGlvRm9ybWF0VGFnLk11TGF3XTogXCJhdWRpby94LXdhdlwiLFxuICAgIFtBdWRpb0Zvcm1hdFRhZy5NUDNdOiBcImF1ZGlvL21wZWdcIixcbiAgICBbQXVkaW9Gb3JtYXRUYWcuT0dHX09QVVNdOiBcImF1ZGlvL29nZ1wiLFxuICAgIFtBdWRpb0Zvcm1hdFRhZy5XRUJNX09QVVNdOiBcImF1ZGlvL3dlYm07IGNvZGVjcz1vcHVzXCIsXG4gICAgW0F1ZGlvRm9ybWF0VGFnLkFMYXddOiBcImF1ZGlvL3gtd2F2XCIsXG4gICAgW0F1ZGlvRm9ybWF0VGFnLkZMQUNdOiBcImF1ZGlvL2ZsYWNcIixcbn07XG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIHNwZWFrZXIgcGxheWJhY2sgYXVkaW8gZGVzdGluYXRpb24sIHdoaWNoIG9ubHkgd29ya3MgaW4gYnJvd3Nlci5cbiAqIE5vdGU6IHRoZSBTREsgd2lsbCB0cnkgdG8gdXNlIDxhIGhyZWY9XCJodHRwczovL3d3dy53My5vcmcvVFIvbWVkaWEtc291cmNlL1wiPk1lZGlhIFNvdXJjZSBFeHRlbnNpb25zPC9hPiB0byBwbGF5IGF1ZGlvLlxuICogTXAzIGZvcm1hdCBoYXMgYmV0dGVyIHN1cHBvcnRzIG9uIE1pY3Jvc29mdCBFZGdlLCBDaHJvbWUgYW5kIFNhZmFyaSAoZGVza3RvcCksIHNvLCBpdCdzIGJldHRlciB0byBzcGVjaWZ5IG1wMyBmb3JtYXQgZm9yIHBsYXliYWNrLlxuICogQGNsYXNzIFNwZWFrZXJBdWRpb0Rlc3RpbmF0aW9uXG4gKiBVcGRhdGVkIGluIHZlcnNpb24gMS4xNy4wXG4gKi9cbmV4cG9ydCBjbGFzcyBTcGVha2VyQXVkaW9EZXN0aW5hdGlvbiB7XG4gICAgY29uc3RydWN0b3IoYXVkaW9EZXN0aW5hdGlvbklkKSB7XG4gICAgICAgIHRoaXMucHJpdlBsYXliYWNrU3RhcnRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZBcHBlbmRpbmdUb0J1ZmZlciA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZNZWRpYVNvdXJjZU9wZW5lZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZCeXRlc1JlY2VpdmVkID0gMDtcbiAgICAgICAgdGhpcy5wcml2SWQgPSBhdWRpb0Rlc3RpbmF0aW9uSWQgPyBhdWRpb0Rlc3RpbmF0aW9uSWQgOiBjcmVhdGVOb0Rhc2hHdWlkKCk7XG4gICAgICAgIHRoaXMucHJpdklzUGF1c2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdklzQ2xvc2VkID0gZmFsc2U7XG4gICAgfVxuICAgIGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SWQ7XG4gICAgfVxuICAgIHdyaXRlKGJ1ZmZlciwgY2IsIGVycikge1xuICAgICAgICBpZiAodGhpcy5wcml2QXVkaW9CdWZmZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5wcml2QXVkaW9CdWZmZXIucHVzaChidWZmZXIpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTb3VyY2VCdWZmZXIoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoISFjYikge1xuICAgICAgICAgICAgICAgICAgICBjYigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgICAgICBlcnIoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMucHJpdkF1ZGlvT3V0cHV0U3RyZWFtICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvT3V0cHV0U3RyZWFtLndyaXRlKGJ1ZmZlcik7XG4gICAgICAgICAgICB0aGlzLnByaXZCeXRlc1JlY2VpdmVkICs9IGJ1ZmZlci5ieXRlTGVuZ3RoO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNsb3NlKGNiLCBlcnIpIHtcbiAgICAgICAgdGhpcy5wcml2SXNDbG9zZWQgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5wcml2U291cmNlQnVmZmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlU291cmNlQnVmZmVyVXBkYXRlRW5kKCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCEhY2IpIHtcbiAgICAgICAgICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoISFlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnByaXZBdWRpb091dHB1dFN0cmVhbSAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIGlmICgodGhpcy5wcml2Rm9ybWF0LmZvcm1hdFRhZyA9PT0gQXVkaW9Gb3JtYXRUYWcuUENNIHx8IHRoaXMucHJpdkZvcm1hdC5mb3JtYXRUYWcgPT09IEF1ZGlvRm9ybWF0VGFnLk11TGF3XG4gICAgICAgICAgICAgICAgfHwgdGhpcy5wcml2Rm9ybWF0LmZvcm1hdFRhZyA9PT0gQXVkaW9Gb3JtYXRUYWcuQUxhdykgJiYgdGhpcy5wcml2Rm9ybWF0Lmhhc0hlYWRlciA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIlBsYXkgYmFjayBpcyBub3Qgc3VwcG9ydGVkIGZvciByYXcgUENNLCBtdWxhdyBvciBhbGF3IGZvcm1hdCB3aXRob3V0IGhlYWRlci5cIik7XG4gICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5vbkF1ZGlvRW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25BdWRpb0VuZCh0aGlzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBsZXQgcmVjZWl2ZWRBdWRpbyA9IG5ldyBBcnJheUJ1ZmZlcih0aGlzLnByaXZCeXRlc1JlY2VpdmVkKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZBdWRpb091dHB1dFN0cmVhbS5yZWFkKHJlY2VpdmVkQXVkaW8pLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZWNlaXZlZEF1ZGlvID0gU3ludGhlc2lzQWRhcHRlckJhc2UuYWRkSGVhZGVyKHJlY2VpdmVkQXVkaW8sIHRoaXMucHJpdkZvcm1hdCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGF1ZGlvQmxvYiA9IG5ldyBCbG9iKFtyZWNlaXZlZEF1ZGlvXSwgeyB0eXBlOiBBdWRpb0Zvcm1hdFRvTWltZVR5cGVbdGhpcy5wcml2Rm9ybWF0LmZvcm1hdFRhZ10gfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvLnNyYyA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGF1ZGlvQmxvYik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5UGxheWJhY2soKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIWNiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISFlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnIoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9LCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnIoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyB1bnN1cHBvcnRlZCBmb3JtYXQsIGNhbGwgb25BdWRpb0VuZCBkaXJlY3RseS5cbiAgICAgICAgICAgIGlmICghIXRoaXMub25BdWRpb0VuZCkge1xuICAgICAgICAgICAgICAgIHRoaXMub25BdWRpb0VuZCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXQgZm9ybWF0KGZvcm1hdCkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1tZW1iZXItYWNjZXNzXG4gICAgICAgIGlmICh0eXBlb2YgKEF1ZGlvQ29udGV4dCkgIT09IFwidW5kZWZpbmVkXCIgfHwgKHR5cGVvZiAod2luZG93KSAhPT0gXCJ1bmRlZmluZWRcIiAmJiB0eXBlb2YgKHdpbmRvdy53ZWJraXRBdWRpb0NvbnRleHQpICE9PSBcInVuZGVmaW5lZFwiKSkge1xuICAgICAgICAgICAgdGhpcy5wcml2Rm9ybWF0ID0gZm9ybWF0O1xuICAgICAgICAgICAgY29uc3QgbWltZVR5cGUgPSBBdWRpb0Zvcm1hdFRvTWltZVR5cGVbdGhpcy5wcml2Rm9ybWF0LmZvcm1hdFRhZ107XG4gICAgICAgICAgICBpZiAobWltZVR5cGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBVbmtub3duIG1pbWVUeXBlIGZvciBmb3JtYXQgJHtBdWRpb0Zvcm1hdFRhZ1t0aGlzLnByaXZGb3JtYXQuZm9ybWF0VGFnXX07IHBsYXliYWNrIGlzIG5vdCBzdXBwb3J0ZWQuYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgKE1lZGlhU291cmNlKSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBNZWRpYVNvdXJjZS5pc1R5cGVTdXBwb3J0ZWQobWltZVR5cGUpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2QXVkaW8gPSBuZXcgQXVkaW8oKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZBdWRpb0J1ZmZlciA9IFtdO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdk1lZGlhU291cmNlID0gbmV3IE1lZGlhU291cmNlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2QXVkaW8uc3JjID0gVVJMLmNyZWF0ZU9iamVjdFVSTCh0aGlzLnByaXZNZWRpYVNvdXJjZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2QXVkaW8ubG9hZCgpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdk1lZGlhU291cmNlLm9uc291cmNlb3BlbiA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2TWVkaWFTb3VyY2VPcGVuZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZNZWRpYVNvdXJjZS5kdXJhdGlvbiA9IE1lZGlhRHVyYXRpb25QbGFjZWhvbGRlclNlY29uZHM7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlNvdXJjZUJ1ZmZlciA9IHRoaXMucHJpdk1lZGlhU291cmNlLmFkZFNvdXJjZUJ1ZmZlcihtaW1lVHlwZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlNvdXJjZUJ1ZmZlci5vbnVwZGF0ZSA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU291cmNlQnVmZmVyKCkuY2F0Y2goKHJlYXNvbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50cy5pbnN0YW5jZS5vbkV2ZW50KG5ldyBCYWNrZ3JvdW5kRXZlbnQocmVhc29uKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U291cmNlQnVmZmVyLm9udXBkYXRlZW5kID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVTb3VyY2VCdWZmZXJVcGRhdGVFbmQoKS5jYXRjaCgocmVhc29uKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnRzLmluc3RhbmNlLm9uRXZlbnQobmV3IEJhY2tncm91bmRFdmVudChyZWFzb24pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTb3VyY2VCdWZmZXIub251cGRhdGVzdGFydCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkFwcGVuZGluZ1RvQnVmZmVyID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNvdXJjZUJ1ZmZlcigpLmNhdGNoKChyZWFzb24pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgRXZlbnRzLmluc3RhbmNlLm9uRXZlbnQobmV3IEJhY2tncm91bmRFdmVudChyZWFzb24pKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBGb3JtYXQgJHtBdWRpb0Zvcm1hdFRhZ1t0aGlzLnByaXZGb3JtYXQuZm9ybWF0VGFnXX0gY291bGQgbm90IGJlIHBsYXllZCBieSBNU0UsIHN0cmVhbWluZyBwbGF5YmFjayBpcyBub3QgZW5hYmxlZC5gKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZBdWRpb091dHB1dFN0cmVhbSA9IG5ldyBQdWxsQXVkaW9PdXRwdXRTdHJlYW1JbXBsKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2QXVkaW9PdXRwdXRTdHJlYW0uZm9ybWF0ID0gdGhpcy5wcml2Rm9ybWF0O1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvID0gbmV3IEF1ZGlvKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IHZvbHVtZSgpIHtcbiAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgcmV0dXJuIChfYiA9IChfYSA9IHRoaXMucHJpdkF1ZGlvKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Eudm9sdW1lKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiAtMTtcbiAgICB9XG4gICAgc2V0IHZvbHVtZSh2b2x1bWUpIHtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2QXVkaW8pIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvLnZvbHVtZSA9IHZvbHVtZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBtdXRlKCkge1xuICAgICAgICBpZiAoISF0aGlzLnByaXZBdWRpbykge1xuICAgICAgICAgICAgdGhpcy5wcml2QXVkaW8ubXV0ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHVubXV0ZSgpIHtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2QXVkaW8pIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvLm11dGVkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IGlzQ2xvc2VkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SXNDbG9zZWQ7XG4gICAgfVxuICAgIGdldCBjdXJyZW50VGltZSgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdkF1ZGlvICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpby5jdXJyZW50VGltZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIHBhdXNlKCkge1xuICAgICAgICBpZiAoIXRoaXMucHJpdklzUGF1c2VkICYmIHRoaXMucHJpdkF1ZGlvICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvLnBhdXNlKCk7XG4gICAgICAgICAgICB0aGlzLnByaXZJc1BhdXNlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVzdW1lKGNiLCBlcnIpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdklzUGF1c2VkICYmIHRoaXMucHJpdkF1ZGlvICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvLnBsYXkoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoISFjYikge1xuICAgICAgICAgICAgICAgICAgICBjYigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgICAgICBlcnIoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5wcml2SXNQYXVzZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgaW50ZXJuYWxBdWRpbygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvO1xuICAgIH1cbiAgICB1cGRhdGVTb3VyY2VCdWZmZXIoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2QXVkaW9CdWZmZXIgIT09IHVuZGVmaW5lZCAmJiAodGhpcy5wcml2QXVkaW9CdWZmZXIubGVuZ3RoID4gMCkgJiYgdGhpcy5zb3VyY2VCdWZmZXJBdmFpbGFibGUoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkFwcGVuZGluZ1RvQnVmZmVyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb25zdCBiaW5hcnkgPSB0aGlzLnByaXZBdWRpb0J1ZmZlci5zaGlmdCgpO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlNvdXJjZUJ1ZmZlci5hcHBlbmRCdWZmZXIoYmluYXJ5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvQnVmZmVyLnVuc2hpZnQoYmluYXJ5KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJidWZmZXIgZmlsbGVkLCBwYXVzaW5nIGFkZGl0aW9uIG9mIGJpbmFyaWVzIHVudGlsIHNwYWNlIGlzIG1hZGVcIik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5ub3RpZnlQbGF5YmFjaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5jYW5FbmRTdHJlYW0oKSkge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuaGFuZGxlU291cmNlQnVmZmVyVXBkYXRlRW5kKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBoYW5kbGVTb3VyY2VCdWZmZXJVcGRhdGVFbmQoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jYW5FbmRTdHJlYW0oKSAmJiB0aGlzLnNvdXJjZUJ1ZmZlckF2YWlsYWJsZSgpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2TWVkaWFTb3VyY2UuZW5kT2ZTdHJlYW0oKTtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLm5vdGlmeVBsYXliYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBub3RpZnlQbGF5YmFjaygpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wcml2UGxheWJhY2tTdGFydGVkICYmIHRoaXMucHJpdkF1ZGlvICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZQbGF5YmFja1N0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmICghIXRoaXMub25BdWRpb1N0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25BdWRpb1N0YXJ0KHRoaXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnByaXZBdWRpby5vbmVuZGVkID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLm9uQXVkaW9FbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25BdWRpb0VuZCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZJc1BhdXNlZCkge1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZBdWRpby5wbGF5KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgY2FuRW5kU3RyZWFtKCkge1xuICAgICAgICByZXR1cm4gKHRoaXMuaXNDbG9zZWQgJiYgdGhpcy5wcml2U291cmNlQnVmZmVyICE9PSB1bmRlZmluZWQgJiYgKHRoaXMucHJpdkF1ZGlvQnVmZmVyLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgICYmIHRoaXMucHJpdk1lZGlhU291cmNlT3BlbmVkICYmICF0aGlzLnByaXZBcHBlbmRpbmdUb0J1ZmZlciAmJiB0aGlzLnByaXZNZWRpYVNvdXJjZS5yZWFkeVN0YXRlID09PSBcIm9wZW5cIik7XG4gICAgfVxuICAgIHNvdXJjZUJ1ZmZlckF2YWlsYWJsZSgpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLnByaXZTb3VyY2VCdWZmZXIgIT09IHVuZGVmaW5lZCAmJiAhdGhpcy5wcml2U291cmNlQnVmZmVyLnVwZGF0aW5nKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWFrZXJBdWRpb0Rlc3RpbmF0aW9uLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VzT3BlblJhbmdlT3B0aW9uTmFtZSB9IGZyb20gXCIuLi9jb21tb24uc3BlZWNoL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuL0NvbnRyYWN0c1wiO1xuaW1wb3J0IHsgUHJvcGVydHlDb2xsZWN0aW9uLCBQcm9wZXJ0eUlkLCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbmltcG9ydCB7IExhbmd1YWdlSWRNb2RlIH0gZnJvbSBcIi4vTGFuZ3VhZ2VJZE1vZGVcIjtcbi8qKlxuICogTGFuZ3VhZ2UgYXV0byBkZXRlY3QgY29uZmlndXJhdGlvbi5cbiAqIEBjbGFzcyBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWdcbiAqIEFkZGVkIGluIHZlcnNpb24gMS4xMy4wLlxuICovXG5leHBvcnQgY2xhc3MgQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcyA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0xhbmd1YWdlSWRNb2RlLCBcIkF0U3RhcnRcIik7XG4gICAgICAgIHRoaXMucHJpdkxhbmd1YWdlSWRNb2RlID0gTGFuZ3VhZ2VJZE1vZGUuQXRTdGFydDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQG1lbWJlciBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWcuZnJvbU9wZW5SYW5nZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBPbmx5IFtbU3BlZWNoU3ludGhlc2l6ZXJdXSBzdXBwb3J0cyBzb3VyY2UgbGFuZ3VhZ2UgYXV0byBkZXRlY3Rpb24gZnJvbSBvcGVuIHJhbmdlLFxuICAgICAqIGZvciBbW1JlY29nbml6ZXJdXSwgcGxlYXNlIHVzZSBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWcgd2l0aCBzcGVjaWZpYyBzb3VyY2UgbGFuZ3VhZ2VzLlxuICAgICAqIEByZXR1cm4ge0F1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZ30gSW5zdGFuY2Ugb2YgQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnXG4gICAgICogQHN1bW1hcnkgQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiB0aGUgQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnIHdpdGggb3BlbiByYW5nZS5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbU9wZW5SYW5nZSgpIHtcbiAgICAgICAgY29uc3QgY29uZmlnID0gbmV3IEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZygpO1xuICAgICAgICBjb25maWcucHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0F1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXMsIEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXNPcGVuUmFuZ2VPcHRpb25OYW1lKTtcbiAgICAgICAgcmV0dXJuIGNvbmZpZztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQG1lbWJlciBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWcuZnJvbUxhbmd1YWdlc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBsYW5ndWFnZXMgQ29tbWEtc2VwYXJhdGVkIHN0cmluZyBvZiBsYW5ndWFnZXMgKGVnLiBcImVuLVVTLGZyLUZSXCIpIHRvIHBvcHVsYXRlIHByb3BlcnRpZXMgb2YgY29uZmlnLlxuICAgICAqIEByZXR1cm4ge0F1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZ30gSW5zdGFuY2Ugb2YgQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnXG4gICAgICogQHN1bW1hcnkgQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiB0aGUgQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnIHdpdGggZ2l2ZW4gbGFuZ3VhZ2VzLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tTGFuZ3VhZ2VzKGxhbmd1YWdlcykge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZkFycmF5RW1wdHlPcldoaXRlc3BhY2UobGFuZ3VhZ2VzLCBcImxhbmd1YWdlc1wiKTtcbiAgICAgICAgY29uc3QgY29uZmlnID0gbmV3IEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZygpO1xuICAgICAgICBjb25maWcucHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0F1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXMsIGxhbmd1YWdlcy5qb2luKCkpO1xuICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAbWVtYmVyIEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZy5mcm9tU291cmNlTGFuZ3VhZ2VDb25maWdzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7U291cmNlTGFuZ3VhZ2VDb25maWdbXX0gY29uZmlncyBTb3VyY2VMYW5ndWFnZUNvbmZpZ3MgdG8gcG9wdWxhdGUgcHJvcGVydGllcyBvZiBjb25maWcuXG4gICAgICogQHJldHVybiB7QXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnfSBJbnN0YW5jZSBvZiBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWdcbiAgICAgKiBAc3VtbWFyeSBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIHRoZSBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWcgd2l0aCBnaXZlbiBTb3VyY2VMYW5ndWFnZUNvbmZpZ3MuXG4gICAgICovXG4gICAgc3RhdGljIGZyb21Tb3VyY2VMYW5ndWFnZUNvbmZpZ3MoY29uZmlncykge1xuICAgICAgICBpZiAoY29uZmlncy5sZW5ndGggPCAxKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFeHBlY3RlZCBub24tZW1wdHkgU291cmNlTGFuZ3VhZ2VDb25maWcgYXJyYXkuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGF1dG9Db25maWcgPSBuZXcgQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnKCk7XG4gICAgICAgIGNvbnN0IGxhbmdzID0gW107XG4gICAgICAgIGNvbmZpZ3MuZm9yRWFjaCgoY29uZmlnKSA9PiB7XG4gICAgICAgICAgICBsYW5ncy5wdXNoKGNvbmZpZy5sYW5ndWFnZSk7XG4gICAgICAgICAgICBpZiAoY29uZmlnLmVuZHBvaW50SWQgIT09IHVuZGVmaW5lZCAmJiBjb25maWcuZW5kcG9pbnRJZCAhPT0gXCJcIikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1c3RvbVByb3BlcnR5ID0gY29uZmlnLmxhbmd1YWdlICsgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludElkLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgYXV0b0NvbmZpZy5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KGN1c3RvbVByb3BlcnR5LCBjb25maWcuZW5kcG9pbnRJZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBhdXRvQ29uZmlnLnByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9BdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VzLCBsYW5ncy5qb2luKCkpO1xuICAgICAgICByZXR1cm4gYXV0b0NvbmZpZztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQG1lbWJlciBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWcucHJvdG90eXBlLnByb3BlcnRpZXNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybiB7UHJvcGVydHlDb2xsZWN0aW9ufSBQcm9wZXJ0aWVzIG9mIHRoZSBjb25maWcuXG4gICAgICogQHN1bW1hcnkgR2V0cyBhbiBhdXRvIGRldGVjdGVkIGxhbmd1YWdlIGNvbmZpZyBwcm9wZXJ0aWVzXG4gICAgICovXG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAbWVtYmVyIEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZy5wcm90b3R5cGUubW9kZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge0xhbmd1YWdlSWRNb2RlfSBtb2RlIExJRCBtb2RlIGRlc2lyZWQuXG4gICAgICogQHN1bW1hcnkgU2V0cyBMSUQgb3BlcmF0aW9uIHRvIGRlc2lyZWQgbW9kZVxuICAgICAqL1xuICAgIHNldCBtb2RlKG1vZGUpIHtcbiAgICAgICAgaWYgKG1vZGUgPT09IExhbmd1YWdlSWRNb2RlLkNvbnRpbnVvdXMpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvZ25pdGlvbkVuZHBvaW50VmVyc2lvbiwgXCIyXCIpO1xuICAgICAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0xhbmd1YWdlSWRNb2RlLCBcIkNvbnRpbnVvdXNcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7IC8vIExhbmd1YWdlSWRNb2RlLkF0U3RhcnRcbiAgICAgICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvZ25pdGlvbkVuZHBvaW50VmVyc2lvbiwgXCIxXCIpO1xuICAgICAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0xhbmd1YWdlSWRNb2RlLCBcIkF0U3RhcnRcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2TGFuZ3VhZ2VJZE1vZGUgPSBtb2RlO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi9Db250cmFjdHNcIjtcbi8qKlxuICogT3V0cHV0IGZvcm1hdFxuICogQGNsYXNzIEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZVJlc3VsdFxuICovXG5leHBvcnQgY2xhc3MgQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlUmVzdWx0IHtcbiAgICBjb25zdHJ1Y3RvcihsYW5ndWFnZSwgbGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKGxhbmd1YWdlLCBcImxhbmd1YWdlXCIpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChsYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UsIFwibGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlXCIpO1xuICAgICAgICB0aGlzLnByaXZMYW5ndWFnZSA9IGxhbmd1YWdlO1xuICAgICAgICB0aGlzLnByaXZMYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UgPSBsYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlUmVzdWx0IG9iamVjdCBmcm9tIGEgU3BlZWNoUmVjb2duaXRpb25SZXN1bHQgaW5zdGFuY2UuXG4gICAgICogQG1lbWJlciBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VSZXN1bHQuZnJvbVJlc3VsdFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge1NwZWVjaFJlY29nbml0aW9uUmVzdWx0fSByZXN1bHQgLSBUaGUgcmVjb2duaXRpb24gcmVzdWx0LlxuICAgICAqIEByZXR1cm5zIHtBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VSZXN1bHR9IEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZVJlc3VsdCBvYmplY3QgYmVpbmcgY3JlYXRlZC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbVJlc3VsdChyZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VSZXN1bHQocmVzdWx0Lmxhbmd1YWdlLCByZXN1bHQubGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlKTtcbiAgICB9XG4gICAgZ2V0IGxhbmd1YWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TGFuZ3VhZ2U7XG4gICAgfVxuICAgIGdldCBsYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZMYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2U7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1BdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VSZXN1bHQuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuL0NvbnRyYWN0c1wiO1xuaW1wb3J0IHsgRGlhbG9nU2VydmljZUNvbmZpZywgRGlhbG9nU2VydmljZUNvbmZpZ0ltcGwgfSBmcm9tIFwiLi9EaWFsb2dTZXJ2aWNlQ29uZmlnXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eUlkIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBDbGFzcyB0aGF0IGRlZmluZXMgY29uZmlndXJhdGlvbnMgZm9yIHRoZSBkaWFsb2cgc2VydmljZSBjb25uZWN0b3Igb2JqZWN0IGZvciB1c2luZyBhIEJvdCBGcmFtZXdvcmsgYmFja2VuZC5cbiAqIEBjbGFzcyBCb3RGcmFtZXdvcmtDb25maWdcbiAqL1xuZXhwb3J0IGNsYXNzIEJvdEZyYW1ld29ya0NvbmZpZyBleHRlbmRzIERpYWxvZ1NlcnZpY2VDb25maWdJbXBsIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIEJvdEZyYW1ld29ya0NvbmZpZy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGJvdCBmcmFtZXdvcmsgY29uZmlndXJhdGlvbiBpbnN0YW5jZSB3aXRoIHRoZSBwcm92aWRlZCBzdWJzY3JpcHRpb24gaW5mb3JtYXRpb24uXG4gICAgICogQG1lbWJlciBCb3RGcmFtZXdvcmtDb25maWcuZnJvbVN1YnNjcmlwdGlvblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0gc3Vic2NyaXB0aW9uIFN1YnNjcmlwdGlvbiBrZXkgYXNzb2NpYXRlZCB3aXRoIHRoZSBib3RcbiAgICAgKiBAcGFyYW0gcmVnaW9uIFRoZSByZWdpb24gbmFtZSAoc2VlIHRoZSA8YSBocmVmPVwiaHR0cHM6Ly9ha2EubXMvY3NzcGVlY2gvcmVnaW9uXCI+cmVnaW9uIHBhZ2U8L2E+KS5cbiAgICAgKiBAcGFyYW0gYm90SWQgT3B0aW9uYWwuIElkZW50aWZpZXIgZm9yIHVzaW5nIGEgc3BlY2lmaWMgYm90IHdpdGhpbiBhbiBBenVyZSByZXNvdXJjZSBncm91cC4gRXF1aXZhbGVudCB0byB0aGVcbiAgICAgKiByZXNvdXJjZSBuYW1lLlxuICAgICAqIEByZXR1cm5zIHtCb3RGcmFtZXdvcmtDb25maWd9IEEgbmV3IGJvdCBmcmFtZXdvcmsgY29uZmlndXJhdGlvbiBpbnN0YW5jZS5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbVN1YnNjcmlwdGlvbihzdWJzY3JpcHRpb24sIHJlZ2lvbiwgYm90SWQpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHN1YnNjcmlwdGlvbiwgXCJzdWJzY3JpcHRpb25cIik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShyZWdpb24sIFwicmVnaW9uXCIpO1xuICAgICAgICBjb25zdCBib3RGcmFtZXdvcmtDb25maWcgPSBuZXcgRGlhbG9nU2VydmljZUNvbmZpZ0ltcGwoKTtcbiAgICAgICAgYm90RnJhbWV3b3JrQ29uZmlnLnNldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uX0RpYWxvZ1R5cGUsIERpYWxvZ1NlcnZpY2VDb25maWcuRGlhbG9nVHlwZXMuQm90RnJhbWV3b3JrKTtcbiAgICAgICAgYm90RnJhbWV3b3JrQ29uZmlnLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fS2V5LCBzdWJzY3JpcHRpb24pO1xuICAgICAgICBib3RGcmFtZXdvcmtDb25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWdpb24sIHJlZ2lvbik7XG4gICAgICAgIGlmIChib3RJZCkge1xuICAgICAgICAgICAgYm90RnJhbWV3b3JrQ29uZmlnLnNldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uX0FwcGxpY2F0aW9uSWQsIGJvdElkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYm90RnJhbWV3b3JrQ29uZmlnO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgYm90IGZyYW1ld29yayBjb25maWd1cmF0aW9uIGluc3RhbmNlIGZvciB0aGUgc3BlY2lmaWVkIGF1dGhvcml6YXRpb24gdG9rZW4gYW5kIHJlZ2lvbi5cbiAgICAgKiBOb3RlOiBUaGUgY2FsbGVyIG11c3QgZW5zdXJlIHRoYXQgYW4gYXV0aG9yaXphdGlvbiB0b2tlbiBpcyB2YWxpZC4gQmVmb3JlIGFuIGF1dGhvcml6YXRpb24gdG9rZW4gZXhwaXJlcywgdGhlXG4gICAgICogY2FsbGVyIG11c3QgcmVmcmVzaCBpdCBieSBzZXR0aW5nIHRoZSBhdXRob3JpemF0aW9uVG9rZW4gcHJvcGVydHkgb24gdGhlIGNvcnJlc3BvbmRpbmdcbiAgICAgKiBEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yIGluc3RhbmNlIGNyZWF0ZWQgd2l0aCB0aGlzIGNvbmZpZy4gVGhlIGNvbnRlbnRzIG9mIGNvbmZpZ3VyYXRpb24gb2JqZWN0cyBhcmUgY29waWVkXG4gICAgICogd2hlbiBjb25uZWN0b3JzIGFyZSBjcmVhdGVkLCBzbyBzZXR0aW5nIGF1dGhvcml6YXRpb25Ub2tlbiBvbiBhIERpYWxvZ1NlcnZpY2VDb25uZWN0b3Igd2lsbCBub3QgdXBkYXRlIHRoZVxuICAgICAqIG9yaWdpbmFsIGNvbmZpZ3VyYXRpb24ncyBhdXRob3JpemF0aW9uIHRva2VuLiBDcmVhdGUgYSBuZXcgY29uZmlndXJhdGlvbiBpbnN0YW5jZSBvciBzZXQgdGhlXG4gICAgICogU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW4gcHJvcGVydHkgdG8gdXBkYXRlIGFuIGV4aXN0aW5nIGluc3RhbmNlIGlmIGl0IHdpbGwgYmUgdXNlZCB0byBjcmVhdGVcbiAgICAgKiBmdXJ0aGVyIERpYWxvZ1NlcnZpY2VDb25uZWN0b3JzLlxuICAgICAqIEBtZW1iZXIgQm90RnJhbWV3b3JrQ29uZmlnLmZyb21BdXRob3JpemF0aW9uVG9rZW5cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIGF1dGhvcml6YXRpb25Ub2tlbiBUaGUgYXV0aG9yaXphdGlvbiB0b2tlbiBhc3NvY2lhdGVkIHdpdGggdGhlIGJvdFxuICAgICAqIEBwYXJhbSByZWdpb24gVGhlIHJlZ2lvbiBuYW1lIChzZWUgdGhlIDxhIGhyZWY9XCJodHRwczovL2FrYS5tcy9jc3NwZWVjaC9yZWdpb25cIj5yZWdpb24gcGFnZTwvYT4pLlxuICAgICAqIEBwYXJhbSBib3RJZCBPcHRpb25hbC4gSWRlbnRpZmllciBmb3IgdXNpbmcgYSBzcGVjaWZpYyBib3Qgd2l0aGluIGFuIEF6dXJlIHJlc291cmNlIGdyb3VwLiBFcXVpdmFsZW50IHRvIHRoZVxuICAgICAqIHJlc291cmNlIG5hbWUuXG4gICAgICogQHJldHVybnMge0JvdEZyYW1ld29ya0NvbmZpZ30gQSBuZXcgYm90IGZyYW1ld29yayBjb25maWd1cmF0aW9uIGluc3RhbmNlLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tQXV0aG9yaXphdGlvblRva2VuKGF1dGhvcml6YXRpb25Ub2tlbiwgcmVnaW9uLCBib3RJZCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UoYXV0aG9yaXphdGlvblRva2VuLCBcImF1dGhvcml6YXRpb25Ub2tlblwiKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHJlZ2lvbiwgXCJyZWdpb25cIik7XG4gICAgICAgIGNvbnN0IGJvdEZyYW1ld29ya0NvbmZpZyA9IG5ldyBEaWFsb2dTZXJ2aWNlQ29uZmlnSW1wbCgpO1xuICAgICAgICBib3RGcmFtZXdvcmtDb25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25fRGlhbG9nVHlwZSwgRGlhbG9nU2VydmljZUNvbmZpZy5EaWFsb2dUeXBlcy5Cb3RGcmFtZXdvcmspO1xuICAgICAgICBib3RGcmFtZXdvcmtDb25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbiwgYXV0aG9yaXphdGlvblRva2VuKTtcbiAgICAgICAgYm90RnJhbWV3b3JrQ29uZmlnLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVnaW9uLCByZWdpb24pO1xuICAgICAgICBpZiAoYm90SWQpIHtcbiAgICAgICAgICAgIGJvdEZyYW1ld29ya0NvbmZpZy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvbl9BcHBsaWNhdGlvbklkLCBib3RJZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJvdEZyYW1ld29ya0NvbmZpZztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBhIEJvdEZyYW1ld29ya0NvbmZpZy5cbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBvbmx5IGZvciB1c2VycyB3aG8gdXNlIGEgbm9uLWRlZmF1bHQgc2VydmljZSBob3N0LiBUaGUgc3RhbmRhcmQgcmVzb3VyY2UgcGF0aCB3aWxsIGJlXG4gICAgICogYXNzdW1lZC4gRm9yIHNlcnZpY2VzIHdpdGggYSBub24tc3RhbmRhcmQgcmVzb3VyY2UgcGF0aCBvciBubyBwYXRoIGF0IGFsbCwgdXNlIGZyb21FbmRwb2ludCBpbnN0ZWFkLlxuICAgICAqIE5vdGU6IFF1ZXJ5IHBhcmFtZXRlcnMgYXJlIG5vdCBhbGxvd2VkIGluIHRoZSBob3N0IFVSSSBhbmQgbXVzdCBiZSBzZXQgYnkgb3RoZXIgQVBJcy5cbiAgICAgKiBOb3RlOiBUbyB1c2UgYW4gYXV0aG9yaXphdGlvbiB0b2tlbiB3aXRoIGZyb21Ib3N0LCB1c2UgZnJvbUhvc3QoVVJMKSBhbmQgdGhlbiBzZXQgdGhlIEF1dGhvcml6YXRpb25Ub2tlblxuICAgICAqIHByb3BlcnR5IG9uIHRoZSBjcmVhdGVkIEJvdEZyYW1ld29ya0NvbmZpZyBpbnN0YW5jZS5cbiAgICAgKiBOb3RlOiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTUuMC5cbiAgICAgKiBAbWVtYmVyIEJvdEZyYW1ld29ya0NvbmZpZy5mcm9tSG9zdFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge1VSTCB8IHN0cmluZ30gaG9zdCAtIElmIGEgVVJMIGlzIHByb3ZpZGVkLCB0aGUgZnVsbHktcXVhbGlmaWVkIGhvc3Qgd2l0aCBwcm90b2NvbCAoZS5nLlxuICAgICAqIHdzczovL3lvdXIuaG9zdC5jb206MTIzNCkgd2lsbCBiZSB1c2VkLiBJZiBhIHN0cmluZyBpcyBwcm92aWRlZCwgaXQgd2lsbCBiZSBlbWJlZGRlZCBpblxuICAgICAqIHdzczovL3tob3N0fS5jb252YWkuc3BlZWNoLmF6dXJlLnVzLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzdWJzY3JpcHRpb25LZXkgLSBUaGUgc3Vic2NyaXB0aW9uIGtleS4gSWYgYSBzdWJzY3JpcHRpb24ga2V5IGlzIG5vdCBzcGVjaWZpZWQsIGFuIGF1dGhvcml6YXRpb25cbiAgICAgKiB0b2tlbiBtdXN0IGJlIHNldC5cbiAgICAgKiBAcGFyYW0gYm90SWQgT3B0aW9uYWwuIElkZW50aWZpZXIgZm9yIHVzaW5nIGEgc3BlY2lmaWMgYm90IHdpdGhpbiBhbiBBenVyZSByZXNvdXJjZSBncm91cC4gRXF1aXZhbGVudCB0byB0aGVcbiAgICAgKiByZXNvdXJjZSBuYW1lLlxuICAgICAqIEByZXR1cm5zIHtCb3RGcmFtZXdvcmtDb25maWd9IEEgbmV3IGJvdCBmcmFtZXdvcmsgY29uZmlndXJhdGlvbiBpbnN0YW5jZS5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbUhvc3QoaG9zdCwgc3Vic2NyaXB0aW9uS2V5LCBib3RJZCkge1xuICAgICAgICB2b2lkIGJvdElkO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChob3N0LCBcImhvc3RcIik7XG4gICAgICAgIGNvbnN0IHJlc29sdmVkSG9zdCA9IGhvc3QgaW5zdGFuY2VvZiBVUkwgPyBob3N0IDogbmV3IFVSTChgd3NzOi8vJHtob3N0fS5jb252YWkuc3BlZWNoLmF6dXJlLnVzYCk7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHJlc29sdmVkSG9zdCwgXCJyZXNvbHZlZEhvc3RcIik7XG4gICAgICAgIGNvbnN0IGJvdEZyYW1ld29ya0NvbmZpZyA9IG5ldyBEaWFsb2dTZXJ2aWNlQ29uZmlnSW1wbCgpO1xuICAgICAgICBib3RGcmFtZXdvcmtDb25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25fRGlhbG9nVHlwZSwgRGlhbG9nU2VydmljZUNvbmZpZy5EaWFsb2dUeXBlcy5Cb3RGcmFtZXdvcmspO1xuICAgICAgICBib3RGcmFtZXdvcmtDb25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Ib3N0LCByZXNvbHZlZEhvc3QudG9TdHJpbmcoKSk7XG4gICAgICAgIGlmICh1bmRlZmluZWQgIT09IHN1YnNjcmlwdGlvbktleSkge1xuICAgICAgICAgICAgYm90RnJhbWV3b3JrQ29uZmlnLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fS2V5LCBzdWJzY3JpcHRpb25LZXkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBib3RGcmFtZXdvcmtDb25maWc7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgYSBCb3RGcmFtZXdvcmtDb25maWcuXG4gICAgICogVGhpcyBtZXRob2QgaXMgaW50ZW5kZWQgb25seSBmb3IgdXNlcnMgd2hvIHVzZSBhIG5vbi1zdGFuZGFyZCBzZXJ2aWNlIGVuZHBvaW50IG9yIHBhcmFtZXRlcnMuXG4gICAgICogTm90ZTogVGhlIHF1ZXJ5IHBhcmFtZXRlcnMgc3BlY2lmaWVkIGluIHRoZSBlbmRwb2ludCBVUkwgYXJlIG5vdCBjaGFuZ2VkLCBldmVuIGlmIHRoZXkgYXJlIHNldCBieSBhbnkgb3RoZXIgQVBJcy5cbiAgICAgKiBOb3RlOiBUbyB1c2UgYXV0aG9yaXphdGlvbiB0b2tlbiB3aXRoIGZyb21FbmRwb2ludCwgcGFzcyBhbiBlbXB0eSBzdHJpbmcgdG8gdGhlIHN1YnNjcmlwdGlvbktleSBpbiB0aGVcbiAgICAgKiBmcm9tRW5kcG9pbnQgbWV0aG9kLCBhbmQgdGhlbiBzZXQgYXV0aG9yaXphdGlvblRva2VuPVwidG9rZW5cIiBvbiB0aGUgY3JlYXRlZCBCb3RGcmFtZXdvcmtDb25maWcgaW5zdGFuY2UgdG9cbiAgICAgKiB1c2UgdGhlIGF1dGhvcml6YXRpb24gdG9rZW4uXG4gICAgICogTm90ZTogQWRkZWQgaW4gdmVyc2lvbiAxLjE1LjAuXG4gICAgICogQG1lbWJlciBCb3RGcmFtZXdvcmtDb25maWcuZnJvbUVuZHBvaW50XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7VVJMfSBlbmRwb2ludCAtIFRoZSBzZXJ2aWNlIGVuZHBvaW50IHRvIGNvbm5lY3QgdG8uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHN1YnNjcmlwdGlvbktleSAtIFRoZSBzdWJzY3JpcHRpb24ga2V5LiBJZiBhIHN1YnNjcmlwdGlvbiBrZXkgaXMgbm90IHNwZWNpZmllZCwgYW4gYXV0aG9yaXphdGlvblxuICAgICAqIHRva2VuIG11c3QgYmUgc2V0LlxuICAgICAqIEByZXR1cm5zIHtCb3RGcmFtZXdvcmtDb25maWd9IC0gQSBuZXcgYm90IGZyYW1ld29yayBjb25maWd1cmF0aW9uIGluc3RhbmNlIHVzaW5nIHRoZSBwcm92aWRlZCBlbmRwb2ludC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbUVuZHBvaW50KGVuZHBvaW50LCBzdWJzY3JpcHRpb25LZXkpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsKGVuZHBvaW50LCBcImVuZHBvaW50XCIpO1xuICAgICAgICBjb25zdCBib3RGcmFtZXdvcmtDb25maWcgPSBuZXcgRGlhbG9nU2VydmljZUNvbmZpZ0ltcGwoKTtcbiAgICAgICAgYm90RnJhbWV3b3JrQ29uZmlnLnNldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uX0RpYWxvZ1R5cGUsIERpYWxvZ1NlcnZpY2VDb25maWcuRGlhbG9nVHlwZXMuQm90RnJhbWV3b3JrKTtcbiAgICAgICAgYm90RnJhbWV3b3JrQ29uZmlnLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnQsIGVuZHBvaW50LnRvU3RyaW5nKCkpO1xuICAgICAgICBpZiAodW5kZWZpbmVkICE9PSBzdWJzY3JpcHRpb25LZXkpIHtcbiAgICAgICAgICAgIGJvdEZyYW1ld29ya0NvbmZpZy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0tleSwgc3Vic2NyaXB0aW9uS2V5KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYm90RnJhbWV3b3JrQ29uZmlnO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Qm90RnJhbWV3b3JrQ29uZmlnLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBDYW5jZWxsYXRpb25FcnJvckNvZGVQcm9wZXJ0eU5hbWUsIEVudW1UcmFuc2xhdGlvbiwgU2ltcGxlU3BlZWNoUGhyYXNlIH0gZnJvbSBcIi4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ2FuY2VsbGF0aW9uRGV0YWlsc0Jhc2UgfSBmcm9tIFwiLi9DYW5jZWxsYXRpb25EZXRhaWxzQmFzZVwiO1xuaW1wb3J0IHsgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLCBDYW5jZWxsYXRpb25SZWFzb24sIFJlY29nbml0aW9uUmVzdWx0IH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBDb250YWlucyBkZXRhaWxlZCBpbmZvcm1hdGlvbiBhYm91dCB3aHkgYSByZXN1bHQgd2FzIGNhbmNlbGVkLlxuICogQGNsYXNzIENhbmNlbGxhdGlvbkRldGFpbHNcbiAqL1xuZXhwb3J0IGNsYXNzIENhbmNlbGxhdGlvbkRldGFpbHMgZXh0ZW5kcyBDYW5jZWxsYXRpb25EZXRhaWxzQmFzZSB7XG4gICAgY29uc3RydWN0b3IocmVhc29uLCBlcnJvckRldGFpbHMsIGVycm9yQ29kZSkge1xuICAgICAgICBzdXBlcihyZWFzb24sIGVycm9yRGV0YWlscywgZXJyb3JDb2RlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBDYW5jZWxsYXRpb25EZXRhaWxzIG9iamVjdCBmb3IgdGhlIGNhbmNlbGVkIFJlY29nbml0aW9uUmVzdWx0LlxuICAgICAqIEBtZW1iZXIgQ2FuY2VsbGF0aW9uRGV0YWlscy5mcm9tUmVzdWx0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7UmVjb2duaXRpb25SZXN1bHQgfCBTcGVlY2hTeW50aGVzaXNSZXN1bHR9IHJlc3VsdCAtIFRoZSByZXN1bHQgdGhhdCB3YXMgY2FuY2VsZWQuXG4gICAgICogQHJldHVybnMge0NhbmNlbGxhdGlvbkRldGFpbHN9IFRoZSBjYW5jZWxsYXRpb24gZGV0YWlscyBvYmplY3QgYmVpbmcgY3JlYXRlZC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbVJlc3VsdChyZXN1bHQpIHtcbiAgICAgICAgbGV0IHJlYXNvbiA9IENhbmNlbGxhdGlvblJlYXNvbi5FcnJvcjtcbiAgICAgICAgbGV0IGVycm9yQ29kZSA9IENhbmNlbGxhdGlvbkVycm9yQ29kZS5Ob0Vycm9yO1xuICAgICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgUmVjb2duaXRpb25SZXN1bHQgJiYgISFyZXN1bHQuanNvbikge1xuICAgICAgICAgICAgY29uc3Qgc2ltcGxlU3BlZWNoID0gU2ltcGxlU3BlZWNoUGhyYXNlLmZyb21KU09OKHJlc3VsdC5qc29uKTtcbiAgICAgICAgICAgIHJlYXNvbiA9IEVudW1UcmFuc2xhdGlvbi5pbXBsVHJhbnNsYXRlQ2FuY2VsUmVzdWx0KHNpbXBsZVNwZWVjaC5SZWNvZ25pdGlvblN0YXR1cyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCEhcmVzdWx0LnByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgIGVycm9yQ29kZSA9IENhbmNlbGxhdGlvbkVycm9yQ29kZVtyZXN1bHQucHJvcGVydGllcy5nZXRQcm9wZXJ0eShDYW5jZWxsYXRpb25FcnJvckNvZGVQcm9wZXJ0eU5hbWUsIENhbmNlbGxhdGlvbkVycm9yQ29kZVtDYW5jZWxsYXRpb25FcnJvckNvZGUuTm9FcnJvcl0pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IENhbmNlbGxhdGlvbkRldGFpbHMocmVhc29uLCByZXN1bHQuZXJyb3JEZXRhaWxzIHx8IEVudW1UcmFuc2xhdGlvbi5pbXBsVHJhbnNsYXRlRXJyb3JEZXRhaWxzKGVycm9yQ29kZSksIGVycm9yQ29kZSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1DYW5jZWxsYXRpb25EZXRhaWxzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIENvbnRhaW5zIGRldGFpbGVkIGluZm9ybWF0aW9uIGFib3V0IHdoeSBhIHJlc3VsdCB3YXMgY2FuY2VsZWQuXG4gKiBAY2xhc3MgQ2FuY2VsbGF0aW9uRGV0YWlsc0Jhc2VcbiAqL1xuZXhwb3J0IGNsYXNzIENhbmNlbGxhdGlvbkRldGFpbHNCYXNlIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7Q2FuY2VsbGF0aW9uUmVhc29ufSByZWFzb24gLSBUaGUgY2FuY2VsbGF0aW9uIHJlYXNvbi5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXJyb3JEZXRhaWxzIC0gVGhlIGVycm9yIGRldGFpbHMsIGlmIHByb3ZpZGVkLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlYXNvbiwgZXJyb3JEZXRhaWxzLCBlcnJvckNvZGUpIHtcbiAgICAgICAgdGhpcy5wcml2UmVhc29uID0gcmVhc29uO1xuICAgICAgICB0aGlzLnByaXZFcnJvckRldGFpbHMgPSBlcnJvckRldGFpbHM7XG4gICAgICAgIHRoaXMucHJpdkVycm9yQ29kZSA9IGVycm9yQ29kZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIHJlYXNvbiB0aGUgcmVjb2duaXRpb24gd2FzIGNhbmNlbGVkLlxuICAgICAqIEBtZW1iZXIgQ2FuY2VsbGF0aW9uRGV0YWlsc0Jhc2UucHJvdG90eXBlLnJlYXNvblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7Q2FuY2VsbGF0aW9uUmVhc29ufSBTcGVjaWZpZXMgdGhlIHJlYXNvbiBjYW5jZWxlZC5cbiAgICAgKi9cbiAgICBnZXQgcmVhc29uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVhc29uO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbiBjYXNlIG9mIGFuIHVuc3VjY2Vzc2Z1bCByZWNvZ25pdGlvbiwgcHJvdmlkZXMgZGV0YWlscyBvZiB0aGUgb2NjdXJyZWQgZXJyb3IuXG4gICAgICogQG1lbWJlciBDYW5jZWxsYXRpb25EZXRhaWxzQmFzZS5wcm90b3R5cGUuZXJyb3JEZXRhaWxzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IEEgU3RyaW5nIHRoYXQgcmVwcmVzZW50cyB0aGUgZXJyb3IgZGV0YWlscy5cbiAgICAgKi9cbiAgICBnZXQgZXJyb3JEZXRhaWxzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXJyb3JEZXRhaWxzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgZXJyb3IgY29kZSBpbiBjYXNlIG9mIGFuIHVuc3VjY2Vzc2Z1bCByZWNvZ25pdGlvbi5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMS4wLlxuICAgICAqIEByZXR1cm4gQW4gZXJyb3IgY29kZSB0aGF0IHJlcHJlc2VudHMgdGhlIGVycm9yIHJlYXNvbi5cbiAgICAgKi9cbiAgICBnZXQgRXJyb3JDb2RlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXJyb3JDb2RlO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q2FuY2VsbGF0aW9uRGV0YWlsc0Jhc2UuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogRGVmaW5lcyBlcnJvciBjb2RlIGluIGNhc2UgdGhhdCBDYW5jZWxsYXRpb25SZWFzb24gaXMgRXJyb3IuXG4gKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMS4wLlxuICovXG5leHBvcnQgdmFyIENhbmNlbGxhdGlvbkVycm9yQ29kZTtcbihmdW5jdGlvbiAoQ2FuY2VsbGF0aW9uRXJyb3JDb2RlKSB7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIHRoYXQgbm8gZXJyb3Igb2NjdXJyZWQgZHVyaW5nIHNwZWVjaCByZWNvZ25pdGlvbi5cbiAgICAgKi9cbiAgICBDYW5jZWxsYXRpb25FcnJvckNvZGVbQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW1wiTm9FcnJvclwiXSA9IDBdID0gXCJOb0Vycm9yXCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIGFuIGF1dGhlbnRpY2F0aW9uIGVycm9yLlxuICAgICAqL1xuICAgIENhbmNlbGxhdGlvbkVycm9yQ29kZVtDYW5jZWxsYXRpb25FcnJvckNvZGVbXCJBdXRoZW50aWNhdGlvbkZhaWx1cmVcIl0gPSAxXSA9IFwiQXV0aGVudGljYXRpb25GYWlsdXJlXCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIHRoYXQgb25lIG9yIG1vcmUgcmVjb2duaXRpb24gcGFyYW1ldGVycyBhcmUgaW52YWxpZC5cbiAgICAgKi9cbiAgICBDYW5jZWxsYXRpb25FcnJvckNvZGVbQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW1wiQmFkUmVxdWVzdFBhcmFtZXRlcnNcIl0gPSAyXSA9IFwiQmFkUmVxdWVzdFBhcmFtZXRlcnNcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhhdCB0aGUgbnVtYmVyIG9mIHBhcmFsbGVsIHJlcXVlc3RzIGV4Y2VlZGVkIHRoZSBudW1iZXIgb2YgYWxsb3dlZFxuICAgICAqIGNvbmN1cnJlbnQgdHJhbnNjcmlwdGlvbnMgZm9yIHRoZSBzdWJzY3JpcHRpb24uXG4gICAgICovXG4gICAgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW0NhbmNlbGxhdGlvbkVycm9yQ29kZVtcIlRvb01hbnlSZXF1ZXN0c1wiXSA9IDNdID0gXCJUb29NYW55UmVxdWVzdHNcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgYSBjb25uZWN0aW9uIGVycm9yLlxuICAgICAqL1xuICAgIENhbmNlbGxhdGlvbkVycm9yQ29kZVtDYW5jZWxsYXRpb25FcnJvckNvZGVbXCJDb25uZWN0aW9uRmFpbHVyZVwiXSA9IDRdID0gXCJDb25uZWN0aW9uRmFpbHVyZVwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyBhIHRpbWUtb3V0IGVycm9yIHdoZW4gd2FpdGluZyBmb3IgcmVzcG9uc2UgZnJvbSBzZXJ2aWNlLlxuICAgICAqL1xuICAgIENhbmNlbGxhdGlvbkVycm9yQ29kZVtDYW5jZWxsYXRpb25FcnJvckNvZGVbXCJTZXJ2aWNlVGltZW91dFwiXSA9IDVdID0gXCJTZXJ2aWNlVGltZW91dFwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGF0IGFuIGVycm9yIGlzIHJldHVybmVkIGJ5IHRoZSBzZXJ2aWNlLlxuICAgICAqL1xuICAgIENhbmNlbGxhdGlvbkVycm9yQ29kZVtDYW5jZWxsYXRpb25FcnJvckNvZGVbXCJTZXJ2aWNlRXJyb3JcIl0gPSA2XSA9IFwiU2VydmljZUVycm9yXCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIGFuIHVuZXhwZWN0ZWQgcnVudGltZSBlcnJvci5cbiAgICAgKi9cbiAgICBDYW5jZWxsYXRpb25FcnJvckNvZGVbQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW1wiUnVudGltZUVycm9yXCJdID0gN10gPSBcIlJ1bnRpbWVFcnJvclwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyBhbiBxdW90YSBvdmVycnVuIG9uIGV4aXN0aW5nIGtleS5cbiAgICAgKi9cbiAgICBDYW5jZWxsYXRpb25FcnJvckNvZGVbQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW1wiRm9yYmlkZGVuXCJdID0gOF0gPSBcIkZvcmJpZGRlblwiO1xufSkoQ2FuY2VsbGF0aW9uRXJyb3JDb2RlIHx8IChDYW5jZWxsYXRpb25FcnJvckNvZGUgPSB7fSkpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1DYW5jZWxsYXRpb25FcnJvckNvZGVzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBSZWNvZ25pdGlvbkV2ZW50QXJncyB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogRGVmaW5lcyBjb250ZW50IG9mIGEgQ2FuY2VsbGF0aW9uRXZlbnQuXG4gKiBAY2xhc3MgQ2FuY2VsbGF0aW9uRXZlbnRBcmdzQmFzZVxuICovXG5leHBvcnQgY2xhc3MgQ2FuY2VsbGF0aW9uRXZlbnRBcmdzQmFzZSBleHRlbmRzIFJlY29nbml0aW9uRXZlbnRBcmdzIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7Q2FuY2VsbGF0aW9uUmVhc29ufSByZWFzb24gLSBUaGUgY2FuY2VsbGF0aW9uIHJlYXNvbi5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXJyb3JEZXRhaWxzIC0gRXJyb3IgZGV0YWlscywgaWYgcHJvdmlkZWQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG9mZnNldCAtIFRoZSBvZmZzZXQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHNlc3Npb25JZCAtIFRoZSBzZXNzaW9uIGlkLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlYXNvbiwgZXJyb3JEZXRhaWxzLCBlcnJvckNvZGUsIG9mZnNldCwgc2Vzc2lvbklkKSB7XG4gICAgICAgIHN1cGVyKG9mZnNldCwgc2Vzc2lvbklkKTtcbiAgICAgICAgdGhpcy5wcml2UmVhc29uID0gcmVhc29uO1xuICAgICAgICB0aGlzLnByaXZFcnJvckRldGFpbHMgPSBlcnJvckRldGFpbHM7XG4gICAgICAgIHRoaXMucHJpdkVycm9yQ29kZSA9IGVycm9yQ29kZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIHJlYXNvbiB0aGUgcmVjb2duaXRpb24gd2FzIGNhbmNlbGVkLlxuICAgICAqIEBtZW1iZXIgQ2FuY2VsbGF0aW9uRXZlbnRBcmdzQmFzZS5wcm90b3R5cGUucmVhc29uXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtDYW5jZWxsYXRpb25SZWFzb259IFNwZWNpZmllcyB0aGUgcmVhc29uIGNhbmNlbGVkLlxuICAgICAqL1xuICAgIGdldCByZWFzb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZWFzb247XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBlcnJvciBjb2RlIGluIGNhc2Ugb2YgYW4gdW5zdWNjZXNzZnVsIG9wZXJhdGlvbi5cbiAgICAgKiBAcmV0dXJuIEFuIGVycm9yIGNvZGUgdGhhdCByZXByZXNlbnRzIHRoZSBlcnJvciByZWFzb24uXG4gICAgICovXG4gICAgZ2V0IGVycm9yQ29kZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkVycm9yQ29kZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW4gY2FzZSBvZiBhbiB1bnN1Y2Nlc3NmdWwgb3BlcmF0aW9uLCBwcm92aWRlcyBkZXRhaWxzIG9mIHRoZSBvY2N1cnJlZCBlcnJvci5cbiAgICAgKiBAbWVtYmVyIENhbmNlbGxhdGlvbkV2ZW50QXJnc0Jhc2UucHJvdG90eXBlLmVycm9yRGV0YWlsc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBBIFN0cmluZyB0aGF0IHJlcHJlc2VudHMgdGhlIGVycm9yIGRldGFpbHMuXG4gICAgICovXG4gICAgZ2V0IGVycm9yRGV0YWlscygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkVycm9yRGV0YWlscztcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNhbmNlbGxhdGlvbkV2ZW50QXJnc0Jhc2UuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogRGVmaW5lcyB0aGUgcG9zc2libGUgcmVhc29ucyBhIHJlY29nbml0aW9uIHJlc3VsdCBtaWdodCBiZSBjYW5jZWxlZC5cbiAqIEBjbGFzcyBDYW5jZWxsYXRpb25SZWFzb25cbiAqL1xuZXhwb3J0IHZhciBDYW5jZWxsYXRpb25SZWFzb247XG4oZnVuY3Rpb24gKENhbmNlbGxhdGlvblJlYXNvbikge1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGF0IGFuIGVycm9yIG9jY3VycmVkIGR1cmluZyBzcGVlY2ggcmVjb2duaXRpb24uXG4gICAgICogQG1lbWJlciBDYW5jZWxsYXRpb25SZWFzb24uRXJyb3JcbiAgICAgKi9cbiAgICBDYW5jZWxsYXRpb25SZWFzb25bQ2FuY2VsbGF0aW9uUmVhc29uW1wiRXJyb3JcIl0gPSAwXSA9IFwiRXJyb3JcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhhdCB0aGUgZW5kIG9mIHRoZSBhdWRpbyBzdHJlYW0gd2FzIHJlYWNoZWQuXG4gICAgICogQG1lbWJlciBDYW5jZWxsYXRpb25SZWFzb24uRW5kT2ZTdHJlYW1cbiAgICAgKi9cbiAgICBDYW5jZWxsYXRpb25SZWFzb25bQ2FuY2VsbGF0aW9uUmVhc29uW1wiRW5kT2ZTdHJlYW1cIl0gPSAxXSA9IFwiRW5kT2ZTdHJlYW1cIjtcbn0pKENhbmNlbGxhdGlvblJlYXNvbiB8fCAoQ2FuY2VsbGF0aW9uUmVhc29uID0ge30pKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q2FuY2VsbGF0aW9uUmVhc29uLmpzLm1hcFxuIiwiLy9cbi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0LiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLiBTZWUgTElDRU5TRS5tZCBmaWxlIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGZ1bGwgbGljZW5zZSBpbmZvcm1hdGlvbi5cbi8vXG5pbXBvcnQgeyBTZXJ2aWNlUmVjb2duaXplckJhc2UsIFN5bnRoZXNpc0FkYXB0ZXJCYXNlLCB9IGZyb20gXCIuLi9jb21tb24uc3BlZWNoL0V4cG9ydHNcIjtcbmltcG9ydCB7IG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3MsIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb25uZWN0aW9uTWVzc2FnZUltcGwgfSBmcm9tIFwiLi9Db25uZWN0aW9uTWVzc2FnZVwiO1xuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBDb25uZWN0aW9uRXZlbnRBcmdzLCBDb25uZWN0aW9uTWVzc2FnZUV2ZW50QXJncywgU2VydmljZUV2ZW50QXJncywgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIENvbm5lY3Rpb24gaXMgYSBwcm94eSBjbGFzcyBmb3IgbWFuYWdpbmcgY29ubmVjdGlvbiB0byB0aGUgc3BlZWNoIHNlcnZpY2Ugb2YgdGhlIHNwZWNpZmllZCBSZWNvZ25pemVyLlxuICogQnkgZGVmYXVsdCwgYSBSZWNvZ25pemVyIGF1dG9ub21vdXNseSBtYW5hZ2VzIGNvbm5lY3Rpb24gdG8gc2VydmljZSB3aGVuIG5lZWRlZC5cbiAqIFRoZSBDb25uZWN0aW9uIGNsYXNzIHByb3ZpZGVzIGFkZGl0aW9uYWwgbWV0aG9kcyBmb3IgdXNlcnMgdG8gZXhwbGljaXRseSBvcGVuIG9yIGNsb3NlIGEgY29ubmVjdGlvbiBhbmRcbiAqIHRvIHN1YnNjcmliZSB0byBjb25uZWN0aW9uIHN0YXR1cyBjaGFuZ2VzLlxuICogVGhlIHVzZSBvZiBDb25uZWN0aW9uIGlzIG9wdGlvbmFsLCBhbmQgbWFpbmx5IGZvciBzY2VuYXJpb3Mgd2hlcmUgZmluZSB0dW5pbmcgb2YgYXBwbGljYXRpb25cbiAqIGJlaGF2aW9yIGJhc2VkIG9uIGNvbm5lY3Rpb24gc3RhdHVzIGlzIG5lZWRlZC4gVXNlcnMgY2FuIG9wdGlvbmFsbHkgY2FsbCBPcGVuKCkgdG8gbWFudWFsbHkgc2V0IHVwIGEgY29ubmVjdGlvblxuICogaW4gYWR2YW5jZSBiZWZvcmUgc3RhcnRpbmcgcmVjb2duaXRpb24gb24gdGhlIFJlY29nbml6ZXIgYXNzb2NpYXRlZCB3aXRoIHRoaXMgQ29ubmVjdGlvbi5cbiAqIElmIHRoZSBSZWNvZ25pemVyIG5lZWRzIHRvIGNvbm5lY3Qgb3IgZGlzY29ubmVjdCB0byBzZXJ2aWNlLCBpdCB3aWxsXG4gKiBzZXR1cCBvciBzaHV0ZG93biB0aGUgY29ubmVjdGlvbiBpbmRlcGVuZGVudGx5LiBJbiB0aGlzIGNhc2UgdGhlIENvbm5lY3Rpb24gd2lsbCBiZSBub3RpZmllZCBieSBjaGFuZ2Ugb2YgY29ubmVjdGlvblxuICogc3RhdHVzIHZpYSBDb25uZWN0ZWQvRGlzY29ubmVjdGVkIGV2ZW50cy5cbiAqIEFkZGVkIGluIHZlcnNpb24gMS4yLjEuXG4gKi9cbmV4cG9ydCBjbGFzcyBDb25uZWN0aW9uIHtcbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBDb25uZWN0aW9uIGluc3RhbmNlIGZyb20gdGhlIHNwZWNpZmllZCByZWNvZ25pemVyLlxuICAgICAqIEBwYXJhbSByZWNvZ25pemVyIFRoZSByZWNvZ25pemVyIGFzc29jaWF0ZWQgd2l0aCB0aGUgY29ubmVjdGlvbi5cbiAgICAgKiBAcmV0dXJuIFRoZSBDb25uZWN0aW9uIGluc3RhbmNlIG9mIHRoZSByZWNvZ25pemVyLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tUmVjb2duaXplcihyZWNvZ25pemVyKSB7XG4gICAgICAgIGNvbnN0IHJlY29CYXNlID0gcmVjb2duaXplci5pbnRlcm5hbERhdGE7XG4gICAgICAgIGNvbnN0IHJldCA9IG5ldyBDb25uZWN0aW9uKCk7XG4gICAgICAgIHJldC5wcml2SW50ZXJuYWxEYXRhID0gcmVjb0Jhc2U7XG4gICAgICAgIHJldC5zZXR1cEV2ZW50cygpO1xuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBDb25uZWN0aW9uIGluc3RhbmNlIGZyb20gdGhlIHNwZWNpZmllZCBzeW50aGVzaXplci5cbiAgICAgKiBAcGFyYW0gc3ludGhlc2l6ZXIgVGhlIHN5bnRoZXNpemVyIGFzc29jaWF0ZWQgd2l0aCB0aGUgY29ubmVjdGlvbi5cbiAgICAgKiBAcmV0dXJuIFRoZSBDb25uZWN0aW9uIGluc3RhbmNlIG9mIHRoZSBzeW50aGVzaXplci5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbVN5bnRoZXNpemVyKHN5bnRoZXNpemVyKSB7XG4gICAgICAgIGNvbnN0IHN5bnRoQmFzZSA9IHN5bnRoZXNpemVyLmludGVybmFsRGF0YTtcbiAgICAgICAgY29uc3QgcmV0ID0gbmV3IENvbm5lY3Rpb24oKTtcbiAgICAgICAgcmV0LnByaXZJbnRlcm5hbERhdGEgPSBzeW50aEJhc2U7XG4gICAgICAgIHJldC5zZXR1cEV2ZW50cygpO1xuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgdG8gc2V0IHVwIGNvbm5lY3Rpb24gdG8gdGhlIHNlcnZpY2UuXG4gICAgICogVXNlcnMgY2FuIG9wdGlvbmFsbHkgY2FsbCBvcGVuQ29ubmVjdGlvbigpIHRvIG1hbnVhbGx5IHNldCB1cCBhIGNvbm5lY3Rpb24gaW4gYWR2YW5jZSBiZWZvcmUgc3RhcnRpbmcgcmVjb2duaXRpb24gb24gdGhlXG4gICAgICogUmVjb2duaXplciBhc3NvY2lhdGVkIHdpdGggdGhpcyBDb25uZWN0aW9uLiBBZnRlciBzdGFydGluZyByZWNvZ25pdGlvbiwgY2FsbGluZyBPcGVuKCkgd2lsbCBoYXZlIG5vIGVmZmVjdFxuICAgICAqXG4gICAgICogTm90ZTogT24gcmV0dXJuLCB0aGUgY29ubmVjdGlvbiBtaWdodCBub3QgYmUgcmVhZHkgeWV0LiBQbGVhc2Ugc3Vic2NyaWJlIHRvIHRoZSBDb25uZWN0ZWQgZXZlbnQgdG9cbiAgICAgKiBiZSBub3RpZmllZCB3aGVuIHRoZSBjb25uZWN0aW9uIGlzIGVzdGFibGlzaGVkLlxuICAgICAqL1xuICAgIG9wZW5Db25uZWN0aW9uKGNiLCBlcnIpIHtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLnByaXZJbnRlcm5hbERhdGEuY29ubmVjdCgpLCBjYiwgZXJyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xvc2VzIHRoZSBjb25uZWN0aW9uIHRoZSBzZXJ2aWNlLlxuICAgICAqIFVzZXJzIGNhbiBvcHRpb25hbGx5IGNhbGwgY2xvc2VDb25uZWN0aW9uKCkgdG8gbWFudWFsbHkgc2h1dGRvd24gdGhlIGNvbm5lY3Rpb24gb2YgdGhlIGFzc29jaWF0ZWQgUmVjb2duaXplci5cbiAgICAgKlxuICAgICAqIElmIGNsb3NlQ29ubmVjdGlvbigpIGlzIGNhbGxlZCBkdXJpbmcgcmVjb2duaXRpb24sIHJlY29nbml0aW9uIHdpbGwgZmFpbCBhbmQgY2FuY2VsIHdpdGggYW4gZXJyb3IuXG4gICAgICovXG4gICAgY2xvc2VDb25uZWN0aW9uKGNiLCBlcnIpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdkludGVybmFsRGF0YSBpbnN0YW5jZW9mIFN5bnRoZXNpc0FkYXB0ZXJCYXNlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJEaXNjb25uZWN0aW5nIGEgc3ludGhlc2l6ZXIncyBjb25uZWN0aW9uIGlzIGN1cnJlbnRseSBub3Qgc3VwcG9ydGVkXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLnByaXZJbnRlcm5hbERhdGEuZGlzY29ubmVjdCgpLCBjYiwgZXJyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBBcHBlbmRzIGEgcGFyYW1ldGVyIGluIGEgbWVzc2FnZSB0byBzZXJ2aWNlLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xMi4xLlxuICAgICAqIEBwYXJhbSBwYXRoIFRoZSBwYXRoIG9mIHRoZSBuZXR3b3JrIG1lc3NhZ2UuXG4gICAgICogQHBhcmFtIHByb3BlcnR5TmFtZSBOYW1lIG9mIHRoZSBwcm9wZXJ0eVxuICAgICAqIEBwYXJhbSBwcm9wZXJ0eVZhbHVlIFZhbHVlIG9mIHRoZSBwcm9wZXJ0eS4gVGhpcyBpcyBhIGpzb24gc3RyaW5nLlxuICAgICAqL1xuICAgIHNldE1lc3NhZ2VQcm9wZXJ0eShwYXRoLCBwcm9wZXJ0eU5hbWUsIHByb3BlcnR5VmFsdWUpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHByb3BlcnR5TmFtZSwgXCJwcm9wZXJ0eU5hbWVcIik7XG4gICAgICAgIGlmICh0aGlzLnByaXZJbnRlcm5hbERhdGEgaW5zdGFuY2VvZiBTZXJ2aWNlUmVjb2duaXplckJhc2UpIHtcbiAgICAgICAgICAgIGlmIChwYXRoLnRvTG93ZXJDYXNlKCkgIT09IFwic3BlZWNoLmNvbnRleHRcIikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk9ubHkgc3BlZWNoLmNvbnRleHQgbWVzc2FnZSBwcm9wZXJ0eSBzZXRzIGFyZSBjdXJyZW50bHkgc3VwcG9ydGVkIGZvciByZWNvZ25pemVyXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2SW50ZXJuYWxEYXRhLnNwZWVjaENvbnRleHQuc2V0U2VjdGlvbihwcm9wZXJ0eU5hbWUsIHByb3BlcnR5VmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMucHJpdkludGVybmFsRGF0YSBpbnN0YW5jZW9mIFN5bnRoZXNpc0FkYXB0ZXJCYXNlKSB7XG4gICAgICAgICAgICBpZiAocGF0aC50b0xvd2VyQ2FzZSgpICE9PSBcInN5bnRoZXNpcy5jb250ZXh0XCIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPbmx5IHN5bnRoZXNpcy5jb250ZXh0IG1lc3NhZ2UgcHJvcGVydHkgc2V0cyBhcmUgY3VycmVudGx5IHN1cHBvcnRlZCBmb3Igc3ludGhlc2l6ZXJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZJbnRlcm5hbERhdGEuc3ludGhlc2lzQ29udGV4dC5zZXRTZWN0aW9uKHByb3BlcnR5TmFtZSwgcHJvcGVydHlWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgYSBtZXNzYWdlIHRvIHRoZSBzcGVlY2ggc2VydmljZS5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTMuMC5cbiAgICAgKiBAcGFyYW0gcGF0aCBUaGUgV2ViU29ja2V0IHBhdGggb2YgdGhlIG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0gcGF5bG9hZCBUaGUgcGF5bG9hZCBvZiB0aGUgbWVzc2FnZS4gVGhpcyBpcyBhIGpzb24gc3RyaW5nIG9yIGEgQXJyYXlCdWZmZXIuXG4gICAgICogQHBhcmFtIHN1Y2Nlc3MgQSBjYWxsYmFjayB0byBpbmRpY2F0ZSBzdWNjZXNzLlxuICAgICAqIEBwYXJhbSBlcnJvciBBIGNhbGxiYWNrIHRvIGluZGljYXRlIGFuIGVycm9yLlxuICAgICAqL1xuICAgIHNlbmRNZXNzYWdlQXN5bmMocGF0aCwgcGF5bG9hZCwgc3VjY2VzcywgZXJyb3IpIHtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLnByaXZJbnRlcm5hbERhdGEuc2VuZE5ldHdvcmtNZXNzYWdlKHBhdGgsIHBheWxvYWQpLCBzdWNjZXNzLCBlcnJvcik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERpc3Bvc2Ugb2YgYXNzb2NpYXRlZCByZXNvdXJjZXMuXG4gICAgICovXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgfVxuICAgIHNldHVwRXZlbnRzKCkge1xuICAgICAgICB0aGlzLnByaXZFdmVudExpc3RlbmVyID0gdGhpcy5wcml2SW50ZXJuYWxEYXRhLmNvbm5lY3Rpb25FdmVudHMuYXR0YWNoKChjb25uZWN0aW9uRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmIChjb25uZWN0aW9uRXZlbnQubmFtZSA9PT0gXCJDb25uZWN0aW9uRXN0YWJsaXNoZWRFdmVudFwiKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5jb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb25uZWN0ZWQobmV3IENvbm5lY3Rpb25FdmVudEFyZ3MoY29ubmVjdGlvbkV2ZW50LmNvbm5lY3Rpb25JZCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNvbm5lY3Rpb25FdmVudC5uYW1lID09PSBcIkNvbm5lY3Rpb25DbG9zZWRFdmVudFwiKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5kaXNjb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNjb25uZWN0ZWQobmV3IENvbm5lY3Rpb25FdmVudEFyZ3MoY29ubmVjdGlvbkV2ZW50LmNvbm5lY3Rpb25JZCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNvbm5lY3Rpb25FdmVudC5uYW1lID09PSBcIkNvbm5lY3Rpb25NZXNzYWdlU2VudEV2ZW50XCIpIHtcbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLm1lc3NhZ2VTZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZVNlbnQobmV3IENvbm5lY3Rpb25NZXNzYWdlRXZlbnRBcmdzKG5ldyBDb25uZWN0aW9uTWVzc2FnZUltcGwoY29ubmVjdGlvbkV2ZW50Lm1lc3NhZ2UpKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY29ubmVjdGlvbkV2ZW50Lm5hbWUgPT09IFwiQ29ubmVjdGlvbk1lc3NhZ2VSZWNlaXZlZEV2ZW50XCIpIHtcbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLm1lc3NhZ2VSZWNlaXZlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VSZWNlaXZlZChuZXcgQ29ubmVjdGlvbk1lc3NhZ2VFdmVudEFyZ3MobmV3IENvbm5lY3Rpb25NZXNzYWdlSW1wbChjb25uZWN0aW9uRXZlbnQubWVzc2FnZSkpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnByaXZTZXJ2aWNlRXZlbnRMaXN0ZW5lciA9IHRoaXMucHJpdkludGVybmFsRGF0YS5zZXJ2aWNlRXZlbnRzLmF0dGFjaCgoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKCEhdGhpcy5yZWNlaXZlZFNlcnZpY2VNZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWNlaXZlZFNlcnZpY2VNZXNzYWdlKG5ldyBTZXJ2aWNlRXZlbnRBcmdzKGUuanNvblN0cmluZywgZS5uYW1lKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29ubmVjdGlvbi5qcy5tYXBcbiIsIi8vXG4vLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdC4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4gU2VlIExJQ0VOU0UubWQgZmlsZSBpbiB0aGUgcHJvamVjdCByb290IGZvciBmdWxsIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4vL1xuaW1wb3J0IHsgU2Vzc2lvbkV2ZW50QXJncyB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogRGVmaW5lcyBwYXlsb2FkIGZvciBjb25uZWN0aW9uIGV2ZW50cyBsaWtlIENvbm5lY3RlZC9EaXNjb25uZWN0ZWQuXG4gKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMi4wXG4gKi9cbmV4cG9ydCBjbGFzcyBDb25uZWN0aW9uRXZlbnRBcmdzIGV4dGVuZHMgU2Vzc2lvbkV2ZW50QXJncyB7XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbm5lY3Rpb25FdmVudEFyZ3MuanMubWFwXG4iLCIvL1xuLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuIFNlZSBMSUNFTlNFLm1kIGZpbGUgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgZnVsbCBsaWNlbnNlIGluZm9ybWF0aW9uLlxuLy9cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtY2xhc3Nlcy1wZXItZmlsZVxuaW1wb3J0IHsgSGVhZGVyTmFtZXMgfSBmcm9tIFwiLi4vY29tbW9uLnNwZWVjaC9IZWFkZXJOYW1lc1wiO1xuaW1wb3J0IHsgTWVzc2FnZVR5cGUgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IFByb3BlcnR5Q29sbGVjdGlvbiB9IGZyb20gXCIuL1Byb3BlcnR5Q29sbGVjdGlvblwiO1xuaW1wb3J0IHsgUHJvcGVydHlJZCB9IGZyb20gXCIuL1Byb3BlcnR5SWRcIjtcbi8qKlxuICogQ29ubmVjdGlvbk1lc3NhZ2UgcmVwcmVzZW50cyBpbXBsZW1lbnRhdGlvbiBzcGVjaWZpYyBtZXNzYWdlcyBzZW50IHRvIGFuZCByZWNlaXZlZCBmcm9tXG4gKiB0aGUgc3BlZWNoIHNlcnZpY2UuIFRoZXNlIG1lc3NhZ2VzIGFyZSBwcm92aWRlZCBmb3IgZGVidWdnaW5nIHB1cnBvc2VzIGFuZCBzaG91bGQgbm90XG4gKiBiZSB1c2VkIGZvciBwcm9kdWN0aW9uIHVzZSBjYXNlcyB3aXRoIHRoZSBBenVyZSBDb2duaXRpdmUgU2VydmljZXMgU3BlZWNoIFNlcnZpY2UuXG4gKiBNZXNzYWdlcyBzZW50IHRvIGFuZCByZWNlaXZlZCBmcm9tIHRoZSBTcGVlY2ggU2VydmljZSBhcmUgc3ViamVjdCB0byBjaGFuZ2Ugd2l0aG91dFxuICogbm90aWNlLiBUaGlzIGluY2x1ZGVzIG1lc3NhZ2UgY29udGVudHMsIGhlYWRlcnMsIHBheWxvYWRzLCBvcmRlcmluZywgZXRjLlxuICogQWRkZWQgaW4gdmVyc2lvbiAxLjExLjAuXG4gKi9cbmV4cG9ydCBjbGFzcyBDb25uZWN0aW9uTWVzc2FnZSB7XG59XG5leHBvcnQgY2xhc3MgQ29ubmVjdGlvbk1lc3NhZ2VJbXBsIHtcbiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlKSB7XG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25NZXNzYWdlID0gbWVzc2FnZTtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcyA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29ubmVjdGlvbk1lc3NhZ2UuaGVhZGVyc1tIZWFkZXJOYW1lcy5Db25uZWN0aW9uSWRdKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoX1Nlc3Npb25JZCwgdGhpcy5wcml2Q29ubmVjdGlvbk1lc3NhZ2UuaGVhZGVyc1tIZWFkZXJOYW1lcy5Db25uZWN0aW9uSWRdKTtcbiAgICAgICAgfVxuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLnByaXZDb25uZWN0aW9uTWVzc2FnZS5oZWFkZXJzKS5mb3JFYWNoKChoZWFkZXIpID0+IHtcbiAgICAgICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoaGVhZGVyLCB0aGlzLnByaXZDb25uZWN0aW9uTWVzc2FnZS5oZWFkZXJzW2hlYWRlcl0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIG1lc3NhZ2UgcGF0aC5cbiAgICAgKi9cbiAgICBnZXQgcGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25NZXNzYWdlLmhlYWRlcnNbT2JqZWN0LmtleXModGhpcy5wcml2Q29ubmVjdGlvbk1lc3NhZ2UuaGVhZGVycykuZmluZCgoa2V5KSA9PiBrZXkudG9Mb3dlckNhc2UoKSA9PT0gXCJwYXRoXCIudG9Mb3dlckNhc2UoKSldO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGVja3MgdG8gc2VlIGlmIHRoZSBDb25uZWN0aW9uTWVzc2FnZSBpcyBhIHRleHQgbWVzc2FnZS5cbiAgICAgKiBTZWUgYWxzbyBJc0JpbmFyeU1lc3NhZ2UoKS5cbiAgICAgKi9cbiAgICBnZXQgaXNUZXh0TWVzc2FnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25NZXNzYWdlLm1lc3NhZ2VUeXBlID09PSBNZXNzYWdlVHlwZS5UZXh0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGVja3MgdG8gc2VlIGlmIHRoZSBDb25uZWN0aW9uTWVzc2FnZSBpcyBhIGJpbmFyeSBtZXNzYWdlLlxuICAgICAqIFNlZSBhbHNvIEdldEJpbmFyeU1lc3NhZ2UoKS5cbiAgICAgKi9cbiAgICBnZXQgaXNCaW5hcnlNZXNzYWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvbk1lc3NhZ2UubWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLkJpbmFyeTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgdGV4dCBtZXNzYWdlIHBheWxvYWQuIFR5cGljYWxseSB0aGUgdGV4dCBtZXNzYWdlIGNvbnRlbnQtdHlwZSBpc1xuICAgICAqIGFwcGxpY2F0aW9uL2pzb24uIFRvIGRldGVybWluZSBvdGhlciBjb250ZW50LXR5cGVzIHVzZVxuICAgICAqIFByb3BlcnRpZXMuR2V0UHJvcGVydHkoXCJDb250ZW50LVR5cGVcIikuXG4gICAgICovXG4gICAgZ2V0IFRleHRNZXNzYWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGJpbmFyeSBtZXNzYWdlIHBheWxvYWQuXG4gICAgICovXG4gICAgZ2V0IGJpbmFyeU1lc3NhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uTWVzc2FnZS5iaW5hcnlCb2R5O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBIGNvbGxlY3Rpb24gb2YgcHJvcGVydGllcyBhbmQgdGhlaXIgdmFsdWVzIGRlZmluZWQgZm9yIHRoaXMgPHNlZSBjcmVmPVwiQ29ubmVjdGlvbk1lc3NhZ2VcIi8+LlxuICAgICAqIE1lc3NhZ2UgaGVhZGVycyBjYW4gYmUgYWNjZXNzZWQgdmlhIHRoaXMgY29sbGVjdGlvbiAoZS5nLiBcIkNvbnRlbnQtVHlwZVwiKS5cbiAgICAgKi9cbiAgICBnZXQgcHJvcGVydGllcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3BlcnRpZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBzdHJpbmcgdGhhdCByZXByZXNlbnRzIHRoZSBjb25uZWN0aW9uIG1lc3NhZ2UuXG4gICAgICovXG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiBcIlwiO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29ubmVjdGlvbk1lc3NhZ2UuanMubWFwXG4iLCIvL1xuLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuIFNlZSBMSUNFTlNFLm1kIGZpbGUgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgZnVsbCBsaWNlbnNlIGluZm9ybWF0aW9uLlxuLy9cbmV4cG9ydCBjbGFzcyBDb25uZWN0aW9uTWVzc2FnZUV2ZW50QXJncyB7XG4gICAgY29uc3RydWN0b3IobWVzc2FnZSkge1xuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uTWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIDxzZWUgY3JlZj1cIkNvbm5lY3Rpb25NZXNzYWdlXCIvPiBhc3NvY2lhdGVkIHdpdGggdGhpcyA8c2VlIGNyZWY9XCJDb25uZWN0aW9uTWVzc2FnZUV2ZW50QXJnc1wiLz4uXG4gICAgICovXG4gICAgZ2V0IG1lc3NhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uTWVzc2FnZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHN0cmluZyB0aGF0IHJlcHJlc2VudHMgdGhlIGNvbm5lY3Rpb24gbWVzc2FnZSBldmVudC5cbiAgICAgKi9cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIFwiTWVzc2FnZTogXCIgKyB0aGlzLnByaXZDb25uZWN0aW9uTWVzc2FnZS50b1N0cmluZygpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29ubmVjdGlvbk1lc3NhZ2VFdmVudEFyZ3MuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogQGNsYXNzIENvbnRyYWN0c1xuICogQHByaXZhdGVcbiAqL1xuZXhwb3J0IGNsYXNzIENvbnRyYWN0cyB7XG4gICAgc3RhdGljIHRocm93SWZOdWxsT3JVbmRlZmluZWQocGFyYW0sIG5hbWUpIHtcbiAgICAgICAgaWYgKHBhcmFtID09PSB1bmRlZmluZWQgfHwgcGFyYW0gPT09IG51bGwpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInRocm93SWZOdWxsT3JVbmRlZmluZWQ6XCIgKyBuYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgdGhyb3dJZk51bGwocGFyYW0sIG5hbWUpIHtcbiAgICAgICAgaWYgKHBhcmFtID09PSBudWxsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJ0aHJvd0lmTnVsbDpcIiArIG5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyB0aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShwYXJhbSwgbmFtZSkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChwYXJhbSwgbmFtZSk7XG4gICAgICAgIGlmICgoXCJcIiArIHBhcmFtKS50cmltKCkubGVuZ3RoIDwgMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidGhyb3dJZk51bGxPcldoaXRlc3BhY2U6XCIgKyBuYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgdGhyb3dJZk51bGxPclRvb0xvbmcocGFyYW0sIG5hbWUsIG1heExlbmd0aCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChwYXJhbSwgbmFtZSk7XG4gICAgICAgIGlmICgoXCJcIiArIHBhcmFtKS5sZW5ndGggPiBtYXhMZW5ndGgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInRocm93SWZOdWxsT3JUb29Mb25nOlwiICsgbmFtZSArIFwiIChtb3JlIHRoYW4gXCIgKyBtYXhMZW5ndGgudG9TdHJpbmcoKSArIFwiIGNoYXJhY3RlcnMpXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyB0aHJvd0lmTnVsbE9yVG9vU2hvcnQocGFyYW0sIG5hbWUsIG1pbkxlbmd0aCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChwYXJhbSwgbmFtZSk7XG4gICAgICAgIGlmICgoXCJcIiArIHBhcmFtKS5sZW5ndGggPCBtaW5MZW5ndGgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInRocm93SWZOdWxsT3JUb29TaG9ydDpcIiArIG5hbWUgKyBcIiAobGVzcyB0aGFuIFwiICsgbWluTGVuZ3RoLnRvU3RyaW5nKCkgKyBcIiBjaGFyYWN0ZXJzKVwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgdGhyb3dJZkRpc3Bvc2VkKGlzRGlzcG9zZWQpIHtcbiAgICAgICAgaWYgKGlzRGlzcG9zZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInRoZSBvYmplY3QgaXMgYWxyZWFkeSBkaXNwb3NlZFwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgdGhyb3dJZkFycmF5RW1wdHlPcldoaXRlc3BhY2UoYXJyYXksIG5hbWUpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQoYXJyYXksIG5hbWUpO1xuICAgICAgICBpZiAoYXJyYXkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJ0aHJvd0lmQXJyYXlFbXB0eU9yV2hpdGVzcGFjZTpcIiArIG5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBhcnJheSkge1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKGl0ZW0sIG5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyB0aHJvd0lmRmlsZURvZXNOb3RFeGlzdChwYXJhbSwgbmFtZSkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UocGFyYW0sIG5hbWUpO1xuICAgICAgICAvLyBUT0RPIGNoZWNrIGZvciBmaWxlIGV4aXN0ZW5jZS5cbiAgICB9XG4gICAgc3RhdGljIHRocm93SWZOb3RVbmRlZmluZWQocGFyYW0sIG5hbWUpIHtcbiAgICAgICAgaWYgKHBhcmFtICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInRocm93SWZOb3RVbmRlZmluZWQ6XCIgKyBuYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29udHJhY3RzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBDYW5jZWxsYXRpb25FdmVudEFyZ3NCYXNlLCB9IGZyb20gXCIuL0NhbmNlbGxhdGlvbkV2ZW50QXJnc0Jhc2VcIjtcbi8qKlxuICogRGVmaW5lcyBjb250ZW50IG9mIGEgUmVjb2duaXRpb25FcnJvckV2ZW50LlxuICogQGNsYXNzIENvbnZlcnNhdGlvblRyYW5zY3JpcHRpb25DYW5jZWxlZEV2ZW50QXJnc1xuICovXG5leHBvcnQgY2xhc3MgQ29udmVyc2F0aW9uVHJhbnNjcmlwdGlvbkNhbmNlbGVkRXZlbnRBcmdzIGV4dGVuZHMgQ2FuY2VsbGF0aW9uRXZlbnRBcmdzQmFzZSB7XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbnZlcnNhdGlvblRyYW5zY3JpcHRpb25DYW5jZWxlZEV2ZW50QXJncy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBEaWFsb2dTZXJ2aWNlQ29uZmlnLCBEaWFsb2dTZXJ2aWNlQ29uZmlnSW1wbCB9IGZyb20gXCIuL0RpYWxvZ1NlcnZpY2VDb25maWdcIjtcbmltcG9ydCB7IFByb3BlcnR5SWQgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIENsYXNzIHRoYXQgZGVmaW5lcyBjb25maWd1cmF0aW9ucyBmb3IgdGhlIGRpYWxvZyBzZXJ2aWNlIGNvbm5lY3RvciBvYmplY3QgZm9yIHVzaW5nIGEgQ3VzdG9tQ29tbWFuZHMgYmFja2VuZC5cbiAqIEBjbGFzcyBDdXN0b21Db21tYW5kc0NvbmZpZ1xuICovXG5leHBvcnQgY2xhc3MgQ3VzdG9tQ29tbWFuZHNDb25maWcgZXh0ZW5kcyBEaWFsb2dTZXJ2aWNlQ29uZmlnSW1wbCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBDdXN0b21Db21tYW5kc0NvbmZpZy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiB0aGUgYm90IGZyYW1ld29yayBjb25maWcgd2l0aCB0aGUgc3BlY2lmaWVkIHN1YnNjcmlwdGlvbiBhbmQgcmVnaW9uLlxuICAgICAqIEBtZW1iZXIgQ3VzdG9tQ29tbWFuZHNDb25maWcuZnJvbVN1YnNjcmlwdGlvblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0gYXBwbGljYXRpb25JZCBTcGVlY2ggQ29tbWFuZHMgYXBwbGljYXRpb24gaWQuXG4gICAgICogQHBhcmFtIHN1YnNjcmlwdGlvbiBTdWJzY3JpcHRpb24ga2V5IGFzc29jaWF0ZWQgd2l0aCB0aGUgYm90XG4gICAgICogQHBhcmFtIHJlZ2lvbiBUaGUgcmVnaW9uIG5hbWUgKHNlZSB0aGUgPGEgaHJlZj1cImh0dHBzOi8vYWthLm1zL2Nzc3BlZWNoL3JlZ2lvblwiPnJlZ2lvbiBwYWdlPC9hPikuXG4gICAgICogQHJldHVybnMge0N1c3RvbUNvbW1hbmRzQ29uZmlnfSBBIG5ldyBib3QgZnJhbWV3b3JrIGNvbmZpZy5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbVN1YnNjcmlwdGlvbihhcHBsaWNhdGlvbklkLCBzdWJzY3JpcHRpb24sIHJlZ2lvbikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UoYXBwbGljYXRpb25JZCwgXCJhcHBsaWNhdGlvbklkXCIpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2Uoc3Vic2NyaXB0aW9uLCBcInN1YnNjcmlwdGlvblwiKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHJlZ2lvbiwgXCJyZWdpb25cIik7XG4gICAgICAgIGNvbnN0IGN1c3RvbUNvbW1hbmRzQ29uZmlnID0gbmV3IERpYWxvZ1NlcnZpY2VDb25maWdJbXBsKCk7XG4gICAgICAgIGN1c3RvbUNvbW1hbmRzQ29uZmlnLnNldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uX0RpYWxvZ1R5cGUsIERpYWxvZ1NlcnZpY2VDb25maWcuRGlhbG9nVHlwZXMuQ3VzdG9tQ29tbWFuZHMpO1xuICAgICAgICBjdXN0b21Db21tYW5kc0NvbmZpZy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvbl9BcHBsaWNhdGlvbklkLCBhcHBsaWNhdGlvbklkKTtcbiAgICAgICAgY3VzdG9tQ29tbWFuZHNDb25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9LZXksIHN1YnNjcmlwdGlvbik7XG4gICAgICAgIGN1c3RvbUNvbW1hbmRzQ29uZmlnLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVnaW9uLCByZWdpb24pO1xuICAgICAgICByZXR1cm4gY3VzdG9tQ29tbWFuZHNDb25maWc7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgdGhlIGJvdCBmcmFtZXdvcmsgY29uZmlnIHdpdGggdGhlIHNwZWNpZmllZCBTcGVlY2ggQ29tbWFuZHMgYXBwbGljYXRpb24gaWQsIGF1dGhvcml6YXRpb24gdG9rZW4gYW5kIHJlZ2lvbi5cbiAgICAgKiBOb3RlOiBUaGUgY2FsbGVyIG5lZWRzIHRvIGVuc3VyZSB0aGF0IHRoZSBhdXRob3JpemF0aW9uIHRva2VuIGlzIHZhbGlkLiBCZWZvcmUgdGhlIGF1dGhvcml6YXRpb24gdG9rZW5cbiAgICAgKiBleHBpcmVzLCB0aGUgY2FsbGVyIG5lZWRzIHRvIHJlZnJlc2ggaXQgYnkgY2FsbGluZyB0aGlzIHNldHRlciB3aXRoIGEgbmV3IHZhbGlkIHRva2VuLlxuICAgICAqIEFzIGNvbmZpZ3VyYXRpb24gdmFsdWVzIGFyZSBjb3BpZWQgd2hlbiBjcmVhdGluZyBhIG5ldyByZWNvZ25pemVyLCB0aGUgbmV3IHRva2VuIHZhbHVlIHdpbGwgbm90IGFwcGx5IHRvIHJlY29nbml6ZXJzIHRoYXQgaGF2ZSBhbHJlYWR5IGJlZW4gY3JlYXRlZC5cbiAgICAgKiBGb3IgcmVjb2duaXplcnMgdGhhdCBoYXZlIGJlZW4gY3JlYXRlZCBiZWZvcmUsIHlvdSBuZWVkIHRvIHNldCBhdXRob3JpemF0aW9uIHRva2VuIG9mIHRoZSBjb3JyZXNwb25kaW5nIHJlY29nbml6ZXJcbiAgICAgKiB0byByZWZyZXNoIHRoZSB0b2tlbi4gT3RoZXJ3aXNlLCB0aGUgcmVjb2duaXplcnMgd2lsbCBlbmNvdW50ZXIgZXJyb3JzIGR1cmluZyByZWNvZ25pdGlvbi5cbiAgICAgKiBAbWVtYmVyIEN1c3RvbUNvbW1hbmRzQ29uZmlnLmZyb21BdXRob3JpemF0aW9uVG9rZW5cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIGFwcGxpY2F0aW9uSWQgU3BlZWNoIENvbW1hbmRzIGFwcGxpY2F0aW9uIGlkLlxuICAgICAqIEBwYXJhbSBhdXRob3JpemF0aW9uVG9rZW4gVGhlIGF1dGhvcml6YXRpb24gdG9rZW4gYXNzb2NpYXRlZCB3aXRoIHRoZSBhcHBsaWNhdGlvbi5cbiAgICAgKiBAcGFyYW0gcmVnaW9uIFRoZSByZWdpb24gbmFtZSAoc2VlIHRoZSA8YSBocmVmPVwiaHR0cHM6Ly9ha2EubXMvY3NzcGVlY2gvcmVnaW9uXCI+cmVnaW9uIHBhZ2U8L2E+KS5cbiAgICAgKiBAcmV0dXJucyB7Q3VzdG9tQ29tbWFuZHNDb25maWd9IEEgbmV3IHNwZWVjaCBjb21tYW5kcyBjb25maWcuXG4gICAgICovXG4gICAgc3RhdGljIGZyb21BdXRob3JpemF0aW9uVG9rZW4oYXBwbGljYXRpb25JZCwgYXV0aG9yaXphdGlvblRva2VuLCByZWdpb24pIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKGFwcGxpY2F0aW9uSWQsIFwiYXBwbGljYXRpb25JZFwiKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKGF1dGhvcml6YXRpb25Ub2tlbiwgXCJhdXRob3JpemF0aW9uVG9rZW5cIik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShyZWdpb24sIFwicmVnaW9uXCIpO1xuICAgICAgICBjb25zdCBjdXN0b21Db21tYW5kc0NvbmZpZyA9IG5ldyBEaWFsb2dTZXJ2aWNlQ29uZmlnSW1wbCgpO1xuICAgICAgICBjdXN0b21Db21tYW5kc0NvbmZpZy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvbl9EaWFsb2dUeXBlLCBEaWFsb2dTZXJ2aWNlQ29uZmlnLkRpYWxvZ1R5cGVzLkN1c3RvbUNvbW1hbmRzKTtcbiAgICAgICAgY3VzdG9tQ29tbWFuZHNDb25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25fQXBwbGljYXRpb25JZCwgYXBwbGljYXRpb25JZCk7XG4gICAgICAgIGN1c3RvbUNvbW1hbmRzQ29uZmlnLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW4sIGF1dGhvcml6YXRpb25Ub2tlbik7XG4gICAgICAgIGN1c3RvbUNvbW1hbmRzQ29uZmlnLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVnaW9uLCByZWdpb24pO1xuICAgICAgICByZXR1cm4gY3VzdG9tQ29tbWFuZHNDb25maWc7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIGNvcnJlc3BvbmRpbmcgYmFja2VuZCBhcHBsaWNhdGlvbiBpZGVudGlmaWVyLlxuICAgICAqIEBtZW1iZXIgQ3VzdG9tQ29tbWFuZHNDb25maWcucHJvdG90eXBlLkNvbnZlcnNhdGlvbl9BcHBsaWNhdGlvbklkXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZSAtIFRoZSBhcHBsaWNhdGlvbiBpZGVudGlmaWVyIHRvIHNldC5cbiAgICAgKi9cbiAgICBzZXQgYXBwbGljYXRpb25JZCh2YWx1ZSkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodmFsdWUsIFwidmFsdWVcIik7XG4gICAgICAgIHRoaXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25fQXBwbGljYXRpb25JZCwgdmFsdWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBjb3JyZXNwb25kaW5nIGJhY2tlbmQgYXBwbGljYXRpb24gaWRlbnRpZmllci5cbiAgICAgKiBAbWVtYmVyIEN1c3RvbUNvbW1hbmRzQ29uZmlnLnByb3RvdHlwZS5Db252ZXJzYXRpb25fQXBwbGljYXRpb25JZFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgLSBUaGUgYXBwbGljYXRpb24gaWRlbnRpZmllciB0byBnZXQuXG4gICAgICovXG4gICAgZ2V0IGFwcGxpY2F0aW9uSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uX0FwcGxpY2F0aW9uSWQpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q3VzdG9tQ29tbWFuZHNDb25maWcuanMubWFwXG4iLCIvL1xuLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuIFNlZSBMSUNFTlNFLm1kIGZpbGUgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgZnVsbCBsaWNlbnNlIGluZm9ybWF0aW9uLlxuLy9cbmltcG9ydCB7IENvbnNvbGVMb2dnaW5nTGlzdGVuZXIgfSBmcm9tIFwiLi4vY29tbW9uLmJyb3dzZXIvRXhwb3J0c1wiO1xuaW1wb3J0IHsgRXZlbnRzIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG4vKipcbiAqIERlZmluZXMgZGlhZ25vc3RpY3MgQVBJIGZvciBtYW5hZ2luZyBjb25zb2xlIG91dHB1dFxuICogQWRkZWQgaW4gdmVyc2lvbiAxLjIxLjBcbiAqL1xuZXhwb3J0IGNsYXNzIERpYWdub3N0aWNzIHtcbiAgICBzdGF0aWMgU2V0TG9nZ2luZ0xldmVsKGxvZ0xldmVsKSB7XG4gICAgICAgIHRoaXMucHJpdkxpc3RlbmVyID0gbmV3IENvbnNvbGVMb2dnaW5nTGlzdGVuZXIobG9nTGV2ZWwpO1xuICAgICAgICBFdmVudHMuaW5zdGFuY2UuYXR0YWNoQ29uc29sZUxpc3RlbmVyKHRoaXMucHJpdkxpc3RlbmVyKTtcbiAgICB9XG4gICAgc3RhdGljIFN0YXJ0Q29uc29sZU91dHB1dCgpIHtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2TGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkxpc3RlbmVyLmVuYWJsZUNvbnNvbGVPdXRwdXQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBTdG9wQ29uc29sZU91dHB1dCgpIHtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2TGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkxpc3RlbmVyLmVuYWJsZUNvbnNvbGVPdXRwdXQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgU2V0TG9nT3V0cHV0UGF0aChwYXRoKSB7XG4gICAgICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZMaXN0ZW5lcikge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkxpc3RlbmVyLmxvZ1BhdGggPSBwYXRoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmlsZSBzeXN0ZW0gbG9nZ2luZyBub3QgYXZhaWxhYmxlIGluIGJyb3dzZXIuXCIpO1xuICAgICAgICB9XG4gICAgfVxufVxuRGlhZ25vc3RpY3MucHJpdkxpc3RlbmVyID0gdW5kZWZpbmVkO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1EaWFnbm9zdGljcy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyogZXNsaW50LWRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGUgKi9cbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuL0NvbnRyYWN0c1wiO1xuaW1wb3J0IHsgUHJvcGVydHlJZCwgU3BlZWNoQ29uZmlnSW1wbCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogQ2xhc3MgdGhhdCBkZWZpbmVzIGJhc2UgY29uZmlndXJhdGlvbnMgZm9yIGRpYWxvZyBzZXJ2aWNlIGNvbm5lY3RvclxuICogQGNsYXNzIERpYWxvZ1NlcnZpY2VDb25maWdcbiAqL1xuZXhwb3J0IGNsYXNzIERpYWxvZ1NlcnZpY2VDb25maWcge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgRGlhbG9nU2VydmljZSBjb25maWcuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgY29ycmVzcG9uZGluZyBiYWNrZW5kIGFwcGxpY2F0aW9uIGlkZW50aWZpZXIuXG4gICAgICogQG1lbWJlciBEaWFsb2dTZXJ2aWNlQ29uZmlnLnByb3RvdHlwZS5Db252ZXJzYXRpb25fQXBwbGljYXRpb25JZFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgLSBUaGUgYXBwbGljYXRpb24gaWRlbnRpZmllciB0byBzZXQuXG4gICAgICovXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvblxuICAgIHNldCBhcHBsaWNhdGlvbklkKHZhbHVlKSB7IH1cbiAgICBzdGF0aWMgZ2V0IERpYWxvZ1R5cGVzKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgQm90RnJhbWV3b3JrOiBcImJvdF9mcmFtZXdvcmtcIixcbiAgICAgICAgICAgIEN1c3RvbUNvbW1hbmRzOiBcImN1c3RvbV9jb21tYW5kc1wiXG4gICAgICAgIH07XG4gICAgfVxufVxuLyoqXG4gKiBEaWFsb2cgU2VydmljZSBjb25maWd1cmF0aW9uLlxuICogQGNsYXNzIERpYWxvZ1NlcnZpY2VDb25maWdJbXBsXG4gKi9cbmV4cG9ydCBjbGFzcyBEaWFsb2dTZXJ2aWNlQ29uZmlnSW1wbCBleHRlbmRzIERpYWxvZ1NlcnZpY2VDb25maWcge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgZGlhbG9nU2VydmljZSBjb25maWcuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaENvbmZpZyA9IG5ldyBTcGVlY2hDb25maWdJbXBsKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFByb3ZpZGVzIGFjY2VzcyB0byBjdXN0b20gcHJvcGVydGllcy5cbiAgICAgKiBAbWVtYmVyIERpYWxvZ1NlcnZpY2VDb25maWdJbXBsLnByb3RvdHlwZS5wcm9wZXJ0aWVzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtQcm9wZXJ0eUNvbGxlY3Rpb259IFRoZSBwcm9wZXJ0aWVzLlxuICAgICAqL1xuICAgIGdldCBwcm9wZXJ0aWVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoQ29uZmlnLnByb3BlcnRpZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIHNwZWVjaCByZWNvZ25pdGlvbiBsYW5ndWFnZS5cbiAgICAgKiBAbWVtYmVyIERpYWxvZ1NlcnZpY2VDb25maWdJbXBsLnByb3RvdHlwZS5zcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGdldCBzcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoQ29uZmlnLnNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIHNwZWVjaCByZWNvZ25pdGlvbiBsYW5ndWFnZS5cbiAgICAgKiBAbWVtYmVyIERpYWxvZ1NlcnZpY2VDb25maWdJbXBsLnByb3RvdHlwZS5zcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZSAtIFRoZSBsYW5ndWFnZSB0byBzZXQuXG4gICAgICovXG4gICAgc2V0IHNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2UodmFsdWUpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHZhbHVlLCBcInZhbHVlXCIpO1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hDb25maWcuc3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZSA9IHZhbHVlO1xuICAgIH1cbiAgICBnZXQgb3V0cHV0Rm9ybWF0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoQ29uZmlnLm91dHB1dEZvcm1hdDtcbiAgICB9XG4gICAgc2V0IG91dHB1dEZvcm1hdCh2YWx1ZSkge1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hDb25maWcub3V0cHV0Rm9ybWF0ID0gdmFsdWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgYSBuYW1lZCBwcm9wZXJ0eSBhcyB2YWx1ZVxuICAgICAqIEBtZW1iZXIgRGlhbG9nU2VydmljZUNvbmZpZ0ltcGwucHJvdG90eXBlLnNldFByb3BlcnR5XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7UHJvcGVydHlJZCB8IHN0cmluZ30gbmFtZSAtIFRoZSBwcm9wZXJ0eSB0byBzZXQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlIC0gVGhlIHZhbHVlLlxuICAgICAqL1xuICAgIHNldFByb3BlcnR5KG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaENvbmZpZy5zZXRQcm9wZXJ0eShuYW1lLCB2YWx1ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgYSBuYW1lZCBwcm9wZXJ0eSBhcyB2YWx1ZVxuICAgICAqIEBtZW1iZXIgRGlhbG9nU2VydmljZUNvbmZpZ0ltcGwucHJvdG90eXBlLmdldFByb3BlcnR5XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7UHJvcGVydHlJZCB8IHN0cmluZ30gbmFtZSAtIFRoZSBwcm9wZXJ0eSB0byBnZXQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGRlZiAtIFRoZSBkZWZhdWx0IHZhbHVlIHRvIHJldHVybiBpbiBjYXNlIHRoZSBwcm9wZXJ0eSBpcyBub3Qga25vd24uXG4gICAgICogQHJldHVybnMge3N0cmluZ30gVGhlIGN1cnJlbnQgdmFsdWUsIG9yIHByb3ZpZGVkIGRlZmF1bHQsIG9mIHRoZSBnaXZlbiBwcm9wZXJ0eS5cbiAgICAgKi9cbiAgICBnZXRQcm9wZXJ0eShuYW1lLCBkZWYpIHtcbiAgICAgICAgdm9pZCBkZWY7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hDb25maWcuZ2V0UHJvcGVydHkobmFtZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIHByb3h5IGNvbmZpZ3VyYXRpb24uXG4gICAgICogT25seSByZWxldmFudCBpbiBOb2RlLmpzIGVudmlyb25tZW50cy5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuNC4wLlxuICAgICAqIEBwYXJhbSBwcm94eUhvc3ROYW1lIFRoZSBob3N0IG5hbWUgb2YgdGhlIHByb3h5IHNlcnZlciwgd2l0aG91dCB0aGUgcHJvdG9jb2wgc2NoZW1lIChodHRwOi8vKVxuICAgICAqIEBwYXJhbSBwcm94eVBvcnQgVGhlIHBvcnQgbnVtYmVyIG9mIHRoZSBwcm94eSBzZXJ2ZXIuXG4gICAgICogQHBhcmFtIHByb3h5VXNlck5hbWUgVGhlIHVzZXIgbmFtZSBvZiB0aGUgcHJveHkgc2VydmVyLlxuICAgICAqIEBwYXJhbSBwcm94eVBhc3N3b3JkIFRoZSBwYXNzd29yZCBvZiB0aGUgcHJveHkgc2VydmVyLlxuICAgICAqL1xuICAgIHNldFByb3h5KHByb3h5SG9zdE5hbWUsIHByb3h5UG9ydCwgcHJveHlVc2VyTmFtZSwgcHJveHlQYXNzd29yZCkge1xuICAgICAgICB0aGlzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUHJveHlIb3N0TmFtZSwgcHJveHlIb3N0TmFtZSk7XG4gICAgICAgIHRoaXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Qcm94eVBvcnQsIGAke3Byb3h5UG9ydH1gKTtcbiAgICAgICAgaWYgKHByb3h5VXNlck5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Qcm94eVVzZXJOYW1lLCBwcm94eVVzZXJOYW1lKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocHJveHlQYXNzd29yZCkge1xuICAgICAgICAgICAgdGhpcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5UGFzc3dvcmQsIHByb3h5UGFzc3dvcmQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNldFNlcnZpY2VQcm9wZXJ0eShuYW1lLCB2YWx1ZSwgY2hhbm5lbCkge1xuICAgICAgICB2b2lkIGNoYW5uZWw7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaENvbmZpZy5zZXRTZXJ2aWNlUHJvcGVydHkobmFtZSwgdmFsdWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEaXNwb3NlIG9mIGFzc29jaWF0ZWQgcmVzb3VyY2VzLlxuICAgICAqIEBtZW1iZXIgRGlhbG9nU2VydmljZUNvbmZpZ0ltcGwucHJvdG90eXBlLmNsb3NlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGNsb3NlKCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1EaWFsb2dTZXJ2aWNlQ29uZmlnLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCB7IERpYWxvZ0Nvbm5lY3Rpb25GYWN0b3J5IH0gZnJvbSBcIi4uL2NvbW1vbi5zcGVlY2gvRGlhbG9nQ29ubmVjdG9yRmFjdG9yeVwiO1xuaW1wb3J0IHsgRGlhbG9nU2VydmljZUFkYXB0ZXIsIFJlY29nbml0aW9uTW9kZSwgUmVjb2duaXplckNvbmZpZyB9IGZyb20gXCIuLi9jb21tb24uc3BlZWNoL0V4cG9ydHNcIjtcbmltcG9ydCB7IERlZmVycmVkLCBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi9Db250cmFjdHNcIjtcbmltcG9ydCB7IFJlY29nbml6ZXIgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eUlkIH0gZnJvbSBcIi4vUHJvcGVydHlJZFwiO1xuLyoqXG4gKiBEaWFsb2cgU2VydmljZSBDb25uZWN0b3JcbiAqIEBjbGFzcyBEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yXG4gKi9cbmV4cG9ydCBjbGFzcyBEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yIGV4dGVuZHMgUmVjb2duaXplciB7XG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhlIERpYWxvZ1NlcnZpY2VDb25uZWN0b3IuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtEaWFsb2dTZXJ2aWNlQ29uZmlnfSBkaWFsb2dDb25maWcgLSBTZXQgb2YgcHJvcGVydGllcyB0byBjb25maWd1cmUgdGhpcyByZWNvZ25pemVyLlxuICAgICAqIEBwYXJhbSB7QXVkaW9Db25maWd9IGF1ZGlvQ29uZmlnIC0gQW4gb3B0aW9uYWwgYXVkaW8gY29uZmlnIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVjb2duaXplclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGRpYWxvZ0NvbmZpZywgYXVkaW9Db25maWcpIHtcbiAgICAgICAgY29uc3QgZGlhbG9nU2VydmljZUNvbmZpZ0ltcGwgPSBkaWFsb2dDb25maWc7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbChkaWFsb2dDb25maWcsIFwiZGlhbG9nQ29uZmlnXCIpO1xuICAgICAgICBzdXBlcihhdWRpb0NvbmZpZywgZGlhbG9nU2VydmljZUNvbmZpZ0ltcGwucHJvcGVydGllcywgbmV3IERpYWxvZ0Nvbm5lY3Rpb25GYWN0b3J5KCkpO1xuICAgICAgICB0aGlzLmlzVHVybkNvbXBsZXRlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzID0gZGlhbG9nU2VydmljZUNvbmZpZ0ltcGwucHJvcGVydGllcy5jbG9uZSgpO1xuICAgICAgICBjb25zdCBhZ2VudENvbmZpZyA9IHRoaXMuYnVpbGRBZ2VudENvbmZpZygpO1xuICAgICAgICB0aGlzLnByaXZSZWNvLmFnZW50Q29uZmlnLnNldChhZ2VudENvbmZpZyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyBhIGNvbm5lY3Rpb24gdG8gdGhlIHNlcnZpY2UuXG4gICAgICogVXNlcnMgY2FuIG9wdGlvbmFsbHkgY2FsbCBjb25uZWN0KCkgdG8gbWFudWFsbHkgc2V0IHVwIGEgY29ubmVjdGlvbiBpbiBhZHZhbmNlLCBiZWZvcmUgc3RhcnRpbmcgaW50ZXJhY3Rpb25zLlxuICAgICAqXG4gICAgICogTm90ZTogT24gcmV0dXJuLCB0aGUgY29ubmVjdGlvbiBtaWdodCBub3QgYmUgcmVhZHkgeWV0LiBQbGVhc2Ugc3Vic2NyaWJlIHRvIHRoZSBDb25uZWN0ZWQgZXZlbnQgdG9cbiAgICAgKiBiZSBub3RpZmllZCB3aGVuIHRoZSBjb25uZWN0aW9uIGlzIGVzdGFibGlzaGVkLlxuICAgICAqIEBtZW1iZXIgRGlhbG9nU2VydmljZUNvbm5lY3Rvci5wcm90b3R5cGUuY29ubmVjdFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBjb25uZWN0KGNiLCBlcnIpIHtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLnByaXZSZWNvLmNvbm5lY3QoKSwgY2IsIGVycik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsb3NlcyB0aGUgY29ubmVjdGlvbiB0aGUgc2VydmljZS5cbiAgICAgKiBVc2VycyBjYW4gb3B0aW9uYWxseSBjYWxsIGRpc2Nvbm5lY3QoKSB0byBtYW51YWxseSBzaHV0ZG93biB0aGUgY29ubmVjdGlvbiBvZiB0aGUgYXNzb2NpYXRlZCBEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yLlxuICAgICAqXG4gICAgICogSWYgZGlzY29ubmVjdCgpIGlzIGNhbGxlZCBkdXJpbmcgYSByZWNvZ25pdGlvbiwgcmVjb2duaXRpb24gd2lsbCBmYWlsIGFuZCBjYW5jZWwgd2l0aCBhbiBlcnJvci5cbiAgICAgKi9cbiAgICBkaXNjb25uZWN0KGNiLCBlcnIpIHtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLnByaXZSZWNvLmRpc2Nvbm5lY3QoKSwgY2IsIGVycik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGF1dGhvcml6YXRpb24gdG9rZW4gdXNlZCB0byBjb21tdW5pY2F0ZSB3aXRoIHRoZSBzZXJ2aWNlLlxuICAgICAqIEBtZW1iZXIgRGlhbG9nU2VydmljZUNvbm5lY3Rvci5wcm90b3R5cGUuYXV0aG9yaXphdGlvblRva2VuXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IEF1dGhvcml6YXRpb24gdG9rZW4uXG4gICAgICovXG4gICAgZ2V0IGF1dGhvcml6YXRpb25Ub2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgYXV0aG9yaXphdGlvbiB0b2tlbiB1c2VkIHRvIGNvbW11bmljYXRlIHdpdGggdGhlIHNlcnZpY2UuXG4gICAgICogQG1lbWJlciBEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yLnByb3RvdHlwZS5hdXRob3JpemF0aW9uVG9rZW5cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRva2VuIC0gQXV0aG9yaXphdGlvbiB0b2tlbi5cbiAgICAgKi9cbiAgICBzZXQgYXV0aG9yaXphdGlvblRva2VuKHRva2VuKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh0b2tlbiwgXCJ0b2tlblwiKTtcbiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW4sIHRva2VuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGNvbGxlY3Rpb24gb2YgcHJvcGVydGllcyBhbmQgdGhlaXIgdmFsdWVzIGRlZmluZWQgZm9yIHRoaXMgRGlhbG9nU2VydmljZUNvbm5lY3Rvci5cbiAgICAgKiBAbWVtYmVyIERpYWxvZ1NlcnZpY2VDb25uZWN0b3IucHJvdG90eXBlLnByb3BlcnRpZXNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1Byb3BlcnR5Q29sbGVjdGlvbn0gVGhlIGNvbGxlY3Rpb24gb2YgcHJvcGVydGllcyBhbmQgdGhlaXIgdmFsdWVzIGRlZmluZWQgZm9yIHRoaXMgRGlhbG9nU2VydmljZUNvbm5lY3Rvci5cbiAgICAgKi9cbiAgICBnZXQgcHJvcGVydGllcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3BlcnRpZXM7XG4gICAgfVxuICAgIC8qKiBHZXRzIHRoZSB0ZW1wbGF0ZSBmb3IgdGhlIGFjdGl2aXR5IGdlbmVyYXRlZCBieSBzZXJ2aWNlIGZyb20gc3BlZWNoLlxuICAgICAqIFByb3BlcnRpZXMgZnJvbSB0aGUgdGVtcGxhdGUgd2lsbCBiZSBzdGFtcGVkIG9uIHRoZSBnZW5lcmF0ZWQgYWN0aXZpdHkuXG4gICAgICogSXQgY2FuIGJlIGVtcHR5XG4gICAgICovXG4gICAgZ2V0IHNwZWVjaEFjdGl2aXR5VGVtcGxhdGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25fU3BlZWNoX0FjdGl2aXR5X1RlbXBsYXRlKTtcbiAgICB9XG4gICAgLyoqIFNldHMgdGhlIHRlbXBsYXRlIGZvciB0aGUgYWN0aXZpdHkgZ2VuZXJhdGVkIGJ5IHNlcnZpY2UgZnJvbSBzcGVlY2guXG4gICAgICogUHJvcGVydGllcyBmcm9tIHRoZSB0ZW1wbGF0ZSB3aWxsIGJlIHN0YW1wZWQgb24gdGhlIGdlbmVyYXRlZCBhY3Rpdml0eS5cbiAgICAgKiBJdCBjYW4gYmUgbnVsbCBvciBlbXB0eS5cbiAgICAgKiBOb3RlOiBpdCBoYXMgdG8gYmUgYSB2YWxpZCBKc29uIG9iamVjdC5cbiAgICAgKi9cbiAgICBzZXQgc3BlZWNoQWN0aXZpdHlUZW1wbGF0ZShzcGVlY2hBY3Rpdml0eVRlbXBsYXRlKSB7XG4gICAgICAgIHRoaXMucHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvbl9TcGVlY2hfQWN0aXZpdHlfVGVtcGxhdGUsIHNwZWVjaEFjdGl2aXR5VGVtcGxhdGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgcmVjb2duaXRpb24gYW5kIHN0b3BzIGFmdGVyIHRoZSBmaXJzdCB1dHRlcmFuY2UgaXMgcmVjb2duaXplZC5cbiAgICAgKiBAbWVtYmVyIERpYWxvZ1NlcnZpY2VDb25uZWN0b3IucHJvdG90eXBlLmxpc3Rlbk9uY2VBc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0gY2IgLSBDYWxsYmFjayB0aGF0IHJlY2VpdmVkIHRoZSByZXN1bHQgd2hlbiB0aGUgcmVjbyBoYXMgY29tcGxldGVkLlxuICAgICAqIEBwYXJhbSBlcnIgLSBDYWxsYmFjayBpbnZva2VkIGluIGNhc2Ugb2YgYW4gZXJyb3IuXG4gICAgICovXG4gICAgbGlzdGVuT25jZUFzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNUdXJuQ29tcGxldGUpIHtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2SXNEaXNwb3NlZCk7XG4gICAgICAgICAgICBjb25zdCBjYWxsYmFja0hvbGRlciA9ICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZSZWNvLmNvbm5lY3QoKTtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmltcGxSZWNvZ25pemVyU3RvcCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuaXNUdXJuQ29tcGxldGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBjb25zdCByZXQgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZSZWNvLnJlY29nbml6ZShSZWNvZ25pdGlvbk1vZGUuQ29udmVyc2F0aW9uLCByZXQucmVzb2x2ZSwgcmV0LnJlamVjdCk7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHlpZWxkIHJldC5wcm9taXNlO1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuaW1wbFJlY29nbml6ZXJTdG9wKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IHJldFByb21pc2UgPSBjYWxsYmFja0hvbGRlcigpO1xuICAgICAgICAgICAgcmV0UHJvbWlzZS5jYXRjaCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gRGVzdHJveSB0aGUgcmVjb2duaXplci5cbiAgICAgICAgICAgICAgICAvLyBXZSd2ZSBkb25lIGFsbCB3ZSBjYW4gaGVyZS5cbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uXG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwb3NlKHRydWUpLmNhdGNoKCgpID0+IHsgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3MocmV0UHJvbWlzZS5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzVHVybkNvbXBsZXRlID0gdHJ1ZTtcbiAgICAgICAgICAgIH0pLCBjYiwgZXJyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZW5kQWN0aXZpdHlBc3luYyhhY3Rpdml0eSwgY2IsIGVyckNiKSB7XG4gICAgICAgIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3ModGhpcy5wcml2UmVjby5zZW5kTWVzc2FnZShhY3Rpdml0eSksIGNiLCBlcnJDYik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIGNsb3NlcyBhbGwgZXh0ZXJuYWwgcmVzb3VyY2VzIGhlbGQgYnkgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAbWVtYmVyIERpYWxvZ1NlcnZpY2VDb25uZWN0b3IucHJvdG90eXBlLmNsb3NlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGNsb3NlKGNiLCBlcnIpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZJc0Rpc3Bvc2VkKTtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLmRpc3Bvc2UodHJ1ZSksIGNiLCBlcnIpO1xuICAgIH1cbiAgICBkaXNwb3NlKGRpc3Bvc2luZykge1xuICAgICAgICBjb25zdCBfc3VwZXIgPSBPYmplY3QuY3JlYXRlKG51bGwsIHtcbiAgICAgICAgICAgIGRpc3Bvc2U6IHsgZ2V0OiAoKSA9PiBzdXBlci5kaXNwb3NlIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2SXNEaXNwb3NlZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkaXNwb3NpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmltcGxSZWNvZ25pemVyU3RvcCgpO1xuICAgICAgICAgICAgICAgIHlpZWxkIF9zdXBlci5kaXNwb3NlLmNhbGwodGhpcywgZGlzcG9zaW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNyZWF0ZVJlY29nbml6ZXJDb25maWcoc3BlZWNoQ29uZmlnKSB7XG4gICAgICAgIHJldHVybiBuZXcgUmVjb2duaXplckNvbmZpZyhzcGVlY2hDb25maWcsIHRoaXMucHJpdlByb3BlcnRpZXMpO1xuICAgIH1cbiAgICBjcmVhdGVTZXJ2aWNlUmVjb2duaXplcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvQ29uZmlnLCByZWNvZ25pemVyQ29uZmlnKSB7XG4gICAgICAgIGNvbnN0IGF1ZGlvU291cmNlID0gYXVkaW9Db25maWc7XG4gICAgICAgIHJldHVybiBuZXcgRGlhbG9nU2VydmljZUFkYXB0ZXIoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb1NvdXJjZSwgcmVjb2duaXplckNvbmZpZywgdGhpcyk7XG4gICAgfVxuICAgIGJ1aWxkQWdlbnRDb25maWcoKSB7XG4gICAgICAgIGNvbnN0IGNvbW11bmljYXRpb25UeXBlID0gdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFwiQ29udmVyc2F0aW9uX0NvbW11bmljYXRpb25fVHlwZVwiLCBcIkRlZmF1bHRcIik7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBib3RJbmZvOiB7XG4gICAgICAgICAgICAgICAgY29tbVR5cGU6IGNvbW11bmljYXRpb25UeXBlLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRzQ3VsdHVyZTogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIGNvbm5lY3Rpb25JZDogdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uX0FnZW50X0Nvbm5lY3Rpb25fSWQpLFxuICAgICAgICAgICAgICAgIGNvbnZlcnNhdGlvbklkOiB0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25fQ29udmVyc2F0aW9uX0lkLCB1bmRlZmluZWQpLFxuICAgICAgICAgICAgICAgIGZyb21JZDogdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uX0Zyb21fSWQsIHVuZGVmaW5lZCksXG4gICAgICAgICAgICAgICAgdHRzQXVkaW9Gb3JtYXQ6IHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1N5bnRoT3V0cHV0Rm9ybWF0LCB1bmRlZmluZWQpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdmVyc2lvbjogMC4yXG4gICAgICAgIH07XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1EaWFsb2dTZXJ2aWNlQ29ubmVjdG9yLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5leHBvcnQgeyBBdWRpb0NvbmZpZyB9IGZyb20gXCIuL0F1ZGlvL0F1ZGlvQ29uZmlnXCI7XG5leHBvcnQgeyBBdWRpb1N0cmVhbUZvcm1hdCwgQXVkaW9Gb3JtYXRUYWcgfSBmcm9tIFwiLi9BdWRpby9BdWRpb1N0cmVhbUZvcm1hdFwiO1xuZXhwb3J0IHsgQXVkaW9JbnB1dFN0cmVhbSwgUHVsbEF1ZGlvSW5wdXRTdHJlYW0sIFB1c2hBdWRpb0lucHV0U3RyZWFtIH0gZnJvbSBcIi4vQXVkaW8vQXVkaW9JbnB1dFN0cmVhbVwiO1xuZXhwb3J0IHsgQXVkaW9PdXRwdXRTdHJlYW0sIFB1bGxBdWRpb091dHB1dFN0cmVhbSwgUHVzaEF1ZGlvT3V0cHV0U3RyZWFtIH0gZnJvbSBcIi4vQXVkaW8vQXVkaW9PdXRwdXRTdHJlYW1cIjtcbmV4cG9ydCB7IENhbmNlbGxhdGlvblJlYXNvbiB9IGZyb20gXCIuL0NhbmNlbGxhdGlvblJlYXNvblwiO1xuZXhwb3J0IHsgUHVsbEF1ZGlvSW5wdXRTdHJlYW1DYWxsYmFjayB9IGZyb20gXCIuL0F1ZGlvL1B1bGxBdWRpb0lucHV0U3RyZWFtQ2FsbGJhY2tcIjtcbmV4cG9ydCB7IFB1c2hBdWRpb091dHB1dFN0cmVhbUNhbGxiYWNrIH0gZnJvbSBcIi4vQXVkaW8vUHVzaEF1ZGlvT3V0cHV0U3RyZWFtQ2FsbGJhY2tcIjtcbmV4cG9ydCB7IEtleXdvcmRSZWNvZ25pdGlvbk1vZGVsIH0gZnJvbSBcIi4vS2V5d29yZFJlY29nbml0aW9uTW9kZWxcIjtcbmV4cG9ydCB7IFNlc3Npb25FdmVudEFyZ3MgfSBmcm9tIFwiLi9TZXNzaW9uRXZlbnRBcmdzXCI7XG5leHBvcnQgeyBSZWNvZ25pdGlvbkV2ZW50QXJncyB9IGZyb20gXCIuL1JlY29nbml0aW9uRXZlbnRBcmdzXCI7XG5leHBvcnQgeyBPdXRwdXRGb3JtYXQgfSBmcm9tIFwiLi9PdXRwdXRGb3JtYXRcIjtcbmV4cG9ydCB7IEludGVudFJlY29nbml0aW9uRXZlbnRBcmdzIH0gZnJvbSBcIi4vSW50ZW50UmVjb2duaXRpb25FdmVudEFyZ3NcIjtcbmV4cG9ydCB7IFJlY29nbml0aW9uUmVzdWx0IH0gZnJvbSBcIi4vUmVjb2duaXRpb25SZXN1bHRcIjtcbmV4cG9ydCB7IFNwZWVjaFJlY29nbml0aW9uUmVzdWx0IH0gZnJvbSBcIi4vU3BlZWNoUmVjb2duaXRpb25SZXN1bHRcIjtcbmV4cG9ydCB7IEludGVudFJlY29nbml0aW9uUmVzdWx0IH0gZnJvbSBcIi4vSW50ZW50UmVjb2duaXRpb25SZXN1bHRcIjtcbmV4cG9ydCB7IExhbmd1YWdlVW5kZXJzdGFuZGluZ01vZGVsIH0gZnJvbSBcIi4vTGFuZ3VhZ2VVbmRlcnN0YW5kaW5nTW9kZWxcIjtcbmV4cG9ydCB7IFNwZWVjaFJlY29nbml0aW9uRXZlbnRBcmdzLCBDb252ZXJzYXRpb25UcmFuc2NyaXB0aW9uRXZlbnRBcmdzIH0gZnJvbSBcIi4vU3BlZWNoUmVjb2duaXRpb25FdmVudEFyZ3NcIjtcbmV4cG9ydCB7IFNwZWVjaFJlY29nbml0aW9uQ2FuY2VsZWRFdmVudEFyZ3MgfSBmcm9tIFwiLi9TcGVlY2hSZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzXCI7XG5leHBvcnQgeyBUcmFuc2xhdGlvblJlY29nbml0aW9uRXZlbnRBcmdzIH0gZnJvbSBcIi4vVHJhbnNsYXRpb25SZWNvZ25pdGlvbkV2ZW50QXJnc1wiO1xuZXhwb3J0IHsgVHJhbnNsYXRpb25TeW50aGVzaXNFdmVudEFyZ3MgfSBmcm9tIFwiLi9UcmFuc2xhdGlvblN5bnRoZXNpc0V2ZW50QXJnc1wiO1xuZXhwb3J0IHsgVHJhbnNsYXRpb25SZWNvZ25pdGlvblJlc3VsdCB9IGZyb20gXCIuL1RyYW5zbGF0aW9uUmVjb2duaXRpb25SZXN1bHRcIjtcbmV4cG9ydCB7IFRyYW5zbGF0aW9uU3ludGhlc2lzUmVzdWx0IH0gZnJvbSBcIi4vVHJhbnNsYXRpb25TeW50aGVzaXNSZXN1bHRcIjtcbmV4cG9ydCB7IFJlc3VsdFJlYXNvbiB9IGZyb20gXCIuL1Jlc3VsdFJlYXNvblwiO1xuZXhwb3J0IHsgU3BlZWNoQ29uZmlnLCBTcGVlY2hDb25maWdJbXBsIH0gZnJvbSBcIi4vU3BlZWNoQ29uZmlnXCI7XG5leHBvcnQgeyBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZywgU3BlZWNoVHJhbnNsYXRpb25Db25maWdJbXBsIH0gZnJvbSBcIi4vU3BlZWNoVHJhbnNsYXRpb25Db25maWdcIjtcbmV4cG9ydCB7IFByb3BlcnR5Q29sbGVjdGlvbiB9IGZyb20gXCIuL1Byb3BlcnR5Q29sbGVjdGlvblwiO1xuZXhwb3J0IHsgUHJvcGVydHlJZCB9IGZyb20gXCIuL1Byb3BlcnR5SWRcIjtcbmV4cG9ydCB7IFJlY29nbml6ZXIgfSBmcm9tIFwiLi9SZWNvZ25pemVyXCI7XG5leHBvcnQgeyBTcGVlY2hSZWNvZ25pemVyIH0gZnJvbSBcIi4vU3BlZWNoUmVjb2duaXplclwiO1xuZXhwb3J0IHsgSW50ZW50UmVjb2duaXplciB9IGZyb20gXCIuL0ludGVudFJlY29nbml6ZXJcIjtcbmV4cG9ydCB7IFZvaWNlUHJvZmlsZVR5cGUgfSBmcm9tIFwiLi9Wb2ljZVByb2ZpbGVUeXBlXCI7XG5leHBvcnQgeyBUcmFuc2xhdGlvblJlY29nbml6ZXIgfSBmcm9tIFwiLi9UcmFuc2xhdGlvblJlY29nbml6ZXJcIjtcbmV4cG9ydCB7IFRyYW5zbGF0aW9ucyB9IGZyb20gXCIuL1RyYW5zbGF0aW9uc1wiO1xuZXhwb3J0IHsgTm9NYXRjaFJlYXNvbiB9IGZyb20gXCIuL05vTWF0Y2hSZWFzb25cIjtcbmV4cG9ydCB7IE5vTWF0Y2hEZXRhaWxzIH0gZnJvbSBcIi4vTm9NYXRjaERldGFpbHNcIjtcbmV4cG9ydCB7IFRyYW5zbGF0aW9uUmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJncyB9IGZyb20gXCIuL1RyYW5zbGF0aW9uUmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJnc1wiO1xuZXhwb3J0IHsgSW50ZW50UmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJncyB9IGZyb20gXCIuL0ludGVudFJlY29nbml0aW9uQ2FuY2VsZWRFdmVudEFyZ3NcIjtcbmV4cG9ydCB7IENhbmNlbGxhdGlvbkRldGFpbHNCYXNlIH0gZnJvbSBcIi4vQ2FuY2VsbGF0aW9uRGV0YWlsc0Jhc2VcIjtcbmV4cG9ydCB7IENhbmNlbGxhdGlvbkRldGFpbHMgfSBmcm9tIFwiLi9DYW5jZWxsYXRpb25EZXRhaWxzXCI7XG5leHBvcnQgeyBDYW5jZWxsYXRpb25FcnJvckNvZGUgfSBmcm9tIFwiLi9DYW5jZWxsYXRpb25FcnJvckNvZGVzXCI7XG5leHBvcnQgeyBDb25uZWN0aW9uRXZlbnRBcmdzIH0gZnJvbSBcIi4vQ29ubmVjdGlvbkV2ZW50QXJnc1wiO1xuZXhwb3J0IHsgU2VydmljZUV2ZW50QXJncyB9IGZyb20gXCIuL1NlcnZpY2VFdmVudEFyZ3NcIjtcbmV4cG9ydCB7IENvbm5lY3Rpb24gfSBmcm9tIFwiLi9Db25uZWN0aW9uXCI7XG5leHBvcnQgeyBQaHJhc2VMaXN0R3JhbW1hciB9IGZyb20gXCIuL1BocmFzZUxpc3RHcmFtbWFyXCI7XG5leHBvcnQgeyBEaWFsb2dTZXJ2aWNlQ29uZmlnIH0gZnJvbSBcIi4vRGlhbG9nU2VydmljZUNvbmZpZ1wiO1xuZXhwb3J0IHsgQm90RnJhbWV3b3JrQ29uZmlnIH0gZnJvbSBcIi4vQm90RnJhbWV3b3JrQ29uZmlnXCI7XG5leHBvcnQgeyBDdXN0b21Db21tYW5kc0NvbmZpZyB9IGZyb20gXCIuL0N1c3RvbUNvbW1hbmRzQ29uZmlnXCI7XG5leHBvcnQgeyBEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yIH0gZnJvbSBcIi4vRGlhbG9nU2VydmljZUNvbm5lY3RvclwiO1xuZXhwb3J0IHsgQWN0aXZpdHlSZWNlaXZlZEV2ZW50QXJncyB9IGZyb20gXCIuL0FjdGl2aXR5UmVjZWl2ZWRFdmVudEFyZ3NcIjtcbmV4cG9ydCB7IFR1cm5TdGF0dXNSZWNlaXZlZEV2ZW50QXJncyB9IGZyb20gXCIuL1R1cm5TdGF0dXNSZWNlaXZlZEV2ZW50QXJnc1wiO1xuZXhwb3J0IHsgU2VydmljZVByb3BlcnR5Q2hhbm5lbCB9IGZyb20gXCIuL1NlcnZpY2VQcm9wZXJ0eUNoYW5uZWxcIjtcbmV4cG9ydCB7IFByb2Zhbml0eU9wdGlvbiB9IGZyb20gXCIuL1Byb2Zhbml0eU9wdGlvblwiO1xuZXhwb3J0IHsgQmFzZUF1ZGlvUGxheWVyIH0gZnJvbSBcIi4vQXVkaW8vQmFzZUF1ZGlvUGxheWVyXCI7XG5leHBvcnQgeyBDb25uZWN0aW9uTWVzc2FnZUV2ZW50QXJncyB9IGZyb20gXCIuL0Nvbm5lY3Rpb25NZXNzYWdlRXZlbnRBcmdzXCI7XG5leHBvcnQgeyBDb25uZWN0aW9uTWVzc2FnZSB9IGZyb20gXCIuL0Nvbm5lY3Rpb25NZXNzYWdlXCI7XG5leHBvcnQgeyBWb2ljZVByb2ZpbGUgfSBmcm9tIFwiLi9Wb2ljZVByb2ZpbGVcIjtcbmV4cG9ydCB7IFZvaWNlUHJvZmlsZUVucm9sbG1lbnRSZXN1bHQsIFZvaWNlUHJvZmlsZUVucm9sbG1lbnRDYW5jZWxsYXRpb25EZXRhaWxzIH0gZnJvbSBcIi4vVm9pY2VQcm9maWxlRW5yb2xsbWVudFJlc3VsdFwiO1xuZXhwb3J0IHsgVm9pY2VQcm9maWxlUmVzdWx0LCBWb2ljZVByb2ZpbGVDYW5jZWxsYXRpb25EZXRhaWxzIH0gZnJvbSBcIi4vVm9pY2VQcm9maWxlUmVzdWx0XCI7XG5leHBvcnQgeyBWb2ljZVByb2ZpbGVQaHJhc2VSZXN1bHQgfSBmcm9tIFwiLi9Wb2ljZVByb2ZpbGVQaHJhc2VSZXN1bHRcIjtcbmV4cG9ydCB7IFZvaWNlUHJvZmlsZUNsaWVudCB9IGZyb20gXCIuL1ZvaWNlUHJvZmlsZUNsaWVudFwiO1xuZXhwb3J0IHsgU3BlYWtlclJlY29nbml6ZXIgfSBmcm9tIFwiLi9TcGVha2VyUmVjb2duaXplclwiO1xuZXhwb3J0IHsgU3BlYWtlcklkZW50aWZpY2F0aW9uTW9kZWwgfSBmcm9tIFwiLi9TcGVha2VySWRlbnRpZmljYXRpb25Nb2RlbFwiO1xuZXhwb3J0IHsgU3BlYWtlclZlcmlmaWNhdGlvbk1vZGVsIH0gZnJvbSBcIi4vU3BlYWtlclZlcmlmaWNhdGlvbk1vZGVsXCI7XG5leHBvcnQgeyBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWcgfSBmcm9tIFwiLi9BdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWdcIjtcbmV4cG9ydCB7IEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZVJlc3VsdCB9IGZyb20gXCIuL0F1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZVJlc3VsdFwiO1xuZXhwb3J0IHsgU291cmNlTGFuZ3VhZ2VDb25maWcgfSBmcm9tIFwiLi9Tb3VyY2VMYW5ndWFnZUNvbmZpZ1wiO1xuZXhwb3J0IHsgU3BlYWtlclJlY29nbml0aW9uUmVzdWx0LCBTcGVha2VyUmVjb2duaXRpb25SZXN1bHRUeXBlLCBTcGVha2VyUmVjb2duaXRpb25DYW5jZWxsYXRpb25EZXRhaWxzIH0gZnJvbSBcIi4vU3BlYWtlclJlY29nbml0aW9uUmVzdWx0XCI7XG5leHBvcnQgeyBDb252ZXJzYXRpb24sIENvbnZlcnNhdGlvbkV4cGlyYXRpb25FdmVudEFyZ3MsIENvbnZlcnNhdGlvblBhcnRpY2lwYW50c0NoYW5nZWRFdmVudEFyZ3MsIENvbnZlcnNhdGlvblRyYW5zbGF0aW9uQ2FuY2VsZWRFdmVudEFyZ3MsIENvbnZlcnNhdGlvblRyYW5zbGF0aW9uRXZlbnRBcmdzLCBDb252ZXJzYXRpb25UcmFuc2xhdGlvblJlc3VsdCwgQ29udmVyc2F0aW9uVHJhbnNsYXRvciwgQ29udmVyc2F0aW9uVHJhbnNjcmliZXIsIFBhcnRpY2lwYW50LCBQYXJ0aWNpcGFudENoYW5nZWRSZWFzb24sIFVzZXIgfSBmcm9tIFwiLi9UcmFuc2NyaXB0aW9uL0V4cG9ydHNcIjtcbmV4cG9ydCB7IFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdCB9IGZyb20gXCIuL1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFwiO1xuZXhwb3J0IHsgU3BlZWNoU3ludGhlc2l6ZXIgfSBmcm9tIFwiLi9TcGVlY2hTeW50aGVzaXplclwiO1xuZXhwb3J0IHsgU3ludGhlc2lzUmVzdWx0IH0gZnJvbSBcIi4vU3ludGhlc2lzUmVzdWx0XCI7XG5leHBvcnQgeyBTcGVlY2hTeW50aGVzaXNSZXN1bHQgfSBmcm9tIFwiLi9TcGVlY2hTeW50aGVzaXNSZXN1bHRcIjtcbmV4cG9ydCB7IFNwZWVjaFN5bnRoZXNpc0V2ZW50QXJncyB9IGZyb20gXCIuL1NwZWVjaFN5bnRoZXNpc0V2ZW50QXJnc1wiO1xuZXhwb3J0IHsgU3BlZWNoU3ludGhlc2lzV29yZEJvdW5kYXJ5RXZlbnRBcmdzIH0gZnJvbSBcIi4vU3BlZWNoU3ludGhlc2lzV29yZEJvdW5kYXJ5RXZlbnRBcmdzXCI7XG5leHBvcnQgeyBTcGVlY2hTeW50aGVzaXNCb29rbWFya0V2ZW50QXJncyB9IGZyb20gXCIuL1NwZWVjaFN5bnRoZXNpc0Jvb2ttYXJrRXZlbnRBcmdzXCI7XG5leHBvcnQgeyBTcGVlY2hTeW50aGVzaXNWaXNlbWVFdmVudEFyZ3MgfSBmcm9tIFwiLi9TcGVlY2hTeW50aGVzaXNWaXNlbWVFdmVudEFyZ3NcIjtcbmV4cG9ydCB7IFNwZWVjaFN5bnRoZXNpc0JvdW5kYXJ5VHlwZSB9IGZyb20gXCIuL1NwZWVjaFN5bnRoZXNpc0JvdW5kYXJ5VHlwZVwiO1xuZXhwb3J0IHsgU3ludGhlc2lzVm9pY2VzUmVzdWx0IH0gZnJvbSBcIi4vU3ludGhlc2lzVm9pY2VzUmVzdWx0XCI7XG5leHBvcnQgeyBWb2ljZUluZm8gfSBmcm9tIFwiLi9Wb2ljZUluZm9cIjtcbmV4cG9ydCB7IFNwZWFrZXJBdWRpb0Rlc3RpbmF0aW9uIH0gZnJvbSBcIi4vQXVkaW8vU3BlYWtlckF1ZGlvRGVzdGluYXRpb25cIjtcbmV4cG9ydCB7IENvbnZlcnNhdGlvblRyYW5zY3JpcHRpb25DYW5jZWxlZEV2ZW50QXJncyB9IGZyb20gXCIuL0NvbnZlcnNhdGlvblRyYW5zY3JpcHRpb25DYW5jZWxlZEV2ZW50QXJnc1wiO1xuZXhwb3J0IHsgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFkaW5nU3lzdGVtIH0gZnJvbSBcIi4vUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFkaW5nU3lzdGVtXCI7XG5leHBvcnQgeyBQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYW51bGFyaXR5IH0gZnJvbSBcIi4vUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFudWxhcml0eVwiO1xuZXhwb3J0IHsgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRDb25maWcgfSBmcm9tIFwiLi9Qcm9udW5jaWF0aW9uQXNzZXNzbWVudENvbmZpZ1wiO1xuZXhwb3J0IHsgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRSZXN1bHQgfSBmcm9tIFwiLi9Qcm9udW5jaWF0aW9uQXNzZXNzbWVudFJlc3VsdFwiO1xuZXhwb3J0IHsgTGFuZ3VhZ2VJZE1vZGUgfSBmcm9tIFwiLi9MYW5ndWFnZUlkTW9kZVwiO1xuZXhwb3J0IHsgRGlhZ25vc3RpY3MgfSBmcm9tIFwiLi9EaWFnbm9zdGljc1wiO1xuZXhwb3J0IHsgTG9nTGV2ZWwgfSBmcm9tIFwiLi9Mb2dMZXZlbFwiO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1FeHBvcnRzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBJbnRlbnRSZWNvZ25pdGlvbkV2ZW50QXJncyB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogRGVmaW5lIHBheWxvYWQgb2YgaW50ZW50IHJlY29nbml0aW9uIGNhbmNlbGVkIHJlc3VsdCBldmVudHMuXG4gKiBAY2xhc3MgSW50ZW50UmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJnc1xuICovXG5leHBvcnQgY2xhc3MgSW50ZW50UmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJncyBleHRlbmRzIEludGVudFJlY29nbml0aW9uRXZlbnRBcmdzIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7Q2FuY2VsbGF0aW9uUmVhc29ufSByZXN1bHQgLSBUaGUgcmVzdWx0IG9mIHRoZSBpbnRlbnQgcmVjb2duaXRpb24uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG9mZnNldCAtIFRoZSBvZmZzZXQuXG4gICAgICogQHBhcmFtIHtJbnRlbnRSZWNvZ25pdGlvblJlc3VsdH0gc2Vzc2lvbklkIC0gVGhlIHNlc3Npb24gaWQuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVhc29uLCBlcnJvckRldGFpbHMsIGVycm9yQ29kZSwgcmVzdWx0LCBvZmZzZXQsIHNlc3Npb25JZCkge1xuICAgICAgICBzdXBlcihyZXN1bHQsIG9mZnNldCwgc2Vzc2lvbklkKTtcbiAgICAgICAgdGhpcy5wcml2UmVhc29uID0gcmVhc29uO1xuICAgICAgICB0aGlzLnByaXZFcnJvckRldGFpbHMgPSBlcnJvckRldGFpbHM7XG4gICAgICAgIHRoaXMucHJpdkVycm9yQ29kZSA9IGVycm9yQ29kZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIHJlYXNvbiB0aGUgcmVjb2duaXRpb24gd2FzIGNhbmNlbGVkLlxuICAgICAqIEBtZW1iZXIgSW50ZW50UmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJncy5wcm90b3R5cGUucmVhc29uXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtDYW5jZWxsYXRpb25SZWFzb259IFNwZWNpZmllcyB0aGUgcmVhc29uIGNhbmNlbGVkLlxuICAgICAqL1xuICAgIGdldCByZWFzb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZWFzb247XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBlcnJvciBjb2RlIGluIGNhc2Ugb2YgYW4gdW5zdWNjZXNzZnVsIHJlY29nbml0aW9uLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xLjAuXG4gICAgICogQHJldHVybiBBbiBlcnJvciBjb2RlIHRoYXQgcmVwcmVzZW50cyB0aGUgZXJyb3IgcmVhc29uLlxuICAgICAqL1xuICAgIGdldCBlcnJvckNvZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZFcnJvckNvZGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEluIGNhc2Ugb2YgYW4gdW5zdWNjZXNzZnVsIHJlY29nbml0aW9uLCBwcm92aWRlcyBkZXRhaWxzIG9mIHRoZSBvY2N1cnJlZCBlcnJvci5cbiAgICAgKiBAbWVtYmVyIEludGVudFJlY29nbml0aW9uQ2FuY2VsZWRFdmVudEFyZ3MucHJvdG90eXBlLmVycm9yRGV0YWlsc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBBIFN0cmluZyB0aGF0IHJlcHJlc2VudHMgdGhlIGVycm9yIGRldGFpbHMuXG4gICAgICovXG4gICAgZ2V0IGVycm9yRGV0YWlscygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkVycm9yRGV0YWlscztcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUludGVudFJlY29nbml0aW9uQ2FuY2VsZWRFdmVudEFyZ3MuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFJlY29nbml0aW9uRXZlbnRBcmdzIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBJbnRlbnQgcmVjb2duaXRpb24gcmVzdWx0IGV2ZW50IGFyZ3VtZW50cy5cbiAqIEBjbGFzc1xuICovXG5leHBvcnQgY2xhc3MgSW50ZW50UmVjb2duaXRpb25FdmVudEFyZ3MgZXh0ZW5kcyBSZWNvZ25pdGlvbkV2ZW50QXJncyB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0gcmVzdWx0IC0gVGhlIHJlc3VsdCBvZiB0aGUgaW50ZW50IHJlY29nbml0aW9uLlxuICAgICAqIEBwYXJhbSBvZmZzZXQgLSBUaGUgb2Zmc2V0LlxuICAgICAqIEBwYXJhbSBzZXNzaW9uSWQgLSBUaGUgc2Vzc2lvbiBpZC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZXN1bHQsIG9mZnNldCwgc2Vzc2lvbklkKSB7XG4gICAgICAgIHN1cGVyKG9mZnNldCwgc2Vzc2lvbklkKTtcbiAgICAgICAgdGhpcy5wcml2UmVzdWx0ID0gcmVzdWx0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXByZXNlbnRzIHRoZSBpbnRlbnQgcmVjb2duaXRpb24gcmVzdWx0LlxuICAgICAqIEBtZW1iZXIgSW50ZW50UmVjb2duaXRpb25FdmVudEFyZ3MucHJvdG90eXBlLnJlc3VsdFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7SW50ZW50UmVjb2duaXRpb25SZXN1bHR9IFJlcHJlc2VudHMgdGhlIGludGVudCByZWNvZ25pdGlvbiByZXN1bHQuXG4gICAgICovXG4gICAgZ2V0IHJlc3VsdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlc3VsdDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUludGVudFJlY29nbml0aW9uRXZlbnRBcmdzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBTcGVlY2hSZWNvZ25pdGlvblJlc3VsdCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogSW50ZW50IHJlY29nbml0aW9uIHJlc3VsdC5cbiAqIEBjbGFzc1xuICovXG5leHBvcnQgY2xhc3MgSW50ZW50UmVjb2duaXRpb25SZXN1bHQgZXh0ZW5kcyBTcGVlY2hSZWNvZ25pdGlvblJlc3VsdCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0gaW50ZW50SWQgLSBUaGUgaW50ZW50IGlkLlxuICAgICAqIEBwYXJhbSByZXN1bHRJZCAtIFRoZSByZXN1bHQgaWQuXG4gICAgICogQHBhcmFtIHJlYXNvbiAtIFRoZSByZWFzb24uXG4gICAgICogQHBhcmFtIHRleHQgLSBUaGUgcmVjb2duaXplZCB0ZXh0LlxuICAgICAqIEBwYXJhbSBkdXJhdGlvbiAtIFRoZSBkdXJhdGlvbi5cbiAgICAgKiBAcGFyYW0gb2Zmc2V0IC0gVGhlIG9mZnNldCBpbnRvIHRoZSBzdHJlYW0uXG4gICAgICogQHBhcmFtIGxhbmd1YWdlIC0gUHJpbWFyeSBMYW5ndWFnZSBkZXRlY3RlZCwgaWYgcHJvdmlkZWQuXG4gICAgICogQHBhcmFtIGxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSAtIFByaW1hcnkgTGFuZ3VhZ2UgY29uZmlkZW5jZSAoXCJVbmtub3duLFwiIFwiTG93LFwiIFwiTWVkaXVtLFwiIFwiSGlnaFwiLi4uKSwgaWYgcHJvdmlkZWQuXG4gICAgICogQHBhcmFtIGVycm9yRGV0YWlscyAtIEVycm9yIGRldGFpbHMsIGlmIHByb3ZpZGVkLlxuICAgICAqIEBwYXJhbSBqc29uIC0gQWRkaXRpb25hbCBKc29uLCBpZiBwcm92aWRlZC5cbiAgICAgKiBAcGFyYW0gcHJvcGVydGllcyAtIEFkZGl0aW9uYWwgcHJvcGVydGllcywgaWYgcHJvdmlkZWQuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoaW50ZW50SWQsIHJlc3VsdElkLCByZWFzb24sIHRleHQsIGR1cmF0aW9uLCBvZmZzZXQsIGxhbmd1YWdlLCBsYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UsIGVycm9yRGV0YWlscywganNvbiwgcHJvcGVydGllcykge1xuICAgICAgICBzdXBlcihyZXN1bHRJZCwgcmVhc29uLCB0ZXh0LCBkdXJhdGlvbiwgb2Zmc2V0LCBsYW5ndWFnZSwgbGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlLCB1bmRlZmluZWQsIGVycm9yRGV0YWlscywganNvbiwgcHJvcGVydGllcyk7XG4gICAgICAgIHRoaXMucHJpdkludGVudElkID0gaW50ZW50SWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEEgU3RyaW5nIHRoYXQgcmVwcmVzZW50cyB0aGUgaW50ZW50IGlkZW50aWZpZXIgYmVpbmcgcmVjb2duaXplZC5cbiAgICAgKiBAbWVtYmVyIEludGVudFJlY29nbml0aW9uUmVzdWx0LnByb3RvdHlwZS5pbnRlbnRJZFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBBIFN0cmluZyB0aGF0IHJlcHJlc2VudHMgdGhlIGludGVudCBpZGVudGlmaWVyIGJlaW5nIHJlY29nbml6ZWQuXG4gICAgICovXG4gICAgZ2V0IGludGVudElkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SW50ZW50SWQ7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1JbnRlbnRSZWNvZ25pdGlvblJlc3VsdC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBBZGRlZExtSW50ZW50LCBJbnRlbnRDb25uZWN0aW9uRmFjdG9yeSwgSW50ZW50U2VydmljZVJlY29nbml6ZXIsIFJlY29nbml0aW9uTW9kZSwgUmVjb2duaXplckNvbmZpZyB9IGZyb20gXCIuLi9jb21tb24uc3BlZWNoL0V4cG9ydHNcIjtcbmltcG9ydCB7IG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3MgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuL0NvbnRyYWN0c1wiO1xuaW1wb3J0IHsgUHJvcGVydHlJZCwgUmVjb2duaXplciwgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIEludGVudCByZWNvZ25pemVyLlxuICogQGNsYXNzXG4gKi9cbmV4cG9ydCBjbGFzcyBJbnRlbnRSZWNvZ25pemVyIGV4dGVuZHMgUmVjb2duaXplciB7XG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhlIEludGVudFJlY29nbml6ZXIuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtTcGVlY2hDb25maWd9IHNwZWVjaENvbmZpZyAtIFRoZSBzZXQgb2YgY29uZmlndXJhdGlvbiBwcm9wZXJ0aWVzLlxuICAgICAqIEBwYXJhbSB7QXVkaW9Db25maWd9IGF1ZGlvQ29uZmlnIC0gQW4gb3B0aW9uYWwgYXVkaW8gaW5wdXQgY29uZmlnIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVjb2duaXplclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNwZWVjaENvbmZpZywgYXVkaW9Db25maWcpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQoc3BlZWNoQ29uZmlnLCBcInNwZWVjaENvbmZpZ1wiKTtcbiAgICAgICAgY29uc3QgY29uZmlnSW1wbCA9IHNwZWVjaENvbmZpZztcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQoY29uZmlnSW1wbCwgXCJzcGVlY2hDb25maWdcIik7XG4gICAgICAgIHN1cGVyKGF1ZGlvQ29uZmlnLCBjb25maWdJbXBsLnByb3BlcnRpZXMsIG5ldyBJbnRlbnRDb25uZWN0aW9uRmFjdG9yeSgpKTtcbiAgICAgICAgdGhpcy5wcml2QWRkZWRJbnRlbnRzID0gW107XG4gICAgICAgIHRoaXMucHJpdkFkZGVkTG1JbnRlbnRzID0ge307XG4gICAgICAgIHRoaXMucHJpdkRpc3Bvc2VkSW50ZW50UmVjb2duaXplciA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzID0gY29uZmlnSW1wbC5wcm9wZXJ0aWVzO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlKSwgUHJvcGVydHlJZFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZV0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBzcG9rZW4gbGFuZ3VhZ2Ugb2YgcmVjb2duaXRpb24uXG4gICAgICogQG1lbWJlciBJbnRlbnRSZWNvZ25pemVyLnByb3RvdHlwZS5zcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHRoZSBzcG9rZW4gbGFuZ3VhZ2Ugb2YgcmVjb2duaXRpb24uXG4gICAgICovXG4gICAgZ2V0IHNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2UoKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWRJbnRlbnRSZWNvZ25pemVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGF1dGhvcml6YXRpb24gdG9rZW4gdXNlZCB0byBjb21tdW5pY2F0ZSB3aXRoIHRoZSBzZXJ2aWNlLlxuICAgICAqIEBtZW1iZXIgSW50ZW50UmVjb2duaXplci5wcm90b3R5cGUuYXV0aG9yaXphdGlvblRva2VuXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IEF1dGhvcml6YXRpb24gdG9rZW4uXG4gICAgICovXG4gICAgZ2V0IGF1dGhvcml6YXRpb25Ub2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cy9TZXRzIHRoZSBhdXRob3JpemF0aW9uIHRva2VuIHVzZWQgdG8gY29tbXVuaWNhdGUgd2l0aCB0aGUgc2VydmljZS5cbiAgICAgKiBOb3RlOiBQbGVhc2UgdXNlIGEgdG9rZW4gZGVyaXZlZCBmcm9tIHlvdXIgTGFuZ3VhZ2VVbmRlcnN0YW5kaW5nIHN1YnNjcmlwdGlvbiBrZXkgZm9yIHRoZSBJbnRlbnQgcmVjb2duaXplci5cbiAgICAgKiBAbWVtYmVyIEludGVudFJlY29nbml6ZXIucHJvdG90eXBlLmF1dGhvcml6YXRpb25Ub2tlblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgLSBBdXRob3JpemF0aW9uIHRva2VuLlxuICAgICAqL1xuICAgIHNldCBhdXRob3JpemF0aW9uVG9rZW4odmFsdWUpIHtcbiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW4sIHZhbHVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGNvbGxlY3Rpb24gb2YgcHJvcGVydGllcyBhbmQgdGhlaXIgdmFsdWVzIGRlZmluZWQgZm9yIHRoaXMgSW50ZW50UmVjb2duaXplci5cbiAgICAgKiBAbWVtYmVyIEludGVudFJlY29nbml6ZXIucHJvdG90eXBlLnByb3BlcnRpZXNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1Byb3BlcnR5Q29sbGVjdGlvbn0gVGhlIGNvbGxlY3Rpb24gb2YgcHJvcGVydGllcyBhbmQgdGhlaXJcbiAgICAgKiB2YWx1ZXMgZGVmaW5lZCBmb3IgdGhpcyBJbnRlbnRSZWNvZ25pemVyLlxuICAgICAqL1xuICAgIGdldCBwcm9wZXJ0aWVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RhcnRzIGludGVudCByZWNvZ25pdGlvbiwgYW5kIHN0b3BzIGFmdGVyIHRoZSBmaXJzdCB1dHRlcmFuY2UgaXMgcmVjb2duaXplZC5cbiAgICAgKiBUaGUgdGFzayByZXR1cm5zIHRoZSByZWNvZ25pdGlvbiB0ZXh0IGFuZCBpbnRlbnQgYXMgcmVzdWx0LlxuICAgICAqIE5vdGU6IFJlY29nbml6ZU9uY2VBc3luYygpIHJldHVybnMgd2hlbiB0aGUgZmlyc3QgdXR0ZXJhbmNlIGhhcyBiZWVuIHJlY29nbml6ZWQsXG4gICAgICogc28gaXQgaXMgc3VpdGFibGUgb25seSBmb3Igc2luZ2xlIHNob3QgcmVjb2duaXRpb24gbGlrZSBjb21tYW5kIG9yIHF1ZXJ5LlxuICAgICAqIEZvciBsb25nLXJ1bm5pbmcgcmVjb2duaXRpb24sIHVzZSBTdGFydENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jKCkgaW5zdGVhZC5cbiAgICAgKiBAbWVtYmVyIEludGVudFJlY29nbml6ZXIucHJvdG90eXBlLnJlY29nbml6ZU9uY2VBc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0gY2IgLSBDYWxsYmFjayB0aGF0IHJlY2VpdmVkIHRoZSByZWNvZ25pdGlvbiBoYXMgZmluaXNoZWQgd2l0aCBhbiBJbnRlbnRSZWNvZ25pdGlvblJlc3VsdC5cbiAgICAgKiBAcGFyYW0gZXJyIC0gQ2FsbGJhY2sgaW52b2tlZCBpbiBjYXNlIG9mIGFuIGVycm9yLlxuICAgICAqL1xuICAgIHJlY29nbml6ZU9uY2VBc3luYyhjYiwgZXJyKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWRJbnRlbnRSZWNvZ25pemVyKTtcbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKHRoaXMucHJpdkFkZGVkTG1JbnRlbnRzKS5sZW5ndGggIT09IDAgfHwgdW5kZWZpbmVkICE9PSB0aGlzLnByaXZVbWJyZWxsYUludGVudCkge1xuICAgICAgICAgICAgY29uc3QgY29udGV4dCA9IHRoaXMuYnVpbGRTcGVlY2hDb250ZXh0KCk7XG4gICAgICAgICAgICB0aGlzLnByaXZSZWNvLnNwZWVjaENvbnRleHQuc2V0U2VjdGlvbihcImludGVudFwiLCBjb250ZXh0LkludGVudCk7XG4gICAgICAgICAgICB0aGlzLnByaXZSZWNvLmR5bmFtaWNHcmFtbWFyLmFkZFJlZmVyZW5jZUdyYW1tYXIoY29udGV4dC5SZWZlcmVuY2VHcmFtbWFycyk7XG4gICAgICAgICAgICBjb25zdCBpbnRlbnRSZWNvID0gdGhpcy5wcml2UmVjbztcbiAgICAgICAgICAgIGludGVudFJlY28uc2V0SW50ZW50cyh0aGlzLnByaXZBZGRlZExtSW50ZW50cywgdGhpcy5wcml2VW1icmVsbGFJbnRlbnQpO1xuICAgICAgICB9XG4gICAgICAgIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3ModGhpcy5yZWNvZ25pemVPbmNlQXN5bmNJbXBsKFJlY29nbml0aW9uTW9kZS5JbnRlcmFjdGl2ZSksIGNiLCBlcnIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgc3BlZWNoIHJlY29nbml0aW9uLCB1bnRpbCBzdG9wQ29udGludW91c1JlY29nbml0aW9uQXN5bmMoKSBpcyBjYWxsZWQuXG4gICAgICogVXNlciBtdXN0IHN1YnNjcmliZSB0byBldmVudHMgdG8gcmVjZWl2ZSByZWNvZ25pdGlvbiByZXN1bHRzLlxuICAgICAqIEBtZW1iZXIgSW50ZW50UmVjb2duaXplci5wcm90b3R5cGUuc3RhcnRDb250aW51b3VzUmVjb2duaXRpb25Bc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0gY2IgLSBDYWxsYmFjayBpbnZva2VkIG9uY2UgdGhlIHJlY29nbml0aW9uIGhhcyBzdGFydGVkLlxuICAgICAqIEBwYXJhbSBlcnIgLSBDYWxsYmFjayBpbnZva2VkIGluIGNhc2Ugb2YgYW4gZXJyb3IuXG4gICAgICovXG4gICAgc3RhcnRDb250aW51b3VzUmVjb2duaXRpb25Bc3luYyhjYiwgZXJyKSB7XG4gICAgICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLnByaXZBZGRlZExtSW50ZW50cykubGVuZ3RoICE9PSAwIHx8IHVuZGVmaW5lZCAhPT0gdGhpcy5wcml2VW1icmVsbGFJbnRlbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzLmJ1aWxkU3BlZWNoQ29udGV4dCgpO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVjby5zcGVlY2hDb250ZXh0LnNldFNlY3Rpb24oXCJpbnRlbnRcIiwgY29udGV4dC5JbnRlbnQpO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVjby5keW5hbWljR3JhbW1hci5hZGRSZWZlcmVuY2VHcmFtbWFyKGNvbnRleHQuUmVmZXJlbmNlR3JhbW1hcnMpO1xuICAgICAgICAgICAgY29uc3QgaW50ZW50UmVjbyA9IHRoaXMucHJpdlJlY287XG4gICAgICAgICAgICBpbnRlbnRSZWNvLnNldEludGVudHModGhpcy5wcml2QWRkZWRMbUludGVudHMsIHRoaXMucHJpdlVtYnJlbGxhSW50ZW50KTtcbiAgICAgICAgfVxuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMuc3RhcnRDb250aW51b3VzUmVjb2duaXRpb25Bc3luY0ltcGwoUmVjb2duaXRpb25Nb2RlLkNvbnZlcnNhdGlvbiksIGNiLCBlcnIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdG9wcyBjb250aW51b3VzIGludGVudCByZWNvZ25pdGlvbi5cbiAgICAgKiBAbWVtYmVyIEludGVudFJlY29nbml6ZXIucHJvdG90eXBlLnN0b3BDb250aW51b3VzUmVjb2duaXRpb25Bc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0gY2IgLSBDYWxsYmFjayBpbnZva2VkIG9uY2UgdGhlIHJlY29nbml0aW9uIGhhcyBzdG9wcGVkLlxuICAgICAqIEBwYXJhbSBlcnIgLSBDYWxsYmFjayBpbnZva2VkIGluIGNhc2Ugb2YgYW4gZXJyb3IuXG4gICAgICovXG4gICAgc3RvcENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLnN0b3BDb250aW51b3VzUmVjb2duaXRpb25Bc3luY0ltcGwoKSwgY2IsIGVycik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyBzcGVlY2ggcmVjb2duaXRpb24gd2l0aCBrZXl3b3JkIHNwb3R0aW5nLCB1bnRpbCBzdG9wS2V5d29yZFJlY29nbml0aW9uQXN5bmMoKSBpcyBjYWxsZWQuXG4gICAgICogVXNlciBtdXN0IHN1YnNjcmliZSB0byBldmVudHMgdG8gcmVjZWl2ZSByZWNvZ25pdGlvbiByZXN1bHRzLlxuICAgICAqIE5vdGU6IEtleSB3b3JkIHNwb3R0aW5nIGZ1bmN0aW9uYWxpdHkgaXMgb25seSBhdmFpbGFibGUgb24gdGhlIFNwZWVjaCBEZXZpY2VzIFNESy5cbiAgICAgKiBUaGlzIGZ1bmN0aW9uYWxpdHkgaXMgY3VycmVudGx5IG5vdCBpbmNsdWRlZCBpbiB0aGUgU0RLIGl0c2VsZi5cbiAgICAgKiBAbWVtYmVyIEludGVudFJlY29nbml6ZXIucHJvdG90eXBlLnN0YXJ0S2V5d29yZFJlY29nbml0aW9uQXN5bmNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtLZXl3b3JkUmVjb2duaXRpb25Nb2RlbH0gbW9kZWwgLSBUaGUga2V5d29yZCByZWNvZ25pdGlvbiBtb2RlbCB0aGF0IHNwZWNpZmllcyB0aGUga2V5d29yZCB0byBiZSByZWNvZ25pemVkLlxuICAgICAqIEBwYXJhbSBjYiAtIENhbGxiYWNrIGludm9rZWQgb25jZSB0aGUgcmVjb2duaXRpb24gaGFzIHN0YXJ0ZWQuXG4gICAgICogQHBhcmFtIGVyciAtIENhbGxiYWNrIGludm9rZWQgaW4gY2FzZSBvZiBhbiBlcnJvci5cbiAgICAgKi9cbiAgICBzdGFydEtleXdvcmRSZWNvZ25pdGlvbkFzeW5jKG1vZGVsLCBjYiwgZXJyKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbChtb2RlbCwgXCJtb2RlbFwiKTtcbiAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICBlcnIoXCJOb3QgeWV0IGltcGxlbWVudGVkLlwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdG9wcyBjb250aW51b3VzIHNwZWVjaCByZWNvZ25pdGlvbi5cbiAgICAgKiBOb3RlOiBLZXkgd29yZCBzcG90dGluZyBmdW5jdGlvbmFsaXR5IGlzIG9ubHkgYXZhaWxhYmxlIG9uIHRoZSBTcGVlY2ggRGV2aWNlcyBTREsuXG4gICAgICogVGhpcyBmdW5jdGlvbmFsaXR5IGlzIGN1cnJlbnRseSBub3QgaW5jbHVkZWQgaW4gdGhlIFNESyBpdHNlbGYuXG4gICAgICogQG1lbWJlciBJbnRlbnRSZWNvZ25pemVyLnByb3RvdHlwZS5zdG9wS2V5d29yZFJlY29nbml0aW9uQXN5bmNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIGNiIC0gQ2FsbGJhY2sgaW52b2tlZCBvbmNlIHRoZSByZWNvZ25pdGlvbiBoYXMgc3RvcHBlZC5cbiAgICAgKiBAcGFyYW0gZXJyIC0gQ2FsbGJhY2sgaW52b2tlZCBpbiBjYXNlIG9mIGFuIGVycm9yLlxuICAgICAqL1xuICAgIHN0b3BLZXl3b3JkUmVjb2duaXRpb25Bc3luYyhjYiwgZXJyKSB7XG4gICAgICAgIGlmICghIWNiKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNiKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgICAgICBlcnIoZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBwaHJhc2UgdGhhdCBzaG91bGQgYmUgcmVjb2duaXplZCBhcyBpbnRlbnQuXG4gICAgICogQG1lbWJlciBJbnRlbnRSZWNvZ25pemVyLnByb3RvdHlwZS5hZGRJbnRlbnRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGludGVudElkIC0gQSBTdHJpbmcgdGhhdCByZXByZXNlbnRzIHRoZSBpZGVudGlmaWVyIG9mIHRoZSBpbnRlbnQgdG8gYmUgcmVjb2duaXplZC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcGhyYXNlIC0gQSBTdHJpbmcgdGhhdCBzcGVjaWZpZXMgdGhlIHBocmFzZSByZXByZXNlbnRpbmcgdGhlIGludGVudC5cbiAgICAgKi9cbiAgICBhZGRJbnRlbnQoc2ltcGxlUGhyYXNlLCBpbnRlbnRJZCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkRpc3Bvc2VkSW50ZW50UmVjb2duaXplcik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShpbnRlbnRJZCwgXCJpbnRlbnRJZFwiKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHNpbXBsZVBocmFzZSwgXCJzaW1wbGVQaHJhc2VcIik7XG4gICAgICAgIHRoaXMucHJpdkFkZGVkSW50ZW50cy5wdXNoKFtpbnRlbnRJZCwgc2ltcGxlUGhyYXNlXSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYW4gaW50ZW50IGZyb20gTGFuZ3VhZ2UgVW5kZXJzdGFuZGluZyBzZXJ2aWNlIGZvciByZWNvZ25pdGlvbi5cbiAgICAgKiBAbWVtYmVyIEludGVudFJlY29nbml6ZXIucHJvdG90eXBlLmFkZEludGVudFdpdGhMYW5ndWFnZU1vZGVsXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpbnRlbnRJZCAtIEEgU3RyaW5nIHRoYXQgcmVwcmVzZW50cyB0aGUgaWRlbnRpZmllciBvZiB0aGUgaW50ZW50XG4gICAgICogdG8gYmUgcmVjb2duaXplZC4gSWdub3JlZCBpZiBpbnRlbnROYW1lIGlzIGVtcHR5LlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtb2RlbCAtIFRoZSBpbnRlbnQgbW9kZWwgZnJvbSBMYW5ndWFnZSBVbmRlcnN0YW5kaW5nIHNlcnZpY2UuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGludGVudE5hbWUgLSBUaGUgaW50ZW50IG5hbWUgZGVmaW5lZCBpbiB0aGUgaW50ZW50IG1vZGVsLiBJZiBpdFxuICAgICAqIGlzIGVtcHR5LCBhbGwgaW50ZW50IG5hbWVzIGRlZmluZWQgaW4gdGhlIG1vZGVsIHdpbGwgYmUgYWRkZWQuXG4gICAgICovXG4gICAgYWRkSW50ZW50V2l0aExhbmd1YWdlTW9kZWwoaW50ZW50SWQsIG1vZGVsLCBpbnRlbnROYW1lKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWRJbnRlbnRSZWNvZ25pemVyKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKGludGVudElkLCBcImludGVudElkXCIpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGwobW9kZWwsIFwibW9kZWxcIik7XG4gICAgICAgIGNvbnN0IG1vZGVsSW1wbCA9IG1vZGVsO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UobW9kZWxJbXBsLmFwcElkLCBcIm1vZGVsLmFwcElkXCIpO1xuICAgICAgICB0aGlzLnByaXZBZGRlZExtSW50ZW50c1tpbnRlbnRJZF0gPSBuZXcgQWRkZWRMbUludGVudChtb2RlbEltcGwsIGludGVudE5hbWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAc3VtbWFyeSBBZGRzIGFsbCBpbnRlbnRzIGZyb20gdGhlIHNwZWNpZmllZCBMYW5ndWFnZSBVbmRlcnN0YW5kaW5nIE1vZGVsLlxuICAgICAqIEBtZW1iZXIgSW50ZW50UmVjb2duaXplci5wcm90b3R5cGUuYWRkQWxsSW50ZW50c1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtMYW5ndWFnZVVuZGVyc3RhbmRpbmdNb2RlbH0gbW9kZWwgLSBUaGUgbGFuZ3VhZ2UgdW5kZXJzdGFuZGluZyBtb2RlbCBjb250YWluaW5nIHRoZSBpbnRlbnRzLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpbnRlbnRJZCAtIEEgY3VzdG9tIGlkIFN0cmluZyB0byBiZSByZXR1cm5lZCBpbiB0aGUgSW50ZW50UmVjb2duaXRpb25SZXN1bHQncyBnZXRJbnRlbnRJZCgpIG1ldGhvZC5cbiAgICAgKi9cbiAgICBhZGRBbGxJbnRlbnRzKG1vZGVsLCBpbnRlbnRJZCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGwobW9kZWwsIFwibW9kZWxcIik7XG4gICAgICAgIGNvbnN0IG1vZGVsSW1wbCA9IG1vZGVsO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UobW9kZWxJbXBsLmFwcElkLCBcIm1vZGVsLmFwcElkXCIpO1xuICAgICAgICB0aGlzLnByaXZVbWJyZWxsYUludGVudCA9IG5ldyBBZGRlZExtSW50ZW50KG1vZGVsSW1wbCwgaW50ZW50SWQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBjbG9zZXMgYWxsIGV4dGVybmFsIHJlc291cmNlcyBoZWxkIGJ5IGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQG1lbWJlciBJbnRlbnRSZWNvZ25pemVyLnByb3RvdHlwZS5jbG9zZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBjbG9zZShjYiwgZXJyb3JDYikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkRpc3Bvc2VkSW50ZW50UmVjb2duaXplcik7XG4gICAgICAgIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3ModGhpcy5kaXNwb3NlKHRydWUpLCBjYiwgZXJyb3JDYik7XG4gICAgfVxuICAgIGNyZWF0ZVJlY29nbml6ZXJDb25maWcoc3BlZWNoQ29uZmlnKSB7XG4gICAgICAgIHJldHVybiBuZXcgUmVjb2duaXplckNvbmZpZyhzcGVlY2hDb25maWcsIHRoaXMucHJpdlByb3BlcnRpZXMpO1xuICAgIH1cbiAgICBjcmVhdGVTZXJ2aWNlUmVjb2duaXplcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvQ29uZmlnLCByZWNvZ25pemVyQ29uZmlnKSB7XG4gICAgICAgIGNvbnN0IGF1ZGlvSW1wbCA9IGF1ZGlvQ29uZmlnO1xuICAgICAgICByZXR1cm4gbmV3IEludGVudFNlcnZpY2VSZWNvZ25pemVyKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9JbXBsLCByZWNvZ25pemVyQ29uZmlnLCB0aGlzKTtcbiAgICB9XG4gICAgZGlzcG9zZShkaXNwb3NpbmcpIHtcbiAgICAgICAgY29uc3QgX3N1cGVyID0gT2JqZWN0LmNyZWF0ZShudWxsLCB7XG4gICAgICAgICAgICBkaXNwb3NlOiB7IGdldDogKCkgPT4gc3VwZXIuZGlzcG9zZSB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdkRpc3Bvc2VkSW50ZW50UmVjb2duaXplcikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkaXNwb3NpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZEaXNwb3NlZEludGVudFJlY29nbml6ZXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHlpZWxkIF9zdXBlci5kaXNwb3NlLmNhbGwodGhpcywgZGlzcG9zaW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGJ1aWxkU3BlZWNoQ29udGV4dCgpIHtcbiAgICAgICAgbGV0IGFwcElkO1xuICAgICAgICBsZXQgcmVnaW9uO1xuICAgICAgICBsZXQgc3Vic2NyaXB0aW9uS2V5O1xuICAgICAgICBjb25zdCByZWZHcmFtbWVycyA9IFtdO1xuICAgICAgICBpZiAodW5kZWZpbmVkICE9PSB0aGlzLnByaXZVbWJyZWxsYUludGVudCkge1xuICAgICAgICAgICAgYXBwSWQgPSB0aGlzLnByaXZVbWJyZWxsYUludGVudC5tb2RlbEltcGwuYXBwSWQ7XG4gICAgICAgICAgICByZWdpb24gPSB0aGlzLnByaXZVbWJyZWxsYUludGVudC5tb2RlbEltcGwucmVnaW9uO1xuICAgICAgICAgICAgc3Vic2NyaXB0aW9uS2V5ID0gdGhpcy5wcml2VW1icmVsbGFJbnRlbnQubW9kZWxJbXBsLnN1YnNjcmlwdGlvbktleTtcbiAgICAgICAgfVxuICAgICAgICAvLyBCdWlsZCB0aGUgcmVmZXJlbmNlIGdyYW1tZXIgYXJyYXkuXG4gICAgICAgIGZvciAoY29uc3QgaW50ZW50SWQgb2YgT2JqZWN0LmtleXModGhpcy5wcml2QWRkZWRMbUludGVudHMpKSB7XG4gICAgICAgICAgICBjb25zdCBhZGRlZExtSW50ZW50ID0gdGhpcy5wcml2QWRkZWRMbUludGVudHNbaW50ZW50SWRdO1xuICAgICAgICAgICAgLy8gdmFsaWRhdGUgYWxsIHRoZSBzYW1lIG1vZGVsLCByZWdpb24sIGFuZCBrZXkuLi5cbiAgICAgICAgICAgIGlmIChhcHBJZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgYXBwSWQgPSBhZGRlZExtSW50ZW50Lm1vZGVsSW1wbC5hcHBJZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChhcHBJZCAhPT0gYWRkZWRMbUludGVudC5tb2RlbEltcGwuYXBwSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW50ZW50cyBtdXN0IGFsbCBiZSBmcm9tIHRoZSBzYW1lIExVSVMgbW9kZWxcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlZ2lvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmVnaW9uID0gYWRkZWRMbUludGVudC5tb2RlbEltcGwucmVnaW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlZ2lvbiAhPT0gYWRkZWRMbUludGVudC5tb2RlbEltcGwucmVnaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludGVudHMgbXVzdCBhbGwgYmUgZnJvbSB0aGUgc2FtZSBMVUlTIG1vZGVsIGluIGEgc2luZ2xlIHJlZ2lvblwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb25LZXkgPSBhZGRlZExtSW50ZW50Lm1vZGVsSW1wbC5zdWJzY3JpcHRpb25LZXk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uS2V5ICE9PSBhZGRlZExtSW50ZW50Lm1vZGVsSW1wbC5zdWJzY3JpcHRpb25LZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW50ZW50cyBtdXN0IGFsbCB1c2UgdGhlIHNhbWUgc3Vic2NyaXB0aW9uIGtleVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBncmFtbWVyID0gXCJsdWlzL1wiICsgYXBwSWQgKyBcIi1QUk9EVUNUSU9OI1wiICsgaW50ZW50SWQ7XG4gICAgICAgICAgICByZWZHcmFtbWVycy5wdXNoKGdyYW1tZXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBJbnRlbnQ6IHtcbiAgICAgICAgICAgICAgICBpZDogYXBwSWQsXG4gICAgICAgICAgICAgICAga2V5OiAoc3Vic2NyaXB0aW9uS2V5ID09PSB1bmRlZmluZWQpID8gdGhpcy5wcml2UHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fS2V5XSkgOiBzdWJzY3JpcHRpb25LZXksXG4gICAgICAgICAgICAgICAgcHJvdmlkZXI6IFwiTFVJU1wiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFJlZmVyZW5jZUdyYW1tYXJzOiAodW5kZWZpbmVkID09PSB0aGlzLnByaXZVbWJyZWxsYUludGVudCkgPyByZWZHcmFtbWVycyA6IFtcImx1aXMvXCIgKyBhcHBJZCArIFwiLVBST0RVQ1RJT05cIl0sXG4gICAgICAgIH07XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1JbnRlbnRSZWNvZ25pemVyLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi9Db250cmFjdHNcIjtcbi8qKlxuICogUmVwcmVzZW50cyBhIGtleXdvcmQgcmVjb2duaXRpb24gbW9kZWwgZm9yIHJlY29nbml6aW5nIHdoZW5cbiAqIHRoZSB1c2VyIHNheXMgYSBrZXl3b3JkIHRvIGluaXRpYXRlIGZ1cnRoZXIgc3BlZWNoIHJlY29nbml0aW9uLlxuICogQGNsYXNzIEtleXdvcmRSZWNvZ25pdGlvbk1vZGVsXG4gKi9cbmV4cG9ydCBjbGFzcyBLZXl3b3JkUmVjb2duaXRpb25Nb2RlbCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGFuZCBpbml0aWFsaXplcyBhIG5ldyBpbnN0YW5jZS5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5wcml2RGlzcG9zZWQgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEga2V5d29yZCByZWNvZ25pdGlvbiBtb2RlbCB1c2luZyB0aGUgc3BlY2lmaWVkIGZpbGVuYW1lLlxuICAgICAqIEBtZW1iZXIgS2V5d29yZFJlY29nbml0aW9uTW9kZWwuZnJvbUZpbGVcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGZpbGVOYW1lIC0gQSBzdHJpbmcgdGhhdCByZXByZXNlbnRzIGZpbGUgbmFtZSBmb3IgdGhlIGtleXdvcmQgcmVjb2duaXRpb24gbW9kZWwuXG4gICAgICogTm90ZSwgdGhlIGZpbGUgY2FuIHBvaW50IHRvIGEgemlwIGZpbGUgaW4gd2hpY2ggY2FzZSB0aGUgbW9kZWxcbiAgICAgKiB3aWxsIGJlIGV4dHJhY3RlZCBmcm9tIHRoZSB6aXAuXG4gICAgICogQHJldHVybnMge0tleXdvcmRSZWNvZ25pdGlvbk1vZGVsfSBUaGUga2V5d29yZCByZWNvZ25pdGlvbiBtb2RlbCBiZWluZyBjcmVhdGVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tRmlsZShmaWxlTmFtZSkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZkZpbGVEb2VzTm90RXhpc3QoZmlsZU5hbWUsIFwiZmlsZU5hbWVcIik7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vdCB5ZXQgaW1wbGVtZW50ZWQuXCIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEga2V5d29yZCByZWNvZ25pdGlvbiBtb2RlbCB1c2luZyB0aGUgc3BlY2lmaWVkIGZpbGVuYW1lLlxuICAgICAqIEBtZW1iZXIgS2V5d29yZFJlY29nbml0aW9uTW9kZWwuZnJvbVN0cmVhbVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmlsZSAtIEEgRmlsZSB0aGF0IHJlcHJlc2VudHMgZmlsZSBmb3IgdGhlIGtleXdvcmQgcmVjb2duaXRpb24gbW9kZWwuXG4gICAgICogTm90ZSwgdGhlIGZpbGUgY2FuIHBvaW50IHRvIGEgemlwIGZpbGUgaW4gd2hpY2ggY2FzZSB0aGUgbW9kZWwgd2lsbCBiZSBleHRyYWN0ZWQgZnJvbSB0aGUgemlwLlxuICAgICAqIEByZXR1cm5zIHtLZXl3b3JkUmVjb2duaXRpb25Nb2RlbH0gVGhlIGtleXdvcmQgcmVjb2duaXRpb24gbW9kZWwgYmVpbmcgY3JlYXRlZC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbVN0cmVhbShmaWxlKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbChmaWxlLCBcImZpbGVcIik7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vdCB5ZXQgaW1wbGVtZW50ZWQuXCIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEaXNwb3NlIG9mIGFzc29jaWF0ZWQgcmVzb3VyY2VzLlxuICAgICAqIEBtZW1iZXIgS2V5d29yZFJlY29nbml0aW9uTW9kZWwucHJvdG90eXBlLmNsb3NlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGNsb3NlKCkge1xuICAgICAgICBpZiAodGhpcy5wcml2RGlzcG9zZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZEaXNwb3NlZCA9IHRydWU7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1LZXl3b3JkUmVjb2duaXRpb25Nb2RlbC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBMYW5ndWFnZSBJZGVudGlmaWNhdGlvbiBtb2RlXG4gKiBAY2xhc3MgTGFuZ3VhZ2VJZE1vZGVcbiAqL1xuZXhwb3J0IHZhciBMYW5ndWFnZUlkTW9kZTtcbihmdW5jdGlvbiAoTGFuZ3VhZ2VJZE1vZGUpIHtcbiAgICAvKipcbiAgICAgKiBEZXRlY3QgbGFuZ3VhZ2UgYXQgYXVkaW8gc3RhcnRcbiAgICAgKiBAbWVtYmVyIExhbmd1YWdlSWRNb2RlLkF0U3RhcnRcbiAgICAgKi9cbiAgICBMYW5ndWFnZUlkTW9kZVtMYW5ndWFnZUlkTW9kZVtcIkF0U3RhcnRcIl0gPSAwXSA9IFwiQXRTdGFydFwiO1xuICAgIC8qKlxuICAgICAqIENvbnRpbnVvdXNseSBkZXRlY3QgbGFuZ3VhZ2VcbiAgICAgKiBAbWVtYmVyIExhbmd1YWdlSWRNb2RlLkNvbnRpbnVvdXNcbiAgICAgKi9cbiAgICBMYW5ndWFnZUlkTW9kZVtMYW5ndWFnZUlkTW9kZVtcIkNvbnRpbnVvdXNcIl0gPSAxXSA9IFwiQ29udGludW91c1wiO1xufSkoTGFuZ3VhZ2VJZE1vZGUgfHwgKExhbmd1YWdlSWRNb2RlID0ge30pKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9TGFuZ3VhZ2VJZE1vZGUuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtY2xhc3Nlcy1wZXItZmlsZVxuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4vQ29udHJhY3RzXCI7XG4vKipcbiAqIExhbmd1YWdlIHVuZGVyc3RhbmRpbmcgbW9kZWxcbiAqIEBjbGFzcyBMYW5ndWFnZVVuZGVyc3RhbmRpbmdNb2RlbFxuICovXG5leHBvcnQgY2xhc3MgTGFuZ3VhZ2VVbmRlcnN0YW5kaW5nTW9kZWwge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGEgbmV3IGluc3RhbmNlXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBsYW5ndWFnZSB1bmRlcnN0YW5kaW5nIG1vZGVsIHVzaW5nIHRoZSBzcGVjaWZpZWQgZW5kcG9pbnQuXG4gICAgICogQG1lbWJlciBMYW5ndWFnZVVuZGVyc3RhbmRpbmdNb2RlbC5mcm9tRW5kcG9pbnRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtVUkx9IHVyaSAtIEEgU3RyaW5nIHRoYXQgcmVwcmVzZW50cyB0aGUgZW5kcG9pbnQgb2YgdGhlIGxhbmd1YWdlIHVuZGVyc3RhbmRpbmcgbW9kZWwuXG4gICAgICogQHJldHVybnMge0xhbmd1YWdlVW5kZXJzdGFuZGluZ01vZGVsfSBUaGUgbGFuZ3VhZ2UgdW5kZXJzdGFuZGluZyBtb2RlbCBiZWluZyBjcmVhdGVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tRW5kcG9pbnQodXJpKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbCh1cmksIFwidXJpXCIpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodXJpLmhvc3RuYW1lLCBcInVyaVwiKTtcbiAgICAgICAgY29uc3QgbGFuZ01vZGVsSW1wID0gbmV3IExhbmd1YWdlVW5kZXJzdGFuZGluZ01vZGVsSW1wbCgpO1xuICAgICAgICAvLyBOZWVkIHRvIGV4dHJhY3QgdGhlIGFwcCBJRCBmcm9tIHRoZSBVUkwuXG4gICAgICAgIC8vIFVSTCBpcyBpbiB0aGUgZm9ybWF0OiBodHRwczovLzxyZWdpb24+LmFwaS5jb2duaXRpdmUubWljcm9zb2Z0LmNvbS9sdWlzL3YyLjAvYXBwcy88R3VpZD4/c3Vic2NyaXB0aW9uLWtleT08a2V5PiZ0aW1lem9uZU9mZnNldD0tMzYwXG4gICAgICAgIC8vIFN0YXJ0IHRlYXJpbmcgdGhlIHN0cmluZyBhcGFydC5cbiAgICAgICAgLy8gcmVnaW9uIGNhbiBiZSBleHRyYWN0ZWQgZnJvbSB0aGUgaG9zdCBuYW1lLlxuICAgICAgICBjb25zdCBmaXJzdERvdCA9IHVyaS5ob3N0LmluZGV4T2YoXCIuXCIpO1xuICAgICAgICBpZiAoLTEgPT09IGZpcnN0RG90KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZCBub3QgZGV0ZXJtaW5lIHJlZ2lvbiBmcm9tIGVuZHBvaW50XCIpO1xuICAgICAgICB9XG4gICAgICAgIGxhbmdNb2RlbEltcC5yZWdpb24gPSB1cmkuaG9zdC5zdWJzdHIoMCwgZmlyc3REb3QpO1xuICAgICAgICAvLyBOb3cgdGhlIGFwcCBJRC5cbiAgICAgICAgY29uc3QgbGFzdFNlZ21lbnQgPSB1cmkucGF0aG5hbWUubGFzdEluZGV4T2YoXCIvXCIpICsgMTtcbiAgICAgICAgaWYgKC0xID09PSBsYXN0U2VnbWVudCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ291bGQgbm90IGRldGVybWluZSBhcHBJZCBmcm9tIGVuZHBvaW50XCIpO1xuICAgICAgICB9XG4gICAgICAgIGxhbmdNb2RlbEltcC5hcHBJZCA9IHVyaS5wYXRobmFtZS5zdWJzdHIobGFzdFNlZ21lbnQpO1xuICAgICAgICAvLyBBbmQgZmluYWxseSB0aGUga2V5LlxuICAgICAgICBsYW5nTW9kZWxJbXAuc3Vic2NyaXB0aW9uS2V5ID0gdXJpLnNlYXJjaFBhcmFtcy5nZXQoXCJzdWJzY3JpcHRpb24ta2V5XCIpO1xuICAgICAgICBpZiAodW5kZWZpbmVkID09PSBsYW5nTW9kZWxJbXAuc3Vic2NyaXB0aW9uS2V5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZCBub3QgZGV0ZXJtaW5lIHN1YnNjcmlwdGlvbiBrZXkgZnJvbSBlbmRwb2ludFwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGFuZ01vZGVsSW1wO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGxhbmd1YWdlIHVuZGVyc3RhbmRpbmcgbW9kZWwgdXNpbmcgdGhlIGFwcGxpY2F0aW9uIGlkIG9mIExhbmd1YWdlIFVuZGVyc3RhbmRpbmcgc2VydmljZS5cbiAgICAgKiBAbWVtYmVyIExhbmd1YWdlVW5kZXJzdGFuZGluZ01vZGVsLmZyb21BcHBJZFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gYXBwSWQgLSBBIFN0cmluZyB0aGF0IHJlcHJlc2VudHMgdGhlIGFwcGxpY2F0aW9uIGlkIG9mIExhbmd1YWdlIFVuZGVyc3RhbmRpbmcgc2VydmljZS5cbiAgICAgKiBAcmV0dXJucyB7TGFuZ3VhZ2VVbmRlcnN0YW5kaW5nTW9kZWx9IFRoZSBsYW5ndWFnZSB1bmRlcnN0YW5kaW5nIG1vZGVsIGJlaW5nIGNyZWF0ZWQuXG4gICAgICovXG4gICAgc3RhdGljIGZyb21BcHBJZChhcHBJZCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UoYXBwSWQsIFwiYXBwSWRcIik7XG4gICAgICAgIGNvbnN0IGxhbmdNb2RlbEltcCA9IG5ldyBMYW5ndWFnZVVuZGVyc3RhbmRpbmdNb2RlbEltcGwoKTtcbiAgICAgICAgbGFuZ01vZGVsSW1wLmFwcElkID0gYXBwSWQ7XG4gICAgICAgIHJldHVybiBsYW5nTW9kZWxJbXA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBsYW5ndWFnZSB1bmRlcnN0YW5kaW5nIG1vZGVsIHVzaW5nIGhvc3RuYW1lLCBzdWJzY3JpcHRpb24ga2V5IGFuZCBhcHBsaWNhdGlvblxuICAgICAqIGlkIG9mIExhbmd1YWdlIFVuZGVyc3RhbmRpbmcgc2VydmljZS5cbiAgICAgKiBAbWVtYmVyIExhbmd1YWdlVW5kZXJzdGFuZGluZ01vZGVsLmZyb21TdWJzY3JpcHRpb25cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHN1YnNjcmlwdGlvbktleSAtIEEgU3RyaW5nIHRoYXQgcmVwcmVzZW50cyB0aGUgc3Vic2NyaXB0aW9uIGtleSBvZlxuICAgICAqIExhbmd1YWdlIFVuZGVyc3RhbmRpbmcgc2VydmljZS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gYXBwSWQgLSBBIFN0cmluZyB0aGF0IHJlcHJlc2VudHMgdGhlIGFwcGxpY2F0aW9uIGlkIG9mIExhbmd1YWdlXG4gICAgICogVW5kZXJzdGFuZGluZyBzZXJ2aWNlLlxuICAgICAqIEBwYXJhbSB7TGFuZ3VhZ2VVbmRlcnN0YW5kaW5nTW9kZWx9IHJlZ2lvbiAtIEEgU3RyaW5nIHRoYXQgcmVwcmVzZW50cyB0aGUgcmVnaW9uXG4gICAgICogb2YgdGhlIExhbmd1YWdlIFVuZGVyc3RhbmRpbmcgc2VydmljZSAoc2VlIHRoZSA8YSBocmVmPVwiaHR0cHM6Ly9ha2EubXMvY3NzcGVlY2gvcmVnaW9uXCI+cmVnaW9uIHBhZ2U8L2E+KS5cbiAgICAgKiBAcmV0dXJucyB7TGFuZ3VhZ2VVbmRlcnN0YW5kaW5nTW9kZWx9IFRoZSBsYW5ndWFnZSB1bmRlcnN0YW5kaW5nIG1vZGVsIGJlaW5nIGNyZWF0ZWQuXG4gICAgICovXG4gICAgc3RhdGljIGZyb21TdWJzY3JpcHRpb24oc3Vic2NyaXB0aW9uS2V5LCBhcHBJZCwgcmVnaW9uKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShzdWJzY3JpcHRpb25LZXksIFwic3Vic2NyaXB0aW9uS2V5XCIpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UoYXBwSWQsIFwiYXBwSWRcIik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShyZWdpb24sIFwicmVnaW9uXCIpO1xuICAgICAgICBjb25zdCBsYW5nTW9kZWxJbXAgPSBuZXcgTGFuZ3VhZ2VVbmRlcnN0YW5kaW5nTW9kZWxJbXBsKCk7XG4gICAgICAgIGxhbmdNb2RlbEltcC5hcHBJZCA9IGFwcElkO1xuICAgICAgICBsYW5nTW9kZWxJbXAucmVnaW9uID0gcmVnaW9uO1xuICAgICAgICBsYW5nTW9kZWxJbXAuc3Vic2NyaXB0aW9uS2V5ID0gc3Vic2NyaXB0aW9uS2V5O1xuICAgICAgICByZXR1cm4gbGFuZ01vZGVsSW1wO1xuICAgIH1cbn1cbi8qKlxuICogQHByaXZhdGVcbiAqIEBjbGFzcyBMYW5ndWFnZVVuZGVyc3RhbmRpbmdNb2RlbEltcGxcbiAqL1xuZXhwb3J0IGNsYXNzIExhbmd1YWdlVW5kZXJzdGFuZGluZ01vZGVsSW1wbCBleHRlbmRzIExhbmd1YWdlVW5kZXJzdGFuZGluZ01vZGVsIHtcbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9TGFuZ3VhZ2VVbmRlcnN0YW5kaW5nTW9kZWwuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFJlY29nbml0aW9uU3RhdHVzLCBTaW1wbGVTcGVlY2hQaHJhc2UgfSBmcm9tIFwiLi4vLi4vc3JjL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgTm9NYXRjaFJlYXNvbiB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogQ29udGFpbnMgZGV0YWlsZWQgaW5mb3JtYXRpb24gZm9yIE5vTWF0Y2ggcmVjb2duaXRpb24gcmVzdWx0cy5cbiAqIEBjbGFzcyBOb01hdGNoRGV0YWlsc1xuICovXG5leHBvcnQgY2xhc3MgTm9NYXRjaERldGFpbHMge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtOb01hdGNoUmVhc29ufSByZWFzb24gLSBUaGUgbm8tbWF0Y2ggcmVhc29uLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlYXNvbikge1xuICAgICAgICB0aGlzLnByaXZSZWFzb24gPSByZWFzb247XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgTm9NYXRjaERldGFpbHMgb2JqZWN0IGZvciB0aGUgTm9NYXRjaCBTcGVlY2hSZWNvZ25pdGlvblJlc3VsdHMuXG4gICAgICogQG1lbWJlciBOb01hdGNoRGV0YWlscy5mcm9tUmVzdWx0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7U3BlZWNoUmVjb2duaXRpb25SZXN1bHQgfCBJbnRlbnRSZWNvZ25pdGlvblJlc3VsdCB8IFRyYW5zbGF0aW9uUmVjb2duaXRpb25SZXN1bHR9XG4gICAgICogcmVzdWx0IC0gVGhlIHJlY29nbml0aW9uIHJlc3VsdCB0aGF0IHdhcyBub3QgcmVjb2duaXplZC5cbiAgICAgKiBAcmV0dXJucyB7Tm9NYXRjaERldGFpbHN9IFRoZSBubyBtYXRjaCBkZXRhaWxzIG9iamVjdCBiZWluZyBjcmVhdGVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tUmVzdWx0KHJlc3VsdCkge1xuICAgICAgICBjb25zdCBzaW1wbGVTcGVlY2ggPSBTaW1wbGVTcGVlY2hQaHJhc2UuZnJvbUpTT04ocmVzdWx0Lmpzb24pO1xuICAgICAgICBsZXQgcmVhc29uID0gTm9NYXRjaFJlYXNvbi5Ob3RSZWNvZ25pemVkO1xuICAgICAgICBzd2l0Y2ggKHNpbXBsZVNwZWVjaC5SZWNvZ25pdGlvblN0YXR1cykge1xuICAgICAgICAgICAgY2FzZSBSZWNvZ25pdGlvblN0YXR1cy5CYWJibGVUaW1lb3V0OlxuICAgICAgICAgICAgICAgIHJlYXNvbiA9IE5vTWF0Y2hSZWFzb24uSW5pdGlhbEJhYmJsZVRpbWVvdXQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFJlY29nbml0aW9uU3RhdHVzLkluaXRpYWxTaWxlbmNlVGltZW91dDpcbiAgICAgICAgICAgICAgICByZWFzb24gPSBOb01hdGNoUmVhc29uLkluaXRpYWxTaWxlbmNlVGltZW91dDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmVhc29uID0gTm9NYXRjaFJlYXNvbi5Ob3RSZWNvZ25pemVkO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgTm9NYXRjaERldGFpbHMocmVhc29uKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIHJlYXNvbiB0aGUgcmVjb2duaXRpb24gd2FzIGNhbmNlbGVkLlxuICAgICAqIEBtZW1iZXIgTm9NYXRjaERldGFpbHMucHJvdG90eXBlLnJlYXNvblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7Tm9NYXRjaFJlYXNvbn0gU3BlY2lmaWVzIHRoZSByZWFzb24gY2FuY2VsZWQuXG4gICAgICovXG4gICAgZ2V0IHJlYXNvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlYXNvbjtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPU5vTWF0Y2hEZXRhaWxzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIERlZmluZXMgdGhlIHBvc3NpYmxlIHJlYXNvbnMgYSByZWNvZ25pdGlvbiByZXN1bHQgbWlnaHQgbm90IGJlIHJlY29nbml6ZWQuXG4gKiBAY2xhc3MgTm9NYXRjaFJlYXNvblxuICovXG5leHBvcnQgdmFyIE5vTWF0Y2hSZWFzb247XG4oZnVuY3Rpb24gKE5vTWF0Y2hSZWFzb24pIHtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhhdCBzcGVlY2ggd2FzIGRldGVjdGVkLCBidXQgbm90IHJlY29nbml6ZWQuXG4gICAgICogQG1lbWJlciBOb01hdGNoUmVhc29uLk5vdFJlY29nbml6ZWRcbiAgICAgKi9cbiAgICBOb01hdGNoUmVhc29uW05vTWF0Y2hSZWFzb25bXCJOb3RSZWNvZ25pemVkXCJdID0gMF0gPSBcIk5vdFJlY29nbml6ZWRcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhhdCB0aGUgc3RhcnQgb2YgdGhlIGF1ZGlvIHN0cmVhbSBjb250YWluZWQgb25seSBzaWxlbmNlLFxuICAgICAqIGFuZCB0aGUgc2VydmljZSB0aW1lZCBvdXQgd2FpdGluZyBmb3Igc3BlZWNoLlxuICAgICAqIEBtZW1iZXIgTm9NYXRjaFJlYXNvbi5Jbml0aWFsU2lsZW5jZVRpbWVvdXRcbiAgICAgKi9cbiAgICBOb01hdGNoUmVhc29uW05vTWF0Y2hSZWFzb25bXCJJbml0aWFsU2lsZW5jZVRpbWVvdXRcIl0gPSAxXSA9IFwiSW5pdGlhbFNpbGVuY2VUaW1lb3V0XCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIHRoYXQgdGhlIHN0YXJ0IG9mIHRoZSBhdWRpbyBzdHJlYW0gY29udGFpbmVkIG9ubHkgbm9pc2UsXG4gICAgICogYW5kIHRoZSBzZXJ2aWNlIHRpbWVkIG91dCB3YWl0aW5nIGZvciBzcGVlY2guXG4gICAgICogQG1lbWJlciBOb01hdGNoUmVhc29uLkluaXRpYWxCYWJibGVUaW1lb3V0XG4gICAgICovXG4gICAgTm9NYXRjaFJlYXNvbltOb01hdGNoUmVhc29uW1wiSW5pdGlhbEJhYmJsZVRpbWVvdXRcIl0gPSAyXSA9IFwiSW5pdGlhbEJhYmJsZVRpbWVvdXRcIjtcbn0pKE5vTWF0Y2hSZWFzb24gfHwgKE5vTWF0Y2hSZWFzb24gPSB7fSkpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Ob01hdGNoUmVhc29uLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIERlZmluZSBTcGVlY2ggUmVjb2duaXplciBvdXRwdXQgZm9ybWF0cy5cbiAqIEBjbGFzcyBPdXRwdXRGb3JtYXRcbiAqL1xuZXhwb3J0IHZhciBPdXRwdXRGb3JtYXQ7XG4oZnVuY3Rpb24gKE91dHB1dEZvcm1hdCkge1xuICAgIC8qKlxuICAgICAqIEBtZW1iZXIgT3V0cHV0Rm9ybWF0LlNpbXBsZVxuICAgICAqL1xuICAgIE91dHB1dEZvcm1hdFtPdXRwdXRGb3JtYXRbXCJTaW1wbGVcIl0gPSAwXSA9IFwiU2ltcGxlXCI7XG4gICAgLyoqXG4gICAgICogQG1lbWJlciBPdXRwdXRGb3JtYXQuRGV0YWlsZWRcbiAgICAgKi9cbiAgICBPdXRwdXRGb3JtYXRbT3V0cHV0Rm9ybWF0W1wiRGV0YWlsZWRcIl0gPSAxXSA9IFwiRGV0YWlsZWRcIjtcbn0pKE91dHB1dEZvcm1hdCB8fCAoT3V0cHV0Rm9ybWF0ID0ge30pKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9T3V0cHV0Rm9ybWF0LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIEFsbG93cyBhZGRpdGlvbnMgb2YgbmV3IHBocmFzZXMgdG8gaW1wcm92ZSBzcGVlY2ggcmVjb2duaXRpb24uXG4gKlxuICogUGhyYXNlcyBhZGRlZCB0byB0aGUgcmVjb2duaXplciBhcmUgZWZmZWN0aXZlIGF0IHRoZSBzdGFydCBvZiB0aGUgbmV4dCByZWNvZ25pdGlvbiwgb3IgdGhlIG5leHQgdGltZSB0aGUgU3BlZWNoU0RLIG11c3QgcmVjb25uZWN0XG4gKiB0byB0aGUgc3BlZWNoIHNlcnZpY2UuXG4gKi9cbmV4cG9ydCBjbGFzcyBQaHJhc2VMaXN0R3JhbW1hciB7XG4gICAgY29uc3RydWN0b3IocmVjb2dCYXNlKSB7XG4gICAgICAgIHRoaXMucHJpdkdyYW1tZXJCdWlsZGVyID0gcmVjb2dCYXNlLmR5bmFtaWNHcmFtbWFyO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgUGhyYXNlTGlzdEdyYW1tYXIgZnJvbSBhIGdpdmVuIHNwZWVjaCByZWNvZ25pemVyLiBXaWxsIGFjY2VwdCBhbnkgcmVjb2duaXplciB0aGF0IGRlcml2ZXMgZnJvbSBAY2xhc3MgUmVjb2duaXplci5cbiAgICAgKiBAcGFyYW0gcmVjb2duaXplciBUaGUgcmVjb2duaXplciB0byBhZGQgcGhyYXNlIGxpc3RzIHRvLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tUmVjb2duaXplcihyZWNvZ25pemVyKSB7XG4gICAgICAgIGNvbnN0IHJlY29CYXNlID0gcmVjb2duaXplci5pbnRlcm5hbERhdGE7XG4gICAgICAgIHJldHVybiBuZXcgUGhyYXNlTGlzdEdyYW1tYXIocmVjb0Jhc2UpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgc2luZ2xlIHBocmFzZSB0byB0aGUgY3VycmVudCByZWNvZ25pemVyLlxuICAgICAqIEBwYXJhbSBwaHJhc2UgUGhyYXNlIHRvIGFkZC5cbiAgICAgKi9cbiAgICBhZGRQaHJhc2UocGhyYXNlKSB7XG4gICAgICAgIHRoaXMucHJpdkdyYW1tZXJCdWlsZGVyLmFkZFBocmFzZShwaHJhc2UpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIG11bHRpcGxlIHBocmFzZXMgdG8gdGhlIGN1cnJlbnQgcmVjb2duaXplci5cbiAgICAgKiBAcGFyYW0gcGhyYXNlcyBBcnJheSBvZiBwaHJhc2VzIHRvIGFkZC5cbiAgICAgKi9cbiAgICBhZGRQaHJhc2VzKHBocmFzZXMpIHtcbiAgICAgICAgdGhpcy5wcml2R3JhbW1lckJ1aWxkZXIuYWRkUGhyYXNlKHBocmFzZXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbGVhcnMgYWxsIHBocmFzZXMgYWRkZWQgdG8gdGhlIGN1cnJlbnQgcmVjb2duaXplci5cbiAgICAgKi9cbiAgICBjbGVhcigpIHtcbiAgICAgICAgdGhpcy5wcml2R3JhbW1lckJ1aWxkZXIuY2xlYXJQaHJhc2VzKCk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1QaHJhc2VMaXN0R3JhbW1hci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBQcm9mYW5pdHkgb3B0aW9uLlxuICogQWRkZWQgaW4gdmVyc2lvbiAxLjcuMC5cbiAqL1xuZXhwb3J0IHZhciBQcm9mYW5pdHlPcHRpb247XG4oZnVuY3Rpb24gKFByb2Zhbml0eU9wdGlvbikge1xuICAgIFByb2Zhbml0eU9wdGlvbltQcm9mYW5pdHlPcHRpb25bXCJNYXNrZWRcIl0gPSAwXSA9IFwiTWFza2VkXCI7XG4gICAgUHJvZmFuaXR5T3B0aW9uW1Byb2Zhbml0eU9wdGlvbltcIlJlbW92ZWRcIl0gPSAxXSA9IFwiUmVtb3ZlZFwiO1xuICAgIFByb2Zhbml0eU9wdGlvbltQcm9mYW5pdHlPcHRpb25bXCJSYXdcIl0gPSAyXSA9IFwiUmF3XCI7XG59KShQcm9mYW5pdHlPcHRpb24gfHwgKFByb2Zhbml0eU9wdGlvbiA9IHt9KSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVByb2Zhbml0eU9wdGlvbi5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYWRpbmdTeXN0ZW0sIFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhbnVsYXJpdHksIFByb3BlcnR5Q29sbGVjdGlvbiwgUHJvcGVydHlJZCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogUHJvbnVuY2lhdGlvbiBhc3Nlc3NtZW50IGNvbmZpZ3VyYXRpb24uXG4gKiBAY2xhc3MgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRDb25maWdcbiAqIEFkZGVkIGluIHZlcnNpb24gMS4xNS4wLlxuICovXG5leHBvcnQgY2xhc3MgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRDb25maWcge1xuICAgIC8qKlxuICAgICAqIFByb251bmNpYXRpb25Bc3Nlc3NtZW50Q29uZmlnIGNvbnN0cnVjdG9yLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZWZlcmVuY2VUZXh0XG4gICAgICogQHBhcmFtIGdyYWRpbmdTeXN0ZW1cbiAgICAgKiBAcGFyYW0gZ3JhbnVsYXJpdHlcbiAgICAgKiBAcGFyYW0gZW5hYmxlTWlzY3VlXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVmZXJlbmNlVGV4dCwgZ3JhZGluZ1N5c3RlbSA9IFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhZGluZ1N5c3RlbS5GaXZlUG9pbnQsIGdyYW51bGFyaXR5ID0gUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFudWxhcml0eS5QaG9uZW1lLCBlbmFibGVNaXNjdWUgPSBmYWxzZSkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChyZWZlcmVuY2VUZXh0LCBcInJlZmVyZW5jZVRleHRcIik7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMgPSBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCk7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5Qcm9udW5jaWF0aW9uQXNzZXNzbWVudF9SZWZlcmVuY2VUZXh0LCByZWZlcmVuY2VUZXh0KTtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlByb251bmNpYXRpb25Bc3Nlc3NtZW50X0dyYWRpbmdTeXN0ZW0sIFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhZGluZ1N5c3RlbVtncmFkaW5nU3lzdGVtXSk7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5Qcm9udW5jaWF0aW9uQXNzZXNzbWVudF9HcmFudWxhcml0eSwgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFudWxhcml0eVtncmFudWxhcml0eV0pO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfRW5hYmxlTWlzY3VlLCBTdHJpbmcoZW5hYmxlTWlzY3VlKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBtZW1iZXIgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRDb25maWcuZnJvbUpTT05cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGpzb24gVGhlIGpzb24gc3RyaW5nIGNvbnRhaW5pbmcgdGhlIHByb251bmNpYXRpb24gYXNzZXNzbWVudCBwYXJhbWV0ZXJzLlxuICAgICAqIEByZXR1cm4ge1Byb251bmNpYXRpb25Bc3Nlc3NtZW50Q29uZmlnfSBJbnN0YW5jZSBvZiBQcm9udW5jaWF0aW9uQXNzZXNzbWVudENvbmZpZ1xuICAgICAqIEBzdW1tYXJ5IENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgdGhlIFByb251bmNpYXRpb25Bc3Nlc3NtZW50Q29uZmlnIGZyb20ganNvbi5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbUpTT04oanNvbikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChqc29uLCBcImpzb25cIik7XG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IG5ldyBQcm9udW5jaWF0aW9uQXNzZXNzbWVudENvbmZpZyhcIlwiKTtcbiAgICAgICAgY29uZmlnLnByaXZQcm9wZXJ0aWVzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICBjb25maWcucHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlByb251bmNpYXRpb25Bc3Nlc3NtZW50X0pzb24sIGpzb24pO1xuICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHRoaXMudXBkYXRlSnNvbigpO1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlByb251bmNpYXRpb25Bc3Nlc3NtZW50X1BhcmFtcyk7XG4gICAgfVxuICAgIGFwcGx5VG8ocmVjb2duaXplcikge1xuICAgICAgICB0aGlzLnVwZGF0ZUpzb24oKTtcbiAgICAgICAgY29uc3QgcmVjb0Jhc2UgPSByZWNvZ25pemVyLmludGVybmFsRGF0YTtcbiAgICAgICAgcmVjb0Jhc2Uuc3BlZWNoQ29udGV4dC5zZXRQcm9udW5jaWF0aW9uQXNzZXNzbWVudFBhcmFtcyh0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5Qcm9udW5jaWF0aW9uQXNzZXNzbWVudF9QYXJhbXMpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgcmVmZXJlbmNlIHRleHQuXG4gICAgICogQG1lbWJlciBQcm9udW5jaWF0aW9uQXNzZXNzbWVudENvbmZpZy5wcm90b3R5cGUucmVmZXJlbmNlVGV4dFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBSZWZlcmVuY2UgdGV4dC5cbiAgICAgKi9cbiAgICBnZXQgcmVmZXJlbmNlVGV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlByb251bmNpYXRpb25Bc3Nlc3NtZW50X1JlZmVyZW5jZVRleHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzL1NldHMgdGhlIHJlZmVyZW5jZSB0ZXh0LlxuICAgICAqIEBtZW1iZXIgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRDb25maWcucHJvdG90eXBlLnJlZmVyZW5jZVRleHRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHJlZmVyZW5jZVRleHQgLSBSZWZlcmVuY2UgdGV4dC5cbiAgICAgKi9cbiAgICBzZXQgcmVmZXJlbmNlVGV4dChyZWZlcmVuY2VUZXh0KSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShyZWZlcmVuY2VUZXh0LCBcInJlZmVyZW5jZVRleHRcIik7XG4gICAgICAgIHRoaXMucHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlByb251bmNpYXRpb25Bc3Nlc3NtZW50X1JlZmVyZW5jZVRleHQsIHJlZmVyZW5jZVRleHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBwaG9uZW1lIGFscGhhYmV0LlxuICAgICAqIFRoZSB2YWxpZCB2YWx1ZXMgYXJlIFwiU0FQSVwiIChkZWZhdWx0KSBhbmQgXCJJUEFcIi5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMjAuMFxuICAgICAqIEBtZW1iZXIgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRDb25maWcucHJvdG90eXBlLnBob25lbWVBbHBoYWJldFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcGhvbmVtZUFscGhhYmV0IC0gUGhvbmVtZSBhbHBoYWJldC5cbiAgICAgKi9cbiAgICBzZXQgcGhvbmVtZUFscGhhYmV0KHBob25lbWVBbHBoYWJldCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UocGhvbmVtZUFscGhhYmV0LCBcInBob25lbWVBbHBoYWJldFwiKTtcbiAgICAgICAgdGhpcy5wcml2UGhvbmVtZUFscGhhYmV0ID0gcGhvbmVtZUFscGhhYmV0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBib29sZWFuIGVuYWJsZU1pc2N1ZSBwcm9wZXJ0eS5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMjYuMFxuICAgICAqIEBtZW1iZXIgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRDb25maWcucHJvdG90eXBlLmVuYWJsZU1pc2N1ZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGVuYWJsZU1pc2N1ZSAtIGVuYWJsZSBtaXNjdWUuXG4gICAgICovXG4gICAgc2V0IGVuYWJsZU1pc2N1ZShlbmFibGVNaXNjdWUpIHtcbiAgICAgICAgY29uc3QgZW5hYmxlTWlzY3VlU3RyaW5nID0gZW5hYmxlTWlzY3VlID8gXCJ0cnVlXCIgOiBcImZhbHNlXCI7XG4gICAgICAgIHRoaXMucHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlByb251bmNpYXRpb25Bc3Nlc3NtZW50X0VuYWJsZU1pc2N1ZSwgZW5hYmxlTWlzY3VlU3RyaW5nKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgYm9vbGVhbiBlbmFibGVNaXNjdWUgcHJvcGVydHkuXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjI2LjBcbiAgICAgKiBAbWVtYmVyIFByb251bmNpYXRpb25Bc3Nlc3NtZW50Q29uZmlnLnByb3RvdHlwZS5lbmFibGVNaXNjdWVcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gZW5hYmxlTWlzY3VlIC0gZW5hYmxlIG1pc2N1ZS5cbiAgICAgKi9cbiAgICBnZXQgZW5hYmxlTWlzY3VlKCkge1xuICAgICAgICBjb25zdCBlbmFibGVNaXNjdWVTdHJpbmcgPSB0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5Qcm9udW5jaWF0aW9uQXNzZXNzbWVudF9FbmFibGVNaXNjdWUsIFwiZmFsc2VcIik7XG4gICAgICAgIHJldHVybiAoZW5hYmxlTWlzY3VlU3RyaW5nLnRvTG93ZXJDYXNlKCkgPT09IFwidHJ1ZVwiKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgbmJlc3QgcGhvbmVtZSBjb3VudFxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4yMC4wXG4gICAgICogQG1lbWJlciBQcm9udW5jaWF0aW9uQXNzZXNzbWVudENvbmZpZy5wcm90b3R5cGUubmJlc3RQaG9uZW1lQ291bnRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG5iZXN0UGhvbmVtZUNvdW50IC0gTkJlc3QgcGhvbmVtZSBjb3VudC5cbiAgICAgKi9cbiAgICBzZXQgbmJlc3RQaG9uZW1lQ291bnQobmJlc3RQaG9uZW1lQ291bnQpIHtcbiAgICAgICAgdGhpcy5wcml2TkJlc3RQaG9uZW1lQ291bnQgPSBuYmVzdFBob25lbWVDb3VudDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQG1lbWJlciBQcm9udW5jaWF0aW9uQXNzZXNzbWVudENvbmZpZy5wcm90b3R5cGUucHJvcGVydGllc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJuIHtQcm9wZXJ0eUNvbGxlY3Rpb259IFByb3BlcnRpZXMgb2YgdGhlIGNvbmZpZy5cbiAgICAgKiBAc3VtbWFyeSBHZXRzIGEgcHJvbnVuY2lhdGlvbiBhc3Nlc3NtZW50IGNvbmZpZyBwcm9wZXJ0aWVzXG4gICAgICovXG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzO1xuICAgIH1cbiAgICB1cGRhdGVKc29uKCkge1xuICAgICAgICBjb25zdCBqc29uU3RyaW5nID0gdGhpcy5wcml2UHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlByb251bmNpYXRpb25Bc3Nlc3NtZW50X0pzb24sIFwie31cIik7XG4gICAgICAgIGNvbnN0IHBhcmFtc0pzb24gPSBKU09OLnBhcnNlKGpzb25TdHJpbmcpO1xuICAgICAgICBjb25zdCByZWZlcmVuY2VUZXh0ID0gdGhpcy5wcml2UHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlByb251bmNpYXRpb25Bc3Nlc3NtZW50X1JlZmVyZW5jZVRleHQpO1xuICAgICAgICBpZiAocmVmZXJlbmNlVGV4dCkge1xuICAgICAgICAgICAgcGFyYW1zSnNvbi5yZWZlcmVuY2VUZXh0ID0gcmVmZXJlbmNlVGV4dDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBncmFkaW5nU3lzdGVtID0gdGhpcy5wcml2UHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlByb251bmNpYXRpb25Bc3Nlc3NtZW50X0dyYWRpbmdTeXN0ZW0pO1xuICAgICAgICBpZiAoZ3JhZGluZ1N5c3RlbSkge1xuICAgICAgICAgICAgcGFyYW1zSnNvbi5ncmFkaW5nU3lzdGVtID0gZ3JhZGluZ1N5c3RlbTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBncmFudWxhcml0eSA9IHRoaXMucHJpdlByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5Qcm9udW5jaWF0aW9uQXNzZXNzbWVudF9HcmFudWxhcml0eSk7XG4gICAgICAgIGlmIChncmFudWxhcml0eSkge1xuICAgICAgICAgICAgcGFyYW1zSnNvbi5ncmFudWxhcml0eSA9IGdyYW51bGFyaXR5O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnByaXZQaG9uZW1lQWxwaGFiZXQpIHtcbiAgICAgICAgICAgIHBhcmFtc0pzb24ucGhvbmVtZUFscGhhYmV0ID0gdGhpcy5wcml2UGhvbmVtZUFscGhhYmV0O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnByaXZOQmVzdFBob25lbWVDb3VudCkge1xuICAgICAgICAgICAgcGFyYW1zSnNvbi5uYmVzdFBob25lbWVDb3VudCA9IHRoaXMucHJpdk5CZXN0UGhvbmVtZUNvdW50O1xuICAgICAgICB9XG4gICAgICAgIC8vIGFsd2F5cyBzZXQgZGltZW5zaW9uIHRvIENvbXByZWhlbnNpdmVcbiAgICAgICAgcGFyYW1zSnNvbi5kaW1lbnNpb24gPSBcIkNvbXByZWhlbnNpdmVcIjtcbiAgICAgICAgcGFyYW1zSnNvbi5lbmFibGVNaXNjdWUgPSB0aGlzLmVuYWJsZU1pc2N1ZTtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlByb251bmNpYXRpb25Bc3Nlc3NtZW50X1BhcmFtcywgSlNPTi5zdHJpbmdpZnkocGFyYW1zSnNvbikpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRDb25maWcuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogRGVmaW5lcyB0aGUgcG9pbnQgc3lzdGVtIGZvciBwcm9udW5jaWF0aW9uIHNjb3JlIGNhbGlicmF0aW9uOyBkZWZhdWx0IHZhbHVlIGlzIEZpdmVQb2ludC5cbiAqIEFkZGVkIGluIHZlcnNpb24gMS4xNS4wXG4gKiBAY2xhc3MgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFkaW5nU3lzdGVtXG4gKi9cbmV4cG9ydCB2YXIgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFkaW5nU3lzdGVtO1xuKGZ1bmN0aW9uIChQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYWRpbmdTeXN0ZW0pIHtcbiAgICAvKipcbiAgICAgKiBGaXZlIHBvaW50IGNhbGlicmF0aW9uXG4gICAgICogQG1lbWJlciBQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYWRpbmdTeXN0ZW0uRml2ZVBvaW50XG4gICAgICovXG4gICAgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFkaW5nU3lzdGVtW1Byb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhZGluZ1N5c3RlbVtcIkZpdmVQb2ludFwiXSA9IDFdID0gXCJGaXZlUG9pbnRcIjtcbiAgICAvKipcbiAgICAgKiBIdW5kcmVkIG1hcmtcbiAgICAgKiBAbWVtYmVyIFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhZGluZ1N5c3RlbS5IdW5kcmVkTWFya1xuICAgICAqL1xuICAgIFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhZGluZ1N5c3RlbVtQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYWRpbmdTeXN0ZW1bXCJIdW5kcmVkTWFya1wiXSA9IDJdID0gXCJIdW5kcmVkTWFya1wiO1xufSkoUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFkaW5nU3lzdGVtIHx8IChQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYWRpbmdTeXN0ZW0gPSB7fSkpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Qcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYWRpbmdTeXN0ZW0uanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogRGVmaW5lcyB0aGUgcHJvbnVuY2lhdGlvbiBldmFsdWF0aW9uIGdyYW51bGFyaXR5OyBkZWZhdWx0IHZhbHVlIGlzIFBob25lbWUuXG4gKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTUuMFxuICogQGNsYXNzIFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhbnVsYXJpdHlcbiAqL1xuZXhwb3J0IHZhciBQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYW51bGFyaXR5O1xuKGZ1bmN0aW9uIChQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYW51bGFyaXR5KSB7XG4gICAgLyoqXG4gICAgICogU2hvd3MgdGhlIHNjb3JlIG9uIHRoZSBmdWxsIHRleHQsIHdvcmQgYW5kIHBob25lbWUgbGV2ZWxcbiAgICAgKiBAbWVtYmVyIFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhbnVsYXJpdHkuUGhvbmVtZVxuICAgICAqL1xuICAgIFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhbnVsYXJpdHlbUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFudWxhcml0eVtcIlBob25lbWVcIl0gPSAxXSA9IFwiUGhvbmVtZVwiO1xuICAgIC8qKlxuICAgICAqIFNob3dzIHRoZSBzY29yZSBvbiB0aGUgZnVsbCB0ZXh0IGFuZCB3b3JkIGxldmVsXG4gICAgICogQG1lbWJlciBQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYW51bGFyaXR5LldvcmRcbiAgICAgKi9cbiAgICBQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYW51bGFyaXR5W1Byb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhbnVsYXJpdHlbXCJXb3JkXCJdID0gMl0gPSBcIldvcmRcIjtcbiAgICAvKipcbiAgICAgKiBTaG93cyB0aGUgc2NvcmUgb24gdGhlIGZ1bGwgdGV4dCBsZXZlbCBvbmx5XG4gICAgICogQG1lbWJlciBQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYW51bGFyaXR5LkZ1bGxUZXh0XG4gICAgICovXG4gICAgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFudWxhcml0eVtQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYW51bGFyaXR5W1wiRnVsbFRleHRcIl0gPSAzXSA9IFwiRnVsbFRleHRcIjtcbn0pKFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhbnVsYXJpdHkgfHwgKFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhbnVsYXJpdHkgPSB7fSkpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Qcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYW51bGFyaXR5LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi9Db250cmFjdHNcIjtcbmltcG9ydCB7IFByb3BlcnR5SWQgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIFByb251bmNpYXRpb24gYXNzZXNzbWVudCByZXN1bHRzLlxuICogQGNsYXNzIFByb251bmNpYXRpb25Bc3Nlc3NtZW50UmVzdWx0XG4gKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTUuMC5cbiAqL1xuZXhwb3J0IGNsYXNzIFByb251bmNpYXRpb25Bc3Nlc3NtZW50UmVzdWx0IHtcbiAgICBjb25zdHJ1Y3Rvcihqc29uU3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IGogPSBKU09OLnBhcnNlKGpzb25TdHJpbmcpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChqLk5CZXN0WzBdLCBcIk5CZXN0XCIpO1xuICAgICAgICB0aGlzLnByaXZQcm9uSnNvbiA9IGouTkJlc3RbMF07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBtZW1iZXIgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRSZXN1bHQuZnJvbVJlc3VsdFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge1JlY29nbml0aW9uUmVzdWx0fSByZXN1bHQgVGhlIHJlY29nbml0aW9uIHJlc3VsdC5cbiAgICAgKiBAcmV0dXJuIHtQcm9udW5jaWF0aW9uQXNzZXNzbWVudENvbmZpZ30gSW5zdGFuY2Ugb2YgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRDb25maWdcbiAgICAgKiBAc3VtbWFyeSBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIHRoZSBQcm9udW5jaWF0aW9uQXNzZXNzbWVudFJlc3VsdCBmcm9tIHJlY29nbml0aW9uIHJlc3VsdC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbVJlc3VsdChyZXN1bHQpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQocmVzdWx0LCBcInJlc3VsdFwiKTtcbiAgICAgICAgY29uc3QganNvbiA9IHJlc3VsdC5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZVJlc3BvbnNlX0pzb25SZXN1bHQpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChqc29uLCBcImpzb25cIik7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRSZXN1bHQoanNvbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGRldGFpbCByZXN1bHQgb2YgcHJvbnVuY2lhdGlvbiBhc3Nlc3NtZW50LlxuICAgICAqIEBtZW1iZXIgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRDb25maWcucHJvdG90eXBlLmRldGFpbFJlc3VsdFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7RGV0YWlsUmVzdWx0fSBkZXRhaWwgcmVzdWx0LlxuICAgICAqL1xuICAgIGdldCBkZXRhaWxSZXN1bHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9uSnNvbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIHNjb3JlIGluZGljYXRpbmcgdGhlIHByb251bmNpYXRpb24gYWNjdXJhY3kgb2YgdGhlIGdpdmVuIHNwZWVjaCwgd2hpY2ggaW5kaWNhdGVzXG4gICAgICogaG93IGNsb3NlbHkgdGhlIHBob25lbWVzIG1hdGNoIGEgbmF0aXZlIHNwZWFrZXIncyBwcm9udW5jaWF0aW9uLlxuICAgICAqIEBtZW1iZXIgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRSZXN1bHQucHJvdG90eXBlLmFjY3VyYWN5U2NvcmVcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge251bWJlcn0gQWNjdXJhY3kgc2NvcmUuXG4gICAgICovXG4gICAgZ2V0IGFjY3VyYWN5U2NvcmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRldGFpbFJlc3VsdC5Qcm9udW5jaWF0aW9uQXNzZXNzbWVudC5BY2N1cmFjeVNjb3JlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgb3ZlcmFsbCBzY29yZSBpbmRpY2F0aW5nIHRoZSBwcm9udW5jaWF0aW9uIHF1YWxpdHkgb2YgdGhlIGdpdmVuIHNwZWVjaC5cbiAgICAgKiBUaGlzIGlzIGNhbGN1bGF0ZWQgZnJvbSBBY2N1cmFjeVNjb3JlLCBGbHVlbmN5U2NvcmUgYW5kIENvbXBsZXRlbmVzc1Njb3JlIHdpdGggd2VpZ2h0LlxuICAgICAqIEBtZW1iZXIgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRSZXN1bHQucHJvdG90eXBlLnByb251bmNpYXRpb25TY29yZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBQcm9udW5jaWF0aW9uIHNjb3JlLlxuICAgICAqL1xuICAgIGdldCBwcm9udW5jaWF0aW9uU2NvcmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRldGFpbFJlc3VsdC5Qcm9udW5jaWF0aW9uQXNzZXNzbWVudC5Qcm9uU2NvcmU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBzY29yZSBpbmRpY2F0aW5nIHRoZSBjb21wbGV0ZW5lc3Mgb2YgdGhlIGdpdmVuIHNwZWVjaCBieSBjYWxjdWxhdGluZyB0aGUgcmF0aW8gb2YgcHJvbm91bmNlZCB3b3JkcyB0b3dhcmRzIGVudGlyZSBpbnB1dC5cbiAgICAgKiBAbWVtYmVyIFByb251bmNpYXRpb25Bc3Nlc3NtZW50UmVzdWx0LnByb3RvdHlwZS5jb21wbGV0ZW5lc3NTY29yZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBDb21wbGV0ZW5lc3Mgc2NvcmUuXG4gICAgICovXG4gICAgZ2V0IGNvbXBsZXRlbmVzc1Njb3JlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kZXRhaWxSZXN1bHQuUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnQuQ29tcGxldGVuZXNzU2NvcmU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBzY29yZSBpbmRpY2F0aW5nIHRoZSBmbHVlbmN5IG9mIHRoZSBnaXZlbiBzcGVlY2guXG4gICAgICogQG1lbWJlciBQcm9udW5jaWF0aW9uQXNzZXNzbWVudFJlc3VsdC5wcm90b3R5cGUuZmx1ZW5jeVNjb3JlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IEZsdWVuY3kgc2NvcmUuXG4gICAgICovXG4gICAgZ2V0IGZsdWVuY3lTY29yZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGV0YWlsUmVzdWx0LlByb251bmNpYXRpb25Bc3Nlc3NtZW50LkZsdWVuY3lTY29yZTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVByb251bmNpYXRpb25Bc3Nlc3NtZW50UmVzdWx0LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBQcm9wZXJ0eUlkIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBSZXByZXNlbnRzIGNvbGxlY3Rpb24gb2YgcHJvcGVydGllcyBhbmQgdGhlaXIgdmFsdWVzLlxuICogQGNsYXNzIFByb3BlcnR5Q29sbGVjdGlvblxuICovXG5leHBvcnQgY2xhc3MgUHJvcGVydHlDb2xsZWN0aW9uIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5wcml2S2V5cyA9IFtdO1xuICAgICAgICB0aGlzLnByaXZWYWx1ZXMgPSBbXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgcHJvcGVydHkgdmFsdWUgaW4gdHlwZSBTdHJpbmcuXG4gICAgICogQ3VycmVudGx5IG9ubHkgU3RyaW5nLCBpbnQgYW5kIGJvb2wgYXJlIGFsbG93ZWQuXG4gICAgICogSWYgdGhlIG5hbWUgaXMgbm90IGF2YWlsYWJsZSwgdGhlIHNwZWNpZmllZCBkZWZhdWx0VmFsdWUgaXMgcmV0dXJuZWQuXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUNvbGxlY3Rpb24ucHJvdG90eXBlLmdldFByb3BlcnR5XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgLSBUaGUgcGFyYW1ldGVyIG5hbWUuXG4gICAgICogQHBhcmFtIHtzdHJpbmcgfCBudW1iZXIgfCBib29sZWFufSBkZWYgLSBUaGUgZGVmYXVsdCB2YWx1ZSB3aGljaCBpcyByZXR1cm5lZCBpZiB0aGUgcGFyYW1ldGVyXG4gICAgICogaXMgbm90IGF2YWlsYWJsZSBpbiB0aGUgY29sbGVjdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSB2YWx1ZSBvZiB0aGUgcGFyYW1ldGVyLlxuICAgICAqL1xuICAgIGdldFByb3BlcnR5KGtleSwgZGVmKSB7XG4gICAgICAgIGxldCBrZXlUb1VzZTtcbiAgICAgICAgaWYgKHR5cGVvZiBrZXkgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIGtleVRvVXNlID0ga2V5O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAga2V5VG9Vc2UgPSBQcm9wZXJ0eUlkW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCB0aGlzLnByaXZLZXlzLmxlbmd0aDsgbisrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2S2V5c1tuXSA9PT0ga2V5VG9Vc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2VmFsdWVzW25dO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChkZWYgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gU3RyaW5nKGRlZik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIFN0cmluZyB2YWx1ZSBvZiB0aGUgcGFyYW1ldGVyIHNwZWNpZmllZCBieSBuYW1lLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlDb2xsZWN0aW9uLnByb3RvdHlwZS5zZXRQcm9wZXJ0eVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IC0gVGhlIHBhcmFtZXRlciBuYW1lLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZSAtIFRoZSB2YWx1ZSBvZiB0aGUgcGFyYW1ldGVyLlxuICAgICAqL1xuICAgIHNldFByb3BlcnR5KGtleSwgdmFsdWUpIHtcbiAgICAgICAgbGV0IGtleVRvVXNlO1xuICAgICAgICBpZiAodHlwZW9mIGtleSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAga2V5VG9Vc2UgPSBrZXk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBrZXlUb1VzZSA9IFByb3BlcnR5SWRba2V5XTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IHRoaXMucHJpdktleXMubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZLZXlzW25dID09PSBrZXlUb1VzZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlZhbHVlc1tuXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZLZXlzLnB1c2goa2V5VG9Vc2UpO1xuICAgICAgICB0aGlzLnByaXZWYWx1ZXMucHVzaCh2YWx1ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsb25lcyB0aGUgY29sbGVjdGlvbi5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5Q29sbGVjdGlvbi5wcm90b3R5cGUuY2xvbmVcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1Byb3BlcnR5Q29sbGVjdGlvbn0gQSBjb3B5IG9mIHRoZSBjb2xsZWN0aW9uLlxuICAgICAqL1xuICAgIGNsb25lKCkge1xuICAgICAgICBjb25zdCBjbG9uZWRNYXAgPSBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCk7XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdGhpcy5wcml2S2V5cy5sZW5ndGg7IG4rKykge1xuICAgICAgICAgICAgY2xvbmVkTWFwLnByaXZLZXlzLnB1c2godGhpcy5wcml2S2V5c1tuXSk7XG4gICAgICAgICAgICBjbG9uZWRNYXAucHJpdlZhbHVlcy5wdXNoKHRoaXMucHJpdlZhbHVlc1tuXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNsb25lZE1hcDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTWVyZ2VzIHRoaXMgc2V0IG9mIHByb3BlcnRpZXMgaW50byBhbm90aGVyLCBubyBvdmVyd3JpdGVzLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlDb2xsZWN0aW9uLnByb3RvdHlwZS5tZXJnZVRvXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7UHJvcGVydHlDb2xsZWN0aW9ufSAgZGVzdGluYXRpb25Db2xsZWN0aW9uIC0gVGhlIGNvbGxlY3Rpb24gdG8gbWVyZ2UgaW50by5cbiAgICAgKi9cbiAgICBtZXJnZVRvKGRlc3RpbmF0aW9uQ29sbGVjdGlvbikge1xuICAgICAgICB0aGlzLnByaXZLZXlzLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgICAgICAgaWYgKGRlc3RpbmF0aW9uQ29sbGVjdGlvbi5nZXRQcm9wZXJ0eShrZXksIHVuZGVmaW5lZCkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5nZXRQcm9wZXJ0eShrZXkpO1xuICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uQ29sbGVjdGlvbi5zZXRQcm9wZXJ0eShrZXksIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCB0aGUga2V5cyBpbiBQcm9wZXJ0eSBDb2xsZWN0aW9uLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlDb2xsZWN0aW9uLnByb3RvdHlwZS5rZXlzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmcgW119IEtleXMgaW4gdGhlIGNvbGxlY3Rpb24uXG4gICAgICovXG4gICAgZ2V0IGtleXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZLZXlzO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UHJvcGVydHlDb2xsZWN0aW9uLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIERlZmluZXMgc3BlZWNoIHByb3BlcnR5IGlkcy5cbiAqIEBjbGFzcyBQcm9wZXJ0eUlkXG4gKi9cbmV4cG9ydCB2YXIgUHJvcGVydHlJZDtcbihmdW5jdGlvbiAoUHJvcGVydHlJZCkge1xuICAgIC8qKlxuICAgICAqIFRoZSBDb2duaXRpdmUgU2VydmljZXMgU3BlZWNoIFNlcnZpY2Ugc3Vic2NyaXB0aW9uIEtleS4gSWYgeW91IGFyZSB1c2luZyBhbiBpbnRlbnQgcmVjb2duaXplciwgeW91IG5lZWQgdG9cbiAgICAgKiBzcGVjaWZ5IHRoZSBMVUlTIGVuZHBvaW50IGtleSBmb3IgeW91ciBwYXJ0aWN1bGFyIExVSVMgYXBwLiBVbmRlciBub3JtYWwgY2lyY3Vtc3RhbmNlcywgeW91IHNob3VsZG4ndFxuICAgICAqIGhhdmUgdG8gdXNlIHRoaXMgcHJvcGVydHkgZGlyZWN0bHkuXG4gICAgICogSW5zdGVhZCwgdXNlIFtbU3BlZWNoQ29uZmlnLmZyb21TdWJzY3JpcHRpb25dXS5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fS2V5XG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fS2V5XCJdID0gMF0gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0tleVwiO1xuICAgIC8qKlxuICAgICAqIFRoZSBDb2duaXRpdmUgU2VydmljZXMgU3BlZWNoIFNlcnZpY2UgZW5kcG9pbnQgKHVybCkuIFVuZGVyIG5vcm1hbCBjaXJjdW1zdGFuY2VzLCB5b3Ugc2hvdWxkbid0XG4gICAgICogaGF2ZSB0byB1c2UgdGhpcyBwcm9wZXJ0eSBkaXJlY3RseS5cbiAgICAgKiBJbnN0ZWFkLCB1c2UgW1tTcGVlY2hDb25maWcuZnJvbUVuZHBvaW50XV0uXG4gICAgICogTk9URTogVGhpcyBlbmRwb2ludCBpcyBub3QgdGhlIHNhbWUgYXMgdGhlIGVuZHBvaW50IHVzZWQgdG8gb2J0YWluIGFuIGFjY2VzcyB0b2tlbi5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnRcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludFwiXSA9IDFdID0gXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludFwiO1xuICAgIC8qKlxuICAgICAqIFRoZSBDb2duaXRpdmUgU2VydmljZXMgU3BlZWNoIFNlcnZpY2UgcmVnaW9uLiBVbmRlciBub3JtYWwgY2lyY3Vtc3RhbmNlcywgeW91IHNob3VsZG4ndCBoYXZlIHRvXG4gICAgICogdXNlIHRoaXMgcHJvcGVydHkgZGlyZWN0bHkuXG4gICAgICogSW5zdGVhZCwgdXNlIFtbU3BlZWNoQ29uZmlnLmZyb21TdWJzY3JpcHRpb25dXSwgW1tTcGVlY2hDb25maWcuZnJvbUVuZHBvaW50XV0sIFtbU3BlZWNoQ29uZmlnLmZyb21BdXRob3JpemF0aW9uVG9rZW5dXS5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVnaW9uXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVnaW9uXCJdID0gMl0gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlZ2lvblwiO1xuICAgIC8qKlxuICAgICAqIFRoZSBDb2duaXRpdmUgU2VydmljZXMgU3BlZWNoIFNlcnZpY2UgYXV0aG9yaXphdGlvbiB0b2tlbiAoYWthIGFjY2VzcyB0b2tlbikuIFVuZGVyIG5vcm1hbCBjaXJjdW1zdGFuY2VzLFxuICAgICAqIHlvdSBzaG91bGRuJ3QgaGF2ZSB0byB1c2UgdGhpcyBwcm9wZXJ0eSBkaXJlY3RseS5cbiAgICAgKiBJbnN0ZWFkLCB1c2UgW1tTcGVlY2hDb25maWcuZnJvbUF1dGhvcml6YXRpb25Ub2tlbl1dLCBbW1NwZWVjaFJlY29nbml6ZXIuYXV0aG9yaXphdGlvblRva2VuXV0sXG4gICAgICogW1tJbnRlbnRSZWNvZ25pemVyLmF1dGhvcml6YXRpb25Ub2tlbl1dLCBbW1RyYW5zbGF0aW9uUmVjb2duaXplci5hdXRob3JpemF0aW9uVG9rZW5dXSwgW1tTcGVha2VyUmVjb2duaXplci5hdXRob3JpemF0aW9uVG9rZW5dXS5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW5cbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlblwiXSA9IDNdID0gXCJTcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlblwiO1xuICAgIC8qKlxuICAgICAqIFRoZSBDb2duaXRpdmUgU2VydmljZXMgU3BlZWNoIFNlcnZpY2UgYXV0aG9yaXphdGlvbiB0eXBlLiBDdXJyZW50bHkgdW51c2VkLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9UeXBlXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVHlwZVwiXSA9IDRdID0gXCJTcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9UeXBlXCI7XG4gICAgLyoqXG4gICAgICogVGhlIENvZ25pdGl2ZSBTZXJ2aWNlcyBTcGVlY2ggU2VydmljZSBlbmRwb2ludCBpZC4gVW5kZXIgbm9ybWFsIGNpcmN1bXN0YW5jZXMsIHlvdSBzaG91bGRuJ3RcbiAgICAgKiBoYXZlIHRvIHVzZSB0aGlzIHByb3BlcnR5IGRpcmVjdGx5LlxuICAgICAqIEluc3RlYWQsIHVzZSBbW1NwZWVjaENvbmZpZy5lbmRwb2ludElkXV0uXG4gICAgICogTk9URTogVGhlIGVuZHBvaW50IGlkIGlzIGF2YWlsYWJsZSBpbiB0aGUgU3BlZWNoIFBvcnRhbCwgbGlzdGVkIHVuZGVyIEVuZHBvaW50IERldGFpbHMuXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50SWRcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludElkXCJdID0gNV0gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50SWRcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgbGlzdCBvZiBjb21tYSBzZXBhcmF0ZWQgbGFuZ3VhZ2VzIChCQ1AtNDcgZm9ybWF0KSB1c2VkIGFzIHRhcmdldCB0cmFuc2xhdGlvbiBsYW5ndWFnZXMuIFVuZGVyIG5vcm1hbCBjaXJjdW1zdGFuY2VzLFxuICAgICAqIHlvdSBzaG91bGRuJ3QgaGF2ZSB0byB1c2UgdGhpcyBwcm9wZXJ0eSBkaXJlY3RseS5cbiAgICAgKiBJbnN0ZWFkIHVzZSBbW1NwZWVjaFRyYW5zbGF0aW9uQ29uZmlnLmFkZFRhcmdldExhbmd1YWdlXV0sXG4gICAgICogW1tTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZy50YXJnZXRMYW5ndWFnZXNdXSwgW1tUcmFuc2xhdGlvblJlY29nbml6ZXIudGFyZ2V0TGFuZ3VhZ2VzXV0uXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uVG9MYW5ndWFnZXNcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvblRvTGFuZ3VhZ2VzXCJdID0gNl0gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uVG9MYW5ndWFnZXNcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgQ29nbml0aXZlIFNlcnZpY2UgVGV4dCB0byBTcGVlY2ggU2VydmljZSBWb2ljZS4gVW5kZXIgbm9ybWFsIGNpcmN1bXN0YW5jZXMsIHlvdSBzaG91bGRuJ3QgaGF2ZSB0byB1c2UgdGhpc1xuICAgICAqIHByb3BlcnR5IGRpcmVjdGx5LlxuICAgICAqIEluc3RlYWQsIHVzZSBbW1NwZWVjaFRyYW5zbGF0aW9uQ29uZmlnLnZvaWNlTmFtZV1dLlxuICAgICAqIE5PVEU6IFZhbGlkIHZvaWNlIG5hbWVzIGNhbiBiZSBmb3VuZCA8YSBocmVmPVwiaHR0cHM6Ly9ha2EubXMvY3NzcGVlY2gvdm9pY2VuYW1lc1wiPmhlcmU8L2E+LlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvblZvaWNlXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVHJhbnNsYXRpb25Wb2ljZVwiXSA9IDddID0gXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvblZvaWNlXCI7XG4gICAgLyoqXG4gICAgICogVHJhbnNsYXRpb24gZmVhdHVyZXMuXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uRmVhdHVyZXNcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvbkZlYXR1cmVzXCJdID0gOF0gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uRmVhdHVyZXNcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgTGFuZ3VhZ2UgVW5kZXJzdGFuZGluZyBTZXJ2aWNlIFJlZ2lvbi4gVW5kZXIgbm9ybWFsIGNpcmN1bXN0YW5jZXMsIHlvdSBzaG91bGRuJ3QgaGF2ZSB0byB1c2UgdGhpcyBwcm9wZXJ0eSBkaXJlY3RseS5cbiAgICAgKiBJbnN0ZWFkLCB1c2UgW1tMYW5ndWFnZVVuZGVyc3RhbmRpbmdNb2RlbF1dLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9JbnRlbnRSZWdpb25cbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9JbnRlbnRSZWdpb25cIl0gPSA5XSA9IFwiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fSW50ZW50UmVnaW9uXCI7XG4gICAgLyoqXG4gICAgICogVGhlIGhvc3QgbmFtZSBvZiB0aGUgcHJveHkgc2VydmVyIHVzZWQgdG8gY29ubmVjdCB0byB0aGUgQ29nbml0aXZlIFNlcnZpY2VzIFNwZWVjaCBTZXJ2aWNlLiBPbmx5IHJlbGV2YW50IGluIE5vZGUuanMgZW52aXJvbm1lbnRzLlxuICAgICAqIFlvdSBzaG91bGRuJ3QgaGF2ZSB0byB1c2UgdGhpcyBwcm9wZXJ0eSBkaXJlY3RseS5cbiAgICAgKiBJbnN0ZWFkIHVzZSA8c2VlIGNyZWY9XCJTcGVlY2hDb25maWcuU2V0UHJveHkoc3RyaW5nLGludCxzdHJpbmcsc3RyaW5nKVwiLz4uXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjQuMC5cbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Qcm94eUhvc3ROYW1lXCJdID0gMTBdID0gXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Qcm94eUhvc3ROYW1lXCI7XG4gICAgLyoqXG4gICAgICogVGhlIHBvcnQgb2YgdGhlIHByb3h5IHNlcnZlciB1c2VkIHRvIGNvbm5lY3QgdG8gdGhlIENvZ25pdGl2ZSBTZXJ2aWNlcyBTcGVlY2ggU2VydmljZS4gT25seSByZWxldmFudCBpbiBOb2RlLmpzIGVudmlyb25tZW50cy5cbiAgICAgKiBZb3Ugc2hvdWxkbid0IGhhdmUgdG8gdXNlIHRoaXMgcHJvcGVydHkgZGlyZWN0bHkuXG4gICAgICogSW5zdGVhZCB1c2UgPHNlZSBjcmVmPVwiU3BlZWNoQ29uZmlnLlNldFByb3h5KHN0cmluZyxpbnQsc3RyaW5nLHN0cmluZylcIi8+LlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS40LjAuXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUHJveHlQb3J0XCJdID0gMTFdID0gXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Qcm94eVBvcnRcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgdXNlciBuYW1lIG9mIHRoZSBwcm94eSBzZXJ2ZXIgdXNlZCB0byBjb25uZWN0IHRvIHRoZSBDb2duaXRpdmUgU2VydmljZXMgU3BlZWNoIFNlcnZpY2UuIE9ubHkgcmVsZXZhbnQgaW4gTm9kZS5qcyBlbnZpcm9ubWVudHMuXG4gICAgICogWW91IHNob3VsZG4ndCBoYXZlIHRvIHVzZSB0aGlzIHByb3BlcnR5IGRpcmVjdGx5LlxuICAgICAqIEluc3RlYWQgdXNlIDxzZWUgY3JlZj1cIlNwZWVjaENvbmZpZy5TZXRQcm94eShzdHJpbmcsaW50LHN0cmluZyxzdHJpbmcpXCIvPi5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuNC4wLlxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5VXNlck5hbWVcIl0gPSAxMl0gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5VXNlck5hbWVcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgcGFzc3dvcmQgb2YgdGhlIHByb3h5IHNlcnZlciB1c2VkIHRvIGNvbm5lY3QgdG8gdGhlIENvZ25pdGl2ZSBTZXJ2aWNlcyBTcGVlY2ggU2VydmljZS4gT25seSByZWxldmFudCBpbiBOb2RlLmpzIGVudmlyb25tZW50cy5cbiAgICAgKiBZb3Ugc2hvdWxkbid0IGhhdmUgdG8gdXNlIHRoaXMgcHJvcGVydHkgZGlyZWN0bHkuXG4gICAgICogSW5zdGVhZCB1c2UgPHNlZSBjcmVmPVwiU3BlZWNoQ29uZmlnLlNldFByb3h5KHN0cmluZyxpbnQsc3RyaW5nLHN0cmluZylcIi8+LlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS40LjAuXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUHJveHlQYXNzd29yZFwiXSA9IDEzXSA9IFwiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUHJveHlQYXNzd29yZFwiO1xuICAgIC8qKlxuICAgICAqIFRoZSBDb2duaXRpdmUgU2VydmljZXMgU3BlZWNoIFNlcnZpY2UgcmVjb2duaXRpb24gTW9kZS4gQ2FuIGJlIFwiSU5URVJBQ1RJVkVcIiwgXCJDT05WRVJTQVRJT05cIiwgXCJESUNUQVRJT05cIi5cbiAgICAgKiBUaGlzIHByb3BlcnR5IGlzIGludGVuZGVkIHRvIGJlIHJlYWQtb25seS4gVGhlIFNESyBpcyB1c2luZyBpdCBpbnRlcm5hbGx5LlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTW9kZVxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29Nb2RlXCJdID0gMTRdID0gXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTW9kZVwiO1xuICAgIC8qKlxuICAgICAqIFRoZSBzcG9rZW4gbGFuZ3VhZ2UgdG8gYmUgcmVjb2duaXplZCAoaW4gQkNQLTQ3IGZvcm1hdCkuIFVuZGVyIG5vcm1hbCBjaXJjdW1zdGFuY2VzLCB5b3Ugc2hvdWxkbid0IGhhdmUgdG8gdXNlIHRoaXMgcHJvcGVydHlcbiAgICAgKiBkaXJlY3RseS5cbiAgICAgKiBJbnN0ZWFkLCB1c2UgW1tTcGVlY2hDb25maWcuc3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZV1dLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTGFuZ3VhZ2VcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTGFuZ3VhZ2VcIl0gPSAxNV0gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZVwiO1xuICAgIC8qKlxuICAgICAqIFRoZSBzZXNzaW9uIGlkLiBUaGlzIGlkIGlzIGEgdW5pdmVyc2FsbHkgdW5pcXVlIGlkZW50aWZpZXIgKGFrYSBVVUlEKSByZXByZXNlbnRpbmcgYSBzcGVjaWZpYyBiaW5kaW5nIG9mIGFuIGF1ZGlvIGlucHV0IHN0cmVhbVxuICAgICAqIGFuZCB0aGUgdW5kZXJseWluZyBzcGVlY2ggcmVjb2duaXRpb24gaW5zdGFuY2UgdG8gd2hpY2ggaXQgaXMgYm91bmQuIFVuZGVyIG5vcm1hbCBjaXJjdW1zdGFuY2VzLCB5b3Ugc2hvdWxkbid0IGhhdmUgdG8gdXNlIHRoaXNcbiAgICAgKiBwcm9wZXJ0eSBkaXJlY3RseS5cbiAgICAgKiBJbnN0ZWFkIHVzZSBbW1Nlc3Npb25FdmVudEFyZ3Muc2Vzc2lvbklkXV0uXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLlNwZWVjaF9TZXNzaW9uSWRcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hfU2Vzc2lvbklkXCJdID0gMTZdID0gXCJTcGVlY2hfU2Vzc2lvbklkXCI7XG4gICAgLyoqXG4gICAgICogVGhlIHNwb2tlbiBsYW5ndWFnZSB0byBiZSBzeW50aGVzaXplZCAoZS5nLiBlbi1VUylcbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhMYW5ndWFnZVxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1N5bnRoTGFuZ3VhZ2VcIl0gPSAxN10gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1N5bnRoTGFuZ3VhZ2VcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgVFRTIHZvaWNlIHRvIGJlIHVzZWQgZm9yIHNwZWVjaCBzeW50aGVzaXNcbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhWb2ljZVxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1N5bnRoVm9pY2VcIl0gPSAxOF0gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1N5bnRoVm9pY2VcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgc3RyaW5nIHRvIHNwZWNpZnkgVFRTIG91dHB1dCBhdWRpbyBmb3JtYXRcbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhPdXRwdXRGb3JtYXRcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9TeW50aE91dHB1dEZvcm1hdFwiXSA9IDE5XSA9IFwiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhPdXRwdXRGb3JtYXRcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgbGlzdCBvZiBjb21tYSBzZXBhcmF0ZWQgbGFuZ3VhZ2VzIHVzZWQgYXMgcG9zc2libGUgc291cmNlIGxhbmd1YWdlc1xuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xMy4wXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0F1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXNcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9BdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VzXCJdID0gMjBdID0gXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9BdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VzXCI7XG4gICAgLyoqXG4gICAgICogVGhlIHJlcXVlc3RlZCBDb2duaXRpdmUgU2VydmljZXMgU3BlZWNoIFNlcnZpY2UgcmVzcG9uc2Ugb3V0cHV0IGZvcm1hdCAoc2ltcGxlIG9yIGRldGFpbGVkKS4gVW5kZXIgbm9ybWFsIGNpcmN1bXN0YW5jZXMsIHlvdSBzaG91bGRuJ3QgaGF2ZVxuICAgICAqIHRvIHVzZSB0aGlzIHByb3BlcnR5IGRpcmVjdGx5LlxuICAgICAqIEluc3RlYWQgdXNlIFtbU3BlZWNoQ29uZmlnLm91dHB1dEZvcm1hdF1dLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUmVxdWVzdERldGFpbGVkUmVzdWx0VHJ1ZUZhbHNlXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZVJlc3BvbnNlX1JlcXVlc3REZXRhaWxlZFJlc3VsdFRydWVGYWxzZVwiXSA9IDIxXSA9IFwiU3BlZWNoU2VydmljZVJlc3BvbnNlX1JlcXVlc3REZXRhaWxlZFJlc3VsdFRydWVGYWxzZVwiO1xuICAgIC8qKlxuICAgICAqIFRoZSByZXF1ZXN0ZWQgQ29nbml0aXZlIFNlcnZpY2VzIFNwZWVjaCBTZXJ2aWNlIHJlc3BvbnNlIG91dHB1dCBwcm9mYW5pdHkgbGV2ZWwuIEN1cnJlbnRseSB1bnVzZWQuXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9SZXF1ZXN0UHJvZmFuaXR5RmlsdGVyVHJ1ZUZhbHNlXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZVJlc3BvbnNlX1JlcXVlc3RQcm9mYW5pdHlGaWx0ZXJUcnVlRmFsc2VcIl0gPSAyMl0gPSBcIlNwZWVjaFNlcnZpY2VSZXNwb25zZV9SZXF1ZXN0UHJvZmFuaXR5RmlsdGVyVHJ1ZUZhbHNlXCI7XG4gICAgLyoqXG4gICAgICogVGhlIENvZ25pdGl2ZSBTZXJ2aWNlcyBTcGVlY2ggU2VydmljZSByZXNwb25zZSBvdXRwdXQgKGluIEpTT04gZm9ybWF0KS4gVGhpcyBwcm9wZXJ0eSBpcyBhdmFpbGFibGUgb24gcmVjb2duaXRpb24gcmVzdWx0IG9iamVjdHMgb25seS5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuU3BlZWNoU2VydmljZVJlc3BvbnNlX0pzb25SZXN1bHRcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlUmVzcG9uc2VfSnNvblJlc3VsdFwiXSA9IDIzXSA9IFwiU3BlZWNoU2VydmljZVJlc3BvbnNlX0pzb25SZXN1bHRcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgQ29nbml0aXZlIFNlcnZpY2VzIFNwZWVjaCBTZXJ2aWNlIGVycm9yIGRldGFpbHMgKGluIEpTT04gZm9ybWF0KS4gVW5kZXIgbm9ybWFsIGNpcmN1bXN0YW5jZXMsIHlvdSBzaG91bGRuJ3QgaGF2ZSB0b1xuICAgICAqIHVzZSB0aGlzIHByb3BlcnR5IGRpcmVjdGx5LiBJbnN0ZWFkIHVzZSBbW0NhbmNlbGxhdGlvbkRldGFpbHMuZXJyb3JEZXRhaWxzXV0uXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9Kc29uRXJyb3JEZXRhaWxzXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZVJlc3BvbnNlX0pzb25FcnJvckRldGFpbHNcIl0gPSAyNF0gPSBcIlNwZWVjaFNlcnZpY2VSZXNwb25zZV9Kc29uRXJyb3JEZXRhaWxzXCI7XG4gICAgLyoqXG4gICAgICogVGhlIGNhbmNlbGxhdGlvbiByZWFzb24uIEN1cnJlbnRseSB1bnVzZWQuXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLkNhbmNlbGxhdGlvbkRldGFpbHNfUmVhc29uXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiQ2FuY2VsbGF0aW9uRGV0YWlsc19SZWFzb25cIl0gPSAyNV0gPSBcIkNhbmNlbGxhdGlvbkRldGFpbHNfUmVhc29uXCI7XG4gICAgLyoqXG4gICAgICogVGhlIGNhbmNlbGxhdGlvbiB0ZXh0LiBDdXJyZW50bHkgdW51c2VkLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5DYW5jZWxsYXRpb25EZXRhaWxzX1JlYXNvblRleHRcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJDYW5jZWxsYXRpb25EZXRhaWxzX1JlYXNvblRleHRcIl0gPSAyNl0gPSBcIkNhbmNlbGxhdGlvbkRldGFpbHNfUmVhc29uVGV4dFwiO1xuICAgIC8qKlxuICAgICAqIFRoZSBDYW5jZWxsYXRpb24gZGV0YWlsZWQgdGV4dC4gQ3VycmVudGx5IHVudXNlZC5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuQ2FuY2VsbGF0aW9uRGV0YWlsc19SZWFzb25EZXRhaWxlZFRleHRcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJDYW5jZWxsYXRpb25EZXRhaWxzX1JlYXNvbkRldGFpbGVkVGV4dFwiXSA9IDI3XSA9IFwiQ2FuY2VsbGF0aW9uRGV0YWlsc19SZWFzb25EZXRhaWxlZFRleHRcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgTGFuZ3VhZ2UgVW5kZXJzdGFuZGluZyBTZXJ2aWNlIHJlc3BvbnNlIG91dHB1dCAoaW4gSlNPTiBmb3JtYXQpLiBBdmFpbGFibGUgdmlhIFtbSW50ZW50UmVjb2duaXRpb25SZXN1bHRdXVxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5MYW5ndWFnZVVuZGVyc3RhbmRpbmdTZXJ2aWNlUmVzcG9uc2VfSnNvblJlc3VsdFxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIkxhbmd1YWdlVW5kZXJzdGFuZGluZ1NlcnZpY2VSZXNwb25zZV9Kc29uUmVzdWx0XCJdID0gMjhdID0gXCJMYW5ndWFnZVVuZGVyc3RhbmRpbmdTZXJ2aWNlUmVzcG9uc2VfSnNvblJlc3VsdFwiO1xuICAgIC8qKlxuICAgICAqIFRoZSBVUkwgc3RyaW5nIGJ1aWx0IGZyb20gc3BlZWNoIGNvbmZpZ3VyYXRpb24uXG4gICAgICogVGhpcyBwcm9wZXJ0eSBpcyBpbnRlbmRlZCB0byBiZSByZWFkLW9ubHkuIFRoZSBTREsgaXMgdXNpbmcgaXQgaW50ZXJuYWxseS5cbiAgICAgKiBOT1RFOiBBZGRlZCBpbiB2ZXJzaW9uIDEuNy4wLlxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1VybFwiXSA9IDI5XSA9IFwiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVXJsXCI7XG4gICAgLyoqXG4gICAgICogVGhlIGluaXRpYWwgc2lsZW5jZSB0aW1lb3V0IHZhbHVlIChpbiBtaWxsaXNlY29uZHMpIHVzZWQgYnkgdGhlIHNlcnZpY2UuXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjcuMFxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0luaXRpYWxTaWxlbmNlVGltZW91dE1zXCJdID0gMzBdID0gXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Jbml0aWFsU2lsZW5jZVRpbWVvdXRNc1wiO1xuICAgIC8qKlxuICAgICAqIFRoZSBlbmQgc2lsZW5jZSB0aW1lb3V0IHZhbHVlIChpbiBtaWxsaXNlY29uZHMpIHVzZWQgYnkgdGhlIHNlcnZpY2UuXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjcuMFxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZFNpbGVuY2VUaW1lb3V0TXNcIl0gPSAzMV0gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZFNpbGVuY2VUaW1lb3V0TXNcIjtcbiAgICAvKipcbiAgICAgKiBBIGR1cmF0aW9uIG9mIGRldGVjdGVkIHNpbGVuY2UsIG1lYXN1cmVkIGluIG1pbGxpc2Vjb25kcywgYWZ0ZXIgd2hpY2ggc3BlZWNoLXRvLXRleHQgd2lsbCBkZXRlcm1pbmUgYSBzcG9rZW5cbiAgICAgKiBwaHJhc2UgaGFzIGVuZGVkIGFuZCBnZW5lcmF0ZSBhIGZpbmFsIFJlY29nbml6ZWQgcmVzdWx0LiBDb25maWd1cmluZyB0aGlzIHRpbWVvdXQgbWF5IGJlIGhlbHBmdWwgaW4gc2l0dWF0aW9uc1xuICAgICAqIHdoZXJlIHNwb2tlbiBpbnB1dCBpcyBzaWduaWZpY2FudGx5IGZhc3RlciBvciBzbG93ZXIgdGhhbiB1c3VhbCBhbmQgZGVmYXVsdCBzZWdtZW50YXRpb24gYmVoYXZpb3IgY29uc2lzdGVudGx5XG4gICAgICogeWllbGRzIHJlc3VsdHMgdGhhdCBhcmUgdG9vIGxvbmcgb3IgdG9vIHNob3J0LiBTZWdtZW50YXRpb24gdGltZW91dCB2YWx1ZXMgdGhhdCBhcmUgaW5hcHByb3ByaWF0ZWx5IGhpZ2ggb3IgbG93XG4gICAgICogY2FuIG5lZ2F0aXZlbHkgYWZmZWN0IHNwZWVjaC10by10ZXh0IGFjY3VyYWN5OyB0aGlzIHByb3BlcnR5IHNob3VsZCBiZSBjYXJlZnVsbHkgY29uZmlndXJlZCBhbmQgdGhlIHJlc3VsdGluZ1xuICAgICAqIGJlaGF2aW9yIHNob3VsZCBiZSB0aG9yb3VnaGx5IHZhbGlkYXRlZCBhcyBpbnRlbmRlZC5cbiAgICAgKlxuICAgICAqIEZvciBtb3JlIGluZm9ybWF0aW9uIGFib3V0IHRpbWVvdXQgY29uZmlndXJhdGlvbiB0aGF0IGluY2x1ZGVzIGRpc2N1c3Npb24gb2YgZGVmYXVsdCBiZWhhdmlvcnMsIHBsZWFzZSB2aXNpdFxuICAgICAqIGh0dHBzOi8vYWthLm1zL2Nzc3BlZWNoL3RpbWVvdXRzLlxuICAgICAqXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjIxLjAuXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoX1NlZ21lbnRhdGlvblNpbGVuY2VUaW1lb3V0TXNcIl0gPSAzMl0gPSBcIlNwZWVjaF9TZWdtZW50YXRpb25TaWxlbmNlVGltZW91dE1zXCI7XG4gICAgLyoqXG4gICAgICogQSBib29sZWFuIHZhbHVlIHNwZWNpZnlpbmcgd2hldGhlciBhdWRpbyBsb2dnaW5nIGlzIGVuYWJsZWQgaW4gdGhlIHNlcnZpY2Ugb3Igbm90LlxuICAgICAqIEF1ZGlvIGFuZCBjb250ZW50IGxvZ3MgYXJlIHN0b3JlZCBlaXRoZXIgaW4gTWljcm9zb2Z0LW93bmVkIHN0b3JhZ2UsIG9yIGluIHlvdXIgb3duIHN0b3JhZ2UgYWNjb3VudCBsaW5rZWRcbiAgICAgKiB0byB5b3VyIENvZ25pdGl2ZSBTZXJ2aWNlcyBzdWJzY3JpcHRpb24gKEJyaW5nIFlvdXIgT3duIFN0b3JhZ2UgKEJZT1MpIGVuYWJsZWQgU3BlZWNoIHJlc291cmNlKS5cbiAgICAgKiBUaGUgbG9ncyB3aWxsIGJlIHJlbW92ZWQgYWZ0ZXIgMzAgZGF5cy5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuNy4wXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5hYmxlQXVkaW9Mb2dnaW5nXCJdID0gMzNdID0gXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmFibGVBdWRpb0xvZ2dpbmdcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgc3BlZWNoIHNlcnZpY2UgY29ubmVjdGlvbiBsYW5ndWFnZSBpZGVudGlmaWVyIG1vZGUuXG4gICAgICogQ2FuIGJlIFwiQXRTdGFydFwiICh0aGUgZGVmYXVsdCksIG9yIFwiQ29udGludW91c1wiLiBTZWUgTGFuZ3VhZ2VcbiAgICAgKiBJZGVudGlmaWNhdGlvbiBkb2N1bWVudCBodHRwczovL2FrYS5tcy9zcGVlY2gvbGlkP3Bpdm90cz1wcm9ncmFtbWluZy1sYW5ndWFnZS1qYXZhc2NyaXB0XG4gICAgICogZm9yIG1vcmUgZGV0YWlscy5cbiAgICAgKiBBZGRlZCBpbiAxLjI1LjBcbiAgICAgKiovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fTGFuZ3VhZ2VJZE1vZGVcIl0gPSAzNF0gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0xhbmd1YWdlSWRNb2RlXCI7XG4gICAgLyoqXG4gICAgICogQSBzdHJpbmcgdmFsdWUgcmVwcmVzZW50aW5nIHRoZSBkZXNpcmVkIGVuZHBvaW50IHZlcnNpb24gdG8gdGFyZ2V0IGZvciBTcGVlY2ggUmVjb2duaXRpb24uXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjIxLjBcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvZ25pdGlvbkVuZHBvaW50VmVyc2lvblwiXSA9IDM1XSA9IFwiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb2duaXRpb25FbmRwb2ludFZlcnNpb25cIjtcbiAgICAvKipcbiAgICAvKipcbiAgICAgKiBBIHN0cmluZyB2YWx1ZSB0aGUgY3VycmVudCBzcGVha2VyIHJlY29nbml0aW9uIHNjZW5hcmlvL21vZGUgKFRleHRJbmRlcGVuZGVudElkZW50aWZpY2F0aW9uLCBldGMuKS5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMjMuMFxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1NwZWFrZXJJZE1vZGVcIl0gPSAzNl0gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1NwZWFrZXJJZE1vZGVcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgcmVxdWVzdGVkIENvZ25pdGl2ZSBTZXJ2aWNlcyBTcGVlY2ggU2VydmljZSByZXNwb25zZSBvdXRwdXQgcHJvZmFuaXR5IHNldHRpbmcuXG4gICAgICogQWxsb3dlZCB2YWx1ZXMgYXJlIFwibWFza2VkXCIsIFwicmVtb3ZlZFwiLCBhbmQgXCJyYXdcIi5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuNy4wLlxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VSZXNwb25zZV9Qcm9mYW5pdHlPcHRpb25cIl0gPSAzN10gPSBcIlNwZWVjaFNlcnZpY2VSZXNwb25zZV9Qcm9mYW5pdHlPcHRpb25cIjtcbiAgICAvKipcbiAgICAgKiBBIHN0cmluZyB2YWx1ZSBzcGVjaWZ5aW5nIHdoaWNoIHBvc3QgcHJvY2Vzc2luZyBvcHRpb24gc2hvdWxkIGJlIHVzZWQgYnkgc2VydmljZS5cbiAgICAgKiBBbGxvd2VkIHZhbHVlcyBhcmUgXCJUcnVlVGV4dFwiLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS43LjBcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUG9zdFByb2Nlc3NpbmdPcHRpb25cIl0gPSAzOF0gPSBcIlNwZWVjaFNlcnZpY2VSZXNwb25zZV9Qb3N0UHJvY2Vzc2luZ09wdGlvblwiO1xuICAgIC8qKlxuICAgICAqIEEgYm9vbGVhbiB2YWx1ZSBzcGVjaWZ5aW5nIHdoZXRoZXIgdG8gaW5jbHVkZSB3b3JkLWxldmVsIHRpbWVzdGFtcHMgaW4gdGhlIHJlc3BvbnNlIHJlc3VsdC5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuNy4wXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZVJlc3BvbnNlX1JlcXVlc3RXb3JkTGV2ZWxUaW1lc3RhbXBzXCJdID0gMzldID0gXCJTcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUmVxdWVzdFdvcmRMZXZlbFRpbWVzdGFtcHNcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgbnVtYmVyIG9mIHRpbWVzIGEgd29yZCBoYXMgdG8gYmUgaW4gcGFydGlhbCByZXN1bHRzIHRvIGJlIHJldHVybmVkLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS43LjBcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlUmVzcG9uc2VfU3RhYmxlUGFydGlhbFJlc3VsdFRocmVzaG9sZFwiXSA9IDQwXSA9IFwiU3BlZWNoU2VydmljZVJlc3BvbnNlX1N0YWJsZVBhcnRpYWxSZXN1bHRUaHJlc2hvbGRcIjtcbiAgICAvKipcbiAgICAgKiBBIHN0cmluZyB2YWx1ZSBzcGVjaWZ5aW5nIHRoZSBvdXRwdXQgZm9ybWF0IG9wdGlvbiBpbiB0aGUgcmVzcG9uc2UgcmVzdWx0LiBJbnRlcm5hbCB1c2Ugb25seS5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuNy4wLlxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VSZXNwb25zZV9PdXRwdXRGb3JtYXRPcHRpb25cIl0gPSA0MV0gPSBcIlNwZWVjaFNlcnZpY2VSZXNwb25zZV9PdXRwdXRGb3JtYXRPcHRpb25cIjtcbiAgICAvKipcbiAgICAgKiBBIGJvb2xlYW4gdmFsdWUgdG8gcmVxdWVzdCBmb3Igc3RhYmlsaXppbmcgdHJhbnNsYXRpb24gcGFydGlhbCByZXN1bHRzIGJ5IG9taXR0aW5nIHdvcmRzIGluIHRoZSBlbmQuXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjcuMC5cbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlUmVzcG9uc2VfVHJhbnNsYXRpb25SZXF1ZXN0U3RhYmxlUGFydGlhbFJlc3VsdFwiXSA9IDQyXSA9IFwiU3BlZWNoU2VydmljZVJlc3BvbnNlX1RyYW5zbGF0aW9uUmVxdWVzdFN0YWJsZVBhcnRpYWxSZXN1bHRcIjtcbiAgICAvKipcbiAgICAgKiBBIGJvb2xlYW4gdmFsdWUgc3BlY2lmeWluZyB3aGV0aGVyIHRvIHJlcXVlc3QgV29yZEJvdW5kYXJ5IGV2ZW50cy5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuU3BlZWNoU2VydmljZVJlc3BvbnNlX1JlcXVlc3RXb3JkQm91bmRhcnlcbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMjEuMC5cbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUmVxdWVzdFdvcmRCb3VuZGFyeVwiXSA9IDQzXSA9IFwiU3BlZWNoU2VydmljZVJlc3BvbnNlX1JlcXVlc3RXb3JkQm91bmRhcnlcIjtcbiAgICAvKipcbiAgICAgKiBBIGJvb2xlYW4gdmFsdWUgc3BlY2lmeWluZyB3aGV0aGVyIHRvIHJlcXVlc3QgcHVuY3R1YXRpb24gYm91bmRhcnkgaW4gV29yZEJvdW5kYXJ5IEV2ZW50cy4gRGVmYXVsdCBpcyB0cnVlLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUmVxdWVzdFB1bmN0dWF0aW9uQm91bmRhcnlcbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMjEuMC5cbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUmVxdWVzdFB1bmN0dWF0aW9uQm91bmRhcnlcIl0gPSA0NF0gPSBcIlNwZWVjaFNlcnZpY2VSZXNwb25zZV9SZXF1ZXN0UHVuY3R1YXRpb25Cb3VuZGFyeVwiO1xuICAgIC8qKlxuICAgICAqIEEgYm9vbGVhbiB2YWx1ZSBzcGVjaWZ5aW5nIHdoZXRoZXIgdG8gcmVxdWVzdCBzZW50ZW5jZSBib3VuZGFyeSBpbiBXb3JkQm91bmRhcnkgRXZlbnRzLiBEZWZhdWx0IGlzIGZhbHNlLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUmVxdWVzdFNlbnRlbmNlQm91bmRhcnlcbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMjEuMC5cbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUmVxdWVzdFNlbnRlbmNlQm91bmRhcnlcIl0gPSA0NV0gPSBcIlNwZWVjaFNlcnZpY2VSZXNwb25zZV9SZXF1ZXN0U2VudGVuY2VCb3VuZGFyeVwiO1xuICAgIC8qKlxuICAgICAqIElkZW50aWZpZXIgdXNlZCB0byBjb25uZWN0IHRvIHRoZSBiYWNrZW5kIHNlcnZpY2UuXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvbl9BcHBsaWNhdGlvbklkXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiQ29udmVyc2F0aW9uX0FwcGxpY2F0aW9uSWRcIl0gPSA0Nl0gPSBcIkNvbnZlcnNhdGlvbl9BcHBsaWNhdGlvbklkXCI7XG4gICAgLyoqXG4gICAgICogVHlwZSBvZiBkaWFsb2cgYmFja2VuZCB0byBjb25uZWN0IHRvLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5Db252ZXJzYXRpb25fRGlhbG9nVHlwZVxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIkNvbnZlcnNhdGlvbl9EaWFsb2dUeXBlXCJdID0gNDddID0gXCJDb252ZXJzYXRpb25fRGlhbG9nVHlwZVwiO1xuICAgIC8qKlxuICAgICAqIFNpbGVuY2UgdGltZW91dCBmb3IgbGlzdGVuaW5nXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvbl9Jbml0aWFsX1NpbGVuY2VfVGltZW91dFxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIkNvbnZlcnNhdGlvbl9Jbml0aWFsX1NpbGVuY2VfVGltZW91dFwiXSA9IDQ4XSA9IFwiQ29udmVyc2F0aW9uX0luaXRpYWxfU2lsZW5jZV9UaW1lb3V0XCI7XG4gICAgLyoqXG4gICAgICogRnJvbSBJZCB0byBhZGQgdG8gc3BlZWNoIHJlY29nbml0aW9uIGFjdGl2aXRpZXMuXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvbl9Gcm9tX0lkXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiQ29udmVyc2F0aW9uX0Zyb21fSWRcIl0gPSA0OV0gPSBcIkNvbnZlcnNhdGlvbl9Gcm9tX0lkXCI7XG4gICAgLyoqXG4gICAgICogQ29udmVyc2F0aW9uSWQgZm9yIHRoZSBzZXNzaW9uLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5Db252ZXJzYXRpb25fQ29udmVyc2F0aW9uX0lkXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiQ29udmVyc2F0aW9uX0NvbnZlcnNhdGlvbl9JZFwiXSA9IDUwXSA9IFwiQ29udmVyc2F0aW9uX0NvbnZlcnNhdGlvbl9JZFwiO1xuICAgIC8qKlxuICAgICAqIENvbW1hIHNlcGFyYXRlZCBsaXN0IG9mIGN1c3RvbSB2b2ljZSBkZXBsb3ltZW50IGlkcy5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuQ29udmVyc2F0aW9uX0N1c3RvbV9Wb2ljZV9EZXBsb3ltZW50X0lkc1xuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIkNvbnZlcnNhdGlvbl9DdXN0b21fVm9pY2VfRGVwbG95bWVudF9JZHNcIl0gPSA1MV0gPSBcIkNvbnZlcnNhdGlvbl9DdXN0b21fVm9pY2VfRGVwbG95bWVudF9JZHNcIjtcbiAgICAvKipcbiAgICAgKiBTcGVlY2ggYWN0aXZpdHkgdGVtcGxhdGUsIHN0YW1wIHByb3BlcnRpZXMgZnJvbSB0aGUgdGVtcGxhdGUgb24gdGhlIGFjdGl2aXR5IGdlbmVyYXRlZCBieSB0aGUgc2VydmljZSBmb3Igc3BlZWNoLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5Db252ZXJzYXRpb25fU3BlZWNoX0FjdGl2aXR5X1RlbXBsYXRlXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjEwLjAuXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiQ29udmVyc2F0aW9uX1NwZWVjaF9BY3Rpdml0eV9UZW1wbGF0ZVwiXSA9IDUyXSA9IFwiQ29udmVyc2F0aW9uX1NwZWVjaF9BY3Rpdml0eV9UZW1wbGF0ZVwiO1xuICAgIC8qKlxuICAgICAqIEVuYWJsZXMgb3IgZGlzYWJsZXMgdGhlIHJlY2VpcHQgb2YgdHVybiBzdGF0dXMgbWVzc2FnZXMgYXMgb2J0YWluZWQgb24gdGhlIHR1cm5TdGF0dXNSZWNlaXZlZCBldmVudC5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuQ29udmVyc2F0aW9uX1JlcXVlc3RfQm90X1N0YXR1c19NZXNzYWdlc1xuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xNS4wLlxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIkNvbnZlcnNhdGlvbl9SZXF1ZXN0X0JvdF9TdGF0dXNfTWVzc2FnZXNcIl0gPSA1M10gPSBcIkNvbnZlcnNhdGlvbl9SZXF1ZXN0X0JvdF9TdGF0dXNfTWVzc2FnZXNcIjtcbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIGNvbm5lY3Rpb24gSUQgdG8gYmUgcHJvdmlkZWQgaW4gdGhlIEFnZW50IGNvbmZpZ3VyYXRpb24gbWVzc2FnZSwgZS5nLiBhIERpcmVjdCBMaW5lIHRva2VuIGZvclxuICAgICAqIGNoYW5uZWwgYXV0aGVudGljYXRpb24uXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjE1LjEuXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiQ29udmVyc2F0aW9uX0FnZW50X0Nvbm5lY3Rpb25fSWRcIl0gPSA1NF0gPSBcIkNvbnZlcnNhdGlvbl9BZ2VudF9Db25uZWN0aW9uX0lkXCI7XG4gICAgLyoqXG4gICAgICogVGhlIENvZ25pdGl2ZSBTZXJ2aWNlcyBTcGVlY2ggU2VydmljZSBob3N0ICh1cmwpLiBVbmRlciBub3JtYWwgY2lyY3Vtc3RhbmNlcywgeW91IHNob3VsZG4ndCBoYXZlIHRvIHVzZSB0aGlzIHByb3BlcnR5IGRpcmVjdGx5LlxuICAgICAqIEluc3RlYWQsIHVzZSBbW1NwZWVjaENvbmZpZy5mcm9tSG9zdF1dLlxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0hvc3RcIl0gPSA1NV0gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0hvc3RcIjtcbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIGhvc3QgZm9yIHNlcnZpY2UgY2FsbHMgdG8gdGhlIENvbnZlcnNhdGlvbiBUcmFuc2xhdG9yIFJFU1QgbWFuYWdlbWVudCBhbmQgd2Vic29ja2V0IGNhbGxzLlxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIkNvbnZlcnNhdGlvblRyYW5zbGF0b3JfSG9zdFwiXSA9IDU2XSA9IFwiQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9Ib3N0XCI7XG4gICAgLyoqXG4gICAgICogT3B0aW9uYWxseSBzZXQgdGhlIHRoZSBob3N0J3MgZGlzcGxheSBuYW1lLlxuICAgICAqIFVzZWQgd2hlbiBqb2luaW5nIGEgY29udmVyc2F0aW9uLlxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIkNvbnZlcnNhdGlvblRyYW5zbGF0b3JfTmFtZVwiXSA9IDU3XSA9IFwiQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9OYW1lXCI7XG4gICAgLyoqXG4gICAgICogT3B0aW9uYWxseSBzZXQgYSB2YWx1ZSBmb3IgdGhlIFgtQ29ycmVsYXRpb25JZCByZXF1ZXN0IGhlYWRlci5cbiAgICAgKiBVc2VkIGZvciB0cm91Ymxlc2hvb3RpbmcgZXJyb3JzIGluIHRoZSBzZXJ2ZXIgbG9ncy4gSXQgc2hvdWxkIGJlIGEgdmFsaWQgZ3VpZC5cbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJDb252ZXJzYXRpb25UcmFuc2xhdG9yX0NvcnJlbGF0aW9uSWRcIl0gPSA1OF0gPSBcIkNvbnZlcnNhdGlvblRyYW5zbGF0b3JfQ29ycmVsYXRpb25JZFwiO1xuICAgIC8qKlxuICAgICAqIFNldCB0aGUgY29udmVyc2F0aW9uIHRva2VuIHRvIGJlIHNlbnQgdG8gdGhlIHNwZWVjaCBzZXJ2aWNlLiBUaGlzIGVuYWJsZXMgdGhlXG4gICAgICogc2VydmljZSB0byBzZXJ2aWNlIGNhbGwgZnJvbSB0aGUgc3BlZWNoIHNlcnZpY2UgdG8gdGhlIENvbnZlcnNhdGlvbiBUcmFuc2xhdG9yIHNlcnZpY2UgZm9yIHJlbGF5aW5nXG4gICAgICogcmVjb2duaXRpb25zLiBGb3IgaW50ZXJuYWwgdXNlLlxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIkNvbnZlcnNhdGlvblRyYW5zbGF0b3JfVG9rZW5cIl0gPSA1OV0gPSBcIkNvbnZlcnNhdGlvblRyYW5zbGF0b3JfVG9rZW5cIjtcbiAgICAvKipcbiAgICAgKiBUaGUgcmVmZXJlbmNlIHRleHQgb2YgdGhlIGF1ZGlvIGZvciBwcm9udW5jaWF0aW9uIGV2YWx1YXRpb24uXG4gICAgICogRm9yIHRoaXMgYW5kIHRoZSBmb2xsb3dpbmcgcHJvbnVuY2lhdGlvbiBhc3Nlc3NtZW50IHBhcmFtZXRlcnMsIHNlZVxuICAgICAqIGh0dHBzOi8vZG9jcy5taWNyb3NvZnQuY29tL2F6dXJlL2NvZ25pdGl2ZS1zZXJ2aWNlcy9zcGVlY2gtc2VydmljZS9yZXN0LXNwZWVjaC10by10ZXh0I3Byb251bmNpYXRpb24tYXNzZXNzbWVudC1wYXJhbWV0ZXJzIGZvciBkZXRhaWxzLlxuICAgICAqIFVuZGVyIG5vcm1hbCBjaXJjdW1zdGFuY2VzLCB5b3Ugc2hvdWxkbid0IGhhdmUgdG8gdXNlIHRoaXMgcHJvcGVydHkgZGlyZWN0bHkuXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjE1LjBcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJQcm9udW5jaWF0aW9uQXNzZXNzbWVudF9SZWZlcmVuY2VUZXh0XCJdID0gNjBdID0gXCJQcm9udW5jaWF0aW9uQXNzZXNzbWVudF9SZWZlcmVuY2VUZXh0XCI7XG4gICAgLyoqXG4gICAgICogVGhlIHBvaW50IHN5c3RlbSBmb3IgcHJvbnVuY2lhdGlvbiBzY29yZSBjYWxpYnJhdGlvbiAoRml2ZVBvaW50IG9yIEh1bmRyZWRNYXJrKS5cbiAgICAgKiBVbmRlciBub3JtYWwgY2lyY3Vtc3RhbmNlcywgeW91IHNob3VsZG4ndCBoYXZlIHRvIHVzZSB0aGlzIHByb3BlcnR5IGRpcmVjdGx5LlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xNS4wXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfR3JhZGluZ1N5c3RlbVwiXSA9IDYxXSA9IFwiUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfR3JhZGluZ1N5c3RlbVwiO1xuICAgIC8qKlxuICAgICAqIFRoZSBwcm9udW5jaWF0aW9uIGV2YWx1YXRpb24gZ3JhbnVsYXJpdHkgKFBob25lbWUsIFdvcmQsIG9yIEZ1bGxUZXh0KS5cbiAgICAgKiBVbmRlciBub3JtYWwgY2lyY3Vtc3RhbmNlcywgeW91IHNob3VsZG4ndCBoYXZlIHRvIHVzZSB0aGlzIHByb3BlcnR5IGRpcmVjdGx5LlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xNS4wXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfR3JhbnVsYXJpdHlcIl0gPSA2Ml0gPSBcIlByb251bmNpYXRpb25Bc3Nlc3NtZW50X0dyYW51bGFyaXR5XCI7XG4gICAgLyoqXG4gICAgICogRGVmaW5lcyBpZiBlbmFibGUgbWlzY3VlIGNhbGN1bGF0aW9uLlxuICAgICAqIFdpdGggdGhpcyBlbmFibGVkLCB0aGUgcHJvbm91bmNlZCB3b3JkcyB3aWxsIGJlIGNvbXBhcmVkIHRvIHRoZSByZWZlcmVuY2UgdGV4dCxcbiAgICAgKiBhbmQgd2lsbCBiZSBtYXJrZWQgd2l0aCBvbWlzc2lvbi9pbnNlcnRpb24gYmFzZWQgb24gdGhlIGNvbXBhcmlzb24uIFRoZSBkZWZhdWx0IHNldHRpbmcgaXMgRmFsc2UuXG4gICAgICogVW5kZXIgbm9ybWFsIGNpcmN1bXN0YW5jZXMsIHlvdSBzaG91bGRuJ3QgaGF2ZSB0byB1c2UgdGhpcyBwcm9wZXJ0eSBkaXJlY3RseS5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTUuMFxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlByb251bmNpYXRpb25Bc3Nlc3NtZW50X0VuYWJsZU1pc2N1ZVwiXSA9IDYzXSA9IFwiUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfRW5hYmxlTWlzY3VlXCI7XG4gICAgLyoqXG4gICAgICogVGhlIGpzb24gc3RyaW5nIG9mIHByb251bmNpYXRpb24gYXNzZXNzbWVudCBwYXJhbWV0ZXJzXG4gICAgICogVW5kZXIgbm9ybWFsIGNpcmN1bXN0YW5jZXMsIHlvdSBzaG91bGRuJ3QgaGF2ZSB0byB1c2UgdGhpcyBwcm9wZXJ0eSBkaXJlY3RseS5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTUuMFxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlByb251bmNpYXRpb25Bc3Nlc3NtZW50X0pzb25cIl0gPSA2NF0gPSBcIlByb251bmNpYXRpb25Bc3Nlc3NtZW50X0pzb25cIjtcbiAgICAvKipcbiAgICAgKiBQcm9udW5jaWF0aW9uIGFzc2Vzc21lbnQgcGFyYW1ldGVycy5cbiAgICAgKiBUaGlzIHByb3BlcnR5IGlzIGludGVuZGVkIHRvIGJlIHJlYWQtb25seS4gVGhlIFNESyBpcyB1c2luZyBpdCBpbnRlcm5hbGx5LlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xNS4wXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfUGFyYW1zXCJdID0gNjVdID0gXCJQcm9udW5jaWF0aW9uQXNzZXNzbWVudF9QYXJhbXNcIjtcbiAgICAvKipcbiAgICAgKiBWZXJzaW9uIG9mIFNwZWFrZXIgUmVjb2duaXRpb24gQVBJIHRvIHVzZS5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTguMFxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWFrZXJSZWNvZ25pdGlvbl9BcGlfVmVyc2lvblwiXSA9IDY2XSA9IFwiU3BlYWtlclJlY29nbml0aW9uX0FwaV9WZXJzaW9uXCI7XG59KShQcm9wZXJ0eUlkIHx8IChQcm9wZXJ0eUlkID0ge30pKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UHJvcGVydHlJZC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgU2Vzc2lvbkV2ZW50QXJncyB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogRGVmaW5lcyBwYXlsb2FkIGZvciBzZXNzaW9uIGV2ZW50cyBsaWtlIFNwZWVjaCBTdGFydC9FbmQgRGV0ZWN0ZWRcbiAqIEBjbGFzc1xuICovXG5leHBvcnQgY2xhc3MgUmVjb2duaXRpb25FdmVudEFyZ3MgZXh0ZW5kcyBTZXNzaW9uRXZlbnRBcmdzIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBvZmZzZXQgLSBUaGUgb2Zmc2V0LlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzZXNzaW9uSWQgLSBUaGUgc2Vzc2lvbiBpZC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihvZmZzZXQsIHNlc3Npb25JZCkge1xuICAgICAgICBzdXBlcihzZXNzaW9uSWQpO1xuICAgICAgICB0aGlzLnByaXZPZmZzZXQgPSBvZmZzZXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlcHJlc2VudHMgdGhlIG1lc3NhZ2Ugb2Zmc2V0XG4gICAgICogQG1lbWJlciBSZWNvZ25pdGlvbkV2ZW50QXJncy5wcm90b3R5cGUub2Zmc2V0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGdldCBvZmZzZXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZPZmZzZXQ7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1SZWNvZ25pdGlvbkV2ZW50QXJncy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBEZWZpbmVzIHJlc3VsdCBvZiBzcGVlY2ggcmVjb2duaXRpb24uXG4gKiBAY2xhc3MgUmVjb2duaXRpb25SZXN1bHRcbiAqL1xuZXhwb3J0IGNsYXNzIFJlY29nbml0aW9uUmVzdWx0IHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZXN1bHRJZCAtIFRoZSByZXN1bHQgaWQuXG4gICAgICogQHBhcmFtIHtSZXN1bHRSZWFzb259IHJlYXNvbiAtIFRoZSByZWFzb24uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQgLSBUaGUgcmVjb2duaXplZCB0ZXh0LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkdXJhdGlvbiAtIFRoZSBkdXJhdGlvbi5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gb2Zmc2V0IC0gVGhlIG9mZnNldCBpbnRvIHRoZSBzdHJlYW0uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGxhbmd1YWdlIC0gUHJpbWFyeSBMYW5ndWFnZSBkZXRlY3RlZCwgaWYgcHJvdmlkZWQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSAtIFByaW1hcnkgTGFuZ3VhZ2UgY29uZmlkZW5jZSAoXCJVbmtub3duLFwiIFwiTG93LFwiIFwiTWVkaXVtLFwiIFwiSGlnaFwiLi4uKSwgaWYgcHJvdmlkZWQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGVycm9yRGV0YWlscyAtIEVycm9yIGRldGFpbHMsIGlmIHByb3ZpZGVkLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBqc29uIC0gQWRkaXRpb25hbCBKc29uLCBpZiBwcm92aWRlZC5cbiAgICAgKiBAcGFyYW0ge1Byb3BlcnR5Q29sbGVjdGlvbn0gcHJvcGVydGllcyAtIEFkZGl0aW9uYWwgcHJvcGVydGllcywgaWYgcHJvdmlkZWQuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVzdWx0SWQsIHJlYXNvbiwgdGV4dCwgZHVyYXRpb24sIG9mZnNldCwgbGFuZ3VhZ2UsIGxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSwgZXJyb3JEZXRhaWxzLCBqc29uLCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgIHRoaXMucHJpdlJlc3VsdElkID0gcmVzdWx0SWQ7XG4gICAgICAgIHRoaXMucHJpdlJlYXNvbiA9IHJlYXNvbjtcbiAgICAgICAgdGhpcy5wcml2VGV4dCA9IHRleHQ7XG4gICAgICAgIHRoaXMucHJpdkR1cmF0aW9uID0gZHVyYXRpb247XG4gICAgICAgIHRoaXMucHJpdk9mZnNldCA9IG9mZnNldDtcbiAgICAgICAgdGhpcy5wcml2TGFuZ3VhZ2UgPSBsYW5ndWFnZTtcbiAgICAgICAgdGhpcy5wcml2TGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlID0gbGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlO1xuICAgICAgICB0aGlzLnByaXZFcnJvckRldGFpbHMgPSBlcnJvckRldGFpbHM7XG4gICAgICAgIHRoaXMucHJpdkpzb24gPSBqc29uO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzID0gcHJvcGVydGllcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3BlY2lmaWVzIHRoZSByZXN1bHQgaWRlbnRpZmllci5cbiAgICAgKiBAbWVtYmVyIFJlY29nbml0aW9uUmVzdWx0LnByb3RvdHlwZS5yZXN1bHRJZFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBTcGVjaWZpZXMgdGhlIHJlc3VsdCBpZGVudGlmaWVyLlxuICAgICAqL1xuICAgIGdldCByZXN1bHRJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlc3VsdElkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgc3RhdHVzIG9mIHRoZSByZXN1bHQuXG4gICAgICogQG1lbWJlciBSZWNvZ25pdGlvblJlc3VsdC5wcm90b3R5cGUucmVhc29uXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtSZXN1bHRSZWFzb259IFNwZWNpZmllcyBzdGF0dXMgb2YgdGhlIHJlc3VsdC5cbiAgICAgKi9cbiAgICBnZXQgcmVhc29uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVhc29uO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcmVzZW50cyB0aGUgcmVjb2duaXplZCB0ZXh0IGluIHRoZSByZXN1bHQuXG4gICAgICogQG1lbWJlciBSZWNvZ25pdGlvblJlc3VsdC5wcm90b3R5cGUudGV4dFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBQcmVzZW50cyB0aGUgcmVjb2duaXplZCB0ZXh0IGluIHRoZSByZXN1bHQuXG4gICAgICovXG4gICAgZ2V0IHRleHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUZXh0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEdXJhdGlvbiBvZiByZWNvZ25pemVkIHNwZWVjaCBpbiAxMDAgbmFubyBzZWNvbmQgaW5jcmVtZW50cy5cbiAgICAgKiBAbWVtYmVyIFJlY29nbml0aW9uUmVzdWx0LnByb3RvdHlwZS5kdXJhdGlvblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBEdXJhdGlvbiBvZiByZWNvZ25pemVkIHNwZWVjaCBpbiAxMDAgbmFubyBzZWNvbmQgaW5jcmVtZW50cy5cbiAgICAgKi9cbiAgICBnZXQgZHVyYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZEdXJhdGlvbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogT2Zmc2V0IG9mIHJlY29nbml6ZWQgc3BlZWNoIGluIDEwMCBuYW5vIHNlY29uZCBpbmNyZW1lbnRzLlxuICAgICAqIEBtZW1iZXIgUmVjb2duaXRpb25SZXN1bHQucHJvdG90eXBlLm9mZnNldFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBPZmZzZXQgb2YgcmVjb2duaXplZCBzcGVlY2ggaW4gMTAwIG5hbm8gc2Vjb25kIGluY3JlbWVudHMuXG4gICAgICovXG4gICAgZ2V0IG9mZnNldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdk9mZnNldDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUHJpbWFyeSBMYW5ndWFnZSBkZXRlY3RlZC5cbiAgICAgKiBAbWVtYmVyIFJlY29nbml0aW9uUmVzdWx0LnByb3RvdHlwZS5sYW5ndWFnZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBsYW5ndWFnZSBkZXRlY3RlZC5cbiAgICAgKi9cbiAgICBnZXQgbGFuZ3VhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZMYW5ndWFnZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUHJpbWFyeSBMYW5ndWFnZSBkZXRlY3Rpb24gY29uZmlkZW5jZSAoVW5rbm93biwgTG93LCBNZWRpdW0sIEhpZ2gpLlxuICAgICAqIEBtZW1iZXIgUmVjb2duaXRpb25SZXN1bHQucHJvdG90eXBlLmxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBkZXRlY3Rpb24gY29uZmlkZW5jZSBzdHJlbmd0aC5cbiAgICAgKi9cbiAgICBnZXQgbGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbiBjYXNlIG9mIGFuIHVuc3VjY2Vzc2Z1bCByZWNvZ25pdGlvbiwgcHJvdmlkZXMgZGV0YWlscyBvZiB0aGUgb2NjdXJyZWQgZXJyb3IuXG4gICAgICogQG1lbWJlciBSZWNvZ25pdGlvblJlc3VsdC5wcm90b3R5cGUuZXJyb3JEZXRhaWxzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IGEgYnJpZWYgZGVzY3JpcHRpb24gb2YgYW4gZXJyb3IuXG4gICAgICovXG4gICAgZ2V0IGVycm9yRGV0YWlscygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkVycm9yRGV0YWlscztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQSBzdHJpbmcgY29udGFpbmluZyBKc29uIHNlcmlhbGl6ZWQgcmVjb2duaXRpb24gcmVzdWx0IGFzIGl0IHdhcyByZWNlaXZlZCBmcm9tIHRoZSBzZXJ2aWNlLlxuICAgICAqIEBtZW1iZXIgUmVjb2duaXRpb25SZXN1bHQucHJvdG90eXBlLmpzb25cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IEpzb24gc2VyaWFsaXplZCByZXByZXNlbnRhdGlvbiBvZiB0aGUgcmVzdWx0LlxuICAgICAqL1xuICAgIGdldCBqc29uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SnNvbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIHNldCBvZiBwcm9wZXJ0aWVzIGV4cG9zZWQgaW4gdGhlIHJlc3VsdC5cbiAgICAgKiBAbWVtYmVyIFJlY29nbml0aW9uUmVzdWx0LnByb3RvdHlwZS5wcm9wZXJ0aWVzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtQcm9wZXJ0eUNvbGxlY3Rpb259IFRoZSBzZXQgb2YgcHJvcGVydGllcyBleHBvc2VkIGluIHRoZSByZXN1bHQuXG4gICAgICovXG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UmVjb2duaXRpb25SZXN1bHQuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgQ29nbml0aXZlU3Vic2NyaXB0aW9uS2V5QXV0aGVudGljYXRpb24sIENvZ25pdGl2ZVRva2VuQXV0aGVudGljYXRpb24sIENvbnRleHQsIE9TLCBTZXJ2aWNlUmVjb2duaXplckJhc2UsIFNwZWVjaFNlcnZpY2VDb25maWcsIH0gZnJvbSBcIi4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgRGVmZXJyZWQsIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3MgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuL0NvbnRyYWN0c1wiO1xuaW1wb3J0IHsgQXVkaW9Db25maWcsIFByb3BlcnR5SWQsIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBEZWZpbmVzIHRoZSBiYXNlIGNsYXNzIFJlY29nbml6ZXIgd2hpY2ggbWFpbmx5IGNvbnRhaW5zIGNvbW1vbiBldmVudCBoYW5kbGVycy5cbiAqIEBjbGFzcyBSZWNvZ25pemVyXG4gKi9cbmV4cG9ydCBjbGFzcyBSZWNvZ25pemVyIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiBhIFJlY29nbml6ZXJcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge0F1ZGlvQ29uZmlnfSBhdWRpb0lucHV0IC0gQW4gb3B0aW9uYWwgYXVkaW8gaW5wdXQgc3RyZWFtIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVjb2duaXplclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGF1ZGlvQ29uZmlnLCBwcm9wZXJ0aWVzLCBjb25uZWN0aW9uRmFjdG9yeSkge1xuICAgICAgICB0aGlzLmF1ZGlvQ29uZmlnID0gKGF1ZGlvQ29uZmlnICE9PSB1bmRlZmluZWQpID8gYXVkaW9Db25maWcgOiBBdWRpb0NvbmZpZy5mcm9tRGVmYXVsdE1pY3JvcGhvbmVJbnB1dCgpO1xuICAgICAgICB0aGlzLnByaXZEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzID0gcHJvcGVydGllcy5jbG9uZSgpO1xuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uRmFjdG9yeSA9IGNvbm5lY3Rpb25GYWN0b3J5O1xuICAgICAgICB0aGlzLmltcGxDb21tb25SZWNvZ25pemVyU2V0dXAoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGlzcG9zZSBvZiBhc3NvY2lhdGVkIHJlc291cmNlcy5cbiAgICAgKiBAbWVtYmVyIFJlY29nbml6ZXIucHJvdG90eXBlLmNsb3NlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGNsb3NlKGNiLCBlcnJvckNiKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWQpO1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMuZGlzcG9zZSh0cnVlKSwgY2IsIGVycm9yQ2IpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBASW50ZXJuYWxcbiAgICAgKiBJbnRlcm5hbCBkYXRhIG1lbWJlciB0byBzdXBwb3J0IGZyb21SZWNvZ25pemVyKiBwYXR0ZXJuIG1ldGhvZHMgb24gb3RoZXIgY2xhc3Nlcy5cbiAgICAgKiBEbyBub3QgdXNlIGV4dGVybmFsbHksIG9iamVjdCByZXR1cm5lZCB3aWxsIGNoYW5nZSB3aXRob3V0IHdhcm5pbmcgb3Igbm90aWNlLlxuICAgICAqL1xuICAgIGdldCBpbnRlcm5hbERhdGEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZWNvO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBwZXJmb3JtcyBjbGVhbnVwIG9mIHJlc291cmNlcy5cbiAgICAgKiBUaGUgQm9vbGVhbiBwYXJhbWV0ZXIgZGlzcG9zaW5nIGluZGljYXRlcyB3aGV0aGVyIHRoZSBtZXRob2QgaXMgY2FsbGVkXG4gICAgICogZnJvbSBEaXNwb3NlIChpZiBkaXNwb3NpbmcgaXMgdHJ1ZSkgb3IgZnJvbSB0aGUgZmluYWxpemVyIChpZiBkaXNwb3NpbmcgaXMgZmFsc2UpLlxuICAgICAqIERlcml2ZWQgY2xhc3NlcyBzaG91bGQgb3ZlcnJpZGUgdGhpcyBtZXRob2QgdG8gZGlzcG9zZSByZXNvdXJjZSBpZiBuZWVkZWQuXG4gICAgICogQG1lbWJlciBSZWNvZ25pemVyLnByb3RvdHlwZS5kaXNwb3NlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gZGlzcG9zaW5nIC0gRmxhZyB0byByZXF1ZXN0IGRpc3Bvc2FsLlxuICAgICAqL1xuICAgIGRpc3Bvc2UoZGlzcG9zaW5nKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2RGlzcG9zZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnByaXZEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgICAgICBpZiAoZGlzcG9zaW5nKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdlJlY28pIHtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2UmVjby5hdWRpb1NvdXJjZS50dXJuT2ZmKCk7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdlJlY28uZGlzcG9zZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIHJldHVybnMgdGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIHRlbGVtZXRyeSBzZXR0aW5nLlxuICAgICAqIEBtZW1iZXIgUmVjb2duaXplci5wcm90b3R5cGUudGVsZW1ldHJ5RW5hYmxlZFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB0cnVlIGlmIHRoZSB0ZWxlbWV0cnkgaXMgZW5hYmxlZCwgZmFsc2Ugb3RoZXJ3aXNlLlxuICAgICAqL1xuICAgIHN0YXRpYyBnZXQgdGVsZW1ldHJ5RW5hYmxlZCgpIHtcbiAgICAgICAgcmV0dXJuIFNlcnZpY2VSZWNvZ25pemVyQmFzZS50ZWxlbWV0cnlEYXRhRW5hYmxlZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgZ2xvYmFsbHkgZW5hYmxlcyBvciBkaXNhYmxlcyB0ZWxlbWV0cnkuXG4gICAgICogQG1lbWJlciBSZWNvZ25pemVyLnByb3RvdHlwZS5lbmFibGVUZWxlbWV0cnlcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIGVuYWJsZWQgLSBHbG9iYWwgc2V0dGluZyBmb3IgdGVsZW1ldHJ5IGNvbGxlY3Rpb24uXG4gICAgICogSWYgc2V0IHRvIHRydWUsIHRlbGVtZXRyeSBpbmZvcm1hdGlvbiBsaWtlIG1pY3JvcGhvbmUgZXJyb3JzLFxuICAgICAqIHJlY29nbml0aW9uIGVycm9ycyBhcmUgY29sbGVjdGVkIGFuZCBzZW50IHRvIE1pY3Jvc29mdC5cbiAgICAgKiBJZiBzZXQgdG8gZmFsc2UsIG5vIHRlbGVtZXRyeSBpcyBzZW50IHRvIE1pY3Jvc29mdC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZW5hYmxlVGVsZW1ldHJ5KGVuYWJsZWQpIHtcbiAgICAgICAgU2VydmljZVJlY29nbml6ZXJCYXNlLnRlbGVtZXRyeURhdGFFbmFibGVkID0gZW5hYmxlZDtcbiAgICB9XG4gICAgLy8gRG9lcyB0aGUgZ2VuZXJpYyByZWNvZ25pemVyIHNldHVwIHRoYXQgaXMgY29tbW9uIGFjcm9zcyBhbGwgcmVjb2duaXplciB0eXBlcy5cbiAgICBpbXBsQ29tbW9uUmVjb2duaXplclNldHVwKCkge1xuICAgICAgICBsZXQgb3NQbGF0Zm9ybSA9ICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSA/IFwiQnJvd3NlclwiIDogXCJOb2RlXCI7XG4gICAgICAgIGxldCBvc05hbWUgPSBcInVua25vd25cIjtcbiAgICAgICAgbGV0IG9zVmVyc2lvbiA9IFwidW5rbm93blwiO1xuICAgICAgICBpZiAodHlwZW9mIG5hdmlnYXRvciAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgb3NQbGF0Zm9ybSA9IG9zUGxhdGZvcm0gKyBcIi9cIiArIG5hdmlnYXRvci5wbGF0Zm9ybTtcbiAgICAgICAgICAgIG9zTmFtZSA9IG5hdmlnYXRvci51c2VyQWdlbnQ7XG4gICAgICAgICAgICBvc1ZlcnNpb24gPSBuYXZpZ2F0b3IuYXBwVmVyc2lvbjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZWNvZ25pemVyQ29uZmlnID0gdGhpcy5jcmVhdGVSZWNvZ25pemVyQ29uZmlnKG5ldyBTcGVlY2hTZXJ2aWNlQ29uZmlnKG5ldyBDb250ZXh0KG5ldyBPUyhvc1BsYXRmb3JtLCBvc05hbWUsIG9zVmVyc2lvbikpKSk7XG4gICAgICAgIHRoaXMucHJpdlJlY28gPSB0aGlzLmNyZWF0ZVNlcnZpY2VSZWNvZ25pemVyKFJlY29nbml6ZXIuZ2V0QXV0aEZyb21Qcm9wZXJ0aWVzKHRoaXMucHJpdlByb3BlcnRpZXMpLCB0aGlzLnByaXZDb25uZWN0aW9uRmFjdG9yeSwgdGhpcy5hdWRpb0NvbmZpZywgcmVjb2duaXplckNvbmZpZyk7XG4gICAgfVxuICAgIHJlY29nbml6ZU9uY2VBc3luY0ltcGwocmVjb2duaXRpb25Nb2RlKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkRpc3Bvc2VkKTtcbiAgICAgICAgICAgIGNvbnN0IHJldCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICAgICAgeWllbGQgdGhpcy5pbXBsUmVjb2duaXplclN0b3AoKTtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdlJlY28ucmVjb2duaXplKHJlY29nbml0aW9uTW9kZSwgcmV0LnJlc29sdmUsIHJldC5yZWplY3QpO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0geWllbGQgcmV0LnByb21pc2U7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLmltcGxSZWNvZ25pemVyU3RvcCgpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHN0YXJ0Q29udGludW91c1JlY29nbml0aW9uQXN5bmNJbXBsKHJlY29nbml0aW9uTW9kZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZEaXNwb3NlZCk7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLmltcGxSZWNvZ25pemVyU3RvcCgpO1xuICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2UmVjby5yZWNvZ25pemUocmVjb2duaXRpb25Nb2RlLCB1bmRlZmluZWQsIHVuZGVmaW5lZCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzdG9wQ29udGludW91c1JlY29nbml0aW9uQXN5bmNJbXBsKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZEaXNwb3NlZCk7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLmltcGxSZWNvZ25pemVyU3RvcCgpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgaW1wbFJlY29nbml6ZXJTdG9wKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdlJlY28pIHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZSZWNvLnN0b3BSZWNvZ25pemluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc3RhdGljIGdldEF1dGhGcm9tUHJvcGVydGllcyhwcm9wZXJ0aWVzKSB7XG4gICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbktleSA9IHByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9LZXksIHVuZGVmaW5lZCk7XG4gICAgICAgIGNvbnN0IGF1dGhlbnRpY2F0aW9uID0gKHN1YnNjcmlwdGlvbktleSAmJiBzdWJzY3JpcHRpb25LZXkgIT09IFwiXCIpID9cbiAgICAgICAgICAgIG5ldyBDb2duaXRpdmVTdWJzY3JpcHRpb25LZXlBdXRoZW50aWNhdGlvbihzdWJzY3JpcHRpb25LZXkpIDpcbiAgICAgICAgICAgIG5ldyBDb2duaXRpdmVUb2tlbkF1dGhlbnRpY2F0aW9uKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBhdXRob3JpemF0aW9uVG9rZW4gPSBwcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW4sIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShhdXRob3JpemF0aW9uVG9rZW4pO1xuICAgICAgICAgICAgfSwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGF1dGhvcml6YXRpb25Ub2tlbiA9IHByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbiwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGF1dGhvcml6YXRpb25Ub2tlbik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGF1dGhlbnRpY2F0aW9uO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UmVjb2duaXplci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBEZWZpbmVzIHRoZSBwb3NzaWJsZSByZWFzb25zIGEgcmVjb2duaXRpb24gcmVzdWx0IG1pZ2h0IGJlIGdlbmVyYXRlZC5cbiAqIEBjbGFzcyBSZXN1bHRSZWFzb25cbiAqL1xuZXhwb3J0IHZhciBSZXN1bHRSZWFzb247XG4oZnVuY3Rpb24gKFJlc3VsdFJlYXNvbikge1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyBzcGVlY2ggY291bGQgbm90IGJlIHJlY29nbml6ZWQuIE1vcmUgZGV0YWlsc1xuICAgICAqIGNhbiBiZSBmb3VuZCBpbiB0aGUgTm9NYXRjaERldGFpbHMgb2JqZWN0LlxuICAgICAqIEBtZW1iZXIgUmVzdWx0UmVhc29uLk5vTWF0Y2hcbiAgICAgKi9cbiAgICBSZXN1bHRSZWFzb25bUmVzdWx0UmVhc29uW1wiTm9NYXRjaFwiXSA9IDBdID0gXCJOb01hdGNoXCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIHRoYXQgdGhlIHJlY29nbml0aW9uIHdhcyBjYW5jZWxlZC4gTW9yZSBkZXRhaWxzXG4gICAgICogY2FuIGJlIGZvdW5kIHVzaW5nIHRoZSBDYW5jZWxsYXRpb25EZXRhaWxzIG9iamVjdC5cbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5DYW5jZWxlZFxuICAgICAqL1xuICAgIFJlc3VsdFJlYXNvbltSZXN1bHRSZWFzb25bXCJDYW5jZWxlZFwiXSA9IDFdID0gXCJDYW5jZWxlZFwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGUgc3BlZWNoIHJlc3VsdCBjb250YWlucyBoeXBvdGhlc2lzIHRleHQuXG4gICAgICogQG1lbWJlciBSZXN1bHRSZWFzb24uUmVjb2duaXplZFNwZWVjaFxuICAgICAqL1xuICAgIFJlc3VsdFJlYXNvbltSZXN1bHRSZWFzb25bXCJSZWNvZ25pemluZ1NwZWVjaFwiXSA9IDJdID0gXCJSZWNvZ25pemluZ1NwZWVjaFwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGUgc3BlZWNoIHJlc3VsdCBjb250YWlucyBmaW5hbCB0ZXh0IHRoYXQgaGFzIGJlZW4gcmVjb2duaXplZC5cbiAgICAgKiBTcGVlY2ggUmVjb2duaXRpb24gaXMgbm93IGNvbXBsZXRlIGZvciB0aGlzIHBocmFzZS5cbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5SZWNvZ25pemVkU3BlZWNoXG4gICAgICovXG4gICAgUmVzdWx0UmVhc29uW1Jlc3VsdFJlYXNvbltcIlJlY29nbml6ZWRTcGVlY2hcIl0gPSAzXSA9IFwiUmVjb2duaXplZFNwZWVjaFwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGUgc3BlZWNoIHJlc3VsdCBjb250YWlucyBhIGZpbmFsaXplZCBhY2NlcHRhbmNlIG9mIGEgcHJvdmlkZWQga2V5d29yZC5cbiAgICAgKiBTcGVlY2ggcmVjb2duaXRpb24gd2lsbCBjb250aW51ZSB1bmxlc3Mgb3RoZXJ3aXNlIGNvbmZpZ3VyZWQuXG4gICAgICogQG1lbWJlciBSZXN1bHRSZWFzb24uUmVjb2duaXplZEtleXdvcmRcbiAgICAgKi9cbiAgICBSZXN1bHRSZWFzb25bUmVzdWx0UmVhc29uW1wiUmVjb2duaXplZEtleXdvcmRcIl0gPSA0XSA9IFwiUmVjb2duaXplZEtleXdvcmRcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhlIGludGVudCByZXN1bHQgY29udGFpbnMgaHlwb3RoZXNpcyB0ZXh0IGFuZCBpbnRlbnQuXG4gICAgICogQG1lbWJlciBSZXN1bHRSZWFzb24uUmVjb2duaXppbmdJbnRlbnRcbiAgICAgKi9cbiAgICBSZXN1bHRSZWFzb25bUmVzdWx0UmVhc29uW1wiUmVjb2duaXppbmdJbnRlbnRcIl0gPSA1XSA9IFwiUmVjb2duaXppbmdJbnRlbnRcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhlIGludGVudCByZXN1bHQgY29udGFpbnMgZmluYWwgdGV4dCBhbmQgaW50ZW50LlxuICAgICAqIFNwZWVjaCBSZWNvZ25pdGlvbiBhbmQgSW50ZW50IGRldGVybWluYXRpb24gYXJlIG5vdyBjb21wbGV0ZSBmb3IgdGhpcyBwaHJhc2UuXG4gICAgICogQG1lbWJlciBSZXN1bHRSZWFzb24uUmVjb2duaXplZEludGVudFxuICAgICAqL1xuICAgIFJlc3VsdFJlYXNvbltSZXN1bHRSZWFzb25bXCJSZWNvZ25pemVkSW50ZW50XCJdID0gNl0gPSBcIlJlY29nbml6ZWRJbnRlbnRcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhlIHRyYW5zbGF0aW9uIHJlc3VsdCBjb250YWlucyBoeXBvdGhlc2lzIHRleHQgYW5kIGl0cyB0cmFuc2xhdGlvbihzKS5cbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5UcmFuc2xhdGluZ1NwZWVjaFxuICAgICAqL1xuICAgIFJlc3VsdFJlYXNvbltSZXN1bHRSZWFzb25bXCJUcmFuc2xhdGluZ1NwZWVjaFwiXSA9IDddID0gXCJUcmFuc2xhdGluZ1NwZWVjaFwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGUgdHJhbnNsYXRpb24gcmVzdWx0IGNvbnRhaW5zIGZpbmFsIHRleHQgYW5kIGNvcnJlc3BvbmRpbmcgdHJhbnNsYXRpb24ocykuXG4gICAgICogU3BlZWNoIFJlY29nbml0aW9uIGFuZCBUcmFuc2xhdGlvbiBhcmUgbm93IGNvbXBsZXRlIGZvciB0aGlzIHBocmFzZS5cbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5UcmFuc2xhdGVkU3BlZWNoXG4gICAgICovXG4gICAgUmVzdWx0UmVhc29uW1Jlc3VsdFJlYXNvbltcIlRyYW5zbGF0ZWRTcGVlY2hcIl0gPSA4XSA9IFwiVHJhbnNsYXRlZFNwZWVjaFwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGUgc3ludGhlc2l6ZWQgYXVkaW8gcmVzdWx0IGNvbnRhaW5zIGEgbm9uLXplcm8gYW1vdW50IG9mIGF1ZGlvIGRhdGFcbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5TeW50aGVzaXppbmdBdWRpb1xuICAgICAqL1xuICAgIFJlc3VsdFJlYXNvbltSZXN1bHRSZWFzb25bXCJTeW50aGVzaXppbmdBdWRpb1wiXSA9IDldID0gXCJTeW50aGVzaXppbmdBdWRpb1wiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGUgc3ludGhlc2l6ZWQgYXVkaW8gaXMgbm93IGNvbXBsZXRlIGZvciB0aGlzIHBocmFzZS5cbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5TeW50aGVzaXppbmdBdWRpb0NvbXBsZXRlZFxuICAgICAqL1xuICAgIFJlc3VsdFJlYXNvbltSZXN1bHRSZWFzb25bXCJTeW50aGVzaXppbmdBdWRpb0NvbXBsZXRlZFwiXSA9IDEwXSA9IFwiU3ludGhlc2l6aW5nQXVkaW9Db21wbGV0ZWRcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhlIHNwZWVjaCBzeW50aGVzaXMgaXMgbm93IHN0YXJ0ZWRcbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5TeW50aGVzaXppbmdBdWRpb1N0YXJ0ZWRcbiAgICAgKi9cbiAgICBSZXN1bHRSZWFzb25bUmVzdWx0UmVhc29uW1wiU3ludGhlc2l6aW5nQXVkaW9TdGFydGVkXCJdID0gMTFdID0gXCJTeW50aGVzaXppbmdBdWRpb1N0YXJ0ZWRcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhlIHZvaWNlIHByb2ZpbGUgaXMgYmVpbmcgZW5yb2xsZWQgYW5kIGN1c3RvbWVycyBuZWVkIHRvIHNlbmQgbW9yZSBhdWRpbyB0byBjcmVhdGUgYSB2b2ljZSBwcm9maWxlLlxuICAgICAqIEBtZW1iZXIgUmVzdWx0UmVhc29uLkVucm9sbGluZ1ZvaWNlUHJvZmlsZVxuICAgICAqL1xuICAgIFJlc3VsdFJlYXNvbltSZXN1bHRSZWFzb25bXCJFbnJvbGxpbmdWb2ljZVByb2ZpbGVcIl0gPSAxMl0gPSBcIkVucm9sbGluZ1ZvaWNlUHJvZmlsZVwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGUgdm9pY2UgcHJvZmlsZSBoYXMgYmVlbiBlbnJvbGxlZC5cbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5FbnJvbGxlZFZvaWNlUHJvZmlsZVxuICAgICAqL1xuICAgIFJlc3VsdFJlYXNvbltSZXN1bHRSZWFzb25bXCJFbnJvbGxlZFZvaWNlUHJvZmlsZVwiXSA9IDEzXSA9IFwiRW5yb2xsZWRWb2ljZVByb2ZpbGVcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgc3VjY2Vzc2Z1bCBpZGVudGlmaWNhdGlvbiBvZiBzb21lIHNwZWFrZXJzLlxuICAgICAqIEBtZW1iZXIgUmVzdWx0UmVhc29uLlJlY29nbml6ZWRTcGVha2Vyc1xuICAgICAqL1xuICAgIFJlc3VsdFJlYXNvbltSZXN1bHRSZWFzb25bXCJSZWNvZ25pemVkU3BlYWtlcnNcIl0gPSAxNF0gPSBcIlJlY29nbml6ZWRTcGVha2Vyc1wiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyBzdWNjZXNzZnVsbHkgdmVyaWZpZWQgb25lIHNwZWFrZXIuXG4gICAgICogQG1lbWJlciBSZXN1bHRSZWFzb24uUmVjb2duaXplZFNwZWFrZXJcbiAgICAgKi9cbiAgICBSZXN1bHRSZWFzb25bUmVzdWx0UmVhc29uW1wiUmVjb2duaXplZFNwZWFrZXJcIl0gPSAxNV0gPSBcIlJlY29nbml6ZWRTcGVha2VyXCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIGEgdm9pY2UgcHJvZmlsZSBoYXMgYmVlbiByZXNldCBzdWNjZXNzZnVsbHkuXG4gICAgICogQG1lbWJlciBSZXN1bHRSZWFzb24uUmVzZXRWb2ljZVByb2ZpbGVcbiAgICAgKi9cbiAgICBSZXN1bHRSZWFzb25bUmVzdWx0UmVhc29uW1wiUmVzZXRWb2ljZVByb2ZpbGVcIl0gPSAxNl0gPSBcIlJlc2V0Vm9pY2VQcm9maWxlXCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIGEgdm9pY2UgcHJvZmlsZSBoYXMgYmVlbiBkZWxldGVkIHN1Y2Nlc3NmdWxseS5cbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5EZWxldGVkVm9pY2VQcm9maWxlXG4gICAgICovXG4gICAgUmVzdWx0UmVhc29uW1Jlc3VsdFJlYXNvbltcIkRlbGV0ZWRWb2ljZVByb2ZpbGVcIl0gPSAxN10gPSBcIkRlbGV0ZWRWb2ljZVByb2ZpbGVcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgc3ludGhlc2lzIHZvaWNlcyBsaXN0IGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSByZXRyaWV2ZWQuXG4gICAgICogQG1lbWJlciBSZXN1bHRSZWFzb24uVm9pY2VzTGlzdFJldHJpZXZlZFxuICAgICAqL1xuICAgIFJlc3VsdFJlYXNvbltSZXN1bHRSZWFzb25bXCJWb2ljZXNMaXN0UmV0cmlldmVkXCJdID0gMThdID0gXCJWb2ljZXNMaXN0UmV0cmlldmVkXCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIHRoZSB0cmFuc2NyaXB0aW9uIHJlc3VsdCBjb250YWlucyBoeXBvdGhlc2lzIHRleHQgYW5kIGl0cyB0cmFuc2xhdGlvbihzKSBmb3JcbiAgICAgKiBvdGhlciBwYXJ0aWNpcGFudHMgaW4gdGhlIGNvbnZlcnNhdGlvbi5cbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5UcmFuc2xhdGluZ1BhcnRpY2lwYW50U3BlZWNoXG4gICAgICovXG4gICAgUmVzdWx0UmVhc29uW1Jlc3VsdFJlYXNvbltcIlRyYW5zbGF0aW5nUGFydGljaXBhbnRTcGVlY2hcIl0gPSAxOV0gPSBcIlRyYW5zbGF0aW5nUGFydGljaXBhbnRTcGVlY2hcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhlIHRyYW5zY3JpcHRpb24gcmVzdWx0IGNvbnRhaW5zIGZpbmFsIHRleHQgYW5kIGNvcnJlc3BvbmRpbmcgdHJhbnNsYXRpb24ocylcbiAgICAgKiBmb3Igb3RoZXIgcGFydGljaXBhbnRzIGluIHRoZSBjb252ZXJzYXRpb24uIFNwZWVjaCBSZWNvZ25pdGlvbiBhbmQgVHJhbnNsYXRpb24gYXJlIG5vd1xuICAgICAqIGNvbXBsZXRlIGZvciB0aGlzIHBocmFzZS5cbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5UcmFuc2xhdGVkUGFydGljaXBhbnRTcGVlY2hcbiAgICAgKi9cbiAgICBSZXN1bHRSZWFzb25bUmVzdWx0UmVhc29uW1wiVHJhbnNsYXRlZFBhcnRpY2lwYW50U3BlZWNoXCJdID0gMjBdID0gXCJUcmFuc2xhdGVkUGFydGljaXBhbnRTcGVlY2hcIjtcbiAgICAvKipcbiAgICAgKiA8c3VtbWFyeT5cbiAgICAgKiBJbmRpY2F0ZXMgdGhlIHRyYW5zY3JpcHRpb24gcmVzdWx0IGNvbnRhaW5zIHRoZSBpbnN0YW50IG1lc3NhZ2UgYW5kIGNvcnJlc3BvbmRpbmdcbiAgICAgKiB0cmFuc2xhdGlvbihzKS5cbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5UcmFuc2xhdGVkSW5zdGFudE1lc3NhZ2VcbiAgICAgKi9cbiAgICBSZXN1bHRSZWFzb25bUmVzdWx0UmVhc29uW1wiVHJhbnNsYXRlZEluc3RhbnRNZXNzYWdlXCJdID0gMjFdID0gXCJUcmFuc2xhdGVkSW5zdGFudE1lc3NhZ2VcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhlIHRyYW5zY3JpcHRpb24gcmVzdWx0IGNvbnRhaW5zIHRoZSBpbnN0YW50IG1lc3NhZ2UgZm9yIG90aGVyIHBhcnRpY2lwYW50c1xuICAgICAqIGluIHRoZSBjb252ZXJzYXRpb24gYW5kIGNvcnJlc3BvbmRpbmcgdHJhbnNsYXRpb24ocykuXG4gICAgICogQG1lbWJlciBSZXN1bHRSZWFzb24uVHJhbnNsYXRlZFBhcnRpY2lwYW50SW5zdGFudE1lc3NhZ2VcbiAgICAgKi9cbiAgICBSZXN1bHRSZWFzb25bUmVzdWx0UmVhc29uW1wiVHJhbnNsYXRlZFBhcnRpY2lwYW50SW5zdGFudE1lc3NhZ2VcIl0gPSAyMl0gPSBcIlRyYW5zbGF0ZWRQYXJ0aWNpcGFudEluc3RhbnRNZXNzYWdlXCI7XG59KShSZXN1bHRSZWFzb24gfHwgKFJlc3VsdFJlYXNvbiA9IHt9KSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVJlc3VsdFJlYXNvbi5qcy5tYXBcbiIsIi8vXG4vLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdC4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4gU2VlIExJQ0VOU0UubWQgZmlsZSBpbiB0aGUgcHJvamVjdCByb290IGZvciBmdWxsIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4vL1xuaW1wb3J0IHsgU2Vzc2lvbkV2ZW50QXJncyB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogRGVmaW5lcyBwYXlsb2FkIGZvciBhbnkgU2VydmljZSBtZXNzYWdlIGV2ZW50XG4gKiBBZGRlZCBpbiB2ZXJzaW9uIDEuOS4wXG4gKi9cbmV4cG9ydCBjbGFzcyBTZXJ2aWNlRXZlbnRBcmdzIGV4dGVuZHMgU2Vzc2lvbkV2ZW50QXJncyB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ganNvbiAtIGpzb24gcGF5bG9hZCBvZiB0aGUgVVNQIG1lc3NhZ2UuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoanNvbiwgbmFtZSwgc2Vzc2lvbklkKSB7XG4gICAgICAgIHN1cGVyKHNlc3Npb25JZCk7XG4gICAgICAgIHRoaXMucHJpdkpzb25SZXN1bHQgPSBqc29uO1xuICAgICAgICB0aGlzLnByaXZFdmVudE5hbWUgPSBuYW1lO1xuICAgIH1cbiAgICBnZXQganNvblN0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkpzb25SZXN1bHQ7XG4gICAgfVxuICAgIGdldCBldmVudE5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZFdmVudE5hbWU7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TZXJ2aWNlRXZlbnRBcmdzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIERlZmluZXMgY2hhbm5lbHMgdXNlZCB0byBwYXNzIHByb3BlcnR5IHNldHRpbmdzIHRvIHNlcnZpY2UuXG4gKiBBZGRlZCBpbiB2ZXJzaW9uIDEuNy4wLlxuICovXG5leHBvcnQgdmFyIFNlcnZpY2VQcm9wZXJ0eUNoYW5uZWw7XG4oZnVuY3Rpb24gKFNlcnZpY2VQcm9wZXJ0eUNoYW5uZWwpIHtcbiAgICAvKipcbiAgICAgKiBVc2VzIFVSSSBxdWVyeSBwYXJhbWV0ZXIgdG8gcGFzcyBwcm9wZXJ0eSBzZXR0aW5ncyB0byBzZXJ2aWNlLlxuICAgICAqL1xuICAgIFNlcnZpY2VQcm9wZXJ0eUNoYW5uZWxbU2VydmljZVByb3BlcnR5Q2hhbm5lbFtcIlVyaVF1ZXJ5UGFyYW1ldGVyXCJdID0gMF0gPSBcIlVyaVF1ZXJ5UGFyYW1ldGVyXCI7XG59KShTZXJ2aWNlUHJvcGVydHlDaGFubmVsIHx8IChTZXJ2aWNlUHJvcGVydHlDaGFubmVsID0ge30pKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U2VydmljZVByb3BlcnR5Q2hhbm5lbC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBEZWZpbmVzIGNvbnRlbnQgZm9yIHNlc3Npb24gZXZlbnRzIGxpa2UgU2Vzc2lvblN0YXJ0ZWQvU3RvcHBlZCwgU291bmRTdGFydGVkL1N0b3BwZWQuXG4gKiBAY2xhc3MgU2Vzc2lvbkV2ZW50QXJnc1xuICovXG5leHBvcnQgY2xhc3MgU2Vzc2lvbkV2ZW50QXJncyB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc2Vzc2lvbklkIC0gVGhlIHNlc3Npb24gaWQuXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc2Vzc2lvbklkKSB7XG4gICAgICAgIHRoaXMucHJpdlNlc3Npb25JZCA9IHNlc3Npb25JZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVwcmVzZW50cyB0aGUgc2Vzc2lvbiBpZGVudGlmaWVyLlxuICAgICAqIEBtZW1iZXIgU2Vzc2lvbkV2ZW50QXJncy5wcm90b3R5cGUuc2Vzc2lvbklkXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFJlcHJlc2VudHMgdGhlIHNlc3Npb24gaWRlbnRpZmllci5cbiAgICAgKi9cbiAgICBnZXQgc2Vzc2lvbklkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U2Vzc2lvbklkO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U2Vzc2lvbkV2ZW50QXJncy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4vQ29udHJhY3RzXCI7XG4vKipcbiAqIFNvdXJjZSBMYW5ndWFnZSBjb25maWd1cmF0aW9uLlxuICogQGNsYXNzIFNvdXJjZUxhbmd1YWdlQ29uZmlnXG4gKi9cbmV4cG9ydCBjbGFzcyBTb3VyY2VMYW5ndWFnZUNvbmZpZyB7XG4gICAgY29uc3RydWN0b3IobGFuZ3VhZ2UsIGVuZHBvaW50SWQpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQobGFuZ3VhZ2UsIFwibGFuZ3VhZ2VcIik7XG4gICAgICAgIHRoaXMucHJpdkxhbmd1YWdlID0gbGFuZ3VhZ2U7XG4gICAgICAgIHRoaXMucHJpdkVuZHBvaW50SWQgPSBlbmRwb2ludElkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAbWVtYmVyIFNvdXJjZUxhbmd1YWdlQ29uZmlnLmZyb21MYW5ndWFnZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbGFuZ3VhZ2UgbGFuZ3VhZ2UgKGVnLiBcImVuLVVTXCIpIHZhbHVlIG9mIGNvbmZpZy5cbiAgICAgKiBAcGFyYW0ge3N0cmluZz99IGVuZHBvaW50SWQgZW5kcG9pbnRJZCBvZiBtb2RlbCBib3VuZCB0byBnaXZlbiBsYW5ndWFnZSBvZiBjb25maWcuXG4gICAgICogQHJldHVybiB7U291cmNlTGFuZ3VhZ2VDb25maWd9IEluc3RhbmNlIG9mIFNvdXJjZUxhbmd1YWdlQ29uZmlnXG4gICAgICogQHN1bW1hcnkgQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiB0aGUgU291cmNlTGFuZ3VhZ2VDb25maWcgd2l0aCB0aGUgZ2l2ZW4gbGFuZ3VhZ2UgYW5kIG9wdGlvbmFsIGVuZHBvaW50SWQuXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjEzLjAuXG4gICAgICovXG4gICAgc3RhdGljIGZyb21MYW5ndWFnZShsYW5ndWFnZSwgZW5kcG9pbnRJZCkge1xuICAgICAgICByZXR1cm4gbmV3IFNvdXJjZUxhbmd1YWdlQ29uZmlnKGxhbmd1YWdlLCBlbmRwb2ludElkKTtcbiAgICB9XG4gICAgZ2V0IGxhbmd1YWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TGFuZ3VhZ2U7XG4gICAgfVxuICAgIGdldCBlbmRwb2ludElkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RW5kcG9pbnRJZDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNvdXJjZUxhbmd1YWdlQ29uZmlnLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi9Db250cmFjdHNcIjtcbmltcG9ydCB7IFZvaWNlUHJvZmlsZVR5cGUsIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBEZWZpbmVzIFNwZWFrZXJJZGVudGlmaWNhdGlvbk1vZGVsIGNsYXNzIGZvciBTcGVha2VyIFJlY29nbml0aW9uXG4gKiBNb2RlbCBjb250YWlucyBhIHNldCBvZiBwcm9maWxlcyBhZ2FpbnN0IHdoaWNoIHRvIGlkZW50aWZ5IHNwZWFrZXIocylcbiAqIEBjbGFzcyBTcGVha2VySWRlbnRpZmljYXRpb25Nb2RlbFxuICovXG5leHBvcnQgY2xhc3MgU3BlYWtlcklkZW50aWZpY2F0aW9uTW9kZWwge1xuICAgIGNvbnN0cnVjdG9yKHByb2ZpbGVzKSB7XG4gICAgICAgIHRoaXMucHJpdlZvaWNlUHJvZmlsZXMgPSBbXTtcbiAgICAgICAgdGhpcy5wcml2UHJvZmlsZUlkcyA9IFtdO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChwcm9maWxlcywgXCJWb2ljZVByb2ZpbGVzXCIpO1xuICAgICAgICBpZiAocHJvZmlsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFbXB0eSBWb2ljZSBQcm9maWxlcyBhcnJheVwiKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IHByb2ZpbGUgb2YgcHJvZmlsZXMpIHtcbiAgICAgICAgICAgIGlmIChwcm9maWxlLnByb2ZpbGVUeXBlICE9PSBWb2ljZVByb2ZpbGVUeXBlLlRleHRJbmRlcGVuZGVudElkZW50aWZpY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSWRlbnRpZmljYXRpb24gbW9kZWwgY2FuIG9ubHkgYmUgY3JlYXRlZCBmcm9tIElkZW50aWZpY2F0aW9uIHByb2ZpbGU6IFwiICsgcHJvZmlsZS5wcm9maWxlSWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wcml2Vm9pY2VQcm9maWxlcy5wdXNoKHByb2ZpbGUpO1xuICAgICAgICAgICAgdGhpcy5wcml2UHJvZmlsZUlkcy5wdXNoKHByb2ZpbGUucHJvZmlsZUlkKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZnJvbVByb2ZpbGVzKHByb2ZpbGVzKSB7XG4gICAgICAgIHJldHVybiBuZXcgU3BlYWtlcklkZW50aWZpY2F0aW9uTW9kZWwocHJvZmlsZXMpO1xuICAgIH1cbiAgICBnZXQgdm9pY2VQcm9maWxlSWRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvZmlsZUlkcy5qb2luKFwiLFwiKTtcbiAgICB9XG4gICAgZ2V0IHByb2ZpbGVJZHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9maWxlSWRzO1xuICAgIH1cbiAgICBnZXQgc2NlbmFyaW8oKSB7XG4gICAgICAgIHJldHVybiBcIlRleHRJbmRlcGVuZGVudElkZW50aWZpY2F0aW9uXCI7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TcGVha2VySWRlbnRpZmljYXRpb25Nb2RlbC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyogZXNsaW50LWRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGUgKi9cbmltcG9ydCB7IENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSB9IGZyb20gXCIuLi9jb21tb24uc3BlZWNoL0V4cG9ydHNcIjtcbmltcG9ydCB7IENhbmNlbGxhdGlvbkRldGFpbHNCYXNlLCBDYW5jZWxsYXRpb25FcnJvckNvZGUsIENhbmNlbGxhdGlvblJlYXNvbiwgUHJvcGVydHlDb2xsZWN0aW9uLCBQcm9wZXJ0eUlkLCBSZXN1bHRSZWFzb24sIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuZXhwb3J0IHZhciBTcGVha2VyUmVjb2duaXRpb25SZXN1bHRUeXBlO1xuKGZ1bmN0aW9uIChTcGVha2VyUmVjb2duaXRpb25SZXN1bHRUeXBlKSB7XG4gICAgU3BlYWtlclJlY29nbml0aW9uUmVzdWx0VHlwZVtTcGVha2VyUmVjb2duaXRpb25SZXN1bHRUeXBlW1wiVmVyaWZ5XCJdID0gMF0gPSBcIlZlcmlmeVwiO1xuICAgIFNwZWFrZXJSZWNvZ25pdGlvblJlc3VsdFR5cGVbU3BlYWtlclJlY29nbml0aW9uUmVzdWx0VHlwZVtcIklkZW50aWZ5XCJdID0gMV0gPSBcIklkZW50aWZ5XCI7XG59KShTcGVha2VyUmVjb2duaXRpb25SZXN1bHRUeXBlIHx8IChTcGVha2VyUmVjb2duaXRpb25SZXN1bHRUeXBlID0ge30pKTtcbi8qKlxuICogT3V0cHV0IGZvcm1hdFxuICogQGNsYXNzIFNwZWFrZXJSZWNvZ25pdGlvblJlc3VsdFxuICovXG5leHBvcnQgY2xhc3MgU3BlYWtlclJlY29nbml0aW9uUmVzdWx0IHtcbiAgICBjb25zdHJ1Y3RvcihyZXNwb25zZSwgcmVzdWx0UmVhc29uID0gUmVzdWx0UmVhc29uLlJlY29nbml6ZWRTcGVha2VyLCBjYW5jZWxsYXRpb25FcnJvckNvZGUgPSBDYW5jZWxsYXRpb25FcnJvckNvZGUuTm9FcnJvciwgZXJyb3JEZXRhaWxzID0gXCJcIikge1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICBjb25zdCByZXN1bHRUeXBlID0gcmVzcG9uc2Uuc2NlbmFyaW8gPT09IFwiVGV4dEluZGVwZW5kZW50SWRlbnRpZmljYXRpb25cIiA/IFNwZWFrZXJSZWNvZ25pdGlvblJlc3VsdFR5cGUuSWRlbnRpZnkgOiBTcGVha2VyUmVjb2duaXRpb25SZXN1bHRUeXBlLlZlcmlmeTtcbiAgICAgICAgdGhpcy5wcml2UmVhc29uID0gcmVzdWx0UmVhc29uO1xuICAgICAgICBpZiAodGhpcy5wcml2UmVhc29uICE9PSBSZXN1bHRSZWFzb24uQ2FuY2VsZWQpIHtcbiAgICAgICAgICAgIGlmIChyZXN1bHRUeXBlID09PSBTcGVha2VyUmVjb2duaXRpb25SZXN1bHRUeXBlLklkZW50aWZ5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UHJvZmlsZUlkID0gcmVzcG9uc2UuaWRlbnRpZmljYXRpb25SZXN1bHQuaWRlbnRpZmllZFByb2ZpbGUucHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlNjb3JlID0gcmVzcG9uc2UuaWRlbnRpZmljYXRpb25SZXN1bHQuaWRlbnRpZmllZFByb2ZpbGUuc2NvcmU7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVhc29uID0gUmVzdWx0UmVhc29uLlJlY29nbml6ZWRTcGVha2VycztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlNjb3JlID0gcmVzcG9uc2UudmVyaWZpY2F0aW9uUmVzdWx0LnNjb3JlO1xuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS52ZXJpZmljYXRpb25SZXN1bHQucmVjb2duaXRpb25SZXN1bHQudG9Mb3dlckNhc2UoKSAhPT0gXCJhY2NlcHRcIikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZSZWFzb24gPSBSZXN1bHRSZWFzb24uTm9NYXRjaDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnZlcmlmaWNhdGlvblJlc3VsdC5wcm9maWxlSWQgIT09IHVuZGVmaW5lZCAmJiByZXNwb25zZS52ZXJpZmljYXRpb25SZXN1bHQucHJvZmlsZUlkICE9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlByb2ZpbGVJZCA9IHJlc3BvbnNlLnZlcmlmaWNhdGlvblJlc3VsdC5wcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wcml2RXJyb3JEZXRhaWxzID0gZXJyb3JEZXRhaWxzO1xuICAgICAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShDYW5jZWxsYXRpb25FcnJvckNvZGVQcm9wZXJ0eU5hbWUsIENhbmNlbGxhdGlvbkVycm9yQ29kZVtjYW5jZWxsYXRpb25FcnJvckNvZGVdKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZVJlc3BvbnNlX0pzb25SZXN1bHQsIEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlKSk7XG4gICAgfVxuICAgIGdldCBwcm9wZXJ0aWVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcztcbiAgICB9XG4gICAgZ2V0IHJlYXNvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlYXNvbjtcbiAgICB9XG4gICAgZ2V0IHByb2ZpbGVJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb2ZpbGVJZDtcbiAgICB9XG4gICAgZ2V0IGVycm9yRGV0YWlscygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkVycm9yRGV0YWlscztcbiAgICB9XG4gICAgZ2V0IHNjb3JlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U2NvcmU7XG4gICAgfVxufVxuLyoqXG4gKiBAY2xhc3MgU3BlYWtlclJlY29nbml0aW9uQ2FuY2VsbGF0aW9uRGV0YWlsc1xuICovXG5leHBvcnQgY2xhc3MgU3BlYWtlclJlY29nbml0aW9uQ2FuY2VsbGF0aW9uRGV0YWlscyBleHRlbmRzIENhbmNlbGxhdGlvbkRldGFpbHNCYXNlIHtcbiAgICBjb25zdHJ1Y3RvcihyZWFzb24sIGVycm9yRGV0YWlscywgZXJyb3JDb2RlKSB7XG4gICAgICAgIHN1cGVyKHJlYXNvbiwgZXJyb3JEZXRhaWxzLCBlcnJvckNvZGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIFNwZWFrZXJSZWNvZ25pdGlvbkNhbmNlbGxhdGlvbkRldGFpbHMgb2JqZWN0IGZvciB0aGUgY2FuY2VsZWQgU3BlYWtlclJlY29nbml0aW9uUmVzdWx0XG4gICAgICogQG1lbWJlciBTcGVha2VyUmVjb2duaXRpb25DYW5jZWxsYXRpb25EZXRhaWxzLmZyb21SZXN1bHRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtTcGVha2VyUmVjb2duaXRpb25SZXN1bHR9IHJlc3VsdCAtIFRoZSByZXN1bHQgdGhhdCB3YXMgY2FuY2VsZWQuXG4gICAgICogQHJldHVybnMge1NwZWFrZXJSZWNvZ25pdGlvbkNhbmNlbGxhdGlvbkRldGFpbHN9IFRoZSBjYW5jZWxsYXRpb24gZGV0YWlscyBvYmplY3QgYmVpbmcgY3JlYXRlZC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbVJlc3VsdChyZXN1bHQpIHtcbiAgICAgICAgY29uc3QgcmVhc29uID0gQ2FuY2VsbGF0aW9uUmVhc29uLkVycm9yO1xuICAgICAgICBsZXQgZXJyb3JDb2RlID0gQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLk5vRXJyb3I7XG4gICAgICAgIGlmICghIXJlc3VsdC5wcm9wZXJ0aWVzKSB7XG4gICAgICAgICAgICBlcnJvckNvZGUgPSBDYW5jZWxsYXRpb25FcnJvckNvZGVbcmVzdWx0LnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoQ2FuY2VsbGF0aW9uRXJyb3JDb2RlUHJvcGVydHlOYW1lLCBDYW5jZWxsYXRpb25FcnJvckNvZGVbQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLk5vRXJyb3JdKV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBTcGVha2VyUmVjb2duaXRpb25DYW5jZWxsYXRpb25EZXRhaWxzKHJlYXNvbiwgcmVzdWx0LmVycm9yRGV0YWlscywgZXJyb3JDb2RlKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWFrZXJSZWNvZ25pdGlvblJlc3VsdC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBSZWNvZ25pemVyQ29uZmlnLCBTcGVha2VyUmVjb2duaXRpb25Db25uZWN0aW9uRmFjdG9yeSwgU3BlYWtlclNlcnZpY2VSZWNvZ25pemVyIH0gZnJvbSBcIi4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eUlkLCBSZWNvZ25pemVyLCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogRGVmaW5lcyBTcGVha2VyUmVjb2duaXplciBjbGFzcyBmb3IgU3BlYWtlciBSZWNvZ25pdGlvblxuICogSGFuZGxlcyBvcGVyYXRpb25zIGZyb20gdXNlciBmb3IgVm9pY2UgUHJvZmlsZSBvcGVyYXRpb25zIChlLmcuIGNyZWF0ZVByb2ZpbGUsIGRlbGV0ZVByb2ZpbGUpXG4gKiBAY2xhc3MgU3BlYWtlclJlY29nbml6ZXJcbiAqL1xuZXhwb3J0IGNsYXNzIFNwZWFrZXJSZWNvZ25pemVyIGV4dGVuZHMgUmVjb2duaXplciB7XG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhlIFNwZWFrZXJSZWNvZ25pemVyLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7U3BlZWNoQ29uZmlnfSBzcGVlY2hDb25maWcgLSBUaGUgc2V0IG9mIGNvbmZpZ3VyYXRpb24gcHJvcGVydGllcy5cbiAgICAgKiBAcGFyYW0ge0F1ZGlvQ29uZmlnfSBhdWRpb0NvbmZpZyAtIEFuIG9wdGlvbmFsIGF1ZGlvIGlucHV0IGNvbmZpZyBhc3NvY2lhdGVkIHdpdGggdGhlIHJlY29nbml6ZXJcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihzcGVlY2hDb25maWcsIGF1ZGlvQ29uZmlnKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHNwZWVjaENvbmZpZywgXCJzcGVlY2hDb25maWdcIik7XG4gICAgICAgIGNvbnN0IGNvbmZpZ0ltcGwgPSBzcGVlY2hDb25maWc7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKGNvbmZpZ0ltcGwsIFwic3BlZWNoQ29uZmlnXCIpO1xuICAgICAgICBzdXBlcihhdWRpb0NvbmZpZywgY29uZmlnSW1wbC5wcm9wZXJ0aWVzLCBuZXcgU3BlYWtlclJlY29nbml0aW9uQ29ubmVjdGlvbkZhY3RvcnkoKSk7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvQ29uZmlnSW1wbCA9IGF1ZGlvQ29uZmlnO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGwodGhpcy5wcml2QXVkaW9Db25maWdJbXBsLCBcImF1ZGlvQ29uZmlnXCIpO1xuICAgICAgICB0aGlzLnByaXZEaXNwb3NlZFNwZWFrZXJSZWNvZ25pemVyID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMgPSBjb25maWdJbXBsLnByb3BlcnRpZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGF1dGhvcml6YXRpb24gdG9rZW4gdXNlZCB0byBjb21tdW5pY2F0ZSB3aXRoIHRoZSBzZXJ2aWNlLlxuICAgICAqIEBtZW1iZXIgU3BlYWtlclJlY29nbml6ZXIucHJvdG90eXBlLmF1dGhvcml6YXRpb25Ub2tlblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBBdXRob3JpemF0aW9uIHRva2VuLlxuICAgICAqL1xuICAgIGdldCBhdXRob3JpemF0aW9uVG9rZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMvU2V0cyB0aGUgYXV0aG9yaXphdGlvbiB0b2tlbiB1c2VkIHRvIGNvbW11bmljYXRlIHdpdGggdGhlIHNlcnZpY2UuXG4gICAgICogQG1lbWJlciBTcGVha2VyUmVjb2duaXplci5wcm90b3R5cGUuYXV0aG9yaXphdGlvblRva2VuXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0b2tlbiAtIEF1dGhvcml6YXRpb24gdG9rZW4uXG4gICAgICovXG4gICAgc2V0IGF1dGhvcml6YXRpb25Ub2tlbih0b2tlbikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodG9rZW4sIFwidG9rZW5cIik7XG4gICAgICAgIHRoaXMucHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuLCB0b2tlbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBjb2xsZWN0aW9uIG9mIHByb3BlcnRpZXMgYW5kIHRoZWlyIHZhbHVlcyBkZWZpbmVkIGZvciB0aGlzIFNwZWFrZXJSZWNvZ25pemVyLlxuICAgICAqIEBtZW1iZXIgU3BlYWtlclJlY29nbml6ZXIucHJvdG90eXBlLnByb3BlcnRpZXNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1Byb3BlcnR5Q29sbGVjdGlvbn0gVGhlIGNvbGxlY3Rpb24gb2YgcHJvcGVydGllcyBhbmQgdGhlaXIgdmFsdWVzIGRlZmluZWQgZm9yIHRoaXMgU3BlYWtlclJlY29nbml6ZXIuXG4gICAgICovXG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgcmVjb2duaXRpb24gcmVzdWx0IGZvciBtb2RlbCB1c2luZyBnaXZlbiBhdWRpb1xuICAgICAqIEBtZW1iZXIgU3BlYWtlclJlY29nbml6ZXIucHJvdG90eXBlLnJlY29nbml6ZU9uY2VBc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcGFyYW0ge1NwZWFrZXJJZGVudGlmaWNhdGlvbk1vZGVsIHwgU3BlYWtlclZlcmlmaWNhdGlvbk1vZGVsfSBtb2RlbCBNb2RlbCBjb250YWluaW5nIFZvaWNlIFByb2ZpbGVzIHRvIGJlIGlkZW50aWZpZWRcbiAgICAgKiBAcGFyYW0gY2IgLSBDYWxsYmFjayBpbnZva2VkIG9uY2UgcmVzdWx0IGlzIHJldHVybmVkLlxuICAgICAqIEBwYXJhbSBlcnIgLSBDYWxsYmFjayBpbnZva2VkIGluIGNhc2Ugb2YgYW4gZXJyb3IuXG4gICAgICovXG4gICAgcmVjb2duaXplT25jZUFzeW5jKG1vZGVsKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkRpc3Bvc2VkU3BlYWtlclJlY29nbml6ZXIpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVjb2duaXplU3BlYWtlck9uY2VBc3luY0ltcGwobW9kZWwpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW5jbHVkZWQgZm9yIGNvbXBhdGliaWxpdHlcbiAgICAgKiBAbWVtYmVyIFNwZWFrZXJSZWNvZ25pemVyLnByb3RvdHlwZS5jbG9zZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAYXN5bmNcbiAgICAgKi9cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWRTcGVha2VyUmVjb2duaXplcik7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLmRpc3Bvc2UodHJ1ZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZWNvZ25pemVTcGVha2VyT25jZUFzeW5jSW1wbChtb2RlbCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZEaXNwb3NlZFNwZWFrZXJSZWNvZ25pemVyKTtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuaW1wbFJlY29nbml6ZXJTdG9wKCk7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSB5aWVsZCB0aGlzLnByaXZSZWNvLnJlY29nbml6ZVNwZWFrZXIobW9kZWwpO1xuICAgICAgICAgICAgeWllbGQgdGhpcy5pbXBsUmVjb2duaXplclN0b3AoKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBpbXBsUmVjb2duaXplclN0b3AoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2UmVjbykge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdlJlY28uc3RvcFJlY29nbml6aW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjcmVhdGVSZWNvZ25pemVyQ29uZmlnKHNwZWVjaENvbmZpZykge1xuICAgICAgICByZXR1cm4gbmV3IFJlY29nbml6ZXJDb25maWcoc3BlZWNoQ29uZmlnLCB0aGlzLnByaXZQcm9wZXJ0aWVzKTtcbiAgICB9XG4gICAgY3JlYXRlU2VydmljZVJlY29nbml6ZXIoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb0NvbmZpZywgcmVjb2duaXplckNvbmZpZykge1xuICAgICAgICBjb25zdCBhdWRpb0ltcGwgPSBhdWRpb0NvbmZpZztcbiAgICAgICAgcmV0dXJuIG5ldyBTcGVha2VyU2VydmljZVJlY29nbml6ZXIoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb0ltcGwsIHJlY29nbml6ZXJDb25maWcsIHRoaXMpO1xuICAgIH1cbiAgICBkaXNwb3NlKGRpc3Bvc2luZykge1xuICAgICAgICBjb25zdCBfc3VwZXIgPSBPYmplY3QuY3JlYXRlKG51bGwsIHtcbiAgICAgICAgICAgIGRpc3Bvc2U6IHsgZ2V0OiAoKSA9PiBzdXBlci5kaXNwb3NlIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2RGlzcG9zZWRTcGVha2VyUmVjb2duaXplcikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkaXNwb3NpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZEaXNwb3NlZFNwZWFrZXJSZWNvZ25pemVyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB5aWVsZCBfc3VwZXIuZGlzcG9zZS5jYWxsKHRoaXMsIGRpc3Bvc2luZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlYWtlclJlY29nbml6ZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuL0NvbnRyYWN0c1wiO1xuaW1wb3J0IHsgVm9pY2VQcm9maWxlVHlwZSwgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIERlZmluZXMgU3BlYWtlclZlcmlmaWNhdGlvbk1vZGVsIGNsYXNzIGZvciBTcGVha2VyIFJlY29nbml0aW9uXG4gKiBNb2RlbCBjb250YWlucyBhIHByb2ZpbGUgYWdhaW5zdCB3aGljaCB0byB2ZXJpZnkgYSBzcGVha2VyXG4gKiBAY2xhc3MgU3BlYWtlclZlcmlmaWNhdGlvbk1vZGVsXG4gKi9cbmV4cG9ydCBjbGFzcyBTcGVha2VyVmVyaWZpY2F0aW9uTW9kZWwge1xuICAgIGNvbnN0cnVjdG9yKHByb2ZpbGUpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQocHJvZmlsZSwgXCJWb2ljZVByb2ZpbGVcIik7XG4gICAgICAgIGlmIChwcm9maWxlLnByb2ZpbGVUeXBlID09PSBWb2ljZVByb2ZpbGVUeXBlLlRleHRJbmRlcGVuZGVudElkZW50aWZpY2F0aW9uKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWZXJpZmljYXRpb24gbW9kZWwgY2Fubm90IGJlIGNyZWF0ZWQgZnJvbSBJZGVudGlmaWNhdGlvbiBwcm9maWxlXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdlZvaWNlUHJvZmlsZSA9IHByb2ZpbGU7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tUHJvZmlsZShwcm9maWxlKSB7XG4gICAgICAgIHJldHVybiBuZXcgU3BlYWtlclZlcmlmaWNhdGlvbk1vZGVsKHByb2ZpbGUpO1xuICAgIH1cbiAgICBnZXQgdm9pY2VQcm9maWxlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Vm9pY2VQcm9maWxlO1xuICAgIH1cbiAgICBnZXQgcHJvZmlsZUlkcygpIHtcbiAgICAgICAgcmV0dXJuIFt0aGlzLnZvaWNlUHJvZmlsZS5wcm9maWxlSWRdO1xuICAgIH1cbiAgICBnZXQgc2NlbmFyaW8oKSB7XG4gICAgICAgIGlmICh0aGlzLnZvaWNlUHJvZmlsZS5wcm9maWxlVHlwZSA9PT0gVm9pY2VQcm9maWxlVHlwZS5UZXh0RGVwZW5kZW50VmVyaWZpY2F0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJUZXh0RGVwZW5kZW50VmVyaWZpY2F0aW9uXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gXCJUZXh0SW5kZXBlbmRlbnRWZXJpZmljYXRpb25cIjtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlYWtlclZlcmlmaWNhdGlvbk1vZGVsLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKiBlc2xpbnQtZGlzYWJsZSBtYXgtY2xhc3Nlcy1wZXItZmlsZSAqL1xuaW1wb3J0IHsgRm9yY2VEaWN0YXRpb25Qcm9wZXJ0eU5hbWUsIE91dHB1dEZvcm1hdFByb3BlcnR5TmFtZSwgU2VydmljZVByb3BlcnRpZXNQcm9wZXJ0eU5hbWUgfSBmcm9tIFwiLi4vY29tbW9uLnNwZWVjaC9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi9Db250cmFjdHNcIjtcbmltcG9ydCB7IE91dHB1dEZvcm1hdCwgUHJvZmFuaXR5T3B0aW9uLCBQcm9wZXJ0eUNvbGxlY3Rpb24sIFByb3BlcnR5SWQsIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdCwgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIFNwZWVjaCBjb25maWd1cmF0aW9uLlxuICogQGNsYXNzIFNwZWVjaENvbmZpZ1xuICovXG5leHBvcnQgY2xhc3MgU3BlZWNoQ29uZmlnIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZS5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGF0aWMgaW5zdGFuY2Ugb2YgU3BlZWNoQ29uZmlnIHJldHVybmVkIGJ5IHBhc3Npbmcgc3Vic2NyaXB0aW9uS2V5IGFuZCBzZXJ2aWNlIHJlZ2lvbi5cbiAgICAgKiBOb3RlOiBQbGVhc2UgdXNlIHlvdXIgTGFuZ3VhZ2VVbmRlcnN0YW5kaW5nIHN1YnNjcmlwdGlvbiBrZXkgaW4gY2FzZSB5b3Ugd2FudCB0byB1c2UgdGhlIEludGVudCByZWNvZ25pemVyLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoQ29uZmlnLmZyb21TdWJzY3JpcHRpb25cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHN1YnNjcmlwdGlvbktleSAtIFRoZSBzdWJzY3JpcHRpb24ga2V5LlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZWdpb24gLSBUaGUgcmVnaW9uIG5hbWUgKHNlZSB0aGUgPGEgaHJlZj1cImh0dHBzOi8vYWthLm1zL2Nzc3BlZWNoL3JlZ2lvblwiPnJlZ2lvbiBwYWdlPC9hPikuXG4gICAgICogQHJldHVybnMge1NwZWVjaENvbmZpZ30gVGhlIHNwZWVjaCBmYWN0b3J5XG4gICAgICovXG4gICAgc3RhdGljIGZyb21TdWJzY3JpcHRpb24oc3Vic2NyaXB0aW9uS2V5LCByZWdpb24pIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHN1YnNjcmlwdGlvbktleSwgXCJzdWJzY3JpcHRpb25LZXlcIik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShyZWdpb24sIFwicmVnaW9uXCIpO1xuICAgICAgICBjb25zdCBzcGVlY2hJbXBsID0gbmV3IFNwZWVjaENvbmZpZ0ltcGwoKTtcbiAgICAgICAgc3BlZWNoSW1wbC5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlZ2lvbiwgcmVnaW9uKTtcbiAgICAgICAgc3BlZWNoSW1wbC5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0ludGVudFJlZ2lvbiwgcmVnaW9uKTtcbiAgICAgICAgc3BlZWNoSW1wbC5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0tleSwgc3Vic2NyaXB0aW9uS2V5KTtcbiAgICAgICAgcmV0dXJuIHNwZWVjaEltcGw7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgdGhlIHNwZWVjaCBjb25maWcgd2l0aCBzcGVjaWZpZWQgZW5kcG9pbnQgYW5kIHN1YnNjcmlwdGlvbiBrZXkuXG4gICAgICogVGhpcyBtZXRob2QgaXMgaW50ZW5kZWQgb25seSBmb3IgdXNlcnMgd2hvIHVzZSBhIG5vbi1zdGFuZGFyZCBzZXJ2aWNlIGVuZHBvaW50IG9yIHBhcmFtZXRlcnMuXG4gICAgICogTm90ZTogUGxlYXNlIHVzZSB5b3VyIExhbmd1YWdlVW5kZXJzdGFuZGluZyBzdWJzY3JpcHRpb24ga2V5IGluIGNhc2UgeW91IHdhbnQgdG8gdXNlIHRoZSBJbnRlbnQgcmVjb2duaXplci5cbiAgICAgKiBOb3RlOiBUaGUgcXVlcnkgcGFyYW1ldGVycyBzcGVjaWZpZWQgaW4gdGhlIGVuZHBvaW50IFVSTCBhcmUgbm90IGNoYW5nZWQsIGV2ZW4gaWYgdGhleSBhcmUgc2V0IGJ5IGFueSBvdGhlciBBUElzLlxuICAgICAqIEZvciBleGFtcGxlLCBpZiBsYW5ndWFnZSBpcyBkZWZpbmVkIGluIHRoZSB1cmkgYXMgcXVlcnkgcGFyYW1ldGVyIFwibGFuZ3VhZ2U9ZGUtREVcIiwgYW5kIGFsc28gc2V0IGJ5XG4gICAgICogU3BlZWNoQ29uZmlnLnNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2UgPSBcImVuLVVTXCIsIHRoZSBsYW5ndWFnZSBzZXR0aW5nIGluIHVyaSB0YWtlcyBwcmVjZWRlbmNlLFxuICAgICAqIGFuZCB0aGUgZWZmZWN0aXZlIGxhbmd1YWdlIGlzIFwiZGUtREVcIi4gT25seSB0aGUgcGFyYW1ldGVycyB0aGF0IGFyZSBub3Qgc3BlY2lmaWVkIGluIHRoZVxuICAgICAqIGVuZHBvaW50IFVSTCBjYW4gYmUgc2V0IGJ5IG90aGVyIEFQSXMuXG4gICAgICogTm90ZTogVG8gdXNlIGF1dGhvcml6YXRpb24gdG9rZW4gd2l0aCBmcm9tRW5kcG9pbnQsIHBhc3MgYW4gZW1wdHkgc3RyaW5nIHRvIHRoZSBzdWJzY3JpcHRpb25LZXkgaW4gdGhlXG4gICAgICogZnJvbUVuZHBvaW50IG1ldGhvZCwgYW5kIHRoZW4gc2V0IGF1dGhvcml6YXRpb25Ub2tlbj1cInRva2VuXCIgb24gdGhlIGNyZWF0ZWQgU3BlZWNoQ29uZmlnIGluc3RhbmNlIHRvXG4gICAgICogdXNlIHRoZSBhdXRob3JpemF0aW9uIHRva2VuLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoQ29uZmlnLmZyb21FbmRwb2ludFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge1VSTH0gZW5kcG9pbnQgLSBUaGUgc2VydmljZSBlbmRwb2ludCB0byBjb25uZWN0IHRvLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzdWJzY3JpcHRpb25LZXkgLSBUaGUgc3Vic2NyaXB0aW9uIGtleS4gSWYgYSBzdWJzY3JpcHRpb24ga2V5IGlzIG5vdCBzcGVjaWZpZWQsIGFuIGF1dGhvcml6YXRpb24gdG9rZW4gbXVzdCBiZSBzZXQuXG4gICAgICogQHJldHVybnMge1NwZWVjaENvbmZpZ30gQSBzcGVlY2ggZmFjdG9yeSBpbnN0YW5jZS5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbUVuZHBvaW50KGVuZHBvaW50LCBzdWJzY3JpcHRpb25LZXkpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsKGVuZHBvaW50LCBcImVuZHBvaW50XCIpO1xuICAgICAgICBjb25zdCBzcGVlY2hJbXBsID0gbmV3IFNwZWVjaENvbmZpZ0ltcGwoKTtcbiAgICAgICAgc3BlZWNoSW1wbC5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50LCBlbmRwb2ludC5ocmVmKTtcbiAgICAgICAgaWYgKHVuZGVmaW5lZCAhPT0gc3Vic2NyaXB0aW9uS2V5KSB7XG4gICAgICAgICAgICBzcGVlY2hJbXBsLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fS2V5LCBzdWJzY3JpcHRpb25LZXkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzcGVlY2hJbXBsO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIHRoZSBzcGVlY2ggY29uZmlnIHdpdGggc3BlY2lmaWVkIGhvc3QgYW5kIHN1YnNjcmlwdGlvbiBrZXkuXG4gICAgICogVGhpcyBtZXRob2QgaXMgaW50ZW5kZWQgb25seSBmb3IgdXNlcnMgd2hvIHVzZSBhIG5vbi1kZWZhdWx0IHNlcnZpY2UgaG9zdC4gU3RhbmRhcmQgcmVzb3VyY2UgcGF0aCB3aWxsIGJlIGFzc3VtZWQuXG4gICAgICogRm9yIHNlcnZpY2VzIHdpdGggYSBub24tc3RhbmRhcmQgcmVzb3VyY2UgcGF0aCBvciBubyBwYXRoIGF0IGFsbCwgdXNlIGZyb21FbmRwb2ludCBpbnN0ZWFkLlxuICAgICAqIE5vdGU6IFF1ZXJ5IHBhcmFtZXRlcnMgYXJlIG5vdCBhbGxvd2VkIGluIHRoZSBob3N0IFVSSSBhbmQgbXVzdCBiZSBzZXQgYnkgb3RoZXIgQVBJcy5cbiAgICAgKiBOb3RlOiBUbyB1c2UgYW4gYXV0aG9yaXphdGlvbiB0b2tlbiB3aXRoIGZyb21Ib3N0LCB1c2UgZnJvbUhvc3QoVVJMKSxcbiAgICAgKiBhbmQgdGhlbiBzZXQgdGhlIEF1dGhvcml6YXRpb25Ub2tlbiBwcm9wZXJ0eSBvbiB0aGUgY3JlYXRlZCBTcGVlY2hDb25maWcgaW5zdGFuY2UuXG4gICAgICogTm90ZTogQWRkZWQgaW4gdmVyc2lvbiAxLjkuMC5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaENvbmZpZy5mcm9tSG9zdFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge1VSTH0gaG9zdCAtIFRoZSBzZXJ2aWNlIGVuZHBvaW50IHRvIGNvbm5lY3QgdG8uIEZvcm1hdCBpcyBcInByb3RvY29sOi8vaG9zdDpwb3J0XCIgd2hlcmUgXCI6cG9ydFwiIGlzIG9wdGlvbmFsLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzdWJzY3JpcHRpb25LZXkgLSBUaGUgc3Vic2NyaXB0aW9uIGtleS4gSWYgYSBzdWJzY3JpcHRpb24ga2V5IGlzIG5vdCBzcGVjaWZpZWQsIGFuIGF1dGhvcml6YXRpb24gdG9rZW4gbXVzdCBiZSBzZXQuXG4gICAgICogQHJldHVybnMge1NwZWVjaENvbmZpZ30gQSBzcGVlY2ggZmFjdG9yeSBpbnN0YW5jZS5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbUhvc3QoaG9zdE5hbWUsIHN1YnNjcmlwdGlvbktleSkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGwoaG9zdE5hbWUsIFwiaG9zdE5hbWVcIik7XG4gICAgICAgIGNvbnN0IHNwZWVjaEltcGwgPSBuZXcgU3BlZWNoQ29uZmlnSW1wbCgpO1xuICAgICAgICBzcGVlY2hJbXBsLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fSG9zdCwgaG9zdE5hbWUucHJvdG9jb2wgKyBcIi8vXCIgKyBob3N0TmFtZS5ob3N0bmFtZSArIChob3N0TmFtZS5wb3J0ID09PSBcIlwiID8gXCJcIiA6IFwiOlwiICsgaG9zdE5hbWUucG9ydCkpO1xuICAgICAgICBpZiAodW5kZWZpbmVkICE9PSBzdWJzY3JpcHRpb25LZXkpIHtcbiAgICAgICAgICAgIHNwZWVjaEltcGwuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9LZXksIHN1YnNjcmlwdGlvbktleSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNwZWVjaEltcGw7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgdGhlIHNwZWVjaCBmYWN0b3J5IHdpdGggc3BlY2lmaWVkIGluaXRpYWwgYXV0aG9yaXphdGlvbiB0b2tlbiBhbmQgcmVnaW9uLlxuICAgICAqIE5vdGU6IFRoZSBjYWxsZXIgbmVlZHMgdG8gZW5zdXJlIHRoYXQgdGhlIGF1dGhvcml6YXRpb24gdG9rZW4gaXMgdmFsaWQuIEJlZm9yZSB0aGUgYXV0aG9yaXphdGlvbiB0b2tlblxuICAgICAqIGV4cGlyZXMsIHRoZSBjYWxsZXIgbmVlZHMgdG8gcmVmcmVzaCBpdCBieSBjYWxsaW5nIHRoaXMgc2V0dGVyIHdpdGggYSBuZXcgdmFsaWQgdG9rZW4uXG4gICAgICogTm90ZTogUGxlYXNlIHVzZSBhIHRva2VuIGRlcml2ZWQgZnJvbSB5b3VyIExhbmd1YWdlVW5kZXJzdGFuZGluZyBzdWJzY3JpcHRpb24ga2V5IGluIGNhc2UgeW91IHdhbnRcbiAgICAgKiB0byB1c2UgdGhlIEludGVudCByZWNvZ25pemVyLiBBcyBjb25maWd1cmF0aW9uIHZhbHVlcyBhcmUgY29waWVkIHdoZW4gY3JlYXRpbmcgYSBuZXcgcmVjb2duaXplcixcbiAgICAgKiB0aGUgbmV3IHRva2VuIHZhbHVlIHdpbGwgbm90IGFwcGx5IHRvIHJlY29nbml6ZXJzIHRoYXQgaGF2ZSBhbHJlYWR5IGJlZW4gY3JlYXRlZC4gRm9yIHJlY29nbml6ZXJzXG4gICAgICogdGhhdCBoYXZlIGJlZW4gY3JlYXRlZCBiZWZvcmUsIHlvdSBuZWVkIHRvIHNldCBhdXRob3JpemF0aW9uIHRva2VuIG9mIHRoZSBjb3JyZXNwb25kaW5nIHJlY29nbml6ZXJcbiAgICAgKiB0byByZWZyZXNoIHRoZSB0b2tlbi4gT3RoZXJ3aXNlLCB0aGUgcmVjb2duaXplcnMgd2lsbCBlbmNvdW50ZXIgZXJyb3JzIGR1cmluZyByZWNvZ25pdGlvbi5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaENvbmZpZy5mcm9tQXV0aG9yaXphdGlvblRva2VuXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhdXRob3JpemF0aW9uVG9rZW4gLSBUaGUgaW5pdGlhbCBhdXRob3JpemF0aW9uIHRva2VuLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZWdpb24gLSBUaGUgcmVnaW9uIG5hbWUgKHNlZSB0aGUgPGEgaHJlZj1cImh0dHBzOi8vYWthLm1zL2Nzc3BlZWNoL3JlZ2lvblwiPnJlZ2lvbiBwYWdlPC9hPikuXG4gICAgICogQHJldHVybnMge1NwZWVjaENvbmZpZ30gQSBzcGVlY2ggZmFjdG9yeSBpbnN0YW5jZS5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbUF1dGhvcml6YXRpb25Ub2tlbihhdXRob3JpemF0aW9uVG9rZW4sIHJlZ2lvbikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGwoYXV0aG9yaXphdGlvblRva2VuLCBcImF1dGhvcml6YXRpb25Ub2tlblwiKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHJlZ2lvbiwgXCJyZWdpb25cIik7XG4gICAgICAgIGNvbnN0IHNwZWVjaEltcGwgPSBuZXcgU3BlZWNoQ29uZmlnSW1wbCgpO1xuICAgICAgICBzcGVlY2hJbXBsLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVnaW9uLCByZWdpb24pO1xuICAgICAgICBzcGVlY2hJbXBsLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fSW50ZW50UmVnaW9uLCByZWdpb24pO1xuICAgICAgICBzcGVlY2hJbXBsLmF1dGhvcml6YXRpb25Ub2tlbiA9IGF1dGhvcml6YXRpb25Ub2tlbjtcbiAgICAgICAgcmV0dXJuIHNwZWVjaEltcGw7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsb3NlcyB0aGUgY29uZmlndXJhdGlvbi5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaENvbmZpZy5wcm90b3R5cGUuY2xvc2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvblxuICAgIGNsb3NlKCkgeyB9XG59XG4vKipcbiAqIEBwdWJsaWNcbiAqIEBjbGFzcyBTcGVlY2hDb25maWdJbXBsXG4gKi9cbmV4cG9ydCBjbGFzcyBTcGVlY2hDb25maWdJbXBsIGV4dGVuZHMgU3BlZWNoQ29uZmlnIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcyA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICAgICAgdGhpcy5zcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlID0gXCJlbi1VU1wiOyAvLyBTaG91bGQgd2UgaGF2ZSBhIGRlZmF1bHQ/XG4gICAgICAgIHRoaXMub3V0cHV0Rm9ybWF0ID0gT3V0cHV0Rm9ybWF0LlNpbXBsZTtcbiAgICB9XG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzO1xuICAgIH1cbiAgICBnZXQgZW5kUG9pbnQoKSB7XG4gICAgICAgIHJldHVybiBuZXcgVVJMKHRoaXMucHJpdlByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludCkpO1xuICAgIH1cbiAgICBnZXQgc3Vic2NyaXB0aW9uS2V5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0tleSk7XG4gICAgfVxuICAgIGdldCByZWdpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVnaW9uKTtcbiAgICB9XG4gICAgZ2V0IGF1dGhvcml6YXRpb25Ub2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbik7XG4gICAgfVxuICAgIHNldCBhdXRob3JpemF0aW9uVG9rZW4odmFsdWUpIHtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuLCB2YWx1ZSk7XG4gICAgfVxuICAgIGdldCBzcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZSk7XG4gICAgfVxuICAgIHNldCBzcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTGFuZ3VhZ2UsIHZhbHVlKTtcbiAgICB9XG4gICAgZ2V0IGF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlcyk7XG4gICAgfVxuICAgIHNldCBhdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VzKHZhbHVlKSB7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9BdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VzLCB2YWx1ZSk7XG4gICAgfVxuICAgIGdldCBvdXRwdXRGb3JtYXQoKSB7XG4gICAgICAgIHJldHVybiBPdXRwdXRGb3JtYXRbdGhpcy5wcml2UHJvcGVydGllcy5nZXRQcm9wZXJ0eShPdXRwdXRGb3JtYXRQcm9wZXJ0eU5hbWUsIHVuZGVmaW5lZCldO1xuICAgIH1cbiAgICBzZXQgb3V0cHV0Rm9ybWF0KHZhbHVlKSB7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoT3V0cHV0Rm9ybWF0UHJvcGVydHlOYW1lLCBPdXRwdXRGb3JtYXRbdmFsdWVdKTtcbiAgICB9XG4gICAgZ2V0IGVuZHBvaW50SWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnRJZCk7XG4gICAgfVxuICAgIHNldCBlbmRwb2ludElkKHZhbHVlKSB7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludElkLCB2YWx1ZSk7XG4gICAgfVxuICAgIHNldFByb3BlcnR5KG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbCh2YWx1ZSwgXCJ2YWx1ZVwiKTtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShuYW1lLCB2YWx1ZSk7XG4gICAgfVxuICAgIGdldFByb3BlcnR5KG5hbWUsIGRlZikge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcy5nZXRQcm9wZXJ0eShuYW1lLCBkZWYpO1xuICAgIH1cbiAgICBzZXRQcm94eShwcm94eUhvc3ROYW1lLCBwcm94eVBvcnQsIHByb3h5VXNlck5hbWUsIHByb3h5UGFzc3dvcmQpIHtcbiAgICAgICAgdGhpcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUHJveHlIb3N0TmFtZV0sIHByb3h5SG9zdE5hbWUpO1xuICAgICAgICB0aGlzLnNldFByb3BlcnR5KFByb3BlcnR5SWRbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Qcm94eVBvcnRdLCBwcm94eVBvcnQpO1xuICAgICAgICB0aGlzLnNldFByb3BlcnR5KFByb3BlcnR5SWRbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Qcm94eVVzZXJOYW1lXSwgcHJveHlVc2VyTmFtZSk7XG4gICAgICAgIHRoaXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5UGFzc3dvcmRdLCBwcm94eVBhc3N3b3JkKTtcbiAgICB9XG4gICAgc2V0U2VydmljZVByb3BlcnR5KG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRQcm9wZXJ0aWVzID0gSlNPTi5wYXJzZSh0aGlzLnByaXZQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFNlcnZpY2VQcm9wZXJ0aWVzUHJvcGVydHlOYW1lLCBcInt9XCIpKTtcbiAgICAgICAgY3VycmVudFByb3BlcnRpZXNbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShTZXJ2aWNlUHJvcGVydGllc1Byb3BlcnR5TmFtZSwgSlNPTi5zdHJpbmdpZnkoY3VycmVudFByb3BlcnRpZXMpKTtcbiAgICB9XG4gICAgc2V0UHJvZmFuaXR5KHByb2Zhbml0eSkge1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZVJlc3BvbnNlX1Byb2Zhbml0eU9wdGlvbiwgUHJvZmFuaXR5T3B0aW9uW3Byb2Zhbml0eV0pO1xuICAgIH1cbiAgICBlbmFibGVBdWRpb0xvZ2dpbmcoKSB7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmFibGVBdWRpb0xvZ2dpbmcsIFwidHJ1ZVwiKTtcbiAgICB9XG4gICAgcmVxdWVzdFdvcmRMZXZlbFRpbWVzdGFtcHMoKSB7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUmVxdWVzdFdvcmRMZXZlbFRpbWVzdGFtcHMsIFwidHJ1ZVwiKTtcbiAgICB9XG4gICAgZW5hYmxlRGljdGF0aW9uKCkge1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KEZvcmNlRGljdGF0aW9uUHJvcGVydHlOYW1lLCBcInRydWVcIik7XG4gICAgfVxuICAgIGNsb25lKCkge1xuICAgICAgICBjb25zdCByZXQgPSBuZXcgU3BlZWNoQ29uZmlnSW1wbCgpO1xuICAgICAgICByZXQucHJpdlByb3BlcnRpZXMgPSB0aGlzLnByaXZQcm9wZXJ0aWVzLmNsb25lKCk7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfVxuICAgIGdldCBzcGVlY2hTeW50aGVzaXNMYW5ndWFnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9TeW50aExhbmd1YWdlKTtcbiAgICB9XG4gICAgc2V0IHNwZWVjaFN5bnRoZXNpc0xhbmd1YWdlKGxhbmd1YWdlKSB7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9TeW50aExhbmd1YWdlLCBsYW5ndWFnZSk7XG4gICAgfVxuICAgIGdldCBzcGVlY2hTeW50aGVzaXNWb2ljZU5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhWb2ljZSk7XG4gICAgfVxuICAgIHNldCBzcGVlY2hTeW50aGVzaXNWb2ljZU5hbWUodm9pY2UpIHtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1N5bnRoVm9pY2UsIHZvaWNlKTtcbiAgICB9XG4gICAgZ2V0IHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdCgpIHtcbiAgICAgICAgcmV0dXJuIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFt0aGlzLnByaXZQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhPdXRwdXRGb3JtYXQsIHVuZGVmaW5lZCldO1xuICAgIH1cbiAgICBzZXQgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0KGZvcm1hdCkge1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhPdXRwdXRGb3JtYXQsIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtmb3JtYXRdKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWVjaENvbmZpZy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgQ2FuY2VsbGF0aW9uRXZlbnRBcmdzQmFzZSwgfSBmcm9tIFwiLi9DYW5jZWxsYXRpb25FdmVudEFyZ3NCYXNlXCI7XG5leHBvcnQgY2xhc3MgU3BlZWNoUmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJncyBleHRlbmRzIENhbmNlbGxhdGlvbkV2ZW50QXJnc0Jhc2Uge1xufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TcGVlY2hSZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKiBlc2xpbnQtZGlzYWJsZSBtYXgtY2xhc3Nlcy1wZXItZmlsZSAqL1xuaW1wb3J0IHsgUmVjb2duaXRpb25FdmVudEFyZ3MgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIERlZmluZXMgY29udGVudHMgb2Ygc3BlZWNoIHJlY29nbml6aW5nL3JlY29nbml6ZWQgZXZlbnQuXG4gKiBAY2xhc3MgU3BlZWNoUmVjb2duaXRpb25FdmVudEFyZ3NcbiAqL1xuZXhwb3J0IGNsYXNzIFNwZWVjaFJlY29nbml0aW9uRXZlbnRBcmdzIGV4dGVuZHMgUmVjb2duaXRpb25FdmVudEFyZ3Mge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtTcGVlY2hSZWNvZ25pdGlvblJlc3VsdH0gcmVzdWx0IC0gVGhlIHNwZWVjaCByZWNvZ25pdGlvbiByZXN1bHQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG9mZnNldCAtIFRoZSBvZmZzZXQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHNlc3Npb25JZCAtIFRoZSBzZXNzaW9uIGlkLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlc3VsdCwgb2Zmc2V0LCBzZXNzaW9uSWQpIHtcbiAgICAgICAgc3VwZXIob2Zmc2V0LCBzZXNzaW9uSWQpO1xuICAgICAgICB0aGlzLnByaXZSZXN1bHQgPSByZXN1bHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyB0aGUgcmVjb2duaXRpb24gcmVzdWx0LlxuICAgICAqIEBtZW1iZXIgU3BlZWNoUmVjb2duaXRpb25FdmVudEFyZ3MucHJvdG90eXBlLnJlc3VsdFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7U3BlZWNoUmVjb2duaXRpb25SZXN1bHR9IHRoZSByZWNvZ25pdGlvbiByZXN1bHQuXG4gICAgICovXG4gICAgZ2V0IHJlc3VsdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlc3VsdDtcbiAgICB9XG59XG4vKipcbiAqIERlZmluZXMgY29udGVudHMgb2YgY29udmVyc2F0aW9uIHRyYW5zY3JpYmVkL3RyYW5zY3JpYmluZyBldmVudC5cbiAqIEBjbGFzcyBDb252ZXJzYXRpb25UcmFuc2NyaXB0aW9uRXZlbnRBcmdzXG4gKi9cbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25UcmFuc2NyaXB0aW9uRXZlbnRBcmdzIGV4dGVuZHMgU3BlZWNoUmVjb2duaXRpb25FdmVudEFyZ3Mge1xufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TcGVlY2hSZWNvZ25pdGlvbkV2ZW50QXJncy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgUmVjb2duaXRpb25SZXN1bHQgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIERlZmluZXMgcmVzdWx0IG9mIHNwZWVjaCByZWNvZ25pdGlvbi5cbiAqIEBjbGFzcyBTcGVlY2hSZWNvZ25pdGlvblJlc3VsdFxuICovXG5leHBvcnQgY2xhc3MgU3BlZWNoUmVjb2duaXRpb25SZXN1bHQgZXh0ZW5kcyBSZWNvZ25pdGlvblJlc3VsdCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHJlc3VsdElkIC0gVGhlIHJlc3VsdCBpZC5cbiAgICAgKiBAcGFyYW0ge1Jlc3VsdFJlYXNvbn0gcmVhc29uIC0gVGhlIHJlYXNvbi5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dCAtIFRoZSByZWNvZ25pemVkIHRleHQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGR1cmF0aW9uIC0gVGhlIGR1cmF0aW9uLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBvZmZzZXQgLSBUaGUgb2Zmc2V0IGludG8gdGhlIHN0cmVhbS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbGFuZ3VhZ2UgLSBQcmltYXJ5IExhbmd1YWdlIGRldGVjdGVkLCBpZiBwcm92aWRlZC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlIC0gUHJpbWFyeSBMYW5ndWFnZSBjb25maWRlbmNlIChcIlVua25vd24sXCIgXCJMb3csXCIgXCJNZWRpdW0sXCIgXCJIaWdoXCIuLi4pLCBpZiBwcm92aWRlZC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc3BlYWtlcklkIC0gc3BlYWtlciBpZCBmb3IgY29udmVyc2F0aW9uIHRyYW5zY3JpcHRpb24sIGlmIHByb3ZpZGVkLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBlcnJvckRldGFpbHMgLSBFcnJvciBkZXRhaWxzLCBpZiBwcm92aWRlZC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ganNvbiAtIEFkZGl0aW9uYWwgSnNvbiwgaWYgcHJvdmlkZWQuXG4gICAgICogQHBhcmFtIHtQcm9wZXJ0eUNvbGxlY3Rpb259IHByb3BlcnRpZXMgLSBBZGRpdGlvbmFsIHByb3BlcnRpZXMsIGlmIHByb3ZpZGVkLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlc3VsdElkLCByZWFzb24sIHRleHQsIGR1cmF0aW9uLCBvZmZzZXQsIGxhbmd1YWdlLCBsYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UsIHNwZWFrZXJJZCwgZXJyb3JEZXRhaWxzLCBqc29uLCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgIHN1cGVyKHJlc3VsdElkLCByZWFzb24sIHRleHQsIGR1cmF0aW9uLCBvZmZzZXQsIGxhbmd1YWdlLCBsYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UsIGVycm9yRGV0YWlscywganNvbiwgcHJvcGVydGllcyk7XG4gICAgICAgIHRoaXMucHJpdlNwZWFrZXJJZCA9IHNwZWFrZXJJZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogc3BlYWtlciBpZCBmcm9tIGNvbnZlcnNhdGlvbiB0cmFuc2NyaXB0aW9uL2lkIHNjZW5hcmlvc1xuICAgICAqIEBtZW1iZXIgU3BlZWNoUmVjb2duaXRpb25SZXN1bHQucHJvdG90eXBlLnNwZWFrZXJJZFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBpZCBvZiBzcGVha2VyIGluIGdpdmVuIHJlc3VsdFxuICAgICAqL1xuICAgIGdldCBzcGVha2VySWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVha2VySWQ7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TcGVlY2hSZWNvZ25pdGlvblJlc3VsdC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBPdXRwdXRGb3JtYXRQcm9wZXJ0eU5hbWUsIFJlY29nbml0aW9uTW9kZSwgUmVjb2duaXplckNvbmZpZywgU3BlZWNoQ29ubmVjdGlvbkZhY3RvcnksIFNwZWVjaFNlcnZpY2VSZWNvZ25pemVyLCB9IGZyb20gXCIuLi9jb21tb24uc3BlZWNoL0V4cG9ydHNcIjtcbmltcG9ydCB7IG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3MgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuL0NvbnRyYWN0c1wiO1xuaW1wb3J0IHsgT3V0cHV0Rm9ybWF0LCBQcm9wZXJ0eUlkLCBSZWNvZ25pemVyLCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogUGVyZm9ybXMgc3BlZWNoIHJlY29nbml0aW9uIGZyb20gbWljcm9waG9uZSwgZmlsZSwgb3Igb3RoZXIgYXVkaW8gaW5wdXQgc3RyZWFtcywgYW5kIGdldHMgdHJhbnNjcmliZWQgdGV4dCBhcyByZXN1bHQuXG4gKiBAY2xhc3MgU3BlZWNoUmVjb2duaXplclxuICovXG5leHBvcnQgY2xhc3MgU3BlZWNoUmVjb2duaXplciBleHRlbmRzIFJlY29nbml6ZXIge1xuICAgIC8qKlxuICAgICAqIFNwZWVjaFJlY29nbml6ZXIgY29uc3RydWN0b3IuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtTcGVlY2hDb25maWd9IHNwZWVjaENvbmZpZyAtIGFuIHNldCBvZiBpbml0aWFsIHByb3BlcnRpZXMgZm9yIHRoaXMgcmVjb2duaXplclxuICAgICAqIEBwYXJhbSB7QXVkaW9Db25maWd9IGF1ZGlvQ29uZmlnIC0gQW4gb3B0aW9uYWwgYXVkaW8gY29uZmlndXJhdGlvbiBhc3NvY2lhdGVkIHdpdGggdGhlIHJlY29nbml6ZXJcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihzcGVlY2hDb25maWcsIGF1ZGlvQ29uZmlnKSB7XG4gICAgICAgIGNvbnN0IHNwZWVjaENvbmZpZ0ltcGwgPSBzcGVlY2hDb25maWc7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbChzcGVlY2hDb25maWdJbXBsLCBcInNwZWVjaENvbmZpZ1wiKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHNwZWVjaENvbmZpZ0ltcGwucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZSksIFByb3BlcnR5SWRbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTGFuZ3VhZ2VdKTtcbiAgICAgICAgc3VwZXIoYXVkaW9Db25maWcsIHNwZWVjaENvbmZpZ0ltcGwucHJvcGVydGllcywgbmV3IFNwZWVjaENvbm5lY3Rpb25GYWN0b3J5KCkpO1xuICAgICAgICB0aGlzLnByaXZEaXNwb3NlZFJlY29nbml6ZXIgPSBmYWxzZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3BlZWNoUmVjb2duaXplciBjb25zdHJ1Y3Rvci5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge1NwZWVjaENvbmZpZ30gc3BlZWNoQ29uZmlnIC0gYW4gc2V0IG9mIGluaXRpYWwgcHJvcGVydGllcyBmb3IgdGhpcyByZWNvZ25pemVyXG4gICAgICogQHBhcmFtIHtBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWd9IGF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZyAtIEFuIHNvdXJjZSBsYW5ndWFnZSBkZXRlY3Rpb24gY29uZmlndXJhdGlvbiBhc3NvY2lhdGVkIHdpdGggdGhlIHJlY29nbml6ZXJcbiAgICAgKiBAcGFyYW0ge0F1ZGlvQ29uZmlnfSBhdWRpb0NvbmZpZyAtIEFuIG9wdGlvbmFsIGF1ZGlvIGNvbmZpZ3VyYXRpb24gYXNzb2NpYXRlZCB3aXRoIHRoZSByZWNvZ25pemVyXG4gICAgICovXG4gICAgc3RhdGljIEZyb21Db25maWcoc3BlZWNoQ29uZmlnLCBhdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWcsIGF1ZGlvQ29uZmlnKSB7XG4gICAgICAgIGNvbnN0IHNwZWVjaENvbmZpZ0ltcGwgPSBzcGVlY2hDb25maWc7XG4gICAgICAgIGF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZy5wcm9wZXJ0aWVzLm1lcmdlVG8oc3BlZWNoQ29uZmlnSW1wbC5wcm9wZXJ0aWVzKTtcbiAgICAgICAgY29uc3QgcmVjb2duaXplciA9IG5ldyBTcGVlY2hSZWNvZ25pemVyKHNwZWVjaENvbmZpZywgYXVkaW9Db25maWcpO1xuICAgICAgICByZXR1cm4gcmVjb2duaXplcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgZW5kcG9pbnQgaWQgb2YgYSBjdXN0b21pemVkIHNwZWVjaCBtb2RlbCB0aGF0IGlzIHVzZWQgZm9yIHNwZWVjaCByZWNvZ25pdGlvbi5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFJlY29nbml6ZXIucHJvdG90eXBlLmVuZHBvaW50SWRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ30gdGhlIGVuZHBvaW50IGlkIG9mIGEgY3VzdG9taXplZCBzcGVlY2ggbW9kZWwgdGhhdCBpcyB1c2VkIGZvciBzcGVlY2ggcmVjb2duaXRpb24uXG4gICAgICovXG4gICAgZ2V0IGVuZHBvaW50SWQoKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWRSZWNvZ25pemVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50SWQsIFwiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwXCIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBhdXRob3JpemF0aW9uIHRva2VuIHVzZWQgdG8gY29tbXVuaWNhdGUgd2l0aCB0aGUgc2VydmljZS5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFJlY29nbml6ZXIucHJvdG90eXBlLmF1dGhvcml6YXRpb25Ub2tlblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBBdXRob3JpemF0aW9uIHRva2VuLlxuICAgICAqL1xuICAgIGdldCBhdXRob3JpemF0aW9uVG9rZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMvU2V0cyB0aGUgYXV0aG9yaXphdGlvbiB0b2tlbiB1c2VkIHRvIGNvbW11bmljYXRlIHdpdGggdGhlIHNlcnZpY2UuXG4gICAgICogQG1lbWJlciBTcGVlY2hSZWNvZ25pemVyLnByb3RvdHlwZS5hdXRob3JpemF0aW9uVG9rZW5cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRva2VuIC0gQXV0aG9yaXphdGlvbiB0b2tlbi5cbiAgICAgKi9cbiAgICBzZXQgYXV0aG9yaXphdGlvblRva2VuKHRva2VuKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh0b2tlbiwgXCJ0b2tlblwiKTtcbiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW4sIHRva2VuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgc3Bva2VuIGxhbmd1YWdlIG9mIHJlY29nbml0aW9uLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoUmVjb2duaXplci5wcm90b3R5cGUuc3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgc3Bva2VuIGxhbmd1YWdlIG9mIHJlY29nbml0aW9uLlxuICAgICAqL1xuICAgIGdldCBzcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlKCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkRpc3Bvc2VkUmVjb2duaXplcik7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTGFuZ3VhZ2UpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBvdXRwdXQgZm9ybWF0IG9mIHJlY29nbml0aW9uLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoUmVjb2duaXplci5wcm90b3R5cGUub3V0cHV0Rm9ybWF0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtPdXRwdXRGb3JtYXR9IFRoZSBvdXRwdXQgZm9ybWF0IG9mIHJlY29nbml0aW9uLlxuICAgICAqL1xuICAgIGdldCBvdXRwdXRGb3JtYXQoKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWRSZWNvZ25pemVyKTtcbiAgICAgICAgaWYgKHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShPdXRwdXRGb3JtYXRQcm9wZXJ0eU5hbWUsIE91dHB1dEZvcm1hdFtPdXRwdXRGb3JtYXQuU2ltcGxlXSkgPT09IE91dHB1dEZvcm1hdFtPdXRwdXRGb3JtYXQuU2ltcGxlXSkge1xuICAgICAgICAgICAgcmV0dXJuIE91dHB1dEZvcm1hdC5TaW1wbGU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gT3V0cHV0Rm9ybWF0LkRldGFpbGVkO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBjb2xsZWN0aW9uIG9mIHByb3BlcnRpZXMgYW5kIHRoZWlyIHZhbHVlcyBkZWZpbmVkIGZvciB0aGlzIFNwZWVjaFJlY29nbml6ZXIuXG4gICAgICogQG1lbWJlciBTcGVlY2hSZWNvZ25pemVyLnByb3RvdHlwZS5wcm9wZXJ0aWVzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtQcm9wZXJ0eUNvbGxlY3Rpb259IFRoZSBjb2xsZWN0aW9uIG9mIHByb3BlcnRpZXMgYW5kIHRoZWlyIHZhbHVlcyBkZWZpbmVkIGZvciB0aGlzIFNwZWVjaFJlY29nbml6ZXIuXG4gICAgICovXG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgc3BlZWNoIHJlY29nbml0aW9uLCBhbmQgc3RvcHMgYWZ0ZXIgdGhlIGZpcnN0IHV0dGVyYW5jZSBpcyByZWNvZ25pemVkLlxuICAgICAqIFRoZSB0YXNrIHJldHVybnMgdGhlIHJlY29nbml0aW9uIHRleHQgYXMgcmVzdWx0LlxuICAgICAqIE5vdGU6IFJlY29nbml6ZU9uY2VBc3luYygpIHJldHVybnMgd2hlbiB0aGUgZmlyc3QgdXR0ZXJhbmNlIGhhcyBiZWVuIHJlY29nbml6ZWQsXG4gICAgICogc28gaXQgaXMgc3VpdGFibGUgb25seSBmb3Igc2luZ2xlIHNob3QgcmVjb2duaXRpb25cbiAgICAgKiBsaWtlIGNvbW1hbmQgb3IgcXVlcnkuIEZvciBsb25nLXJ1bm5pbmcgcmVjb2duaXRpb24sIHVzZSBTdGFydENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jKCkgaW5zdGVhZC5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFJlY29nbml6ZXIucHJvdG90eXBlLnJlY29nbml6ZU9uY2VBc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0gY2IgLSBDYWxsYmFjayB0aGF0IHJlY2VpdmVkIHRoZSBTcGVlY2hSZWNvZ25pdGlvblJlc3VsdC5cbiAgICAgKiBAcGFyYW0gZXJyIC0gQ2FsbGJhY2sgaW52b2tlZCBpbiBjYXNlIG9mIGFuIGVycm9yLlxuICAgICAqL1xuICAgIHJlY29nbml6ZU9uY2VBc3luYyhjYiwgZXJyKSB7XG4gICAgICAgIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3ModGhpcy5yZWNvZ25pemVPbmNlQXN5bmNJbXBsKFJlY29nbml0aW9uTW9kZS5JbnRlcmFjdGl2ZSksIGNiLCBlcnIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgc3BlZWNoIHJlY29nbml0aW9uLCB1bnRpbCBzdG9wQ29udGludW91c1JlY29nbml0aW9uQXN5bmMoKSBpcyBjYWxsZWQuXG4gICAgICogVXNlciBtdXN0IHN1YnNjcmliZSB0byBldmVudHMgdG8gcmVjZWl2ZSByZWNvZ25pdGlvbiByZXN1bHRzLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoUmVjb2duaXplci5wcm90b3R5cGUuc3RhcnRDb250aW51b3VzUmVjb2duaXRpb25Bc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0gY2IgLSBDYWxsYmFjayBpbnZva2VkIG9uY2UgdGhlIHJlY29nbml0aW9uIGhhcyBzdGFydGVkLlxuICAgICAqIEBwYXJhbSBlcnIgLSBDYWxsYmFjayBpbnZva2VkIGluIGNhc2Ugb2YgYW4gZXJyb3IuXG4gICAgICovXG4gICAgc3RhcnRDb250aW51b3VzUmVjb2duaXRpb25Bc3luYyhjYiwgZXJyKSB7XG4gICAgICAgIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3ModGhpcy5zdGFydENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jSW1wbChSZWNvZ25pdGlvbk1vZGUuQ29udmVyc2F0aW9uKSwgY2IsIGVycik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0b3BzIGNvbnRpbnVvdXMgc3BlZWNoIHJlY29nbml0aW9uLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoUmVjb2duaXplci5wcm90b3R5cGUuc3RvcENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSBjYiAtIENhbGxiYWNrIGludm9rZWQgb25jZSB0aGUgcmVjb2duaXRpb24gaGFzIHN0b3BwZWQuXG4gICAgICogQHBhcmFtIGVyciAtIENhbGxiYWNrIGludm9rZWQgaW4gY2FzZSBvZiBhbiBlcnJvci5cbiAgICAgKi9cbiAgICBzdG9wQ29udGludW91c1JlY29nbml0aW9uQXN5bmMoY2IsIGVycikge1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMuc3RvcENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jSW1wbCgpLCBjYiwgZXJyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RhcnRzIHNwZWVjaCByZWNvZ25pdGlvbiB3aXRoIGtleXdvcmQgc3BvdHRpbmcsIHVudGlsXG4gICAgICogc3RvcEtleXdvcmRSZWNvZ25pdGlvbkFzeW5jKCkgaXMgY2FsbGVkLlxuICAgICAqIFVzZXIgbXVzdCBzdWJzY3JpYmUgdG8gZXZlbnRzIHRvIHJlY2VpdmUgcmVjb2duaXRpb24gcmVzdWx0cy5cbiAgICAgKiBOb3RlOiBLZXkgd29yZCBzcG90dGluZyBmdW5jdGlvbmFsaXR5IGlzIG9ubHkgYXZhaWxhYmxlIG9uIHRoZVxuICAgICAqIFNwZWVjaCBEZXZpY2VzIFNESy4gVGhpcyBmdW5jdGlvbmFsaXR5IGlzIGN1cnJlbnRseSBub3QgaW5jbHVkZWQgaW4gdGhlIFNESyBpdHNlbGYuXG4gICAgICogQG1lbWJlciBTcGVlY2hSZWNvZ25pemVyLnByb3RvdHlwZS5zdGFydEtleXdvcmRSZWNvZ25pdGlvbkFzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7S2V5d29yZFJlY29nbml0aW9uTW9kZWx9IG1vZGVsIFRoZSBrZXl3b3JkIHJlY29nbml0aW9uIG1vZGVsIHRoYXRcbiAgICAgKiBzcGVjaWZpZXMgdGhlIGtleXdvcmQgdG8gYmUgcmVjb2duaXplZC5cbiAgICAgKiBAcGFyYW0gY2IgLSBDYWxsYmFjayBpbnZva2VkIG9uY2UgdGhlIHJlY29nbml0aW9uIGhhcyBzdGFydGVkLlxuICAgICAqIEBwYXJhbSBlcnIgLSBDYWxsYmFjayBpbnZva2VkIGluIGNhc2Ugb2YgYW4gZXJyb3IuXG4gICAgICovXG4gICAgc3RhcnRLZXl3b3JkUmVjb2duaXRpb25Bc3luYyhtb2RlbCwgY2IsIGVycikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGwobW9kZWwsIFwibW9kZWxcIik7XG4gICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgZXJyKFwiTm90IHlldCBpbXBsZW1lbnRlZC5cIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RvcHMgY29udGludW91cyBzcGVlY2ggcmVjb2duaXRpb24uXG4gICAgICogTm90ZTogS2V5IHdvcmQgc3BvdHRpbmcgZnVuY3Rpb25hbGl0eSBpcyBvbmx5IGF2YWlsYWJsZSBvbiB0aGVcbiAgICAgKiBTcGVlY2ggRGV2aWNlcyBTREsuIFRoaXMgZnVuY3Rpb25hbGl0eSBpcyBjdXJyZW50bHkgbm90IGluY2x1ZGVkIGluIHRoZSBTREsgaXRzZWxmLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoUmVjb2duaXplci5wcm90b3R5cGUuc3RvcEtleXdvcmRSZWNvZ25pdGlvbkFzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSBjYiAtIENhbGxiYWNrIGludm9rZWQgb25jZSB0aGUgcmVjb2duaXRpb24gaGFzIHN0b3BwZWQuXG4gICAgICogQHBhcmFtIGVyciAtIENhbGxiYWNrIGludm9rZWQgaW4gY2FzZSBvZiBhbiBlcnJvci5cbiAgICAgKi9cbiAgICBzdG9wS2V5d29yZFJlY29nbml0aW9uQXN5bmMoY2IpIHtcbiAgICAgICAgaWYgKCEhY2IpIHtcbiAgICAgICAgICAgIGNiKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogY2xvc2VzIGFsbCBleHRlcm5hbCByZXNvdXJjZXMgaGVsZCBieSBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoUmVjb2duaXplci5wcm90b3R5cGUuY2xvc2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY2xvc2UoY2IsIGVycm9yQ2IpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZEaXNwb3NlZFJlY29nbml6ZXIpO1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMuZGlzcG9zZSh0cnVlKSwgY2IsIGVycm9yQ2IpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEaXNwb3NlcyBhbnkgcmVzb3VyY2VzIGhlbGQgYnkgdGhlIG9iamVjdC5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFJlY29nbml6ZXIucHJvdG90eXBlLmRpc3Bvc2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtib29sZWFufSBkaXNwb3NpbmcgLSB0cnVlIGlmIGRpc3Bvc2luZyB0aGUgb2JqZWN0LlxuICAgICAqL1xuICAgIGRpc3Bvc2UoZGlzcG9zaW5nKSB7XG4gICAgICAgIGNvbnN0IF9zdXBlciA9IE9iamVjdC5jcmVhdGUobnVsbCwge1xuICAgICAgICAgICAgZGlzcG9zZTogeyBnZXQ6ICgpID0+IHN1cGVyLmRpc3Bvc2UgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZEaXNwb3NlZFJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGlzcG9zaW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2RGlzcG9zZWRSZWNvZ25pemVyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmltcGxSZWNvZ25pemVyU3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeWllbGQgX3N1cGVyLmRpc3Bvc2UuY2FsbCh0aGlzLCBkaXNwb3NpbmcpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgY3JlYXRlUmVjb2duaXplckNvbmZpZyhzcGVlY2hDb25maWcpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZWNvZ25pemVyQ29uZmlnKHNwZWVjaENvbmZpZywgdGhpcy5wcml2UHJvcGVydGllcyk7XG4gICAgfVxuICAgIGNyZWF0ZVNlcnZpY2VSZWNvZ25pemVyKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Db25maWcsIHJlY29nbml6ZXJDb25maWcpIHtcbiAgICAgICAgY29uc3QgY29uZmlnSW1wbCA9IGF1ZGlvQ29uZmlnO1xuICAgICAgICByZXR1cm4gbmV3IFNwZWVjaFNlcnZpY2VSZWNvZ25pemVyKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgY29uZmlnSW1wbCwgcmVjb2duaXplckNvbmZpZywgdGhpcyk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TcGVlY2hSZWNvZ25pemVyLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIERlZmluZXMgY29udGVudHMgb2Ygc3BlZWNoIHN5bnRoZXNpcyBib29rbWFyayBldmVudC5cbiAqIEBjbGFzcyBTcGVlY2hTeW50aGVzaXNCb29rbWFya0V2ZW50QXJnc1xuICogQWRkZWQgaW4gdmVyc2lvbiAxLjE2LjBcbiAqL1xuZXhwb3J0IGNsYXNzIFNwZWVjaFN5bnRoZXNpc0Jvb2ttYXJrRXZlbnRBcmdzIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBhdWRpb09mZnNldCAtIFRoZSBhdWRpbyBvZmZzZXQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQgLSBUaGUgYm9va21hcmsgdGV4dC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihhdWRpb09mZnNldCwgdGV4dCkge1xuICAgICAgICB0aGlzLnByaXZBdWRpb09mZnNldCA9IGF1ZGlvT2Zmc2V0O1xuICAgICAgICB0aGlzLnByaXZUZXh0ID0gdGV4dDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3BlY2lmaWVzIHRoZSBhdWRpbyBvZmZzZXQuXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNCb29rbWFya0V2ZW50QXJncy5wcm90b3R5cGUuYXVkaW9PZmZzZXRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge251bWJlcn0gdGhlIGF1ZGlvIG9mZnNldC5cbiAgICAgKi9cbiAgICBnZXQgYXVkaW9PZmZzZXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb09mZnNldDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3BlY2lmaWVzIHRoZSBib29rbWFyay5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc0Jvb2ttYXJrRXZlbnRBcmdzLnByb3RvdHlwZS50ZXh0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHRoZSBib29rbWFyayB0ZXh0LlxuICAgICAqL1xuICAgIGdldCB0ZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VGV4dDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWVjaFN5bnRoZXNpc0Jvb2ttYXJrRXZlbnRBcmdzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIERlZmluZXMgdGhlIGJvdW5kYXJ5IHR5cGUgb2Ygc3BlZWNoIHN5bnRoZXNpcyBib3VuZGFyeSBldmVudC5cbiAqIEBjbGFzcyBTcGVlY2hTeW50aGVzaXNCb3VuZGFyeVR5cGVcbiAqIEFkZGVkIGluIHZlcnNpb24gMS4yMS4wXG4gKi9cbmV4cG9ydCB2YXIgU3BlZWNoU3ludGhlc2lzQm91bmRhcnlUeXBlO1xuKGZ1bmN0aW9uIChTcGVlY2hTeW50aGVzaXNCb3VuZGFyeVR5cGUpIHtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhlIGJvdW5kYXJ5IHRleHQgaXMgYSB3b3JkLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzQm91bmRhcnlUeXBlLldvcmRcbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNCb3VuZGFyeVR5cGVbXCJXb3JkXCJdID0gXCJXb3JkQm91bmRhcnlcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhlIGJvdW5kYXJ5IHRleHQgaXMgYSBwdW5jdHVhdGlvbi5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc0JvdW5kYXJ5VHlwZS5QdW5jdHVhdGlvblxuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc0JvdW5kYXJ5VHlwZVtcIlB1bmN0dWF0aW9uXCJdID0gXCJQdW5jdHVhdGlvbkJvdW5kYXJ5XCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIHRoZSBib3VuZGFyeSB0ZXh0IGlzIGEgc2VudGVuY2UuXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNCb3VuZGFyeVR5cGUuU2VudGVuY2VcbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNCb3VuZGFyeVR5cGVbXCJTZW50ZW5jZVwiXSA9IFwiU2VudGVuY2VCb3VuZGFyeVwiO1xufSkoU3BlZWNoU3ludGhlc2lzQm91bmRhcnlUeXBlIHx8IChTcGVlY2hTeW50aGVzaXNCb3VuZGFyeVR5cGUgPSB7fSkpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TcGVlY2hTeW50aGVzaXNCb3VuZGFyeVR5cGUuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogRGVmaW5lcyBjb250ZW50cyBvZiBzcGVlY2ggc3ludGhlc2lzIGV2ZW50cy5cbiAqIEBjbGFzcyBTcGVlY2hTeW50aGVzaXNFdmVudEFyZ3NcbiAqIEFkZGVkIGluIHZlcnNpb24gMS4xMS4wXG4gKi9cbmV4cG9ydCBjbGFzcyBTcGVlY2hTeW50aGVzaXNFdmVudEFyZ3Mge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtTcGVlY2hTeW50aGVzaXNSZXN1bHR9IHJlc3VsdCAtIFRoZSBzcGVlY2ggc3ludGhlc2lzIHJlc3VsdC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZXN1bHQpIHtcbiAgICAgICAgdGhpcy5wcml2UmVzdWx0ID0gcmVzdWx0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIHN5bnRoZXNpcyByZXN1bHQuXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNFdmVudEFyZ3MucHJvdG90eXBlLnJlc3VsdFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7U3BlZWNoU3ludGhlc2lzUmVzdWx0fSB0aGUgc3ludGhlc2lzIHJlc3VsdC5cbiAgICAgKi9cbiAgICBnZXQgcmVzdWx0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVzdWx0O1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlZWNoU3ludGhlc2lzRXZlbnRBcmdzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIERlZmluZSBzcGVlY2ggc3ludGhlc2lzIGF1ZGlvIG91dHB1dCBmb3JtYXRzLlxuICogQGVudW0gU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0XG4gKiBVcGRhdGVkIGluIHZlcnNpb24gMS4xNy4wXG4gKi9cbmV4cG9ydCB2YXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0O1xuKGZ1bmN0aW9uIChTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQpIHtcbiAgICAvKipcbiAgICAgKiByYXctOGtoei04Yml0LW1vbm8tbXVsYXdcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SYXc4S2h6OEJpdE1vbm9NVUxhdyxcbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiUmF3OEtoejhCaXRNb25vTVVMYXdcIl0gPSAwXSA9IFwiUmF3OEtoejhCaXRNb25vTVVMYXdcIjtcbiAgICAvKipcbiAgICAgKiByaWZmLTE2a2h6LTE2a2Jwcy1tb25vLXNpcmVuXG4gICAgICogQG5vdGUgVW5zdXBwb3J0ZWQgYnkgdGhlIHNlcnZpY2UuIERvIG5vdCB1c2UgdGhpcyB2YWx1ZS5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SaWZmMTZLaHoxNkticHNNb25vU2lyZW5cbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiUmlmZjE2S2h6MTZLYnBzTW9ub1NpcmVuXCJdID0gMV0gPSBcIlJpZmYxNktoejE2S2Jwc01vbm9TaXJlblwiO1xuICAgIC8qKlxuICAgICAqIGF1ZGlvLTE2a2h6LTE2a2Jwcy1tb25vLXNpcmVuXG4gICAgICogQG5vdGUgVW5zdXBwb3J0ZWQgYnkgdGhlIHNlcnZpY2UuIERvIG5vdCB1c2UgdGhpcyB2YWx1ZS5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5BdWRpbzE2S2h6MTZLYnBzTW9ub1NpcmVuXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIkF1ZGlvMTZLaHoxNkticHNNb25vU2lyZW5cIl0gPSAyXSA9IFwiQXVkaW8xNktoejE2S2Jwc01vbm9TaXJlblwiO1xuICAgIC8qKlxuICAgICAqIGF1ZGlvLTE2a2h6LTMya2JpdHJhdGUtbW9uby1tcDNcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5BdWRpbzE2S2h6MzJLQml0UmF0ZU1vbm9NcDNcbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiQXVkaW8xNktoejMyS0JpdFJhdGVNb25vTXAzXCJdID0gM10gPSBcIkF1ZGlvMTZLaHozMktCaXRSYXRlTW9ub01wM1wiO1xuICAgIC8qKlxuICAgICAqIGF1ZGlvLTE2a2h6LTEyOGtiaXRyYXRlLW1vbm8tbXAzXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuQXVkaW8xNktoejEyOEtCaXRSYXRlTW9ub01wM1xuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJBdWRpbzE2S2h6MTI4S0JpdFJhdGVNb25vTXAzXCJdID0gNF0gPSBcIkF1ZGlvMTZLaHoxMjhLQml0UmF0ZU1vbm9NcDNcIjtcbiAgICAvKipcbiAgICAgKiBhdWRpby0xNmtoei02NGtiaXRyYXRlLW1vbm8tbXAzXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuQXVkaW8xNktoejY0S0JpdFJhdGVNb25vTXAzXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIkF1ZGlvMTZLaHo2NEtCaXRSYXRlTW9ub01wM1wiXSA9IDVdID0gXCJBdWRpbzE2S2h6NjRLQml0UmF0ZU1vbm9NcDNcIjtcbiAgICAvKipcbiAgICAgKiBhdWRpby0yNGtoei00OGtiaXRyYXRlLW1vbm8tbXAzXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuQXVkaW8yNEtoejQ4S0JpdFJhdGVNb25vTXAzXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIkF1ZGlvMjRLaHo0OEtCaXRSYXRlTW9ub01wM1wiXSA9IDZdID0gXCJBdWRpbzI0S2h6NDhLQml0UmF0ZU1vbm9NcDNcIjtcbiAgICAvKipcbiAgICAgKiBhdWRpby0yNGtoei05NmtiaXRyYXRlLW1vbm8tbXAzXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuQXVkaW8yNEtoejk2S0JpdFJhdGVNb25vTXAzXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIkF1ZGlvMjRLaHo5NktCaXRSYXRlTW9ub01wM1wiXSA9IDddID0gXCJBdWRpbzI0S2h6OTZLQml0UmF0ZU1vbm9NcDNcIjtcbiAgICAvKipcbiAgICAgKiBhdWRpby0yNGtoei0xNjBrYml0cmF0ZS1tb25vLW1wM1xuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LkF1ZGlvMjRLaHoxNjBLQml0UmF0ZU1vbm9NcDNcbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiQXVkaW8yNEtoejE2MEtCaXRSYXRlTW9ub01wM1wiXSA9IDhdID0gXCJBdWRpbzI0S2h6MTYwS0JpdFJhdGVNb25vTXAzXCI7XG4gICAgLyoqXG4gICAgICogcmF3LTE2a2h6LTE2Yml0LW1vbm8tdHJ1ZXNpbGtcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SYXcxNktoejE2Qml0TW9ub1RydWVTaWxrXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIlJhdzE2S2h6MTZCaXRNb25vVHJ1ZVNpbGtcIl0gPSA5XSA9IFwiUmF3MTZLaHoxNkJpdE1vbm9UcnVlU2lsa1wiO1xuICAgIC8qKlxuICAgICAqIHJpZmYtMTZraHotMTZiaXQtbW9uby1wY21cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SaWZmMTZLaHoxNkJpdE1vbm9QY21cbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiUmlmZjE2S2h6MTZCaXRNb25vUGNtXCJdID0gMTBdID0gXCJSaWZmMTZLaHoxNkJpdE1vbm9QY21cIjtcbiAgICAvKipcbiAgICAgKiByaWZmLThraHotMTZiaXQtbW9uby1wY21cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SaWZmOEtoejE2Qml0TW9ub1BjbVxuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJSaWZmOEtoejE2Qml0TW9ub1BjbVwiXSA9IDExXSA9IFwiUmlmZjhLaHoxNkJpdE1vbm9QY21cIjtcbiAgICAvKipcbiAgICAgKiByaWZmLTI0a2h6LTE2Yml0LW1vbm8tcGNtXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmlmZjI0S2h6MTZCaXRNb25vUGNtXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIlJpZmYyNEtoejE2Qml0TW9ub1BjbVwiXSA9IDEyXSA9IFwiUmlmZjI0S2h6MTZCaXRNb25vUGNtXCI7XG4gICAgLyoqXG4gICAgICogcmlmZi04a2h6LThiaXQtbW9uby1tdWxhd1xuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJpZmY4S2h6OEJpdE1vbm9NVUxhd1xuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJSaWZmOEtoejhCaXRNb25vTVVMYXdcIl0gPSAxM10gPSBcIlJpZmY4S2h6OEJpdE1vbm9NVUxhd1wiO1xuICAgIC8qKlxuICAgICAqIHJhdy0xNmtoei0xNmJpdC1tb25vLXBjbVxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJhdzE2S2h6MTZCaXRNb25vUGNtXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIlJhdzE2S2h6MTZCaXRNb25vUGNtXCJdID0gMTRdID0gXCJSYXcxNktoejE2Qml0TW9ub1BjbVwiO1xuICAgIC8qKlxuICAgICAqIHJhdy0yNGtoei0xNmJpdC1tb25vLXBjbVxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJhdzI0S2h6MTZCaXRNb25vUGNtXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIlJhdzI0S2h6MTZCaXRNb25vUGNtXCJdID0gMTVdID0gXCJSYXcyNEtoejE2Qml0TW9ub1BjbVwiO1xuICAgIC8qKlxuICAgICAqIHJhdy04a2h6LTE2Yml0LW1vbm8tcGNtXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmF3OEtoejE2Qml0TW9ub1BjbVxuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJSYXc4S2h6MTZCaXRNb25vUGNtXCJdID0gMTZdID0gXCJSYXc4S2h6MTZCaXRNb25vUGNtXCI7XG4gICAgLyoqXG4gICAgICogb2dnLTE2a2h6LTE2Yml0LW1vbm8tb3B1c1xuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0Lk9nZzE2S2h6MTZCaXRNb25vT3B1c1xuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJPZ2cxNktoejE2Qml0TW9ub09wdXNcIl0gPSAxN10gPSBcIk9nZzE2S2h6MTZCaXRNb25vT3B1c1wiO1xuICAgIC8qKlxuICAgICAqIG9nZy0yNGtoei0xNmJpdC1tb25vLW9wdXNcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5PZ2cyNEtoejE2Qml0TW9ub09wdXNcbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiT2dnMjRLaHoxNkJpdE1vbm9PcHVzXCJdID0gMThdID0gXCJPZ2cyNEtoejE2Qml0TW9ub09wdXNcIjtcbiAgICAvKipcbiAgICAgKiByYXctNDhraHotMTZiaXQtbW9uby1wY21cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SYXc0OEtoejE2Qml0TW9ub1BjbVxuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJSYXc0OEtoejE2Qml0TW9ub1BjbVwiXSA9IDE5XSA9IFwiUmF3NDhLaHoxNkJpdE1vbm9QY21cIjtcbiAgICAvKipcbiAgICAgKiByaWZmLTQ4a2h6LTE2Yml0LW1vbm8tcGNtXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmlmZjQ4S2h6MTZCaXRNb25vUGNtXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIlJpZmY0OEtoejE2Qml0TW9ub1BjbVwiXSA9IDIwXSA9IFwiUmlmZjQ4S2h6MTZCaXRNb25vUGNtXCI7XG4gICAgLyoqXG4gICAgICogYXVkaW8tNDhraHotOTZrYml0cmF0ZS1tb25vLW1wM1xuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LkF1ZGlvNDhLaHo5NktCaXRSYXRlTW9ub01wM1xuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJBdWRpbzQ4S2h6OTZLQml0UmF0ZU1vbm9NcDNcIl0gPSAyMV0gPSBcIkF1ZGlvNDhLaHo5NktCaXRSYXRlTW9ub01wM1wiO1xuICAgIC8qKlxuICAgICAqIGF1ZGlvLTQ4a2h6LTE5MmtiaXRyYXRlLW1vbm8tbXAzXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuQXVkaW80OEtoejE5MktCaXRSYXRlTW9ub01wM1xuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJBdWRpbzQ4S2h6MTkyS0JpdFJhdGVNb25vTXAzXCJdID0gMjJdID0gXCJBdWRpbzQ4S2h6MTkyS0JpdFJhdGVNb25vTXAzXCI7XG4gICAgLyoqXG4gICAgICogb2dnLTQ4a2h6LTE2Yml0LW1vbm8tb3B1c1xuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xNi4wXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuT2dnNDhLaHoxNkJpdE1vbm9PcHVzXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIk9nZzQ4S2h6MTZCaXRNb25vT3B1c1wiXSA9IDIzXSA9IFwiT2dnNDhLaHoxNkJpdE1vbm9PcHVzXCI7XG4gICAgLyoqXG4gICAgICogd2VibS0xNmtoei0xNmJpdC1tb25vLW9wdXNcbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTYuMFxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LldlYm0xNktoejE2Qml0TW9ub09wdXNcbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiV2VibTE2S2h6MTZCaXRNb25vT3B1c1wiXSA9IDI0XSA9IFwiV2VibTE2S2h6MTZCaXRNb25vT3B1c1wiO1xuICAgIC8qKlxuICAgICAqIHdlYm0tMjRraHotMTZiaXQtbW9uby1vcHVzXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjE2LjBcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5XZWJtMjRLaHoxNkJpdE1vbm9PcHVzXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIldlYm0yNEtoejE2Qml0TW9ub09wdXNcIl0gPSAyNV0gPSBcIldlYm0yNEtoejE2Qml0TW9ub09wdXNcIjtcbiAgICAvKipcbiAgICAgKiByYXctMjRraHotMTZiaXQtbW9uby10cnVlc2lsa1xuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xNy4wXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmF3MjRLaHoxNkJpdE1vbm9UcnVlU2lsa1xuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJSYXcyNEtoejE2Qml0TW9ub1RydWVTaWxrXCJdID0gMjZdID0gXCJSYXcyNEtoejE2Qml0TW9ub1RydWVTaWxrXCI7XG4gICAgLyoqXG4gICAgICogcmF3LThraHotOGJpdC1tb25vLWFsYXdcbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTcuMFxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJhdzhLaHo4Qml0TW9ub0FMYXdcbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiUmF3OEtoejhCaXRNb25vQUxhd1wiXSA9IDI3XSA9IFwiUmF3OEtoejhCaXRNb25vQUxhd1wiO1xuICAgIC8qKlxuICAgICAqIHJpZmYtOGtoei04Yml0LW1vbm8tYWxhd1xuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xNy4wXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmlmZjhLaHo4Qml0TW9ub0FMYXdcbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiUmlmZjhLaHo4Qml0TW9ub0FMYXdcIl0gPSAyOF0gPSBcIlJpZmY4S2h6OEJpdE1vbm9BTGF3XCI7XG4gICAgLyoqXG4gICAgICogd2VibS0yNGtoei0xNmJpdC0yNGticHMtbW9uby1vcHVzXG4gICAgICogQXVkaW8gY29tcHJlc3NlZCBieSBPUFVTIGNvZGVjIGluIGEgd2VibSBjb250YWluZXIsIHdpdGggYml0cmF0ZSBvZiAyNGticHMsIG9wdGltaXplZCBmb3IgSW9UIHNjZW5hcmlvLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xOS4wXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuV2VibTI0S2h6MTZCaXQyNEticHNNb25vT3B1c1xuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJXZWJtMjRLaHoxNkJpdDI0S2Jwc01vbm9PcHVzXCJdID0gMjldID0gXCJXZWJtMjRLaHoxNkJpdDI0S2Jwc01vbm9PcHVzXCI7XG4gICAgLyoqXG4gICAgICogYXVkaW8tMTZraHotMTZiaXQtMzJrYnBzLW1vbm8tb3B1c1xuICAgICAqIEF1ZGlvIGNvbXByZXNzZWQgYnkgT1BVUyBjb2RlYyB3aXRob3V0IGNvbnRhaW5lciwgd2l0aCBiaXRyYXRlIG9mIDMya2Jwcy5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMjAuMFxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LkF1ZGlvMTZLaHoxNkJpdDMyS2Jwc01vbm9PcHVzXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIkF1ZGlvMTZLaHoxNkJpdDMyS2Jwc01vbm9PcHVzXCJdID0gMzBdID0gXCJBdWRpbzE2S2h6MTZCaXQzMkticHNNb25vT3B1c1wiO1xuICAgIC8qKlxuICAgICAqIGF1ZGlvLTI0a2h6LTE2Yml0LTQ4a2Jwcy1tb25vLW9wdXNcbiAgICAgKiBBdWRpbyBjb21wcmVzc2VkIGJ5IE9QVVMgY29kZWMgd2l0aG91dCBjb250YWluZXIsIHdpdGggYml0cmF0ZSBvZiA0OGticHMuXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjIwLjBcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5BdWRpbzI0S2h6MTZCaXQ0OEticHNNb25vT3B1c1xuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJBdWRpbzI0S2h6MTZCaXQ0OEticHNNb25vT3B1c1wiXSA9IDMxXSA9IFwiQXVkaW8yNEtoejE2Qml0NDhLYnBzTW9ub09wdXNcIjtcbiAgICAvKipcbiAgICAgKiBhdWRpby0yNGtoei0xNmJpdC0yNGticHMtbW9uby1vcHVzXG4gICAgICogQXVkaW8gY29tcHJlc3NlZCBieSBPUFVTIGNvZGVjIHdpdGhvdXQgY29udGFpbmVyLCB3aXRoIGJpdHJhdGUgb2YgMjRrYnBzLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4yMC4wXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuQXVkaW8yNEtoejE2Qml0MjRLYnBzTW9ub09wdXNcbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiQXVkaW8yNEtoejE2Qml0MjRLYnBzTW9ub09wdXNcIl0gPSAzMl0gPSBcIkF1ZGlvMjRLaHoxNkJpdDI0S2Jwc01vbm9PcHVzXCI7XG4gICAgLyoqXG4gICAgICogcmF3LTIyMDUwaHotMTZiaXQtbW9uby1wY21cbiAgICAgKiBSYXcgUENNIGF1ZGlvIGF0IDIyMDUwSHogc2FtcGxpbmcgcmF0ZSBhbmQgMTYtYml0IGRlcHRoLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4yMi4wXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmF3MjIwNTBIejE2Qml0TW9ub1BjbVxuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJSYXcyMjA1MEh6MTZCaXRNb25vUGNtXCJdID0gMzNdID0gXCJSYXcyMjA1MEh6MTZCaXRNb25vUGNtXCI7XG4gICAgLyoqXG4gICAgICogcmlmZi0yMjA1MGh6LTE2Yml0LW1vbm8tcGNtXG4gICAgICogUENNIGF1ZGlvIGF0IDIyMDUwSHogc2FtcGxpbmcgcmF0ZSBhbmQgMTYtYml0IGRlcHRoLCB3aXRoIFJJRkYgaGVhZGVyLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4yMi4wXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmlmZjIyMDUwSHoxNkJpdE1vbm9QY21cbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiUmlmZjIyMDUwSHoxNkJpdE1vbm9QY21cIl0gPSAzNF0gPSBcIlJpZmYyMjA1MEh6MTZCaXRNb25vUGNtXCI7XG4gICAgLyoqXG4gICAgICogcmF3LTQ0MTAwaHotMTZiaXQtbW9uby1wY21cbiAgICAgKiBSYXcgUENNIGF1ZGlvIGF0IDQ0MTAwSHogc2FtcGxpbmcgcmF0ZSBhbmQgMTYtYml0IGRlcHRoLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4yMi4wXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmF3NDQxMDBIejE2Qml0TW9ub1BjbVxuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJSYXc0NDEwMEh6MTZCaXRNb25vUGNtXCJdID0gMzVdID0gXCJSYXc0NDEwMEh6MTZCaXRNb25vUGNtXCI7XG4gICAgLyoqXG4gICAgICogcmlmZi00NDEwMGh6LTE2Yml0LW1vbm8tcGNtXG4gICAgICogUENNIGF1ZGlvIGF0IDQ0MTAwSHogc2FtcGxpbmcgcmF0ZSBhbmQgMTYtYml0IGRlcHRoLCB3aXRoIFJJRkYgaGVhZGVyLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4yMi4wXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmlmZjQ0MTAwSHoxNkJpdE1vbm9QY21cbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiUmlmZjQ0MTAwSHoxNkJpdE1vbm9QY21cIl0gPSAzNl0gPSBcIlJpZmY0NDEwMEh6MTZCaXRNb25vUGNtXCI7XG59KShTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQgfHwgKFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdCA9IHt9KSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgU3ludGhlc2lzUmVzdWx0IH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBEZWZpbmVzIHJlc3VsdCBvZiBzcGVlY2ggc3ludGhlc2lzLlxuICogQGNsYXNzIFNwZWVjaFN5bnRoZXNpc1Jlc3VsdFxuICogQWRkZWQgaW4gdmVyc2lvbiAxLjExLjBcbiAqL1xuZXhwb3J0IGNsYXNzIFNwZWVjaFN5bnRoZXNpc1Jlc3VsdCBleHRlbmRzIFN5bnRoZXNpc1Jlc3VsdCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcmVzdWx0SWQgLSBUaGUgcmVzdWx0IGlkLlxuICAgICAqIEBwYXJhbSB7UmVzdWx0UmVhc29ufSByZWFzb24gLSBUaGUgcmVhc29uLlxuICAgICAqIEBwYXJhbSB7QXJyYXlCdWZmZXJ9IGF1ZGlvRGF0YSAtIFRoZSBzeW50aGVzaXplZCBhdWRpbyBiaW5hcnkuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGVycm9yRGV0YWlscyAtIEVycm9yIGRldGFpbHMsIGlmIHByb3ZpZGVkLlxuICAgICAqIEBwYXJhbSB7UHJvcGVydHlDb2xsZWN0aW9ufSBwcm9wZXJ0aWVzIC0gQWRkaXRpb25hbCBwcm9wZXJ0aWVzLCBpZiBwcm92aWRlZC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gYXVkaW9EdXJhdGlvbiAtIFRoZSBhdWRpbyBkdXJhdGlvbi5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZXN1bHRJZCwgcmVhc29uLCBhdWRpb0RhdGEsIGVycm9yRGV0YWlscywgcHJvcGVydGllcywgYXVkaW9EdXJhdGlvbikge1xuICAgICAgICBzdXBlcihyZXN1bHRJZCwgcmVhc29uLCBlcnJvckRldGFpbHMsIHByb3BlcnRpZXMpO1xuICAgICAgICB0aGlzLnByaXZBdWRpb0RhdGEgPSBhdWRpb0RhdGE7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvRHVyYXRpb24gPSBhdWRpb0R1cmF0aW9uO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgc3ludGhlc2l6ZWQgYXVkaW8gZGF0YVxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzUmVzdWx0LnByb3RvdHlwZS5hdWRpb0RhdGFcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge0FycmF5QnVmZmVyfSBUaGUgc3ludGhlc2l6ZWQgYXVkaW8gZGF0YS5cbiAgICAgKi9cbiAgICBnZXQgYXVkaW9EYXRhKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXVkaW9EYXRhO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgdGltZSBkdXJhdGlvbiBvZiBzeW50aGVzaXplZCBhdWRpbywgaW4gdGlja3MgKDEwMCBuYW5vc2Vjb25kcykuXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNSZXN1bHQucHJvdG90eXBlLmF1ZGlvRHVyYXRpb25cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge251bWJlcn0gVGhlIHRpbWUgZHVyYXRpb24gb2Ygc3ludGhlc2l6ZWQgYXVkaW8uXG4gICAgICovXG4gICAgZ2V0IGF1ZGlvRHVyYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb0R1cmF0aW9uO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlZWNoU3ludGhlc2lzUmVzdWx0LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIERlZmluZXMgY29udGVudHMgb2Ygc3BlZWNoIHN5bnRoZXNpcyB2aXNlbWUgZXZlbnQuXG4gKiBAY2xhc3MgU3BlZWNoU3ludGhlc2lzVmlzZW1lRXZlbnRBcmdzXG4gKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTYuMFxuICovXG5leHBvcnQgY2xhc3MgU3BlZWNoU3ludGhlc2lzVmlzZW1lRXZlbnRBcmdzIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBhdWRpb09mZnNldCAtIFRoZSBhdWRpbyBvZmZzZXQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHZpc2VtZUlkIC0gVGhlIHZpc2VtZSBJRC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gYW5pbWF0aW9uIC0gVGhlIGFuaW1hdGlvbiwgY291bGQgYmUgaW4gc3ZnIG9yIG90aGVyIGZvcm1hdC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihhdWRpb09mZnNldCwgdmlzZW1lSWQsIGFuaW1hdGlvbikge1xuICAgICAgICB0aGlzLnByaXZBdWRpb09mZnNldCA9IGF1ZGlvT2Zmc2V0O1xuICAgICAgICB0aGlzLnByaXZWaXNlbWVJZCA9IHZpc2VtZUlkO1xuICAgICAgICB0aGlzLnByaXZBbmltYXRpb24gPSBhbmltYXRpb247XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyB0aGUgYXVkaW8gb2Zmc2V0LlxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzVmlzZW1lRXZlbnRBcmdzLnByb3RvdHlwZS5hdWRpb09mZnNldFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSB0aGUgYXVkaW8gb2Zmc2V0LlxuICAgICAqL1xuICAgIGdldCBhdWRpb09mZnNldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvT2Zmc2V0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIHZpc2VtZSBJRC5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc1Zpc2VtZUV2ZW50QXJncy5wcm90b3R5cGUudmlzZW1lSWRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge251bWJlcn0gdGhlIHZpc2VtZSBJRC5cbiAgICAgKi9cbiAgICBnZXQgdmlzZW1lSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZWaXNlbWVJZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3BlY2lmaWVzIHRoZSBhbmltYXRpb24uXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNWaXNlbWVFdmVudEFyZ3MucHJvdG90eXBlLmFuaW1hdGlvblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSB0aGUgYW5pbWF0aW9uLCBjb3VsZCBiZSBpbiBzdmcgb3Igb3RoZXIgZm9ybWF0LlxuICAgICAqL1xuICAgIGdldCBhbmltYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBbmltYXRpb247XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TcGVlY2hTeW50aGVzaXNWaXNlbWVFdmVudEFyZ3MuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogRGVmaW5lcyBjb250ZW50cyBvZiBzcGVlY2ggc3ludGhlc2lzIHdvcmQgYm91bmRhcnkgZXZlbnQuXG4gKiBAY2xhc3MgU3BlZWNoU3ludGhlc2lzV29yZEJvdW5kYXJ5RXZlbnRBcmdzXG4gKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTEuMFxuICovXG5leHBvcnQgY2xhc3MgU3BlZWNoU3ludGhlc2lzV29yZEJvdW5kYXJ5RXZlbnRBcmdzIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBhdWRpb09mZnNldCAtIFRoZSBhdWRpbyBvZmZzZXQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGR1cmF0aW9uIC0gVGhlIGF1ZGlvIGR1cmF0aW9uLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0IC0gVGhlIHRleHQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHdvcmRMZW5ndGggLSBUaGUgbGVuZ3RoIG9mIHRoZSB3b3JkLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB0ZXh0T2Zmc2V0IC0gVGhlIHRleHQgb2Zmc2V0LlxuICAgICAqIEBwYXJhbSB7U3BlZWNoU3ludGhlc2lzQm91bmRhcnlUeXBlfSBib3VuZGFyeVR5cGUgLSBUaGUgYm91bmRhcnkgdHlwZVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGF1ZGlvT2Zmc2V0LCBkdXJhdGlvbiwgdGV4dCwgd29yZExlbmd0aCwgdGV4dE9mZnNldCwgYm91bmRhcnlUeXBlKSB7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvT2Zmc2V0ID0gYXVkaW9PZmZzZXQ7XG4gICAgICAgIHRoaXMucHJpdkR1cmF0aW9uID0gZHVyYXRpb247XG4gICAgICAgIHRoaXMucHJpdlRleHQgPSB0ZXh0O1xuICAgICAgICB0aGlzLnByaXZXb3JkTGVuZ3RoID0gd29yZExlbmd0aDtcbiAgICAgICAgdGhpcy5wcml2VGV4dE9mZnNldCA9IHRleHRPZmZzZXQ7XG4gICAgICAgIHRoaXMucHJpdkJvdW5kYXJ5VHlwZSA9IGJvdW5kYXJ5VHlwZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3BlY2lmaWVzIHRoZSBhdWRpbyBvZmZzZXQuXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNXb3JkQm91bmRhcnlFdmVudEFyZ3MucHJvdG90eXBlLmF1ZGlvT2Zmc2V0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IHRoZSBhdWRpbyBvZmZzZXQuXG4gICAgICovXG4gICAgZ2V0IGF1ZGlvT2Zmc2V0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXVkaW9PZmZzZXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyB0aGUgZHVyYXRpb24sIGluIHRpY2tzICgxMDAgbmFub3NlY29uZHMpLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzV29yZEJvdW5kYXJ5RXZlbnRBcmdzLnByb3RvdHlwZS5kdXJhdGlvblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBEdXJhdGlvbiBpbiAxMDAgbmFub3NlY29uZCBpbmNyZW1lbnRzLlxuICAgICAqL1xuICAgIGdldCBkdXJhdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkR1cmF0aW9uO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIHRleHQgb2YgdGhlIHdvcmQgYm91bmRhcnkgZXZlbnQuXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNXb3JkQm91bmRhcnlFdmVudEFyZ3MucHJvdG90eXBlLnRleHRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ30gdGhlIHRleHQuXG4gICAgICovXG4gICAgZ2V0IHRleHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUZXh0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIHdvcmQgbGVuZ3RoXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNXb3JkQm91bmRhcnlFdmVudEFyZ3MucHJvdG90eXBlLndvcmRMZW5ndGhcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge251bWJlcn0gdGhlIHdvcmQgbGVuZ3RoXG4gICAgICovXG4gICAgZ2V0IHdvcmRMZW5ndGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZXb3JkTGVuZ3RoO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIHRleHQgb2Zmc2V0LlxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzV29yZEJvdW5kYXJ5RXZlbnRBcmdzLnByb3RvdHlwZS50ZXh0T2Zmc2V0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IHRoZSB0ZXh0IG9mZnNldC5cbiAgICAgKi9cbiAgICBnZXQgdGV4dE9mZnNldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRleHRPZmZzZXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyB0aGUgYm91bmRhcnkgdHlwZS5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc1dvcmRCb3VuZGFyeUV2ZW50QXJncy5wcm90b3R5cGUuYm91bmRhcnlUeXBlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtTcGVlY2hTeW50aGVzaXNCb3VuZGFyeVR5cGV9IHRoZSBib3VuZGFyeSB0eXBlLlxuICAgICAqL1xuICAgIGdldCBib3VuZGFyeVR5cGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZCb3VuZGFyeVR5cGU7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TcGVlY2hTeW50aGVzaXNXb3JkQm91bmRhcnlFdmVudEFyZ3MuanMubWFwXG4iLCIvKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb24gKi9cbi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VzT3BlblJhbmdlT3B0aW9uTmFtZSwgQ29nbml0aXZlU3Vic2NyaXB0aW9uS2V5QXV0aGVudGljYXRpb24sIENvZ25pdGl2ZVRva2VuQXV0aGVudGljYXRpb24sIENvbnRleHQsIE9TLCBTcGVlY2hTZXJ2aWNlQ29uZmlnLCBTcGVlY2hTeW50aGVzaXNDb25uZWN0aW9uRmFjdG9yeSwgU3ludGhlc2lzQWRhcHRlckJhc2UsIFN5bnRoZXNpc1Jlc3RBZGFwdGVyLCBTeW50aGVzaXplckNvbmZpZywgfSBmcm9tIFwiLi4vY29tbW9uLnNwZWVjaC9FeHBvcnRzXCI7XG5pbXBvcnQgeyBjcmVhdGVOb0Rhc2hHdWlkLCBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzLCBRdWV1ZSB9IGZyb20gXCIuLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQXVkaW9GaWxlV3JpdGVyIH0gZnJvbSBcIi4vQXVkaW8vQXVkaW9GaWxlV3JpdGVyXCI7XG5pbXBvcnQgeyBBdWRpb091dHB1dEZvcm1hdEltcGwgfSBmcm9tIFwiLi9BdWRpby9BdWRpb091dHB1dEZvcm1hdFwiO1xuaW1wb3J0IHsgUHVzaEF1ZGlvT3V0cHV0U3RyZWFtSW1wbCB9IGZyb20gXCIuL0F1ZGlvL0F1ZGlvT3V0cHV0U3RyZWFtXCI7XG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi9Db250cmFjdHNcIjtcbmltcG9ydCB7IEF1ZGlvQ29uZmlnLCBQcm9wZXJ0eUlkLCBQdWxsQXVkaW9PdXRwdXRTdHJlYW0sIFB1c2hBdWRpb091dHB1dFN0cmVhbUNhbGxiYWNrLCBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQsIFN5bnRoZXNpc1ZvaWNlc1Jlc3VsdCwgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIERlZmluZXMgdGhlIGNsYXNzIFNwZWVjaFN5bnRoZXNpemVyIGZvciB0ZXh0IHRvIHNwZWVjaC5cbiAqIFVwZGF0ZWQgaW4gdmVyc2lvbiAxLjE2LjBcbiAqIEBjbGFzcyBTcGVlY2hTeW50aGVzaXplclxuICovXG5leHBvcnQgY2xhc3MgU3BlZWNoU3ludGhlc2l6ZXIge1xuICAgIC8qKlxuICAgICAqIFNwZWVjaFN5bnRoZXNpemVyIGNvbnN0cnVjdG9yLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7U3BlZWNoQ29uZmlnfSBzcGVlY2hDb25maWcgLSBBbiBzZXQgb2YgaW5pdGlhbCBwcm9wZXJ0aWVzIGZvciB0aGlzIHN5bnRoZXNpemVyLlxuICAgICAqIEBwYXJhbSB7QXVkaW9Db25maWd9IGF1ZGlvQ29uZmlnIC0gQW4gb3B0aW9uYWwgYXVkaW8gY29uZmlndXJhdGlvbiBhc3NvY2lhdGVkIHdpdGggdGhlIHN5bnRoZXNpemVyLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNwZWVjaENvbmZpZywgYXVkaW9Db25maWcpIHtcbiAgICAgICAgY29uc3Qgc3BlZWNoQ29uZmlnSW1wbCA9IHNwZWVjaENvbmZpZztcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsKHNwZWVjaENvbmZpZ0ltcGwsIFwic3BlZWNoQ29uZmlnXCIpO1xuICAgICAgICBpZiAoYXVkaW9Db25maWcgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGlmIChhdWRpb0NvbmZpZyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hdWRpb0NvbmZpZyA9ICh0eXBlb2Ygd2luZG93ID09PSBcInVuZGVmaW5lZFwiKSA/IHVuZGVmaW5lZCA6IEF1ZGlvQ29uZmlnLmZyb21EZWZhdWx0U3BlYWtlck91dHB1dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hdWRpb0NvbmZpZyA9IGF1ZGlvQ29uZmlnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMgPSBzcGVlY2hDb25maWdJbXBsLnByb3BlcnRpZXMuY2xvbmUoKTtcbiAgICAgICAgdGhpcy5wcml2RGlzcG9zZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2U3ludGhlc2l6aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25GYWN0b3J5ID0gbmV3IFNwZWVjaFN5bnRoZXNpc0Nvbm5lY3Rpb25GYWN0b3J5KCk7XG4gICAgICAgIHRoaXMuc3ludGhlc2lzUmVxdWVzdFF1ZXVlID0gbmV3IFF1ZXVlKCk7XG4gICAgICAgIHRoaXMuaW1wbENvbW1vblN5bnRoZXNpemVTZXR1cCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBhdXRob3JpemF0aW9uIHRva2VuIHVzZWQgdG8gY29tbXVuaWNhdGUgd2l0aCB0aGUgc2VydmljZS5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpemVyLnByb3RvdHlwZS5hdXRob3JpemF0aW9uVG9rZW5cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ30gQXV0aG9yaXphdGlvbiB0b2tlbi5cbiAgICAgKi9cbiAgICBnZXQgYXV0aG9yaXphdGlvblRva2VuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzL1NldHMgdGhlIGF1dGhvcml6YXRpb24gdG9rZW4gdXNlZCB0byBjb21tdW5pY2F0ZSB3aXRoIHRoZSBzZXJ2aWNlLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2l6ZXIucHJvdG90eXBlLmF1dGhvcml6YXRpb25Ub2tlblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdG9rZW4gLSBBdXRob3JpemF0aW9uIHRva2VuLlxuICAgICAqL1xuICAgIHNldCBhdXRob3JpemF0aW9uVG9rZW4odG9rZW4pIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHRva2VuLCBcInRva2VuXCIpO1xuICAgICAgICB0aGlzLnByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbiwgdG9rZW4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgY29sbGVjdGlvbiBvZiBwcm9wZXJ0aWVzIGFuZCB0aGVpciB2YWx1ZXMgZGVmaW5lZCBmb3IgdGhpcyBTcGVlY2hTeW50aGVzaXplci5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpemVyLnByb3RvdHlwZS5wcm9wZXJ0aWVzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtQcm9wZXJ0eUNvbGxlY3Rpb259IFRoZSBjb2xsZWN0aW9uIG9mIHByb3BlcnRpZXMgYW5kIHRoZWlyIHZhbHVlcyBkZWZpbmVkIGZvciB0aGlzIFNwZWVjaFN5bnRoZXNpemVyLlxuICAgICAqL1xuICAgIGdldCBwcm9wZXJ0aWVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIGlmIGF1dG8gZGV0ZWN0IHNvdXJjZSBsYW5ndWFnZSBpcyBlbmFibGVkXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXplci5wcm90b3R5cGUucHJvcGVydGllc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gaWYgYXV0byBkZXRlY3Qgc291cmNlIGxhbmd1YWdlIGlzIGVuYWJsZWRcbiAgICAgKi9cbiAgICBnZXQgYXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlcykgPT09IEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXNPcGVuUmFuZ2VPcHRpb25OYW1lO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVlY2hTeW50aGVzaXplciBjb25zdHJ1Y3Rvci5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge1NwZWVjaENvbmZpZ30gc3BlZWNoQ29uZmlnIC0gYW4gc2V0IG9mIGluaXRpYWwgcHJvcGVydGllcyBmb3IgdGhpcyBzeW50aGVzaXplclxuICAgICAqIEBwYXJhbSB7QXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnfSBhdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWcgLSBBbiBzb3VyY2UgbGFuZ3VhZ2UgZGV0ZWN0aW9uIGNvbmZpZ3VyYXRpb24gYXNzb2NpYXRlZCB3aXRoIHRoZSBzeW50aGVzaXplclxuICAgICAqIEBwYXJhbSB7QXVkaW9Db25maWd9IGF1ZGlvQ29uZmlnIC0gQW4gb3B0aW9uYWwgYXVkaW8gY29uZmlndXJhdGlvbiBhc3NvY2lhdGVkIHdpdGggdGhlIHN5bnRoZXNpemVyXG4gICAgICovXG4gICAgc3RhdGljIEZyb21Db25maWcoc3BlZWNoQ29uZmlnLCBhdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWcsIGF1ZGlvQ29uZmlnKSB7XG4gICAgICAgIGNvbnN0IHNwZWVjaENvbmZpZ0ltcGwgPSBzcGVlY2hDb25maWc7XG4gICAgICAgIGF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZy5wcm9wZXJ0aWVzLm1lcmdlVG8oc3BlZWNoQ29uZmlnSW1wbC5wcm9wZXJ0aWVzKTtcbiAgICAgICAgcmV0dXJuIG5ldyBTcGVlY2hTeW50aGVzaXplcihzcGVlY2hDb25maWcsIGF1ZGlvQ29uZmlnKTtcbiAgICB9XG4gICAgYnVpbGRTc21sKHRleHQpIHtcbiAgICAgICAgY29uc3QgbGFuZ3VhZ2VUb0RlZmF1bHRWb2ljZSA9IHtcbiAgICAgICAgICAgIFtcImFmLVpBXCJdOiBcImFmLVpBLUFkcmlOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImFtLUVUXCJdOiBcImFtLUVULUFtZWhhTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJhci1BRVwiXTogXCJhci1BRS1GYXRpbWFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImFyLUJIXCJdOiBcImFyLUJILUFsaU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiYXItRFpcIl06IFwiYXItRFotQW1pbmFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImFyLUVHXCJdOiBcImFyLUVHLVNhbG1hTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJhci1JUVwiXTogXCJhci1JUS1CYXNzZWxOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImFyLUpPXCJdOiBcImFyLUpPLVNhbmFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImFyLUtXXCJdOiBcImFyLUtXLUZhaGVkTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJhci1MWVwiXTogXCJhci1MWS1JbWFuTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJhci1NQVwiXTogXCJhci1NQS1KYW1hbE5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiYXItUUFcIl06IFwiYXItUUEtQW1hbE5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiYXItU0FcIl06IFwiYXItU0EtSGFtZWROZXVyYWxcIixcbiAgICAgICAgICAgIFtcImFyLVNZXCJdOiBcImFyLVNZLUFtYW55TmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJhci1UTlwiXTogXCJhci1UTi1IZWRpTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJhci1ZRVwiXTogXCJhci1ZRS1NYXJ5YW1OZXVyYWxcIixcbiAgICAgICAgICAgIFtcImJnLUJHXCJdOiBcImJnLUJHLUJvcmlzbGF2TmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJibi1CRFwiXTogXCJibi1CRC1OYWJhbml0YU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiYm4tSU5cIl06IFwiYm4tSU4tQmFzaGthck5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiY2EtRVNcIl06IFwiY2EtRVMtSm9hbmFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImNzLUNaXCJdOiBcImNzLUNaLUFudG9uaW5OZXVyYWxcIixcbiAgICAgICAgICAgIFtcImN5LUdCXCJdOiBcImN5LUdCLUFsZWROZXVyYWxcIixcbiAgICAgICAgICAgIFtcImRhLURLXCJdOiBcImRhLURLLUNocmlzdGVsTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJkZS1BVFwiXTogXCJkZS1BVC1JbmdyaWROZXVyYWxcIixcbiAgICAgICAgICAgIFtcImRlLUNIXCJdOiBcImRlLUNILUphbk5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZGUtREVcIl06IFwiZGUtREUtS2F0amFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVsLUdSXCJdOiBcImVsLUdSLUF0aGluYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZW4tQVVcIl06IFwiZW4tQVUtTmF0YXNoYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZW4tQ0FcIl06IFwiZW4tQ0EtQ2xhcmFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVuLUdCXCJdOiBcImVuLUdCLUxpYmJ5TmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlbi1IS1wiXTogXCJlbi1ISy1TYW1OZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVuLUlFXCJdOiBcImVuLUlFLUNvbm5vck5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZW4tSU5cIl06IFwiZW4tSU4tTmVlcmphTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlbi1LRVwiXTogXCJlbi1LRS1Bc2lsaWFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVuLU5HXCJdOiBcImVuLU5HLUFiZW9OZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVuLU5aXCJdOiBcImVuLU5aLU1pdGNoZWxsTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlbi1QSFwiXTogXCJlbi1QSC1KYW1lc05ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZW4tU0dcIl06IFwiZW4tU0ctTHVuYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZW4tVFpcIl06IFwiZW4tVFotRWxpbXVOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVuLVVTXCJdOiBcImVuLVVTLUplbm55TmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlbi1aQVwiXTogXCJlbi1aQS1MZWFoTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlcy1BUlwiXTogXCJlcy1BUi1FbGVuYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZXMtQk9cIl06IFwiZXMtQk8tTWFyY2Vsb05ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZXMtQ0xcIl06IFwiZXMtQ0wtQ2F0YWxpbmFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVzLUNPXCJdOiBcImVzLUNPLUdvbnphbG9OZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVzLUNSXCJdOiBcImVzLUNSLUp1YW5OZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVzLUNVXCJdOiBcImVzLUNVLUJlbGt5c05ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZXMtRE9cIl06IFwiZXMtRE8tRW1pbGlvTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlcy1FQ1wiXTogXCJlcy1FQy1BbmRyZWFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVzLUVTXCJdOiBcImVzLUVTLUFsdmFyb05ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZXMtR1FcIl06IFwiZXMtR1EtSmF2aWVyTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlcy1HVFwiXTogXCJlcy1HVC1BbmRyZXNOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVzLUhOXCJdOiBcImVzLUhOLUNhcmxvc05ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZXMtTVhcIl06IFwiZXMtTVgtRGFsaWFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVzLU5JXCJdOiBcImVzLU5JLUZlZGVyaWNvTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlcy1QQVwiXTogXCJlcy1QQS1NYXJnYXJpdGFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVzLVBFXCJdOiBcImVzLVBFLUFsZXhOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVzLVBSXCJdOiBcImVzLVBSLUthcmluYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZXMtUFlcIl06IFwiZXMtUFktTWFyaW9OZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVzLVNWXCJdOiBcImVzLVNWLUxvcmVuYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZXMtVVNcIl06IFwiZXMtVVMtQWxvbnNvTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlcy1VWVwiXTogXCJlcy1VWS1NYXRlb05ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZXMtVkVcIl06IFwiZXMtVkUtUGFvbGFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImV0LUVFXCJdOiBcImV0LUVFLUFudU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZmEtSVJcIl06IFwiZmEtSVItRGlsYXJhTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJmaS1GSVwiXTogXCJmaS1GSS1TZWxtYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZmlsLVBIXCJdOiBcImZpbC1QSC1BbmdlbG9OZXVyYWxcIixcbiAgICAgICAgICAgIFtcImZyLUJFXCJdOiBcImZyLUJFLUNoYXJsaW5lTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJmci1DQVwiXTogXCJmci1DQS1TeWx2aWVOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImZyLUNIXCJdOiBcImZyLUNILUFyaWFuZU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZnItRlJcIl06IFwiZnItRlItRGVuaXNlTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJnYS1JRVwiXTogXCJnYS1JRS1Db2xtTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJnbC1FU1wiXTogXCJnbC1FUy1Sb2lOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImd1LUlOXCJdOiBcImd1LUlOLURod2FuaU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiaGUtSUxcIl06IFwiaGUtSUwtQXZyaU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiaGktSU5cIl06IFwiaGktSU4tTWFkaHVyTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJoci1IUlwiXTogXCJoci1IUi1HYWJyaWplbGFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImh1LUhVXCJdOiBcImh1LUhVLU5vZW1pTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJpZC1JRFwiXTogXCJpZC1JRC1BcmRpTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJpcy1JU1wiXTogXCJpcy1JUy1HdWRydW5OZXVyYWxcIixcbiAgICAgICAgICAgIFtcIml0LUlUXCJdOiBcIml0LUlULUlzYWJlbGxhTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJqYS1KUFwiXTogXCJqYS1KUC1OYW5hbWlOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImp2LUlEXCJdOiBcImp2LUlELURpbWFzTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJray1LWlwiXTogXCJray1LWi1BaWd1bE5ldXJhbFwiLFxuICAgICAgICAgICAgW1wia20tS0hcIl06IFwia20tS0gtUGlzZXRoTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJrbi1JTlwiXTogXCJrbi1JTi1HYWdhbk5ldXJhbFwiLFxuICAgICAgICAgICAgW1wia28tS1JcIl06IFwia28tS1ItU3VuSGlOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImxvLUxBXCJdOiBcImxvLUxBLUNoYW50aGF2b25nTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJsdC1MVFwiXTogXCJsdC1MVC1MZW9uYXNOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImx2LUxWXCJdOiBcImx2LUxWLUV2ZXJpdGFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcIm1rLU1LXCJdOiBcIm1rLU1LLUFsZWtzYW5kYXJOZXVyYWxcIixcbiAgICAgICAgICAgIFtcIm1sLUlOXCJdOiBcIm1sLUlOLU1pZGh1bk5ldXJhbFwiLFxuICAgICAgICAgICAgW1wibXItSU5cIl06IFwibXItSU4tQWFyb2hpTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJtcy1NWVwiXTogXCJtcy1NWS1Pc21hbk5ldXJhbFwiLFxuICAgICAgICAgICAgW1wibXQtTVRcIl06IFwibXQtTVQtR3JhY2VOZXVyYWxcIixcbiAgICAgICAgICAgIFtcIm15LU1NXCJdOiBcIm15LU1NLU5pbGFyTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJuYi1OT1wiXTogXCJuYi1OTy1QZXJuaWxsZU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wibmwtQkVcIl06IFwibmwtQkUtQXJuYXVkTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJubC1OTFwiXTogXCJubC1OTC1Db2xldHRlTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJwbC1QTFwiXTogXCJwbC1QTC1BZ25pZXN6a2FOZXVyYWxcIixcbiAgICAgICAgICAgIFtcInBzLUFGXCJdOiBcInBzLUFGLUd1bE5hd2F6TmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJwdC1CUlwiXTogXCJwdC1CUi1GcmFuY2lzY2FOZXVyYWxcIixcbiAgICAgICAgICAgIFtcInB0LVBUXCJdOiBcInB0LVBULUR1YXJ0ZU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wicm8tUk9cIl06IFwicm8tUk8tQWxpbmFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcInJ1LVJVXCJdOiBcInJ1LVJVLVN2ZXRsYW5hTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJzaS1MS1wiXTogXCJzaS1MSy1TYW1lZXJhTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJzay1TS1wiXTogXCJzay1TSy1MdWthc05ldXJhbFwiLFxuICAgICAgICAgICAgW1wic2wtU0lcIl06IFwic2wtU0ktUGV0cmFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcInNvLVNPXCJdOiBcInNvLVNPLU11dXNlTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJzci1SU1wiXTogXCJzci1SUy1OaWNob2xhc05ldXJhbFwiLFxuICAgICAgICAgICAgW1wic3UtSURcIl06IFwic3UtSUQtSmFqYW5nTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJzdi1TRVwiXTogXCJzdi1TRS1Tb2ZpZU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wic3ctS0VcIl06IFwic3ctS0UtUmFmaWtpTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJzdy1UWlwiXTogXCJzdy1UWi1EYXVkaU5ldXJhbFwiLFxuICAgICAgICAgICAgW1widGEtSU5cIl06IFwidGEtSU4tUGFsbGF2aU5ldXJhbFwiLFxuICAgICAgICAgICAgW1widGEtTEtcIl06IFwidGEtTEstS3VtYXJOZXVyYWxcIixcbiAgICAgICAgICAgIFtcInRhLVNHXCJdOiBcInRhLVNHLUFuYnVOZXVyYWxcIixcbiAgICAgICAgICAgIFtcInRlLUlOXCJdOiBcInRlLUlOLU1vaGFuTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJ0aC1USFwiXTogXCJ0aC1USC1QcmVtd2FkZWVOZXVyYWxcIixcbiAgICAgICAgICAgIFtcInRyLVRSXCJdOiBcInRyLVRSLUFobWV0TmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJ1ay1VQVwiXTogXCJ1ay1VQS1Pc3RhcE5ldXJhbFwiLFxuICAgICAgICAgICAgW1widXItSU5cIl06IFwidXItSU4tR3VsTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJ1ci1QS1wiXTogXCJ1ci1QSy1Bc2FkTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJ1ei1VWlwiXTogXCJ1ei1VWi1NYWRpbmFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcInZpLVZOXCJdOiBcInZpLVZOLUhvYWlNeU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiemgtQ05cIl06IFwiemgtQ04tWGlhb3hpYW9OZXVyYWxcIixcbiAgICAgICAgICAgIFtcInpoLUhLXCJdOiBcInpoLUhLLUhpdU1hYW5OZXVyYWxcIixcbiAgICAgICAgICAgIFtcInpoLVRXXCJdOiBcInpoLVRXLUhzaWFvQ2hlbk5ldXJhbFwiLFxuICAgICAgICAgICAgW1wienUtWkFcIl06IFwienUtWkEtVGhhbmRvTmV1cmFsXCIsXG4gICAgICAgIH07XG4gICAgICAgIGxldCBsYW5ndWFnZSA9IHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1N5bnRoTGFuZ3VhZ2UsIFwiZW4tVVNcIik7XG4gICAgICAgIGxldCB2b2ljZSA9IHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1N5bnRoVm9pY2UsIFwiXCIpO1xuICAgICAgICBsZXQgc3NtbCA9IFNwZWVjaFN5bnRoZXNpemVyLlhNTEVuY29kZSh0ZXh0KTtcbiAgICAgICAgaWYgKHRoaXMuYXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlKSB7XG4gICAgICAgICAgICBsYW5ndWFnZSA9IFwiZW4tVVNcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZvaWNlID0gdm9pY2UgfHwgbGFuZ3VhZ2VUb0RlZmF1bHRWb2ljZVtsYW5ndWFnZV07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZvaWNlKSB7XG4gICAgICAgICAgICBzc21sID0gYDx2b2ljZSBuYW1lPScke3ZvaWNlfSc+JHtzc21sfTwvdm9pY2U+YDtcbiAgICAgICAgfVxuICAgICAgICBzc21sID0gYDxzcGVhayB2ZXJzaW9uPScxLjAnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3N5bnRoZXNpcycgeG1sbnM6bXN0dHM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDEvbXN0dHMnIHhtbG5zOmVtbz0naHR0cDovL3d3dy53My5vcmcvMjAwOS8xMC9lbW90aW9ubWwnIHhtbDpsYW5nPScke2xhbmd1YWdlfSc+JHtzc21sfTwvc3BlYWs+YDtcbiAgICAgICAgcmV0dXJuIHNzbWw7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGVzIHNwZWVjaCBzeW50aGVzaXMgb24gcGxhaW4gdGV4dC5cbiAgICAgKiBUaGUgdGFzayByZXR1cm5zIHRoZSBzeW50aGVzaXMgcmVzdWx0LlxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2l6ZXIucHJvdG90eXBlLnNwZWFrVGV4dEFzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB0ZXh0IC0gVGV4dCB0byBiZSBzeW50aGVzaXplZC5cbiAgICAgKiBAcGFyYW0gY2IgLSBDYWxsYmFjayB0aGF0IHJlY2VpdmVkIHRoZSBTcGVlY2hTeW50aGVzaXNSZXN1bHQuXG4gICAgICogQHBhcmFtIGVyciAtIENhbGxiYWNrIGludm9rZWQgaW4gY2FzZSBvZiBhbiBlcnJvci5cbiAgICAgKiBAcGFyYW0gc3RyZWFtIC0gQXVkaW9PdXRwdXRTdHJlYW0gdG8gcmVjZWl2ZSB0aGUgc3ludGhlc2l6ZWQgYXVkaW8uXG4gICAgICovXG4gICAgc3BlYWtUZXh0QXN5bmModGV4dCwgY2IsIGVyciwgc3RyZWFtKSB7XG4gICAgICAgIHRoaXMuc3BlYWtJbXBsKHRleHQsIGZhbHNlLCBjYiwgZXJyLCBzdHJlYW0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlcyBzcGVlY2ggc3ludGhlc2lzIG9uIFNTTUwuXG4gICAgICogVGhlIHRhc2sgcmV0dXJucyB0aGUgc3ludGhlc2lzIHJlc3VsdC5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpemVyLnByb3RvdHlwZS5zcGVha1NzbWxBc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0gc3NtbCAtIFNTTUwgdG8gYmUgc3ludGhlc2l6ZWQuXG4gICAgICogQHBhcmFtIGNiIC0gQ2FsbGJhY2sgdGhhdCByZWNlaXZlZCB0aGUgU3BlZWNoU3ludGhlc2lzUmVzdWx0LlxuICAgICAqIEBwYXJhbSBlcnIgLSBDYWxsYmFjayBpbnZva2VkIGluIGNhc2Ugb2YgYW4gZXJyb3IuXG4gICAgICogQHBhcmFtIHN0cmVhbSAtIEF1ZGlvT3V0cHV0U3RyZWFtIHRvIHJlY2VpdmUgdGhlIHN5bnRoZXNpemVkIGF1ZGlvLlxuICAgICAqL1xuICAgIHNwZWFrU3NtbEFzeW5jKHNzbWwsIGNiLCBlcnIsIHN0cmVhbSkge1xuICAgICAgICB0aGlzLnNwZWFrSW1wbChzc21sLCB0cnVlLCBjYiwgZXJyLCBzdHJlYW0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgbGlzdCBvZiBzeW50aGVzaXMgdm9pY2VzIGF2YWlsYWJsZS5cbiAgICAgKiBUaGUgdGFzayByZXR1cm5zIHRoZSBzeW50aGVzaXMgdm9pY2UgcmVzdWx0LlxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2l6ZXIucHJvdG90eXBlLmdldFZvaWNlc0FzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQGFzeW5jXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSBsb2NhbGUgLSBMb2NhbGUgb2Ygdm9pY2VzIGluIEJDUC00NyBmb3JtYXQ7IGlmIGxlZnQgZW1wdHksIGdldCBhbGwgYXZhaWxhYmxlIHZvaWNlcy5cbiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPFN5bnRoZXNpc1ZvaWNlc1Jlc3VsdD59IC0gUHJvbWlzZSBvZiBhIFN5bnRoZXNpc1ZvaWNlc1Jlc3VsdC5cbiAgICAgKi9cbiAgICBnZXRWb2ljZXNBc3luYyhsb2NhbGUgPSBcIlwiKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRWb2ljZXMobG9jYWxlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERpc3Bvc2Ugb2YgYXNzb2NpYXRlZCByZXNvdXJjZXMuXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXplci5wcm90b3R5cGUuY2xvc2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY2xvc2UoY2IsIGVycikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkRpc3Bvc2VkKTtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLmRpc3Bvc2UodHJ1ZSksIGNiLCBlcnIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBASW50ZXJuYWxcbiAgICAgKiBEbyBub3QgdXNlIGV4dGVybmFsbHksIG9iamVjdCByZXR1cm5lZCB3aWxsIGNoYW5nZSB3aXRob3V0IHdhcm5pbmcgb3Igbm90aWNlLlxuICAgICAqL1xuICAgIGdldCBpbnRlcm5hbERhdGEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBZGFwdGVyO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBwZXJmb3JtcyBjbGVhbnVwIG9mIHJlc291cmNlcy5cbiAgICAgKiBUaGUgQm9vbGVhbiBwYXJhbWV0ZXIgZGlzcG9zaW5nIGluZGljYXRlcyB3aGV0aGVyIHRoZSBtZXRob2QgaXMgY2FsbGVkXG4gICAgICogZnJvbSBEaXNwb3NlIChpZiBkaXNwb3NpbmcgaXMgdHJ1ZSkgb3IgZnJvbSB0aGUgZmluYWxpemVyIChpZiBkaXNwb3NpbmcgaXMgZmFsc2UpLlxuICAgICAqIERlcml2ZWQgY2xhc3NlcyBzaG91bGQgb3ZlcnJpZGUgdGhpcyBtZXRob2QgdG8gZGlzcG9zZSByZXNvdXJjZSBpZiBuZWVkZWQuXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXplci5wcm90b3R5cGUuZGlzcG9zZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGRpc3Bvc2luZyAtIEZsYWcgdG8gcmVxdWVzdCBkaXNwb3NhbC5cbiAgICAgKi9cbiAgICBkaXNwb3NlKGRpc3Bvc2luZykge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdkRpc3Bvc2VkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRpc3Bvc2luZykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnByaXZBZGFwdGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdkFkYXB0ZXIuZGlzcG9zZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucHJpdkRpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8vXG4gICAgLy8gIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI1xuICAgIC8vIElNUExFTUVOVEFUSU9OLlxuICAgIC8vIE1vdmUgdG8gaW5kZXBlbmRlbnQgY2xhc3NcbiAgICAvLyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjXG4gICAgLy9cbiAgICBjcmVhdGVTeW50aGVzaXplckNvbmZpZyhzcGVlY2hDb25maWcpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTeW50aGVzaXplckNvbmZpZyhzcGVlY2hDb25maWcsIHRoaXMucHJpdlByb3BlcnRpZXMpO1xuICAgIH1cbiAgICAvLyBDcmVhdGVzIHRoZSBzeW50aGVzaXMgYWRhcHRlclxuICAgIGNyZWF0ZVN5bnRoZXNpc0FkYXB0ZXIoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb0NvbmZpZywgc3ludGhlc2l6ZXJDb25maWcpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTeW50aGVzaXNBZGFwdGVyQmFzZShhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIHN5bnRoZXNpemVyQ29uZmlnLCB0aGlzLCB0aGlzLmF1ZGlvQ29uZmlnKTtcbiAgICB9XG4gICAgaW1wbENvbW1vblN5bnRoZXNpemVTZXR1cCgpIHtcbiAgICAgICAgbGV0IG9zUGxhdGZvcm0gPSAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikgPyBcIkJyb3dzZXJcIiA6IFwiTm9kZVwiO1xuICAgICAgICBsZXQgb3NOYW1lID0gXCJ1bmtub3duXCI7XG4gICAgICAgIGxldCBvc1ZlcnNpb24gPSBcInVua25vd25cIjtcbiAgICAgICAgaWYgKHR5cGVvZiBuYXZpZ2F0b3IgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIG9zUGxhdGZvcm0gPSBvc1BsYXRmb3JtICsgXCIvXCIgKyBuYXZpZ2F0b3IucGxhdGZvcm07XG4gICAgICAgICAgICBvc05hbWUgPSBuYXZpZ2F0b3IudXNlckFnZW50O1xuICAgICAgICAgICAgb3NWZXJzaW9uID0gbmF2aWdhdG9yLmFwcFZlcnNpb247XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc3ludGhlc2l6ZXJDb25maWcgPSB0aGlzLmNyZWF0ZVN5bnRoZXNpemVyQ29uZmlnKG5ldyBTcGVlY2hTZXJ2aWNlQ29uZmlnKG5ldyBDb250ZXh0KG5ldyBPUyhvc1BsYXRmb3JtLCBvc05hbWUsIG9zVmVyc2lvbikpKSk7XG4gICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbktleSA9IHRoaXMucHJpdlByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9LZXksIHVuZGVmaW5lZCk7XG4gICAgICAgIGNvbnN0IGF1dGhlbnRpY2F0aW9uID0gKHN1YnNjcmlwdGlvbktleSAmJiBzdWJzY3JpcHRpb25LZXkgIT09IFwiXCIpID9cbiAgICAgICAgICAgIG5ldyBDb2duaXRpdmVTdWJzY3JpcHRpb25LZXlBdXRoZW50aWNhdGlvbihzdWJzY3JpcHRpb25LZXkpIDpcbiAgICAgICAgICAgIG5ldyBDb2duaXRpdmVUb2tlbkF1dGhlbnRpY2F0aW9uKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBhdXRob3JpemF0aW9uVG9rZW4gPSB0aGlzLnByaXZQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW4sIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShhdXRob3JpemF0aW9uVG9rZW4pO1xuICAgICAgICAgICAgfSwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGF1dGhvcml6YXRpb25Ub2tlbiA9IHRoaXMucHJpdlByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbiwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGF1dGhvcml6YXRpb25Ub2tlbik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wcml2QWRhcHRlciA9IHRoaXMuY3JlYXRlU3ludGhlc2lzQWRhcHRlcihhdXRoZW50aWNhdGlvbiwgdGhpcy5wcml2Q29ubmVjdGlvbkZhY3RvcnksIHRoaXMuYXVkaW9Db25maWcsIHN5bnRoZXNpemVyQ29uZmlnKTtcbiAgICAgICAgdGhpcy5wcml2QWRhcHRlci5hdWRpb091dHB1dEZvcm1hdCA9IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbC5mcm9tU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0KFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFt0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9TeW50aE91dHB1dEZvcm1hdCwgdW5kZWZpbmVkKV0pO1xuICAgICAgICB0aGlzLnByaXZSZXN0QWRhcHRlciA9IG5ldyBTeW50aGVzaXNSZXN0QWRhcHRlcihzeW50aGVzaXplckNvbmZpZywgYXV0aGVudGljYXRpb24pO1xuICAgIH1cbiAgICBzcGVha0ltcGwodGV4dCwgSXNTc21sLCBjYiwgZXJyLCBkYXRhU3RyZWFtKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkRpc3Bvc2VkKTtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RJZCA9IGNyZWF0ZU5vRGFzaEd1aWQoKTtcbiAgICAgICAgICAgIGxldCBhdWRpb0Rlc3RpbmF0aW9uO1xuICAgICAgICAgICAgaWYgKGRhdGFTdHJlYW0gaW5zdGFuY2VvZiBQdXNoQXVkaW9PdXRwdXRTdHJlYW1DYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGF1ZGlvRGVzdGluYXRpb24gPSBuZXcgUHVzaEF1ZGlvT3V0cHV0U3RyZWFtSW1wbChkYXRhU3RyZWFtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGRhdGFTdHJlYW0gaW5zdGFuY2VvZiBQdWxsQXVkaW9PdXRwdXRTdHJlYW0pIHtcbiAgICAgICAgICAgICAgICBhdWRpb0Rlc3RpbmF0aW9uID0gZGF0YVN0cmVhbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGRhdGFTdHJlYW0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGF1ZGlvRGVzdGluYXRpb24gPSBuZXcgQXVkaW9GaWxlV3JpdGVyKGRhdGFTdHJlYW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYXVkaW9EZXN0aW5hdGlvbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc3ludGhlc2lzUmVxdWVzdFF1ZXVlLmVucXVldWUobmV3IFN5bnRoZXNpc1JlcXVlc3QocmVxdWVzdElkLCB0ZXh0LCBJc1NzbWwsIChlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U3ludGhlc2l6aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKCEhY2IpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNiKGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISFlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnIoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2IgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgICAgICB0aGlzLmFkYXB0ZXJTcGVhaygpLmNhdGNoKCgpID0+IHsgfSk7XG4gICAgICAgICAgICB9LCAoZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgICAgICBlcnIoZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgYXVkaW9EZXN0aW5hdGlvbikpO1xuICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHktZnVuY3Rpb24gKi9cbiAgICAgICAgICAgIHRoaXMuYWRhcHRlclNwZWFrKCkuY2F0Y2goKCkgPT4geyB9KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHR5cGVkRXJyb3IgPSBlcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgZXJyKHR5cGVkRXJyb3IubmFtZSArIFwiOiBcIiArIHR5cGVkRXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlcnIoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIERlc3Ryb3kgdGhlIHN5bnRoZXNpemVyLlxuICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgIHRoaXMuZGlzcG9zZSh0cnVlKS5jYXRjaCgoKSA9PiB7IH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldFZvaWNlcyhsb2NhbGUpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RJZCA9IGNyZWF0ZU5vRGFzaEd1aWQoKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0geWllbGQgdGhpcy5wcml2UmVzdEFkYXB0ZXIuZ2V0Vm9pY2VzTGlzdChyZXF1ZXN0SWQpO1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLm9rICYmIEFycmF5LmlzQXJyYXkocmVzcG9uc2UuanNvbikpIHtcbiAgICAgICAgICAgICAgICBsZXQganNvbiA9IHJlc3BvbnNlLmpzb247XG4gICAgICAgICAgICAgICAgaWYgKCEhbG9jYWxlICYmIGxvY2FsZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGpzb24gPSBqc29uLmZpbHRlcigoaXRlbSkgPT4gISFpdGVtLkxvY2FsZSAmJiBpdGVtLkxvY2FsZS50b0xvd2VyQ2FzZSgpID09PSBsb2NhbGUudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU3ludGhlc2lzVm9pY2VzUmVzdWx0KHJlcXVlc3RJZCwganNvbiwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU3ludGhlc2lzVm9pY2VzUmVzdWx0KHJlcXVlc3RJZCwgdW5kZWZpbmVkLCBgRXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfTogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgYWRhcHRlclNwZWFrKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZEaXNwb3NlZCAmJiAhdGhpcy5wcml2U3ludGhlc2l6aW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U3ludGhlc2l6aW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb25zdCByZXF1ZXN0ID0geWllbGQgdGhpcy5zeW50aGVzaXNSZXF1ZXN0UXVldWUuZGVxdWV1ZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZBZGFwdGVyLlNwZWFrKHJlcXVlc3QudGV4dCwgcmVxdWVzdC5pc1NTTUwsIHJlcXVlc3QucmVxdWVzdElkLCByZXF1ZXN0LmNiLCByZXF1ZXN0LmVyciwgcmVxdWVzdC5kYXRhU3RyZWFtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHN0YXRpYyBYTUxFbmNvZGUodGV4dCkge1xuICAgICAgICByZXR1cm4gdGV4dC5yZXBsYWNlKC8mL2csIFwiJmFtcDtcIilcbiAgICAgICAgICAgIC5yZXBsYWNlKC88L2csIFwiJmx0O1wiKVxuICAgICAgICAgICAgLnJlcGxhY2UoLz4vZywgXCImZ3Q7XCIpXG4gICAgICAgICAgICAucmVwbGFjZSgvXCIvZywgXCImcXVvdDtcIilcbiAgICAgICAgICAgIC5yZXBsYWNlKC8nL2csIFwiJmFwb3M7XCIpO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBTeW50aGVzaXNSZXF1ZXN0IHtcbiAgICBjb25zdHJ1Y3RvcihyZXF1ZXN0SWQsIHRleHQsIGlzU1NNTCwgY2IsIGVyciwgZGF0YVN0cmVhbSkge1xuICAgICAgICB0aGlzLnJlcXVlc3RJZCA9IHJlcXVlc3RJZDtcbiAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDtcbiAgICAgICAgdGhpcy5pc1NTTUwgPSBpc1NTTUw7XG4gICAgICAgIHRoaXMuY2IgPSBjYjtcbiAgICAgICAgdGhpcy5lcnIgPSBlcnI7XG4gICAgICAgIHRoaXMuZGF0YVN0cmVhbSA9IGRhdGFTdHJlYW07XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TcGVlY2hTeW50aGVzaXplci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyogZXNsaW50LWRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGUgKi9cbmltcG9ydCB7IEZvcmNlRGljdGF0aW9uUHJvcGVydHlOYW1lLCBPdXRwdXRGb3JtYXRQcm9wZXJ0eU5hbWUsIFNlcnZpY2VQcm9wZXJ0aWVzUHJvcGVydHlOYW1lIH0gZnJvbSBcIi4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBPdXRwdXRGb3JtYXQsIFByb2Zhbml0eU9wdGlvbiwgUHJvcGVydHlDb2xsZWN0aW9uLCBQcm9wZXJ0eUlkLCBTcGVlY2hDb25maWcsIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdCwgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIFNwZWVjaCB0cmFuc2xhdGlvbiBjb25maWd1cmF0aW9uLlxuICogQGNsYXNzIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnXG4gKi9cbmV4cG9ydCBjbGFzcyBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZyBleHRlbmRzIFNwZWVjaENvbmZpZyB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiByZWNvZ25pemVyIGNvbmZpZy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RhdGljIGluc3RhbmNlIG9mIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnIHJldHVybmVkIGJ5IHBhc3NpbmcgYSBzdWJzY3JpcHRpb24ga2V5IGFuZCBzZXJ2aWNlIHJlZ2lvbi5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnLmZyb21TdWJzY3JpcHRpb25cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHN1YnNjcmlwdGlvbktleSAtIFRoZSBzdWJzY3JpcHRpb24ga2V5LlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZWdpb24gLSBUaGUgcmVnaW9uIG5hbWUgKHNlZSB0aGUgPGEgaHJlZj1cImh0dHBzOi8vYWthLm1zL2Nzc3BlZWNoL3JlZ2lvblwiPnJlZ2lvbiBwYWdlPC9hPikuXG4gICAgICogQHJldHVybnMge1NwZWVjaFRyYW5zbGF0aW9uQ29uZmlnfSBUaGUgc3BlZWNoIHRyYW5zbGF0aW9uIGNvbmZpZy5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbVN1YnNjcmlwdGlvbihzdWJzY3JpcHRpb25LZXksIHJlZ2lvbikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2Uoc3Vic2NyaXB0aW9uS2V5LCBcInN1YnNjcmlwdGlvbktleVwiKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHJlZ2lvbiwgXCJyZWdpb25cIik7XG4gICAgICAgIGNvbnN0IHJldCA9IG5ldyBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwoKTtcbiAgICAgICAgcmV0LnByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9LZXksIHN1YnNjcmlwdGlvbktleSk7XG4gICAgICAgIHJldC5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVnaW9uLCByZWdpb24pO1xuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGF0aWMgaW5zdGFuY2Ugb2YgU3BlZWNoVHJhbnNsYXRpb25Db25maWcgcmV0dXJuZWQgYnkgcGFzc2luZyBhdXRob3JpemF0aW9uIHRva2VuIGFuZCBzZXJ2aWNlIHJlZ2lvbi5cbiAgICAgKiBOb3RlOiBUaGUgY2FsbGVyIG5lZWRzIHRvIGVuc3VyZSB0aGF0IHRoZSBhdXRob3JpemF0aW9uIHRva2VuIGlzIHZhbGlkLiBCZWZvcmUgdGhlIGF1dGhvcml6YXRpb24gdG9rZW5cbiAgICAgKiBleHBpcmVzLCB0aGUgY2FsbGVyIG5lZWRzIHRvIHJlZnJlc2ggaXQgYnkgc2V0dGluZyB0aGUgcHJvcGVydHkgYXV0aG9yaXphdGlvblRva2VuIHdpdGggYSBuZXdcbiAgICAgKiB2YWxpZCB0b2tlbi4gT3RoZXJ3aXNlLCBhbGwgdGhlIHJlY29nbml6ZXJzIGNyZWF0ZWQgYnkgdGhpcyBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZyBpbnN0YW5jZVxuICAgICAqIHdpbGwgZW5jb3VudGVyIGVycm9ycyBkdXJpbmcgcmVjb2duaXRpb24uXG4gICAgICogQXMgY29uZmlndXJhdGlvbiB2YWx1ZXMgYXJlIGNvcGllZCB3aGVuIGNyZWF0aW5nIGEgbmV3IHJlY29nbml6ZXIsIHRoZSBuZXcgdG9rZW4gdmFsdWUgd2lsbCBub3QgYXBwbHlcbiAgICAgKiB0byByZWNvZ25pemVycyB0aGF0IGhhdmUgYWxyZWFkeSBiZWVuIGNyZWF0ZWQuXG4gICAgICogRm9yIHJlY29nbml6ZXJzIHRoYXQgaGF2ZSBiZWVuIGNyZWF0ZWQgYmVmb3JlLCB5b3UgbmVlZCB0byBzZXQgYXV0aG9yaXphdGlvbiB0b2tlbiBvZiB0aGUgY29ycmVzcG9uZGluZyByZWNvZ25pemVyXG4gICAgICogdG8gcmVmcmVzaCB0aGUgdG9rZW4uIE90aGVyd2lzZSwgdGhlIHJlY29nbml6ZXJzIHdpbGwgZW5jb3VudGVyIGVycm9ycyBkdXJpbmcgcmVjb2duaXRpb24uXG4gICAgICogQG1lbWJlciBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZy5mcm9tQXV0aG9yaXphdGlvblRva2VuXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhdXRob3JpemF0aW9uVG9rZW4gLSBUaGUgYXV0aG9yaXphdGlvbiB0b2tlbi5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcmVnaW9uIC0gVGhlIHJlZ2lvbiBuYW1lIChzZWUgdGhlIDxhIGhyZWY9XCJodHRwczovL2FrYS5tcy9jc3NwZWVjaC9yZWdpb25cIj5yZWdpb24gcGFnZTwvYT4pLlxuICAgICAqIEByZXR1cm5zIHtTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ30gVGhlIHNwZWVjaCB0cmFuc2xhdGlvbiBjb25maWcuXG4gICAgICovXG4gICAgc3RhdGljIGZyb21BdXRob3JpemF0aW9uVG9rZW4oYXV0aG9yaXphdGlvblRva2VuLCByZWdpb24pIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKGF1dGhvcml6YXRpb25Ub2tlbiwgXCJhdXRob3JpemF0aW9uVG9rZW5cIik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShyZWdpb24sIFwicmVnaW9uXCIpO1xuICAgICAgICBjb25zdCByZXQgPSBuZXcgU3BlZWNoVHJhbnNsYXRpb25Db25maWdJbXBsKCk7XG4gICAgICAgIHJldC5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW4sIGF1dGhvcml6YXRpb25Ub2tlbik7XG4gICAgICAgIHJldC5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVnaW9uLCByZWdpb24pO1xuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIHRoZSBzcGVlY2ggY29uZmlnIHdpdGggc3BlY2lmaWVkIGhvc3QgYW5kIHN1YnNjcmlwdGlvbiBrZXkuXG4gICAgICogVGhpcyBtZXRob2QgaXMgaW50ZW5kZWQgb25seSBmb3IgdXNlcnMgd2hvIHVzZSBhIG5vbi1kZWZhdWx0IHNlcnZpY2UgaG9zdC4gU3RhbmRhcmQgcmVzb3VyY2UgcGF0aCB3aWxsIGJlIGFzc3VtZWQuXG4gICAgICogRm9yIHNlcnZpY2VzIHdpdGggYSBub24tc3RhbmRhcmQgcmVzb3VyY2UgcGF0aCBvciBubyBwYXRoIGF0IGFsbCwgdXNlIGZyb21FbmRwb2ludCBpbnN0ZWFkLlxuICAgICAqIE5vdGU6IFF1ZXJ5IHBhcmFtZXRlcnMgYXJlIG5vdCBhbGxvd2VkIGluIHRoZSBob3N0IFVSSSBhbmQgbXVzdCBiZSBzZXQgYnkgb3RoZXIgQVBJcy5cbiAgICAgKiBOb3RlOiBUbyB1c2UgYW4gYXV0aG9yaXphdGlvbiB0b2tlbiB3aXRoIGZyb21Ib3N0LCB1c2UgZnJvbUhvc3QoVVJMKSxcbiAgICAgKiBhbmQgdGhlbiBzZXQgdGhlIEF1dGhvcml6YXRpb25Ub2tlbiBwcm9wZXJ0eSBvbiB0aGUgY3JlYXRlZCBTcGVlY2hDb25maWcgaW5zdGFuY2UuXG4gICAgICogTm90ZTogQWRkZWQgaW4gdmVyc2lvbiAxLjkuMC5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaENvbmZpZy5mcm9tSG9zdFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge1VSTH0gaG9zdCAtIFRoZSBzZXJ2aWNlIGVuZHBvaW50IHRvIGNvbm5lY3QgdG8uIEZvcm1hdCBpcyBcInByb3RvY29sOi8vaG9zdDpwb3J0XCIgd2hlcmUgXCI6cG9ydFwiIGlzIG9wdGlvbmFsLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzdWJzY3JpcHRpb25LZXkgLSBUaGUgc3Vic2NyaXB0aW9uIGtleS4gSWYgYSBzdWJzY3JpcHRpb24ga2V5IGlzIG5vdCBzcGVjaWZpZWQsIGFuIGF1dGhvcml6YXRpb24gdG9rZW4gbXVzdCBiZSBzZXQuXG4gICAgICogQHJldHVybnMge1NwZWVjaENvbmZpZ30gQSBzcGVlY2ggZmFjdG9yeSBpbnN0YW5jZS5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbUhvc3QoaG9zdE5hbWUsIHN1YnNjcmlwdGlvbktleSkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGwoaG9zdE5hbWUsIFwiaG9zdE5hbWVcIik7XG4gICAgICAgIGNvbnN0IHNwZWVjaEltcGwgPSBuZXcgU3BlZWNoVHJhbnNsYXRpb25Db25maWdJbXBsKCk7XG4gICAgICAgIHNwZWVjaEltcGwuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Ib3N0LCBob3N0TmFtZS5wcm90b2NvbCArIFwiLy9cIiArIGhvc3ROYW1lLmhvc3RuYW1lICsgKGhvc3ROYW1lLnBvcnQgPT09IFwiXCIgPyBcIlwiIDogXCI6XCIgKyBob3N0TmFtZS5wb3J0KSk7XG4gICAgICAgIGlmICh1bmRlZmluZWQgIT09IHN1YnNjcmlwdGlvbktleSkge1xuICAgICAgICAgICAgc3BlZWNoSW1wbC5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0tleSwgc3Vic2NyaXB0aW9uS2V5KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3BlZWNoSW1wbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiB0aGUgc3BlZWNoIHRyYW5zbGF0aW9uIGNvbmZpZyB3aXRoIHNwZWNpZmllZCBlbmRwb2ludCBhbmQgc3Vic2NyaXB0aW9uIGtleS5cbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBvbmx5IGZvciB1c2VycyB3aG8gdXNlIGEgbm9uLXN0YW5kYXJkIHNlcnZpY2UgZW5kcG9pbnQgb3IgcGFyYW10ZXJzLlxuICAgICAqIE5vdGU6IFRoZSBxdWVyeSBwcm9wZXJ0aWVzIHNwZWNpZmllZCBpbiB0aGUgZW5kcG9pbnQgVVJMIGFyZSBub3QgY2hhbmdlZCwgZXZlbiBpZiB0aGV5IGFyZVxuICAgICAqIHNldCBieSBhbnkgb3RoZXIgQVBJcy4gRm9yIGV4YW1wbGUsIGlmIGxhbmd1YWdlIGlzIGRlZmluZWQgaW4gdGhlIHVyaSBhcyBxdWVyeSBwYXJhbWV0ZXJcbiAgICAgKiBcImxhbmd1YWdlPWRlLURFXCIsIGFuZCBhbHNvIHNldCBieSB0aGUgc3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZSBwcm9wZXJ0eSwgdGhlIGxhbmd1YWdlXG4gICAgICogc2V0dGluZyBpbiB1cmkgdGFrZXMgcHJlY2VkZW5jZSwgYW5kIHRoZSBlZmZlY3RpdmUgbGFuZ3VhZ2UgaXMgXCJkZS1ERVwiLlxuICAgICAqIE9ubHkgdGhlIHByb3BlcnRpZXMgdGhhdCBhcmUgbm90IHNwZWNpZmllZCBpbiB0aGUgZW5kcG9pbnQgVVJMIGNhbiBiZSBzZXQgYnkgb3RoZXIgQVBJcy5cbiAgICAgKiBOb3RlOiBUbyB1c2UgYXV0aG9yaXphdGlvbiB0b2tlbiB3aXRoIGZyb21FbmRwb2ludCwgcGFzcyBhbiBlbXB0eSBzdHJpbmcgdG8gdGhlIHN1YnNjcmlwdGlvbktleSBpbiB0aGVcbiAgICAgKiBmcm9tRW5kcG9pbnQgbWV0aG9kLCBhbmQgdGhlbiBzZXQgYXV0aG9yaXphdGlvblRva2VuPVwidG9rZW5cIiBvbiB0aGUgY3JlYXRlZCBTcGVlY2hDb25maWcgaW5zdGFuY2UgdG9cbiAgICAgKiB1c2UgdGhlIGF1dGhvcml6YXRpb24gdG9rZW4uXG4gICAgICogQG1lbWJlciBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZy5mcm9tRW5kcG9pbnRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtVUkx9IGVuZHBvaW50IC0gVGhlIHNlcnZpY2UgZW5kcG9pbnQgdG8gY29ubmVjdCB0by5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc3Vic2NyaXB0aW9uS2V5IC0gVGhlIHN1YnNjcmlwdGlvbiBrZXkuXG4gICAgICogQHJldHVybnMge1NwZWVjaFRyYW5zbGF0aW9uQ29uZmlnfSBBIHNwZWVjaCBjb25maWcgaW5zdGFuY2UuXG4gICAgICovXG4gICAgc3RhdGljIGZyb21FbmRwb2ludChlbmRwb2ludCwgc3Vic2NyaXB0aW9uS2V5KSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbChlbmRwb2ludCwgXCJlbmRwb2ludFwiKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsKHN1YnNjcmlwdGlvbktleSwgXCJzdWJzY3JpcHRpb25LZXlcIik7XG4gICAgICAgIGNvbnN0IHJldCA9IG5ldyBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwoKTtcbiAgICAgICAgcmV0LnByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludCwgZW5kcG9pbnQuaHJlZik7XG4gICAgICAgIHJldC5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fS2V5LCBzdWJzY3JpcHRpb25LZXkpO1xuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH1cbn1cbi8qKlxuICogQHByaXZhdGVcbiAqIEBjbGFzcyBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGxcbiAqL1xuZXhwb3J0IGNsYXNzIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbCBleHRlbmRzIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoUHJvcGVydGllcyA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICAgICAgdGhpcy5vdXRwdXRGb3JtYXQgPSBPdXRwdXRGb3JtYXQuU2ltcGxlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzL1NldHMgdGhlIGF1dGhvcml6YXRpb24gdG9rZW4uXG4gICAgICogSWYgdGhpcyBpcyBzZXQsIHN1YnNjcmlwdGlvbiBrZXkgaXMgaWdub3JlZC5cbiAgICAgKiBVc2VyIG5lZWRzIHRvIG1ha2Ugc3VyZSB0aGUgcHJvdmlkZWQgYXV0aG9yaXphdGlvbiB0b2tlbiBpcyB2YWxpZCBhbmQgbm90IGV4cGlyZWQuXG4gICAgICogQG1lbWJlciBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwucHJvdG90eXBlLmF1dGhvcml6YXRpb25Ub2tlblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgLSBUaGUgYXV0aG9yaXphdGlvbiB0b2tlbi5cbiAgICAgKi9cbiAgICBzZXQgYXV0aG9yaXphdGlvblRva2VuKHZhbHVlKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh2YWx1ZSwgXCJ2YWx1ZVwiKTtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuLCB2YWx1ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIHNwZWVjaCByZWNvZ25pdGlvbiBsYW5ndWFnZS5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbC5wcm90b3R5cGUuc3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgLSBUaGUgYXV0aG9yaXphdGlvbiB0b2tlbi5cbiAgICAgKi9cbiAgICBzZXQgc3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZSh2YWx1ZSkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodmFsdWUsIFwidmFsdWVcIik7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaFByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTGFuZ3VhZ2UsIHZhbHVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgc3BlZWNoIHJlY29nbml0aW9uIGxhbmd1YWdlLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoVHJhbnNsYXRpb25Db25maWdJbXBsLnByb3RvdHlwZS5zcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm4ge3N0cmluZ30gVGhlIHNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2UuXG4gICAgICovXG4gICAgZ2V0IHNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWRbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTGFuZ3VhZ2VdKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQG1lbWJlciBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwucHJvdG90eXBlLnN1YnNjcmlwdGlvbktleVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBnZXQgc3Vic2NyaXB0aW9uS2V5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fS2V5XSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIG91dHB1dCBmb3JtYXRcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbC5wcm90b3R5cGUub3V0cHV0Rm9ybWF0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGdldCBvdXRwdXRGb3JtYXQoKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgICAgICByZXR1cm4gT3V0cHV0Rm9ybWF0W3RoaXMucHJpdlNwZWVjaFByb3BlcnRpZXMuZ2V0UHJvcGVydHkoT3V0cHV0Rm9ybWF0UHJvcGVydHlOYW1lLCB1bmRlZmluZWQpXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cy9TZXRzIHRoZSBvdXRwdXQgZm9ybWF0XG4gICAgICogQG1lbWJlciBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwucHJvdG90eXBlLm91dHB1dEZvcm1hdFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBzZXQgb3V0cHV0Rm9ybWF0KHZhbHVlKSB7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaFByb3BlcnRpZXMuc2V0UHJvcGVydHkoT3V0cHV0Rm9ybWF0UHJvcGVydHlOYW1lLCBPdXRwdXRGb3JtYXRbdmFsdWVdKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgZW5kcG9pbnQgaWQuXG4gICAgICogQG1lbWJlciBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwucHJvdG90eXBlLmVuZHBvaW50SWRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgZ2V0IGVuZHBvaW50SWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnRJZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMvU2V0cyB0aGUgZW5kcG9pbnQgaWQuXG4gICAgICogQG1lbWJlciBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwucHJvdG90eXBlLmVuZHBvaW50SWRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgc2V0IGVuZHBvaW50SWQodmFsdWUpIHtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50SWQsIHZhbHVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkIGEgKHRleHQpIHRhcmdldCBsYW5ndWFnZSB0byB0cmFuc2xhdGUgaW50by5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbC5wcm90b3R5cGUuYWRkVGFyZ2V0TGFuZ3VhZ2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlIC0gVGhlIGxhbmd1YWdlIHN1Y2ggYXMgZGUtREVcbiAgICAgKi9cbiAgICBhZGRUYXJnZXRMYW5ndWFnZSh2YWx1ZSkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodmFsdWUsIFwidmFsdWVcIik7XG4gICAgICAgIGNvbnN0IGxhbmd1YWdlcyA9IHRoaXMudGFyZ2V0TGFuZ3VhZ2VzO1xuICAgICAgICBsYW5ndWFnZXMucHVzaCh2YWx1ZSk7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaFByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvblRvTGFuZ3VhZ2VzLCBsYW5ndWFnZXMuam9pbihcIixcIikpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSAodGV4dCkgdGFyZ2V0IGxhbmd1YWdlIHRvIHRyYW5zbGF0ZSBpbnRvLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoVHJhbnNsYXRpb25Db25maWdJbXBsLnByb3RvdHlwZS50YXJnZXRMYW5ndWFnZXNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlIC0gVGhlIGxhbmd1YWdlIHN1Y2ggYXMgZGUtREVcbiAgICAgKi9cbiAgICBnZXQgdGFyZ2V0TGFuZ3VhZ2VzKCkge1xuICAgICAgICBpZiAodGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uVG9MYW5ndWFnZXMsIHVuZGVmaW5lZCkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaFByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvblRvTGFuZ3VhZ2VzKS5zcGxpdChcIixcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgdm9pY2UgbmFtZS5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbC5wcm90b3R5cGUudm9pY2VOYW1lXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGdldCB2b2ljZU5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFByb3BlcnR5KFByb3BlcnR5SWRbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvblZvaWNlXSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMvU2V0cyB0aGUgdm9pY2Ugb2YgdGhlIHRyYW5zbGF0ZWQgbGFuZ3VhZ2UsIGVuYWJsZSB2b2ljZSBzeW50aGVzaXMgb3V0cHV0LlxuICAgICAqIEBtZW1iZXIgU3BlZWNoVHJhbnNsYXRpb25Db25maWdJbXBsLnByb3RvdHlwZS52b2ljZU5hbWVcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlIC0gVGhlIG5hbWUgb2YgdGhlIHZvaWNlLlxuICAgICAqL1xuICAgIHNldCB2b2ljZU5hbWUodmFsdWUpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHZhbHVlLCBcInZhbHVlXCIpO1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVHJhbnNsYXRpb25Wb2ljZSwgdmFsdWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcm92aWRlcyB0aGUgcmVnaW9uLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoVHJhbnNsYXRpb25Db25maWdJbXBsLnByb3RvdHlwZS5yZWdpb25cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ30gVGhlIHJlZ2lvbi5cbiAgICAgKi9cbiAgICBnZXQgcmVnaW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlZ2lvbik7XG4gICAgfVxuICAgIHNldFByb3h5KHByb3h5SG9zdE5hbWUsIHByb3h5UG9ydCwgcHJveHlVc2VyTmFtZSwgcHJveHlQYXNzd29yZCkge1xuICAgICAgICB0aGlzLnNldFByb3BlcnR5KFByb3BlcnR5SWRbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Qcm94eUhvc3ROYW1lXSwgcHJveHlIb3N0TmFtZSk7XG4gICAgICAgIHRoaXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5UG9ydF0sIHByb3h5UG9ydCk7XG4gICAgICAgIHRoaXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5VXNlck5hbWVdLCBwcm94eVVzZXJOYW1lKTtcbiAgICAgICAgdGhpcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUHJveHlQYXNzd29yZF0sIHByb3h5UGFzc3dvcmQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIGFuIGFyYml0cmFyeSBwcm9wZXJ0eSB2YWx1ZS5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbC5wcm90b3R5cGUuZ2V0UHJvcGVydHlcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgLSBUaGUgbmFtZSBvZiB0aGUgcHJvcGVydHkuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGRlZiAtIFRoZSBkZWZhdWx0IHZhbHVlIG9mIHRoZSBwcm9wZXJ0eSBpbiBjYXNlIGl0IGlzIG5vdCBzZXQuXG4gICAgICogQHJldHVybnMge3N0cmluZ30gVGhlIHZhbHVlIG9mIHRoZSBwcm9wZXJ0eS5cbiAgICAgKi9cbiAgICBnZXRQcm9wZXJ0eShuYW1lLCBkZWYpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaFByb3BlcnRpZXMuZ2V0UHJvcGVydHkobmFtZSwgZGVmKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cy9TZXRzIGFuIGFyYml0cmFyeSBwcm9wZXJ0eSB2YWx1ZS5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbC5wcm90b3R5cGUuc2V0UHJvcGVydHlcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmcgfCBQcm9wZXJ0eUlkfSBuYW1lIC0gVGhlIG5hbWUgb2YgdGhlIHByb3BlcnR5IHRvIHNldC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgLSBUaGUgdmFsdWUgb2YgdGhlIHByb3BlcnR5LlxuICAgICAqL1xuICAgIHNldFByb3BlcnR5KG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaFByb3BlcnRpZXMuc2V0UHJvcGVydHkobmFtZSwgdmFsdWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcm92aWRlcyBhY2Nlc3MgdG8gY3VzdG9tIHByb3BlcnRpZXMuXG4gICAgICogQG1lbWJlciBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwucHJvdG90eXBlLnByb3BlcnRpZXNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1Byb3BlcnR5Q29sbGVjdGlvbn0gVGhlIHByb3BlcnRpZXMuXG4gICAgICovXG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hQcm9wZXJ0aWVzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEaXNwb3NlIG9mIGFzc29jaWF0ZWQgcmVzb3VyY2VzLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoVHJhbnNsYXRpb25Db25maWdJbXBsLnByb3RvdHlwZS5jbG9zZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBzZXRTZXJ2aWNlUHJvcGVydHkobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgY29uc3QgY3VycmVudFByb3BlcnRpZXMgPSBKU09OLnBhcnNlKHRoaXMucHJpdlNwZWVjaFByb3BlcnRpZXMuZ2V0UHJvcGVydHkoU2VydmljZVByb3BlcnRpZXNQcm9wZXJ0eU5hbWUsIFwie31cIikpO1xuICAgICAgICBjdXJyZW50UHJvcGVydGllc1tuYW1lXSA9IHZhbHVlO1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFNlcnZpY2VQcm9wZXJ0aWVzUHJvcGVydHlOYW1lLCBKU09OLnN0cmluZ2lmeShjdXJyZW50UHJvcGVydGllcykpO1xuICAgIH1cbiAgICBzZXRQcm9mYW5pdHkocHJvZmFuaXR5KSB7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaFByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUHJvZmFuaXR5T3B0aW9uLCBQcm9mYW5pdHlPcHRpb25bcHJvZmFuaXR5XSk7XG4gICAgfVxuICAgIGVuYWJsZUF1ZGlvTG9nZ2luZygpIHtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuYWJsZUF1ZGlvTG9nZ2luZywgXCJ0cnVlXCIpO1xuICAgIH1cbiAgICByZXF1ZXN0V29yZExldmVsVGltZXN0YW1wcygpIHtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9SZXF1ZXN0V29yZExldmVsVGltZXN0YW1wcywgXCJ0cnVlXCIpO1xuICAgIH1cbiAgICBlbmFibGVEaWN0YXRpb24oKSB7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaFByb3BlcnRpZXMuc2V0UHJvcGVydHkoRm9yY2VEaWN0YXRpb25Qcm9wZXJ0eU5hbWUsIFwidHJ1ZVwiKTtcbiAgICB9XG4gICAgZ2V0IHNwZWVjaFN5bnRoZXNpc0xhbmd1YWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1N5bnRoTGFuZ3VhZ2UpO1xuICAgIH1cbiAgICBzZXQgc3BlZWNoU3ludGhlc2lzTGFuZ3VhZ2UobGFuZ3VhZ2UpIHtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1N5bnRoTGFuZ3VhZ2UsIGxhbmd1YWdlKTtcbiAgICB9XG4gICAgZ2V0IHNwZWVjaFN5bnRoZXNpc1ZvaWNlTmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaFByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9TeW50aFZvaWNlKTtcbiAgICB9XG4gICAgc2V0IHNwZWVjaFN5bnRoZXNpc1ZvaWNlTmFtZSh2b2ljZSkge1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhWb2ljZSwgdm9pY2UpO1xuICAgIH1cbiAgICBnZXQgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0KCkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICAgICAgcmV0dXJuIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFt0aGlzLnByaXZTcGVlY2hQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhPdXRwdXRGb3JtYXQsIHVuZGVmaW5lZCldO1xuICAgIH1cbiAgICBzZXQgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0KGZvcm1hdCkge1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhPdXRwdXRGb3JtYXQsIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtmb3JtYXRdKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIEJhc2UgY2xhc3MgZm9yIHN5bnRoZXNpcyByZXN1bHRzXG4gKiBAY2xhc3MgU3ludGhlc2lzUmVzdWx0XG4gKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMjAuMFxuICovXG5leHBvcnQgY2xhc3MgU3ludGhlc2lzUmVzdWx0IHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZXN1bHRJZCAtIFRoZSByZXN1bHQgaWQuXG4gICAgICogQHBhcmFtIHtSZXN1bHRSZWFzb259IHJlYXNvbiAtIFRoZSByZWFzb24uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGVycm9yRGV0YWlscyAtIEVycm9yIGRldGFpbHMsIGlmIHByb3ZpZGVkLlxuICAgICAqIEBwYXJhbSB7UHJvcGVydHlDb2xsZWN0aW9ufSBwcm9wZXJ0aWVzIC0gQWRkaXRpb25hbCBwcm9wZXJ0aWVzLCBpZiBwcm92aWRlZC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZXN1bHRJZCwgcmVhc29uLCBlcnJvckRldGFpbHMsIHByb3BlcnRpZXMpIHtcbiAgICAgICAgdGhpcy5wcml2UmVzdWx0SWQgPSByZXN1bHRJZDtcbiAgICAgICAgdGhpcy5wcml2UmVhc29uID0gcmVhc29uO1xuICAgICAgICB0aGlzLnByaXZFcnJvckRldGFpbHMgPSBlcnJvckRldGFpbHM7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIHJlc3VsdCBpZGVudGlmaWVyLlxuICAgICAqIEBtZW1iZXIgU3ludGhlc2lzUmVzdWx0LnByb3RvdHlwZS5yZXN1bHRJZFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBTcGVjaWZpZXMgdGhlIHJlc3VsdCBpZGVudGlmaWVyLlxuICAgICAqL1xuICAgIGdldCByZXN1bHRJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlc3VsdElkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgc3RhdHVzIG9mIHRoZSByZXN1bHQuXG4gICAgICogQG1lbWJlciBTeW50aGVzaXNSZXN1bHQucHJvdG90eXBlLnJlYXNvblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7UmVzdWx0UmVhc29ufSBTcGVjaWZpZXMgc3RhdHVzIG9mIHRoZSByZXN1bHQuXG4gICAgICovXG4gICAgZ2V0IHJlYXNvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlYXNvbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW4gY2FzZSBvZiBhbiB1bnN1Y2Nlc3NmdWwgc3ludGhlc2lzLCBwcm92aWRlcyBkZXRhaWxzIG9mIHRoZSBvY2N1cnJlZCBlcnJvci5cbiAgICAgKiBAbWVtYmVyIFN5bnRoZXNpc1Jlc3VsdC5wcm90b3R5cGUuZXJyb3JEZXRhaWxzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IGEgYnJpZWYgZGVzY3JpcHRpb24gb2YgYW4gZXJyb3IuXG4gICAgICovXG4gICAgZ2V0IGVycm9yRGV0YWlscygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkVycm9yRGV0YWlscztcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIHNldCBvZiBwcm9wZXJ0aWVzIGV4cG9zZWQgaW4gdGhlIHJlc3VsdC5cbiAgICAgKiBAbWVtYmVyIFN5bnRoZXNpc1Jlc3VsdC5wcm90b3R5cGUucHJvcGVydGllc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7UHJvcGVydHlDb2xsZWN0aW9ufSBUaGUgc2V0IG9mIHByb3BlcnRpZXMgZXhwb3NlZCBpbiB0aGUgcmVzdWx0LlxuICAgICAqL1xuICAgIGdldCBwcm9wZXJ0aWVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcztcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVN5bnRoZXNpc1Jlc3VsdC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgUHJvcGVydHlDb2xsZWN0aW9uLCBSZXN1bHRSZWFzb24sIFN5bnRoZXNpc1Jlc3VsdCwgVm9pY2VJbmZvIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBEZWZpbmVzIHJlc3VsdCBvZiBzcGVlY2ggc3ludGhlc2lzLlxuICogQGNsYXNzIFN5bnRoZXNpc1ZvaWNlc1Jlc3VsdFxuICogQWRkZWQgaW4gdmVyc2lvbiAxLjIwLjBcbiAqL1xuZXhwb3J0IGNsYXNzIFN5bnRoZXNpc1ZvaWNlc1Jlc3VsdCBleHRlbmRzIFN5bnRoZXNpc1Jlc3VsdCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0gcmVxdWVzdElkIC0gcmVzdWx0IGlkIGZvciByZXF1ZXN0LlxuICAgICAqIEBwYXJhbSBqc29uIC0ganNvbiBwYXlsb2FkIGZyb20gZW5kcG9pbnQuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVxdWVzdElkLCBqc29uLCBlcnJvckRldGFpbHMpIHtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoanNvbikpIHtcbiAgICAgICAgICAgIHN1cGVyKHJlcXVlc3RJZCwgUmVzdWx0UmVhc29uLlZvaWNlc0xpc3RSZXRyaWV2ZWQsIHVuZGVmaW5lZCwgbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpKTtcbiAgICAgICAgICAgIHRoaXMucHJpdlZvaWNlcyA9IFtdO1xuICAgICAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGpzb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZWb2ljZXMucHVzaChuZXcgVm9pY2VJbmZvKGl0ZW0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHN1cGVyKHJlcXVlc3RJZCwgUmVzdWx0UmVhc29uLkNhbmNlbGVkLCBlcnJvckRldGFpbHMgPyBlcnJvckRldGFpbHMgOiBcIkVycm9yIGluZm9ybWF0aW9uIHVuYXZhaWxhYmxlXCIsIG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGxpc3Qgb2Ygdm9pY2VzXG4gICAgICogQG1lbWJlciBTeW50aGVzaXNWb2ljZXNSZXN1bHQucHJvdG90eXBlLnZvaWNlc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7Vm9pY2VJbmZvW119IExpc3Qgb2Ygc3ludGhlc2l6ZWQgdm9pY2VzLlxuICAgICAqL1xuICAgIGdldCB2b2ljZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZWb2ljZXM7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TeW50aGVzaXNWb2ljZXNSZXN1bHQuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8vIE11bHRpLWRldmljZSBDb252ZXJzYXRpb24gaXMgYSBQcmV2aWV3IGZlYXR1cmUuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbi8qIGVzbGludC1kaXNhYmxlIG1heC1jbGFzc2VzLXBlci1maWxlICovXG5pbXBvcnQgeyBDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLCBDb252ZXJzYXRpb25NYW5hZ2VyLCBDb252ZXJzYXRpb25SZWNvZ25pemVyRmFjdG9yeSwgQ29udmVyc2F0aW9uVHJhbnNsYXRvckNvbW1hbmRUeXBlcywgQ29udmVyc2F0aW9uVHJhbnNsYXRvck1lc3NhZ2VUeXBlcywgSW50ZXJuYWxQYXJ0aWNpcGFudHMgfSBmcm9tIFwiLi4vLi4vY29tbW9uLnNwZWVjaC9FeHBvcnRzXCI7XG5pbXBvcnQgeyBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25QYXJ0aWNpcGFudHNDaGFuZ2VkRXZlbnRBcmdzLCBDb252ZXJzYXRpb25UcmFuc2xhdGlvbkV2ZW50QXJncywgUGFydGljaXBhbnQsIFBhcnRpY2lwYW50Q2hhbmdlZFJlYXNvbiwgUHJvZmFuaXR5T3B0aW9uLCBQcm9wZXJ0eUNvbGxlY3Rpb24sIFByb3BlcnR5SWQsIH0gZnJvbSBcIi4uL0V4cG9ydHNcIjtcbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb24ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIGNvbnZlcnNhdGlvblxuICAgICAqIEBwYXJhbSBzcGVlY2hDb25maWdcbiAgICAgKiBAcGFyYW0gY2JcbiAgICAgKiBAcGFyYW0gZXJyXG4gICAgICovXG4gICAgc3RhdGljIGNyZWF0ZUNvbnZlcnNhdGlvbkFzeW5jKHNwZWVjaENvbmZpZywgYXJnMiwgYXJnMywgYXJnNCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChzcGVlY2hDb25maWcsIENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcucmVzdEVycm9ycy5pbnZhbGlkQXJncy5yZXBsYWNlKFwie2FyZ31cIiwgXCJjb25maWdcIikpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChzcGVlY2hDb25maWcucmVnaW9uLCBDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLnJlc3RFcnJvcnMuaW52YWxpZEFyZ3MucmVwbGFjZShcInthcmd9XCIsIFwiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVnaW9uXCIpKTtcbiAgICAgICAgaWYgKCFzcGVlY2hDb25maWcuc3Vic2NyaXB0aW9uS2V5ICYmICFzcGVlY2hDb25maWcuZ2V0UHJvcGVydHkoUHJvcGVydHlJZFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuXSkpIHtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHNwZWVjaENvbmZpZy5zdWJzY3JpcHRpb25LZXksIENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcucmVzdEVycm9ycy5pbnZhbGlkQXJncy5yZXBsYWNlKFwie2FyZ31cIiwgXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9LZXlcIikpO1xuICAgICAgICB9XG4gICAgICAgIGxldCBjb252ZXJzYXRpb25JbXBsO1xuICAgICAgICBsZXQgY2I7XG4gICAgICAgIGxldCBlcnI7XG4gICAgICAgIGlmICh0eXBlb2YgYXJnMiA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgY29udmVyc2F0aW9uSW1wbCA9IG5ldyBDb252ZXJzYXRpb25JbXBsKHNwZWVjaENvbmZpZywgYXJnMik7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uXG4gICAgICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKCgoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7IH0pKSgpLCBhcmczLCBhcmc0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbkltcGwgPSBuZXcgQ29udmVyc2F0aW9uSW1wbChzcGVlY2hDb25maWcpO1xuICAgICAgICAgICAgY2IgPSBhcmcyO1xuICAgICAgICAgICAgZXJyID0gYXJnMztcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbkltcGwuY3JlYXRlQ29udmVyc2F0aW9uQXN5bmMoKCgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoISFjYikge1xuICAgICAgICAgICAgICAgICAgICBjYigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoISFlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29udmVyc2F0aW9uSW1wbDtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgQ29udmVyc2F0aW9uSW1wbCBleHRlbmRzIENvbnZlcnNhdGlvbiB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgY29udmVyc2F0aW9uIGltcGxcbiAgICAgKiBAcGFyYW0gc3BlZWNoQ29uZmlnXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGlkIC0gb3B0aW9uYWwgY29udmVyc2F0aW9uSWRcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihzcGVlY2hDb25maWcsIGlkKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMucHJpdkVycm9ycyA9IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcucmVzdEVycm9ycztcbiAgICAgICAgLyoqIHdlYnNvY2tldCBjYWxsYmFja3MgKi9cbiAgICAgICAgLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L3R5cGVkZWYgKi9cbiAgICAgICAgdGhpcy5vbkNvbm5lY3RlZCA9IChlKSA9PiB7XG4gICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICB0aGlzLnByaXZJc0Nvbm5lY3RlZCA9IHRydWU7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmICghISgoX2EgPSB0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc2Vzc2lvblN0YXJ0ZWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3Iuc2Vzc2lvblN0YXJ0ZWQodGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvciwgZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLm9uRGlzY29ubmVjdGVkID0gKGUpID0+IHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKCEhKChfYSA9IHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zZXNzaW9uU3RvcHBlZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvci5zZXNzaW9uU3RvcHBlZCh0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yLCBlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICB2b2lkIHRoaXMuY2xvc2UoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLm9uQ2FuY2VsZWQgPSAociwgZSkgPT4ge1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAoISEoKF9hID0gdGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNhbmNlbGVkKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yLmNhbmNlbGVkKHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IsIGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5vblBhcnRpY2lwYW50VXBkYXRlQ29tbWFuZFJlY2VpdmVkID0gKHIsIGUpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdXBkYXRlZFBhcnRpY2lwYW50ID0gdGhpcy5wcml2UGFydGljaXBhbnRzLmdldFBhcnRpY2lwYW50KGUuaWQpO1xuICAgICAgICAgICAgICAgIGlmICh1cGRhdGVkUGFydGljaXBhbnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGUua2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIENvbnZlcnNhdGlvblRyYW5zbGF0b3JDb21tYW5kVHlwZXMuY2hhbmdlTmlja25hbWU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZFBhcnRpY2lwYW50LmRpc3BsYXlOYW1lID0gZS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgQ29udmVyc2F0aW9uVHJhbnNsYXRvckNvbW1hbmRUeXBlcy5zZXRVc2VUVFM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZFBhcnRpY2lwYW50LmlzVXNpbmdUdHMgPSBlLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBDb252ZXJzYXRpb25UcmFuc2xhdG9yQ29tbWFuZFR5cGVzLnNldFByb2Zhbml0eUZpbHRlcmluZzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkUGFydGljaXBhbnQucHJvZmFuaXR5ID0gZS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgQ29udmVyc2F0aW9uVHJhbnNsYXRvckNvbW1hbmRUeXBlcy5zZXRNdXRlOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRQYXJ0aWNpcGFudC5pc011dGVkID0gZS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgQ29udmVyc2F0aW9uVHJhbnNsYXRvckNvbW1hbmRUeXBlcy5zZXRUcmFuc2xhdGVUb0xhbmd1YWdlczpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkUGFydGljaXBhbnQudHJhbnNsYXRlVG9MYW5ndWFnZXMgPSBlLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlBhcnRpY2lwYW50cy5hZGRPclVwZGF0ZVBhcnRpY2lwYW50KHVwZGF0ZWRQYXJ0aWNpcGFudCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IucGFydGljaXBhbnRzQ2hhbmdlZCh0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yLCBuZXcgQ29udmVyc2F0aW9uUGFydGljaXBhbnRzQ2hhbmdlZEV2ZW50QXJncyhQYXJ0aWNpcGFudENoYW5nZWRSZWFzb24uVXBkYXRlZCwgW3RoaXMudG9QYXJ0aWNpcGFudCh1cGRhdGVkUGFydGljaXBhbnQpXSwgZS5zZXNzaW9uSWQpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5vbkxvY2tSb29tQ29tbWFuZFJlY2VpdmVkID0gKCkgPT4ge1xuICAgICAgICAgICAgLy8gVE9ET1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLm9uTXV0ZUFsbENvbW1hbmRSZWNlaXZlZCA9IChyLCBlKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlBhcnRpY2lwYW50cy5wYXJ0aWNpcGFudHMuZm9yRWFjaCgocCkgPT4gcC5pc011dGVkID0gKHAuaXNIb3N0ID8gZmFsc2UgOiBlLmlzTXV0ZWQpKTtcbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IucGFydGljaXBhbnRzQ2hhbmdlZCh0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yLCBuZXcgQ29udmVyc2F0aW9uUGFydGljaXBhbnRzQ2hhbmdlZEV2ZW50QXJncyhQYXJ0aWNpcGFudENoYW5nZWRSZWFzb24uVXBkYXRlZCwgdGhpcy50b1BhcnRpY2lwYW50cyhmYWxzZSksIGUuc2Vzc2lvbklkKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLm9uUGFydGljaXBhbnRKb2luQ29tbWFuZFJlY2VpdmVkID0gKHIsIGUpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UGFydGljaXBhbnQgPSB0aGlzLnByaXZQYXJ0aWNpcGFudHMuYWRkT3JVcGRhdGVQYXJ0aWNpcGFudChlLnBhcnRpY2lwYW50KTtcbiAgICAgICAgICAgICAgICBpZiAobmV3UGFydGljaXBhbnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yLnBhcnRpY2lwYW50c0NoYW5nZWQodGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvciwgbmV3IENvbnZlcnNhdGlvblBhcnRpY2lwYW50c0NoYW5nZWRFdmVudEFyZ3MoUGFydGljaXBhbnRDaGFuZ2VkUmVhc29uLkpvaW5lZENvbnZlcnNhdGlvbiwgW3RoaXMudG9QYXJ0aWNpcGFudChuZXdQYXJ0aWNpcGFudCldLCBlLnNlc3Npb25JZCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLm9uUGFydGljaXBhbnRMZWF2ZUNvbW1hbmRSZWNlaXZlZCA9IChyLCBlKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVqZWN0ZWRQYXJ0aWNpcGFudCA9IHRoaXMucHJpdlBhcnRpY2lwYW50cy5nZXRQYXJ0aWNpcGFudChlLnBhcnRpY2lwYW50LmlkKTtcbiAgICAgICAgICAgICAgICBpZiAoZWplY3RlZFBhcnRpY2lwYW50ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIHRoZSBwYXJ0aWNpcGFudCBmcm9tIHRoZSBpbnRlcm5hbCBwYXJ0aWNpcGFudHMgbGlzdFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZQYXJ0aWNpcGFudHMuZGVsZXRlUGFydGljaXBhbnQoZS5wYXJ0aWNpcGFudC5pZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vdGlmeSBzdWJzY3JpYmVycyB0aGF0IHRoZSBwYXJ0aWNpcGFudCBoYXMgbGVmdCB0aGUgY29udmVyc2F0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yLnBhcnRpY2lwYW50c0NoYW5nZWQodGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvciwgbmV3IENvbnZlcnNhdGlvblBhcnRpY2lwYW50c0NoYW5nZWRFdmVudEFyZ3MoUGFydGljaXBhbnRDaGFuZ2VkUmVhc29uLkxlZnRDb252ZXJzYXRpb24sIFt0aGlzLnRvUGFydGljaXBhbnQoZWplY3RlZFBhcnRpY2lwYW50KV0sIGUuc2Vzc2lvbklkKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMub25UcmFuc2xhdGlvblJlY2VpdmVkID0gKHIsIGUpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChlLmNvbW1hbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBDb252ZXJzYXRpb25UcmFuc2xhdG9yTWVzc2FnZVR5cGVzLmZpbmFsOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IudHJhbnNjcmliZWQodGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvciwgbmV3IENvbnZlcnNhdGlvblRyYW5zbGF0aW9uRXZlbnRBcmdzKGUucGF5bG9hZCwgdW5kZWZpbmVkLCBlLnNlc3Npb25JZCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgQ29udmVyc2F0aW9uVHJhbnNsYXRvck1lc3NhZ2VUeXBlcy5wYXJ0aWFsOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IudHJhbnNjcmliaW5nKHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IsIG5ldyBDb252ZXJzYXRpb25UcmFuc2xhdGlvbkV2ZW50QXJncyhlLnBheWxvYWQsIHVuZGVmaW5lZCwgZS5zZXNzaW9uSWQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIENvbnZlcnNhdGlvblRyYW5zbGF0b3JNZXNzYWdlVHlwZXMuaW5zdGFudE1lc3NhZ2U6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvci50ZXh0TWVzc2FnZVJlY2VpdmVkKHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IsIG5ldyBDb252ZXJzYXRpb25UcmFuc2xhdGlvbkV2ZW50QXJncyhlLnBheWxvYWQsIHVuZGVmaW5lZCwgZS5zZXNzaW9uSWQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5vblBhcnRpY2lwYW50c0xpc3RSZWNlaXZlZCA9IChyLCBlKSA9PiB7XG4gICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBzZXNzaW9uIHRva2VuIG5lZWRzIHRvIGJlIHVwZGF0ZWRcbiAgICAgICAgICAgICAgICBpZiAoZS5zZXNzaW9uVG9rZW4gIT09IHVuZGVmaW5lZCAmJiBlLnNlc3Npb25Ub2tlbiAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZSb29tLnRva2VuID0gZS5zZXNzaW9uVG9rZW47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIHNhdmUgdGhlIHBhcnRpY2lwYW50c1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlBhcnRpY2lwYW50cy5wYXJ0aWNpcGFudHMgPSBbLi4uZS5wYXJ0aWNpcGFudHNdO1xuICAgICAgICAgICAgICAgIC8vIGVuYWJsZSB0aGUgY29udmVyc2F0aW9uXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdlBhcnRpY2lwYW50cy5tZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdklzUmVhZHkgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IucGFydGljaXBhbnRzQ2hhbmdlZCh0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yLCBuZXcgQ29udmVyc2F0aW9uUGFydGljaXBhbnRzQ2hhbmdlZEV2ZW50QXJncyhQYXJ0aWNpcGFudENoYW5nZWRSZWFzb24uSm9pbmVkQ29udmVyc2F0aW9uLCB0aGlzLnRvUGFydGljaXBhbnRzKHRydWUpLCBlLnNlc3Npb25JZCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBpZiB0aGlzIGlzIHRoZSBob3N0LCB1cGRhdGUgdGhlIG5pY2tuYW1lIGlmIG5lZWRlZFxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm1lLmlzSG9zdCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuaWNrbmFtZSA9IChfYSA9IHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9OYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5pY2tuYW1lICE9PSB1bmRlZmluZWQgJiYgbmlja25hbWUubGVuZ3RoID4gMCAmJiBuaWNrbmFtZSAhPT0gdGhpcy5tZS5kaXNwbGF5TmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaXNzdWUgYSBjaGFuZ2Ugbmlja25hbWUgcmVxdWVzdFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VOaWNrbmFtZUFzeW5jKG5pY2tuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5vbkNvbnZlcnNhdGlvbkV4cGlyYXRpb24gPSAociwgZSkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IuY29udmVyc2F0aW9uRXhwaXJhdGlvbih0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yLCBlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucHJpdklzQ29ubmVjdGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdklzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uSWQgPSBcIlwiO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICB0aGlzLnByaXZNYW5hZ2VyID0gbmV3IENvbnZlcnNhdGlvbk1hbmFnZXIoKTtcbiAgICAgICAgLy8gY2hlY2sgdGhlIHNwZWVjaCBsYW5ndWFnZVxuICAgICAgICBjb25zdCBsYW5ndWFnZSA9IHNwZWVjaENvbmZpZy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlXSk7XG4gICAgICAgIGlmICghbGFuZ3VhZ2UpIHtcbiAgICAgICAgICAgIHNwZWVjaENvbmZpZy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlXSwgQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5kZWZhdWx0TGFuZ3VhZ2VDb2RlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZMYW5ndWFnZSA9IHNwZWVjaENvbmZpZy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlXSk7XG4gICAgICAgIGlmICghaWQpIHtcbiAgICAgICAgICAgIC8vIGNoZWNrIHRoZSB0YXJnZXQgbGFuZ3VhZ2UocylcbiAgICAgICAgICAgIGlmIChzcGVlY2hDb25maWcudGFyZ2V0TGFuZ3VhZ2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHNwZWVjaENvbmZpZy5hZGRUYXJnZXRMYW5ndWFnZSh0aGlzLnByaXZMYW5ndWFnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBjaGVjayB0aGUgcHJvZmFuaXR5IHNldHRpbmc6IHNwZWVjaCBhbmQgY29udmVyc2F0aW9uVHJhbnNsYXRvciBzaG91bGQgYmUgaW4gc3luY1xuICAgICAgICAgICAgY29uc3QgcHJvZmFuaXR5ID0gc3BlZWNoQ29uZmlnLmdldFByb3BlcnR5KFByb3BlcnR5SWRbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUHJvZmFuaXR5T3B0aW9uXSk7XG4gICAgICAgICAgICBpZiAoIXByb2Zhbml0eSkge1xuICAgICAgICAgICAgICAgIHNwZWVjaENvbmZpZy5zZXRQcm9mYW5pdHkoUHJvZmFuaXR5T3B0aW9uLk1hc2tlZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBjaGVjayB0aGUgbmlja25hbWU6IGl0IHNob3VsZCBwYXNzIHRoaXMgcmVnZXg6IF5cXHcrKFtcXHMtXVtcXHdcXChcXCldKykqJFwiXG4gICAgICAgICAgICAvLyBUT0RPOiBzcGVjaWZ5IHRoZSByZWdleCByZXF1aXJlZC4gTmlja25hbWVzIG11c3QgYmUgdW5pcXVlIG9yIGdldCB0aGUgZHVwbGljYXRlIG5pY2tuYW1lIGVycm9yXG4gICAgICAgICAgICAvLyBUT0RPOiBjaGVjayB3aGF0IHRoZSBtYXggbGVuZ3RoIGlzIGFuZCBpZiBhIHRydW5jYXRpb24gaXMgcmVxdWlyZWQgb3IgaWYgdGhlIHNlcnZpY2UgaGFuZGxlcyBpdCB3aXRob3V0IGFuIGVycm9yXG4gICAgICAgICAgICBsZXQgaG9zdE5pY2tuYW1lID0gc3BlZWNoQ29uZmlnLmdldFByb3BlcnR5KFByb3BlcnR5SWRbUHJvcGVydHlJZC5Db252ZXJzYXRpb25UcmFuc2xhdG9yX05hbWVdKTtcbiAgICAgICAgICAgIGlmIChob3N0Tmlja25hbWUgPT09IHVuZGVmaW5lZCB8fCBob3N0Tmlja25hbWUgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBob3N0Tmlja25hbWUgPSBcIkhvc3RcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVG9vTG9uZyhob3N0Tmlja25hbWUsIFwibmlja25hbWVcIiwgNTApO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JUb29TaG9ydChob3N0Tmlja25hbWUsIFwibmlja25hbWVcIiwgMik7XG4gICAgICAgICAgICBzcGVlY2hDb25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZFtQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvblRyYW5zbGF0b3JfTmFtZV0sIGhvc3ROaWNrbmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25JZCA9IGlkO1xuICAgICAgICB9XG4gICAgICAgIC8vIHNhdmUgdGhlIHNwZWVjaCBjb25maWcgZm9yIGZ1dHVyZSB1c2FnZVxuICAgICAgICB0aGlzLnByaXZDb25maWcgPSBzcGVlY2hDb25maWc7XG4gICAgICAgIC8vIHNhdmUgdGhlIGNvbmZpZyBwcm9wZXJ0aWVzXG4gICAgICAgIGNvbnN0IGNvbmZpZ0ltcGwgPSBzcGVlY2hDb25maWc7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbChjb25maWdJbXBsLCBcInNwZWVjaENvbmZpZ1wiKTtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcyA9IGNvbmZpZ0ltcGwucHJvcGVydGllcy5jbG9uZSgpO1xuICAgICAgICB0aGlzLnByaXZJc0Nvbm5lY3RlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZQYXJ0aWNpcGFudHMgPSBuZXcgSW50ZXJuYWxQYXJ0aWNpcGFudHMoKTtcbiAgICAgICAgdGhpcy5wcml2SXNSZWFkeSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZUZXh0TWVzc2FnZU1heExlbmd0aCA9IDEwMDA7XG4gICAgfVxuICAgIC8vIGdldCB0aGUgaW50ZXJuYWwgZGF0YSBhYm91dCBhIGNvbnZlcnNhdGlvblxuICAgIGdldCByb29tKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Um9vbTtcbiAgICB9XG4gICAgLy8gZ2V0IHRoZSB3cmFwcGVyIGZvciBjb25uZWN0aW5nIHRvIHRoZSB3ZWJzb2NrZXRzXG4gICAgZ2V0IGNvbm5lY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyOyAvLyB0aGlzLnByaXZDb25uZWN0aW9uO1xuICAgIH1cbiAgICAvLyBnZXQgdGhlIGNvbmZpZ1xuICAgIGdldCBjb25maWcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb25maWc7XG4gICAgfVxuICAgIC8vIGdldCB0aGUgY29udmVyc2F0aW9uIElkXG4gICAgZ2V0IGNvbnZlcnNhdGlvbklkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Um9vbSA/IHRoaXMucHJpdlJvb20ucm9vbUlkIDogdGhpcy5wcml2Q29udmVyc2F0aW9uSWQ7XG4gICAgfVxuICAgIC8vIGdldCB0aGUgcHJvcGVydGllc1xuICAgIGdldCBwcm9wZXJ0aWVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcztcbiAgICB9XG4gICAgLy8gZ2V0IHRoZSBzcGVlY2ggbGFuZ3VhZ2VcbiAgICBnZXQgc3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkxhbmd1YWdlO1xuICAgIH1cbiAgICBnZXQgaXNNdXRlZEJ5SG9zdCgpIHtcbiAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgcmV0dXJuICgoX2EgPSB0aGlzLnByaXZQYXJ0aWNpcGFudHMubWUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5pc0hvc3QpID8gZmFsc2UgOiAoX2IgPSB0aGlzLnByaXZQYXJ0aWNpcGFudHMubWUpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5pc011dGVkO1xuICAgIH1cbiAgICBnZXQgaXNDb25uZWN0ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJc0Nvbm5lY3RlZCAmJiB0aGlzLnByaXZJc1JlYWR5O1xuICAgIH1cbiAgICBnZXQgcGFydGljaXBhbnRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b1BhcnRpY2lwYW50cyh0cnVlKTtcbiAgICB9XG4gICAgZ2V0IG1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b1BhcnRpY2lwYW50KHRoaXMucHJpdlBhcnRpY2lwYW50cy5tZSk7XG4gICAgfVxuICAgIGdldCBob3N0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b1BhcnRpY2lwYW50KHRoaXMucHJpdlBhcnRpY2lwYW50cy5ob3N0KTtcbiAgICB9XG4gICAgZ2V0IHRyYW5zY3JpYmVyUmVjb2duaXplcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRyYW5zY3JpYmVyUmVjb2duaXplcjtcbiAgICB9XG4gICAgZ2V0IGNvbnZlcnNhdGlvbkluZm8oKSB7XG4gICAgICAgIGNvbnN0IGNvbnZJZCA9IHRoaXMuY29udmVyc2F0aW9uSWQ7XG4gICAgICAgIGNvbnN0IHAgPSB0aGlzLnBhcnRpY2lwYW50cy5tYXAoKHBhcnQpID0+ICh7XG4gICAgICAgICAgICBpZDogcGFydC5pZCxcbiAgICAgICAgICAgIHByZWZlcnJlZExhbmd1YWdlOiBwYXJ0LnByZWZlcnJlZExhbmd1YWdlLFxuICAgICAgICAgICAgdm9pY2U6IHBhcnQudm9pY2VcbiAgICAgICAgfSkpO1xuICAgICAgICBjb25zdCBwcm9wcyA9IHt9O1xuICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLnRyYW5zY3JpcHRpb25FdmVudEtleXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHZhbCA9IHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShrZXksIFwiXCIpO1xuICAgICAgICAgICAgaWYgKHZhbCAhPT0gXCJcIikge1xuICAgICAgICAgICAgICAgIHByb3BzW2tleV0gPSB2YWw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaW5mbyA9IHsgaWQ6IGNvbnZJZCwgcGFydGljaXBhbnRzOiBwLCBjb252ZXJzYXRpb25Qcm9wZXJ0aWVzOiBwcm9wcyB9O1xuICAgICAgICByZXR1cm4gaW5mbztcbiAgICB9XG4gICAgZ2V0IGNhblNlbmQoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzQ29ubmVjdGVkICYmICEoKF9hID0gdGhpcy5wcml2UGFydGljaXBhbnRzLm1lKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaXNNdXRlZCk7XG4gICAgfVxuICAgIGdldCBjYW5TZW5kQXNIb3N0KCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJc0Nvbm5lY3RlZCAmJiAoKF9hID0gdGhpcy5wcml2UGFydGljaXBhbnRzLm1lKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaXNIb3N0KTtcbiAgICB9XG4gICAgLy8gZ2V0IC8gc2V0IHRoZSBzcGVlY2ggYXV0aCB0b2tlblxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbWVtYmVyLW9yZGVyaW5nXG4gICAgZ2V0IGF1dGhvcml6YXRpb25Ub2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRva2VuO1xuICAgIH1cbiAgICBzZXQgYXV0aG9yaXphdGlvblRva2VuKHZhbHVlKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh2YWx1ZSwgXCJhdXRob3JpemF0aW9uVG9rZW5cIik7XG4gICAgICAgIHRoaXMucHJpdlRva2VuID0gdmFsdWU7XG4gICAgfVxuICAgIHNldCBjb252ZXJzYXRpb25UcmFuc2xhdG9yKGNvbnZlcnNhdGlvblRyYW5zbGF0b3IpIHtcbiAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvciA9IGNvbnZlcnNhdGlvblRyYW5zbGF0b3I7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG5ldyBjb252ZXJzYXRpb24gYXMgSG9zdFxuICAgICAqIEBwYXJhbSBjYlxuICAgICAqIEBwYXJhbSBlcnJcbiAgICAgKi9cbiAgICBjcmVhdGVDb252ZXJzYXRpb25Bc3luYyhjYiwgZXJyKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihuZXcgRXJyb3IodGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRTdGFydCksIGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnByaXZNYW5hZ2VyLmNyZWF0ZU9ySm9pbih0aGlzLnByaXZQcm9wZXJ0aWVzLCB1bmRlZmluZWQsICgocm9vbSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghcm9vbSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKG5ldyBFcnJvcih0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZENvbm5lY3QpLCBlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnByaXZSb29tID0gcm9vbTtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUNhbGxiYWNrKGNiLCBlcnIpO1xuICAgICAgICAgICAgfSksICgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBlcnIpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgZXJyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgYSBuZXcgY29udmVyc2F0aW9uIGFzIGhvc3QuXG4gICAgICogQHBhcmFtIGNiXG4gICAgICogQHBhcmFtIGVyclxuICAgICAqL1xuICAgIHN0YXJ0Q29udmVyc2F0aW9uQXN5bmMoY2IsIGVycikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlcmUgaXMgYWxyZWFkeSBhIHJlY29nbml6ZXJcbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKG5ldyBFcnJvcih0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZFN0YXJ0KSwgZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZXJlIGlzIGNvbnZlcnNhdGlvbiBkYXRhIGF2YWlsYWJsZVxuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQodGhpcy5wcml2Um9vbSwgdGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRDb25uZWN0KTtcbiAgICAgICAgICAgIC8vIGNvbm5lY3QgdG8gdGhlIGNvbnZlcnNhdGlvbiB3ZWJzb2NrZXRcbiAgICAgICAgICAgIHRoaXMucHJpdlBhcnRpY2lwYW50cy5tZUlkID0gdGhpcy5wcml2Um9vbS5wYXJ0aWNpcGFudElkO1xuICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplciA9IENvbnZlcnNhdGlvblJlY29nbml6ZXJGYWN0b3J5LmZyb21Db25maWcodGhpcywgdGhpcy5wcml2Q29uZmlnKTtcbiAgICAgICAgICAgIC8vIEJlY2F1c2UgQ29udmVyc2F0aW9uVHJhbnNsYXRvciBtYW51YWxseSBzZXRzIHVwIGFuZCBtYW5hZ2VzIHRoZSBjb25uZWN0aW9uLCBDb252ZXJzYXRpb25cbiAgICAgICAgICAgIC8vIGhhcyB0byBmb3J3YXJkIHNlcnZpY2VSZWNvZ25pemVyIGNvbm5lY3Rpb24gZXZlbnRzIHRoYXQgdXN1YWxseSBnZXQgcGFzc2VkIGF1dG9tYXRpY2FsbHlcbiAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIuY29ubmVjdGVkID0gdGhpcy5vbkNvbm5lY3RlZDtcbiAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIuZGlzY29ubmVjdGVkID0gdGhpcy5vbkRpc2Nvbm5lY3RlZDtcbiAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIuY2FuY2VsZWQgPSB0aGlzLm9uQ2FuY2VsZWQ7XG4gICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyLnBhcnRpY2lwYW50VXBkYXRlQ29tbWFuZFJlY2VpdmVkID0gdGhpcy5vblBhcnRpY2lwYW50VXBkYXRlQ29tbWFuZFJlY2VpdmVkO1xuICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5sb2NrUm9vbUNvbW1hbmRSZWNlaXZlZCA9IHRoaXMub25Mb2NrUm9vbUNvbW1hbmRSZWNlaXZlZDtcbiAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIubXV0ZUFsbENvbW1hbmRSZWNlaXZlZCA9IHRoaXMub25NdXRlQWxsQ29tbWFuZFJlY2VpdmVkO1xuICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5wYXJ0aWNpcGFudEpvaW5Db21tYW5kUmVjZWl2ZWQgPSB0aGlzLm9uUGFydGljaXBhbnRKb2luQ29tbWFuZFJlY2VpdmVkO1xuICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5wYXJ0aWNpcGFudExlYXZlQ29tbWFuZFJlY2VpdmVkID0gdGhpcy5vblBhcnRpY2lwYW50TGVhdmVDb21tYW5kUmVjZWl2ZWQ7XG4gICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyLnRyYW5zbGF0aW9uUmVjZWl2ZWQgPSB0aGlzLm9uVHJhbnNsYXRpb25SZWNlaXZlZDtcbiAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIucGFydGljaXBhbnRzTGlzdFJlY2VpdmVkID0gdGhpcy5vblBhcnRpY2lwYW50c0xpc3RSZWNlaXZlZDtcbiAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIuY29udmVyc2F0aW9uRXhwaXJhdGlvbiA9IHRoaXMub25Db252ZXJzYXRpb25FeHBpcmF0aW9uO1xuICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5jb25uZWN0KHRoaXMucHJpdlJvb20udG9rZW4sICgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVDYWxsYmFjayhjYiwgZXJyKTtcbiAgICAgICAgICAgIH0pLCAoKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgZXJyKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIGVycik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogSm9pbiBhIGNvbnZlcnNhdGlvbiBhcyBhIHBhcnRpY2lwYW50LlxuICAgICAqIEBwYXJhbSB7IElQYXJ0aWNpcGFudCB9IHBhcnRpY2lwYW50IC0gcGFydGljaXBhbnQgdG8gYWRkXG4gICAgICogQHBhcmFtIGNiXG4gICAgICogQHBhcmFtIGVyclxuICAgICAqL1xuICAgIGFkZFBhcnRpY2lwYW50QXN5bmMocGFydGljaXBhbnQsIGNiLCBlcnIpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQocGFydGljaXBhbnQsIFwiUGFydGljaXBhbnRcIik7XG4gICAgICAgIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3ModGhpcy5hZGRQYXJ0aWNpcGFudEltcGxBc3luYyhwYXJ0aWNpcGFudCksIGNiLCBlcnIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBKb2luIGEgY29udmVyc2F0aW9uIGFzIGEgcGFydGljaXBhbnQuXG4gICAgICogQHBhcmFtIGNvbnZlcnNhdGlvblxuICAgICAqIEBwYXJhbSBuaWNrbmFtZVxuICAgICAqIEBwYXJhbSBsYW5nXG4gICAgICogQHBhcmFtIGNiXG4gICAgICogQHBhcmFtIGVyclxuICAgICAqL1xuICAgIGpvaW5Db252ZXJzYXRpb25Bc3luYyhjb252ZXJzYXRpb25JZCwgbmlja25hbWUsIGxhbmcsIGNiLCBlcnIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFRPRE9cbiAgICAgICAgICAgIC8vIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgIC8vICAgICB0aHJvdyBuZXcgRXJyb3IodGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRTdGFydCk7XG4gICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UoY29udmVyc2F0aW9uSWQsIHRoaXMucHJpdkVycm9ycy5pbnZhbGlkQXJncy5yZXBsYWNlKFwie2FyZ31cIiwgXCJjb252ZXJzYXRpb25JZFwiKSk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2Uobmlja25hbWUsIHRoaXMucHJpdkVycm9ycy5pbnZhbGlkQXJncy5yZXBsYWNlKFwie2FyZ31cIiwgXCJuaWNrbmFtZVwiKSk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UobGFuZywgdGhpcy5wcml2RXJyb3JzLmludmFsaWRBcmdzLnJlcGxhY2UoXCJ7YXJnfVwiLCBcImxhbmd1YWdlXCIpKTtcbiAgICAgICAgICAgIC8vIGpvaW4gdGhlIGNvbnZlcnNhdGlvblxuICAgICAgICAgICAgdGhpcy5wcml2TWFuYWdlci5jcmVhdGVPckpvaW4odGhpcy5wcml2UHJvcGVydGllcywgY29udmVyc2F0aW9uSWQsICgocm9vbSkgPT4ge1xuICAgICAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHJvb20sIHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkQ29ubmVjdCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Um9vbSA9IHJvb207XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29uZmlnLmF1dGhvcml6YXRpb25Ub2tlbiA9IHJvb20uY29nbml0aXZlU3BlZWNoQXV0aFRva2VuO1xuICAgICAgICAgICAgICAgIC8vIGpvaW4gY2FsbGJhY2tcbiAgICAgICAgICAgICAgICBpZiAoISFjYikge1xuICAgICAgICAgICAgICAgICAgICBjYihyb29tLmNvZ25pdGl2ZVNwZWVjaEF1dGhUb2tlbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSksICgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBlcnIpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgZXJyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWxldGVzIGEgY29udmVyc2F0aW9uXG4gICAgICogQHBhcmFtIGNiXG4gICAgICogQHBhcmFtIGVyclxuICAgICAqL1xuICAgIGRlbGV0ZUNvbnZlcnNhdGlvbkFzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLmRlbGV0ZUNvbnZlcnNhdGlvbkltcGxBc3luYygpLCBjYiwgZXJyKTtcbiAgICB9XG4gICAgZGVsZXRlQ29udmVyc2F0aW9uSW1wbEFzeW5jKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQodGhpcy5wcml2UHJvcGVydGllcywgdGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRDb25uZWN0KTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh0aGlzLnByaXZSb29tLnRva2VuLCB0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZENvbm5lY3QpO1xuICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2TWFuYWdlci5sZWF2ZSh0aGlzLnByaXZQcm9wZXJ0aWVzLCB0aGlzLnByaXZSb29tLnRva2VuKTtcbiAgICAgICAgICAgIHRoaXMuZGlzcG9zZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSXNzdWVzIGEgcmVxdWVzdCB0byBjbG9zZSB0aGUgY2xpZW50IHdlYnNvY2tldHNcbiAgICAgKiBAcGFyYW0gY2JcbiAgICAgKiBAcGFyYW0gZXJyXG4gICAgICovXG4gICAgZW5kQ29udmVyc2F0aW9uQXN5bmMoY2IsIGVycikge1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMuZW5kQ29udmVyc2F0aW9uSW1wbEFzeW5jKCksIGNiLCBlcnIpO1xuICAgIH1cbiAgICBlbmRDb252ZXJzYXRpb25JbXBsQXN5bmMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNsb3NlKHRydWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJc3N1ZXMgYSByZXF1ZXN0IHRvIGxvY2sgdGhlIGNvbnZlcnNhdGlvblxuICAgICAqIEBwYXJhbSBjYlxuICAgICAqIEBwYXJhbSBlcnJcbiAgICAgKi9cbiAgICBsb2NrQ29udmVyc2F0aW9uQXN5bmMoY2IsIGVycikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZJc0Rpc3Bvc2VkKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5pc0Rpc3Bvc2VkKCkpO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQodGhpcy5wcml2Um9vbSwgdGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRTZW5kKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5jYW5TZW5kQXNIb3N0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihuZXcgRXJyb3IodGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRDb252ZXJzYXRpb24ucmVwbGFjZShcIntjb21tYW5kfVwiLCBcImxvY2tcIikpLCBlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplcikge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIuc2VuZFJlcXVlc3QodGhpcy5nZXRMb2NrQ29tbWFuZCh0cnVlKSwgKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVDYWxsYmFjayhjYiwgZXJyKTtcbiAgICAgICAgICAgICAgICB9KSwgKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBlcnIpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIGVycik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogSXNzdWVzIGEgcmVxdWVzdCB0byBtdXRlIHRoZSBjb252ZXJzYXRpb25cbiAgICAgKiBAcGFyYW0gY2JcbiAgICAgKiBAcGFyYW0gZXJyXG4gICAgICovXG4gICAgbXV0ZUFsbFBhcnRpY2lwYW50c0FzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2SXNEaXNwb3NlZCk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIuaXNEaXNwb3NlZCgpKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIsIHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkU2VuZCk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZCh0aGlzLnByaXZSb29tLCB0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZFNlbmQpO1xuICAgICAgICAgICAgLy8gY2hlY2sgdGhlIHVzZXIncyBwZXJtaXNzaW9uc1xuICAgICAgICAgICAgaWYgKCF0aGlzLmNhblNlbmRBc0hvc3QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKG5ldyBFcnJvcih0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZENvbnZlcnNhdGlvbi5yZXBsYWNlKFwie2NvbW1hbmR9XCIsIFwibXV0ZVwiKSksIGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5zZW5kUmVxdWVzdCh0aGlzLmdldE11dGVBbGxDb21tYW5kKHRydWUpLCAoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUNhbGxiYWNrKGNiLCBlcnIpO1xuICAgICAgICAgICAgICAgIH0pLCAoKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIGVycik7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgZXJyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBJc3N1ZXMgYSByZXF1ZXN0IHRvIG11dGUgYSBwYXJ0aWNpcGFudCBpbiB0aGUgY29udmVyc2F0aW9uXG4gICAgICogQHBhcmFtIHVzZXJJZFxuICAgICAqIEBwYXJhbSBjYlxuICAgICAqIEBwYXJhbSBlcnJcbiAgICAgKi9cbiAgICBtdXRlUGFydGljaXBhbnRBc3luYyh1c2VySWQsIGNiLCBlcnIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2SXNEaXNwb3NlZCk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIuaXNEaXNwb3NlZCgpKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh1c2VySWQsIHRoaXMucHJpdkVycm9ycy5pbnZhbGlkQXJncy5yZXBsYWNlKFwie2FyZ31cIiwgXCJ1c2VySWRcIikpO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQodGhpcy5wcml2Um9vbSwgdGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRTZW5kKTtcbiAgICAgICAgICAgIC8vIGNoZWNrIHRoZSBjb25uZWN0aW9uIGlzIG9wZW4gKGhvc3QgKyBwYXJ0aWNpcGFudCBjYW4gcGVyZm9ybSB0aGUgbXV0ZSBjb21tYW5kKVxuICAgICAgICAgICAgaWYgKCF0aGlzLmNhblNlbmQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKG5ldyBFcnJvcih0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZFNlbmQpLCBlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gaWYgbm90IGhvc3QsIGNoZWNrIHRoZSBwYXJ0aWNpcGFudCBpcyBub3QgbXV0aW5nIGFub3RoZXIgcGFydGljaXBhbnRcbiAgICAgICAgICAgIGlmICghdGhpcy5tZS5pc0hvc3QgJiYgdGhpcy5tZS5pZCAhPT0gdXNlcklkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihuZXcgRXJyb3IodGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRQYXJ0aWNpcGFudC5yZXBsYWNlKFwie2NvbW1hbmR9XCIsIFwibXV0ZVwiKSksIGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBjaGVjayB0aGUgdXNlciBleGlzdHNcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0cyA9IHRoaXMucHJpdlBhcnRpY2lwYW50cy5nZXRQYXJ0aWNpcGFudEluZGV4KHVzZXJJZCk7XG4gICAgICAgICAgICBpZiAoZXhpc3RzID09PSAtMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IobmV3IEVycm9yKHRoaXMucHJpdkVycm9ycy5pbnZhbGlkUGFydGljaXBhbnRSZXF1ZXN0KSwgZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyLnNlbmRSZXF1ZXN0KHRoaXMuZ2V0TXV0ZUNvbW1hbmQodXNlcklkLCB0cnVlKSwgKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVDYWxsYmFjayhjYiwgZXJyKTtcbiAgICAgICAgICAgICAgICB9KSwgKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBlcnIpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIGVycik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogSXNzdWVzIGEgcmVxdWVzdCB0byByZW1vdmUgYSBwYXJ0aWNpcGFudCBmcm9tIHRoZSBjb252ZXJzYXRpb25cbiAgICAgKiBAcGFyYW0gdXNlcklkXG4gICAgICogQHBhcmFtIGNiXG4gICAgICogQHBhcmFtIGVyclxuICAgICAqL1xuICAgIHJlbW92ZVBhcnRpY2lwYW50QXN5bmModXNlcklkLCBjYiwgZXJyKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdklzRGlzcG9zZWQpO1xuICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2VHJhbnNjcmliZXJSZWNvZ25pemVyICYmIHVzZXJJZC5oYXNPd25Qcm9wZXJ0eShcImlkXCIpKSB7XG4gICAgICAgICAgICAgICAgLy8gQXNzdW1lIHRoaXMgaXMgYSB0cmFuc2NyaXB0aW9uIHBhcnRpY2lwYW50XG4gICAgICAgICAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLnJlbW92ZVBhcnRpY2lwYW50SW1wbEFzeW5jKHVzZXJJZCksIGNiLCBlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyLmlzRGlzcG9zZWQoKSk7XG4gICAgICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQodGhpcy5wcml2Um9vbSwgdGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRTZW5kKTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY2FuU2VuZEFzSG9zdCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKG5ldyBFcnJvcih0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZFBhcnRpY2lwYW50LnJlcGxhY2UoXCJ7Y29tbWFuZH1cIiwgXCJyZW1vdmVcIikpLCBlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsZXQgcGFydGljaXBhbnRJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB1c2VySWQgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFydGljaXBhbnRJZCA9IHVzZXJJZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodXNlcklkLmhhc093blByb3BlcnR5KFwiaWRcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFydGljaXBhbnQgPSB1c2VySWQ7XG4gICAgICAgICAgICAgICAgICAgIHBhcnRpY2lwYW50SWQgPSBwYXJ0aWNpcGFudC5pZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodXNlcklkLmhhc093blByb3BlcnR5KFwidXNlcklkXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHVzZXIgPSB1c2VySWQ7XG4gICAgICAgICAgICAgICAgICAgIHBhcnRpY2lwYW50SWQgPSB1c2VyLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHBhcnRpY2lwYW50SWQsIHRoaXMucHJpdkVycm9ycy5pbnZhbGlkQXJncy5yZXBsYWNlKFwie2FyZ31cIiwgXCJ1c2VySWRcIikpO1xuICAgICAgICAgICAgICAgIC8vIGNoZWNrIHRoZSBwYXJ0aWNpcGFudCBleGlzdHNcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMucGFydGljaXBhbnRzLmZpbmRJbmRleCgocCkgPT4gcC5pZCA9PT0gcGFydGljaXBhbnRJZCk7XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKG5ldyBFcnJvcih0aGlzLnByaXZFcnJvcnMuaW52YWxpZFBhcnRpY2lwYW50UmVxdWVzdCksIGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5zZW5kUmVxdWVzdCh0aGlzLmdldEVqZWN0Q29tbWFuZChwYXJ0aWNpcGFudElkKSwgKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlQ2FsbGJhY2soY2IsIGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pLCAoKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgZXJyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBJc3N1ZXMgYSByZXF1ZXN0IHRvIHVubG9jayB0aGUgY29udmVyc2F0aW9uXG4gICAgICogQHBhcmFtIGNiXG4gICAgICogQHBhcmFtIGVyclxuICAgICAqL1xuICAgIHVubG9ja0NvbnZlcnNhdGlvbkFzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2SXNEaXNwb3NlZCk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIuaXNEaXNwb3NlZCgpKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHRoaXMucHJpdlJvb20sIHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkU2VuZCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY2FuU2VuZEFzSG9zdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IobmV3IEVycm9yKHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkQ29udmVyc2F0aW9uLnJlcGxhY2UoXCJ7Y29tbWFuZH1cIiwgXCJ1bmxvY2tcIikpLCBlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplcikge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIuc2VuZFJlcXVlc3QodGhpcy5nZXRMb2NrQ29tbWFuZChmYWxzZSksICgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlQ2FsbGJhY2soY2IsIGVycik7XG4gICAgICAgICAgICAgICAgfSksICgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgZXJyKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBlcnIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIElzc3VlcyBhIHJlcXVlc3QgdG8gdW5tdXRlIGFsbCBwYXJ0aWNpcGFudHMgaW4gdGhlIGNvbnZlcnNhdGlvblxuICAgICAqIEBwYXJhbSBjYlxuICAgICAqIEBwYXJhbSBlcnJcbiAgICAgKi9cbiAgICB1bm11dGVBbGxQYXJ0aWNpcGFudHNBc3luYyhjYiwgZXJyKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdklzRGlzcG9zZWQpO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyLmlzRGlzcG9zZWQoKSk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZCh0aGlzLnByaXZSb29tLCB0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZFNlbmQpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmNhblNlbmRBc0hvc3QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKG5ldyBFcnJvcih0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZENvbnZlcnNhdGlvbi5yZXBsYWNlKFwie2NvbW1hbmR9XCIsIFwidW5tdXRlIGFsbFwiKSksIGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5zZW5kUmVxdWVzdCh0aGlzLmdldE11dGVBbGxDb21tYW5kKGZhbHNlKSwgKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVDYWxsYmFjayhjYiwgZXJyKTtcbiAgICAgICAgICAgICAgICB9KSwgKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBlcnIpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIGVycik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogSXNzdWVzIGEgcmVxdWVzdCB0byB1bm11dGUgYSBwYXJ0aWNpcGFudCBpbiB0aGUgY29udmVyc2F0aW9uXG4gICAgICogQHBhcmFtIHVzZXJJZFxuICAgICAqIEBwYXJhbSBjYlxuICAgICAqIEBwYXJhbSBlcnJcbiAgICAgKi9cbiAgICB1bm11dGVQYXJ0aWNpcGFudEFzeW5jKHVzZXJJZCwgY2IsIGVycikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZJc0Rpc3Bvc2VkKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5pc0Rpc3Bvc2VkKCkpO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHVzZXJJZCwgdGhpcy5wcml2RXJyb3JzLmludmFsaWRBcmdzLnJlcGxhY2UoXCJ7YXJnfVwiLCBcInVzZXJJZFwiKSk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZCh0aGlzLnByaXZSb29tLCB0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZFNlbmQpO1xuICAgICAgICAgICAgLy8gY2hlY2sgdGhlIGNvbm5lY3Rpb24gaXMgb3BlbiAoaG9zdCArIHBhcnRpY2lwYW50IGNhbiBwZXJmb3JtIHRoZSBtdXRlIGNvbW1hbmQpXG4gICAgICAgICAgICBpZiAoIXRoaXMuY2FuU2VuZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IobmV3IEVycm9yKHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkU2VuZCksIGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBpZiBub3QgaG9zdCwgY2hlY2sgdGhlIHBhcnRpY2lwYW50IGlzIG5vdCBtdXRpbmcgYW5vdGhlciBwYXJ0aWNpcGFudFxuICAgICAgICAgICAgaWYgKCF0aGlzLm1lLmlzSG9zdCAmJiB0aGlzLm1lLmlkICE9PSB1c2VySWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKG5ldyBFcnJvcih0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZFBhcnRpY2lwYW50LnJlcGxhY2UoXCJ7Y29tbWFuZH1cIiwgXCJtdXRlXCIpKSwgZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGNoZWNrIHRoZSB1c2VyIGV4aXN0c1xuICAgICAgICAgICAgY29uc3QgZXhpc3RzID0gdGhpcy5wcml2UGFydGljaXBhbnRzLmdldFBhcnRpY2lwYW50SW5kZXgodXNlcklkKTtcbiAgICAgICAgICAgIGlmIChleGlzdHMgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihuZXcgRXJyb3IodGhpcy5wcml2RXJyb3JzLmludmFsaWRQYXJ0aWNpcGFudFJlcXVlc3QpLCBlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplcikge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIuc2VuZFJlcXVlc3QodGhpcy5nZXRNdXRlQ29tbWFuZCh1c2VySWQsIGZhbHNlKSwgKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVDYWxsYmFjayhjYiwgZXJyKTtcbiAgICAgICAgICAgICAgICB9KSwgKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBlcnIpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIGVycik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZCBhIHRleHQgbWVzc2FnZVxuICAgICAqIEBwYXJhbSBtZXNzYWdlXG4gICAgICogQHBhcmFtIGNiXG4gICAgICogQHBhcmFtIGVyclxuICAgICAqL1xuICAgIHNlbmRUZXh0TWVzc2FnZUFzeW5jKG1lc3NhZ2UsIGNiLCBlcnIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2SXNEaXNwb3NlZCk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIuaXNEaXNwb3NlZCgpKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShtZXNzYWdlLCB0aGlzLnByaXZFcnJvcnMuaW52YWxpZEFyZ3MucmVwbGFjZShcInthcmd9XCIsIFwibWVzc2FnZVwiKSk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZCh0aGlzLnByaXZSb29tLCB0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZFNlbmQpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmNhblNlbmQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKG5ldyBFcnJvcih0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZFNlbmQpLCBlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gVE9ETzogaXMgYSBtYXggbGVuZ3RoIGNoZWNrIHJlcXVpcmVkP1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2UubGVuZ3RoID4gdGhpcy5wcml2VGV4dE1lc3NhZ2VNYXhMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKG5ldyBFcnJvcih0aGlzLnByaXZFcnJvcnMuaW52YWxpZEFyZ3MucmVwbGFjZShcInthcmd9XCIsIFwibWVzc2FnZSBsZW5ndGhcIikpLCBlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplcikge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIuc2VuZFJlcXVlc3QodGhpcy5nZXRNZXNzYWdlQ29tbWFuZChtZXNzYWdlKSwgKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVDYWxsYmFjayhjYiwgZXJyKTtcbiAgICAgICAgICAgICAgICB9KSwgKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBlcnIpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIGVycik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0IHRyYW5zbGF0ZWQgdG8gbGFuZ3VhZ2VzXG4gICAgICogQHBhcmFtIHtzdHJpbmdbXX0gbGFuZ3VhZ2VzIC0gbGFuZ3VhZ2VzIHRvIHRyYW5zbGF0ZSB0b1xuICAgICAqIEBwYXJhbSBjYlxuICAgICAqIEBwYXJhbSBlcnJcbiAgICAgKi9cbiAgICBzZXRUcmFuc2xhdGVkTGFuZ3VhZ2VzQXN5bmMobGFuZ3VhZ2VzLCBjYiwgZXJyKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdklzRGlzcG9zZWQpO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyLmlzRGlzcG9zZWQoKSk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkFycmF5RW1wdHlPcldoaXRlc3BhY2UobGFuZ3VhZ2VzLCB0aGlzLnByaXZFcnJvcnMuaW52YWxpZEFyZ3MucmVwbGFjZShcInthcmd9XCIsIFwibGFuZ3VhZ2VzXCIpKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHRoaXMucHJpdlJvb20sIHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkU2VuZCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY2FuU2VuZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IobmV3IEVycm9yKHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkU2VuZCksIGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5zZW5kUmVxdWVzdCh0aGlzLmdldFNldFRyYW5zbGF0ZVRvTGFuZ3VhZ2VzQ29tbWFuZChsYW5ndWFnZXMpLCAoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUNhbGxiYWNrKGNiLCBlcnIpO1xuICAgICAgICAgICAgICAgIH0pLCAoKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIGVycik7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgZXJyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGFuZ2Ugbmlja25hbWVcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmlja25hbWUgLSBuZXcgbmlja25hbWUgZm9yIHRoZSByb29tXG4gICAgICogQHBhcmFtIGNiXG4gICAgICogQHBhcmFtIGVyclxuICAgICAqL1xuICAgIGNoYW5nZU5pY2tuYW1lQXN5bmMobmlja25hbWUsIGNiLCBlcnIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2SXNEaXNwb3NlZCk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIuaXNEaXNwb3NlZCgpKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShuaWNrbmFtZSwgdGhpcy5wcml2RXJyb3JzLmludmFsaWRBcmdzLnJlcGxhY2UoXCJ7YXJnfVwiLCBcIm5pY2tuYW1lXCIpKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHRoaXMucHJpdlJvb20sIHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkU2VuZCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY2FuU2VuZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IobmV3IEVycm9yKHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkU2VuZCksIGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5zZW5kUmVxdWVzdCh0aGlzLmdldENoYW5nZU5pY2tuYW1lQ29tbWFuZChuaWNrbmFtZSksICgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlQ2FsbGJhY2soY2IsIGVycik7XG4gICAgICAgICAgICAgICAgfSksICgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgZXJyKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBlcnIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlzRGlzcG9zZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJc0Rpc3Bvc2VkO1xuICAgIH1cbiAgICBkaXNwb3NlKCkge1xuICAgICAgICBpZiAodGhpcy5pc0Rpc3Bvc2VkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgIGlmICghIXRoaXMuY29uZmlnKSB7XG4gICAgICAgICAgICB0aGlzLmNvbmZpZy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdkNvbmZpZyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5wcml2TGFuZ3VhZ2UgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucHJpdlJvb20gPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucHJpdlRva2VuID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnByaXZNYW5hZ2VyID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnByaXZJc0Nvbm5lY3RlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZJc1JlYWR5ID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdlBhcnRpY2lwYW50cyA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgY29ubmVjdFRyYW5zY3JpYmVyUmVjb2duaXplcihyZWNvZ25pemVyKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZUcmFuc2NyaWJlclJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZUcmFuc2NyaWJlclJlY29nbml6ZXIuY2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHlpZWxkIHJlY29nbml6ZXIuZW5mb3JjZUF1ZGlvR2F0aW5nKCk7XG4gICAgICAgICAgICB0aGlzLnByaXZUcmFuc2NyaWJlclJlY29nbml6ZXIgPSByZWNvZ25pemVyO1xuICAgICAgICAgICAgdGhpcy5wcml2VHJhbnNjcmliZXJSZWNvZ25pemVyLmNvbnZlcnNhdGlvbiA9IHRoaXM7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXRLZWVwQWxpdmUoKSB7XG4gICAgICAgIGNvbnN0IG5pY2tuYW1lID0gKCEhdGhpcy5tZSkgPyB0aGlzLm1lLmRpc3BsYXlOYW1lIDogXCJkZWZhdWx0X25pY2tuYW1lXCI7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBpZDogXCIwXCIsXG4gICAgICAgICAgICBuaWNrbmFtZSxcbiAgICAgICAgICAgIHBhcnRpY2lwYW50SWQ6IHRoaXMucHJpdlJvb20ucGFydGljaXBhbnRJZCxcbiAgICAgICAgICAgIHJvb21JZDogdGhpcy5wcml2Um9vbS5yb29tSWQsXG4gICAgICAgICAgICB0eXBlOiBDb252ZXJzYXRpb25UcmFuc2xhdG9yTWVzc2FnZVR5cGVzLmtlZXBBbGl2ZVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyogZXNsaW50LWVuYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvdHlwZWRlZiAqL1xuICAgIGFkZFBhcnRpY2lwYW50SW1wbEFzeW5jKHBhcnRpY2lwYW50KSB7XG4gICAgICAgIGNvbnN0IG5ld1BhcnRpY2lwYW50ID0gdGhpcy5wcml2UGFydGljaXBhbnRzLmFkZE9yVXBkYXRlUGFydGljaXBhbnQocGFydGljaXBhbnQpO1xuICAgICAgICBpZiAobmV3UGFydGljaXBhbnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2VHJhbnNjcmliZXJSZWNvZ25pemVyKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29udmVyc2F0aW9uSW5mbyA9IHRoaXMuY29udmVyc2F0aW9uSW5mbztcbiAgICAgICAgICAgICAgICBjb252ZXJzYXRpb25JbmZvLnBhcnRpY2lwYW50cyA9IFtwYXJ0aWNpcGFudF07XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRyYW5zY3JpYmVyUmVjb2duaXplci5wdXNoQ29udmVyc2F0aW9uRXZlbnQoY29udmVyc2F0aW9uSW5mbywgXCJqb2luXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJlbW92ZVBhcnRpY2lwYW50SW1wbEFzeW5jKHBhcnRpY2lwYW50KSB7XG4gICAgICAgIHRoaXMucHJpdlBhcnRpY2lwYW50cy5kZWxldGVQYXJ0aWNpcGFudChwYXJ0aWNpcGFudC5pZCk7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkluZm8gPSB0aGlzLmNvbnZlcnNhdGlvbkluZm87XG4gICAgICAgIGNvbnZlcnNhdGlvbkluZm8ucGFydGljaXBhbnRzID0gW3BhcnRpY2lwYW50XTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRyYW5zY3JpYmVyUmVjb2duaXplci5wdXNoQ29udmVyc2F0aW9uRXZlbnQoY29udmVyc2F0aW9uSW5mbywgXCJsZWF2ZVwiKTtcbiAgICB9XG4gICAgY2xvc2UoZGlzcG9zZSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdklzQ29ubmVjdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgeWllbGQgKChfYSA9IHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5jbG9zZSgpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvci5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvLyBpZ25vcmUgZXJyb3JcbiAgICAgICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRpc3Bvc2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKiBIZWxwZXJzICovXG4gICAgaGFuZGxlQ2FsbGJhY2soY2IsIGVycikge1xuICAgICAgICBpZiAoISFjYikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjYigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoISFlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyKGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNiID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfVxuICAgIGhhbmRsZUVycm9yKGVycm9yLCBlcnIpIHtcbiAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHR5cGVkRXJyb3IgPSBlcnJvcjtcbiAgICAgICAgICAgICAgICBlcnIodHlwZWRFcnJvci5uYW1lICsgXCI6IFwiICsgdHlwZWRFcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGVycihlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqIFBhcnRpY2lwYW50IEhlbHBlcnMgKi9cbiAgICB0b1BhcnRpY2lwYW50cyhpbmNsdWRlSG9zdCkge1xuICAgICAgICBjb25zdCBwYXJ0aWNpcGFudHMgPSB0aGlzLnByaXZQYXJ0aWNpcGFudHMucGFydGljaXBhbnRzLm1hcCgocCkgPT4gKHRoaXMudG9QYXJ0aWNpcGFudChwKSkpO1xuICAgICAgICBpZiAoIWluY2x1ZGVIb3N0KSB7XG4gICAgICAgICAgICByZXR1cm4gcGFydGljaXBhbnRzLmZpbHRlcigocCkgPT4gcC5pc0hvc3QgPT09IGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJ0aWNpcGFudHM7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9QYXJ0aWNpcGFudChwKSB7XG4gICAgICAgIHJldHVybiBuZXcgUGFydGljaXBhbnQocC5pZCwgcC5hdmF0YXIsIHAuZGlzcGxheU5hbWUsIHAuaXNIb3N0LCBwLmlzTXV0ZWQsIHAuaXNVc2luZ1R0cywgcC5wcmVmZXJyZWRMYW5ndWFnZSwgcC52b2ljZSk7XG4gICAgfVxuICAgIGdldE11dGVBbGxDb21tYW5kKGlzTXV0ZWQpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHRoaXMucHJpdlJvb20ucm9vbUlkLCBcImNvbnZlcnNhdGlvbklkXCIpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodGhpcy5wcml2Um9vbS5wYXJ0aWNpcGFudElkLCBcInBhcnRpY2lwYW50SWRcIik7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBjb21tYW5kOiBDb252ZXJzYXRpb25UcmFuc2xhdG9yQ29tbWFuZFR5cGVzLnNldE11dGVBbGwsXG4gICAgICAgICAgICBwYXJ0aWNpcGFudElkOiB0aGlzLnByaXZSb29tLnBhcnRpY2lwYW50SWQsXG4gICAgICAgICAgICByb29taWQ6IHRoaXMucHJpdlJvb20ucm9vbUlkLFxuICAgICAgICAgICAgdHlwZTogQ29udmVyc2F0aW9uVHJhbnNsYXRvck1lc3NhZ2VUeXBlcy5wYXJ0aWNpcGFudENvbW1hbmQsXG4gICAgICAgICAgICB2YWx1ZTogaXNNdXRlZFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZ2V0TXV0ZUNvbW1hbmQocGFydGljaXBhbnRJZCwgaXNNdXRlZCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodGhpcy5wcml2Um9vbS5yb29tSWQsIFwiY29udmVyc2F0aW9uSWRcIik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShwYXJ0aWNpcGFudElkLCBcInBhcnRpY2lwYW50SWRcIik7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBjb21tYW5kOiBDb252ZXJzYXRpb25UcmFuc2xhdG9yQ29tbWFuZFR5cGVzLnNldE11dGUsXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgb2JqZWN0LXNob3J0aGFuZFxuICAgICAgICAgICAgcGFydGljaXBhbnRJZDogcGFydGljaXBhbnRJZCxcbiAgICAgICAgICAgIHJvb21pZDogdGhpcy5wcml2Um9vbS5yb29tSWQsXG4gICAgICAgICAgICB0eXBlOiBDb252ZXJzYXRpb25UcmFuc2xhdG9yTWVzc2FnZVR5cGVzLnBhcnRpY2lwYW50Q29tbWFuZCxcbiAgICAgICAgICAgIHZhbHVlOiBpc011dGVkXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXRMb2NrQ29tbWFuZChpc0xvY2tlZCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodGhpcy5wcml2Um9vbS5yb29tSWQsIFwiY29udmVyc2F0aW9uSWRcIik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh0aGlzLnByaXZSb29tLnBhcnRpY2lwYW50SWQsIFwicGFydGljaXBhbnRJZFwiKTtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGNvbW1hbmQ6IENvbnZlcnNhdGlvblRyYW5zbGF0b3JDb21tYW5kVHlwZXMuc2V0TG9ja1N0YXRlLFxuICAgICAgICAgICAgcGFydGljaXBhbnRJZDogdGhpcy5wcml2Um9vbS5wYXJ0aWNpcGFudElkLFxuICAgICAgICAgICAgcm9vbWlkOiB0aGlzLnByaXZSb29tLnJvb21JZCxcbiAgICAgICAgICAgIHR5cGU6IENvbnZlcnNhdGlvblRyYW5zbGF0b3JNZXNzYWdlVHlwZXMucGFydGljaXBhbnRDb21tYW5kLFxuICAgICAgICAgICAgdmFsdWU6IGlzTG9ja2VkXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXRFamVjdENvbW1hbmQocGFydGljaXBhbnRJZCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodGhpcy5wcml2Um9vbS5yb29tSWQsIFwiY29udmVyc2F0aW9uSWRcIik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShwYXJ0aWNpcGFudElkLCBcInBhcnRpY2lwYW50SWRcIik7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBjb21tYW5kOiBDb252ZXJzYXRpb25UcmFuc2xhdG9yQ29tbWFuZFR5cGVzLmVqZWN0UGFydGljaXBhbnQsXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgb2JqZWN0LXNob3J0aGFuZFxuICAgICAgICAgICAgcGFydGljaXBhbnRJZDogcGFydGljaXBhbnRJZCxcbiAgICAgICAgICAgIHJvb21pZDogdGhpcy5wcml2Um9vbS5yb29tSWQsXG4gICAgICAgICAgICB0eXBlOiBDb252ZXJzYXRpb25UcmFuc2xhdG9yTWVzc2FnZVR5cGVzLnBhcnRpY2lwYW50Q29tbWFuZCxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldFNldFRyYW5zbGF0ZVRvTGFuZ3VhZ2VzQ29tbWFuZChsYW5ndWFnZXMpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHRoaXMucHJpdlJvb20ucm9vbUlkLCBcImNvbnZlcnNhdGlvbklkXCIpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodGhpcy5wcml2Um9vbS5wYXJ0aWNpcGFudElkLCBcInBhcnRpY2lwYW50SWRcIik7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBjb21tYW5kOiBDb252ZXJzYXRpb25UcmFuc2xhdG9yQ29tbWFuZFR5cGVzLnNldFRyYW5zbGF0ZVRvTGFuZ3VhZ2VzLFxuICAgICAgICAgICAgcGFydGljaXBhbnRJZDogdGhpcy5wcml2Um9vbS5wYXJ0aWNpcGFudElkLFxuICAgICAgICAgICAgcm9vbWlkOiB0aGlzLnByaXZSb29tLnJvb21JZCxcbiAgICAgICAgICAgIHR5cGU6IENvbnZlcnNhdGlvblRyYW5zbGF0b3JNZXNzYWdlVHlwZXMucGFydGljaXBhbnRDb21tYW5kLFxuICAgICAgICAgICAgdmFsdWU6IGxhbmd1YWdlc1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZ2V0Q2hhbmdlTmlja25hbWVDb21tYW5kKG5pY2tuYW1lKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh0aGlzLnByaXZSb29tLnJvb21JZCwgXCJjb252ZXJzYXRpb25JZFwiKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKG5pY2tuYW1lLCBcIm5pY2tuYW1lXCIpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodGhpcy5wcml2Um9vbS5wYXJ0aWNpcGFudElkLCBcInBhcnRpY2lwYW50SWRcIik7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBjb21tYW5kOiBDb252ZXJzYXRpb25UcmFuc2xhdG9yQ29tbWFuZFR5cGVzLmNoYW5nZU5pY2tuYW1lLFxuICAgICAgICAgICAgbmlja25hbWUsXG4gICAgICAgICAgICBwYXJ0aWNpcGFudElkOiB0aGlzLnByaXZSb29tLnBhcnRpY2lwYW50SWQsXG4gICAgICAgICAgICByb29taWQ6IHRoaXMucHJpdlJvb20ucm9vbUlkLFxuICAgICAgICAgICAgdHlwZTogQ29udmVyc2F0aW9uVHJhbnNsYXRvck1lc3NhZ2VUeXBlcy5wYXJ0aWNpcGFudENvbW1hbmQsXG4gICAgICAgICAgICB2YWx1ZTogbmlja25hbWVcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldE1lc3NhZ2VDb21tYW5kKG1lc3NhZ2UpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHRoaXMucHJpdlJvb20ucm9vbUlkLCBcImNvbnZlcnNhdGlvbklkXCIpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodGhpcy5wcml2Um9vbS5wYXJ0aWNpcGFudElkLCBcInBhcnRpY2lwYW50SWRcIik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShtZXNzYWdlLCBcIm1lc3NhZ2VcIik7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBwYXJ0aWNpcGFudElkOiB0aGlzLnByaXZSb29tLnBhcnRpY2lwYW50SWQsXG4gICAgICAgICAgICByb29tSWQ6IHRoaXMucHJpdlJvb20ucm9vbUlkLFxuICAgICAgICAgICAgdGV4dDogbWVzc2FnZSxcbiAgICAgICAgICAgIHR5cGU6IENvbnZlcnNhdGlvblRyYW5zbGF0b3JNZXNzYWdlVHlwZXMuaW5zdGFudE1lc3NhZ2VcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db252ZXJzYXRpb24uanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25Db21tb24ge1xuICAgIGNvbnN0cnVjdG9yKGF1ZGlvQ29uZmlnKSB7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvQ29uZmlnID0gYXVkaW9Db25maWc7XG4gICAgfVxuICAgIGhhbmRsZUNhbGxiYWNrKGNiLCBlcnIpIHtcbiAgICAgICAgaWYgKCEhY2IpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycihlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYiA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVFcnJvcihlcnJvciwgZXJyKSB7XG4gICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0eXBlZEVycm9yID0gZXJyb3I7XG4gICAgICAgICAgICAgICAgZXJyKHR5cGVkRXJyb3IubmFtZSArIFwiOiBcIiArIHR5cGVkRXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBlcnIoZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db252ZXJzYXRpb25Db21tb24uanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8vIE11bHRpLWRldmljZSBDb252ZXJzYXRpb24gaXMgYSBQcmV2aWV3IGZlYXR1cmUuXG5pbXBvcnQgeyBTZXNzaW9uRXZlbnRBcmdzIH0gZnJvbSBcIi4uL0V4cG9ydHNcIjtcbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25FeHBpcmF0aW9uRXZlbnRBcmdzIGV4dGVuZHMgU2Vzc2lvbkV2ZW50QXJncyB7XG4gICAgY29uc3RydWN0b3IoZXhwaXJhdGlvblRpbWUsIHNlc3Npb25JZCkge1xuICAgICAgICBzdXBlcihzZXNzaW9uSWQpO1xuICAgICAgICB0aGlzLnByaXZFeHBpcmF0aW9uVGltZSA9IGV4cGlyYXRpb25UaW1lO1xuICAgIH1cbiAgICAvKiogSG93IG11Y2ggbG9uZ2VyIHVudGlsIHRoZSBjb252ZXJzYXRpb24gZXhwaXJlcyAoaW4gbWludXRlcykuICovXG4gICAgZ2V0IGV4cGlyYXRpb25UaW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXhwaXJhdGlvblRpbWU7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db252ZXJzYXRpb25FeHBpcmF0aW9uRXZlbnRBcmdzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vLyBNdWx0aS1kZXZpY2UgQ29udmVyc2F0aW9uIGlzIGEgUHJldmlldyBmZWF0dXJlLlxuaW1wb3J0IHsgU2Vzc2lvbkV2ZW50QXJncyB9IGZyb20gXCIuLi9FeHBvcnRzXCI7XG5leHBvcnQgY2xhc3MgQ29udmVyc2F0aW9uUGFydGljaXBhbnRzQ2hhbmdlZEV2ZW50QXJncyBleHRlbmRzIFNlc3Npb25FdmVudEFyZ3Mge1xuICAgIGNvbnN0cnVjdG9yKHJlYXNvbiwgcGFydGljaXBhbnRzLCBzZXNzaW9uSWQpIHtcbiAgICAgICAgc3VwZXIoc2Vzc2lvbklkKTtcbiAgICAgICAgdGhpcy5wcml2UmVhc29uID0gcmVhc29uO1xuICAgICAgICB0aGlzLnByaXZQYXJ0aWNpcGFudCA9IHBhcnRpY2lwYW50cztcbiAgICB9XG4gICAgZ2V0IHJlYXNvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlYXNvbjtcbiAgICB9XG4gICAgZ2V0IHBhcnRpY2lwYW50cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhcnRpY2lwYW50O1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29udmVyc2F0aW9uUGFydGljaXBhbnRzQ2hhbmdlZEV2ZW50QXJncy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBUcmFuc2NyaWJlclJlY29nbml6ZXIgfSBmcm9tIFwiLi4vLi4vY29tbW9uLnNwZWVjaC9FeHBvcnRzXCI7XG5pbXBvcnQgeyBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBDb25uZWN0aW9uLCBQcm9wZXJ0eUNvbGxlY3Rpb24sIFByb3BlcnR5SWQgfSBmcm9tIFwiLi4vRXhwb3J0c1wiO1xuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvblRyYW5zY3JpYmVyIHtcbiAgICAvKipcbiAgICAgKiBDb252ZXJzYXRpb25UcmFuc2NyaWJlciBjb25zdHJ1Y3Rvci5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge0F1ZGlvQ29uZmlnfSBhdWRpb0NvbmZpZyAtIEFuIG9wdGlvbmFsIGF1ZGlvIGNvbmZpZ3VyYXRpb24gYXNzb2NpYXRlZCB3aXRoIHRoZSByZWNvZ25pemVyXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoYXVkaW9Db25maWcpIHtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9Db25maWcgPSBhdWRpb0NvbmZpZztcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcyA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICAgICAgdGhpcy5wcml2UmVjb2duaXplciA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5wcml2RGlzcG9zZWRSZWNvZ25pemVyID0gZmFsc2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIHNwb2tlbiBsYW5ndWFnZSBvZiByZWNvZ25pdGlvbi5cbiAgICAgKiBAbWVtYmVyIENvbnZlcnNhdGlvblRyYW5zY3JpYmVyLnByb3RvdHlwZS5zcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBzcG9rZW4gbGFuZ3VhZ2Ugb2YgcmVjb2duaXRpb24uXG4gICAgICovXG4gICAgZ2V0IHNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2UoKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWRSZWNvZ25pemVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBjb2xsZWN0aW9uIG9mIHByb3BlcnRpZXMgYW5kIHRoZWlyIHZhbHVlcyBkZWZpbmVkIGZvciB0aGlzIENvbnZlcnNhdGlvblRyYW5zY3JpYmVyLlxuICAgICAqIEBtZW1iZXIgQ29udmVyc2F0aW9uVHJhbnNjcmliZXIucHJvdG90eXBlLnByb3BlcnRpZXNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1Byb3BlcnR5Q29sbGVjdGlvbn0gVGhlIGNvbGxlY3Rpb24gb2YgcHJvcGVydGllcyBhbmQgdGhlaXIgdmFsdWVzIGRlZmluZWQgZm9yIHRoaXMgQ29udmVyc2F0aW9uVHJhbnNjcmliZXIuXG4gICAgICovXG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBASW50ZXJuYWxcbiAgICAgKiBJbnRlcm5hbCBkYXRhIG1lbWJlciB0byBzdXBwb3J0IGZyb21SZWNvZ25pemVyKiBwYXR0ZXJuIG1ldGhvZHMgb24gb3RoZXIgY2xhc3Nlcy5cbiAgICAgKiBEbyBub3QgdXNlIGV4dGVybmFsbHksIG9iamVjdCByZXR1cm5lZCB3aWxsIGNoYW5nZSB3aXRob3V0IHdhcm5pbmcgb3Igbm90aWNlLlxuICAgICAqL1xuICAgIGdldCBpbnRlcm5hbERhdGEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZWNvZ25pemVyLmludGVybmFsRGF0YTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQERlcHJlY2F0ZWRcbiAgICAgKiBAT2Jzb2xldGVcbiAgICAgKiBQbGVhc2UgdXNlIHRoZSBDb25uZWN0aW9uLmZyb21SZWNvZ25pemVyIHBhdHRlcm4gdG8gb2J0YWluIGEgY29ubmVjdGlvbiBvYmplY3RcbiAgICAgKi9cbiAgICBnZXQgY29ubmVjdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIENvbm5lY3Rpb24uZnJvbVJlY29nbml6ZXIodGhpcy5wcml2UmVjb2duaXplcik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGF1dGhvcml6YXRpb24gdG9rZW4gdXNlZCB0byBjb21tdW5pY2F0ZSB3aXRoIHRoZSBzZXJ2aWNlLlxuICAgICAqIEBtZW1iZXIgQ29udmVyc2F0aW9uVHJhbnNjcmliZXIucHJvdG90eXBlLmF1dGhvcml6YXRpb25Ub2tlblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBBdXRob3JpemF0aW9uIHRva2VuLlxuICAgICAqL1xuICAgIGdldCBhdXRob3JpemF0aW9uVG9rZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMvU2V0cyB0aGUgYXV0aG9yaXphdGlvbiB0b2tlbiB1c2VkIHRvIGNvbW11bmljYXRlIHdpdGggdGhlIHNlcnZpY2UuXG4gICAgICogQG1lbWJlciBDb252ZXJzYXRpb25UcmFuc2NyaWJlci5wcm90b3R5cGUuYXV0aG9yaXphdGlvblRva2VuXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0b2tlbiAtIEF1dGhvcml6YXRpb24gdG9rZW4uXG4gICAgICovXG4gICAgc2V0IGF1dGhvcml6YXRpb25Ub2tlbih0b2tlbikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodG9rZW4sIFwidG9rZW5cIik7XG4gICAgICAgIHRoaXMucHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuLCB0b2tlbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Q29udmVyc2F0aW9ufSBjb252ZXJzYXRpb24gLSBjb252ZXJzYXRpb24gdG8gYmUgcmVjb2duaXplZFxuICAgICAqL1xuICAgIGpvaW5Db252ZXJzYXRpb25Bc3luYyhjb252ZXJzYXRpb24sIGNiLCBlcnIpIHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uSW1wbCA9IGNvbnZlcnNhdGlvbjtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQoY29udmVyc2F0aW9uSW1wbCwgXCJDb252ZXJzYXRpb25cIik7XG4gICAgICAgIC8vIHJlZiB0aGUgY29udmVyc2F0aW9uIG9iamVjdFxuICAgICAgICAvLyBjcmVhdGUgcmVjb2duaXplciBhbmQgc3Vic2NyaWJlIHRvIHJlY29nbml6ZXIgZXZlbnRzXG4gICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXIgPSBuZXcgVHJhbnNjcmliZXJSZWNvZ25pemVyKGNvbnZlcnNhdGlvbi5jb25maWcsIHRoaXMucHJpdkF1ZGlvQ29uZmlnKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQodGhpcy5wcml2UmVjb2duaXplciwgXCJSZWNvZ25pemVyXCIpO1xuICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyLmNvbm5lY3RDYWxsYmFja3ModGhpcyk7XG4gICAgICAgIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3MoY29udmVyc2F0aW9uSW1wbC5jb25uZWN0VHJhbnNjcmliZXJSZWNvZ25pemVyKHRoaXMucHJpdlJlY29nbml6ZXIpLCBjYiwgZXJyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RhcnRzIGNvbnZlcnNhdGlvbiB0cmFuc2NyaXB0aW9uLCB1bnRpbCBzdG9wVHJhbnNjcmliaW5nQXN5bmMoKSBpcyBjYWxsZWQuXG4gICAgICogVXNlciBtdXN0IHN1YnNjcmliZSB0byBldmVudHMgdG8gcmVjZWl2ZSB0cmFuc2NyaXB0aW9uIHJlc3VsdHMuXG4gICAgICogQG1lbWJlciBDb252ZXJzYXRpb25UcmFuc2NyaWJlci5wcm90b3R5cGUuc3RhcnRUcmFuc2NyaWJpbmdBc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0gY2IgLSBDYWxsYmFjayBpbnZva2VkIG9uY2UgdGhlIHRyYW5zY3JpcHRpb24gaGFzIHN0YXJ0ZWQuXG4gICAgICogQHBhcmFtIGVyciAtIENhbGxiYWNrIGludm9rZWQgaW4gY2FzZSBvZiBhbiBlcnJvci5cbiAgICAgKi9cbiAgICBzdGFydFRyYW5zY3JpYmluZ0FzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgdGhpcy5wcml2UmVjb2duaXplci5zdGFydENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jKGNiLCBlcnIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgY29udmVyc2F0aW9uIHRyYW5zY3JpcHRpb24sIHVudGlsIHN0b3BUcmFuc2NyaWJpbmdBc3luYygpIGlzIGNhbGxlZC5cbiAgICAgKiBVc2VyIG11c3Qgc3Vic2NyaWJlIHRvIGV2ZW50cyB0byByZWNlaXZlIHRyYW5zY3JpcHRpb24gcmVzdWx0cy5cbiAgICAgKiBAbWVtYmVyIENvbnZlcnNhdGlvblRyYW5zY3JpYmVyLnByb3RvdHlwZS5zdG9wVHJhbnNjcmliaW5nQXN5bmNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIGNiIC0gQ2FsbGJhY2sgaW52b2tlZCBvbmNlIHRoZSB0cmFuc2NyaXB0aW9uIGhhcyBzdGFydGVkLlxuICAgICAqIEBwYXJhbSBlcnIgLSBDYWxsYmFjayBpbnZva2VkIGluIGNhc2Ugb2YgYW4gZXJyb3IuXG4gICAgICovXG4gICAgc3RvcFRyYW5zY3JpYmluZ0FzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgdGhpcy5wcml2UmVjb2duaXplci5zdG9wQ29udGludW91c1JlY29nbml0aW9uQXN5bmMoY2IsIGVycik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExlYXZlIHRoZSBjdXJyZW50IGNvbnZlcnNhdGlvbi4gQWZ0ZXIgdGhpcyBpcyBjYWxsZWQsIHlvdSB3aWxsIG5vIGxvbmdlciByZWNlaXZlIGFueSBldmVudHMuXG4gICAgICovXG4gICAgbGVhdmVDb252ZXJzYXRpb25Bc3luYyhjYiwgZXJyKSB7XG4gICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXIuZGlzY29ubmVjdENhbGxiYWNrcygpO1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcygoKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkgeyByZXR1cm47IH0pKSgpLCBjYiwgZXJyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogY2xvc2VzIGFsbCBleHRlcm5hbCByZXNvdXJjZXMgaGVsZCBieSBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBtZW1iZXIgQ29udmVyc2F0aW9uVHJhbnNjcmliZXIucHJvdG90eXBlLmNsb3NlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGNsb3NlKGNiLCBlcnJvckNiKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWRSZWNvZ25pemVyKTtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLmRpc3Bvc2UodHJ1ZSksIGNiLCBlcnJvckNiKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGlzcG9zZXMgYW55IHJlc291cmNlcyBoZWxkIGJ5IHRoZSBvYmplY3QuXG4gICAgICogQG1lbWJlciBDb252ZXJzYXRpb25UcmFuc2NyaWJlci5wcm90b3R5cGUuZGlzcG9zZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGRpc3Bvc2luZyAtIHRydWUgaWYgZGlzcG9zaW5nIHRoZSBvYmplY3QuXG4gICAgICovXG4gICAgZGlzcG9zZShkaXNwb3NpbmcpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZEaXNwb3NlZFJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZSZWNvZ25pemVyKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2UmVjb2duaXplci5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGlzcG9zaW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2RGlzcG9zZWRSZWNvZ25pemVyID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db252ZXJzYXRpb25UcmFuc2NyaWJlci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLy8gTXVsdGktZGV2aWNlIENvbnZlcnNhdGlvbiBpcyBhIFByZXZpZXcgZmVhdHVyZS5cbmltcG9ydCB7IENhbmNlbGxhdGlvbkV2ZW50QXJnc0Jhc2UgfSBmcm9tIFwiLi4vQ2FuY2VsbGF0aW9uRXZlbnRBcmdzQmFzZVwiO1xuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvblRyYW5zbGF0aW9uQ2FuY2VsZWRFdmVudEFyZ3MgZXh0ZW5kcyBDYW5jZWxsYXRpb25FdmVudEFyZ3NCYXNlIHtcbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29udmVyc2F0aW9uVHJhbnNsYXRpb25DYW5jZWxlZEV2ZW50QXJncy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLy8gTXVsdGktZGV2aWNlIENvbnZlcnNhdGlvbiBpcyBhIFByZXZpZXcgZmVhdHVyZS5cbmltcG9ydCB7IFJlY29nbml0aW9uRXZlbnRBcmdzIH0gZnJvbSBcIi4uL0V4cG9ydHNcIjtcbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25UcmFuc2xhdGlvbkV2ZW50QXJncyBleHRlbmRzIFJlY29nbml0aW9uRXZlbnRBcmdzIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7Q29udmVyc2F0aW9uVHJhbnNsYXRpb25SZXN1bHR9IHJlc3VsdCAtIFRoZSB0cmFuc2xhdGlvbiByZWNvZ25pdGlvbiByZXN1bHQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG9mZnNldCAtIFRoZSBvZmZzZXQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHNlc3Npb25JZCAtIFRoZSBzZXNzaW9uIGlkLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlc3VsdCwgb2Zmc2V0LCBzZXNzaW9uSWQpIHtcbiAgICAgICAgc3VwZXIob2Zmc2V0LCBzZXNzaW9uSWQpO1xuICAgICAgICB0aGlzLnByaXZSZXN1bHQgPSByZXN1bHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyB0aGUgcmVjb2duaXRpb24gcmVzdWx0LlxuICAgICAqIEByZXR1cm5zIHtDb252ZXJzYXRpb25UcmFuc2xhdGlvblJlc3VsdH0gdGhlIHJlY29nbml0aW9uIHJlc3VsdC5cbiAgICAgKi9cbiAgICBnZXQgcmVzdWx0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVzdWx0O1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29udmVyc2F0aW9uVHJhbnNsYXRpb25FdmVudEFyZ3MuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8vIE11bHRpLWRldmljZSBDb252ZXJzYXRpb24gaXMgYSBQcmV2aWV3IGZlYXR1cmUuXG5pbXBvcnQgeyBUcmFuc2xhdGlvblJlY29nbml0aW9uUmVzdWx0IH0gZnJvbSBcIi4uL1RyYW5zbGF0aW9uUmVjb2duaXRpb25SZXN1bHRcIjtcbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25UcmFuc2xhdGlvblJlc3VsdCBleHRlbmRzIFRyYW5zbGF0aW9uUmVjb2duaXRpb25SZXN1bHQge1xuICAgIGNvbnN0cnVjdG9yKHBhcnRpY2lwYW50SWQsIHRyYW5zbGF0aW9ucywgb3JpZ2luYWxMYW5ndWFnZSwgcmVzdWx0SWQsIHJlYXNvbiwgdGV4dCwgZHVyYXRpb24sIG9mZnNldCwgZXJyb3JEZXRhaWxzLCBqc29uLCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgIHN1cGVyKHRyYW5zbGF0aW9ucywgcmVzdWx0SWQsIHJlYXNvbiwgdGV4dCwgZHVyYXRpb24sIG9mZnNldCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGVycm9yRGV0YWlscywganNvbiwgcHJvcGVydGllcyk7XG4gICAgICAgIHRoaXMucHJpdklkID0gcGFydGljaXBhbnRJZDtcbiAgICAgICAgdGhpcy5wcml2T3JpZ0xhbmcgPSBvcmlnaW5hbExhbmd1YWdlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBwYXJ0aWNpcGFudCB0aGlzIHJlc3VsdCBpcyBmb3IuXG4gICAgICovXG4gICAgZ2V0IHBhcnRpY2lwYW50SWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIG9yaWdpbmFsIGxhbmd1YWdlIHRoaXMgcmVzdWx0IHdhcyBpbi5cbiAgICAgKi9cbiAgICBnZXQgb3JpZ2luYWxMYW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2T3JpZ0xhbmc7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db252ZXJzYXRpb25UcmFuc2xhdGlvblJlc3VsdC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLy8gTXVsdGktZGV2aWNlIENvbnZlcnNhdGlvbiBpcyBhIFByZXZpZXcgZmVhdHVyZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuLyogZXNsaW50LWRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGUgKi9cbmltcG9ydCB7IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcsIFNlcnZpY2VQcm9wZXJ0aWVzUHJvcGVydHlOYW1lLCB9IGZyb20gXCIuLi8uLi9jb21tb24uc3BlZWNoL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnZlcnNhdGlvblRyYW5zbGF0b3JDb25uZWN0aW9uRmFjdG9yeSB9IGZyb20gXCIuLi8uLi9jb21tb24uc3BlZWNoL1RyYW5zY3JpcHRpb24vQ29udmVyc2F0aW9uVHJhbnNsYXRvckNvbm5lY3Rpb25GYWN0b3J5XCI7XG5pbXBvcnQgeyBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBBdWRpb0NvbmZpZywgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLCBDYW5jZWxsYXRpb25SZWFzb24sIFByb2Zhbml0eU9wdGlvbiwgUHJvcGVydHlDb2xsZWN0aW9uLCBQcm9wZXJ0eUlkLCBTZXJ2aWNlUHJvcGVydHlDaGFubmVsLCBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZywgVHJhbnNsYXRpb25SZWNvZ25pemVyIH0gZnJvbSBcIi4uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnZlcnNhdGlvbkltcGwgfSBmcm9tIFwiLi9Db252ZXJzYXRpb25cIjtcbmltcG9ydCB7IENvbnZlcnNhdGlvbkNvbW1vbiwgQ29udmVyc2F0aW9uVHJhbnNsYXRpb25DYW5jZWxlZEV2ZW50QXJncyB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbmV4cG9ydCB2YXIgU3BlZWNoU3RhdGU7XG4oZnVuY3Rpb24gKFNwZWVjaFN0YXRlKSB7XG4gICAgU3BlZWNoU3RhdGVbU3BlZWNoU3RhdGVbXCJJbmFjdGl2ZVwiXSA9IDBdID0gXCJJbmFjdGl2ZVwiO1xuICAgIFNwZWVjaFN0YXRlW1NwZWVjaFN0YXRlW1wiQ29ubmVjdGluZ1wiXSA9IDFdID0gXCJDb25uZWN0aW5nXCI7XG4gICAgU3BlZWNoU3RhdGVbU3BlZWNoU3RhdGVbXCJDb25uZWN0ZWRcIl0gPSAyXSA9IFwiQ29ubmVjdGVkXCI7XG59KShTcGVlY2hTdGF0ZSB8fCAoU3BlZWNoU3RhdGUgPSB7fSkpO1xuLy8gY2hpbGQgY2xhc3Mgb2YgVHJhbnNsYXRpb25SZWNvZ25pemVyIG1lYW50IG9ubHkgZm9yIHVzZSB3aXRoIENvbnZlcnNhdGlvblRyYW5zbGF0b3JcbmNsYXNzIENvbnZlcnNhdGlvblRyYW5zbGF0aW9uUmVjb2duaXplciBleHRlbmRzIFRyYW5zbGF0aW9uUmVjb2duaXplciB7XG4gICAgY29uc3RydWN0b3Ioc3BlZWNoQ29uZmlnLCBhdWRpb0NvbmZpZywgdHJhbnNsYXRvciwgY29udkdldHRlcikge1xuICAgICAgICBzdXBlcihzcGVlY2hDb25maWcsIGF1ZGlvQ29uZmlnLCBuZXcgQ29udmVyc2F0aW9uVHJhbnNsYXRvckNvbm5lY3Rpb25GYWN0b3J5KGNvbnZHZXR0ZXIpKTtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoU3RhdGUgPSBTcGVlY2hTdGF0ZS5JbmFjdGl2ZTtcbiAgICAgICAgaWYgKCEhdHJhbnNsYXRvcikge1xuICAgICAgICAgICAgdGhpcy5wcml2VHJhbnNsYXRvciA9IHRyYW5zbGF0b3I7XG4gICAgICAgICAgICB0aGlzLnNlc3Npb25TdGFydGVkID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaFN0YXRlID0gU3BlZWNoU3RhdGUuQ29ubmVjdGVkO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuc2Vzc2lvblN0b3BwZWQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoU3RhdGUgPSBTcGVlY2hTdGF0ZS5JbmFjdGl2ZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnJlY29nbml6aW5nID0gKHRyLCBlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2VHJhbnNsYXRvci5yZWNvZ25pemluZykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZUcmFuc2xhdG9yLnJlY29nbml6aW5nKHRoaXMucHJpdlRyYW5zbGF0b3IsIGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLW1pc3VzZWQtcHJvbWlzZXNcbiAgICAgICAgICAgIHRoaXMucmVjb2duaXplZCA9ICh0ciwgZSkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgICAgICAvLyBpZiB0aGVyZSBpcyBhbiBlcnJvciBjb25uZWN0aW5nIHRvIHRoZSBjb252ZXJzYXRpb24gc2VydmljZSBmcm9tIHRoZSBzcGVlY2ggc2VydmljZSB0aGUgZXJyb3Igd2lsbCBiZSByZXR1cm5lZCBpbiB0aGUgRXJyb3JEZXRhaWxzIGZpZWxkLlxuICAgICAgICAgICAgICAgIGlmICgoX2EgPSBlLnJlc3VsdCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmVycm9yRGV0YWlscykge1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmNhbmNlbFNwZWVjaCgpO1xuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBmb3JtYXQgdGhlIGVycm9yIG1lc3NhZ2UgY29udGFpbmVkIGluICdlcnJvckRldGFpbHMnXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlyZUNhbmNlbEV2ZW50KGUucmVzdWx0LmVycm9yRGV0YWlscyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZUcmFuc2xhdG9yLnJlY29nbml6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlRyYW5zbGF0b3IucmVjb2duaXplZCh0aGlzLnByaXZUcmFuc2xhdG9yLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbWlzdXNlZC1wcm9taXNlc1xuICAgICAgICAgICAgdGhpcy5jYW5jZWxlZCA9ICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2U3BlZWNoU3RhdGUgIT09IFNwZWVjaFN0YXRlLkluYWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmNhbmNlbFNwZWVjaCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoU3RhdGUgPSBTcGVlY2hTdGF0ZS5JbmFjdGl2ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBzdGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaFN0YXRlO1xuICAgIH1cbiAgICBzZXQgc3RhdGUobmV3U3RhdGUpIHtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoU3RhdGUgPSBuZXdTdGF0ZTtcbiAgICB9XG4gICAgb25Db25uZWN0aW9uKCkge1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hTdGF0ZSA9IFNwZWVjaFN0YXRlLkNvbm5lY3RlZDtcbiAgICB9XG4gICAgb25EaXNjb25uZWN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoU3RhdGUgPSBTcGVlY2hTdGF0ZS5JbmFjdGl2ZTtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuY2FuY2VsU3BlZWNoKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGaXJlIGEgY2FuY2VsIGV2ZW50XG4gICAgICogQHBhcmFtIGVycm9yXG4gICAgICovXG4gICAgZmlyZUNhbmNlbEV2ZW50KGVycm9yKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZUcmFuc2xhdG9yLmNhbmNlbGVkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2FuY2VsRXZlbnQgPSBuZXcgQ29udmVyc2F0aW9uVHJhbnNsYXRpb25DYW5jZWxlZEV2ZW50QXJncyhDYW5jZWxsYXRpb25SZWFzb24uRXJyb3IsIGVycm9yLCBDYW5jZWxsYXRpb25FcnJvckNvZGUuUnVudGltZUVycm9yKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZUcmFuc2xhdG9yLmNhbmNlbGVkKHRoaXMucHJpdlRyYW5zbGF0b3IsIGNhbmNlbEV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgLy9cbiAgICAgICAgfVxuICAgIH1cbiAgICBjYW5jZWxTcGVlY2goKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdG9wQ29udGludW91c1JlY29nbml0aW9uQXN5bmMoKTtcbiAgICAgICAgICAgICAgICB5aWVsZCAoKF9hID0gdGhpcy5wcml2UmVjbykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmRpc2Nvbm5lY3QoKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoU3RhdGUgPSBTcGVlY2hTdGF0ZS5JbmFjdGl2ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy8gaWdub3JlIHRoZSBlcnJvclxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG4vKipcbiAqIEpvaW4sIGxlYXZlIG9yIGNvbm5lY3QgdG8gYSBjb252ZXJzYXRpb24uXG4gKi9cbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25UcmFuc2xhdG9yIGV4dGVuZHMgQ29udmVyc2F0aW9uQ29tbW9uIHtcbiAgICBjb25zdHJ1Y3RvcihhdWRpb0NvbmZpZykge1xuICAgICAgICBzdXBlcihhdWRpb0NvbmZpZyk7XG4gICAgICAgIHRoaXMucHJpdkVycm9ycyA9IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcucmVzdEVycm9ycztcbiAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZJc1NwZWFraW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdlBsYWNlaG9sZGVyS2V5ID0gXCJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NVwiO1xuICAgICAgICB0aGlzLnByaXZQbGFjZWhvbGRlclJlZ2lvbiA9IFwid2VzdHVzXCI7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMgPSBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCk7XG4gICAgfVxuICAgIGdldCBwcm9wZXJ0aWVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcztcbiAgICB9XG4gICAgZ2V0IHNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlO1xuICAgIH1cbiAgICBnZXQgcGFydGljaXBhbnRzKCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiAoX2EgPSB0aGlzLnByaXZDb252ZXJzYXRpb24pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wYXJ0aWNpcGFudHM7XG4gICAgfVxuICAgIGdldCBjYW5TcGVhaygpIHtcbiAgICAgICAgLy8gaXMgdGhlcmUgYSBDb252ZXJzYXRpb24gd2Vic29ja2V0IGF2YWlsYWJsZSBhbmQgaGFzIHRoZSBSZWNvZ25pemVyIGJlZW4gc2V0IHVwXG4gICAgICAgIGlmICghdGhpcy5wcml2Q29udmVyc2F0aW9uLmlzQ29ubmVjdGVkIHx8ICF0aGlzLnByaXZDVFJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICAvLyBpcyB0aGUgdXNlciBhbHJlYWR5IHNwZWFraW5nXG4gICAgICAgIGlmICh0aGlzLnByaXZJc1NwZWFraW5nIHx8IHRoaXMucHJpdkNUUmVjb2duaXplci5zdGF0ZSA9PT0gU3BlZWNoU3RhdGUuQ29ubmVjdGVkIHx8IHRoaXMucHJpdkNUUmVjb2duaXplci5zdGF0ZSA9PT0gU3BlZWNoU3RhdGUuQ29ubmVjdGluZykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIC8vIGlzIHRoZSB1c2VyIG11dGVkXG4gICAgICAgIGlmICh0aGlzLnByaXZDb252ZXJzYXRpb24uaXNNdXRlZEJ5SG9zdCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBzZXRTZXJ2aWNlUHJvcGVydHkobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgY29uc3QgY3VycmVudFByb3BlcnRpZXMgPSBKU09OLnBhcnNlKHRoaXMucHJpdlByb3BlcnRpZXMuZ2V0UHJvcGVydHkoU2VydmljZVByb3BlcnRpZXNQcm9wZXJ0eU5hbWUsIFwie31cIikpO1xuICAgICAgICBjdXJyZW50UHJvcGVydGllc1tuYW1lXSA9IHZhbHVlO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFNlcnZpY2VQcm9wZXJ0aWVzUHJvcGVydHlOYW1lLCBKU09OLnN0cmluZ2lmeShjdXJyZW50UHJvcGVydGllcykpO1xuICAgIH1cbiAgICBqb2luQ29udmVyc2F0aW9uQXN5bmMoY29udmVyc2F0aW9uLCBuaWNrbmFtZSwgcGFyYW0xLCBwYXJhbTIsIHBhcmFtMykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBjb252ZXJzYXRpb24gPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChjb252ZXJzYXRpb24sIHRoaXMucHJpdkVycm9ycy5pbnZhbGlkQXJncy5yZXBsYWNlKFwie2FyZ31cIiwgXCJjb252ZXJzYXRpb24gaWRcIikpO1xuICAgICAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShuaWNrbmFtZSwgdGhpcy5wcml2RXJyb3JzLmludmFsaWRBcmdzLnJlcGxhY2UoXCJ7YXJnfVwiLCBcIm5pY2tuYW1lXCIpKTtcbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihuZXcgRXJyb3IodGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRTdGFydCksIHBhcmFtMyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxldCBsYW5nID0gcGFyYW0xO1xuICAgICAgICAgICAgICAgIGlmIChsYW5nID09PSB1bmRlZmluZWQgfHwgbGFuZyA9PT0gbnVsbCB8fCBsYW5nID09PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGxhbmcgPSBDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLmRlZmF1bHRMYW5ndWFnZUNvZGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBhIHBsYWNlaG9sZGVyIGNvbmZpZ1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnID0gU3BlZWNoVHJhbnNsYXRpb25Db25maWcuZnJvbVN1YnNjcmlwdGlvbih0aGlzLnByaXZQbGFjZWhvbGRlcktleSwgdGhpcy5wcml2UGxhY2Vob2xkZXJSZWdpb24pO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnLnNldFByb2Zhbml0eShQcm9mYW5pdHlPcHRpb24uTWFza2VkKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZy5hZGRUYXJnZXRMYW5ndWFnZShsYW5nKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlXSwgbGFuZyk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoVHJhbnNsYXRpb25Db25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZFtQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvblRyYW5zbGF0b3JfTmFtZV0sIG5pY2tuYW1lKTtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9wZXJ0eUlkc1RvQ29weSA9IFtcbiAgICAgICAgICAgICAgICAgICAgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Ib3N0LFxuICAgICAgICAgICAgICAgICAgICBQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvblRyYW5zbGF0b3JfSG9zdCxcbiAgICAgICAgICAgICAgICAgICAgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludCxcbiAgICAgICAgICAgICAgICAgICAgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Qcm94eUhvc3ROYW1lLFxuICAgICAgICAgICAgICAgICAgICBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5UGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgICAgIFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUHJveHlQb3J0LFxuICAgICAgICAgICAgICAgICAgICBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5VXNlck5hbWUsXG4gICAgICAgICAgICAgICAgICAgIFwiQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9NdWx0aUNoYW5uZWxBdWRpb1wiLFxuICAgICAgICAgICAgICAgICAgICBcIkNvbnZlcnNhdGlvblRyYW5zbGF0b3JfUmVnaW9uXCJcbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcHJvcCBvZiBwcm9wZXJ0eUlkc1RvQ29weSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMucHJpdlByb3BlcnRpZXMuZ2V0UHJvcGVydHkocHJvcCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gdHlwZW9mIHByb3AgPT09IFwic3RyaW5nXCIgPyBwcm9wIDogUHJvcGVydHlJZFtwcm9wXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnLnNldFByb3BlcnR5KGtleSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRQcm9wZXJ0aWVzID0gSlNPTi5wYXJzZSh0aGlzLnByaXZQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFNlcnZpY2VQcm9wZXJ0aWVzUHJvcGVydHlOYW1lLCBcInt9XCIpKTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHByb3Agb2YgT2JqZWN0LmtleXMoY3VycmVudFByb3BlcnRpZXMpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnLnNldFNlcnZpY2VQcm9wZXJ0eShwcm9wLCBjdXJyZW50UHJvcGVydGllc1twcm9wXSwgU2VydmljZVByb3BlcnR5Q2hhbm5lbC5VcmlRdWVyeVBhcmFtZXRlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGpvaW4gdGhlIGNvbnZlcnNhdGlvblxuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvbiA9IG5ldyBDb252ZXJzYXRpb25JbXBsKHRoaXMucHJpdlNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb24uY29udmVyc2F0aW9uVHJhbnNsYXRvciA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uLmpvaW5Db252ZXJzYXRpb25Bc3luYyhjb252ZXJzYXRpb24sIG5pY2tuYW1lLCBsYW5nLCAoKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihuZXcgRXJyb3IodGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRDb25uZWN0KSwgcGFyYW0zKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZy5hdXRob3JpemF0aW9uVG9rZW4gPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvbi5yb29tLmlzSG9zdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25uZWN0IHRvIHRoZSB3c1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb24uc3RhcnRDb252ZXJzYXRpb25Bc3luYygoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVDYWxsYmFjayhwYXJhbTIsIHBhcmFtMyk7XG4gICAgICAgICAgICAgICAgICAgIH0pLCAoKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBwYXJhbTMpO1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgfSksICgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgcGFyYW0zKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgY29udmVyc2F0aW9uID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQoY29udmVyc2F0aW9uLCB0aGlzLnByaXZFcnJvcnMuaW52YWxpZEFyZ3MucmVwbGFjZShcInthcmd9XCIsIFwiY29udmVyc2F0aW9uIGlkXCIpKTtcbiAgICAgICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2Uobmlja25hbWUsIHRoaXMucHJpdkVycm9ycy5pbnZhbGlkQXJncy5yZXBsYWNlKFwie2FyZ31cIiwgXCJuaWNrbmFtZVwiKSk7XG4gICAgICAgICAgICAgICAgLy8gc2F2ZSB0aGUgbmlja25hbWVcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9OYW1lLCBuaWNrbmFtZSk7XG4gICAgICAgICAgICAgICAgLy8gcmVmIHRoZSBjb252ZXJzYXRpb24gb2JqZWN0XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uID0gY29udmVyc2F0aW9uO1xuICAgICAgICAgICAgICAgIC8vIHJlZiB0aGUgY29udmVyc2F0aW9uIHRyYW5zbGF0b3Igb2JqZWN0XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uLmNvbnZlcnNhdGlvblRyYW5zbGF0b3IgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvbi5yb29tLmlzSG9zdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQodGhpcy5wcml2Q29udmVyc2F0aW9uLCB0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZENvbm5lY3QpO1xuICAgICAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHRoaXMucHJpdkNvbnZlcnNhdGlvbi5yb29tLnRva2VuLCB0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZENvbm5lY3QpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnID0gY29udmVyc2F0aW9uLmNvbmZpZztcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUNhbGxiYWNrKHBhcmFtMSwgcGFyYW0yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IobmV3IEVycm9yKHRoaXMucHJpdkVycm9ycy5pbnZhbGlkQXJncy5yZXBsYWNlKFwie2FyZ31cIiwgXCJpbnZhbGlkIGNvbnZlcnNhdGlvbiB0eXBlXCIpKSwgcGFyYW0yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIHR5cGVvZiBwYXJhbTEgPT09IFwic3RyaW5nXCIgPyBwYXJhbTMgOiBwYXJhbTIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExlYXZlIHRoZSBjb252ZXJzYXRpb25cbiAgICAgKiBAcGFyYW0gY2JcbiAgICAgKiBAcGFyYW0gZXJyXG4gICAgICovXG4gICAgbGVhdmVDb252ZXJzYXRpb25Bc3luYyhjYiwgZXJyKSB7XG4gICAgICAgIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3MoKCgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIC8vIHN0b3AgdGhlIHNwZWVjaCB3ZWJzb2NrZXRcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuY2FuY2VsU3BlZWNoKCk7XG4gICAgICAgICAgICAvLyBzdG9wIHRoZSB3ZWJzb2NrZXRcbiAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdkNvbnZlcnNhdGlvbi5lbmRDb252ZXJzYXRpb25JbXBsQXN5bmMoKTtcbiAgICAgICAgICAgIC8vIGh0dHBzIGRlbGV0ZSByZXF1ZXN0XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZDb252ZXJzYXRpb24uZGVsZXRlQ29udmVyc2F0aW9uSW1wbEFzeW5jKCk7XG4gICAgICAgICAgICB0aGlzLmRpc3Bvc2UoKTtcbiAgICAgICAgfSkpKCksIGNiLCBlcnIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZW5kIGEgdGV4dCBtZXNzYWdlXG4gICAgICogQHBhcmFtIG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0gY2JcbiAgICAgKiBAcGFyYW0gZXJyXG4gICAgICovXG4gICAgc2VuZFRleHRNZXNzYWdlQXN5bmMobWVzc2FnZSwgY2IsIGVycikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQodGhpcy5wcml2Q29udmVyc2F0aW9uLCB0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZFNlbmQpO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKG1lc3NhZ2UsIHRoaXMucHJpdkVycm9ycy5pbnZhbGlkQXJncy5yZXBsYWNlKFwie2FyZ31cIiwgbWVzc2FnZSkpO1xuICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uLnNlbmRUZXh0TWVzc2FnZUFzeW5jKG1lc3NhZ2UsIGNiLCBlcnIpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgZXJyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydCBzcGVha2luZ1xuICAgICAqIEBwYXJhbSBjYlxuICAgICAqIEBwYXJhbSBlcnJcbiAgICAgKi9cbiAgICBzdGFydFRyYW5zY3JpYmluZ0FzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcygoKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZCh0aGlzLnByaXZDb252ZXJzYXRpb24sIHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkU2VuZCk7XG4gICAgICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQodGhpcy5wcml2Q29udmVyc2F0aW9uLnJvb20udG9rZW4sIHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkQ29ubmVjdCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdkNUUmVjb2duaXplciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuY29ubmVjdFRyYW5zbGF0b3JSZWNvZ25pemVyKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHRoaXMucHJpdkNUUmVjb2duaXplciwgdGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRTZW5kKTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY2FuU3BlYWspIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihuZXcgRXJyb3IodGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRTZW5kKSwgZXJyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5zdGFydENvbnRpbnVvdXNSZWNvZ25pdGlvbigpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdklzU3BlYWtpbmcgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2SXNTcGVha2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuY2FuY2VsU3BlZWNoKCk7XG4gICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKSgpLCBjYiwgZXJyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RvcCBzcGVha2luZ1xuICAgICAqIEBwYXJhbSBjYlxuICAgICAqIEBwYXJhbSBlcnJcbiAgICAgKi9cbiAgICBzdG9wVHJhbnNjcmliaW5nQXN5bmMoY2IsIGVycikge1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKCgoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5wcml2SXNTcGVha2luZykge1xuICAgICAgICAgICAgICAgICAgICAvLyBzdG9wIHNwZWVjaFxuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmNhbmNlbFNwZWVjaCgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIHN0b3AgdGhlIHJlY29nbml0aW9uIGJ1dCBsZWF2ZSB0aGUgd2Vic29ja2V0IG9wZW5cbiAgICAgICAgICAgICAgICB0aGlzLnByaXZJc1NwZWFraW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgeWllbGQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDVFJlY29nbml6ZXIuc3RvcENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jKHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmNhbmNlbFNwZWVjaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSkoKSwgY2IsIGVycik7XG4gICAgfVxuICAgIGlzRGlzcG9zZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJc0Rpc3Bvc2VkO1xuICAgIH1cbiAgICBkaXNwb3NlKHJlYXNvbiwgc3VjY2VzcywgZXJyKSB7XG4gICAgICAgIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3MoKCgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzRGlzcG9zZWQgJiYgIXRoaXMucHJpdklzU3BlYWtpbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB5aWVsZCB0aGlzLmNhbmNlbFNwZWVjaCgpO1xuICAgICAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZy5jbG9zZSgpO1xuICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB0aGlzLnByaXZBdWRpb0NvbmZpZyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgfSkpKCksIHN1Y2Nlc3MsIGVycik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbmNlbCB0aGUgc3BlZWNoIHdlYnNvY2tldFxuICAgICAqL1xuICAgIGNhbmNlbFNwZWVjaCgpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZJc1NwZWFraW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgeWllbGQgKChfYSA9IHRoaXMucHJpdkNUUmVjb2duaXplcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm9uRGlzY29ubmVjdGlvbigpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDVFJlY29nbml6ZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vIGlnbm9yZSB0aGUgZXJyb3JcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbm5lY3QgdG8gdGhlIHNwZWVjaCB0cmFuc2xhdGlvbiByZWNvZ25pemVyLlxuICAgICAqIEN1cnJlbnRseSB0aGVyZSBpcyBubyBsYW5ndWFnZSB2YWxpZGF0aW9uIHBlcmZvcm1lZCBiZWZvcmUgc2VuZGluZyB0aGUgU3BlZWNoTGFuZ3VhZ2UgY29kZSB0byB0aGUgc2VydmljZS5cbiAgICAgKiBJZiBpdCdzIGFuIGludmFsaWQgbGFuZ3VhZ2UgdGhlIHJhdyBlcnJvciB3aWxsIGJlOiAnRXJyb3IgZHVyaW5nIFdlYlNvY2tldCBoYW5kc2hha2U6IFVuZXhwZWN0ZWQgcmVzcG9uc2UgY29kZTogNDAwJ1xuICAgICAqIGUuZy4gcGFzcyBpbiAnZnInIGluc3RlYWQgb2YgJ2ZyLUZSJywgb3IgYSB0ZXh0LW9ubHkgbGFuZ3VhZ2UgJ2N5J1xuICAgICAqL1xuICAgIGNvbm5lY3RUcmFuc2xhdG9yUmVjb2duaXplcigpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdkF1ZGlvQ29uZmlnID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2QXVkaW9Db25maWcgPSBBdWRpb0NvbmZpZy5mcm9tRGVmYXVsdE1pY3JvcGhvbmVJbnB1dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBjbGVhciB0aGUgdGVtcCBzdWJzY3JpcHRpb24ga2V5IGlmIGl0J3MgYSBwYXJ0aWNpcGFudCBqb2luaW5nXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdlNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnLmdldFByb3BlcnR5KFByb3BlcnR5SWRbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9LZXldKVxuICAgICAgICAgICAgICAgICAgICA9PT0gdGhpcy5wcml2UGxhY2Vob2xkZXJLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoVHJhbnNsYXRpb25Db25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0tleV0sIFwiXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBjb252R2V0dGVyID0gKCkgPT4gdGhpcy5wcml2Q29udmVyc2F0aW9uO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNUUmVjb2duaXplciA9IG5ldyBDb252ZXJzYXRpb25UcmFuc2xhdGlvblJlY29nbml6ZXIodGhpcy5wcml2U3BlZWNoVHJhbnNsYXRpb25Db25maWcsIHRoaXMucHJpdkF1ZGlvQ29uZmlnLCB0aGlzLCBjb252R2V0dGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuY2FuY2VsU3BlZWNoKCk7XG4gICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgdGhlIHN0YXJ0IHNwZWFraW5nIHJlcXVlc3RcbiAgICAgKi9cbiAgICBzdGFydENvbnRpbnVvdXNSZWNvZ25pdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRoaXMucHJpdkNUUmVjb2duaXplci5zdGFydENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jKHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29udmVyc2F0aW9uVHJhbnNsYXRvci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLy8gTXVsdGktZGV2aWNlIENvbnZlcnNhdGlvbiBpcyBhIFByZXZpZXcgZmVhdHVyZS5cbi8qIGVzbGludC1kaXNhYmxlIG1heC1jbGFzc2VzLXBlci1maWxlICovXG5pbXBvcnQgeyBQcm9wZXJ0eUNvbGxlY3Rpb24gfSBmcm9tIFwiLi4vRXhwb3J0c1wiO1xuZXhwb3J0IGNsYXNzIFVzZXIge1xuICAgIGNvbnN0cnVjdG9yKHVzZXJJZCkge1xuICAgICAgICB0aGlzLnByaXZVc2VySWQgPSB1c2VySWQ7XG4gICAgfVxuICAgIGdldCB1c2VySWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZVc2VySWQ7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFBhcnRpY2lwYW50IHtcbiAgICBjb25zdHJ1Y3RvcihpZCwgYXZhdGFyLCBkaXNwbGF5TmFtZSwgaXNIb3N0LCBpc011dGVkLCBpc1VzaW5nVHRzLCBwcmVmZXJyZWRMYW5ndWFnZSwgdm9pY2UpIHtcbiAgICAgICAgdGhpcy5wcml2SWQgPSBpZDtcbiAgICAgICAgdGhpcy5wcml2QXZhdGFyID0gYXZhdGFyO1xuICAgICAgICB0aGlzLnByaXZEaXNwbGF5TmFtZSA9IGRpc3BsYXlOYW1lO1xuICAgICAgICB0aGlzLnByaXZJc0hvc3QgPSBpc0hvc3Q7XG4gICAgICAgIHRoaXMucHJpdklzTXV0ZWQgPSBpc011dGVkO1xuICAgICAgICB0aGlzLnByaXZJc1VzaW5nVHRzID0gaXNVc2luZ1R0cztcbiAgICAgICAgdGhpcy5wcml2UHJlZmVycmVkTGFuZ3VhZ2UgPSBwcmVmZXJyZWRMYW5ndWFnZTtcbiAgICAgICAgdGhpcy5wcml2Vm9pY2UgPSB2b2ljZTtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcyA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICB9XG4gICAgZ2V0IGF2YXRhcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF2YXRhcjtcbiAgICB9XG4gICAgZ2V0IGRpc3BsYXlOYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RGlzcGxheU5hbWU7XG4gICAgfVxuICAgIGdldCBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklkO1xuICAgIH1cbiAgICBnZXQgcHJlZmVycmVkTGFuZ3VhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcmVmZXJyZWRMYW5ndWFnZTtcbiAgICB9XG4gICAgZ2V0IGlzSG9zdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzSG9zdDtcbiAgICB9XG4gICAgZ2V0IGlzTXV0ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJc011dGVkO1xuICAgIH1cbiAgICBnZXQgaXNVc2luZ1R0cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzVXNpbmdUdHM7XG4gICAgfVxuICAgIGdldCB2b2ljZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlZvaWNlO1xuICAgIH1cbiAgICBnZXQgcHJvcGVydGllcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3BlcnRpZXM7XG4gICAgfVxuICAgIHN0YXRpYyBGcm9tKGlkLCBsYW5ndWFnZSwgdm9pY2UpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQYXJ0aWNpcGFudChpZCwgXCJcIiwgaWQsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGxhbmd1YWdlLCB2b2ljZSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1JUGFydGljaXBhbnQuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8vIE11bHRpLWRldmljZSBDb252ZXJzYXRpb24gaXMgYSBQcmV2aWV3IGZlYXR1cmUuXG5leHBvcnQgdmFyIFBhcnRpY2lwYW50Q2hhbmdlZFJlYXNvbjtcbihmdW5jdGlvbiAoUGFydGljaXBhbnRDaGFuZ2VkUmVhc29uKSB7XG4gICAgLyoqIFBhcnRpY2lwYW50IGhhcyBqb2luZWQgdGhlIGNvbnZlcnNhdGlvbi4gKi9cbiAgICBQYXJ0aWNpcGFudENoYW5nZWRSZWFzb25bUGFydGljaXBhbnRDaGFuZ2VkUmVhc29uW1wiSm9pbmVkQ29udmVyc2F0aW9uXCJdID0gMF0gPSBcIkpvaW5lZENvbnZlcnNhdGlvblwiO1xuICAgIC8qKiBQYXJ0aWNpcGFudCBoYXMgbGVmdCB0aGUgY29udmVyc2F0aW9uLiBUaGlzIGNvdWxkIGJlIHZvbHVudGFyeSwgb3IgaW52b2x1bnRhcnlcbiAgICAgKiAoZS5nLiB0aGV5IGFyZSBleHBlcmllbmNpbmcgbmV0d29ya2luZyBpc3N1ZXMpLlxuICAgICAqL1xuICAgIFBhcnRpY2lwYW50Q2hhbmdlZFJlYXNvbltQYXJ0aWNpcGFudENoYW5nZWRSZWFzb25bXCJMZWZ0Q29udmVyc2F0aW9uXCJdID0gMV0gPSBcIkxlZnRDb252ZXJzYXRpb25cIjtcbiAgICAvKiogVGhlIHBhcnRpY2lwYW50cycgc3RhdGUgaGFzIGNoYW5nZWQgKGUuZy4gdGhleSBiZWNhbWUgbXV0ZWQsIGNoYW5nZWQgdGhlaXIgbmlja25hbWUpLiAqL1xuICAgIFBhcnRpY2lwYW50Q2hhbmdlZFJlYXNvbltQYXJ0aWNpcGFudENoYW5nZWRSZWFzb25bXCJVcGRhdGVkXCJdID0gMl0gPSBcIlVwZGF0ZWRcIjtcbn0pKFBhcnRpY2lwYW50Q2hhbmdlZFJlYXNvbiB8fCAoUGFydGljaXBhbnRDaGFuZ2VkUmVhc29uID0ge30pKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UGFydGljaXBhbnRDaGFuZ2VkUmVhc29uLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIERlZmluZSBwYXlsb2FkIG9mIHNwZWVjaCByZWNvZ25pdGlvbiBjYW5jZWxlZCByZXN1bHQgZXZlbnRzLlxuICogQGNsYXNzIFRyYW5zbGF0aW9uUmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJnc1xuICovXG5leHBvcnQgY2xhc3MgVHJhbnNsYXRpb25SZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzZXNzaW9uaWQgLSBUaGUgc2Vzc2lvbiBpZC5cbiAgICAgKiBAcGFyYW0ge0NhbmNlbGxhdGlvblJlYXNvbn0gY2FuY2VsbGF0aW9uUmVhc29uIC0gVGhlIGNhbmNlbGxhdGlvbiByZWFzb24uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGVycm9yRGV0YWlscyAtIEVycm9yIGRldGFpbHMsIGlmIHByb3ZpZGVkLlxuICAgICAqIEBwYXJhbSB7VHJhbnNsYXRpb25SZWNvZ25pdGlvblJlc3VsdH0gcmVzdWx0IC0gVGhlIHJlc3VsdC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihzZXNzaW9uaWQsIGNhbmNlbGxhdGlvblJlYXNvbiwgZXJyb3JEZXRhaWxzLCBlcnJvckNvZGUsIHJlc3VsdCkge1xuICAgICAgICB0aGlzLnByaXZDYW5jZWxSZWFzb24gPSBjYW5jZWxsYXRpb25SZWFzb247XG4gICAgICAgIHRoaXMucHJpdkVycm9yRGV0YWlscyA9IGVycm9yRGV0YWlscztcbiAgICAgICAgdGhpcy5wcml2UmVzdWx0ID0gcmVzdWx0O1xuICAgICAgICB0aGlzLnByaXZTZXNzaW9uSWQgPSBzZXNzaW9uaWQ7XG4gICAgICAgIHRoaXMucHJpdkVycm9yQ29kZSA9IGVycm9yQ29kZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3BlY2lmaWVzIHRoZSByZWNvZ25pdGlvbiByZXN1bHQuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblJlY29nbml0aW9uQ2FuY2VsZWRFdmVudEFyZ3MucHJvdG90eXBlLnJlc3VsdFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7VHJhbnNsYXRpb25SZWNvZ25pdGlvblJlc3VsdH0gdGhlIHJlY29nbml0aW9uIHJlc3VsdC5cbiAgICAgKi9cbiAgICBnZXQgcmVzdWx0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVzdWx0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIHNlc3Npb24gaWRlbnRpZmllci5cbiAgICAgKiBAbWVtYmVyIFRyYW5zbGF0aW9uUmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJncy5wcm90b3R5cGUuc2Vzc2lvbklkXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHRoZSBzZXNzaW9uIGlkZW50aWZpZXIuXG4gICAgICovXG4gICAgZ2V0IHNlc3Npb25JZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNlc3Npb25JZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIHJlYXNvbiB0aGUgcmVjb2duaXRpb24gd2FzIGNhbmNlbGVkLlxuICAgICAqIEBtZW1iZXIgVHJhbnNsYXRpb25SZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzLnByb3RvdHlwZS5yZWFzb25cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge0NhbmNlbGxhdGlvblJlYXNvbn0gU3BlY2lmaWVzIHRoZSByZWFzb24gY2FuY2VsZWQuXG4gICAgICovXG4gICAgZ2V0IHJlYXNvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNhbmNlbFJlYXNvbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGVycm9yIGNvZGUgaW4gY2FzZSBvZiBhbiB1bnN1Y2Nlc3NmdWwgcmVjb2duaXRpb24uXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjEuMC5cbiAgICAgKiBAcmV0dXJuIEFuIGVycm9yIGNvZGUgdGhhdCByZXByZXNlbnRzIHRoZSBlcnJvciByZWFzb24uXG4gICAgICovXG4gICAgZ2V0IGVycm9yQ29kZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkVycm9yQ29kZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW4gY2FzZSBvZiBhbiB1bnN1Y2Nlc3NmdWwgcmVjb2duaXRpb24sIHByb3ZpZGVzIGRldGFpbHMgb2YgdGhlIG9jY3VycmVkIGVycm9yLlxuICAgICAqIEBtZW1iZXIgVHJhbnNsYXRpb25SZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzLnByb3RvdHlwZS5lcnJvckRldGFpbHNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ30gQSBTdHJpbmcgdGhhdCByZXByZXNlbnRzIHRoZSBlcnJvciBkZXRhaWxzLlxuICAgICAqL1xuICAgIGdldCBlcnJvckRldGFpbHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZFcnJvckRldGFpbHM7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1UcmFuc2xhdGlvblJlY29nbml0aW9uQ2FuY2VsZWRFdmVudEFyZ3MuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFJlY29nbml0aW9uRXZlbnRBcmdzIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBUcmFuc2xhdGlvbiB0ZXh0IHJlc3VsdCBldmVudCBhcmd1bWVudHMuXG4gKiBAY2xhc3MgVHJhbnNsYXRpb25SZWNvZ25pdGlvbkV2ZW50QXJnc1xuICovXG5leHBvcnQgY2xhc3MgVHJhbnNsYXRpb25SZWNvZ25pdGlvbkV2ZW50QXJncyBleHRlbmRzIFJlY29nbml0aW9uRXZlbnRBcmdzIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7VHJhbnNsYXRpb25SZWNvZ25pdGlvblJlc3VsdH0gcmVzdWx0IC0gVGhlIHRyYW5zbGF0aW9uIHJlY29nbml0aW9uIHJlc3VsdC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gb2Zmc2V0IC0gVGhlIG9mZnNldC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc2Vzc2lvbklkIC0gVGhlIHNlc3Npb24gaWQuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVzdWx0LCBvZmZzZXQsIHNlc3Npb25JZCkge1xuICAgICAgICBzdXBlcihvZmZzZXQsIHNlc3Npb25JZCk7XG4gICAgICAgIHRoaXMucHJpdlJlc3VsdCA9IHJlc3VsdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3BlY2lmaWVzIHRoZSByZWNvZ25pdGlvbiByZXN1bHQuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblJlY29nbml0aW9uRXZlbnRBcmdzLnByb3RvdHlwZS5yZXN1bHRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1RyYW5zbGF0aW9uUmVjb2duaXRpb25SZXN1bHR9IHRoZSByZWNvZ25pdGlvbiByZXN1bHQuXG4gICAgICovXG4gICAgZ2V0IHJlc3VsdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlc3VsdDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVRyYW5zbGF0aW9uUmVjb2duaXRpb25FdmVudEFyZ3MuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFNwZWVjaFJlY29nbml0aW9uUmVzdWx0IH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBUcmFuc2xhdGlvbiB0ZXh0IHJlc3VsdC5cbiAqIEBjbGFzcyBUcmFuc2xhdGlvblJlY29nbml0aW9uUmVzdWx0XG4gKi9cbmV4cG9ydCBjbGFzcyBUcmFuc2xhdGlvblJlY29nbml0aW9uUmVzdWx0IGV4dGVuZHMgU3BlZWNoUmVjb2duaXRpb25SZXN1bHQge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtUcmFuc2xhdGlvbnN9IHRyYW5zbGF0aW9ucyAtIFRoZSB0cmFuc2xhdGlvbnMuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHJlc3VsdElkIC0gVGhlIHJlc3VsdCBpZC5cbiAgICAgKiBAcGFyYW0ge1Jlc3VsdFJlYXNvbn0gcmVhc29uIC0gVGhlIHJlYXNvbi5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dCAtIFRoZSByZWNvZ25pemVkIHRleHQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGR1cmF0aW9uIC0gVGhlIGR1cmF0aW9uLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBvZmZzZXQgLSBUaGUgb2Zmc2V0IGludG8gdGhlIHN0cmVhbS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbGFuZ3VhZ2UgLSBQcmltYXJ5IExhbmd1YWdlIGRldGVjdGVkLCBpZiBwcm92aWRlZC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlIC0gUHJpbWFyeSBMYW5ndWFnZSBjb25maWRlbmNlIChcIlVua25vd24sXCIgXCJMb3csXCIgXCJNZWRpdW0sXCIgXCJIaWdoXCIuLi4pLCBpZiBwcm92aWRlZC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXJyb3JEZXRhaWxzIC0gRXJyb3IgZGV0YWlscywgaWYgcHJvdmlkZWQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGpzb24gLSBBZGRpdGlvbmFsIEpzb24sIGlmIHByb3ZpZGVkLlxuICAgICAqIEBwYXJhbSB7UHJvcGVydHlDb2xsZWN0aW9ufSBwcm9wZXJ0aWVzIC0gQWRkaXRpb25hbCBwcm9wZXJ0aWVzLCBpZiBwcm92aWRlZC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0cmFuc2xhdGlvbnMsIHJlc3VsdElkLCByZWFzb24sIHRleHQsIGR1cmF0aW9uLCBvZmZzZXQsIGxhbmd1YWdlLCBsYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UsIGVycm9yRGV0YWlscywganNvbiwgcHJvcGVydGllcykge1xuICAgICAgICBzdXBlcihyZXN1bHRJZCwgcmVhc29uLCB0ZXh0LCBkdXJhdGlvbiwgb2Zmc2V0LCBsYW5ndWFnZSwgbGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlLCB1bmRlZmluZWQsIGVycm9yRGV0YWlscywganNvbiwgcHJvcGVydGllcyk7XG4gICAgICAgIHRoaXMucHJpdlRyYW5zbGF0aW9ucyA9IHRyYW5zbGF0aW9ucztcbiAgICB9XG4gICAgc3RhdGljIGZyb21TcGVlY2hSZWNvZ25pdGlvblJlc3VsdChyZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUcmFuc2xhdGlvblJlY29nbml0aW9uUmVzdWx0KHVuZGVmaW5lZCwgcmVzdWx0LnJlc3VsdElkLCByZXN1bHQucmVhc29uLCByZXN1bHQudGV4dCwgcmVzdWx0LmR1cmF0aW9uLCByZXN1bHQub2Zmc2V0LCByZXN1bHQubGFuZ3VhZ2UsIHJlc3VsdC5sYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UsIHJlc3VsdC5lcnJvckRldGFpbHMsIHJlc3VsdC5qc29uLCByZXN1bHQucHJvcGVydGllcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFByZXNlbnRzIHRoZSB0cmFuc2xhdGlvbiByZXN1bHRzLiBFYWNoIGl0ZW0gaW4gdGhlIGRpY3Rpb25hcnkgcmVwcmVzZW50c1xuICAgICAqIGEgdHJhbnNsYXRpb24gcmVzdWx0IGluIG9uZSBvZiB0YXJnZXQgbGFuZ3VhZ2VzLCB3aGVyZSB0aGUga2V5IGlzIHRoZSBuYW1lXG4gICAgICogb2YgdGhlIHRhcmdldCBsYW5ndWFnZSwgaW4gQkNQLTQ3IGZvcm1hdCwgYW5kIHRoZSB2YWx1ZSBpcyB0aGUgdHJhbnNsYXRpb25cbiAgICAgKiB0ZXh0IGluIHRoZSBzcGVjaWZpZWQgbGFuZ3VhZ2UuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblJlY29nbml0aW9uUmVzdWx0LnByb3RvdHlwZS50cmFuc2xhdGlvbnNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1RyYW5zbGF0aW9uc30gdGhlIGN1cnJlbnQgdHJhbnNsYXRpb24gbWFwIHRoYXQgaG9sZHMgYWxsIHRyYW5zbGF0aW9ucyByZXF1ZXN0ZWQuXG4gICAgICovXG4gICAgZ2V0IHRyYW5zbGF0aW9ucygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRyYW5zbGF0aW9ucztcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVRyYW5zbGF0aW9uUmVjb2duaXRpb25SZXN1bHQuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgUmVjb2duaXRpb25Nb2RlLCBSZWNvZ25pemVyQ29uZmlnLCBUcmFuc2xhdGlvbkNvbm5lY3Rpb25GYWN0b3J5LCBUcmFuc2xhdGlvblNlcnZpY2VSZWNvZ25pemVyIH0gZnJvbSBcIi4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyB9IGZyb20gXCIuLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29ubmVjdGlvbiB9IGZyb20gXCIuL0Nvbm5lY3Rpb25cIjtcbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuL0NvbnRyYWN0c1wiO1xuaW1wb3J0IHsgUHJvcGVydHlJZCwgUmVjb2duaXplciB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogVHJhbnNsYXRpb24gcmVjb2duaXplclxuICogQGNsYXNzIFRyYW5zbGF0aW9uUmVjb2duaXplclxuICovXG5leHBvcnQgY2xhc3MgVHJhbnNsYXRpb25SZWNvZ25pemVyIGV4dGVuZHMgUmVjb2duaXplciB7XG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhlIFRyYW5zbGF0aW9uUmVjb2duaXplci5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge1NwZWVjaFRyYW5zbGF0aW9uQ29uZmlnfSBzcGVlY2hDb25maWcgLSBTZXQgb2YgcHJvcGVydGllcyB0byBjb25maWd1cmUgdGhpcyByZWNvZ25pemVyLlxuICAgICAqIEBwYXJhbSB7QXVkaW9Db25maWd9IGF1ZGlvQ29uZmlnIC0gQW4gb3B0aW9uYWwgYXVkaW8gY29uZmlnIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVjb2duaXplclxuICAgICAqIEBwYXJhbSB7SUNvbm5lY3Rpb25GYWN0b3J5fSBjb25uZWN0aW9uRmFjdG9yeSAtIEFuIG9wdGlvbmFsIGNvbm5lY3Rpb24gZmFjdG9yeSB0byB1c2UgdG8gZ2VuZXJhdGUgdGhlIGVuZHBvaW50IFVSSXMsIGhlYWRlcnMgdG8gc2V0LCBldGMuLi5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihzcGVlY2hDb25maWcsIGF1ZGlvQ29uZmlnLCBjb25uZWN0aW9uRmFjdG9yeSkge1xuICAgICAgICBjb25zdCBjb25maWdJbXBsID0gc3BlZWNoQ29uZmlnO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGwoY29uZmlnSW1wbCwgXCJzcGVlY2hDb25maWdcIik7XG4gICAgICAgIHN1cGVyKGF1ZGlvQ29uZmlnLCBjb25maWdJbXBsLnByb3BlcnRpZXMsIGNvbm5lY3Rpb25GYWN0b3J5IHx8IG5ldyBUcmFuc2xhdGlvbkNvbm5lY3Rpb25GYWN0b3J5KCkpO1xuICAgICAgICB0aGlzLnByaXZEaXNwb3NlZFRyYW5zbGF0aW9uUmVjb2duaXplciA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVHJhbnNsYXRpb25Wb2ljZSwgdW5kZWZpbmVkKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVHJhbnNsYXRpb25Wb2ljZSksIFByb3BlcnR5SWRbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvblZvaWNlXSk7XG4gICAgICAgIH1cbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uVG9MYW5ndWFnZXMpLCBQcm9wZXJ0eUlkW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVHJhbnNsYXRpb25Ub0xhbmd1YWdlc10pO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlKSwgUHJvcGVydHlJZFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZV0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUcmFuc2xhdGlvblJlY29nbml6ZXIgY29uc3RydWN0b3IuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ30gc3BlZWNoVHJhbnNsYXRpb25Db25maWcgLSBhbiBzZXQgb2YgaW5pdGlhbCBwcm9wZXJ0aWVzIGZvciB0aGlzIHJlY29nbml6ZXJcbiAgICAgKiBAcGFyYW0ge0F1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZ30gYXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnIC0gQW4gc291cmNlIGxhbmd1YWdlIGRldGVjdGlvbiBjb25maWd1cmF0aW9uIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVjb2duaXplclxuICAgICAqIEBwYXJhbSB7QXVkaW9Db25maWd9IGF1ZGlvQ29uZmlnIC0gQW4gb3B0aW9uYWwgYXVkaW8gY29uZmlndXJhdGlvbiBhc3NvY2lhdGVkIHdpdGggdGhlIHJlY29nbml6ZXJcbiAgICAgKi9cbiAgICBzdGF0aWMgRnJvbUNvbmZpZyhzcGVlY2hUcmFuc2xhdGlvbkNvbmZpZywgYXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnLCBhdWRpb0NvbmZpZykge1xuICAgICAgICBjb25zdCBzcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwgPSBzcGVlY2hUcmFuc2xhdGlvbkNvbmZpZztcbiAgICAgICAgYXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnLnByb3BlcnRpZXMubWVyZ2VUbyhzcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwucHJvcGVydGllcyk7XG4gICAgICAgIHJldHVybiBuZXcgVHJhbnNsYXRpb25SZWNvZ25pemVyKHNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnLCBhdWRpb0NvbmZpZyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGxhbmd1YWdlIG5hbWUgdGhhdCB3YXMgc2V0IHdoZW4gdGhlIHJlY29nbml6ZXIgd2FzIGNyZWF0ZWQuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblJlY29nbml6ZXIucHJvdG90eXBlLnNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ30gR2V0cyB0aGUgbGFuZ3VhZ2UgbmFtZSB0aGF0IHdhcyBzZXQgd2hlbiB0aGUgcmVjb2duaXplciB3YXMgY3JlYXRlZC5cbiAgICAgKi9cbiAgICBnZXQgc3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZSgpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZEaXNwb3NlZFRyYW5zbGF0aW9uUmVjb2duaXplcik7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTGFuZ3VhZ2UpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRhcmdldCBsYW5ndWFnZXMgZm9yIHRyYW5zbGF0aW9uIHRoYXQgd2VyZSBzZXQgd2hlbiB0aGUgcmVjb2duaXplciB3YXMgY3JlYXRlZC5cbiAgICAgKiBUaGUgbGFuZ3VhZ2UgaXMgc3BlY2lmaWVkIGluIEJDUC00NyBmb3JtYXQuIFRoZSB0cmFuc2xhdGlvbiB3aWxsIHByb3ZpZGUgdHJhbnNsYXRlZCB0ZXh0IGZvciBlYWNoIG9mIGxhbmd1YWdlLlxuICAgICAqIEBtZW1iZXIgVHJhbnNsYXRpb25SZWNvZ25pemVyLnByb3RvdHlwZS50YXJnZXRMYW5ndWFnZXNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ1tdfSBHZXRzIHRhcmdldCBsYW5ndWFnZXMgZm9yIHRyYW5zbGF0aW9uIHRoYXQgd2VyZSBzZXQgd2hlbiB0aGUgcmVjb2duaXplciB3YXMgY3JlYXRlZC5cbiAgICAgKi9cbiAgICBnZXQgdGFyZ2V0TGFuZ3VhZ2VzKCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkRpc3Bvc2VkVHJhbnNsYXRpb25SZWNvZ25pemVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uVG9MYW5ndWFnZXMpLnNwbGl0KFwiLFwiKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgbmFtZSBvZiBvdXRwdXQgdm9pY2UuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblJlY29nbml6ZXIucHJvdG90eXBlLnZvaWNlTmFtZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSB0aGUgbmFtZSBvZiBvdXRwdXQgdm9pY2UuXG4gICAgICovXG4gICAgZ2V0IHZvaWNlTmFtZSgpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZEaXNwb3NlZFRyYW5zbGF0aW9uUmVjb2duaXplcik7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvblZvaWNlLCB1bmRlZmluZWQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgY29sbGVjdGlvbiBvZiBwcm9wZXJ0aWVzIGFuZCB0aGVpciB2YWx1ZXMgZGVmaW5lZCBmb3IgdGhpcyBUcmFuc2xhdGlvblJlY29nbml6ZXIuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblJlY29nbml6ZXIucHJvdG90eXBlLnByb3BlcnRpZXNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1Byb3BlcnR5Q29sbGVjdGlvbn0gVGhlIGNvbGxlY3Rpb24gb2YgcHJvcGVydGllcyBhbmQgdGhlaXIgdmFsdWVzIGRlZmluZWQgZm9yIHRoaXMgVHJhbnNsYXRpb25SZWNvZ25pemVyLlxuICAgICAqL1xuICAgIGdldCBwcm9wZXJ0aWVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgYXV0aG9yaXphdGlvbiB0b2tlbiB1c2VkIHRvIGNvbW11bmljYXRlIHdpdGggdGhlIHNlcnZpY2UuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblJlY29nbml6ZXIucHJvdG90eXBlLmF1dGhvcml6YXRpb25Ub2tlblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBBdXRob3JpemF0aW9uIHRva2VuLlxuICAgICAqL1xuICAgIGdldCBhdXRob3JpemF0aW9uVG9rZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMvU2V0cyB0aGUgYXV0aG9yaXphdGlvbiB0b2tlbiB1c2VkIHRvIGNvbW11bmljYXRlIHdpdGggdGhlIHNlcnZpY2UuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblJlY29nbml6ZXIucHJvdG90eXBlLmF1dGhvcml6YXRpb25Ub2tlblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgLSBBdXRob3JpemF0aW9uIHRva2VuLlxuICAgICAqL1xuICAgIHNldCBhdXRob3JpemF0aW9uVG9rZW4odmFsdWUpIHtcbiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW4sIHZhbHVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RhcnRzIHJlY29nbml0aW9uIGFuZCB0cmFuc2xhdGlvbiwgYW5kIHN0b3BzIGFmdGVyIHRoZSBmaXJzdCB1dHRlcmFuY2UgaXMgcmVjb2duaXplZC5cbiAgICAgKiBUaGUgdGFzayByZXR1cm5zIHRoZSB0cmFuc2xhdGlvbiB0ZXh0IGFzIHJlc3VsdC5cbiAgICAgKiBOb3RlOiByZWNvZ25pemVPbmNlQXN5bmMgcmV0dXJucyB3aGVuIHRoZSBmaXJzdCB1dHRlcmFuY2UgaGFzIGJlZW4gcmVjb2duaXplZCwgc28gaXQgaXMgc3VpdGFibGUgb25seVxuICAgICAqIGZvciBzaW5nbGUgc2hvdCByZWNvZ25pdGlvbiBsaWtlIGNvbW1hbmQgb3IgcXVlcnkuIEZvciBsb25nLXJ1bm5pbmcgcmVjb2duaXRpb24sXG4gICAgICogdXNlIHN0YXJ0Q29udGludW91c1JlY29nbml0aW9uQXN5bmMoKSBpbnN0ZWFkLlxuICAgICAqIEBtZW1iZXIgVHJhbnNsYXRpb25SZWNvZ25pemVyLnByb3RvdHlwZS5yZWNvZ25pemVPbmNlQXN5bmNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIGNiIC0gQ2FsbGJhY2sgdGhhdCByZWNlaXZlZCB0aGUgcmVzdWx0IHdoZW4gdGhlIHRyYW5zbGF0aW9uIGhhcyBjb21wbGV0ZWQuXG4gICAgICogQHBhcmFtIGVyciAtIENhbGxiYWNrIGludm9rZWQgaW4gY2FzZSBvZiBhbiBlcnJvci5cbiAgICAgKi9cbiAgICByZWNvZ25pemVPbmNlQXN5bmMoY2IsIGVycikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkRpc3Bvc2VkVHJhbnNsYXRpb25SZWNvZ25pemVyKTtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLnJlY29nbml6ZU9uY2VBc3luY0ltcGwoUmVjb2duaXRpb25Nb2RlLkNvbnZlcnNhdGlvbiksIGNiLCBlcnIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgcmVjb2duaXRpb24gYW5kIHRyYW5zbGF0aW9uLCB1bnRpbCBzdG9wQ29udGludW91c1JlY29nbml0aW9uQXN5bmMoKSBpcyBjYWxsZWQuXG4gICAgICogVXNlciBtdXN0IHN1YnNjcmliZSB0byBldmVudHMgdG8gcmVjZWl2ZSB0cmFuc2xhdGlvbiByZXN1bHRzLlxuICAgICAqIEBtZW1iZXIgVHJhbnNsYXRpb25SZWNvZ25pemVyLnByb3RvdHlwZS5zdGFydENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSBjYiAtIENhbGxiYWNrIHRoYXQgcmVjZWl2ZWQgdGhlIHRyYW5zbGF0aW9uIGhhcyBzdGFydGVkLlxuICAgICAqIEBwYXJhbSBlcnIgLSBDYWxsYmFjayBpbnZva2VkIGluIGNhc2Ugb2YgYW4gZXJyb3IuXG4gICAgICovXG4gICAgc3RhcnRDb250aW51b3VzUmVjb2duaXRpb25Bc3luYyhjYiwgZXJyKSB7XG4gICAgICAgIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3ModGhpcy5zdGFydENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jSW1wbChSZWNvZ25pdGlvbk1vZGUuQ29udmVyc2F0aW9uKSwgY2IsIGVycik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0b3BzIGNvbnRpbnVvdXMgcmVjb2duaXRpb24gYW5kIHRyYW5zbGF0aW9uLlxuICAgICAqIEBtZW1iZXIgVHJhbnNsYXRpb25SZWNvZ25pemVyLnByb3RvdHlwZS5zdG9wQ29udGludW91c1JlY29nbml0aW9uQXN5bmNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIGNiIC0gQ2FsbGJhY2sgdGhhdCByZWNlaXZlZCB0aGUgdHJhbnNsYXRpb24gaGFzIHN0b3BwZWQuXG4gICAgICogQHBhcmFtIGVyciAtIENhbGxiYWNrIGludm9rZWQgaW4gY2FzZSBvZiBhbiBlcnJvci5cbiAgICAgKi9cbiAgICBzdG9wQ29udGludW91c1JlY29nbml0aW9uQXN5bmMoY2IsIGVycikge1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMuc3RvcENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jSW1wbCgpLCBjYiwgZXJyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogZHluYW1pY2FsbHkgcmVtb3ZlIGEgbGFuZ3VhZ2UgZnJvbSBsaXN0IG9mIHRhcmdldCBsYW5ndWFnZVxuICAgICAqIChjYW4gYmUgdXNlZCB3aGlsZSByZWNvZ25pdGlvbiBpcyBvbmdvaW5nKVxuICAgICAqIEBtZW1iZXIgVHJhbnNsYXRpb25SZWNvZ25pemVyLnByb3RvdHlwZS5yZW1vdmVUYXJnZXRMYW5ndWFnZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwYXJhbSBsYW5nIC0gbGFuZ3VhZ2UgdG8gYmUgcmVtb3ZlZFxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICByZW1vdmVUYXJnZXRMYW5ndWFnZShsYW5nKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKGxhbmcsIFwibGFuZ3VhZ2UgdG8gYmUgcmVtb3ZlZFwiKTtcbiAgICAgICAgaWYgKHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uVG9MYW5ndWFnZXMsIHVuZGVmaW5lZCkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29uc3QgbGFuZ3VhZ2VzID0gdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVHJhbnNsYXRpb25Ub0xhbmd1YWdlcykuc3BsaXQoXCIsXCIpO1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBsYW5ndWFnZXMuaW5kZXhPZihsYW5nKTtcbiAgICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICAgICAgbGFuZ3VhZ2VzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVHJhbnNsYXRpb25Ub0xhbmd1YWdlcywgbGFuZ3VhZ2VzLmpvaW4oXCIsXCIpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUxhbmd1YWdlcyhsYW5ndWFnZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIGR5bmFtaWNhbGx5IGFkZCBhIGxhbmd1YWdlIHRvIGxpc3Qgb2YgdGFyZ2V0IGxhbmd1YWdlXG4gICAgICogKGNhbiBiZSB1c2VkIHdoaWxlIHJlY29nbml0aW9uIGlzIG9uZ29pbmcpXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblJlY29nbml6ZXIucHJvdG90eXBlLmFkZFRhcmdldExhbmd1YWdlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHBhcmFtIGxhbmcgLSBsYW5ndWFnZSB0byBiZSBhZGRlZFxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBhZGRUYXJnZXRMYW5ndWFnZShsYW5nKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKGxhbmcsIFwibGFuZ3VhZ2UgdG8gYmUgYWRkZWRcIik7XG4gICAgICAgIGxldCBsYW5ndWFnZXMgPSBbXTtcbiAgICAgICAgaWYgKHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uVG9MYW5ndWFnZXMsIHVuZGVmaW5lZCkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgbGFuZ3VhZ2VzID0gdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVHJhbnNsYXRpb25Ub0xhbmd1YWdlcykuc3BsaXQoXCIsXCIpO1xuICAgICAgICAgICAgaWYgKCFsYW5ndWFnZXMuaW5jbHVkZXMobGFuZykpIHtcbiAgICAgICAgICAgICAgICBsYW5ndWFnZXMucHVzaChsYW5nKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvblRvTGFuZ3VhZ2VzLCBsYW5ndWFnZXMuam9pbihcIixcIikpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVHJhbnNsYXRpb25Ub0xhbmd1YWdlcywgbGFuZyk7XG4gICAgICAgICAgICBsYW5ndWFnZXMgPSBbbGFuZ107XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGVMYW5ndWFnZXMobGFuZ3VhZ2VzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogY2xvc2VzIGFsbCBleHRlcm5hbCByZXNvdXJjZXMgaGVsZCBieSBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBtZW1iZXIgVHJhbnNsYXRpb25SZWNvZ25pemVyLnByb3RvdHlwZS5jbG9zZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBjbG9zZShjYiwgZXJyb3JDYikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkRpc3Bvc2VkVHJhbnNsYXRpb25SZWNvZ25pemVyKTtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLmRpc3Bvc2UodHJ1ZSksIGNiLCBlcnJvckNiKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogaGFuZGxlcyBDb25uZWN0aW9uRXN0YWJsaXNoZWRFdmVudCBmb3IgY29udmVyc2F0aW9uIHRyYW5zbGF0aW9uIHNjZW5hcmlvcy5cbiAgICAgKiBAbWVtYmVyIFRyYW5zbGF0aW9uUmVjb2duaXplci5wcm90b3R5cGUub25Db25uZWN0aW9uXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb25cbiAgICBvbkNvbm5lY3Rpb24oKSB7IH1cbiAgICAvKipcbiAgICAgKiBoYW5kbGVzIGRpc2Nvbm5lY3Rpb24gZXZlbnRzIGZvciBjb252ZXJzYXRpb24gdHJhbnNsYXRpb24gc2NlbmFyaW9zLlxuICAgICAqIEBtZW1iZXIgVHJhbnNsYXRpb25SZWNvZ25pemVyLnByb3RvdHlwZS5vbkRpc2Nvbm5lY3Rpb25cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvblxuICAgIG9uRGlzY29ubmVjdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHsgfSk7XG4gICAgfVxuICAgIGRpc3Bvc2UoZGlzcG9zaW5nKSB7XG4gICAgICAgIGNvbnN0IF9zdXBlciA9IE9iamVjdC5jcmVhdGUobnVsbCwge1xuICAgICAgICAgICAgZGlzcG9zZTogeyBnZXQ6ICgpID0+IHN1cGVyLmRpc3Bvc2UgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZEaXNwb3NlZFRyYW5zbGF0aW9uUmVjb2duaXplcikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucHJpdkRpc3Bvc2VkVHJhbnNsYXRpb25SZWNvZ25pemVyID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmIChkaXNwb3NpbmcpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmltcGxSZWNvZ25pemVyU3RvcCgpO1xuICAgICAgICAgICAgICAgIHlpZWxkIF9zdXBlci5kaXNwb3NlLmNhbGwodGhpcywgZGlzcG9zaW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNyZWF0ZVJlY29nbml6ZXJDb25maWcoc3BlZWNoQ29uZmlnKSB7XG4gICAgICAgIHJldHVybiBuZXcgUmVjb2duaXplckNvbmZpZyhzcGVlY2hDb25maWcsIHRoaXMucHJpdlByb3BlcnRpZXMpO1xuICAgIH1cbiAgICBjcmVhdGVTZXJ2aWNlUmVjb2duaXplcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvQ29uZmlnLCByZWNvZ25pemVyQ29uZmlnKSB7XG4gICAgICAgIGNvbnN0IGNvbmZpZ0ltcGwgPSBhdWRpb0NvbmZpZztcbiAgICAgICAgcmV0dXJuIG5ldyBUcmFuc2xhdGlvblNlcnZpY2VSZWNvZ25pemVyKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgY29uZmlnSW1wbCwgcmVjb2duaXplckNvbmZpZywgdGhpcyk7XG4gICAgfVxuICAgIHVwZGF0ZUxhbmd1YWdlcyhsYW5ndWFnZXMpIHtcbiAgICAgICAgY29uc3QgY29ubiA9IENvbm5lY3Rpb24uZnJvbVJlY29nbml6ZXIodGhpcyk7XG4gICAgICAgIGlmICghIWNvbm4pIHtcbiAgICAgICAgICAgIGNvbm4uc2V0TWVzc2FnZVByb3BlcnR5KFwic3BlZWNoLmNvbnRleHRcIiwgXCJ0cmFuc2xhdGlvbmNvbnRleHRcIiwgeyB0bzogbGFuZ3VhZ2VzIH0pO1xuICAgICAgICAgICAgY29ubi5zZW5kTWVzc2FnZUFzeW5jKFwiZXZlbnRcIiwgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIGlkOiBcInRyYW5zbGF0aW9uXCIsXG4gICAgICAgICAgICAgICAgbmFtZTogXCJ1cGRhdGVMYW5ndWFnZVwiLFxuICAgICAgICAgICAgICAgIHRvOiBsYW5ndWFnZXNcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VHJhbnNsYXRpb25SZWNvZ25pemVyLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBTZXNzaW9uRXZlbnRBcmdzIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBUcmFuc2xhdGlvbiBTeW50aGVzaXMgZXZlbnQgYXJndW1lbnRzXG4gKiBAY2xhc3MgVHJhbnNsYXRpb25TeW50aGVzaXNFdmVudEFyZ3NcbiAqL1xuZXhwb3J0IGNsYXNzIFRyYW5zbGF0aW9uU3ludGhlc2lzRXZlbnRBcmdzIGV4dGVuZHMgU2Vzc2lvbkV2ZW50QXJncyB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge1RyYW5zbGF0aW9uU3ludGhlc2lzUmVzdWx0fSByZXN1bHQgLSBUaGUgdHJhbnNsYXRpb24gc3ludGhlc2lzIHJlc3VsdC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc2Vzc2lvbklkIC0gVGhlIHNlc3Npb24gaWQuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVzdWx0LCBzZXNzaW9uSWQpIHtcbiAgICAgICAgc3VwZXIoc2Vzc2lvbklkKTtcbiAgICAgICAgdGhpcy5wcml2UmVzdWx0ID0gcmVzdWx0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIHRyYW5zbGF0aW9uIHN5bnRoZXNpcyByZXN1bHQuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblN5bnRoZXNpc0V2ZW50QXJncy5wcm90b3R5cGUucmVzdWx0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtUcmFuc2xhdGlvblN5bnRoZXNpc1Jlc3VsdH0gU3BlY2lmaWVzIHRoZSB0cmFuc2xhdGlvbiBzeW50aGVzaXMgcmVzdWx0LlxuICAgICAqL1xuICAgIGdldCByZXN1bHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZXN1bHQ7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1UcmFuc2xhdGlvblN5bnRoZXNpc0V2ZW50QXJncy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBEZWZpbmVzIHRyYW5zbGF0aW9uIHN5bnRoZXNpcyByZXN1bHQsIGkuZS4gdGhlIHZvaWNlIG91dHB1dCBvZiB0aGUgdHJhbnNsYXRlZFxuICogdGV4dCBpbiB0aGUgdGFyZ2V0IGxhbmd1YWdlLlxuICogQGNsYXNzIFRyYW5zbGF0aW9uU3ludGhlc2lzUmVzdWx0XG4gKi9cbmV4cG9ydCBjbGFzcyBUcmFuc2xhdGlvblN5bnRoZXNpc1Jlc3VsdCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge1Jlc3VsdFJlYXNvbn0gcmVhc29uIC0gVGhlIHN5bnRoZXNpcyByZWFzb24uXG4gICAgICogQHBhcmFtIHtBcnJheUJ1ZmZlcn0gYXVkaW8gLSBUaGUgYXVkaW8gZGF0YS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZWFzb24sIGF1ZGlvKSB7XG4gICAgICAgIHRoaXMucHJpdlJlYXNvbiA9IHJlYXNvbjtcbiAgICAgICAgdGhpcy5wcml2QXVkaW8gPSBhdWRpbztcbiAgICB9XG4gICAgLyoqXG4gICAgICogVHJhbnNsYXRlZCB0ZXh0IGluIHRoZSB0YXJnZXQgbGFuZ3VhZ2UuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblN5bnRoZXNpc1Jlc3VsdC5wcm90b3R5cGUuYXVkaW9cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge0FycmF5QnVmZmVyfSBUcmFuc2xhdGVkIGF1ZGlvIGluIHRoZSB0YXJnZXQgbGFuZ3VhZ2UuXG4gICAgICovXG4gICAgZ2V0IGF1ZGlvKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXVkaW87XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBzeW50aGVzaXMgc3RhdHVzLlxuICAgICAqIEBtZW1iZXIgVHJhbnNsYXRpb25TeW50aGVzaXNSZXN1bHQucHJvdG90eXBlLnJlYXNvblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7UmVzdWx0UmVhc29ufSBUaGUgc3ludGhlc2lzIHN0YXR1cy5cbiAgICAgKi9cbiAgICBnZXQgcmVhc29uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVhc29uO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VHJhbnNsYXRpb25TeW50aGVzaXNSZXN1bHQuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFByb3BlcnR5Q29sbGVjdGlvbiB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogUmVwcmVzZW50cyBjb2xsZWN0aW9uIG9mIHBhcmFtZXRlcnMgYW5kIHRoZWlyIHZhbHVlcy5cbiAqIEBjbGFzcyBUcmFuc2xhdGlvbnNcbiAqL1xuZXhwb3J0IGNsYXNzIFRyYW5zbGF0aW9ucyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIC8vIFVzZSBhbiBQcm9wZXJ0eUNvbGxlY3Rpb24gaW50ZXJuYWxseSwganVzdCB3cmFwcGluZyBpdCB0byBoaWRlIHRoZSB8IGVudW0gc3ludGF4IGl0IGhhcy5cbiAgICAgICAgdGhpcy5wcml2TWFwID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGxhbmd1YWdlcyBpbiB0aGUgb2JqZWN0IGluIGEgU3RyaW5nIGFycmF5LlxuICAgICAqIEBtZW1iZXIgVHJhbnNsYXRpb25zLnByb3RvdHlwZS5sYW5ndWFnZXNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ1tdfSBsYW5ndWFnZXMgaW4gdHJhbnNsYXRpb25zIG9iamVjdC5cbiAgICAgKi9cbiAgICBnZXQgbGFuZ3VhZ2VzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TWFwLmtleXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHBhcmFtZXRlciB2YWx1ZSBpbiB0eXBlIFN0cmluZy4gVGhlIHBhcmFtZXRlciBtdXN0IGhhdmUgdGhlIHNhbWUgdHlwZSBhcyBTdHJpbmcuXG4gICAgICogQ3VycmVudGx5IG9ubHkgU3RyaW5nLCBpbnQgYW5kIGJvb2wgYXJlIGFsbG93ZWQuXG4gICAgICogSWYgdGhlIG5hbWUgaXMgbm90IGF2YWlsYWJsZSwgdGhlIHNwZWNpZmllZCBkZWZhdWx0VmFsdWUgaXMgcmV0dXJuZWQuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvbnMucHJvdG90eXBlLmdldFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IC0gVGhlIHBhcmFtZXRlciBuYW1lLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBkZWYgLSBUaGUgZGVmYXVsdCB2YWx1ZSB3aGljaCBpcyByZXR1cm5lZCBpZiB0aGUgcGFyYW1ldGVyIGlzIG5vdCBhdmFpbGFibGUgaW4gdGhlIGNvbGxlY3Rpb24uXG4gICAgICogQHJldHVybnMge3N0cmluZ30gdmFsdWUgb2YgdGhlIHBhcmFtZXRlci5cbiAgICAgKi9cbiAgICBnZXQoa2V5LCBkZWYpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdk1hcC5nZXRQcm9wZXJ0eShrZXksIGRlZik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIFN0cmluZyB2YWx1ZSBvZiB0aGUgcGFyYW1ldGVyIHNwZWNpZmllZCBieSBuYW1lLlxuICAgICAqIEBtZW1iZXIgVHJhbnNsYXRpb25zLnByb3RvdHlwZS5zZXRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSAtIFRoZSBwYXJhbWV0ZXIgbmFtZS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgLSBUaGUgdmFsdWUgb2YgdGhlIHBhcmFtZXRlci5cbiAgICAgKi9cbiAgICBzZXQoa2V5LCB2YWx1ZSkge1xuICAgICAgICB0aGlzLnByaXZNYXAuc2V0UHJvcGVydHkoa2V5LCB2YWx1ZSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1UcmFuc2xhdGlvbnMuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFR1cm5TdGF0dXNSZXNwb25zZVBheWxvYWQgfSBmcm9tIFwiLi4vY29tbW9uLnNwZWVjaC9TZXJ2aWNlTWVzc2FnZXMvVHVyblN0YXR1c1BheWxvYWRcIjtcbi8qKlxuICogRGVmaW5lcyBjb250ZW50cyBvZiByZWNlaXZlZCBtZXNzYWdlL2V2ZW50cy5cbiAqIEBjbGFzcyBUdXJuU3RhdHVzUmVjZWl2ZWRFdmVudEFyZ3NcbiAqL1xuZXhwb3J0IGNsYXNzIFR1cm5TdGF0dXNSZWNlaXZlZEV2ZW50QXJncyB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHVyblN0YXR1cyAtIFRoZSBKU09OLWVuY29kZWQgdHVybiBzdGF0dXMgbWVzc2FnZS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0dXJuU3RhdHVzKSB7XG4gICAgICAgIHRoaXMucHJpdlR1cm5TdGF0dXMgPSBUdXJuU3RhdHVzUmVzcG9uc2VQYXlsb2FkLmZyb21KU09OKHR1cm5TdGF0dXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBpbnRlcmFjdGlvbiBpZGVudGlmaWVyIGFzc29jaWF0ZWQgd2l0aCB0aGlzIHR1cm4gc3RhdHVzIGV2ZW50LlxuICAgICAqIEBtZW1iZXIgVHVyblN0YXR1c1JlY2VpdmVkRXZlbnRBcmdzLnByb3RvdHlwZS5pbnRlcmFjdGlvbklkXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHthbnl9IHRoZSByZWNlaXZlZCBpbnRlcmFjdGlvbiBpZC5cbiAgICAgKi9cbiAgICBnZXQgaW50ZXJhY3Rpb25JZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlR1cm5TdGF0dXMuaW50ZXJhY3Rpb25JZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgY29udmVyc2F0aW9uIGlkZW50aWZpZXIgYXNzb2NpYXRlZCB3aXRoIHRoaXMgdHVybiBzdGF0dXMgZXZlbnQuXG4gICAgICogQG1lbWJlciBUdXJuU3RhdHVzUmVjZWl2ZWRFdmVudEFyZ3MucHJvdG90eXBlLmNvbnZlcnNhdGlvbklkXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHthbnl9IHRoZSByZWNlaXZlZCBjb252ZXJzYXRpb24gaWQuXG4gICAgICovXG4gICAgZ2V0IGNvbnZlcnNhdGlvbklkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VHVyblN0YXR1cy5jb252ZXJzYXRpb25JZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgcmVjZWl2ZWQgdHVybiBzdGF0dXMgY29kZS5cbiAgICAgKiBAbWVtYmVyIFR1cm5TdGF0dXNSZWNlaXZlZEV2ZW50QXJncy5wcm90b3R5cGUuc3RhdHVzQ29kZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSB0aGUgcmVjZWl2ZWQgdHVybiBzdGF0dXMuXG4gICAgICovXG4gICAgZ2V0IHN0YXR1c0NvZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUdXJuU3RhdHVzLnN0YXR1c0NvZGU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1yZXR1cm5cbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVR1cm5TdGF0dXNSZWNlaXZlZEV2ZW50QXJncy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBEZWZpbmVzIHRoZSBnZW5kZXIgb2Ygc3ludGhlc2lzIHZvaWNlcy5cbiAqIEFkZGVkIGluIHZlcnNpb24gMS4yMC4wLlxuICovXG5leHBvcnQgdmFyIFN5bnRoZXNpc1ZvaWNlR2VuZGVyO1xuKGZ1bmN0aW9uIChTeW50aGVzaXNWb2ljZUdlbmRlcikge1xuICAgIC8qKiBHZW5kZXIgdW5rbm93biAqL1xuICAgIFN5bnRoZXNpc1ZvaWNlR2VuZGVyW1N5bnRoZXNpc1ZvaWNlR2VuZGVyW1wiVW5rbm93blwiXSA9IDBdID0gXCJVbmtub3duXCI7XG4gICAgLyoqIEZlbWFsZSB2b2ljZSAqL1xuICAgIFN5bnRoZXNpc1ZvaWNlR2VuZGVyW1N5bnRoZXNpc1ZvaWNlR2VuZGVyW1wiRmVtYWxlXCJdID0gMV0gPSBcIkZlbWFsZVwiO1xuICAgIC8qKiBNYWxlIHZvaWNlICovXG4gICAgU3ludGhlc2lzVm9pY2VHZW5kZXJbU3ludGhlc2lzVm9pY2VHZW5kZXJbXCJNYWxlXCJdID0gMl0gPSBcIk1hbGVcIjtcbn0pKFN5bnRoZXNpc1ZvaWNlR2VuZGVyIHx8IChTeW50aGVzaXNWb2ljZUdlbmRlciA9IHt9KSk7XG5leHBvcnQgdmFyIFN5bnRoZXNpc1ZvaWNlVHlwZTtcbihmdW5jdGlvbiAoU3ludGhlc2lzVm9pY2VUeXBlKSB7XG4gICAgU3ludGhlc2lzVm9pY2VUeXBlW1N5bnRoZXNpc1ZvaWNlVHlwZVtcIk9ubGluZU5ldXJhbFwiXSA9IDFdID0gXCJPbmxpbmVOZXVyYWxcIjtcbiAgICBTeW50aGVzaXNWb2ljZVR5cGVbU3ludGhlc2lzVm9pY2VUeXBlW1wiT25saW5lU3RhbmRhcmRcIl0gPSAyXSA9IFwiT25saW5lU3RhbmRhcmRcIjtcbiAgICBTeW50aGVzaXNWb2ljZVR5cGVbU3ludGhlc2lzVm9pY2VUeXBlW1wiT2ZmbGluZU5ldXJhbFwiXSA9IDNdID0gXCJPZmZsaW5lTmV1cmFsXCI7XG4gICAgU3ludGhlc2lzVm9pY2VUeXBlW1N5bnRoZXNpc1ZvaWNlVHlwZVtcIk9mZmxpbmVTdGFuZGFyZFwiXSA9IDRdID0gXCJPZmZsaW5lU3RhbmRhcmRcIjtcbn0pKFN5bnRoZXNpc1ZvaWNlVHlwZSB8fCAoU3ludGhlc2lzVm9pY2VUeXBlID0ge30pKTtcbi8qKlxuICogSW5mb3JtYXRpb24gYWJvdXQgU3BlZWNoIFN5bnRoZXNpcyB2b2ljZVxuICogQWRkZWQgaW4gdmVyc2lvbiAxLjIwLjAuXG4gKiBAY2xhc3MgVm9pY2VJbmZvXG4gKi9cbmV4cG9ydCBjbGFzcyBWb2ljZUluZm8ge1xuICAgIGNvbnN0cnVjdG9yKGpzb24pIHtcbiAgICAgICAgdGhpcy5wcml2U3R5bGVMaXN0ID0gW107XG4gICAgICAgIHRoaXMucHJpdlZvaWNlUGF0aCA9IFwiXCI7XG4gICAgICAgIGlmICghIWpzb24pIHtcbiAgICAgICAgICAgIHRoaXMucHJpdk5hbWUgPSBqc29uLk5hbWU7XG4gICAgICAgICAgICB0aGlzLnByaXZMb2NhbGUgPSBqc29uLkxvY2FsZTtcbiAgICAgICAgICAgIHRoaXMucHJpdlNob3J0TmFtZSA9IGpzb24uU2hvcnROYW1lO1xuICAgICAgICAgICAgdGhpcy5wcml2TG9jYWxlTmFtZSA9IGpzb24uTG9jYWxlTmFtZTtcbiAgICAgICAgICAgIHRoaXMucHJpdkxvY2FsTmFtZSA9IGpzb24uTG9jYWxOYW1lO1xuICAgICAgICAgICAgdGhpcy5wcml2Vm9pY2VUeXBlID0ganNvbi5Wb2ljZVR5cGUuZW5kc1dpdGgoXCJTdGFuZGFyZFwiKSA/IFN5bnRoZXNpc1ZvaWNlVHlwZS5PbmxpbmVTdGFuZGFyZCA6IFN5bnRoZXNpc1ZvaWNlVHlwZS5PbmxpbmVOZXVyYWw7XG4gICAgICAgICAgICB0aGlzLnByaXZHZW5kZXIgPSBqc29uLkdlbmRlciA9PT0gXCJNYWxlXCIgPyBTeW50aGVzaXNWb2ljZUdlbmRlci5NYWxlIDoganNvbi5HZW5kZXIgPT09IFwiRmVtYWxlXCIgPyBTeW50aGVzaXNWb2ljZUdlbmRlci5GZW1hbGUgOiBTeW50aGVzaXNWb2ljZUdlbmRlci5Vbmtub3duO1xuICAgICAgICAgICAgaWYgKCEhanNvbi5TdHlsZUxpc3QgJiYgQXJyYXkuaXNBcnJheShqc29uLlN0eWxlTGlzdCkpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHN0eWxlIG9mIGpzb24uU3R5bGVMaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlN0eWxlTGlzdC5wdXNoKHN0eWxlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZOYW1lO1xuICAgIH1cbiAgICBnZXQgbG9jYWxlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TG9jYWxlO1xuICAgIH1cbiAgICBnZXQgc2hvcnROYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U2hvcnROYW1lO1xuICAgIH1cbiAgICBnZXQgbG9jYWxOYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TG9jYWxOYW1lO1xuICAgIH1cbiAgICBnZXQgbG9jYWxlTmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkxvY2FsZU5hbWU7XG4gICAgfVxuICAgIGdldCBnZW5kZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZHZW5kZXI7XG4gICAgfVxuICAgIGdldCB2b2ljZVR5cGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZWb2ljZVR5cGU7XG4gICAgfVxuICAgIGdldCBzdHlsZUxpc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTdHlsZUxpc3Q7XG4gICAgfVxuICAgIGdldCB2b2ljZVBhdGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZWb2ljZVBhdGg7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Wb2ljZUluZm8uanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogRGVmaW5lcyBWb2ljZSBQcm9maWxlIGNsYXNzIGZvciBTcGVha2VyIFJlY29nbml0aW9uXG4gKiBAY2xhc3MgVm9pY2VQcm9maWxlXG4gKi9cbmV4cG9ydCBjbGFzcyBWb2ljZVByb2ZpbGUge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHByb2ZpbGVJZCAtIHByb2ZpbGVJZCBvZiB0aGlzIFZvaWNlIFByb2ZpbGUuXG4gICAgICogQHBhcmFtIHtWb2ljZVByb2ZpbGVUeXBlfSBwcm9maWxlVHlwZSAtIHByb2ZpbGVUeXBlIG9mIHRoaXMgVm9pY2UgUHJvZmlsZS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcihwcm9maWxlSWQsIHByb2ZpbGVUeXBlKSB7XG4gICAgICAgIHRoaXMucHJpdklkID0gcHJvZmlsZUlkO1xuICAgICAgICB0aGlzLnByaXZQcm9maWxlVHlwZSA9IHByb2ZpbGVUeXBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBwcm9maWxlSWQgb2YgdGhpcyBWb2ljZSBQcm9maWxlIGluc3RhbmNlXG4gICAgICogQG1lbWJlciBWb2ljZVByb2ZpbGUucHJvdG90eXBlLnByb2ZpbGVJZFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBwcm9maWxlSWQgb2YgdGhpcyBWb2ljZSBQcm9maWxlIGluc3RhbmNlLlxuICAgICAqL1xuICAgIGdldCBwcm9maWxlSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogcHJvZmlsZVR5cGUgb2YgdGhpcyBWb2ljZSBQcm9maWxlIGluc3RhbmNlXG4gICAgICogQG1lbWJlciBWb2ljZVByb2ZpbGUucHJvdG90eXBlLnByb2ZpbGVUeXBlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtWb2ljZVByb2ZpbGVUeXBlfSBwcm9maWxlIHR5cGUgb2YgdGhpcyBWb2ljZSBQcm9maWxlIGluc3RhbmNlLlxuICAgICAqL1xuICAgIGdldCBwcm9maWxlVHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb2ZpbGVUeXBlO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Vm9pY2VQcm9maWxlLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCB7IFJlY29nbml6ZXJDb25maWcsIFZvaWNlUHJvZmlsZUNvbm5lY3Rpb25GYWN0b3J5LCBWb2ljZVNlcnZpY2VSZWNvZ25pemVyIH0gZnJvbSBcIi4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQXVkaW9Db25maWcgfSBmcm9tIFwiLi9BdWRpby9BdWRpb0NvbmZpZ1wiO1xuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBBdWRpb0lucHV0U3RyZWFtLCBQcm9wZXJ0eUlkLCBSZWNvZ25pemVyLCBSZXN1bHRSZWFzb24sIFZvaWNlUHJvZmlsZSwgVm9pY2VQcm9maWxlUmVzdWx0IH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBEZWZpbmVzIFZvaWNlUHJvZmlsZUNsaWVudCBjbGFzcyBmb3IgU3BlYWtlciBSZWNvZ25pdGlvblxuICogSGFuZGxlcyBvcGVyYXRpb25zIGZyb20gdXNlciBmb3IgVm9pY2UgUHJvZmlsZSBvcGVyYXRpb25zIChlLmcuIGNyZWF0ZVByb2ZpbGUsIGRlbGV0ZVByb2ZpbGUpXG4gKiBAY2xhc3MgVm9pY2VQcm9maWxlQ2xpZW50XG4gKi9cbmV4cG9ydCBjbGFzcyBWb2ljZVByb2ZpbGVDbGllbnQgZXh0ZW5kcyBSZWNvZ25pemVyIHtcbiAgICAvKipcbiAgICAgKiBWb2ljZVByb2ZpbGVDbGllbnQgY29uc3RydWN0b3IuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtTcGVlY2hDb25maWd9IHNwZWVjaENvbmZpZyAtIEFuIHNldCBvZiBpbml0aWFsIHByb3BlcnRpZXMgZm9yIHRoaXMgc3ludGhlc2l6ZXIgKGF1dGhlbnRpY2F0aW9uIGtleSwgcmVnaW9uLCAmYylcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihzcGVlY2hDb25maWcpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQoc3BlZWNoQ29uZmlnLCBcInNwZWVjaENvbmZpZ1wiKTtcbiAgICAgICAgY29uc3Qgc3BlZWNoQ29uZmlnSW1wbCA9IHNwZWVjaENvbmZpZztcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsKHNwZWVjaENvbmZpZ0ltcGwsIFwic3BlZWNoQ29uZmlnXCIpO1xuICAgICAgICBzdXBlcihBdWRpb0NvbmZpZy5mcm9tU3RyZWFtSW5wdXQoQXVkaW9JbnB1dFN0cmVhbS5jcmVhdGVQdXNoU3RyZWFtKCkpLCBzcGVlY2hDb25maWdJbXBsLnByb3BlcnRpZXMsIG5ldyBWb2ljZVByb2ZpbGVDb25uZWN0aW9uRmFjdG9yeSgpKTtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcyA9IHNwZWVjaENvbmZpZ0ltcGwucHJvcGVydGllcy5jbG9uZSgpO1xuICAgICAgICB0aGlzLnByaXZWb2ljZUFkYXB0ZXIgPSB0aGlzLnByaXZSZWNvO1xuICAgICAgICB0aGlzLnByaXZEaXNwb3NlZFZvaWNlQWRhcHRlciA9IGZhbHNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgY29sbGVjdGlvbiBvZiBwcm9wZXJ0aWVzIGFuZCB0aGVpciB2YWx1ZXMgZGVmaW5lZCBmb3IgdGhpcyBWb2ljZVByb2ZpbGVDbGllbnQuXG4gICAgICogQG1lbWJlciBWb2ljZVByb2ZpbGVDbGllbnQucHJvdG90eXBlLnByb3BlcnRpZXNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1Byb3BlcnR5Q29sbGVjdGlvbn0gVGhlIGNvbGxlY3Rpb24gb2YgcHJvcGVydGllcyBhbmQgdGhlaXIgdmFsdWVzIGRlZmluZWQgZm9yIHRoaXMgVm9pY2VQcm9maWxlQ2xpZW50LlxuICAgICAqL1xuICAgIGdldCBwcm9wZXJ0aWVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgYXV0aG9yaXphdGlvbiB0b2tlbiB1c2VkIHRvIGNvbW11bmljYXRlIHdpdGggdGhlIHNlcnZpY2UuXG4gICAgICogQG1lbWJlciBWb2ljZVByb2ZpbGVDbGllbnQucHJvdG90eXBlLmF1dGhvcml6YXRpb25Ub2tlblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBBdXRob3JpemF0aW9uIHRva2VuLlxuICAgICAqL1xuICAgIGdldCBhdXRob3JpemF0aW9uVG9rZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMvU2V0cyB0aGUgYXV0aG9yaXphdGlvbiB0b2tlbiB1c2VkIHRvIGNvbW11bmljYXRlIHdpdGggdGhlIHNlcnZpY2UuXG4gICAgICogQG1lbWJlciBWb2ljZVByb2ZpbGVDbGllbnQucHJvdG90eXBlLmF1dGhvcml6YXRpb25Ub2tlblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdG9rZW4gLSBBdXRob3JpemF0aW9uIHRva2VuLlxuICAgICAqL1xuICAgIHNldCBhdXRob3JpemF0aW9uVG9rZW4odG9rZW4pIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHRva2VuLCBcInRva2VuXCIpO1xuICAgICAgICB0aGlzLnByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbiwgdG9rZW4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBzcGVha2VyIHJlY29nbml0aW9uIHZvaWNlIHByb2ZpbGVcbiAgICAgKiBAbWVtYmVyIFZvaWNlUHJvZmlsZUNsaWVudC5wcm90b3R5cGUuY3JlYXRlUHJvZmlsZUFzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBhc3luY1xuICAgICAqIEBwYXJhbSB7Vm9pY2VQcm9maWxlVHlwZX0gcHJvZmlsZVR5cGUgVHlwZSBvZiBWb2ljZSBQcm9maWxlIHRvIGJlIGNyZWF0ZWRcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbGFuZyBMYW5ndWFnZSBzdHJpbmcgKGxvY2FsZSkgZm9yIFZvaWNlIFByb2ZpbGVcbiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPFZvaWNlUHJvZmlsZT59IC0gUHJvbWlzZSBvZiBhIFZvaWNlUHJvZmlsZS5cbiAgICAgKi9cbiAgICBjcmVhdGVQcm9maWxlQXN5bmMocHJvZmlsZVR5cGUsIGxhbmcpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IHByb2ZpbGVJZHMgPSB5aWVsZCB0aGlzLnByaXZWb2ljZUFkYXB0ZXIuY3JlYXRlUHJvZmlsZShwcm9maWxlVHlwZSwgbGFuZyk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFZvaWNlUHJvZmlsZShwcm9maWxlSWRzWzBdLCBwcm9maWxlVHlwZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgY3VycmVudCBpbmZvcm1hdGlvbiBvZiBhIHZvaWNlIHByb2ZpbGVcbiAgICAgKiBAbWVtYmVyIFZvaWNlUHJvZmlsZUNsaWVudC5wcm90b3R5cGUucmV0cmlldmVFbnJvbGxtZW50UmVzdWx0QXN5bmNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQGFzeW5jXG4gICAgICogQHBhcmFtIHtWb2ljZVByb2ZpbGV9IHByb2ZpbGUgVm9pY2UgUHJvZmlsZSB0byByZXRyaWV2ZSBpbmZvIGZvclxuICAgICAqIEByZXR1cm4ge1Byb21pc2U8Vm9pY2VQcm9maWxlRW5yb2xsbWVudFJlc3VsdD59IC0gUHJvbWlzZSBvZiBhIFZvaWNlUHJvZmlsZUVucm9sbG1lbnRSZXN1bHQuXG4gICAgICovXG4gICAgcmV0cmlldmVFbnJvbGxtZW50UmVzdWx0QXN5bmMocHJvZmlsZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdlZvaWNlQWRhcHRlci5yZXRyaWV2ZUVucm9sbG1lbnRSZXN1bHQocHJvZmlsZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgYWxsIHZvaWNlIHByb2ZpbGVzIG9uIGFjY291bnQgd2l0aCBnaXZlbiB2b2ljZSBwcm9maWxlIHR5cGVcbiAgICAgKiBAbWVtYmVyIFZvaWNlUHJvZmlsZUNsaWVudC5wcm90b3R5cGUuZ2V0QWxsUHJvZmlsZXNBc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcGFyYW0ge1ZvaWNlUHJvZmlsZVR5cGV9IHByb2ZpbGVUeXBlIHByb2ZpbGUgdHlwZSAoaWRlbnRpZmljYXRpb24vdmVyaWZpY2F0aW9uKSBmb3Igd2hpY2ggdG8gbGlzdCBwcm9maWxlc1xuICAgICAqIEByZXR1cm4ge1Byb21pc2U8Vm9pY2VQcm9maWxlRW5yb2xsbWVudFJlc3VsdFtdPn0gLSBQcm9taXNlIG9mIGFuIGFycmF5IG9mIFZvaWNlUHJvZmlsZUVucm9sbG1lbnRSZXN1bHRzLlxuICAgICAqL1xuICAgIGdldEFsbFByb2ZpbGVzQXN5bmMocHJvZmlsZVR5cGUpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZWb2ljZUFkYXB0ZXIuZ2V0QWxsUHJvZmlsZXMocHJvZmlsZVR5cGUpO1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdDogeyBqc29uOiB7IHZhbHVlOiBFbnJvbGxtZW50UmVzdWx0SlNPTltdIH0gfSA9IGF3YWl0IHRoaXMucHJpdkFkYXB0ZXIuZ2V0UHJvZmlsZXMocHJvZmlsZVR5cGUpO1xuICAgICAgICAgICAgaWYgKHByb2ZpbGVUeXBlID09PSBWb2ljZVByb2ZpbGVUeXBlLlRleHRJbmRlcGVuZGVudElkZW50aWZpY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFZvaWNlUHJvZmlsZUVucm9sbG1lbnRSZXN1bHQuRnJvbUlkZW50aWZpY2F0aW9uUHJvZmlsZUxpc3QocmVzdWx0Lmpzb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFZvaWNlUHJvZmlsZUVucm9sbG1lbnRSZXN1bHQuRnJvbVZlcmlmaWNhdGlvblByb2ZpbGVMaXN0KHJlc3VsdC5qc29uKTtcbiAgICAgICAgICAgICovXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdmFsaWQgYXV0aG9yaXphdGlvbiBwaHJhc2VzIGZvciB2b2ljZSBwcm9maWxlIGVucm9sbG1lbnRcbiAgICAgKiBAbWVtYmVyIFZvaWNlUHJvZmlsZUNsaWVudC5wcm90b3R5cGUuZ2V0QWN0aXZhdGlvblBocmFzZXNBc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcGFyYW0ge1ZvaWNlUHJvZmlsZVR5cGV9IHByb2ZpbGVUeXBlIFByb2ZpbGUgVHlwZSB0byBnZXQgYWN0aXZhdGlvbiBwaHJhc2VzIGZvclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBsYW5nIExhbmd1YWdlIHN0cmluZyAobG9jYWxlKSBmb3IgVm9pY2UgUHJvZmlsZVxuICAgICAqL1xuICAgIGdldEFjdGl2YXRpb25QaHJhc2VzQXN5bmMocHJvZmlsZVR5cGUsIGxhbmcpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZWb2ljZUFkYXB0ZXIuZ2V0QWN0aXZhdGlvblBocmFzZXMocHJvZmlsZVR5cGUsIGxhbmcpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgc3BlYWtlciByZWNvZ25pdGlvbiB2b2ljZSBwcm9maWxlXG4gICAgICogQG1lbWJlciBWb2ljZVByb2ZpbGVDbGllbnQucHJvdG90eXBlLmVucm9sbFByb2ZpbGVBc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcGFyYW0ge1ZvaWNlUHJvZmlsZX0gcHJvZmlsZSBWb2ljZSBQcm9maWxlIHRvIGNyZWF0ZSBlbnJvbGxtZW50IGZvclxuICAgICAqIEBwYXJhbSB7QXVkaW9Db25maWd9IGF1ZGlvQ29uZmlnIHNvdXJjZSBpbmZvIGZyb20gd2hpY2ggdG8gY3JlYXRlIGVucm9sbG1lbnRcbiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPFZvaWNlUHJvZmlsZUVucm9sbG1lbnRSZXN1bHQ+fSAtIFByb21pc2Ugb2YgYSBWb2ljZVByb2ZpbGVFbnJvbGxtZW50UmVzdWx0LlxuICAgICAqL1xuICAgIGVucm9sbFByb2ZpbGVBc3luYyhwcm9maWxlLCBhdWRpb0NvbmZpZykge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgY29uZmlnSW1wbCA9IGF1ZGlvQ29uZmlnO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQoY29uZmlnSW1wbCwgXCJhdWRpb0NvbmZpZ1wiKTtcbiAgICAgICAgICAgIHRoaXMuYXVkaW9Db25maWcgPSBhdWRpb0NvbmZpZztcbiAgICAgICAgICAgIHRoaXMucHJpdlZvaWNlQWRhcHRlci5TcGVha2VyQXVkaW9Tb3VyY2UgPSBjb25maWdJbXBsO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdlZvaWNlQWRhcHRlci5lbnJvbGxQcm9maWxlKHByb2ZpbGUpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVsZXRlIGEgc3BlYWtlciByZWNvZ25pdGlvbiB2b2ljZSBwcm9maWxlXG4gICAgICogQG1lbWJlciBWb2ljZVByb2ZpbGVDbGllbnQucHJvdG90eXBlLmRlbGV0ZVByb2ZpbGVBc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcGFyYW0ge1ZvaWNlUHJvZmlsZX0gcHJvZmlsZSBWb2ljZSBQcm9maWxlIHRvIGJlIGRlbGV0ZWRcbiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPFZvaWNlUHJvZmlsZVJlc3VsdD59IC0gUHJvbWlzZSBvZiBhIFZvaWNlUHJvZmlsZVJlc3VsdC5cbiAgICAgKi9cbiAgICBkZWxldGVQcm9maWxlQXN5bmMocHJvZmlsZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdlZvaWNlQWRhcHRlci5kZWxldGVQcm9maWxlKHByb2ZpbGUpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGFsbCBlbnJvbGxtZW50cyBmb3IgYSBzcGVha2VyIHJlY29nbml0aW9uIHZvaWNlIHByb2ZpbGVcbiAgICAgKiBAbWVtYmVyIFZvaWNlUHJvZmlsZUNsaWVudC5wcm90b3R5cGUucmVzZXRQcm9maWxlQXN5bmNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQGFzeW5jXG4gICAgICogQHBhcmFtIHtWb2ljZVByb2ZpbGV9IHByb2ZpbGUgVm9pY2UgUHJvZmlsZSB0byBiZSByZXNldFxuICAgICAqIEByZXR1cm4ge1Byb21pc2U8Vm9pY2VQcm9maWxlUmVzdWx0Pn0gLSBQcm9taXNlIG9mIGEgVm9pY2VQcm9maWxlUmVzdWx0LlxuICAgICAqL1xuICAgIHJlc2V0UHJvZmlsZUFzeW5jKHByb2ZpbGUpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZWb2ljZUFkYXB0ZXIucmVzZXRQcm9maWxlKHByb2ZpbGUpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xlYW4gdXAgb2JqZWN0IGFuZCBjbG9zZSB1bmRlcmx5aW5nIGNvbm5lY3Rpb25cbiAgICAgKiBAbWVtYmVyIFZvaWNlUHJvZmlsZUNsaWVudC5wcm90b3R5cGUuY2xvc2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLmRpc3Bvc2UodHJ1ZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjcmVhdGVTZXJ2aWNlUmVjb2duaXplcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvQ29uZmlnLCByZWNvZ25pemVyQ29uZmlnKSB7XG4gICAgICAgIGNvbnN0IGF1ZGlvSW1wbCA9IGF1ZGlvQ29uZmlnO1xuICAgICAgICByZXR1cm4gbmV3IFZvaWNlU2VydmljZVJlY29nbml6ZXIoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb0ltcGwsIHJlY29nbml6ZXJDb25maWcsIHRoaXMpO1xuICAgIH1cbiAgICBkaXNwb3NlKGRpc3Bvc2luZykge1xuICAgICAgICBjb25zdCBfc3VwZXIgPSBPYmplY3QuY3JlYXRlKG51bGwsIHtcbiAgICAgICAgICAgIGRpc3Bvc2U6IHsgZ2V0OiAoKSA9PiBzdXBlci5kaXNwb3NlIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2RGlzcG9zZWRWb2ljZUFkYXB0ZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnByaXZEaXNwb3NlZFZvaWNlQWRhcHRlciA9IHRydWU7XG4gICAgICAgICAgICBpZiAoZGlzcG9zaW5nKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgX3N1cGVyLmRpc3Bvc2UuY2FsbCh0aGlzLCBkaXNwb3NpbmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgY3JlYXRlUmVjb2duaXplckNvbmZpZyhzcGVlY2hDb25maWcpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZWNvZ25pemVyQ29uZmlnKHNwZWVjaENvbmZpZywgdGhpcy5wcm9wZXJ0aWVzKTtcbiAgICB9XG4gICAgZ2V0UmVzdWx0KHJlc3VsdCwgc3VjY2Vzc1JlYXNvbikge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IG5ldyBWb2ljZVByb2ZpbGVSZXN1bHQocmVzdWx0Lm9rID8gc3VjY2Vzc1JlYXNvbiA6IFJlc3VsdFJlYXNvbi5DYW5jZWxlZCwgcmVzdWx0LnN0YXR1c1RleHQpO1xuICAgICAgICByZXR1cm4gKHJlc3BvbnNlKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVZvaWNlUHJvZmlsZUNsaWVudC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyogZXNsaW50LWRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGUgKi9cbmltcG9ydCB7IENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSB9IGZyb20gXCIuLi9jb21tb24uc3BlZWNoL0V4cG9ydHNcIjtcbmltcG9ydCB7IENhbmNlbGxhdGlvbkRldGFpbHNCYXNlLCBDYW5jZWxsYXRpb25FcnJvckNvZGUsIENhbmNlbGxhdGlvblJlYXNvbiwgUHJvcGVydHlDb2xsZWN0aW9uLCBSZXN1bHRSZWFzb24gfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIE91dHB1dCBmb3JtYXRcbiAqIEBjbGFzcyBWb2ljZVByb2ZpbGVFbnJvbGxtZW50UmVzdWx0XG4gKi9cbmV4cG9ydCBjbGFzcyBWb2ljZVByb2ZpbGVFbnJvbGxtZW50UmVzdWx0IHtcbiAgICBjb25zdHJ1Y3RvcihyZWFzb24sIGpzb24sIHN0YXR1c1RleHQpIHtcbiAgICAgICAgdGhpcy5wcml2UmVhc29uID0gcmVhc29uO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICBpZiAodGhpcy5wcml2UmVhc29uICE9PSBSZXN1bHRSZWFzb24uQ2FuY2VsZWQpIHtcbiAgICAgICAgICAgIGlmICghIWpzb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZEZXRhaWxzID0gSlNPTi5wYXJzZShqc29uKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2RGV0YWlscy5lbnJvbGxtZW50U3RhdHVzLnRvTG93ZXJDYXNlKCkgPT09IFwiZW5yb2xsaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVhc29uID0gUmVzdWx0UmVhc29uLkVucm9sbGluZ1ZvaWNlUHJvZmlsZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnByaXZFcnJvckRldGFpbHMgPSBzdGF0dXNUZXh0O1xuICAgICAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShDYW5jZWxsYXRpb25FcnJvckNvZGVQcm9wZXJ0eU5hbWUsIENhbmNlbGxhdGlvbkVycm9yQ29kZVtDYW5jZWxsYXRpb25FcnJvckNvZGUuU2VydmljZUVycm9yXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IHJlYXNvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlYXNvbjtcbiAgICB9XG4gICAgZ2V0IGVucm9sbG1lbnRzQ291bnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZEZXRhaWxzLmVucm9sbG1lbnRzQ291bnQ7XG4gICAgfVxuICAgIGdldCBlbnJvbGxtZW50c0xlbmd0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkRldGFpbHMuZW5yb2xsbWVudHNMZW5ndGg7XG4gICAgfVxuICAgIGdldCBwcm9wZXJ0aWVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcztcbiAgICB9XG4gICAgZ2V0IGVucm9sbG1lbnRSZXN1bHREZXRhaWxzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RGV0YWlscztcbiAgICB9XG4gICAgZ2V0IGVycm9yRGV0YWlscygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkVycm9yRGV0YWlscztcbiAgICB9XG4gICAgc3RhdGljIEZyb21JZGVudGlmaWNhdGlvblByb2ZpbGVMaXN0KGpzb24pIHtcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YganNvbi52YWx1ZSkge1xuICAgICAgICAgICAgY29uc3QgcmVhc29uID0gaXRlbS5lbnJvbGxtZW50U3RhdHVzLnRvTG93ZXJDYXNlKCkgPT09IFwiZW5yb2xsaW5nXCIgP1xuICAgICAgICAgICAgICAgIFJlc3VsdFJlYXNvbi5FbnJvbGxpbmdWb2ljZVByb2ZpbGUgOiBpdGVtLmVucm9sbG1lbnRTdGF0dXMudG9Mb3dlckNhc2UoKSA9PT0gXCJlbnJvbGxlZFwiID9cbiAgICAgICAgICAgICAgICBSZXN1bHRSZWFzb24uRW5yb2xsZWRWb2ljZVByb2ZpbGUgOiBSZXN1bHRSZWFzb24uQ2FuY2VsZWQ7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgVm9pY2VQcm9maWxlRW5yb2xsbWVudFJlc3VsdChyZWFzb24sIG51bGwsIG51bGwpO1xuICAgICAgICAgICAgcmVzdWx0LnByaXZEZXRhaWxzID0gdGhpcy5nZXRJZGVudGlmaWNhdGlvbkRldGFpbHMoaXRlbSk7XG4gICAgICAgICAgICByZXN1bHRzLnB1c2gocmVzdWx0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0cztcbiAgICB9XG4gICAgc3RhdGljIEZyb21WZXJpZmljYXRpb25Qcm9maWxlTGlzdChqc29uKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGpzb24udmFsdWUpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlYXNvbiA9IGl0ZW0uZW5yb2xsbWVudFN0YXR1cy50b0xvd2VyQ2FzZSgpID09PSBcImVucm9sbGluZ1wiID9cbiAgICAgICAgICAgICAgICBSZXN1bHRSZWFzb24uRW5yb2xsaW5nVm9pY2VQcm9maWxlIDogaXRlbS5lbnJvbGxtZW50U3RhdHVzLnRvTG93ZXJDYXNlKCkgPT09IFwiZW5yb2xsZWRcIiA/XG4gICAgICAgICAgICAgICAgUmVzdWx0UmVhc29uLkVucm9sbGVkVm9pY2VQcm9maWxlIDogUmVzdWx0UmVhc29uLkNhbmNlbGVkO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IFZvaWNlUHJvZmlsZUVucm9sbG1lbnRSZXN1bHQocmVhc29uLCBudWxsLCBudWxsKTtcbiAgICAgICAgICAgIHJlc3VsdC5wcml2RGV0YWlscyA9IHRoaXMuZ2V0VmVyaWZpY2F0aW9uRGV0YWlscyhpdGVtKTtcbiAgICAgICAgICAgIHJlc3VsdHMucHVzaChyZXN1bHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgIH1cbiAgICBzdGF0aWMgZ2V0SWRlbnRpZmljYXRpb25EZXRhaWxzKGpzb24pIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGF1ZGlvTGVuZ3RoOiBqc29uLmF1ZGlvTGVuZ3RoID8gcGFyc2VGbG9hdChqc29uLmF1ZGlvTGVuZ3RoKSA6IDAsXG4gICAgICAgICAgICBhdWRpb1NwZWVjaExlbmd0aDoganNvbi5hdWRpb1NwZWVjaExlbmd0aCA/IHBhcnNlRmxvYXQoanNvbi5hdWRpb1NwZWVjaExlbmd0aCkgOiAwLFxuICAgICAgICAgICAgZW5yb2xsbWVudFN0YXR1czoganNvbi5lbnJvbGxtZW50U3RhdHVzLFxuICAgICAgICAgICAgZW5yb2xsbWVudHNDb3VudDoganNvbi5lbnJvbGxtZW50c0NvdW50IHx8IDAsXG4gICAgICAgICAgICBlbnJvbGxtZW50c0xlbmd0aDoganNvbi5lbnJvbGxtZW50c0xlbmd0aCA/IHBhcnNlRmxvYXQoanNvbi5lbnJvbGxtZW50c0xlbmd0aCkgOiAwLFxuICAgICAgICAgICAgZW5yb2xsbWVudHNTcGVlY2hMZW5ndGg6IGpzb24uZW5yb2xsbWVudHNTcGVlY2hMZW5ndGggPyBwYXJzZUZsb2F0KGpzb24uZW5yb2xsbWVudHNTcGVlY2hMZW5ndGgpIDogMCxcbiAgICAgICAgICAgIHByb2ZpbGVJZDoganNvbi5wcm9maWxlSWQgfHwganNvbi5pZGVudGlmaWNhdGlvblByb2ZpbGVJZCxcbiAgICAgICAgICAgIHJlbWFpbmluZ0Vucm9sbG1lbnRzU3BlZWNoTGVuZ3RoOiBqc29uLnJlbWFpbmluZ0Vucm9sbG1lbnRzU3BlZWNoTGVuZ3RoID8gcGFyc2VGbG9hdChqc29uLnJlbWFpbmluZ0Vucm9sbG1lbnRzU3BlZWNoTGVuZ3RoKSA6IDBcbiAgICAgICAgfTtcbiAgICB9XG4gICAgc3RhdGljIGdldFZlcmlmaWNhdGlvbkRldGFpbHMoanNvbikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYXVkaW9MZW5ndGg6IGpzb24uYXVkaW9MZW5ndGggPyBwYXJzZUZsb2F0KGpzb24uYXVkaW9MZW5ndGgpIDogMCxcbiAgICAgICAgICAgIGF1ZGlvU3BlZWNoTGVuZ3RoOiBqc29uLmF1ZGlvU3BlZWNoTGVuZ3RoID8gcGFyc2VGbG9hdChqc29uLmF1ZGlvU3BlZWNoTGVuZ3RoKSA6IDAsXG4gICAgICAgICAgICBlbnJvbGxtZW50U3RhdHVzOiBqc29uLmVucm9sbG1lbnRTdGF0dXMsXG4gICAgICAgICAgICBlbnJvbGxtZW50c0NvdW50OiBqc29uLmVucm9sbG1lbnRzQ291bnQsXG4gICAgICAgICAgICBlbnJvbGxtZW50c0xlbmd0aDoganNvbi5lbnJvbGxtZW50c0xlbmd0aCA/IHBhcnNlRmxvYXQoanNvbi5lbnJvbGxtZW50c0xlbmd0aCkgOiAwLFxuICAgICAgICAgICAgZW5yb2xsbWVudHNTcGVlY2hMZW5ndGg6IGpzb24uZW5yb2xsbWVudHNTcGVlY2hMZW5ndGggPyBwYXJzZUZsb2F0KGpzb24uZW5yb2xsbWVudHNTcGVlY2hMZW5ndGgpIDogMCxcbiAgICAgICAgICAgIHByb2ZpbGVJZDoganNvbi5wcm9maWxlSWQgfHwganNvbi52ZXJpZmljYXRpb25Qcm9maWxlSWQsXG4gICAgICAgICAgICByZW1haW5pbmdFbnJvbGxtZW50c0NvdW50OiBqc29uLnJlbWFpbmluZ0Vucm9sbG1lbnRzIHx8IGpzb24ucmVtYWluaW5nRW5yb2xsbWVudHNDb3VudCxcbiAgICAgICAgICAgIHJlbWFpbmluZ0Vucm9sbG1lbnRzU3BlZWNoTGVuZ3RoOiBqc29uLnJlbWFpbmluZ0Vucm9sbG1lbnRzU3BlZWNoTGVuZ3RoID8gcGFyc2VGbG9hdChqc29uLnJlbWFpbmluZ0Vucm9sbG1lbnRzU3BlZWNoTGVuZ3RoKSA6IDBcbiAgICAgICAgfTtcbiAgICB9XG59XG4vKipcbiAqIEBjbGFzcyBWb2ljZVByb2ZpbGVFbnJvbGxtZW50Q2FuY2VsbGF0aW9uRGV0YWlsc1xuICovXG5leHBvcnQgY2xhc3MgVm9pY2VQcm9maWxlRW5yb2xsbWVudENhbmNlbGxhdGlvbkRldGFpbHMgZXh0ZW5kcyBDYW5jZWxsYXRpb25EZXRhaWxzQmFzZSB7XG4gICAgY29uc3RydWN0b3IocmVhc29uLCBlcnJvckRldGFpbHMsIGVycm9yQ29kZSkge1xuICAgICAgICBzdXBlcihyZWFzb24sIGVycm9yRGV0YWlscywgZXJyb3JDb2RlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBWb2ljZVByb2ZpbGVFbnJvbGxtZW50Q2FuY2VsbGF0aW9uRGV0YWlscyBvYmplY3QgZm9yIHRoZSBjYW5jZWxlZCBWb2ljZVByb2ZpbGVFbnJvbGxtZW50UmVzdWx0LlxuICAgICAqIEBtZW1iZXIgVm9pY2VQcm9maWxlRW5yb2xsbWVudENhbmNlbGxhdGlvbkRldGFpbHMuZnJvbVJlc3VsdFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge1ZvaWNlUHJvZmlsZUVucm9sbG1lbnRSZXN1bHR9IHJlc3VsdCAtIFRoZSByZXN1bHQgdGhhdCB3YXMgY2FuY2VsZWQuXG4gICAgICogQHJldHVybnMge1ZvaWNlUHJvZmlsZUVucm9sbG1lbnRDYW5jZWxsYXRpb25EZXRhaWxzfSBUaGUgY2FuY2VsbGF0aW9uIGRldGFpbHMgb2JqZWN0IGJlaW5nIGNyZWF0ZWQuXG4gICAgICovXG4gICAgc3RhdGljIGZyb21SZXN1bHQocmVzdWx0KSB7XG4gICAgICAgIGNvbnN0IHJlYXNvbiA9IENhbmNlbGxhdGlvblJlYXNvbi5FcnJvcjtcbiAgICAgICAgbGV0IGVycm9yQ29kZSA9IENhbmNlbGxhdGlvbkVycm9yQ29kZS5Ob0Vycm9yO1xuICAgICAgICBpZiAoISFyZXN1bHQucHJvcGVydGllcykge1xuICAgICAgICAgICAgZXJyb3JDb2RlID0gQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW3Jlc3VsdC5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW0NhbmNlbGxhdGlvbkVycm9yQ29kZS5Ob0Vycm9yXSldOyAvL2VzbGludC1kaXNhYmxlLWxpbmVcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFZvaWNlUHJvZmlsZUVucm9sbG1lbnRDYW5jZWxsYXRpb25EZXRhaWxzKHJlYXNvbiwgcmVzdWx0LmVycm9yRGV0YWlscywgZXJyb3JDb2RlKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVZvaWNlUHJvZmlsZUVucm9sbG1lbnRSZXN1bHQuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuL0NvbnRyYWN0c1wiO1xuaW1wb3J0IHsgVm9pY2VQcm9maWxlUmVzdWx0IH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBPdXRwdXQgZm9ybWF0XG4gKiBAY2xhc3MgVm9pY2VQcm9maWxlUGhyYXNlUmVzdWx0XG4gKi9cbmV4cG9ydCBjbGFzcyBWb2ljZVByb2ZpbGVQaHJhc2VSZXN1bHQgZXh0ZW5kcyBWb2ljZVByb2ZpbGVSZXN1bHQge1xuICAgIGNvbnN0cnVjdG9yKHJlYXNvbiwgc3RhdHVzVGV4dCwgdHlwZSwgcGhyYXNlQXJyYXkpIHtcbiAgICAgICAgc3VwZXIocmVhc29uLCBzdGF0dXNUZXh0KTtcbiAgICAgICAgdGhpcy5wcml2UGhyYXNlcyA9IFtdO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChwaHJhc2VBcnJheSwgXCJwaHJhc2UgYXJyYXlcIik7XG4gICAgICAgIHRoaXMucHJpdlR5cGUgPSB0eXBlO1xuICAgICAgICBpZiAoISFwaHJhc2VBcnJheSAmJiAhIXBocmFzZUFycmF5WzBdKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZQaHJhc2VzID0gcGhyYXNlQXJyYXk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IHBocmFzZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQaHJhc2VzO1xuICAgIH1cbiAgICBnZXQgdHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlR5cGU7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Wb2ljZVByb2ZpbGVQaHJhc2VSZXN1bHQuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qIGVzbGludC1kaXNhYmxlIG1heC1jbGFzc2VzLXBlci1maWxlICovXG5pbXBvcnQgeyBDYW5jZWxsYXRpb25FcnJvckNvZGVQcm9wZXJ0eU5hbWUgfSBmcm9tIFwiLi4vY29tbW9uLnNwZWVjaC9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi9Db250cmFjdHNcIjtcbmltcG9ydCB7IENhbmNlbGxhdGlvbkRldGFpbHNCYXNlLCBDYW5jZWxsYXRpb25FcnJvckNvZGUsIENhbmNlbGxhdGlvblJlYXNvbiwgUHJvcGVydHlDb2xsZWN0aW9uLCBSZXN1bHRSZWFzb24gfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIE91dHB1dCBmb3JtYXRcbiAqIEBjbGFzcyBWb2ljZVByb2ZpbGVSZXN1bHRcbiAqL1xuZXhwb3J0IGNsYXNzIFZvaWNlUHJvZmlsZVJlc3VsdCB7XG4gICAgY29uc3RydWN0b3IocmVhc29uLCBzdGF0dXNUZXh0KSB7XG4gICAgICAgIHRoaXMucHJpdlJlYXNvbiA9IHJlYXNvbjtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcyA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICAgICAgaWYgKHJlYXNvbiA9PT0gUmVzdWx0UmVhc29uLkNhbmNlbGVkKSB7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChzdGF0dXNUZXh0LCBcInN0YXR1c1RleHRcIik7XG4gICAgICAgICAgICB0aGlzLnByaXZFcnJvckRldGFpbHMgPSBzdGF0dXNUZXh0O1xuICAgICAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShDYW5jZWxsYXRpb25FcnJvckNvZGVQcm9wZXJ0eU5hbWUsIENhbmNlbGxhdGlvbkVycm9yQ29kZVtDYW5jZWxsYXRpb25FcnJvckNvZGUuU2VydmljZUVycm9yXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IHJlYXNvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlYXNvbjtcbiAgICB9XG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzO1xuICAgIH1cbiAgICBnZXQgZXJyb3JEZXRhaWxzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXJyb3JEZXRhaWxzO1xuICAgIH1cbn1cbi8qKlxuICogQGNsYXNzIFZvaWNlUHJvZmlsZUNhbmNlbGxhdGlvbkRldGFpbHNcbiAqL1xuZXhwb3J0IGNsYXNzIFZvaWNlUHJvZmlsZUNhbmNlbGxhdGlvbkRldGFpbHMgZXh0ZW5kcyBDYW5jZWxsYXRpb25EZXRhaWxzQmFzZSB7XG4gICAgY29uc3RydWN0b3IocmVhc29uLCBlcnJvckRldGFpbHMsIGVycm9yQ29kZSkge1xuICAgICAgICBzdXBlcihyZWFzb24sIGVycm9yRGV0YWlscywgZXJyb3JDb2RlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBWb2ljZVByb2ZpbGVDYW5jZWxsYXRpb25EZXRhaWxzIG9iamVjdCBmb3IgdGhlIGNhbmNlbGVkIFZvaWNlUHJvZmlsZVJlc3VsdC5cbiAgICAgKiBAbWVtYmVyIFZvaWNlUHJvZmlsZUNhbmNlbGxhdGlvbkRldGFpbHMuZnJvbVJlc3VsdFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge1ZvaWNlUHJvZmlsZVJlc3VsdH0gcmVzdWx0IC0gVGhlIHJlc3VsdCB0aGF0IHdhcyBjYW5jZWxlZC5cbiAgICAgKiBAcmV0dXJucyB7Vm9pY2VQcm9maWxlQ2FuY2VsbGF0aW9uRGV0YWlsc30gVGhlIGNhbmNlbGxhdGlvbiBkZXRhaWxzIG9iamVjdCBiZWluZyBjcmVhdGVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tUmVzdWx0KHJlc3VsdCkge1xuICAgICAgICBjb25zdCByZWFzb24gPSBDYW5jZWxsYXRpb25SZWFzb24uRXJyb3I7XG4gICAgICAgIGxldCBlcnJvckNvZGUgPSBDYW5jZWxsYXRpb25FcnJvckNvZGUuTm9FcnJvcjtcbiAgICAgICAgaWYgKCEhcmVzdWx0LnByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgIGVycm9yQ29kZSA9IENhbmNlbGxhdGlvbkVycm9yQ29kZVtyZXN1bHQucHJvcGVydGllcy5nZXRQcm9wZXJ0eShDYW5jZWxsYXRpb25FcnJvckNvZGVQcm9wZXJ0eU5hbWUsIENhbmNlbGxhdGlvbkVycm9yQ29kZVtDYW5jZWxsYXRpb25FcnJvckNvZGUuTm9FcnJvcl0pXTsgLy9lc2xpbnQtZGlzYWJsZS1saW5lXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBWb2ljZVByb2ZpbGVDYW5jZWxsYXRpb25EZXRhaWxzKHJlYXNvbiwgcmVzdWx0LmVycm9yRGV0YWlscywgZXJyb3JDb2RlKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVZvaWNlUHJvZmlsZVJlc3VsdC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBPdXRwdXQgZm9ybWF0XG4gKiBAY2xhc3MgVm9pY2VQcm9maWxlVHlwZVxuICovXG5leHBvcnQgdmFyIFZvaWNlUHJvZmlsZVR5cGU7XG4oZnVuY3Rpb24gKFZvaWNlUHJvZmlsZVR5cGUpIHtcbiAgICAvKipcbiAgICAgKiBUZXh0IGluZGVwZW5kZW50IHNwZWFrZXIgaWRlbnRpZmljYXRpb25cbiAgICAgKiBAbWVtYmVyIFZvaWNlUHJvZmlsZVR5cGUuVGV4dEluZGVwZW5kZW50SWRlbnRpZmljYXRpb25cbiAgICAgKi9cbiAgICBWb2ljZVByb2ZpbGVUeXBlW1ZvaWNlUHJvZmlsZVR5cGVbXCJUZXh0SW5kZXBlbmRlbnRJZGVudGlmaWNhdGlvblwiXSA9IDBdID0gXCJUZXh0SW5kZXBlbmRlbnRJZGVudGlmaWNhdGlvblwiO1xuICAgIC8qKlxuICAgICAqIFRleHQgZGVwZW5kZW50IHNwZWFrZXIgdmVyaWZpY2F0aW9uXG4gICAgICogQG1lbWJlciBWb2ljZVByb2ZpbGVUeXBlLlRleHREZXBlbmRlbnRWZXJpZmljYXRpb25cbiAgICAgKi9cbiAgICBWb2ljZVByb2ZpbGVUeXBlW1ZvaWNlUHJvZmlsZVR5cGVbXCJUZXh0RGVwZW5kZW50VmVyaWZpY2F0aW9uXCJdID0gMV0gPSBcIlRleHREZXBlbmRlbnRWZXJpZmljYXRpb25cIjtcbiAgICAvKipcbiAgICAgKiBUZXh0IGluZGVwZW5kZW50IHNwZWFrZXIgdmVyaWZpY2F0aW9uXG4gICAgICogQG1lbWJlciBWb2ljZVByb2ZpbGVUeXBlLlRleHRJbmRlcGVuZGVudFZlcmlmaWNhdGlvblxuICAgICAqL1xuICAgIFZvaWNlUHJvZmlsZVR5cGVbVm9pY2VQcm9maWxlVHlwZVtcIlRleHRJbmRlcGVuZGVudFZlcmlmaWNhdGlvblwiXSA9IDJdID0gXCJUZXh0SW5kZXBlbmRlbnRWZXJpZmljYXRpb25cIjtcbn0pKFZvaWNlUHJvZmlsZVR5cGUgfHwgKFZvaWNlUHJvZmlsZVR5cGUgPSB7fSkpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Wb2ljZVByb2ZpbGVUeXBlLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLm1vZGVscyA9IHZvaWQgMDtcbmV4cG9ydHMubW9kZWxzID0gW1xuICAgIHtcbiAgICAgICAgJ25hbWUnOiAnZ3B0LTMuNS10dXJibycsXG4gICAgICAgICdpZCc6ICdvcGVuYWkvZ3B0LTMuNS10dXJibydcbiAgICB9LFxuICAgIHtcbiAgICAgICAgJ25hbWUnOiAnZ3B0LTMuNS10dXJiby0xNmsnLFxuICAgICAgICAnaWQnOiAnb3BlbmFpL2dwdC0zLjUtdHVyYm8tMTZrJ1xuICAgIH0sXG4gICAge1xuICAgICAgICAnbmFtZSc6ICdncHQtNCcsXG4gICAgICAgICdpZCc6ICdvcGVuYWkvZ3B0LTQnXG4gICAgfSxcbiAgICB7XG4gICAgICAgICduYW1lJzogJ2dwdC00LTMyaycsXG4gICAgICAgICdpZCc6ICdvcGVuYWkvZ3B0LTQtMzJrJ1xuICAgIH0sXG4gICAge1xuICAgICAgICAnbmFtZSc6ICdjbGF1ZGUtMicsXG4gICAgICAgICdpZCc6ICdhbnRocm9waWMvY2xhdWRlLTInXG4gICAgfSxcbiAgICB7XG4gICAgICAgICduYW1lJzogJ2NsYXVkZS1pbnN0YW50LXYxJyxcbiAgICAgICAgJ2lkJzogJ2FudGhyb3BpYy9jbGF1ZGUtaW5zdGFudC12MSdcbiAgICB9LFxuICAgIHtcbiAgICAgICAgJ25hbWUnOiAnUGFMTSAyIEJpc29uJyxcbiAgICAgICAgJ2lkJzogJ2dvb2dsZS9wYWxtLTItY2hhdC1iaXNvbidcbiAgICB9LFxuICAgIHtcbiAgICAgICAgJ25hbWUnOiAnTGxhbWEgdjIgMTNCIENoYXQgKGJldGEpJyxcbiAgICAgICAgJ2lkJzogJ21ldGEtbGxhbWEvbGxhbWEtMi0xM2ItY2hhdCdcbiAgICB9XG5dO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuZ2V0U2V0dGluZ3MgPSB2b2lkIDA7XG5jb25zdCB3ZWJleHRlbnNpb25fcG9seWZpbGxfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwid2ViZXh0ZW5zaW9uLXBvbHlmaWxsXCIpKTtcbmNvbnN0IG1vZGVsc18xID0gcmVxdWlyZShcIi4vbW9kZWxzXCIpO1xuZnVuY3Rpb24gZ2V0U2V0dGluZ3MoKSB7XG4gICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgbGV0IGl0ZW1zID0geWllbGQgd2ViZXh0ZW5zaW9uX3BvbHlmaWxsXzEuZGVmYXVsdC5zdG9yYWdlLnN5bmMuZ2V0KHtcbiAgICAgICAgICAgIFwib3BlbkFwaUtleVwiOiAnJyxcbiAgICAgICAgICAgIFwib3BlbkFwaUVuZHBvaW50XCI6ICdodHRwczovL2FwaS5vcGVuYWkuY29tJyxcbiAgICAgICAgICAgIFwidW5zcGxhc2hBcGlLZXlcIjogJycsXG4gICAgICAgICAgICBcImN1cnJlbnRMYW5ndWFnZVwiOiAnJyxcbiAgICAgICAgICAgIFwidGFyZ2V0TGFuZ3VhZ2VcIjogJycsXG4gICAgICAgICAgICBcImFua2lEZWNrTmFtZVwiOiAnJyxcbiAgICAgICAgICAgIFwibGljZW5zZUtleVwiOiAnJyxcbiAgICAgICAgICAgIFwibW9kZWxcIjogbW9kZWxzXzEubW9kZWxzWzBdWydpZCddLCBcImFwaUtleVNlbGVjdGlvblwiOiAnbGljZW5zZUtleSdcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBpdGVtcztcbiAgICB9KTtcbn1cbmV4cG9ydHMuZ2V0U2V0dGluZ3MgPSBnZXRTZXR0aW5ncztcbiIsIlwidXNlIHN0cmljdFwiO1xudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5jb25zdCB3ZWJleHRlbnNpb25fcG9seWZpbGxfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwid2ViZXh0ZW5zaW9uLXBvbHlmaWxsXCIpKTtcbmNvbnN0IGV2ZW50c291cmNlX3BhcnNlcl8xID0gcmVxdWlyZShcImV2ZW50c291cmNlLXBhcnNlclwiKTtcbmNvbnN0IHV0aWxfMSA9IHJlcXVpcmUoXCIuL3V0aWxcIik7XG5jb25zdCB1bnNwbGFzaF9qc18xID0gcmVxdWlyZShcInVuc3BsYXNoLWpzXCIpO1xuY29uc3QgdXRpbF8yID0gcmVxdWlyZShcIi4vT3B0aW9ucy91dGlsXCIpO1xuLy8gY29udGVudCBzY3JpcHQg5YWz6Zet56qX5Y+j5pe277yM5bCG5q2k5YC86K6+5Li6IGZhbHNlIOS7peS4reaWreaVsOaNrua4suafk1xuLy8gbGV0IGlzQ29udGludWUgPSB0cnVlXG5sZXQgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbmNvbnN0IGRlZmF1bHRPcGVuQXBpRW5kcG9pbnQgPSAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbSc7XG5jb25zb2xlLmxvZygnSSBhbSBiYWNrZ3JvdW5kJyk7XG53ZWJleHRlbnNpb25fcG9seWZpbGxfMS5kZWZhdWx0LnJ1bnRpbWUub25JbnN0YWxsZWQuYWRkTGlzdGVuZXIoZnVuY3Rpb24gKCkge1xuICAgIGNvbnNvbGUubG9nKFwi5o+S5Lu25bey6KKr5a6J6KOFXCIpO1xufSk7XG4vLyDljbjovb3mj5Lku7blkI7lvJXlr7zloavlhpnljbjovb3ljp/lm6DvvIzluK7liqnkuqflk4HkvJjljJZcbndlYmV4dGVuc2lvbl9wb2x5ZmlsbF8xLmRlZmF1bHQucnVudGltZS5zZXRVbmluc3RhbGxVUkwoXCJodHRwczovL2RvY3MuZ29vZ2xlLmNvbS9mb3Jtcy9kL2UvMUZBSXBRTFNkb2JHUU4zTzBDazRmVnJnZnZSWk1tZTNkZS0yT2FFcDFwRnRpYlprVTBrb2MzN3cvdmlld2Zvcm0/dXNwPXNmX2xpbmtcIik7XG4vLyDliJvlu7rlj7PplK7oj5zljZVcbndlYmV4dGVuc2lvbl9wb2x5ZmlsbF8xLmRlZmF1bHQuY29udGV4dE1lbnVzLmNyZWF0ZSh7XG4gICAgaWQ6IFwiMlwiLFxuICAgIHRpdGxlOiBcIlJ1biBsYXN0IHByb21wdFwiLFxuICAgIGNvbnRleHRzOiBbXCJzZWxlY3Rpb25cIl0sXG59LCAoKSA9PiB7XG4gICAgd2ViZXh0ZW5zaW9uX3BvbHlmaWxsXzEuZGVmYXVsdC5ydW50aW1lLmxhc3RFcnJvcjtcbn0pO1xud2ViZXh0ZW5zaW9uX3BvbHlmaWxsXzEuZGVmYXVsdC5jb250ZXh0TWVudXMuY3JlYXRlKHtcbiAgICBpZDogXCIxXCIsXG4gICAgdGl0bGU6IFwiT3BlblwiLFxuICAgIGNvbnRleHRzOiBbXCJzZWxlY3Rpb25cIl0sXG59LCAoKSA9PiB7XG4gICAgd2ViZXh0ZW5zaW9uX3BvbHlmaWxsXzEuZGVmYXVsdC5ydW50aW1lLmxhc3RFcnJvcjtcbn0pO1xuLy8g5Y+z6ZSu6I+c5Y2V54K55Ye75LqL5Lu2XG53ZWJleHRlbnNpb25fcG9seWZpbGxfMS5kZWZhdWx0LmNvbnRleHRNZW51cy5vbkNsaWNrZWQuYWRkTGlzdGVuZXIoZnVuY3Rpb24gKGluZm8sIF90YWIpIHtcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICBjb25zb2xlLmxvZygn5Y+z6ZSu6I+c5Y2V54K55Ye75LqL5Lu2Jyk7XG4gICAgICAgIGNvbnNvbGUubG9nKGluZm8pO1xuICAgICAgICBjb25zdCBydW5Qcm9tcHQgPSBpbmZvLm1lbnVJdGVtSWQgPT09ICcyJyA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgc2VuZE1lc3NhZ2VUb0NvbnRlbnQocnVuUHJvbXB0KTtcbiAgICB9KTtcbn0pO1xuLy8g55uR5ZCs5b+r5o236ZSuXG53ZWJleHRlbnNpb25fcG9seWZpbGxfMS5kZWZhdWx0LmNvbW1hbmRzLm9uQ29tbWFuZC5hZGRMaXN0ZW5lcihmdW5jdGlvbiAoY29tbWFuZCkge1xuICAgIGNvbnNvbGUubG9nKCdoZWxsbycpO1xuICAgIGlmIChjb21tYW5kID09PSAnUnVuTGFzdFByb21wdCcpIHtcbiAgICAgICAgLy8g5omn6KGM55u45YWz5Luj56CBXG4gICAgICAgIHNlbmRNZXNzYWdlVG9Db250ZW50KCk7XG4gICAgfVxufSk7XG4vLyDplb/ov57mjqXvvIzlpITnkIYgR1BUIOaVsOaNrlxud2ViZXh0ZW5zaW9uX3BvbHlmaWxsXzEuZGVmYXVsdC5ydW50aW1lLm9uQ29ubmVjdC5hZGRMaXN0ZW5lcihwb3J0ID0+IHtcbiAgICAvLyDmlLbliLAgY29udGVudCBzY3JpcHQg5raI5oGvXG4gICAgY29uc29sZS5sb2coJ+i/nuaOpeS4rS0tLS0tLS0tLS0tLScpO1xuICAgIGNvbnNvbGUubG9nKCdwcm9jZXNzLmVudi5BTVBMSVRVREVfS0VZOicpO1xuICAgIGNvbnNvbGUubG9nKHByb2Nlc3MuZW52LkFNUExJVFVERV9LRVkpO1xuICAgIGNvbnNvbGUubG9nKHByb2Nlc3MuZW52KTtcbiAgICAvLyBhbXBsaXR1ZGUuaW5pdChwcm9jZXNzLmVudi5BTVBMSVRVREVfS0VZIGFzIHN0cmluZyk7XG4gICAgLy8gYW1wbGl0dWRlLnRyYWNrKCdleGVjdXRpdmVQcm9tcHQnKTtcbiAgICAvLyDmjqXmlLYgY29udGVudCBzY3JpcHQg55qE5raI5oGvXG4gICAgcG9ydC5vbk1lc3NhZ2UuYWRkTGlzdGVuZXIoKG1zZykgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfmjqXmlLbmtojmga/vvJonLCBtc2cpO1xuICAgICAgICAvLyDojrflj5YgQVBJIEtleSDnrYnlrZjlgqjnmoTmlbDmja5cbiAgICAgICAgbGV0IG9wZW5BcGlLZXksIGFwaUtleVNlbGVjdGlvbiwgbW9kZWwsIGxpY2Vuc2VLZXksIGN1cnJlbnRMYW5ndWFnZSwgb3BlbkFwaUVuZHBvaW50LCB0YXJnZXRMYW5ndWFnZSA9ICcnO1xuICAgICAgICAoMCwgdXRpbF8yLmdldFNldHRpbmdzKSgpLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgYXBpS2V5U2VsZWN0aW9uID0gcmVzdWx0LmFwaUtleVNlbGVjdGlvbjtcbiAgICAgICAgICAgIGxpY2Vuc2VLZXkgPSByZXN1bHQubGljZW5zZUtleTtcbiAgICAgICAgICAgIG9wZW5BcGlLZXkgPSByZXN1bHQub3BlbkFwaUtleTtcbiAgICAgICAgICAgIG9wZW5BcGlFbmRwb2ludCA9IHJlc3VsdC5vcGVuQXBpRW5kcG9pbnQ7XG4gICAgICAgICAgICBjdXJyZW50TGFuZ3VhZ2UgPSByZXN1bHQuY3VycmVudExhbmd1YWdlO1xuICAgICAgICAgICAgdGFyZ2V0TGFuZ3VhZ2UgPSByZXN1bHQudGFyZ2V0TGFuZ3VhZ2U7XG4gICAgICAgICAgICBtb2RlbCA9IHJlc3VsdC5tb2RlbDtcbiAgICAgICAgICAgIC8vIOivt+axgiAgR1BUIOaVsOaNrlxuICAgICAgICAgICAgaWYgKG1zZy50eXBlID09PSAnZ2V0R1BUTXNnJykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnZXRHUFRNc2cnKTtcbiAgICAgICAgICAgICAgICAvLyBpc0NvbnRpbnVlID0gdHJ1ZSDml7bmiY3kvJrmuLLmn5PmlbDmja5cbiAgICAgICAgICAgICAgICAvLyBpc0NvbnRpbnVlID0gdHJ1ZVxuICAgICAgICAgICAgICAgIC8vIGNvbnRyb2xsZXIuYWJvcnQoKTtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICAgICAgICAgICAgICAgIGxldCBtZXNzYWdlcyA9IG1zZy5tZXNzYWdlcztcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtZXNzYWdlcyk7XG4gICAgICAgICAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PSDkuIvpnaLnmoTku6PnoIHnlKjkuo7osIPor5Xkvb/nlKjvvIzmraPlvI/njq/looPpnIDopoHms6jph4rmjolcbiAgICAgICAgICAgICAgICAvLyBwb3J0LnBvc3RNZXNzYWdlKHsgJ3R5cGUnOiAnc2VuZEdQVERhdGEnLCAnc3RhdHVzJzogJ2Vycm8nLCAnY29udGVudCc6ICfwn6WyIEFQSSBLZXkgZXJyb3IuIFBsZWFzZSBtb2RpZnkgYW5kIHRyeSBhZ2Fpbi4uJyB9KVxuICAgICAgICAgICAgICAgIC8vIHBvcnQucG9zdE1lc3NhZ2UoeyAndHlwZSc6ICdzZW5kR1BURGF0YScsICdzdGF0dXMnOiAnZXJybycsICdjb250ZW50JzogJ/CfpbIgRW5jb3VudGVyZWQgc29tZSBpc3N1ZXMsIHBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuJyB9KVxuICAgICAgICAgICAgICAgIC8vIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAvLyAgIHBvcnQucG9zdE1lc3NhZ2UoeyAndHlwZSc6ICdzZW5kR1BURGF0YScsICdzdGF0dXMnOiAnYmVnaW4nLCAnY29udGVudCc6ICcnIH0pXG4gICAgICAgICAgICAgICAgLy8gICBwb3J0LnBvc3RNZXNzYWdlKHsgJ3R5cGUnOiAnc2VuZEdQVERhdGEnLCAnc3RhdHVzJzogJ3Byb2Nlc3MnLCAnY29udGVudCc6IGAke25vd31gIH0pXG4gICAgICAgICAgICAgICAgLy8gICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAvLyAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyMDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgcG9ydC5wb3N0TWVzc2FnZSh7ICd0eXBlJzogJ3NlbmRHUFREYXRhJywgJ3N0YXR1cyc6ICdwcm9jZXNzJywgJ2NvbnRlbnQnOiBcIldcIiB9KVxuICAgICAgICAgICAgICAgIC8vICAgICAgIC8vIGlmICghaXNDb250aW51ZSkge1xuICAgICAgICAgICAgICAgIC8vICAgICAgIC8vICAgY29uc29sZS5sb2coJ+WBnOatoua4suafk+aVsOaNricpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgLy8gICBicmVha1xuICAgICAgICAgICAgICAgIC8vICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgICAvLyAgICAgfVxuICAgICAgICAgICAgICAgIC8vICAgICBwb3J0LnBvc3RNZXNzYWdlKHsgJ3R5cGUnOiAnc2VuZEdQVERhdGEnLCAnc3RhdHVzJzogJ3Byb2Nlc3MnLCAnY29udGVudCc6IG1lc3NhZ2VzW21lc3NhZ2VzLmxlbmd0aCAtIDFdLmNvbnRlbnQgfSlcbiAgICAgICAgICAgICAgICAvLyAgICAgcG9ydC5wb3N0TWVzc2FnZSh7ICd0eXBlJzogJ3NlbmRHUFREYXRhJywgJ3N0YXR1cyc6ICdlbmQnLCAnY29udGVudCc6IFwiXCIgfSlcbiAgICAgICAgICAgICAgICAvLyAgIH0sIDEwMDApO1xuICAgICAgICAgICAgICAgIC8vIH0sIDE0MDApO1xuICAgICAgICAgICAgICAgIC8vIHJldHVyblxuICAgICAgICAgICAgICAgIC8vID09PT09PT09PT09PT09PT09PT09XG4gICAgICAgICAgICAgICAgaWYgKG9wZW5BcGlLZXkubGVuZ3RoIDwgNSAmJiBsaWNlbnNlS2V5Lmxlbmd0aCA8IDUpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9ydC5wb3N0TWVzc2FnZSh7ICd0eXBlJzogJ3NlbmRHUFREYXRhJywgJ3N0YXR1cyc6ICdlcnJvJywgJ2NvZGUnOiAnaW52YWxpZF9hcGlfa2V5JywgJ2NvbnRlbnQnOiAn8J+lsiBBUEkgS2V5IGVycm9yLiBQbGVhc2UgbW9kaWZ5IGFuZCB0cnkgYWdhaW4uLicgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG9wZW5BcGlFbmRwb2ludC5sZW5ndGggPCA1KSB7XG4gICAgICAgICAgICAgICAgICAgIG9wZW5BcGlFbmRwb2ludCA9IGRlZmF1bHRPcGVuQXBpRW5kcG9pbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxldCBoZWFkZXJzID0ge307XG4gICAgICAgICAgICAgICAgbGV0IGJvZHk7XG4gICAgICAgICAgICAgICAgLy8g5LyY5YWI5L2/55So6Ieq5bex55qEIEtleVxuICAgICAgICAgICAgICAgIGlmIChhcGlLZXlTZWxlY3Rpb24gPT09ICdsaWNlbnNlS2V5Jykge1xuICAgICAgICAgICAgICAgICAgICAvLyDkvb/nlKjorrjlj6/or4FcbiAgICAgICAgICAgICAgICAgICAgb3BlbkFwaUVuZHBvaW50ID0gJ2h0dHBzOi8vb3BlbnJvdXRlci5haS9hcGkvdjEvY2hhdC9jb21wbGV0aW9ucyc7XG4gICAgICAgICAgICAgICAgICAgIG9wZW5BcGlLZXkgPSBsaWNlbnNlS2V5O1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiAnQmVhcmVyICcgKyBvcGVuQXBpS2V5LFxuICAgICAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdIVFRQLVJlZmVyZXInOiAnaHR0cHM6Ly9ub3Rlcy5kYWJpbmcub25lLycsXG4gICAgICAgICAgICAgICAgICAgICAgICAnWC1UaXRsZSc6ICdTY291dGVyJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBib2R5ID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJtb2RlbFwiOiBtb2RlbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWVzc2FnZXNcIjogbWVzc2FnZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRlbXBlcmF0dXJlXCI6IDAuNyxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWF4X3Rva2Vuc1wiOiA0MjAsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRvcF9wXCI6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImZyZXF1ZW5jeV9wZW5hbHR5XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByZXNlbmNlX3BlbmFsdHlcIjogMixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3RyZWFtXCI6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyDkvb/nlKjnlKjmiLfoh6rlt7HnmoQgS2V5XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcGVuQXBpRW5kcG9pbnQuaW5kZXhPZignYXp1cmUuY29tJykgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXp1cmVcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnMgPSB7ICdhcGkta2V5Jzogb3BlbkFwaUtleSwgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvZHkgPSBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtb2RlbFwiOiBcImdwdC0zNS10dXJib1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibWVzc2FnZXNcIjogbWVzc2FnZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0ZW1wZXJhdHVyZVwiOiAwLjcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtYXhfdG9rZW5zXCI6IDQyMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRvcF9wXCI6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJmcmVxdWVuY3lfcGVuYWx0eVwiOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJlc2VuY2VfcGVuYWx0eVwiOiAyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RyZWFtXCI6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT3BlbkFJXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzID0geyAnQXV0aG9yaXphdGlvbic6ICdCZWFyZXIgJyArIG9wZW5BcGlLZXksICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDljrvpmaTnq6/ngrnmnKvlsL7nmoQgXFwg56ym5Y+3XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob3BlbkFwaUVuZHBvaW50LnNsaWNlKC0xKSA9PT0gXCIvXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVuQXBpRW5kcG9pbnQgPSBvcGVuQXBpRW5kcG9pbnQuc2xpY2UoMCwgLTEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb3BlbkFwaUVuZHBvaW50ICs9ICcvdjEvY2hhdC9jb21wbGV0aW9ucyc7XG4gICAgICAgICAgICAgICAgICAgICAgICBib2R5ID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibW9kZWxcIjogXCJncHQtMy41LXR1cmJvXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlc1wiOiBtZXNzYWdlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRlbXBlcmF0dXJlXCI6IDAuNyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1heF90b2tlbnNcIjogNDIwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidG9wX3BcIjogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImZyZXF1ZW5jeV9wZW5hbHR5XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcmVzZW5jZV9wZW5hbHR5XCI6IDIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdHJlYW1cIjogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZmV0Y2gob3BlbkFwaUVuZHBvaW50LCB7XG4gICAgICAgICAgICAgICAgICAgIHNpZ25hbDogY29udHJvbGxlci5zaWduYWwsXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICAgICAgICAgIGJvZHk6IGJvZHksXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnNcbiAgICAgICAgICAgICAgICB9KS50aGVuKChyZXNwb25zZSkgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgICAgICAgICAgcG9ydC5wb3N0TWVzc2FnZSh7ICd0eXBlJzogJ3NlbmRHUFREYXRhJywgJ3N0YXR1cyc6ICdiZWdpbicsICdjb250ZW50JzogJycgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgIT09IDIwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQVBJIEtFWSBFcnJvclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UuanNvbigpLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3J0LnBvc3RNZXNzYWdlKHsgJ3R5cGUnOiAnc2VuZEdQVERhdGEnLCAnc3RhdHVzJzogJ2Vycm8nLCAnY29udGVudCc6ICfwn6WyICcgKyBkYXRhLmVycm9yLm1lc3NhZ2UsICdjb2RlJzogZGF0YS5lcnJvci5jb2RlIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIOWkhOeQhiBzZXJ2ZXItc2VudCBldmVudHNcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyc2VyID0gKDAsIGV2ZW50c291cmNlX3BhcnNlcl8xLmNyZWF0ZVBhcnNlcikoKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQudHlwZSA9PT0gJ2V2ZW50Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdjcmVhdGVQYXJzZXI6Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LmRhdGEgIT09ICdbRE9ORV0nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV3X21zZyA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSlbJ2Nob2ljZXMnXVswXVsnZGVsdGEnXVsnY29udGVudCddO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5ld19tc2cgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04ucGFyc2UoZXZlbnQuZGF0YSkuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWwhuaVsOaNruWPkemAgee7mSBVSSDku6XmuLLmn5PlhoXlrrlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3J0LnBvc3RNZXNzYWdlKHsgJ3R5cGUnOiAnc2VuZEdQVERhdGEnLCAnc3RhdHVzJzogJ3Byb2Nlc3MnLCAnY29udGVudCc6IEpTT04ucGFyc2UoZXZlbnQuZGF0YSlbJ2Nob2ljZXMnXVswXVsnZGVsdGEnXVsnY29udGVudCddLCAnY2hhdElkJzogSlNPTi5wYXJzZShldmVudC5kYXRhKS5pZCB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJyBjcmVhdGVQYXJzZXIgSlNPTi5wYXJzZSBlcnJvdycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlYWRlciA9IChfYSA9IHJlc3BvbnNlLmJvZHkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5nZXRSZWFkZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlYWRlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zdGFudC1jb25kaXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSB5aWVsZCByZWFkZXIucmVhZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zdCB7IGRvbmU6Ym9vbGVhbiwgdmFsdWU6dWludDhBcnJheSB9ID0gYXdhaXQgUHJvbWlzZS5yYWNlKFtyZWFkZXIucmVhZCgpLCBjYW5jZWxQcm9taXNlXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb25lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmlbDmja7kvKDovpPnu5PmnZ9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdEb25lJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3J0LnBvc3RNZXNzYWdlKHsgJ3R5cGUnOiAnc2VuZEdQVERhdGEnLCAnc3RhdHVzJzogJ2VuZCcsICdjb250ZW50JzogJycgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiAoIWlzQ29udGludWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICBjb25zb2xlLmxvZygn5YGc5q2i5riy5p+T5pWw5o2uJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICBicmVha1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0ciA9IG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlci5mZWVkKHN0cik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZGVyLnJlbGVhc2VMb2NrKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJzZXIucmVzZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pKS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yJyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVycm9yLm1lc3NhZ2UuaW5kZXhPZignYWJvcnRlZCcpID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOW8gOWQr+aWsOeahOivt+axgu+8jOS4reaWreaXp+ivt+axglxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGlwcyA9IGVycm9yLm1lc3NhZ2UuaW5kZXhPZignRmFpbGVkIHRvIGZldGNoJykgPj0gMCA/ICfwn6WyQW4gZXJyb3Igb2NjdXJyZWQuIEl0IG1pZ2h0IGJlIGFuICoqQVBJIGVuZHBvaW50IGVycm9yKionICsgJygnICsgb3BlbkFwaUVuZHBvaW50ICsgJyknICsgJy4gUGxlYXNlIG1vZGlmeSBhbmQgdHJ5IGFnYWluLicgOiAn8J+lskFuIGVycm9yIG9jY3VycmVkLic7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb3J0LnBvc3RNZXNzYWdlKHsgJ3R5cGUnOiAnc2VuZEdQVERhdGEnLCAnc3RhdHVzJzogJ2Vycm8nLCAnY29udGVudCc6IHRpcHMgKyAnKCcgKyBlcnJvci5tZXNzYWdlICsgJyknLCAnY29kZSc6IGVycm9yLm1lc3NhZ2UgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gcG9ydC5wb3N0TWVzc2FnZSh7ICd0eXBlJzogJ3NlbmRHUFREYXRhJywgJ3N0YXR1cyc6ICdlcnJvJywgJ2NvbnRlbnQnOiBcIvCfpbIgRW5jb3VudGVyZWQgc29tZSBpc3N1ZXMsIHBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuXCIgfSlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIOiOt+WPliBVbnNwbGFzaCDlm77niYdcbiAgICAgICAgICAgIGlmIChtc2cudHlwZSA9PT0gJ2dldFVuc3BsYXNoSW1hZ2VzJykge1xuICAgICAgICAgICAgICAgIC8vIOiOt+WPluWbvueJh1xuICAgICAgICAgICAgICAgIGlmIChtc2cua2V5V29yZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBwb3J0LnBvc3RNZXNzYWdlKHsgJ3R5cGUnOiAnc2VuZEltZ0RhdGEnLCAnc3RhdHVzJzogJ2VuZCcsICdpbWdzJzogaW1ncyB9KVxuICAgICAgICAgICAgICAgICAgICAoMCwgdXRpbF8xLnVuc3BsYXNoU2VhcmNoUGhvdG9zKShwcm9jZXNzLmVudi5VTlNQTEFTSF9BUElfS0VZLCBtc2cua2V5V29yZCkudGhlbigoaW1ncykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coaW1ncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb3J0LnBvc3RNZXNzYWdlKHsgJ3R5cGUnOiAnc2VuZEltZ0RhdGEnLCAnc3RhdHVzJzogJ2VuZCcsICdpbWdzJzogaW1ncyB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIOWBnOatoua4suafk+aVsOaNrlxuICAgICAgICAgICAgaWYgKG1zZy50eXBlID09PSAnU3RvcFRoZUNvbnZlcnNhdGlvbicpIHtcbiAgICAgICAgICAgICAgICAvLyBpc0NvbnRpbnVlID0gZmFsc2VcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLmFib3J0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pKTtcbn0pO1xud2ViZXh0ZW5zaW9uX3BvbHlmaWxsXzEuZGVmYXVsdC5ydW50aW1lLm9uTWVzc2FnZS5hZGRMaXN0ZW5lcihoYW5kbGVNZXNzYWdlKTtcbmZ1bmN0aW9uIGhhbmRsZU1lc3NhZ2UocmVxdWVzdCwgc2VuZGVyLCBzZW5kUmVzcG9uc2UpIHtcbiAgICBjb25zb2xlLmxvZyhcIk1lc3NhZ2UgZnJvbSB0aGUgY29udGVudCBzY3JpcHQ6IFwiICtcbiAgICAgICAgcmVxdWVzdC50eXBlKTtcbiAgICAvLyBEZWZpbmUgc2VuZFJlc3BvbnNlIGFzIGFuIGFzeW5jIGZ1bmN0aW9uXG4gICAgY29uc3QgYXN5bmNTZW5kUmVzcG9uc2UgPSAocmVzcG9uc2UpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHlpZWxkIHNlbmRSZXNwb25zZShyZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGlmIChyZXF1ZXN0LnR5cGUgPT09ICdhZGROb3RlJykge1xuICAgICAgICBjb25zb2xlLmxvZygnYWRkTm90ZScpO1xuICAgICAgICAvLyBVbnNwbGFzaFxuICAgICAgICBjb25zdCB1bnNwbGFzaCA9ICgwLCB1bnNwbGFzaF9qc18xLmNyZWF0ZUFwaSkoe1xuICAgICAgICAgICAgYWNjZXNzS2V5OiBwcm9jZXNzLmVudi5VTlNQTEFTSF9BUElfS0VZXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zb2xlLmxvZygndW5zcGxhc2gucGhvdG9zLnRyYWNrRG93bmxvYWQnKTtcbiAgICAgICAgaWYgKHJlcXVlc3QubWVzc2FnZXMudW5zcGxhc2hfZG93bmxvYWRfbG9jYXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdW5zcGxhc2gucGhvdG9zLnRyYWNrRG93bmxvYWQoeyBkb3dubG9hZExvY2F0aW9uOiByZXF1ZXN0Lm1lc3NhZ2VzLnVuc3BsYXNoX2Rvd25sb2FkX2xvY2F0aW9uLCB9KS50aGVuKChyZXN1bHQpID0+IGNvbnNvbGUubG9nKHJlc3VsdCkpO1xuICAgICAgICB9XG4gICAgICAgICgwLCB1dGlsXzEuYW5raUFjdGlvbikocmVxdWVzdC5tZXNzYWdlcy5hbmtpX2FjdGlvbl90eXBlLCA2LCByZXF1ZXN0Lm1lc3NhZ2VzLmFua2lfYXJndW1lbnRzKS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBnb3QgbGlzdCBvZiBkZWNrczogJHtyZXN1bHR9YCk7XG4gICAgICAgICAgICAvLyDlj43ppojlpITnkIbnu5PmnpxcbiAgICAgICAgICAgIGFzeW5jU2VuZFJlc3BvbnNlKHsgdHlwZTogJ2FkZFRvQW5raScsIHJlc3VsdDogJ3N1Y2Nlc3MnLCBkYXRhOiByZXN1bHQucmVzdWx0LCBlcnJvcjogcmVzdWx0LmVycm9yIH0pO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgICAgICBhc3luY1NlbmRSZXNwb25zZSh7IHR5cGU6ICdhZGRUb0Fua2knLCByZXN1bHQ6ICdmYWlsdXJlJywgZXJyb3I6IGVycm9yLmVycm9yIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgLy8gUmV0dXJuIHRydWUgdG8gaW5mb3JtIHNlbmRSZXNwb25zZSB0aGF0IHlvdSB3aWxsIGJlIGNhbGxpbmcgaXQgYXN5bmNocm9ub3VzbHlcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIC8vIOiOt+WPlueUqOaIt+iuvue9rueahOeJjOe7hOWSjOaooeadv1xuICAgIGlmIChyZXF1ZXN0LnR5cGUgPT09ICdzZXRNb2RlbCcpIHtcbiAgICAgICAgY29uc3QgaXNBbmtpU3BhY2UgPSByZXF1ZXN0Lm1lc3NhZ2VzLmlzQW5raVNwYWNlO1xuICAgICAgICAvLyDojrflj5YgRGVja05hbWVcbiAgICAgICAgKDAsIHV0aWxfMS5nZXREZWZhdWx0RGVja05hbWUpKCkudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICBsZXQgZGVmYXVsdERlY2tOYW1lID0gcmVzdWx0LmRlZmF1bHREZWNrTmFtZTtcbiAgICAgICAgICAgIGlmIChkZWZhdWx0RGVja05hbWUgPT09ICcnIHx8IGRlZmF1bHREZWNrTmFtZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgZGVmYXVsdERlY2tOYW1lID0gJ0RlZmF1bHQnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8g6I635Y+W5omA5pyJIE1vZGVsXG4gICAgICAgICAgICAoMCwgdXRpbF8xLmFua2lBY3Rpb24pKCdtb2RlbE5hbWVzJywgNikudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0LnJlc3VsdCk7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGRlZmF1bHRNb2RlbE5hbWUgPSAnU2NvdXRlcic7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjYXJkVGVtcGxhdGVzID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICduYW1lJzogJ0NhcmQxJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnRnJvbnQnOiAne3tGcm9udH19JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQmFjayc6IGB7e0Zyb250fX1cbiAgICAgICAgICAgICAgPGhyIGlkPWFuc3dlcj5cbiAgICAgICAgICAgICAge3tCYWNrfX1gXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgICAgIGxldCBpbk9yZGVyRmllbGRzID0gW1wiRnJvbnRcIiwgXCJCYWNrXCJdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNBbmtpU3BhY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFua2kg5a6M5b2i5aGr56m6XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0TW9kZWxOYW1lID0gJ1Njb3V0ZXIgQ2xvemUgVGV4dCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXJkVGVtcGxhdGVzID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ25hbWUnOiAnQ2FyZDInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnRnJvbnQnOiAne3tjbG96ZTpUZXh0fX0nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQmFjayc6IGB7e2Nsb3plOlRleHR9fVxuICAgICAgICAgICAgICAgICAgICAgICAgPGJyPnt7TW9yZX19YFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpbk9yZGVyRmllbGRzID0gW1wiVGV4dFwiLCBcIk1vcmVcIl07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5yZXN1bHQuaW5jbHVkZXMoZGVmYXVsdE1vZGVsTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWmguaenOaciSBTY291dGVyIE1vZGVsIOWImeiOt+WPliBNb2RlbCDnmoTlrZfmrrVcbiAgICAgICAgICAgICAgICAgICAgICAgICgwLCB1dGlsXzEuYW5raUFjdGlvbikoJ21vZGVsRmllbGROYW1lcycsIDYsIHsgJ21vZGVsTmFtZSc6IGRlZmF1bHRNb2RlbE5hbWUgfSkudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5yZXN1bHQubGVuZ3RoIDwgMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlrZfmrrXlsJHkuo4gMiDkuKrml7bml6Dms5Xmt7vliqDnrJTorrDvvIzlvJXlr7znlKjmiLfkv67mlLlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXN5bmNTZW5kUmVzcG9uc2UoeyB0eXBlOiAnc2V0TW9kZWwnLCByZXN1bHQ6ICdmYWlsdXJlJywgZGF0YToge30sIGVycm9yOiAnVGhlIFNjb3V0ZXIgbW9kZWwgaW4gQW5raSBuZWVkcyB0byBpbmNsdWRlIGF0IGxlYXN0IDIgZmllbGRzLiBQbGVhc2UgbW9kaWZ5IGFuZCB0cnkgYWdhaW4uJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWPjemmiOWkhOeQhue7k+aenFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3luY1NlbmRSZXNwb25zZSh7IHR5cGU6ICdzZXRNb2RlbCcsIHJlc3VsdDogJ3N1Y2Nlc3MnLCBkYXRhOiB7ICdkZWZhdWx0RGVja05hbWUnOiBkZWZhdWx0RGVja05hbWUsICdtb2RlbE5hbWUnOiBkZWZhdWx0TW9kZWxOYW1lLCAnZmllbGQxJzogcmVzdWx0LnJlc3VsdFswXSwgJ2ZpZWxkMic6IHJlc3VsdC5yZXN1bHRbMV0gfSwgZXJyb3I6IHJlc3VsdC5lcnJvciB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWmguaenOayoeaciSBTY291dGVyIOm7mOiupOeahCBNb2RlbO+8jOWImeWIm+W7ulxuICAgICAgICAgICAgICAgICAgICAgICAgKDAsIHV0aWxfMS5hbmtpQWN0aW9uKSgnY3JlYXRlTW9kZWwnLCA2LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ21vZGVsTmFtZSc6IGRlZmF1bHRNb2RlbE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2luT3JkZXJGaWVsZHMnOiBpbk9yZGVyRmllbGRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjYXJkVGVtcGxhdGVzJzogY2FyZFRlbXBsYXRlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaXNDbG96ZSc6IGlzQW5raVNwYWNlXG4gICAgICAgICAgICAgICAgICAgICAgICB9KS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdC5lcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlj43ppojlpITnkIbnu5PmnpxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXN5bmNTZW5kUmVzcG9uc2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3NldE1vZGVsJywgcmVzdWx0OiAnc3VjY2VzcycsIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGVmYXVsdERlY2tOYW1lJzogZGVmYXVsdERlY2tOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtb2RlbE5hbWUnOiBkZWZhdWx0TW9kZWxOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdmaWVsZDEnOiByZXN1bHQucmVzdWx0LmZsZHNbMF0ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZmllbGQyJzogcmVzdWx0LnJlc3VsdC5mbGRzWzFdLm5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGVycm9yOiByZXN1bHQuZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgICAgICBhc3luY1NlbmRSZXNwb25zZSh7IHR5cGU6ICdzZXRNb2RlbCcsIHJlc3VsdDogJ2ZhaWx1cmUnLCBlcnJvcjogZXJyb3IuZXJyb3IgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHdlYmV4dGVuc2lvbl9wb2x5ZmlsbF8xLmRlZmF1bHQuc3RvcmFnZS5zeW5jLmdldCh7ICdhbmtpRGVja05hbWUnOiAnRGVmYXVsdCcgfSkudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKHJlcXVlc3QudHlwZSA9PT0gJ2d1aUVkaXROb3RlJykge1xuICAgICAgICAoMCwgdXRpbF8xLmFua2lBY3Rpb24pKHJlcXVlc3QubWVzc2FnZXMuYW5raV9hY3Rpb25fdHlwZSwgNiwgcmVxdWVzdC5tZXNzYWdlcy5hbmtpX2FyZ3VtZW50cykudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgZ290IGxpc3Qgb2YgZGVja3M6ICR7cmVzdWx0fWApO1xuICAgICAgICAgICAgLy8g5Y+N6aaI5aSE55CG57uT5p6cXG4gICAgICAgICAgICBhc3luY1NlbmRSZXNwb25zZSh7IHR5cGU6ICdndWlFZGl0Tm90ZScsIHJlc3VsdDogJ3N1Y2Nlc3MnLCBkYXRhOiByZXN1bHQucmVzdWx0LCBlcnJvcjogcmVzdWx0LmVycm9yIH0pO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgICAgICBhc3luY1NlbmRSZXNwb25zZSh7IHR5cGU6ICdndWlFZGl0Tm90ZScsIHJlc3VsdDogJ2ZhaWx1cmUnLCBlcnJvcjogZXJyb3IuZXJyb3IgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBSZXR1cm4gdHJ1ZSB0byBpbmZvcm0gc2VuZFJlc3BvbnNlIHRoYXQgeW91IHdpbGwgYmUgY2FsbGluZyBpdCBhc3luY2hyb25vdXNseVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKHJlcXVlc3QudHlwZSA9PT0gJ2Fua2lBY3Rpb24nKSB7XG4gICAgICAgICgwLCB1dGlsXzEuYW5raUFjdGlvbikocmVxdWVzdC5tZXNzYWdlcy5hbmtpX2FjdGlvbl90eXBlLCA2LCByZXF1ZXN0Lm1lc3NhZ2VzLmFua2lfYXJndW1lbnRzKS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgIC8vIOWPjemmiOWkhOeQhue7k+aenFxuICAgICAgICAgICAgYXN5bmNTZW5kUmVzcG9uc2UocmVzdWx0KTtcbiAgICAgICAgfSkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBhc3luY1NlbmRSZXNwb25zZShlcnJvcik7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG59XG5jb25zdCBzZW5kTWVzc2FnZVRvQ29udGVudCA9IChydW5Qcm9tcHQpID0+IHtcbiAgICBjb25zb2xlLmxvZygnc2VuZE1lc3NhZ2VUb0NvbnRlbnQ6Jyk7XG4gICAgbGV0IG5lZWRUb1J1blByb21wdCA9IHJ1blByb21wdDtcbiAgICBpZiAobmVlZFRvUnVuUHJvbXB0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgbmVlZFRvUnVuUHJvbXB0ID0gdHJ1ZTtcbiAgICB9XG4gICAgd2ViZXh0ZW5zaW9uX3BvbHlmaWxsXzEuZGVmYXVsdC50YWJzLnF1ZXJ5KHsgYWN0aXZlOiB0cnVlLCBjdXJyZW50V2luZG93OiB0cnVlIH0pLnRoZW4oKHRhYnMpID0+IHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICBjb25zb2xlLmxvZyh0YWJzKTtcbiAgICAgICAgY29uc3QgYWN0aXZlVGFiID0gdGFic1swXTtcbiAgICAgICAgbGV0IHRJRCA9IChfYSA9IGFjdGl2ZVRhYi5pZCkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogLTE7XG4gICAgICAgIGlmIChhY3RpdmVUYWIgJiYgYWN0aXZlVGFiLmlkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGxldCBiID0gd2ViZXh0ZW5zaW9uX3BvbHlmaWxsXzEuZGVmYXVsdC50YWJzLnNlbmRNZXNzYWdlKHRJRCwgeyB0eXBlOiAnb3Blbi1zY291dGVyJywgcnVuUHJvbXB0OiBuZWVkVG9SdW5Qcm9tcHQgfSk7XG4gICAgICAgICAgICAvLyDlt7Lnn6Xmg4XlhrXvvJrliJrlronoo4Xmj5Lku7bml7bnm7TmjqXkvb/nlKjkvJrmiqXplJnvvIjliLfmlrDpobXpnaLlkI7kvb/nlKjliJnmraPluLjvvInvvIzmraTml7bpnIDopoHovb3lhaUgY29udGVudF9zY3JpcHQuanMg5omN6KGMXG4gICAgICAgICAgICAvLyBiLmNhdGNoKGUgPT4ge1xuICAgICAgICAgICAgLy8gICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgICAgIC8vICAgY29uc29sZS5sb2coJ2NhdGNoJyk7XG4gICAgICAgICAgICAvLyAgIGJyb3dzZXIuc2NyaXB0aW5nLmV4ZWN1dGVTY3JpcHQoe1xuICAgICAgICAgICAgLy8gICAgIHRhcmdldDogeyB0YWJJZDogdElEIH0sXG4gICAgICAgICAgICAvLyAgICAgZmlsZXM6IFtcImpzL3ZlbmRvci5qc1wiLCBcImpzL2NvbnRlbnRfc2NyaXB0LmpzXCJdLFxuICAgICAgICAgICAgLy8gICB9KS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIC8vICAgICBjb25zb2xlLmxvZygnY2hyb21lLnNjcmlwdGluZy5leGVjdXRlU2NyaXB0Jyk7XG4gICAgICAgICAgICAvLyAgIH0pLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgLy8gICAgIGJyb3dzZXIudGFicy5zZW5kTWVzc2FnZSh0SUQsIHsgdHlwZTogJ29wZW4tc2NvdXRlcicgfSlcbiAgICAgICAgICAgIC8vICAgfSlcbiAgICAgICAgICAgIC8vIH0pXG4gICAgICAgIH1cbiAgICB9KTtcbn07XG4iLCJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2NyZWF0ZUJpbmRpbmcgPSAodGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZykgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcbiAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgZGVzYyA9IHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICBvW2syXSA9IG1ba107XG59KSk7XG52YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHYgfSk7XG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG59KTtcbnZhciBfX2ltcG9ydFN0YXIgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhcikgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xuICAgIHJldHVybiByZXN1bHQ7XG59O1xudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLmdldFVzZXJJZCA9IGV4cG9ydHMuZ2V0QmFsYW5jZSA9IGV4cG9ydHMucGxheVRleHRUb1NwZWVjaCA9IGV4cG9ydHMuZ2V0RGVmYXVsdERlY2tOYW1lID0gZXhwb3J0cy51bnNwbGFzaFNlYXJjaFBob3RvcyA9IGV4cG9ydHMuYW5raUFjdGlvbiA9IHZvaWQgMDtcbmNvbnN0IHdlYmV4dGVuc2lvbl9wb2x5ZmlsbF8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCJ3ZWJleHRlbnNpb24tcG9seWZpbGxcIikpO1xuY29uc3QgdW5zcGxhc2hfanNfMSA9IHJlcXVpcmUoXCJ1bnNwbGFzaC1qc1wiKTtcbmNvbnN0IHNkayA9IF9faW1wb3J0U3RhcihyZXF1aXJlKFwibWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGtcIikpO1xuY29uc3QgdXVpZF8xID0gcmVxdWlyZShcInV1aWRcIik7XG4vLyDlsIbkv6Hmga/mt7vliqDliLAgQW5raVxuZnVuY3Rpb24gYW5raUFjdGlvbihhY3Rpb24sIHZlcnNpb24sIHBhcmFtcyA9IHt9KSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgZmV0Y2goJ2h0dHA6Ly8xMjcuMC4wLjE6ODc2NScsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IFwiYWN0aW9uXCI6IGFjdGlvbiwgXCJ2ZXJzaW9uXCI6IHZlcnNpb24sIFwicGFyYW1zXCI6IHBhcmFtcyB9KVxuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSkudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICByZXNvbHZlKGRhdGEpO1xuICAgICAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIHJlamVjdCh7ICdyZXN1bHQnOiBbXSwgJ2Vycm9yJzogJ1BsZWFzZSBvcGVuIHRoZSBBbmtpIGNsaWVudCBhbmQgaW5zdGFsbCB0aGUgQW5raS1Db25uZWN0IHBsdWdpbiBiZWZvcmUgdHJ5aW5nIGFnYWluLicgfSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuZXhwb3J0cy5hbmtpQWN0aW9uID0gYW5raUFjdGlvbjtcbi8vIOWcqCB1bnNwbGFzaCDkuK3mkJzntKLnhafniYdcbmZ1bmN0aW9uIHVuc3BsYXNoU2VhcmNoUGhvdG9zKEFQSV9LRVksIHF1ZXJ5KSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgY29uc3QgdW5zcGxhc2ggPSAoMCwgdW5zcGxhc2hfanNfMS5jcmVhdGVBcGkpKHtcbiAgICAgICAgICAgIGFjY2Vzc0tleTogQVBJX0tFWSxcbiAgICAgICAgfSk7XG4gICAgICAgIHVuc3BsYXNoLnNlYXJjaC5nZXRQaG90b3Moe1xuICAgICAgICAgICAgcXVlcnk6IHF1ZXJ5LFxuICAgICAgICB9KS50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgICAgICBpZiAoKChfYSA9IGRhdGEucmVzcG9uc2UpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5yZXN1bHRzLmxlbmd0aCkgPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKFtdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoKF9iID0gZGF0YS5yZXNwb25zZSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnJlc3VsdHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuZXhwb3J0cy51bnNwbGFzaFNlYXJjaFBob3RvcyA9IHVuc3BsYXNoU2VhcmNoUGhvdG9zO1xuLy8g6I635Y+WIEFua2kg55qEIERlY2sg5ZCN56ew77yM5re75Yqg5Yiw5Y2h54mH5Lya5a2Y5pS+5Yiw6L+Z6YeMXG5mdW5jdGlvbiBnZXREZWZhdWx0RGVja05hbWUoKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgbGV0IGRlZmF1bHREZWNrTmFtZSA9ICcnO1xuICAgICAgICAvLyDojrflj5bnlKjmiLforr7nva7nmoQgRGVjayBOYW1lXG4gICAgICAgIHdlYmV4dGVuc2lvbl9wb2x5ZmlsbF8xLmRlZmF1bHQuc3RvcmFnZS5zeW5jLmdldChbXCJhbmtpRGVja05hbWVcIl0pLnRoZW4oKHJlc3VsdCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3Jlc3VsdDonKTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlc3VsdCk7XG4gICAgICAgICAgICBpZiAocmVzdWx0LmFua2lEZWNrTmFtZSkge1xuICAgICAgICAgICAgICAgIC8vIOeUqOaIt+acieiuvue9rlxuICAgICAgICAgICAgICAgIGRlZmF1bHREZWNrTmFtZSA9IHJlc3VsdC5hbmtpRGVja05hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyDnlKjmiLfmnKrorr7nva5cbiAgICAgICAgICAgICAgICAvLyDojrflj5YgQW5raSDnmoTniYznu4TliJfooahcbiAgICAgICAgICAgICAgICBkZWZhdWx0RGVja05hbWUgPSB5aWVsZCBhbmtpQWN0aW9uKCdkZWNrTmFtZXMnLCA2KS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8g5bCG56ys5LiA5Liq54mM57uE5L2c5Li66buY6K6k54mM57uEXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQucmVzdWx0WzBdO1xuICAgICAgICAgICAgICAgIH0pLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc29sdmUoeyAnZGVmYXVsdERlY2tOYW1lJzogZGVmYXVsdERlY2tOYW1lIH0pO1xuICAgICAgICB9KSk7XG4gICAgfSk7XG59XG5leHBvcnRzLmdldERlZmF1bHREZWNrTmFtZSA9IGdldERlZmF1bHREZWNrTmFtZTtcbmNvbnN0IHBsYXlUZXh0VG9TcGVlY2ggPSAodGV4dCwgdm9pY2UpID0+IHtcbiAgICBjb25zdCBhdWRpb0NvbmZpZyA9IHNkay5BdWRpb0NvbmZpZy5mcm9tRGVmYXVsdFNwZWFrZXJPdXRwdXQoKTtcbiAgICBjb25zdCBzcGVlY2hDb25maWcgPSBzZGsuU3BlZWNoQ29uZmlnLmZyb21TdWJzY3JpcHRpb24ocHJvY2Vzcy5lbnYuQVpVUkVfVFRTX0FQSV9LRVksIHByb2Nlc3MuZW52LkFaVVJFX1RUU19TUEVFQ0hfUkVHSU9OKTtcbiAgICBzcGVlY2hDb25maWcuc3BlZWNoU3ludGhlc2lzVm9pY2VOYW1lID0gdm9pY2U7XG4gICAgY29uc3Qgc3ludGhlc2l6ZXIgPSBuZXcgc2RrLlNwZWVjaFN5bnRoZXNpemVyKHNwZWVjaENvbmZpZywgYXVkaW9Db25maWcpO1xuICAgIHN5bnRoZXNpemVyLnNwZWFrVGV4dEFzeW5jKHRleHQsIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgaWYgKHJlc3VsdC5yZWFzb24gPT09IHNkay5SZXN1bHRSZWFzb24uU3ludGhlc2l6aW5nQXVkaW9Db21wbGV0ZWQpIHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdzeW50aGVzaXMgZmluaXNoZWQuJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdTcGVlY2ggc3ludGhlc2lzIGNhbmNlbGVkLCAnICsgcmVzdWx0LmVycm9yRGV0YWlscyArICdcXG5EaWQgeW91IHNldCB0aGUgc3BlZWNoIHJlc291cmNlIGtleSBhbmQgcmVnaW9uIHZhbHVlcz8nKTtcbiAgICAgICAgfVxuICAgICAgICBzeW50aGVzaXplci5jbG9zZSgpO1xuICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgLy8gY29uc29sZS50cmFjZSgnZXJyIC0gJyArIGVycik7XG4gICAgICAgIHN5bnRoZXNpemVyLmNsb3NlKCk7XG4gICAgfSk7XG4gICAgLy8gY29uc29sZS5sb2coJ05vdyBzeW50aGVzaXppbmcuLi4nKTtcbn07XG5leHBvcnRzLnBsYXlUZXh0VG9TcGVlY2ggPSBwbGF5VGV4dFRvU3BlZWNoO1xuY29uc3QgZ2V0QmFsYW5jZSA9IChhcGlLZXkpID0+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBjb25zdCB1cmwgPSAnaHR0cHM6Ly9vcGVucm91dGVyLmFpL2FwaS92MS9hdXRoL2tleSc7XG4gICAgICAgIGNvbnN0IGhlYWRlcnMgPSB7ICdBdXRob3JpemF0aW9uJzogJ0JlYXJlciAnICsgYXBpS2V5LCAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLCB9O1xuICAgICAgICBmZXRjaCh1cmwsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnNcbiAgICAgICAgfSkudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIHJlc3BvbnNlLmpzb24oKS50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn07XG5leHBvcnRzLmdldEJhbGFuY2UgPSBnZXRCYWxhbmNlO1xuY29uc3QgZ2V0VXNlcklkID0gKCkgPT4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGNocm9tZS5zdG9yYWdlLnN5bmMuZ2V0KCd1c2VySWQnLCAocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICBpZiAoY2hyb21lLnJ1bnRpbWUubGFzdEVycm9yKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGNocm9tZS5ydW50aW1lLmxhc3RFcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVzdWx0LnVzZXJJZCkge1xuICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LnVzZXJJZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBsZXQgdW5pcXVlSWQgPSAoMCwgdXVpZF8xLnY0KSgpO1xuICAgICAgICAgICAgICAgIGNocm9tZS5zdG9yYWdlLnN5bmMuc2V0KHsgdXNlcklkOiB1bmlxdWVJZCB9LCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaHJvbWUucnVudGltZS5sYXN0RXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChjaHJvbWUucnVudGltZS5sYXN0RXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh1bmlxdWVJZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG59O1xuZXhwb3J0cy5nZXRVc2VySWQgPSBnZXRVc2VySWQ7XG4iLCJpbXBvcnQgeyBwYXJzZSB9IGZyb20gJ2NvbnRlbnQtdHlwZSc7XG5cbmZ1bmN0aW9uIF9leHRlbmRzKCkge1xuICBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKHRhcmdldCkge1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldO1xuXG4gICAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7XG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7XG4gICAgICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0YXJnZXQ7XG4gIH07XG5cbiAgcmV0dXJuIF9leHRlbmRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKHNvdXJjZSwgZXhjbHVkZWQpIHtcbiAgaWYgKHNvdXJjZSA9PSBudWxsKSByZXR1cm4ge307XG4gIHZhciB0YXJnZXQgPSB7fTtcbiAgdmFyIHNvdXJjZUtleXMgPSBPYmplY3Qua2V5cyhzb3VyY2UpO1xuICB2YXIga2V5LCBpO1xuXG4gIGZvciAoaSA9IDA7IGkgPCBzb3VyY2VLZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAga2V5ID0gc291cmNlS2V5c1tpXTtcbiAgICBpZiAoZXhjbHVkZWQuaW5kZXhPZihrZXkpID49IDApIGNvbnRpbnVlO1xuICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV07XG4gIH1cblxuICByZXR1cm4gdGFyZ2V0O1xufVxuXG52YXIgY2hlY2tJc1N0cmluZyA9IC8qI19fUFVSRV9fKi9nZXRSZWZpbmVtZW50KGZ1bmN0aW9uICh2YWx1ZSkge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IHZhbHVlIDogbnVsbDtcbn0pO1xudmFyIGlzRGVmaW5lZCA9IGZ1bmN0aW9uIGlzRGVmaW5lZCh4KSB7XG4gIHJldHVybiB4ICE9PSBudWxsICYmIHggIT09IHVuZGVmaW5lZDtcbn07XG5mdW5jdGlvbiBnZXRSZWZpbmVtZW50KGdldEIpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7XG4gICAgcmV0dXJuIGlzRGVmaW5lZChnZXRCKGEpKTtcbiAgfTtcbn1cbnZhciBjaGVja0lzTm9uRW1wdHlBcnJheSA9IGZ1bmN0aW9uIGNoZWNrSXNOb25FbXB0eUFycmF5KGEpIHtcbiAgcmV0dXJuIGEubGVuZ3RoID4gMDtcbn07XG5cbi8qKiBUYWtlcyBhIGRpY3Rpb25hcnkgY29udGFpbmluZyBudWxsaXNoIHZhbHVlcyBhbmQgcmV0dXJucyBhIGRpY3Rpb25hcnkgb2YgYWxsIHRoZSBkZWZpbmVkXHJcbiAqIChub24tbnVsbGlzaCkgdmFsdWVzLlxyXG4gKi9cblxudmFyIGNvbXBhY3REZWZpbmVkID0gZnVuY3Rpb24gY29tcGFjdERlZmluZWQob2JqKSB7XG4gIHJldHVybiBPYmplY3Qua2V5cyhvYmopLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBrZXkpIHtcbiAgICB2YXIgX3JlZjtcblxuICAgIHZhciB2YWx1ZSA9IG9ialtrZXldO1xuICAgIHJldHVybiBfZXh0ZW5kcyh7fSwgYWNjLCBpc0RlZmluZWQodmFsdWUpID8gKF9yZWYgPSB7fSwgX3JlZltrZXldID0gdmFsdWUsIF9yZWYpIDoge30pO1xuICB9LCB7fSk7XG59O1xuZnVuY3Rpb24gZmxvdygpIHtcbiAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGZucyA9IG5ldyBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICBmbnNbX2tleV0gPSBhcmd1bWVudHNbX2tleV07XG4gIH1cblxuICB2YXIgbGVuID0gZm5zLmxlbmd0aCAtIDE7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgZm9yICh2YXIgX2xlbjIgPSBhcmd1bWVudHMubGVuZ3RoLCB4ID0gbmV3IEFycmF5KF9sZW4yKSwgX2tleTIgPSAwOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7XG4gICAgICB4W19rZXkyXSA9IGFyZ3VtZW50c1tfa2V5Ml07XG4gICAgfVxuXG4gICAgdmFyIHkgPSBmbnNbMF0uYXBwbHkodGhpcywgeCk7XG5cbiAgICBmb3IgKHZhciBpID0gMTsgaSA8PSBsZW47IGkrKykge1xuICAgICAgeSA9IGZuc1tpXS5jYWxsKHRoaXMsIHkpO1xuICAgIH1cblxuICAgIHJldHVybiB5O1xuICB9O1xufVxuXG52YXIgY2hlY2tJc09iamVjdCA9IC8qI19fUFVSRV9fKi9nZXRSZWZpbmVtZW50KGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICByZXR1cm4gaXNEZWZpbmVkKHJlc3BvbnNlKSAmJiB0eXBlb2YgcmVzcG9uc2UgPT09ICdvYmplY3QnICYmICFBcnJheS5pc0FycmF5KHJlc3BvbnNlKSA/IHJlc3BvbnNlIDogbnVsbDtcbn0pO1xudmFyIGNoZWNrSXNFcnJvcnMgPSAvKiNfX1BVUkVfXyovZ2V0UmVmaW5lbWVudChmdW5jdGlvbiAoZXJyb3JzKSB7XG4gIHJldHVybiBBcnJheS5pc0FycmF5KGVycm9ycykgJiYgZXJyb3JzLmV2ZXJ5KGNoZWNrSXNTdHJpbmcpICYmIGNoZWNrSXNOb25FbXB0eUFycmF5KGVycm9ycykgPyBlcnJvcnMgOiBudWxsO1xufSk7XG52YXIgY2hlY2tJc0FwaUVycm9yID0gLyojX19QVVJFX18qL2dldFJlZmluZW1lbnQoZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gIHJldHVybiBjaGVja0lzT2JqZWN0KHJlc3BvbnNlKSAmJiAnZXJyb3JzJyBpbiByZXNwb25zZSAmJiBjaGVja0lzRXJyb3JzKHJlc3BvbnNlLmVycm9ycykgPyB7XG4gICAgZXJyb3JzOiByZXNwb25zZS5lcnJvcnNcbiAgfSA6IG51bGw7XG59KTtcbnZhciBnZXRFcnJvckZvckJhZFN0YXR1c0NvZGUgPSBmdW5jdGlvbiBnZXRFcnJvckZvckJhZFN0YXR1c0NvZGUoanNvblJlc3BvbnNlKSB7XG4gIGlmIChjaGVja0lzQXBpRXJyb3IoanNvblJlc3BvbnNlKSkge1xuICAgIHJldHVybiB7XG4gICAgICBlcnJvcnM6IGpzb25SZXNwb25zZS5lcnJvcnMsXG4gICAgICBzb3VyY2U6ICdhcGknXG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4ge1xuICAgICAgZXJyb3JzOiBbJ1Jlc3BvbmRlZCB3aXRoIGEgc3RhdHVzIGNvZGUgb3V0c2lkZSB0aGUgMnh4IHJhbmdlLCBhbmQgdGhlIHJlc3BvbnNlIGJvZHkgaXMgbm90IHJlY29nbmlzYWJsZS4nXSxcbiAgICAgIHNvdXJjZTogJ2RlY29kaW5nJ1xuICAgIH07XG4gIH1cbn07XG52YXIgRGVjb2RpbmdFcnJvciA9IGZ1bmN0aW9uIERlY29kaW5nRXJyb3IobWVzc2FnZSkge1xuICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xufTtcblxudmFyIENPTlRFTlRfVFlQRV9SRVNQT05TRV9IRUFERVIgPSAnY29udGVudC10eXBlJztcbnZhciBDT05URU5UX1RZUEVfSlNPTiA9ICdhcHBsaWNhdGlvbi9qc29uJztcblxudmFyIGNoZWNrSXNKc29uUmVzcG9uc2UgPSBmdW5jdGlvbiBjaGVja0lzSnNvblJlc3BvbnNlKHJlc3BvbnNlKSB7XG4gIHZhciBjb250ZW50VHlwZUhlYWRlciA9IHJlc3BvbnNlLmhlYWRlcnMuZ2V0KENPTlRFTlRfVFlQRV9SRVNQT05TRV9IRUFERVIpO1xuICByZXR1cm4gaXNEZWZpbmVkKGNvbnRlbnRUeXBlSGVhZGVyKSAmJiBwYXJzZShjb250ZW50VHlwZUhlYWRlcikudHlwZSA9PT0gQ09OVEVOVF9UWVBFX0pTT047XG59O1xuLyoqXHJcbiAqIE5vdGU6IHJlc3RyaWN0IHRoZSB0eXBlIG9mIEpTT04gdG8gYEFueUpzb25gIHNvIHRoYXQgYGFueWAgZG9lc24ndCBsZWFrIGRvd25zdHJlYW0uXHJcbiAqL1xuXG5cbnZhciBnZXRKc29uUmVzcG9uc2UgPSBmdW5jdGlvbiBnZXRKc29uUmVzcG9uc2UocmVzcG9uc2UpIHtcbiAgaWYgKGNoZWNrSXNKc29uUmVzcG9uc2UocmVzcG9uc2UpKSB7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKVtcImNhdGNoXCJdKGZ1bmN0aW9uIChfZXJyKSB7XG4gICAgICB0aHJvdyBuZXcgRGVjb2RpbmdFcnJvcigndW5hYmxlIHRvIHBhcnNlIEpTT04gcmVzcG9uc2UuJyk7XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IERlY29kaW5nRXJyb3IoJ2V4cGVjdGVkIEpTT04gcmVzcG9uc2UgZnJvbSBzZXJ2ZXIuJyk7XG4gIH1cbn07XG5cbnZhciBoYW5kbGVGZXRjaFJlc3BvbnNlID0gZnVuY3Rpb24gaGFuZGxlRmV0Y2hSZXNwb25zZShoYW5kbGVSZXNwb25zZSkge1xuICByZXR1cm4gZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgcmV0dXJuIChyZXNwb25zZS5vayA/IGhhbmRsZVJlc3BvbnNlKHtcbiAgICAgIHJlc3BvbnNlOiByZXNwb25zZVxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKGhhbmRsZWRSZXNwb25zZSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLFxuICAgICAgICBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgcmVzcG9uc2U6IGhhbmRsZWRSZXNwb25zZSxcbiAgICAgICAgb3JpZ2luYWxSZXNwb25zZTogcmVzcG9uc2VcbiAgICAgIH07XG4gICAgfSkgOiBnZXRKc29uUmVzcG9uc2UocmVzcG9uc2UpLnRoZW4oZnVuY3Rpb24gKGpzb25SZXNwb25zZSkge1xuICAgICAgcmV0dXJuIF9leHRlbmRzKHtcbiAgICAgICAgdHlwZTogJ2Vycm9yJyxcbiAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXNcbiAgICAgIH0sIGdldEVycm9yRm9yQmFkU3RhdHVzQ29kZShqc29uUmVzcG9uc2UpLCB7XG4gICAgICAgIG9yaWdpbmFsUmVzcG9uc2U6IHJlc3BvbnNlXG4gICAgICB9KTtcbiAgICB9KSlbXCJjYXRjaFwiXShmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgIC8qKlxyXG4gICAgICAgKiBXZSB3YW50IHRvIHNlcGFyYXRlIGV4cGVjdGVkIGRlY29kaW5nIGVycm9ycyBmcm9tIHVua25vd24gb25lcy4gV2UgZG8gc28gYnkgdGhyb3dpbmcgYSBjdXN0b21cclxuICAgICAgICogYERlY29kaW5nRXJyb3JgIHdoZW5ldmVyIHdlIGVuY291bnRlciBvbmUgd2l0aGluIGBoYW5kbGVGZXRjaFJlc3BvbnNlYCBhbmQgY2F0Y2ggdGhlbSBhbGxcclxuICAgICAgICogaGVyZS4gVGhpcyBhbGxvd3MgdXMgdG8gZWFzaWx5IGhhbmRsZSBhbGwgb2YgdGhlc2UgZXJyb3JzIGF0IG9uY2UuIFVuZXhwZWN0ZWQgZXJyb3JzIGFyZSBub3RcclxuICAgICAgICogY2F1Z2h0LCBzbyB0aGF0IHRoZXkgYnViYmxlIHVwIGFuZCBmYWlsIGxvdWRseS5cclxuICAgICAgICpcclxuICAgICAgICogTm90ZTogSWRlYWxseSB3ZSdkIHVzZSBhbiBFaXRoZXIgdHlwZSwgYnV0IHRoaXMgZG9lcyB0aGUgam9iIHdpdGhvdXQgaW50cm9kdWNpbmcgZGVwZW5kZW5jaWVzXHJcbiAgICAgICAqIGxpa2UgYGZwLXRzYC5cclxuICAgICAgICovXG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBEZWNvZGluZ0Vycm9yKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHlwZTogJ2Vycm9yJyxcbiAgICAgICAgICBzb3VyY2U6ICdkZWNvZGluZycsXG4gICAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgb3JpZ2luYWxSZXNwb25zZTogcmVzcG9uc2UsXG4gICAgICAgICAgZXJyb3JzOiBbZXJyb3IubWVzc2FnZV1cbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xufTtcbnZhciBjYXN0UmVzcG9uc2UgPSBmdW5jdGlvbiBjYXN0UmVzcG9uc2UoKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoX3JlZikge1xuICAgIHZhciByZXNwb25zZSA9IF9yZWYucmVzcG9uc2U7XG4gICAgcmV0dXJuIGdldEpzb25SZXNwb25zZShyZXNwb25zZSk7XG4gIH07XG59O1xuXG52YXIgYWRkUXVlcnlUb1VybCA9IGZ1bmN0aW9uIGFkZFF1ZXJ5VG9VcmwocXVlcnkpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh1cmwpIHtcbiAgICBPYmplY3Qua2V5cyhxdWVyeSkuZm9yRWFjaChmdW5jdGlvbiAocXVlcnlLZXkpIHtcbiAgICAgIHJldHVybiB1cmwuc2VhcmNoUGFyYW1zLnNldChxdWVyeUtleSwgcXVlcnlbcXVlcnlLZXldLnRvU3RyaW5nKCkpO1xuICAgIH0pO1xuICB9O1xufTtcblxudmFyIGFkZFBhdGhuYW1lVG9VcmwgPSBmdW5jdGlvbiBhZGRQYXRobmFtZVRvVXJsKHBhdGhuYW1lKSB7XG4gIHJldHVybiBmdW5jdGlvbiAodXJsKSB7XG4gICAgLy8gV2hlbiB0aGVyZSBpcyBubyBleGlzdGluZyBwYXRobmFtZSwgdGhlIHZhbHVlIGlzIGAvYC4gQXBwZW5kaW5nIHdvdWxkIGdpdmUgdXMgYSBVUkwgd2l0aCB0d29cbiAgICAvLyBmb3J3YXJkIHNsYXNoZXMuIFRoaXMgaXMgd2h5IHdlIHJlcGxhY2UgdGhlIHZhbHVlIGluIHRoYXQgc2NlbmFyaW8uXG4gICAgaWYgKHVybC5wYXRobmFtZSA9PT0gJy8nKSB7XG4gICAgICB1cmwucGF0aG5hbWUgPSBwYXRobmFtZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdXJsLnBhdGhuYW1lICs9IHBhdGhuYW1lO1xuICAgIH1cbiAgfTtcbn07XG5cbnZhciBidWlsZFVybCA9IGZ1bmN0aW9uIGJ1aWxkVXJsKF9yZWYpIHtcbiAgdmFyIHBhdGhuYW1lID0gX3JlZi5wYXRobmFtZSxcbiAgICAgIHF1ZXJ5ID0gX3JlZi5xdWVyeTtcbiAgcmV0dXJuIGZ1bmN0aW9uIChhcGlVcmwpIHtcbiAgICB2YXIgdXJsID0gbmV3IFVSTChhcGlVcmwpO1xuICAgIGFkZFBhdGhuYW1lVG9VcmwocGF0aG5hbWUpKHVybCk7XG4gICAgYWRkUXVlcnlUb1VybChxdWVyeSkodXJsKTtcbiAgICByZXR1cm4gdXJsLnRvU3RyaW5nKCk7XG4gIH07XG59O1xuXG52YXIgZ2V0UXVlcnlGcm9tU2VhcmNoUGFyYW1zID0gZnVuY3Rpb24gZ2V0UXVlcnlGcm9tU2VhcmNoUGFyYW1zKHNlYXJjaFBhcmFtcykge1xuICB2YXIgcXVlcnkgPSB7fTtcbiAgc2VhcmNoUGFyYW1zLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcbiAgICBxdWVyeVtrZXldID0gdmFsdWU7XG4gIH0pO1xuICByZXR1cm4gcXVlcnk7XG59O1xuXG52YXIgcGFyc2VRdWVyeUFuZFBhdGhuYW1lID0gZnVuY3Rpb24gcGFyc2VRdWVyeUFuZFBhdGhuYW1lKHVybCkge1xuICB2YXIgX1VSTCA9IG5ldyBVUkwodXJsKSxcbiAgICAgIHBhdGhuYW1lID0gX1VSTC5wYXRobmFtZSxcbiAgICAgIHNlYXJjaFBhcmFtcyA9IF9VUkwuc2VhcmNoUGFyYW1zO1xuXG4gIHZhciBxdWVyeSA9IGdldFF1ZXJ5RnJvbVNlYXJjaFBhcmFtcyhzZWFyY2hQYXJhbXMpO1xuICByZXR1cm4ge1xuICAgIHF1ZXJ5OiBxdWVyeSxcbiAgICBwYXRobmFtZTogcGF0aG5hbWUgPT09ICcvJyA/IHVuZGVmaW5lZCA6IHBhdGhuYW1lXG4gIH07XG59O1xuXG4vKipcclxuICogaGVscGVyIHVzZWQgdG8gdHlwZS1jaGVjayB0aGUgYXJndW1lbnRzLCBhbmQgYWRkIGRlZmF1bHQgcGFyYW1zIGZvciBhbGwgcmVxdWVzdHNcclxuICovXG5cbnZhciBjcmVhdGVSZXF1ZXN0SGFuZGxlciA9IGZ1bmN0aW9uIGNyZWF0ZVJlcXVlc3RIYW5kbGVyKGZuKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoYSwgYWRkaXRpb25hbEZldGNoT3B0aW9ucykge1xuICAgIGlmIChhZGRpdGlvbmFsRmV0Y2hPcHRpb25zID09PSB2b2lkIDApIHtcbiAgICAgIGFkZGl0aW9uYWxGZXRjaE9wdGlvbnMgPSB7fTtcbiAgICB9XG5cbiAgICB2YXIgX2ZuID0gZm4oYSksXG4gICAgICAgIGhlYWRlcnMgPSBfZm4uaGVhZGVycyxcbiAgICAgICAgcXVlcnkgPSBfZm4ucXVlcnksXG4gICAgICAgIGJhc2VSZXFQYXJhbXMgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfZm4sIFtcImhlYWRlcnNcIiwgXCJxdWVyeVwiXSk7XG5cbiAgICByZXR1cm4gX2V4dGVuZHMoe30sIGJhc2VSZXFQYXJhbXMsIGFkZGl0aW9uYWxGZXRjaE9wdGlvbnMsIHtcbiAgICAgIHF1ZXJ5OiBxdWVyeSxcbiAgICAgIGhlYWRlcnM6IF9leHRlbmRzKHt9LCBoZWFkZXJzLCBhZGRpdGlvbmFsRmV0Y2hPcHRpb25zLmhlYWRlcnMpXG4gICAgfSk7XG4gIH07XG59O1xudmFyIG1ha2VFbmRwb2ludCA9IGZ1bmN0aW9uIG1ha2VFbmRwb2ludChlbmRwb2ludCkge1xuICByZXR1cm4gZW5kcG9pbnQ7XG59O1xudmFyIGluaXRNYWtlUmVxdWVzdCA9IGZ1bmN0aW9uIGluaXRNYWtlUmVxdWVzdChfcmVmKSB7XG4gIHZhciBhY2Nlc3NLZXkgPSBfcmVmLmFjY2Vzc0tleSxcbiAgICAgIF9yZWYkYXBpVmVyc2lvbiA9IF9yZWYuYXBpVmVyc2lvbixcbiAgICAgIGFwaVZlcnNpb24gPSBfcmVmJGFwaVZlcnNpb24gPT09IHZvaWQgMCA/ICd2MScgOiBfcmVmJGFwaVZlcnNpb24sXG4gICAgICBfcmVmJGFwaVVybCA9IF9yZWYuYXBpVXJsLFxuICAgICAgYXBpVXJsID0gX3JlZiRhcGlVcmwgPT09IHZvaWQgMCA/ICdodHRwczovL2FwaS51bnNwbGFzaC5jb20nIDogX3JlZiRhcGlVcmwsXG4gICAgICBnZW5lcmFsSGVhZGVycyA9IF9yZWYuaGVhZGVycyxcbiAgICAgIHByb3ZpZGVkRmV0Y2ggPSBfcmVmLmZldGNoLFxuICAgICAgZ2VuZXJhbEZldGNoT3B0aW9ucyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWYsIFtcImFjY2Vzc0tleVwiLCBcImFwaVZlcnNpb25cIiwgXCJhcGlVcmxcIiwgXCJoZWFkZXJzXCIsIFwiZmV0Y2hcIl0pO1xuXG4gIHJldHVybiBmdW5jdGlvbiAoX3JlZjIpIHtcbiAgICB2YXIgaGFuZGxlUmVzcG9uc2UgPSBfcmVmMi5oYW5kbGVSZXNwb25zZSxcbiAgICAgICAgaGFuZGxlUmVxdWVzdCA9IF9yZWYyLmhhbmRsZVJlcXVlc3Q7XG4gICAgcmV0dXJuIGZsb3coaGFuZGxlUmVxdWVzdCwgZnVuY3Rpb24gKF9yZWYzKSB7XG4gICAgICB2YXIgcGF0aG5hbWUgPSBfcmVmMy5wYXRobmFtZSxcbiAgICAgICAgICBxdWVyeSA9IF9yZWYzLnF1ZXJ5LFxuICAgICAgICAgIF9yZWYzJG1ldGhvZCA9IF9yZWYzLm1ldGhvZCxcbiAgICAgICAgICBtZXRob2QgPSBfcmVmMyRtZXRob2QgPT09IHZvaWQgMCA/ICdHRVQnIDogX3JlZjMkbWV0aG9kLFxuICAgICAgICAgIGVuZHBvaW50SGVhZGVycyA9IF9yZWYzLmhlYWRlcnMsXG4gICAgICAgICAgYm9keSA9IF9yZWYzLmJvZHksXG4gICAgICAgICAgc2lnbmFsID0gX3JlZjMuc2lnbmFsO1xuICAgICAgdmFyIHVybCA9IGJ1aWxkVXJsKHtcbiAgICAgICAgcGF0aG5hbWU6IHBhdGhuYW1lLFxuICAgICAgICBxdWVyeTogcXVlcnlcbiAgICAgIH0pKGFwaVVybCk7XG5cbiAgICAgIHZhciBmZXRjaE9wdGlvbnMgPSBfZXh0ZW5kcyh7XG4gICAgICAgIG1ldGhvZDogbWV0aG9kLFxuICAgICAgICBoZWFkZXJzOiBfZXh0ZW5kcyh7fSwgZ2VuZXJhbEhlYWRlcnMsIGVuZHBvaW50SGVhZGVycywge1xuICAgICAgICAgICdBY2NlcHQtVmVyc2lvbic6IGFwaVZlcnNpb25cbiAgICAgICAgfSwgaXNEZWZpbmVkKGFjY2Vzc0tleSkgPyB7XG4gICAgICAgICAgQXV0aG9yaXphdGlvbjogXCJDbGllbnQtSUQgXCIgKyBhY2Nlc3NLZXlcbiAgICAgICAgfSA6IHt9KSxcbiAgICAgICAgYm9keTogYm9keSxcbiAgICAgICAgc2lnbmFsOiBzaWduYWxcbiAgICAgIH0sIGdlbmVyYWxGZXRjaE9wdGlvbnMpO1xuXG4gICAgICB2YXIgZmV0Y2hUb1VzZSA9IHByb3ZpZGVkRmV0Y2ggIT0gbnVsbCA/IHByb3ZpZGVkRmV0Y2ggOiBmZXRjaDtcbiAgICAgIHJldHVybiBmZXRjaFRvVXNlKHVybCwgZmV0Y2hPcHRpb25zKS50aGVuKGhhbmRsZUZldGNoUmVzcG9uc2UoaGFuZGxlUmVzcG9uc2UpKTtcbiAgICB9KTtcbiAgfTtcbn07XG5cbnZhciBUT1RBTF9SRVNQT05TRV9IRUFERVIgPSAneC10b3RhbCc7XG5cbnZhciBnZXRUb3RhbEZyb21BcGlGZWVkUmVzcG9uc2UgPSBmdW5jdGlvbiBnZXRUb3RhbEZyb21BcGlGZWVkUmVzcG9uc2UocmVzcG9uc2UpIHtcbiAgdmFyIHRvdGFsc1N0ciA9IHJlc3BvbnNlLmhlYWRlcnMuZ2V0KFRPVEFMX1JFU1BPTlNFX0hFQURFUik7XG5cbiAgaWYgKGlzRGVmaW5lZCh0b3RhbHNTdHIpKSB7XG4gICAgdmFyIHRvdGFsID0gcGFyc2VJbnQodG90YWxzU3RyKTtcblxuICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKHRvdGFsKSkge1xuICAgICAgcmV0dXJuIHRvdGFsO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRGVjb2RpbmdFcnJvcihcImV4cGVjdGVkIFwiICsgVE9UQUxfUkVTUE9OU0VfSEVBREVSICsgXCIgaGVhZGVyIHRvIGJlIHZhbGlkIGludGVnZXIuXCIpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICB0aHJvdyBuZXcgRGVjb2RpbmdFcnJvcihcImV4cGVjdGVkIFwiICsgVE9UQUxfUkVTUE9OU0VfSEVBREVSICsgXCIgaGVhZGVyIHRvIGV4aXN0LlwiKTtcbiAgfVxufTtcblxudmFyIGhhbmRsZUZlZWRSZXNwb25zZSA9IGZ1bmN0aW9uIGhhbmRsZUZlZWRSZXNwb25zZSgpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChfcmVmKSB7XG4gICAgdmFyIHJlc3BvbnNlID0gX3JlZi5yZXNwb25zZTtcbiAgICByZXR1cm4gY2FzdFJlc3BvbnNlKCkoe1xuICAgICAgcmVzcG9uc2U6IHJlc3BvbnNlXG4gICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0cykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdWx0czogcmVzdWx0cyxcbiAgICAgICAgdG90YWw6IGdldFRvdGFsRnJvbUFwaUZlZWRSZXNwb25zZShyZXNwb25zZSlcbiAgICAgIH07XG4gICAgfSk7XG4gIH07XG59O1xuXG52YXIgZ2V0Q29sbGVjdGlvbnMgPSBmdW5jdGlvbiBnZXRDb2xsZWN0aW9ucyhjb2xsZWN0aW9uSWRzKSB7XG4gIHJldHVybiBpc0RlZmluZWQoY29sbGVjdGlvbklkcykgPyB7XG4gICAgY29sbGVjdGlvbnM6IGNvbGxlY3Rpb25JZHMuam9pbigpXG4gIH0gOiB7fTtcbn07XG52YXIgZ2V0VG9waWNzID0gZnVuY3Rpb24gZ2V0VG9waWNzKHRvcGljSWRzKSB7XG4gIHJldHVybiBpc0RlZmluZWQodG9waWNJZHMpID8ge1xuICAgIHRvcGljczogdG9waWNJZHMuam9pbigpXG4gIH0gOiB7fTtcbn07XG52YXIgZ2V0RmVlZFBhcmFtcyA9IGZ1bmN0aW9uIGdldEZlZWRQYXJhbXMoX3JlZikge1xuICB2YXIgcGFnZSA9IF9yZWYucGFnZSxcbiAgICAgIHBlclBhZ2UgPSBfcmVmLnBlclBhZ2UsXG4gICAgICBvcmRlckJ5ID0gX3JlZi5vcmRlckJ5O1xuICByZXR1cm4gY29tcGFjdERlZmluZWQoe1xuICAgIHBlcl9wYWdlOiBwZXJQYWdlLFxuICAgIG9yZGVyX2J5OiBvcmRlckJ5LFxuICAgIHBhZ2U6IHBhZ2VcbiAgfSk7XG59O1xuXG52YXIgQ09MTEVDVElPTlNfUEFUSF9QUkVGSVggPSAnL2NvbGxlY3Rpb25zJztcbnZhciBnZXRQaG90b3MgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICB2YXIgZ2V0UGF0aG5hbWUgPSBmdW5jdGlvbiBnZXRQYXRobmFtZShfcmVmKSB7XG4gICAgdmFyIGNvbGxlY3Rpb25JZCA9IF9yZWYuY29sbGVjdGlvbklkO1xuICAgIHJldHVybiBDT0xMRUNUSU9OU19QQVRIX1BSRUZJWCArIFwiL1wiICsgY29sbGVjdGlvbklkICsgXCIvcGhvdG9zXCI7XG4gIH07XG5cbiAgcmV0dXJuIG1ha2VFbmRwb2ludCh7XG4gICAgZ2V0UGF0aG5hbWU6IGdldFBhdGhuYW1lLFxuICAgIGhhbmRsZVJlcXVlc3Q6IGNyZWF0ZVJlcXVlc3RIYW5kbGVyKGZ1bmN0aW9uIChfcmVmMikge1xuICAgICAgdmFyIGNvbGxlY3Rpb25JZCA9IF9yZWYyLmNvbGxlY3Rpb25JZCxcbiAgICAgICAgICBvcmllbnRhdGlvbiA9IF9yZWYyLm9yaWVudGF0aW9uLFxuICAgICAgICAgIHBhZ2luYXRpb25QYXJhbXMgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfcmVmMiwgW1wiY29sbGVjdGlvbklkXCIsIFwib3JpZW50YXRpb25cIl0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBwYXRobmFtZTogZ2V0UGF0aG5hbWUoe1xuICAgICAgICAgIGNvbGxlY3Rpb25JZDogY29sbGVjdGlvbklkXG4gICAgICAgIH0pLFxuICAgICAgICBxdWVyeTogY29tcGFjdERlZmluZWQoX2V4dGVuZHMoe30sIGdldEZlZWRQYXJhbXMocGFnaW5hdGlvblBhcmFtcyksIHtcbiAgICAgICAgICBvcmllbnRhdGlvbjogb3JpZW50YXRpb25cbiAgICAgICAgfSkpXG4gICAgICB9O1xuICAgIH0pLFxuICAgIGhhbmRsZVJlc3BvbnNlOiBoYW5kbGVGZWVkUmVzcG9uc2UoKVxuICB9KTtcbn0oKTtcbnZhciBnZXQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICB2YXIgZ2V0UGF0aG5hbWUgPSBmdW5jdGlvbiBnZXRQYXRobmFtZShfcmVmMykge1xuICAgIHZhciBjb2xsZWN0aW9uSWQgPSBfcmVmMy5jb2xsZWN0aW9uSWQ7XG4gICAgcmV0dXJuIENPTExFQ1RJT05TX1BBVEhfUFJFRklYICsgXCIvXCIgKyBjb2xsZWN0aW9uSWQ7XG4gIH07XG5cbiAgcmV0dXJuIG1ha2VFbmRwb2ludCh7XG4gICAgZ2V0UGF0aG5hbWU6IGdldFBhdGhuYW1lLFxuICAgIGhhbmRsZVJlcXVlc3Q6IGNyZWF0ZVJlcXVlc3RIYW5kbGVyKGZ1bmN0aW9uIChfcmVmNCkge1xuICAgICAgdmFyIGNvbGxlY3Rpb25JZCA9IF9yZWY0LmNvbGxlY3Rpb25JZDtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBhdGhuYW1lOiBnZXRQYXRobmFtZSh7XG4gICAgICAgICAgY29sbGVjdGlvbklkOiBjb2xsZWN0aW9uSWRcbiAgICAgICAgfSksXG4gICAgICAgIHF1ZXJ5OiB7fVxuICAgICAgfTtcbiAgICB9KSxcbiAgICBoYW5kbGVSZXNwb25zZTogY2FzdFJlc3BvbnNlKClcbiAgfSk7XG59KCk7XG52YXIgbGlzdCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIHZhciBnZXRQYXRobmFtZSA9IGZ1bmN0aW9uIGdldFBhdGhuYW1lKCkge1xuICAgIHJldHVybiBDT0xMRUNUSU9OU19QQVRIX1BSRUZJWDtcbiAgfTtcblxuICByZXR1cm4gbWFrZUVuZHBvaW50KHtcbiAgICBnZXRQYXRobmFtZTogZ2V0UGF0aG5hbWUsXG4gICAgaGFuZGxlUmVxdWVzdDogY3JlYXRlUmVxdWVzdEhhbmRsZXIoZnVuY3Rpb24gKHBhZ2luYXRpb25QYXJhbXMpIHtcbiAgICAgIGlmIChwYWdpbmF0aW9uUGFyYW1zID09PSB2b2lkIDApIHtcbiAgICAgICAgcGFnaW5hdGlvblBhcmFtcyA9IHt9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBwYXRobmFtZTogZ2V0UGF0aG5hbWUoKSxcbiAgICAgICAgcXVlcnk6IGdldEZlZWRQYXJhbXMocGFnaW5hdGlvblBhcmFtcylcbiAgICAgIH07XG4gICAgfSksXG4gICAgaGFuZGxlUmVzcG9uc2U6IGhhbmRsZUZlZWRSZXNwb25zZSgpXG4gIH0pO1xufSgpO1xudmFyIGdldFJlbGF0ZWQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICB2YXIgZ2V0UGF0aG5hbWUgPSBmdW5jdGlvbiBnZXRQYXRobmFtZShfcmVmNSkge1xuICAgIHZhciBjb2xsZWN0aW9uSWQgPSBfcmVmNS5jb2xsZWN0aW9uSWQ7XG4gICAgcmV0dXJuIENPTExFQ1RJT05TX1BBVEhfUFJFRklYICsgXCIvXCIgKyBjb2xsZWN0aW9uSWQgKyBcIi9yZWxhdGVkXCI7XG4gIH07XG5cbiAgcmV0dXJuIG1ha2VFbmRwb2ludCh7XG4gICAgZ2V0UGF0aG5hbWU6IGdldFBhdGhuYW1lLFxuICAgIGhhbmRsZVJlcXVlc3Q6IGNyZWF0ZVJlcXVlc3RIYW5kbGVyKGZ1bmN0aW9uIChfcmVmNikge1xuICAgICAgdmFyIGNvbGxlY3Rpb25JZCA9IF9yZWY2LmNvbGxlY3Rpb25JZDtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBhdGhuYW1lOiBnZXRQYXRobmFtZSh7XG4gICAgICAgICAgY29sbGVjdGlvbklkOiBjb2xsZWN0aW9uSWRcbiAgICAgICAgfSksXG4gICAgICAgIHF1ZXJ5OiB7fVxuICAgICAgfTtcbiAgICB9KSxcbiAgICBoYW5kbGVSZXNwb25zZTogY2FzdFJlc3BvbnNlKClcbiAgfSk7XG59KCk7XG5cbnZhciBpbmRleCA9IHtcbiAgX19wcm90b19fOiBudWxsLFxuICBnZXRQaG90b3M6IGdldFBob3RvcyxcbiAgZ2V0OiBnZXQsXG4gIGxpc3Q6IGxpc3QsXG4gIGdldFJlbGF0ZWQ6IGdldFJlbGF0ZWRcbn07XG5cbnZhciBQSE9UT1NfUEFUSF9QUkVGSVggPSAnL3Bob3Rvcyc7XG52YXIgbGlzdCQxID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgdmFyIF9nZXRQYXRobmFtZSA9IGZ1bmN0aW9uIGdldFBhdGhuYW1lKCkge1xuICAgIHJldHVybiBQSE9UT1NfUEFUSF9QUkVGSVg7XG4gIH07XG5cbiAgcmV0dXJuIG1ha2VFbmRwb2ludCh7XG4gICAgLy8gV3JhcHBlciB1c2VzIHR5cGUgdHJpY2sgdG8gYWxsb3cgMCBhcmdzXG4gICAgZ2V0UGF0aG5hbWU6IGZ1bmN0aW9uIGdldFBhdGhuYW1lKF9wYXJhbXMpIHtcbiAgICAgIHJldHVybiBfZ2V0UGF0aG5hbWUoKTtcbiAgICB9LFxuICAgIGhhbmRsZVJlcXVlc3Q6IGNyZWF0ZVJlcXVlc3RIYW5kbGVyKGZ1bmN0aW9uIChmZWVkUGFyYW1zKSB7XG4gICAgICBpZiAoZmVlZFBhcmFtcyA9PT0gdm9pZCAwKSB7XG4gICAgICAgIGZlZWRQYXJhbXMgPSB7fTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcGF0aG5hbWU6IFBIT1RPU19QQVRIX1BSRUZJWCxcbiAgICAgICAgcXVlcnk6IGNvbXBhY3REZWZpbmVkKGdldEZlZWRQYXJhbXMoZmVlZFBhcmFtcykpXG4gICAgICB9O1xuICAgIH0pLFxuICAgIGhhbmRsZVJlc3BvbnNlOiBoYW5kbGVGZWVkUmVzcG9uc2UoKVxuICB9KTtcbn0oKTtcbnZhciBnZXQkMSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIHZhciBnZXRQYXRobmFtZSA9IGZ1bmN0aW9uIGdldFBhdGhuYW1lKF9yZWYpIHtcbiAgICB2YXIgcGhvdG9JZCA9IF9yZWYucGhvdG9JZDtcbiAgICByZXR1cm4gUEhPVE9TX1BBVEhfUFJFRklYICsgXCIvXCIgKyBwaG90b0lkO1xuICB9O1xuXG4gIHJldHVybiBtYWtlRW5kcG9pbnQoe1xuICAgIGdldFBhdGhuYW1lOiBnZXRQYXRobmFtZSxcbiAgICBoYW5kbGVSZXF1ZXN0OiBjcmVhdGVSZXF1ZXN0SGFuZGxlcihmdW5jdGlvbiAoX3JlZjIpIHtcbiAgICAgIHZhciBwaG90b0lkID0gX3JlZjIucGhvdG9JZDtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBhdGhuYW1lOiBnZXRQYXRobmFtZSh7XG4gICAgICAgICAgcGhvdG9JZDogcGhvdG9JZFxuICAgICAgICB9KSxcbiAgICAgICAgcXVlcnk6IHt9XG4gICAgICB9O1xuICAgIH0pLFxuICAgIGhhbmRsZVJlc3BvbnNlOiBjYXN0UmVzcG9uc2UoKVxuICB9KTtcbn0oKTtcbnZhciBnZXRTdGF0cyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIHZhciBnZXRQYXRobmFtZSA9IGZ1bmN0aW9uIGdldFBhdGhuYW1lKF9yZWYzKSB7XG4gICAgdmFyIHBob3RvSWQgPSBfcmVmMy5waG90b0lkO1xuICAgIHJldHVybiBQSE9UT1NfUEFUSF9QUkVGSVggKyBcIi9cIiArIHBob3RvSWQgKyBcIi9zdGF0aXN0aWNzXCI7XG4gIH07XG5cbiAgcmV0dXJuIG1ha2VFbmRwb2ludCh7XG4gICAgZ2V0UGF0aG5hbWU6IGdldFBhdGhuYW1lLFxuICAgIGhhbmRsZVJlcXVlc3Q6IGNyZWF0ZVJlcXVlc3RIYW5kbGVyKGZ1bmN0aW9uIChfcmVmNCkge1xuICAgICAgdmFyIHBob3RvSWQgPSBfcmVmNC5waG90b0lkO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcGF0aG5hbWU6IGdldFBhdGhuYW1lKHtcbiAgICAgICAgICBwaG90b0lkOiBwaG90b0lkXG4gICAgICAgIH0pLFxuICAgICAgICBxdWVyeToge31cbiAgICAgIH07XG4gICAgfSksXG4gICAgaGFuZGxlUmVzcG9uc2U6IGNhc3RSZXNwb25zZSgpXG4gIH0pO1xufSgpO1xudmFyIGdldFJhbmRvbSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIHZhciBnZXRQYXRobmFtZSA9IGZ1bmN0aW9uIGdldFBhdGhuYW1lKCkge1xuICAgIHJldHVybiBQSE9UT1NfUEFUSF9QUkVGSVggKyBcIi9yYW5kb21cIjtcbiAgfTtcblxuICByZXR1cm4gbWFrZUVuZHBvaW50KHtcbiAgICBnZXRQYXRobmFtZTogZ2V0UGF0aG5hbWUsXG4gICAgaGFuZGxlUmVxdWVzdDogY3JlYXRlUmVxdWVzdEhhbmRsZXIoZnVuY3Rpb24gKF90ZW1wKSB7XG4gICAgICB2YXIgX3JlZjUgPSBfdGVtcCA9PT0gdm9pZCAwID8ge30gOiBfdGVtcCxcbiAgICAgICAgICBjb2xsZWN0aW9uSWRzID0gX3JlZjUuY29sbGVjdGlvbklkcyxcbiAgICAgICAgICBjb250ZW50RmlsdGVyID0gX3JlZjUuY29udGVudEZpbHRlcixcbiAgICAgICAgICB0b3BpY0lkcyA9IF9yZWY1LnRvcGljSWRzLFxuICAgICAgICAgIHF1ZXJ5UGFyYW1zID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UoX3JlZjUsIFtcImNvbGxlY3Rpb25JZHNcIiwgXCJjb250ZW50RmlsdGVyXCIsIFwidG9waWNJZHNcIl0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBwYXRobmFtZTogZ2V0UGF0aG5hbWUoKSxcbiAgICAgICAgcXVlcnk6IGNvbXBhY3REZWZpbmVkKF9leHRlbmRzKHt9LCBxdWVyeVBhcmFtcywge1xuICAgICAgICAgIGNvbnRlbnRfZmlsdGVyOiBjb250ZW50RmlsdGVyXG4gICAgICAgIH0sIGdldENvbGxlY3Rpb25zKGNvbGxlY3Rpb25JZHMpLCBnZXRUb3BpY3ModG9waWNJZHMpKSksXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAvKipcclxuICAgICAgICAgICAqIEF2b2lkIHJlc3BvbnNlIGNhY2hpbmdcclxuICAgICAgICAgICAqL1xuICAgICAgICAgICdjYWNoZS1jb250cm9sJzogJ25vLWNhY2hlJ1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0pLFxuICAgIGhhbmRsZVJlc3BvbnNlOiBjYXN0UmVzcG9uc2UoKVxuICB9KTtcbn0oKTtcbnZhciB0cmFja0Rvd25sb2FkID0ge1xuICBoYW5kbGVSZXF1ZXN0OiAvKiNfX1BVUkVfXyovY3JlYXRlUmVxdWVzdEhhbmRsZXIoZnVuY3Rpb24gKF9yZWY2KSB7XG4gICAgdmFyIGRvd25sb2FkTG9jYXRpb24gPSBfcmVmNi5kb3dubG9hZExvY2F0aW9uO1xuXG4gICAgdmFyIF9wYXJzZVF1ZXJ5QW5kUGF0aG5hbSA9IHBhcnNlUXVlcnlBbmRQYXRobmFtZShkb3dubG9hZExvY2F0aW9uKSxcbiAgICAgICAgcGF0aG5hbWUgPSBfcGFyc2VRdWVyeUFuZFBhdGhuYW0ucGF0aG5hbWUsXG4gICAgICAgIHF1ZXJ5ID0gX3BhcnNlUXVlcnlBbmRQYXRobmFtLnF1ZXJ5O1xuXG4gICAgaWYgKCFpc0RlZmluZWQocGF0aG5hbWUpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBwYXJzZSBwYXRobmFtZSBmcm9tIHVybC4nKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgcGF0aG5hbWU6IHBhdGhuYW1lLFxuICAgICAgcXVlcnk6IGNvbXBhY3REZWZpbmVkKHF1ZXJ5KVxuICAgIH07XG4gIH0pLFxuICBoYW5kbGVSZXNwb25zZTogLyojX19QVVJFX18qL2Nhc3RSZXNwb25zZSgpXG59O1xuXG52YXIgaW5kZXgkMSA9IHtcbiAgX19wcm90b19fOiBudWxsLFxuICBsaXN0OiBsaXN0JDEsXG4gIGdldDogZ2V0JDEsXG4gIGdldFN0YXRzOiBnZXRTdGF0cyxcbiAgZ2V0UmFuZG9tOiBnZXRSYW5kb20sXG4gIHRyYWNrRG93bmxvYWQ6IHRyYWNrRG93bmxvYWRcbn07XG5cbnZhciBTRUFSQ0hfUEFUSF9QUkVGSVggPSBcIi9zZWFyY2hcIjtcbnZhciBnZXRQaG90b3MkMSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIHZhciBfZ2V0UGF0aG5hbWUgPSBmdW5jdGlvbiBnZXRQYXRobmFtZSgpIHtcbiAgICByZXR1cm4gU0VBUkNIX1BBVEhfUFJFRklYICsgXCIvcGhvdG9zXCI7XG4gIH07XG5cbiAgcmV0dXJuIG1ha2VFbmRwb2ludCh7XG4gICAgLy8gV3JhcHBlciB1c2VzIHR5cGUgdHJpY2sgdG8gYWxsb3cgMCBhcmdzXG4gICAgZ2V0UGF0aG5hbWU6IGZ1bmN0aW9uIGdldFBhdGhuYW1lKF9wYXJhbXMpIHtcbiAgICAgIHJldHVybiBfZ2V0UGF0aG5hbWUoKTtcbiAgICB9LFxuICAgIGhhbmRsZVJlcXVlc3Q6IGNyZWF0ZVJlcXVlc3RIYW5kbGVyKGZ1bmN0aW9uIChfcmVmKSB7XG4gICAgICB2YXIgcXVlcnkgPSBfcmVmLnF1ZXJ5LFxuICAgICAgICAgIHBhZ2UgPSBfcmVmLnBhZ2UsXG4gICAgICAgICAgcGVyUGFnZSA9IF9yZWYucGVyUGFnZSxcbiAgICAgICAgICBvcmRlckJ5ID0gX3JlZi5vcmRlckJ5LFxuICAgICAgICAgIGNvbGxlY3Rpb25JZHMgPSBfcmVmLmNvbGxlY3Rpb25JZHMsXG4gICAgICAgICAgbGFuZyA9IF9yZWYubGFuZyxcbiAgICAgICAgICBjb250ZW50RmlsdGVyID0gX3JlZi5jb250ZW50RmlsdGVyLFxuICAgICAgICAgIGZpbHRlcnMgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfcmVmLCBbXCJxdWVyeVwiLCBcInBhZ2VcIiwgXCJwZXJQYWdlXCIsIFwib3JkZXJCeVwiLCBcImNvbGxlY3Rpb25JZHNcIiwgXCJsYW5nXCIsIFwiY29udGVudEZpbHRlclwiXSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBhdGhuYW1lOiBfZ2V0UGF0aG5hbWUoKSxcbiAgICAgICAgcXVlcnk6IGNvbXBhY3REZWZpbmVkKF9leHRlbmRzKHtcbiAgICAgICAgICBxdWVyeTogcXVlcnksXG4gICAgICAgICAgY29udGVudF9maWx0ZXI6IGNvbnRlbnRGaWx0ZXIsXG4gICAgICAgICAgbGFuZzogbGFuZyxcbiAgICAgICAgICBvcmRlcl9ieTogb3JkZXJCeVxuICAgICAgICB9LCBnZXRGZWVkUGFyYW1zKHtcbiAgICAgICAgICBwYWdlOiBwYWdlLFxuICAgICAgICAgIHBlclBhZ2U6IHBlclBhZ2VcbiAgICAgICAgfSksIGdldENvbGxlY3Rpb25zKGNvbGxlY3Rpb25JZHMpLCBmaWx0ZXJzKSlcbiAgICAgIH07XG4gICAgfSksXG4gICAgaGFuZGxlUmVzcG9uc2U6IGNhc3RSZXNwb25zZSgpXG4gIH0pO1xufSgpO1xudmFyIGdldENvbGxlY3Rpb25zJDEgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICB2YXIgX2dldFBhdGhuYW1lMiA9IGZ1bmN0aW9uIGdldFBhdGhuYW1lKCkge1xuICAgIHJldHVybiBTRUFSQ0hfUEFUSF9QUkVGSVggKyBcIi9jb2xsZWN0aW9uc1wiO1xuICB9O1xuXG4gIHJldHVybiBtYWtlRW5kcG9pbnQoe1xuICAgIC8vIFdyYXBwZXIgdXNlcyB0eXBlIHRyaWNrIHRvIGFsbG93IDAgYXJnc1xuICAgIGdldFBhdGhuYW1lOiBmdW5jdGlvbiBnZXRQYXRobmFtZShfcGFyYW1zKSB7XG4gICAgICByZXR1cm4gX2dldFBhdGhuYW1lMigpO1xuICAgIH0sXG4gICAgaGFuZGxlUmVxdWVzdDogY3JlYXRlUmVxdWVzdEhhbmRsZXIoZnVuY3Rpb24gKF9yZWYyKSB7XG4gICAgICB2YXIgcXVlcnkgPSBfcmVmMi5xdWVyeSxcbiAgICAgICAgICBwYWdpbmF0aW9uUGFyYW1zID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UoX3JlZjIsIFtcInF1ZXJ5XCJdKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcGF0aG5hbWU6IF9nZXRQYXRobmFtZTIoKSxcbiAgICAgICAgcXVlcnk6IF9leHRlbmRzKHtcbiAgICAgICAgICBxdWVyeTogcXVlcnlcbiAgICAgICAgfSwgZ2V0RmVlZFBhcmFtcyhwYWdpbmF0aW9uUGFyYW1zKSlcbiAgICAgIH07XG4gICAgfSksXG4gICAgaGFuZGxlUmVzcG9uc2U6IGNhc3RSZXNwb25zZSgpXG4gIH0pO1xufSgpO1xudmFyIGdldFVzZXJzID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgdmFyIF9nZXRQYXRobmFtZTMgPSBmdW5jdGlvbiBnZXRQYXRobmFtZSgpIHtcbiAgICByZXR1cm4gU0VBUkNIX1BBVEhfUFJFRklYICsgXCIvdXNlcnNcIjtcbiAgfTtcblxuICByZXR1cm4gbWFrZUVuZHBvaW50KHtcbiAgICAvLyBXcmFwcGVyIHVzZXMgdHlwZSB0cmljayB0byBhbGxvdyAwIGFyZ3NcbiAgICBnZXRQYXRobmFtZTogZnVuY3Rpb24gZ2V0UGF0aG5hbWUoX3BhcmFtcykge1xuICAgICAgcmV0dXJuIF9nZXRQYXRobmFtZTMoKTtcbiAgICB9LFxuICAgIGhhbmRsZVJlcXVlc3Q6IGNyZWF0ZVJlcXVlc3RIYW5kbGVyKGZ1bmN0aW9uIChfcmVmMykge1xuICAgICAgdmFyIHF1ZXJ5ID0gX3JlZjMucXVlcnksXG4gICAgICAgICAgcGFnaW5hdGlvblBhcmFtcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWYzLCBbXCJxdWVyeVwiXSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBhdGhuYW1lOiBfZ2V0UGF0aG5hbWUzKCksXG4gICAgICAgIHF1ZXJ5OiBfZXh0ZW5kcyh7XG4gICAgICAgICAgcXVlcnk6IHF1ZXJ5XG4gICAgICAgIH0sIGdldEZlZWRQYXJhbXMocGFnaW5hdGlvblBhcmFtcykpXG4gICAgICB9O1xuICAgIH0pLFxuICAgIGhhbmRsZVJlc3BvbnNlOiBjYXN0UmVzcG9uc2UoKVxuICB9KTtcbn0oKTtcblxudmFyIGluZGV4JDIgPSB7XG4gIF9fcHJvdG9fXzogbnVsbCxcbiAgZ2V0UGhvdG9zOiBnZXRQaG90b3MkMSxcbiAgZ2V0Q29sbGVjdGlvbnM6IGdldENvbGxlY3Rpb25zJDEsXG4gIGdldFVzZXJzOiBnZXRVc2Vyc1xufTtcblxudmFyIFVTRVJTX1BBVEhfUFJFRklYID0gJy91c2Vycyc7XG52YXIgZ2V0JDIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICB2YXIgZ2V0UGF0aG5hbWUgPSBmdW5jdGlvbiBnZXRQYXRobmFtZShfcmVmKSB7XG4gICAgdmFyIHVzZXJuYW1lID0gX3JlZi51c2VybmFtZTtcbiAgICByZXR1cm4gVVNFUlNfUEFUSF9QUkVGSVggKyBcIi9cIiArIHVzZXJuYW1lO1xuICB9O1xuXG4gIHJldHVybiBtYWtlRW5kcG9pbnQoe1xuICAgIGdldFBhdGhuYW1lOiBnZXRQYXRobmFtZSxcbiAgICBoYW5kbGVSZXF1ZXN0OiBjcmVhdGVSZXF1ZXN0SGFuZGxlcihmdW5jdGlvbiAoX3JlZjIpIHtcbiAgICAgIHZhciB1c2VybmFtZSA9IF9yZWYyLnVzZXJuYW1lO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcGF0aG5hbWU6IGdldFBhdGhuYW1lKHtcbiAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWVcbiAgICAgICAgfSksXG4gICAgICAgIHF1ZXJ5OiB7fVxuICAgICAgfTtcbiAgICB9KSxcbiAgICBoYW5kbGVSZXNwb25zZTogY2FzdFJlc3BvbnNlKClcbiAgfSk7XG59KCk7XG52YXIgZ2V0UGhvdG9zJDIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICB2YXIgZ2V0UGF0aG5hbWUgPSBmdW5jdGlvbiBnZXRQYXRobmFtZShfcmVmMykge1xuICAgIHZhciB1c2VybmFtZSA9IF9yZWYzLnVzZXJuYW1lO1xuICAgIHJldHVybiBVU0VSU19QQVRIX1BSRUZJWCArIFwiL1wiICsgdXNlcm5hbWUgKyBcIi9waG90b3NcIjtcbiAgfTtcblxuICByZXR1cm4gbWFrZUVuZHBvaW50KHtcbiAgICBnZXRQYXRobmFtZTogZ2V0UGF0aG5hbWUsXG4gICAgaGFuZGxlUmVxdWVzdDogY3JlYXRlUmVxdWVzdEhhbmRsZXIoZnVuY3Rpb24gKF9yZWY0KSB7XG4gICAgICB2YXIgdXNlcm5hbWUgPSBfcmVmNC51c2VybmFtZSxcbiAgICAgICAgICBzdGF0cyA9IF9yZWY0LnN0YXRzLFxuICAgICAgICAgIG9yaWVudGF0aW9uID0gX3JlZjQub3JpZW50YXRpb24sXG4gICAgICAgICAgcGFnaW5hdGlvblBhcmFtcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWY0LCBbXCJ1c2VybmFtZVwiLCBcInN0YXRzXCIsIFwib3JpZW50YXRpb25cIl0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBwYXRobmFtZTogZ2V0UGF0aG5hbWUoe1xuICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZVxuICAgICAgICB9KSxcbiAgICAgICAgcXVlcnk6IGNvbXBhY3REZWZpbmVkKF9leHRlbmRzKHt9LCBnZXRGZWVkUGFyYW1zKHBhZ2luYXRpb25QYXJhbXMpLCB7XG4gICAgICAgICAgb3JpZW50YXRpb246IG9yaWVudGF0aW9uLFxuICAgICAgICAgIHN0YXRzOiBzdGF0c1xuICAgICAgICB9KSlcbiAgICAgIH07XG4gICAgfSksXG4gICAgaGFuZGxlUmVzcG9uc2U6IGhhbmRsZUZlZWRSZXNwb25zZSgpXG4gIH0pO1xufSgpO1xudmFyIGdldExpa2VzID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgdmFyIGdldFBhdGhuYW1lID0gZnVuY3Rpb24gZ2V0UGF0aG5hbWUoX3JlZjUpIHtcbiAgICB2YXIgdXNlcm5hbWUgPSBfcmVmNS51c2VybmFtZTtcbiAgICByZXR1cm4gVVNFUlNfUEFUSF9QUkVGSVggKyBcIi9cIiArIHVzZXJuYW1lICsgXCIvbGlrZXNcIjtcbiAgfTtcblxuICByZXR1cm4gbWFrZUVuZHBvaW50KHtcbiAgICBnZXRQYXRobmFtZTogZ2V0UGF0aG5hbWUsXG4gICAgaGFuZGxlUmVxdWVzdDogY3JlYXRlUmVxdWVzdEhhbmRsZXIoZnVuY3Rpb24gKF9yZWY2KSB7XG4gICAgICB2YXIgdXNlcm5hbWUgPSBfcmVmNi51c2VybmFtZSxcbiAgICAgICAgICBvcmllbnRhdGlvbiA9IF9yZWY2Lm9yaWVudGF0aW9uLFxuICAgICAgICAgIHBhZ2luYXRpb25QYXJhbXMgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfcmVmNiwgW1widXNlcm5hbWVcIiwgXCJvcmllbnRhdGlvblwiXSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBhdGhuYW1lOiBnZXRQYXRobmFtZSh7XG4gICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lXG4gICAgICAgIH0pLFxuICAgICAgICBxdWVyeTogY29tcGFjdERlZmluZWQoX2V4dGVuZHMoe30sIGdldEZlZWRQYXJhbXMocGFnaW5hdGlvblBhcmFtcyksIHtcbiAgICAgICAgICBvcmllbnRhdGlvbjogb3JpZW50YXRpb25cbiAgICAgICAgfSkpXG4gICAgICB9O1xuICAgIH0pLFxuICAgIGhhbmRsZVJlc3BvbnNlOiBoYW5kbGVGZWVkUmVzcG9uc2UoKVxuICB9KTtcbn0oKTtcbnZhciBnZXRDb2xsZWN0aW9ucyQyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgdmFyIGdldFBhdGhuYW1lID0gZnVuY3Rpb24gZ2V0UGF0aG5hbWUoX3JlZjcpIHtcbiAgICB2YXIgdXNlcm5hbWUgPSBfcmVmNy51c2VybmFtZTtcbiAgICByZXR1cm4gVVNFUlNfUEFUSF9QUkVGSVggKyBcIi9cIiArIHVzZXJuYW1lICsgXCIvY29sbGVjdGlvbnNcIjtcbiAgfTtcblxuICByZXR1cm4gbWFrZUVuZHBvaW50KHtcbiAgICBnZXRQYXRobmFtZTogZ2V0UGF0aG5hbWUsXG4gICAgaGFuZGxlUmVxdWVzdDogY3JlYXRlUmVxdWVzdEhhbmRsZXIoZnVuY3Rpb24gKF9yZWY4KSB7XG4gICAgICB2YXIgdXNlcm5hbWUgPSBfcmVmOC51c2VybmFtZSxcbiAgICAgICAgICBwYWdpbmF0aW9uUGFyYW1zID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UoX3JlZjgsIFtcInVzZXJuYW1lXCJdKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcGF0aG5hbWU6IGdldFBhdGhuYW1lKHtcbiAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWVcbiAgICAgICAgfSksXG4gICAgICAgIHF1ZXJ5OiBnZXRGZWVkUGFyYW1zKHBhZ2luYXRpb25QYXJhbXMpXG4gICAgICB9O1xuICAgIH0pLFxuICAgIGhhbmRsZVJlc3BvbnNlOiBoYW5kbGVGZWVkUmVzcG9uc2UoKVxuICB9KTtcbn0oKTtcblxudmFyIGluZGV4JDMgPSB7XG4gIF9fcHJvdG9fXzogbnVsbCxcbiAgZ2V0OiBnZXQkMixcbiAgZ2V0UGhvdG9zOiBnZXRQaG90b3MkMixcbiAgZ2V0TGlrZXM6IGdldExpa2VzLFxuICBnZXRDb2xsZWN0aW9uczogZ2V0Q29sbGVjdGlvbnMkMlxufTtcblxudmFyIEJBU0VfVE9QSUNfUEFUSCA9ICcvdG9waWNzJztcblxudmFyIGdldFRvcGljUGF0aCA9IGZ1bmN0aW9uIGdldFRvcGljUGF0aChfcmVmKSB7XG4gIHZhciB0b3BpY0lkT3JTbHVnID0gX3JlZi50b3BpY0lkT3JTbHVnO1xuICByZXR1cm4gQkFTRV9UT1BJQ19QQVRIICsgXCIvXCIgKyB0b3BpY0lkT3JTbHVnO1xufTtcblxudmFyIGxpc3QkMiA9IC8qI19fUFVSRV9fKi9tYWtlRW5kcG9pbnQoe1xuICBnZXRQYXRobmFtZTogZ2V0VG9waWNQYXRoLFxuICBoYW5kbGVSZXF1ZXN0OiBmdW5jdGlvbiBoYW5kbGVSZXF1ZXN0KF9yZWYyKSB7XG4gICAgdmFyIHBhZ2UgPSBfcmVmMi5wYWdlLFxuICAgICAgICBwZXJQYWdlID0gX3JlZjIucGVyUGFnZSxcbiAgICAgICAgb3JkZXJCeSA9IF9yZWYyLm9yZGVyQnksXG4gICAgICAgIHRvcGljSWRzT3JTbHVncyA9IF9yZWYyLnRvcGljSWRzT3JTbHVncztcbiAgICByZXR1cm4ge1xuICAgICAgcGF0aG5hbWU6IEJBU0VfVE9QSUNfUEFUSCxcbiAgICAgIHF1ZXJ5OiBjb21wYWN0RGVmaW5lZChfZXh0ZW5kcyh7fSwgZ2V0RmVlZFBhcmFtcyh7XG4gICAgICAgIHBhZ2U6IHBhZ2UsXG4gICAgICAgIHBlclBhZ2U6IHBlclBhZ2VcbiAgICAgIH0pLCB7XG4gICAgICAgIGlkczogdG9waWNJZHNPclNsdWdzID09IG51bGwgPyB2b2lkIDAgOiB0b3BpY0lkc09yU2x1Z3Muam9pbignLCcpLFxuICAgICAgICBvcmRlcl9ieTogb3JkZXJCeVxuICAgICAgfSkpXG4gICAgfTtcbiAgfSxcbiAgaGFuZGxlUmVzcG9uc2U6IC8qI19fUFVSRV9fKi9oYW5kbGVGZWVkUmVzcG9uc2UoKVxufSk7XG52YXIgZ2V0JDMgPSAvKiNfX1BVUkVfXyovbWFrZUVuZHBvaW50KHtcbiAgZ2V0UGF0aG5hbWU6IGdldFRvcGljUGF0aCxcbiAgaGFuZGxlUmVxdWVzdDogZnVuY3Rpb24gaGFuZGxlUmVxdWVzdChfcmVmMykge1xuICAgIHZhciB0b3BpY0lkT3JTbHVnID0gX3JlZjMudG9waWNJZE9yU2x1ZztcbiAgICByZXR1cm4ge1xuICAgICAgcGF0aG5hbWU6IGdldFRvcGljUGF0aCh7XG4gICAgICAgIHRvcGljSWRPclNsdWc6IHRvcGljSWRPclNsdWdcbiAgICAgIH0pLFxuICAgICAgcXVlcnk6IHt9XG4gICAgfTtcbiAgfSxcbiAgaGFuZGxlUmVzcG9uc2U6IC8qI19fUFVSRV9fKi9jYXN0UmVzcG9uc2UoKVxufSk7XG52YXIgZ2V0UGhvdG9zJDMgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICB2YXIgZ2V0UGF0aG5hbWUgPSAvKiNfX1BVUkVfXyovZmxvdyhnZXRUb3BpY1BhdGgsIGZ1bmN0aW9uICh0b3BpY1BhdGgpIHtcbiAgICByZXR1cm4gdG9waWNQYXRoICsgXCIvcGhvdG9zXCI7XG4gIH0pO1xuICByZXR1cm4gbWFrZUVuZHBvaW50KHtcbiAgICBnZXRQYXRobmFtZTogZ2V0UGF0aG5hbWUsXG4gICAgaGFuZGxlUmVxdWVzdDogZnVuY3Rpb24gaGFuZGxlUmVxdWVzdChfcmVmNCkge1xuICAgICAgdmFyIHRvcGljSWRPclNsdWcgPSBfcmVmNC50b3BpY0lkT3JTbHVnLFxuICAgICAgICAgIG9yaWVudGF0aW9uID0gX3JlZjQub3JpZW50YXRpb24sXG4gICAgICAgICAgZmVlZFBhcmFtcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWY0LCBbXCJ0b3BpY0lkT3JTbHVnXCIsIFwib3JpZW50YXRpb25cIl0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBwYXRobmFtZTogZ2V0UGF0aG5hbWUoe1xuICAgICAgICAgIHRvcGljSWRPclNsdWc6IHRvcGljSWRPclNsdWdcbiAgICAgICAgfSksXG4gICAgICAgIHF1ZXJ5OiBjb21wYWN0RGVmaW5lZChfZXh0ZW5kcyh7fSwgZ2V0RmVlZFBhcmFtcyhmZWVkUGFyYW1zKSwge1xuICAgICAgICAgIG9yaWVudGF0aW9uOiBvcmllbnRhdGlvblxuICAgICAgICB9KSlcbiAgICAgIH07XG4gICAgfSxcbiAgICBoYW5kbGVSZXNwb25zZTogaGFuZGxlRmVlZFJlc3BvbnNlKClcbiAgfSk7XG59KCk7XG5cbnZhciBpbmRleCQ0ID0ge1xuICBfX3Byb3RvX186IG51bGwsXG4gIGxpc3Q6IGxpc3QkMixcbiAgZ2V0OiBnZXQkMyxcbiAgZ2V0UGhvdG9zOiBnZXRQaG90b3MkM1xufTtcblxudmFyIHRyYWNrTm9uSG90TGlua2VkUGhvdG9WaWV3ID0gZnVuY3Rpb24gdHJhY2tOb25Ib3RMaW5rZWRQaG90b1ZpZXcoX3JlZikge1xuICB2YXIgYXBwSWQgPSBfcmVmLmFwcElkO1xuICByZXR1cm4gZnVuY3Rpb24gKF9yZWYyKSB7XG4gICAgdmFyIHBob3RvSWQgPSBfcmVmMi5waG90b0lkO1xuICAgIHZhciBpZHMgPSAhQXJyYXkuaXNBcnJheShwaG90b0lkKSA/IFtwaG90b0lkXSA6IHBob3RvSWQ7XG5cbiAgICBpZiAoaWRzLmxlbmd0aCA+IDIwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBjYW5ub3QgdHJhY2sgbW9yZSB0aGFuIDIwIHBob3RvcyBhdCBvbmNlLiBQbGVhc2UgdHJ5IGFnYWluIHdpdGggZmV3ZXIgcGhvdG9zLicpO1xuICAgIH1cblxuICAgIHJldHVybiBmZXRjaChcInZpZXdzLnVuc3BsYXNoLmNvbS92P3Bob3RvX2lkPVwiICsgaWRzLmpvaW4oKSArIFwiJmFwcF9pZD1cIiArIGFwcElkKTtcbiAgfTtcbn07XG5cblxuXG52YXIgaW50ZXJuYWxzID0ge1xuICBfX3Byb3RvX186IG51bGwsXG4gIGNvbGxlY3Rpb25zOiBpbmRleCxcbiAgcGhvdG9zOiBpbmRleCQxLFxuICBzZWFyY2g6IGluZGV4JDIsXG4gIHVzZXJzOiBpbmRleCQzLFxuICB0b3BpY3M6IGluZGV4JDQsXG4gIHRyYWNrTm9uSG90TGlua2VkUGhvdG9WaWV3OiB0cmFja05vbkhvdExpbmtlZFBob3RvVmlld1xufTtcblxudmFyIExhbmd1YWdlO1xuXG4oZnVuY3Rpb24gKExhbmd1YWdlKSB7XG4gIExhbmd1YWdlW1wiQWZyaWthYW5zXCJdID0gXCJhZlwiO1xuICBMYW5ndWFnZVtcIkFtaGFyaWNcIl0gPSBcImFtXCI7XG4gIExhbmd1YWdlW1wiQXJhYmljXCJdID0gXCJhclwiO1xuICBMYW5ndWFnZVtcIkF6ZXJiYWlqYW5pXCJdID0gXCJhelwiO1xuICBMYW5ndWFnZVtcIkJlbGFydXNpYW5cIl0gPSBcImJlXCI7XG4gIExhbmd1YWdlW1wiQnVsZ2FyaWFuXCJdID0gXCJiZ1wiO1xuICBMYW5ndWFnZVtcIkJlbmdhbGlcIl0gPSBcImJuXCI7XG4gIExhbmd1YWdlW1wiQm9zbmlhblwiXSA9IFwiYnNcIjtcbiAgTGFuZ3VhZ2VbXCJDYXRhbGFuXCJdID0gXCJjYVwiO1xuICBMYW5ndWFnZVtcIkNlYnVhbm9cIl0gPSBcImNlYlwiO1xuICBMYW5ndWFnZVtcIkNvcnNpY2FuXCJdID0gXCJjb1wiO1xuICBMYW5ndWFnZVtcIkN6ZWNoXCJdID0gXCJjc1wiO1xuICBMYW5ndWFnZVtcIldlbHNoXCJdID0gXCJjeVwiO1xuICBMYW5ndWFnZVtcIkRhbmlzaFwiXSA9IFwiZGFcIjtcbiAgTGFuZ3VhZ2VbXCJHZXJtYW5cIl0gPSBcImRlXCI7XG4gIExhbmd1YWdlW1wiR3JlZWtcIl0gPSBcImVsXCI7XG4gIExhbmd1YWdlW1wiRW5nbGlzaFwiXSA9IFwiZW5cIjtcbiAgTGFuZ3VhZ2VbXCJFc3BlcmFudG9cIl0gPSBcImVvXCI7XG4gIExhbmd1YWdlW1wiU3BhbmlzaFwiXSA9IFwiZXNcIjtcbiAgTGFuZ3VhZ2VbXCJFc3RvbmlhblwiXSA9IFwiZXRcIjtcbiAgTGFuZ3VhZ2VbXCJCYXNxdWVcIl0gPSBcImV1XCI7XG4gIExhbmd1YWdlW1wiUGVyc2lhblwiXSA9IFwiZmFcIjtcbiAgTGFuZ3VhZ2VbXCJGaW5uaXNoXCJdID0gXCJmaVwiO1xuICBMYW5ndWFnZVtcIkZyZW5jaFwiXSA9IFwiZnJcIjtcbiAgTGFuZ3VhZ2VbXCJGcmlzaWFuXCJdID0gXCJmeVwiO1xuICBMYW5ndWFnZVtcIklyaXNoXCJdID0gXCJnYVwiO1xuICBMYW5ndWFnZVtcIlNjb3RzR2FlbGljXCJdID0gXCJnZFwiO1xuICBMYW5ndWFnZVtcIkdhbGljaWFuXCJdID0gXCJnbFwiO1xuICBMYW5ndWFnZVtcIkd1amFyYXRpXCJdID0gXCJndVwiO1xuICBMYW5ndWFnZVtcIkhhdXNhXCJdID0gXCJoYVwiO1xuICBMYW5ndWFnZVtcIkhhd2FpaWFuXCJdID0gXCJoYXdcIjtcbiAgTGFuZ3VhZ2VbXCJIaW5kaVwiXSA9IFwiaGlcIjtcbiAgTGFuZ3VhZ2VbXCJIbW9uZ1wiXSA9IFwiaG1uXCI7XG4gIExhbmd1YWdlW1wiQ3JvYXRpYW5cIl0gPSBcImhyXCI7XG4gIExhbmd1YWdlW1wiSGFpdGlhbkNyZW9sZVwiXSA9IFwiaHRcIjtcbiAgTGFuZ3VhZ2VbXCJIdW5nYXJpYW5cIl0gPSBcImh1XCI7XG4gIExhbmd1YWdlW1wiQXJtZW5pYW5cIl0gPSBcImh5XCI7XG4gIExhbmd1YWdlW1wiSW5kb25lc2lhblwiXSA9IFwiaWRcIjtcbiAgTGFuZ3VhZ2VbXCJJZ2JvXCJdID0gXCJpZ1wiO1xuICBMYW5ndWFnZVtcIkljZWxhbmRpY1wiXSA9IFwiaXNcIjtcbiAgTGFuZ3VhZ2VbXCJJdGFsaWFuXCJdID0gXCJpdFwiO1xuICBMYW5ndWFnZVtcIkhlYnJld1wiXSA9IFwiaXdcIjtcbiAgTGFuZ3VhZ2VbXCJKYXBhbmVzZVwiXSA9IFwiamFcIjtcbiAgTGFuZ3VhZ2VbXCJKYXZhbmVzZVwiXSA9IFwiandcIjtcbiAgTGFuZ3VhZ2VbXCJHZW9yZ2lhblwiXSA9IFwia2FcIjtcbiAgTGFuZ3VhZ2VbXCJLYXpha2hcIl0gPSBcImtrXCI7XG4gIExhbmd1YWdlW1wiS2htZXJcIl0gPSBcImttXCI7XG4gIExhbmd1YWdlW1wiS2FubmFkYVwiXSA9IFwia25cIjtcbiAgTGFuZ3VhZ2VbXCJLb3JlYW5cIl0gPSBcImtvXCI7XG4gIExhbmd1YWdlW1wiS3VyZGlzaFwiXSA9IFwia3VcIjtcbiAgTGFuZ3VhZ2VbXCJLeXJneXpcIl0gPSBcImt5XCI7XG4gIExhbmd1YWdlW1wiTGF0aW5cIl0gPSBcImxhXCI7XG4gIExhbmd1YWdlW1wiTHV4ZW1ib3VyZ2lzaFwiXSA9IFwibGJcIjtcbiAgTGFuZ3VhZ2VbXCJMYW9cIl0gPSBcImxvXCI7XG4gIExhbmd1YWdlW1wiTGl0aHVhbmlhblwiXSA9IFwibHRcIjtcbiAgTGFuZ3VhZ2VbXCJMYXR2aWFuXCJdID0gXCJsdlwiO1xuICBMYW5ndWFnZVtcIk1hbGFnYXN5XCJdID0gXCJtZ1wiO1xuICBMYW5ndWFnZVtcIk1hb3JpXCJdID0gXCJtaVwiO1xuICBMYW5ndWFnZVtcIk1hY2Vkb25pYW5cIl0gPSBcIm1rXCI7XG4gIExhbmd1YWdlW1wiTWFsYXlhbGFtXCJdID0gXCJtbFwiO1xuICBMYW5ndWFnZVtcIk1vbmdvbGlhblwiXSA9IFwibW5cIjtcbiAgTGFuZ3VhZ2VbXCJNYXJhdGhpXCJdID0gXCJtclwiO1xuICBMYW5ndWFnZVtcIk1hbGF5XCJdID0gXCJtc1wiO1xuICBMYW5ndWFnZVtcIk1hbHRlc2VcIl0gPSBcIm10XCI7XG4gIExhbmd1YWdlW1wiTXlhbm1hclwiXSA9IFwibXlcIjtcbiAgTGFuZ3VhZ2VbXCJOZXBhbGlcIl0gPSBcIm5lXCI7XG4gIExhbmd1YWdlW1wiRHV0Y2hcIl0gPSBcIm5sXCI7XG4gIExhbmd1YWdlW1wiTm9yd2VnaWFuXCJdID0gXCJub1wiO1xuICBMYW5ndWFnZVtcIk55YW5qYVwiXSA9IFwibnlcIjtcbiAgTGFuZ3VhZ2VbXCJPcml5YVwiXSA9IFwib3JcIjtcbiAgTGFuZ3VhZ2VbXCJQdW5qYWJpXCJdID0gXCJwYVwiO1xuICBMYW5ndWFnZVtcIlBvbGlzaFwiXSA9IFwicGxcIjtcbiAgTGFuZ3VhZ2VbXCJQYXNodG9cIl0gPSBcInBzXCI7XG4gIExhbmd1YWdlW1wiUG9ydHVndWVzZVwiXSA9IFwicHRcIjtcbiAgTGFuZ3VhZ2VbXCJSb21hbmlhblwiXSA9IFwicm9cIjtcbiAgTGFuZ3VhZ2VbXCJSdXNzaWFuXCJdID0gXCJydVwiO1xuICBMYW5ndWFnZVtcIktpbnlhcndhbmRhXCJdID0gXCJyd1wiO1xuICBMYW5ndWFnZVtcIlNpbmRoaVwiXSA9IFwic2RcIjtcbiAgTGFuZ3VhZ2VbXCJTaW5oYWxhXCJdID0gXCJzaVwiO1xuICBMYW5ndWFnZVtcIlNsb3Zha1wiXSA9IFwic2tcIjtcbiAgTGFuZ3VhZ2VbXCJTbG92ZW5pYW5cIl0gPSBcInNsXCI7XG4gIExhbmd1YWdlW1wiU2Ftb2FuXCJdID0gXCJzbVwiO1xuICBMYW5ndWFnZVtcIlNob25hXCJdID0gXCJzblwiO1xuICBMYW5ndWFnZVtcIlNvbWFsaVwiXSA9IFwic29cIjtcbiAgTGFuZ3VhZ2VbXCJBbGJhbmlhblwiXSA9IFwic3FcIjtcbiAgTGFuZ3VhZ2VbXCJTZXJiaWFuXCJdID0gXCJzclwiO1xuICBMYW5ndWFnZVtcIlNlc290aG9cIl0gPSBcInN0XCI7XG4gIExhbmd1YWdlW1wiU3VuZGFuZXNlXCJdID0gXCJzdVwiO1xuICBMYW5ndWFnZVtcIlN3ZWRpc2hcIl0gPSBcInN2XCI7XG4gIExhbmd1YWdlW1wiU3dhaGlsaVwiXSA9IFwic3dcIjtcbiAgTGFuZ3VhZ2VbXCJUYW1pbFwiXSA9IFwidGFcIjtcbiAgTGFuZ3VhZ2VbXCJUZWx1Z3VcIl0gPSBcInRlXCI7XG4gIExhbmd1YWdlW1wiVGFqaWtcIl0gPSBcInRnXCI7XG4gIExhbmd1YWdlW1wiVGhhaVwiXSA9IFwidGhcIjtcbiAgTGFuZ3VhZ2VbXCJUdXJrbWVuXCJdID0gXCJ0a1wiO1xuICBMYW5ndWFnZVtcIkZpbGlwaW5vXCJdID0gXCJ0bFwiO1xuICBMYW5ndWFnZVtcIlR1cmtpc2hcIl0gPSBcInRyXCI7XG4gIExhbmd1YWdlW1wiVGF0YXJcIl0gPSBcInR0XCI7XG4gIExhbmd1YWdlW1wiVWlnaHVyXCJdID0gXCJ1Z1wiO1xuICBMYW5ndWFnZVtcIlVrcmFpbmlhblwiXSA9IFwidWtcIjtcbiAgTGFuZ3VhZ2VbXCJVcmR1XCJdID0gXCJ1clwiO1xuICBMYW5ndWFnZVtcIlV6YmVrXCJdID0gXCJ1elwiO1xuICBMYW5ndWFnZVtcIlZpZXRuYW1lc2VcIl0gPSBcInZpXCI7XG4gIExhbmd1YWdlW1wiWGhvc2FcIl0gPSBcInhoXCI7XG4gIExhbmd1YWdlW1wiWWlkZGlzaFwiXSA9IFwieWlcIjtcbiAgTGFuZ3VhZ2VbXCJZb3J1YmFcIl0gPSBcInlvXCI7XG4gIExhbmd1YWdlW1wiQ2hpbmVzZVNpbXBsaWZpZWRcIl0gPSBcInpoXCI7XG4gIExhbmd1YWdlW1wiQ2hpbmVzZVRyYWRpdGlvbmFsXCJdID0gXCJ6aC1UV1wiO1xuICBMYW5ndWFnZVtcIlp1bHVcIl0gPSBcInp1XCI7XG59KShMYW5ndWFnZSB8fCAoTGFuZ3VhZ2UgPSB7fSkpO1xuXG52YXIgT3JkZXJCeTtcblxuKGZ1bmN0aW9uIChPcmRlckJ5KSB7XG4gIE9yZGVyQnlbXCJMQVRFU1RcIl0gPSBcImxhdGVzdFwiO1xuICBPcmRlckJ5W1wiUE9QVUxBUlwiXSA9IFwicG9wdWxhclwiO1xuICBPcmRlckJ5W1wiVklFV1NcIl0gPSBcInZpZXdzXCI7XG4gIE9yZGVyQnlbXCJET1dOTE9BRFNcIl0gPSBcImRvd25sb2Fkc1wiO1xuICBPcmRlckJ5W1wiT0xERVNUXCJdID0gXCJvbGRlc3RcIjtcbn0pKE9yZGVyQnkgfHwgKE9yZGVyQnkgPSB7fSkpO1xuXG52YXIgY3JlYXRlQXBpID0gLyojX19QVVJFX18qL2Zsb3coaW5pdE1ha2VSZXF1ZXN0LCBmdW5jdGlvbiAobWFrZVJlcXVlc3QpIHtcbiAgcmV0dXJuIHtcbiAgICBwaG90b3M6IHtcbiAgICAgIGdldDogbWFrZVJlcXVlc3QoZ2V0JDEpLFxuICAgICAgbGlzdDogbWFrZVJlcXVlc3QobGlzdCQxKSxcbiAgICAgIGdldFN0YXRzOiBtYWtlUmVxdWVzdChnZXRTdGF0cyksXG4gICAgICBnZXRSYW5kb206IG1ha2VSZXF1ZXN0KGdldFJhbmRvbSksXG4gICAgICB0cmFja0Rvd25sb2FkOiBtYWtlUmVxdWVzdCh0cmFja0Rvd25sb2FkKVxuICAgIH0sXG4gICAgdXNlcnM6IHtcbiAgICAgIGdldFBob3RvczogbWFrZVJlcXVlc3QoZ2V0UGhvdG9zJDIpLFxuICAgICAgZ2V0Q29sbGVjdGlvbnM6IG1ha2VSZXF1ZXN0KGdldENvbGxlY3Rpb25zJDIpLFxuICAgICAgZ2V0TGlrZXM6IG1ha2VSZXF1ZXN0KGdldExpa2VzKSxcbiAgICAgIGdldDogbWFrZVJlcXVlc3QoZ2V0JDIpXG4gICAgfSxcbiAgICBzZWFyY2g6IHtcbiAgICAgIGdldENvbGxlY3Rpb25zOiBtYWtlUmVxdWVzdChnZXRDb2xsZWN0aW9ucyQxKSxcbiAgICAgIGdldFBob3RvczogbWFrZVJlcXVlc3QoZ2V0UGhvdG9zJDEpLFxuICAgICAgZ2V0VXNlcnM6IG1ha2VSZXF1ZXN0KGdldFVzZXJzKVxuICAgIH0sXG4gICAgY29sbGVjdGlvbnM6IHtcbiAgICAgIGdldFBob3RvczogbWFrZVJlcXVlc3QoZ2V0UGhvdG9zKSxcbiAgICAgIGdldDogbWFrZVJlcXVlc3QoZ2V0KSxcbiAgICAgIGxpc3Q6IG1ha2VSZXF1ZXN0KGxpc3QpLFxuICAgICAgZ2V0UmVsYXRlZDogbWFrZVJlcXVlc3QoZ2V0UmVsYXRlZClcbiAgICB9LFxuICAgIHRvcGljczoge1xuICAgICAgbGlzdDogbWFrZVJlcXVlc3QobGlzdCQyKSxcbiAgICAgIGdldDogbWFrZVJlcXVlc3QoZ2V0JDMpLFxuICAgICAgZ2V0UGhvdG9zOiBtYWtlUmVxdWVzdChnZXRQaG90b3MkMylcbiAgICB9XG4gIH07XG59KTtcblxuZXhwb3J0IHsgTGFuZ3VhZ2UsIE9yZGVyQnksIGludGVybmFscyBhcyBfaW50ZXJuYWxzLCBjcmVhdGVBcGkgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXVuc3BsYXNoLWpzLmVzbS5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiTklMXCIsIHtcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgcmV0dXJuIF9uaWwuZGVmYXVsdDtcbiAgfVxufSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJwYXJzZVwiLCB7XG4gIGVudW1lcmFibGU6IHRydWUsXG4gIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgIHJldHVybiBfcGFyc2UuZGVmYXVsdDtcbiAgfVxufSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJzdHJpbmdpZnlcIiwge1xuICBlbnVtZXJhYmxlOiB0cnVlLFxuICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICByZXR1cm4gX3N0cmluZ2lmeS5kZWZhdWx0O1xuICB9XG59KTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcInYxXCIsIHtcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgcmV0dXJuIF92LmRlZmF1bHQ7XG4gIH1cbn0pO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwidjNcIiwge1xuICBlbnVtZXJhYmxlOiB0cnVlLFxuICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICByZXR1cm4gX3YyLmRlZmF1bHQ7XG4gIH1cbn0pO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwidjRcIiwge1xuICBlbnVtZXJhYmxlOiB0cnVlLFxuICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICByZXR1cm4gX3YzLmRlZmF1bHQ7XG4gIH1cbn0pO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwidjVcIiwge1xuICBlbnVtZXJhYmxlOiB0cnVlLFxuICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICByZXR1cm4gX3Y0LmRlZmF1bHQ7XG4gIH1cbn0pO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwidmFsaWRhdGVcIiwge1xuICBlbnVtZXJhYmxlOiB0cnVlLFxuICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICByZXR1cm4gX3ZhbGlkYXRlLmRlZmF1bHQ7XG4gIH1cbn0pO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwidmVyc2lvblwiLCB7XG4gIGVudW1lcmFibGU6IHRydWUsXG4gIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgIHJldHVybiBfdmVyc2lvbi5kZWZhdWx0O1xuICB9XG59KTtcblxudmFyIF92ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi92MS5qc1wiKSk7XG5cbnZhciBfdjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL3YzLmpzXCIpKTtcblxudmFyIF92MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vdjQuanNcIikpO1xuXG52YXIgX3Y0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi92NS5qc1wiKSk7XG5cbnZhciBfbmlsID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9uaWwuanNcIikpO1xuXG52YXIgX3ZlcnNpb24gPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL3ZlcnNpb24uanNcIikpO1xuXG52YXIgX3ZhbGlkYXRlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi92YWxpZGF0ZS5qc1wiKSk7XG5cbnZhciBfc3RyaW5naWZ5ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9zdHJpbmdpZnkuanNcIikpO1xuXG52YXIgX3BhcnNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9wYXJzZS5qc1wiKSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbi8qXG4gKiBCcm93c2VyLWNvbXBhdGlibGUgSmF2YVNjcmlwdCBNRDVcbiAqXG4gKiBNb2RpZmljYXRpb24gb2YgSmF2YVNjcmlwdCBNRDVcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ibHVlaW1wL0phdmFTY3JpcHQtTUQ1XG4gKlxuICogQ29weXJpZ2h0IDIwMTEsIFNlYmFzdGlhbiBUc2NoYW5cbiAqIGh0dHBzOi8vYmx1ZWltcC5uZXRcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2U6XG4gKiBodHRwczovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL01JVFxuICpcbiAqIEJhc2VkIG9uXG4gKiBBIEphdmFTY3JpcHQgaW1wbGVtZW50YXRpb24gb2YgdGhlIFJTQSBEYXRhIFNlY3VyaXR5LCBJbmMuIE1ENSBNZXNzYWdlXG4gKiBEaWdlc3QgQWxnb3JpdGhtLCBhcyBkZWZpbmVkIGluIFJGQyAxMzIxLlxuICogVmVyc2lvbiAyLjIgQ29weXJpZ2h0IChDKSBQYXVsIEpvaG5zdG9uIDE5OTkgLSAyMDA5XG4gKiBPdGhlciBjb250cmlidXRvcnM6IEdyZWcgSG9sdCwgQW5kcmV3IEtlcGVydCwgWWRuYXIsIExvc3RpbmV0XG4gKiBEaXN0cmlidXRlZCB1bmRlciB0aGUgQlNEIExpY2Vuc2VcbiAqIFNlZSBodHRwOi8vcGFqaG9tZS5vcmcudWsvY3J5cHQvbWQ1IGZvciBtb3JlIGluZm8uXG4gKi9cbmZ1bmN0aW9uIG1kNShieXRlcykge1xuICBpZiAodHlwZW9mIGJ5dGVzID09PSAnc3RyaW5nJykge1xuICAgIGNvbnN0IG1zZyA9IHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChieXRlcykpOyAvLyBVVEY4IGVzY2FwZVxuXG4gICAgYnl0ZXMgPSBuZXcgVWludDhBcnJheShtc2cubGVuZ3RoKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbXNnLmxlbmd0aDsgKytpKSB7XG4gICAgICBieXRlc1tpXSA9IG1zZy5jaGFyQ29kZUF0KGkpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBtZDVUb0hleEVuY29kZWRBcnJheSh3b3Jkc1RvTWQ1KGJ5dGVzVG9Xb3JkcyhieXRlcyksIGJ5dGVzLmxlbmd0aCAqIDgpKTtcbn1cbi8qXG4gKiBDb252ZXJ0IGFuIGFycmF5IG9mIGxpdHRsZS1lbmRpYW4gd29yZHMgdG8gYW4gYXJyYXkgb2YgYnl0ZXNcbiAqL1xuXG5cbmZ1bmN0aW9uIG1kNVRvSGV4RW5jb2RlZEFycmF5KGlucHV0KSB7XG4gIGNvbnN0IG91dHB1dCA9IFtdO1xuICBjb25zdCBsZW5ndGgzMiA9IGlucHV0Lmxlbmd0aCAqIDMyO1xuICBjb25zdCBoZXhUYWIgPSAnMDEyMzQ1Njc4OWFiY2RlZic7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGgzMjsgaSArPSA4KSB7XG4gICAgY29uc3QgeCA9IGlucHV0W2kgPj4gNV0gPj4+IGkgJSAzMiAmIDB4ZmY7XG4gICAgY29uc3QgaGV4ID0gcGFyc2VJbnQoaGV4VGFiLmNoYXJBdCh4ID4+PiA0ICYgMHgwZikgKyBoZXhUYWIuY2hhckF0KHggJiAweDBmKSwgMTYpO1xuICAgIG91dHB1dC5wdXNoKGhleCk7XG4gIH1cblxuICByZXR1cm4gb3V0cHV0O1xufVxuLyoqXG4gKiBDYWxjdWxhdGUgb3V0cHV0IGxlbmd0aCB3aXRoIHBhZGRpbmcgYW5kIGJpdCBsZW5ndGhcbiAqL1xuXG5cbmZ1bmN0aW9uIGdldE91dHB1dExlbmd0aChpbnB1dExlbmd0aDgpIHtcbiAgcmV0dXJuIChpbnB1dExlbmd0aDggKyA2NCA+Pj4gOSA8PCA0KSArIDE0ICsgMTtcbn1cbi8qXG4gKiBDYWxjdWxhdGUgdGhlIE1ENSBvZiBhbiBhcnJheSBvZiBsaXR0bGUtZW5kaWFuIHdvcmRzLCBhbmQgYSBiaXQgbGVuZ3RoLlxuICovXG5cblxuZnVuY3Rpb24gd29yZHNUb01kNSh4LCBsZW4pIHtcbiAgLyogYXBwZW5kIHBhZGRpbmcgKi9cbiAgeFtsZW4gPj4gNV0gfD0gMHg4MCA8PCBsZW4gJSAzMjtcbiAgeFtnZXRPdXRwdXRMZW5ndGgobGVuKSAtIDFdID0gbGVuO1xuICBsZXQgYSA9IDE3MzI1ODQxOTM7XG4gIGxldCBiID0gLTI3MTczMzg3OTtcbiAgbGV0IGMgPSAtMTczMjU4NDE5NDtcbiAgbGV0IGQgPSAyNzE3MzM4Nzg7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCB4Lmxlbmd0aDsgaSArPSAxNikge1xuICAgIGNvbnN0IG9sZGEgPSBhO1xuICAgIGNvbnN0IG9sZGIgPSBiO1xuICAgIGNvbnN0IG9sZGMgPSBjO1xuICAgIGNvbnN0IG9sZGQgPSBkO1xuICAgIGEgPSBtZDVmZihhLCBiLCBjLCBkLCB4W2ldLCA3LCAtNjgwODc2OTM2KTtcbiAgICBkID0gbWQ1ZmYoZCwgYSwgYiwgYywgeFtpICsgMV0sIDEyLCAtMzg5NTY0NTg2KTtcbiAgICBjID0gbWQ1ZmYoYywgZCwgYSwgYiwgeFtpICsgMl0sIDE3LCA2MDYxMDU4MTkpO1xuICAgIGIgPSBtZDVmZihiLCBjLCBkLCBhLCB4W2kgKyAzXSwgMjIsIC0xMDQ0NTI1MzMwKTtcbiAgICBhID0gbWQ1ZmYoYSwgYiwgYywgZCwgeFtpICsgNF0sIDcsIC0xNzY0MTg4OTcpO1xuICAgIGQgPSBtZDVmZihkLCBhLCBiLCBjLCB4W2kgKyA1XSwgMTIsIDEyMDAwODA0MjYpO1xuICAgIGMgPSBtZDVmZihjLCBkLCBhLCBiLCB4W2kgKyA2XSwgMTcsIC0xNDczMjMxMzQxKTtcbiAgICBiID0gbWQ1ZmYoYiwgYywgZCwgYSwgeFtpICsgN10sIDIyLCAtNDU3MDU5ODMpO1xuICAgIGEgPSBtZDVmZihhLCBiLCBjLCBkLCB4W2kgKyA4XSwgNywgMTc3MDAzNTQxNik7XG4gICAgZCA9IG1kNWZmKGQsIGEsIGIsIGMsIHhbaSArIDldLCAxMiwgLTE5NTg0MTQ0MTcpO1xuICAgIGMgPSBtZDVmZihjLCBkLCBhLCBiLCB4W2kgKyAxMF0sIDE3LCAtNDIwNjMpO1xuICAgIGIgPSBtZDVmZihiLCBjLCBkLCBhLCB4W2kgKyAxMV0sIDIyLCAtMTk5MDQwNDE2Mik7XG4gICAgYSA9IG1kNWZmKGEsIGIsIGMsIGQsIHhbaSArIDEyXSwgNywgMTgwNDYwMzY4Mik7XG4gICAgZCA9IG1kNWZmKGQsIGEsIGIsIGMsIHhbaSArIDEzXSwgMTIsIC00MDM0MTEwMSk7XG4gICAgYyA9IG1kNWZmKGMsIGQsIGEsIGIsIHhbaSArIDE0XSwgMTcsIC0xNTAyMDAyMjkwKTtcbiAgICBiID0gbWQ1ZmYoYiwgYywgZCwgYSwgeFtpICsgMTVdLCAyMiwgMTIzNjUzNTMyOSk7XG4gICAgYSA9IG1kNWdnKGEsIGIsIGMsIGQsIHhbaSArIDFdLCA1LCAtMTY1Nzk2NTEwKTtcbiAgICBkID0gbWQ1Z2coZCwgYSwgYiwgYywgeFtpICsgNl0sIDksIC0xMDY5NTAxNjMyKTtcbiAgICBjID0gbWQ1Z2coYywgZCwgYSwgYiwgeFtpICsgMTFdLCAxNCwgNjQzNzE3NzEzKTtcbiAgICBiID0gbWQ1Z2coYiwgYywgZCwgYSwgeFtpXSwgMjAsIC0zNzM4OTczMDIpO1xuICAgIGEgPSBtZDVnZyhhLCBiLCBjLCBkLCB4W2kgKyA1XSwgNSwgLTcwMTU1ODY5MSk7XG4gICAgZCA9IG1kNWdnKGQsIGEsIGIsIGMsIHhbaSArIDEwXSwgOSwgMzgwMTYwODMpO1xuICAgIGMgPSBtZDVnZyhjLCBkLCBhLCBiLCB4W2kgKyAxNV0sIDE0LCAtNjYwNDc4MzM1KTtcbiAgICBiID0gbWQ1Z2coYiwgYywgZCwgYSwgeFtpICsgNF0sIDIwLCAtNDA1NTM3ODQ4KTtcbiAgICBhID0gbWQ1Z2coYSwgYiwgYywgZCwgeFtpICsgOV0sIDUsIDU2ODQ0NjQzOCk7XG4gICAgZCA9IG1kNWdnKGQsIGEsIGIsIGMsIHhbaSArIDE0XSwgOSwgLTEwMTk4MDM2OTApO1xuICAgIGMgPSBtZDVnZyhjLCBkLCBhLCBiLCB4W2kgKyAzXSwgMTQsIC0xODczNjM5NjEpO1xuICAgIGIgPSBtZDVnZyhiLCBjLCBkLCBhLCB4W2kgKyA4XSwgMjAsIDExNjM1MzE1MDEpO1xuICAgIGEgPSBtZDVnZyhhLCBiLCBjLCBkLCB4W2kgKyAxM10sIDUsIC0xNDQ0NjgxNDY3KTtcbiAgICBkID0gbWQ1Z2coZCwgYSwgYiwgYywgeFtpICsgMl0sIDksIC01MTQwMzc4NCk7XG4gICAgYyA9IG1kNWdnKGMsIGQsIGEsIGIsIHhbaSArIDddLCAxNCwgMTczNTMyODQ3Myk7XG4gICAgYiA9IG1kNWdnKGIsIGMsIGQsIGEsIHhbaSArIDEyXSwgMjAsIC0xOTI2NjA3NzM0KTtcbiAgICBhID0gbWQ1aGgoYSwgYiwgYywgZCwgeFtpICsgNV0sIDQsIC0zNzg1NTgpO1xuICAgIGQgPSBtZDVoaChkLCBhLCBiLCBjLCB4W2kgKyA4XSwgMTEsIC0yMDIyNTc0NDYzKTtcbiAgICBjID0gbWQ1aGgoYywgZCwgYSwgYiwgeFtpICsgMTFdLCAxNiwgMTgzOTAzMDU2Mik7XG4gICAgYiA9IG1kNWhoKGIsIGMsIGQsIGEsIHhbaSArIDE0XSwgMjMsIC0zNTMwOTU1Nik7XG4gICAgYSA9IG1kNWhoKGEsIGIsIGMsIGQsIHhbaSArIDFdLCA0LCAtMTUzMDk5MjA2MCk7XG4gICAgZCA9IG1kNWhoKGQsIGEsIGIsIGMsIHhbaSArIDRdLCAxMSwgMTI3Mjg5MzM1Myk7XG4gICAgYyA9IG1kNWhoKGMsIGQsIGEsIGIsIHhbaSArIDddLCAxNiwgLTE1NTQ5NzYzMik7XG4gICAgYiA9IG1kNWhoKGIsIGMsIGQsIGEsIHhbaSArIDEwXSwgMjMsIC0xMDk0NzMwNjQwKTtcbiAgICBhID0gbWQ1aGgoYSwgYiwgYywgZCwgeFtpICsgMTNdLCA0LCA2ODEyNzkxNzQpO1xuICAgIGQgPSBtZDVoaChkLCBhLCBiLCBjLCB4W2ldLCAxMSwgLTM1ODUzNzIyMik7XG4gICAgYyA9IG1kNWhoKGMsIGQsIGEsIGIsIHhbaSArIDNdLCAxNiwgLTcyMjUyMTk3OSk7XG4gICAgYiA9IG1kNWhoKGIsIGMsIGQsIGEsIHhbaSArIDZdLCAyMywgNzYwMjkxODkpO1xuICAgIGEgPSBtZDVoaChhLCBiLCBjLCBkLCB4W2kgKyA5XSwgNCwgLTY0MDM2NDQ4Nyk7XG4gICAgZCA9IG1kNWhoKGQsIGEsIGIsIGMsIHhbaSArIDEyXSwgMTEsIC00MjE4MTU4MzUpO1xuICAgIGMgPSBtZDVoaChjLCBkLCBhLCBiLCB4W2kgKyAxNV0sIDE2LCA1MzA3NDI1MjApO1xuICAgIGIgPSBtZDVoaChiLCBjLCBkLCBhLCB4W2kgKyAyXSwgMjMsIC05OTUzMzg2NTEpO1xuICAgIGEgPSBtZDVpaShhLCBiLCBjLCBkLCB4W2ldLCA2LCAtMTk4NjMwODQ0KTtcbiAgICBkID0gbWQ1aWkoZCwgYSwgYiwgYywgeFtpICsgN10sIDEwLCAxMTI2ODkxNDE1KTtcbiAgICBjID0gbWQ1aWkoYywgZCwgYSwgYiwgeFtpICsgMTRdLCAxNSwgLTE0MTYzNTQ5MDUpO1xuICAgIGIgPSBtZDVpaShiLCBjLCBkLCBhLCB4W2kgKyA1XSwgMjEsIC01NzQzNDA1NSk7XG4gICAgYSA9IG1kNWlpKGEsIGIsIGMsIGQsIHhbaSArIDEyXSwgNiwgMTcwMDQ4NTU3MSk7XG4gICAgZCA9IG1kNWlpKGQsIGEsIGIsIGMsIHhbaSArIDNdLCAxMCwgLTE4OTQ5ODY2MDYpO1xuICAgIGMgPSBtZDVpaShjLCBkLCBhLCBiLCB4W2kgKyAxMF0sIDE1LCAtMTA1MTUyMyk7XG4gICAgYiA9IG1kNWlpKGIsIGMsIGQsIGEsIHhbaSArIDFdLCAyMSwgLTIwNTQ5MjI3OTkpO1xuICAgIGEgPSBtZDVpaShhLCBiLCBjLCBkLCB4W2kgKyA4XSwgNiwgMTg3MzMxMzM1OSk7XG4gICAgZCA9IG1kNWlpKGQsIGEsIGIsIGMsIHhbaSArIDE1XSwgMTAsIC0zMDYxMTc0NCk7XG4gICAgYyA9IG1kNWlpKGMsIGQsIGEsIGIsIHhbaSArIDZdLCAxNSwgLTE1NjAxOTgzODApO1xuICAgIGIgPSBtZDVpaShiLCBjLCBkLCBhLCB4W2kgKyAxM10sIDIxLCAxMzA5MTUxNjQ5KTtcbiAgICBhID0gbWQ1aWkoYSwgYiwgYywgZCwgeFtpICsgNF0sIDYsIC0xNDU1MjMwNzApO1xuICAgIGQgPSBtZDVpaShkLCBhLCBiLCBjLCB4W2kgKyAxMV0sIDEwLCAtMTEyMDIxMDM3OSk7XG4gICAgYyA9IG1kNWlpKGMsIGQsIGEsIGIsIHhbaSArIDJdLCAxNSwgNzE4Nzg3MjU5KTtcbiAgICBiID0gbWQ1aWkoYiwgYywgZCwgYSwgeFtpICsgOV0sIDIxLCAtMzQzNDg1NTUxKTtcbiAgICBhID0gc2FmZUFkZChhLCBvbGRhKTtcbiAgICBiID0gc2FmZUFkZChiLCBvbGRiKTtcbiAgICBjID0gc2FmZUFkZChjLCBvbGRjKTtcbiAgICBkID0gc2FmZUFkZChkLCBvbGRkKTtcbiAgfVxuXG4gIHJldHVybiBbYSwgYiwgYywgZF07XG59XG4vKlxuICogQ29udmVydCBhbiBhcnJheSBieXRlcyB0byBhbiBhcnJheSBvZiBsaXR0bGUtZW5kaWFuIHdvcmRzXG4gKiBDaGFyYWN0ZXJzID4yNTUgaGF2ZSB0aGVpciBoaWdoLWJ5dGUgc2lsZW50bHkgaWdub3JlZC5cbiAqL1xuXG5cbmZ1bmN0aW9uIGJ5dGVzVG9Xb3JkcyhpbnB1dCkge1xuICBpZiAoaW5wdXQubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgY29uc3QgbGVuZ3RoOCA9IGlucHV0Lmxlbmd0aCAqIDg7XG4gIGNvbnN0IG91dHB1dCA9IG5ldyBVaW50MzJBcnJheShnZXRPdXRwdXRMZW5ndGgobGVuZ3RoOCkpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoODsgaSArPSA4KSB7XG4gICAgb3V0cHV0W2kgPj4gNV0gfD0gKGlucHV0W2kgLyA4XSAmIDB4ZmYpIDw8IGkgJSAzMjtcbiAgfVxuXG4gIHJldHVybiBvdXRwdXQ7XG59XG4vKlxuICogQWRkIGludGVnZXJzLCB3cmFwcGluZyBhdCAyXjMyLiBUaGlzIHVzZXMgMTYtYml0IG9wZXJhdGlvbnMgaW50ZXJuYWxseVxuICogdG8gd29yayBhcm91bmQgYnVncyBpbiBzb21lIEpTIGludGVycHJldGVycy5cbiAqL1xuXG5cbmZ1bmN0aW9uIHNhZmVBZGQoeCwgeSkge1xuICBjb25zdCBsc3cgPSAoeCAmIDB4ZmZmZikgKyAoeSAmIDB4ZmZmZik7XG4gIGNvbnN0IG1zdyA9ICh4ID4+IDE2KSArICh5ID4+IDE2KSArIChsc3cgPj4gMTYpO1xuICByZXR1cm4gbXN3IDw8IDE2IHwgbHN3ICYgMHhmZmZmO1xufVxuLypcbiAqIEJpdHdpc2Ugcm90YXRlIGEgMzItYml0IG51bWJlciB0byB0aGUgbGVmdC5cbiAqL1xuXG5cbmZ1bmN0aW9uIGJpdFJvdGF0ZUxlZnQobnVtLCBjbnQpIHtcbiAgcmV0dXJuIG51bSA8PCBjbnQgfCBudW0gPj4+IDMyIC0gY250O1xufVxuLypcbiAqIFRoZXNlIGZ1bmN0aW9ucyBpbXBsZW1lbnQgdGhlIGZvdXIgYmFzaWMgb3BlcmF0aW9ucyB0aGUgYWxnb3JpdGhtIHVzZXMuXG4gKi9cblxuXG5mdW5jdGlvbiBtZDVjbW4ocSwgYSwgYiwgeCwgcywgdCkge1xuICByZXR1cm4gc2FmZUFkZChiaXRSb3RhdGVMZWZ0KHNhZmVBZGQoc2FmZUFkZChhLCBxKSwgc2FmZUFkZCh4LCB0KSksIHMpLCBiKTtcbn1cblxuZnVuY3Rpb24gbWQ1ZmYoYSwgYiwgYywgZCwgeCwgcywgdCkge1xuICByZXR1cm4gbWQ1Y21uKGIgJiBjIHwgfmIgJiBkLCBhLCBiLCB4LCBzLCB0KTtcbn1cblxuZnVuY3Rpb24gbWQ1Z2coYSwgYiwgYywgZCwgeCwgcywgdCkge1xuICByZXR1cm4gbWQ1Y21uKGIgJiBkIHwgYyAmIH5kLCBhLCBiLCB4LCBzLCB0KTtcbn1cblxuZnVuY3Rpb24gbWQ1aGgoYSwgYiwgYywgZCwgeCwgcywgdCkge1xuICByZXR1cm4gbWQ1Y21uKGIgXiBjIF4gZCwgYSwgYiwgeCwgcywgdCk7XG59XG5cbmZ1bmN0aW9uIG1kNWlpKGEsIGIsIGMsIGQsIHgsIHMsIHQpIHtcbiAgcmV0dXJuIG1kNWNtbihjIF4gKGIgfCB+ZCksIGEsIGIsIHgsIHMsIHQpO1xufVxuXG52YXIgX2RlZmF1bHQgPSBtZDU7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDsiLCJcInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbmNvbnN0IHJhbmRvbVVVSUQgPSB0eXBlb2YgY3J5cHRvICE9PSAndW5kZWZpbmVkJyAmJiBjcnlwdG8ucmFuZG9tVVVJRCAmJiBjcnlwdG8ucmFuZG9tVVVJRC5iaW5kKGNyeXB0byk7XG52YXIgX2RlZmF1bHQgPSB7XG4gIHJhbmRvbVVVSURcbn07XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDsiLCJcInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBfZGVmYXVsdCA9ICcwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAnO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfdmFsaWRhdGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL3ZhbGlkYXRlLmpzXCIpKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gcGFyc2UodXVpZCkge1xuICBpZiAoISgwLCBfdmFsaWRhdGUuZGVmYXVsdCkodXVpZCkpIHtcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ0ludmFsaWQgVVVJRCcpO1xuICB9XG5cbiAgbGV0IHY7XG4gIGNvbnN0IGFyciA9IG5ldyBVaW50OEFycmF5KDE2KTsgLy8gUGFyc2UgIyMjIyMjIyMtLi4uLi0uLi4uLS4uLi4tLi4uLi4uLi4uLi4uXG5cbiAgYXJyWzBdID0gKHYgPSBwYXJzZUludCh1dWlkLnNsaWNlKDAsIDgpLCAxNikpID4+PiAyNDtcbiAgYXJyWzFdID0gdiA+Pj4gMTYgJiAweGZmO1xuICBhcnJbMl0gPSB2ID4+PiA4ICYgMHhmZjtcbiAgYXJyWzNdID0gdiAmIDB4ZmY7IC8vIFBhcnNlIC4uLi4uLi4uLSMjIyMtLi4uLi0uLi4uLS4uLi4uLi4uLi4uLlxuXG4gIGFycls0XSA9ICh2ID0gcGFyc2VJbnQodXVpZC5zbGljZSg5LCAxMyksIDE2KSkgPj4+IDg7XG4gIGFycls1XSA9IHYgJiAweGZmOyAvLyBQYXJzZSAuLi4uLi4uLi0uLi4uLSMjIyMtLi4uLi0uLi4uLi4uLi4uLi5cblxuICBhcnJbNl0gPSAodiA9IHBhcnNlSW50KHV1aWQuc2xpY2UoMTQsIDE4KSwgMTYpKSA+Pj4gODtcbiAgYXJyWzddID0gdiAmIDB4ZmY7IC8vIFBhcnNlIC4uLi4uLi4uLS4uLi4tLi4uLi0jIyMjLS4uLi4uLi4uLi4uLlxuXG4gIGFycls4XSA9ICh2ID0gcGFyc2VJbnQodXVpZC5zbGljZSgxOSwgMjMpLCAxNikpID4+PiA4O1xuICBhcnJbOV0gPSB2ICYgMHhmZjsgLy8gUGFyc2UgLi4uLi4uLi4tLi4uLi0uLi4uLS4uLi4tIyMjIyMjIyMjIyMjXG4gIC8vIChVc2UgXCIvXCIgdG8gYXZvaWQgMzItYml0IHRydW5jYXRpb24gd2hlbiBiaXQtc2hpZnRpbmcgaGlnaC1vcmRlciBieXRlcylcblxuICBhcnJbMTBdID0gKHYgPSBwYXJzZUludCh1dWlkLnNsaWNlKDI0LCAzNiksIDE2KSkgLyAweDEwMDAwMDAwMDAwICYgMHhmZjtcbiAgYXJyWzExXSA9IHYgLyAweDEwMDAwMDAwMCAmIDB4ZmY7XG4gIGFyclsxMl0gPSB2ID4+PiAyNCAmIDB4ZmY7XG4gIGFyclsxM10gPSB2ID4+PiAxNiAmIDB4ZmY7XG4gIGFyclsxNF0gPSB2ID4+PiA4ICYgMHhmZjtcbiAgYXJyWzE1XSA9IHYgJiAweGZmO1xuICByZXR1cm4gYXJyO1xufVxuXG52YXIgX2RlZmF1bHQgPSBwYXJzZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0OyIsIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xudmFyIF9kZWZhdWx0ID0gL14oPzpbMC05YS1mXXs4fS1bMC05YS1mXXs0fS1bMS01XVswLTlhLWZdezN9LVs4OWFiXVswLTlhLWZdezN9LVswLTlhLWZdezEyfXwwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDApJC9pO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSBybmc7XG4vLyBVbmlxdWUgSUQgY3JlYXRpb24gcmVxdWlyZXMgYSBoaWdoIHF1YWxpdHkgcmFuZG9tICMgZ2VuZXJhdG9yLiBJbiB0aGUgYnJvd3NlciB3ZSB0aGVyZWZvcmVcbi8vIHJlcXVpcmUgdGhlIGNyeXB0byBBUEkgYW5kIGRvIG5vdCBzdXBwb3J0IGJ1aWx0LWluIGZhbGxiYWNrIHRvIGxvd2VyIHF1YWxpdHkgcmFuZG9tIG51bWJlclxuLy8gZ2VuZXJhdG9ycyAobGlrZSBNYXRoLnJhbmRvbSgpKS5cbmxldCBnZXRSYW5kb21WYWx1ZXM7XG5jb25zdCBybmRzOCA9IG5ldyBVaW50OEFycmF5KDE2KTtcblxuZnVuY3Rpb24gcm5nKCkge1xuICAvLyBsYXp5IGxvYWQgc28gdGhhdCBlbnZpcm9ubWVudHMgdGhhdCBuZWVkIHRvIHBvbHlmaWxsIGhhdmUgYSBjaGFuY2UgdG8gZG8gc29cbiAgaWYgKCFnZXRSYW5kb21WYWx1ZXMpIHtcbiAgICAvLyBnZXRSYW5kb21WYWx1ZXMgbmVlZHMgdG8gYmUgaW52b2tlZCBpbiBhIGNvbnRleHQgd2hlcmUgXCJ0aGlzXCIgaXMgYSBDcnlwdG8gaW1wbGVtZW50YXRpb24uXG4gICAgZ2V0UmFuZG9tVmFsdWVzID0gdHlwZW9mIGNyeXB0byAhPT0gJ3VuZGVmaW5lZCcgJiYgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyAmJiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzLmJpbmQoY3J5cHRvKTtcblxuICAgIGlmICghZ2V0UmFuZG9tVmFsdWVzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NyeXB0by5nZXRSYW5kb21WYWx1ZXMoKSBub3Qgc3VwcG9ydGVkLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3V1aWRqcy91dWlkI2dldHJhbmRvbXZhbHVlcy1ub3Qtc3VwcG9ydGVkJyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGdldFJhbmRvbVZhbHVlcyhybmRzOCk7XG59IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbi8vIEFkYXB0ZWQgZnJvbSBDaHJpcyBWZW5lc3MnIFNIQTEgY29kZSBhdFxuLy8gaHR0cDovL3d3dy5tb3ZhYmxlLXR5cGUuY28udWsvc2NyaXB0cy9zaGExLmh0bWxcbmZ1bmN0aW9uIGYocywgeCwgeSwgeikge1xuICBzd2l0Y2ggKHMpIHtcbiAgICBjYXNlIDA6XG4gICAgICByZXR1cm4geCAmIHkgXiB+eCAmIHo7XG5cbiAgICBjYXNlIDE6XG4gICAgICByZXR1cm4geCBeIHkgXiB6O1xuXG4gICAgY2FzZSAyOlxuICAgICAgcmV0dXJuIHggJiB5IF4geCAmIHogXiB5ICYgejtcblxuICAgIGNhc2UgMzpcbiAgICAgIHJldHVybiB4IF4geSBeIHo7XG4gIH1cbn1cblxuZnVuY3Rpb24gUk9UTCh4LCBuKSB7XG4gIHJldHVybiB4IDw8IG4gfCB4ID4+PiAzMiAtIG47XG59XG5cbmZ1bmN0aW9uIHNoYTEoYnl0ZXMpIHtcbiAgY29uc3QgSyA9IFsweDVhODI3OTk5LCAweDZlZDllYmExLCAweDhmMWJiY2RjLCAweGNhNjJjMWQ2XTtcbiAgY29uc3QgSCA9IFsweDY3NDUyMzAxLCAweGVmY2RhYjg5LCAweDk4YmFkY2ZlLCAweDEwMzI1NDc2LCAweGMzZDJlMWYwXTtcblxuICBpZiAodHlwZW9mIGJ5dGVzID09PSAnc3RyaW5nJykge1xuICAgIGNvbnN0IG1zZyA9IHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChieXRlcykpOyAvLyBVVEY4IGVzY2FwZVxuXG4gICAgYnl0ZXMgPSBbXTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbXNnLmxlbmd0aDsgKytpKSB7XG4gICAgICBieXRlcy5wdXNoKG1zZy5jaGFyQ29kZUF0KGkpKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAoIUFycmF5LmlzQXJyYXkoYnl0ZXMpKSB7XG4gICAgLy8gQ29udmVydCBBcnJheS1saWtlIHRvIEFycmF5XG4gICAgYnl0ZXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChieXRlcyk7XG4gIH1cblxuICBieXRlcy5wdXNoKDB4ODApO1xuICBjb25zdCBsID0gYnl0ZXMubGVuZ3RoIC8gNCArIDI7XG4gIGNvbnN0IE4gPSBNYXRoLmNlaWwobCAvIDE2KTtcbiAgY29uc3QgTSA9IG5ldyBBcnJheShOKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IE47ICsraSkge1xuICAgIGNvbnN0IGFyciA9IG5ldyBVaW50MzJBcnJheSgxNik7XG5cbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IDE2OyArK2opIHtcbiAgICAgIGFycltqXSA9IGJ5dGVzW2kgKiA2NCArIGogKiA0XSA8PCAyNCB8IGJ5dGVzW2kgKiA2NCArIGogKiA0ICsgMV0gPDwgMTYgfCBieXRlc1tpICogNjQgKyBqICogNCArIDJdIDw8IDggfCBieXRlc1tpICogNjQgKyBqICogNCArIDNdO1xuICAgIH1cblxuICAgIE1baV0gPSBhcnI7XG4gIH1cblxuICBNW04gLSAxXVsxNF0gPSAoYnl0ZXMubGVuZ3RoIC0gMSkgKiA4IC8gTWF0aC5wb3coMiwgMzIpO1xuICBNW04gLSAxXVsxNF0gPSBNYXRoLmZsb29yKE1bTiAtIDFdWzE0XSk7XG4gIE1bTiAtIDFdWzE1XSA9IChieXRlcy5sZW5ndGggLSAxKSAqIDggJiAweGZmZmZmZmZmO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgTjsgKytpKSB7XG4gICAgY29uc3QgVyA9IG5ldyBVaW50MzJBcnJheSg4MCk7XG5cbiAgICBmb3IgKGxldCB0ID0gMDsgdCA8IDE2OyArK3QpIHtcbiAgICAgIFdbdF0gPSBNW2ldW3RdO1xuICAgIH1cblxuICAgIGZvciAobGV0IHQgPSAxNjsgdCA8IDgwOyArK3QpIHtcbiAgICAgIFdbdF0gPSBST1RMKFdbdCAtIDNdIF4gV1t0IC0gOF0gXiBXW3QgLSAxNF0gXiBXW3QgLSAxNl0sIDEpO1xuICAgIH1cblxuICAgIGxldCBhID0gSFswXTtcbiAgICBsZXQgYiA9IEhbMV07XG4gICAgbGV0IGMgPSBIWzJdO1xuICAgIGxldCBkID0gSFszXTtcbiAgICBsZXQgZSA9IEhbNF07XG5cbiAgICBmb3IgKGxldCB0ID0gMDsgdCA8IDgwOyArK3QpIHtcbiAgICAgIGNvbnN0IHMgPSBNYXRoLmZsb29yKHQgLyAyMCk7XG4gICAgICBjb25zdCBUID0gUk9UTChhLCA1KSArIGYocywgYiwgYywgZCkgKyBlICsgS1tzXSArIFdbdF0gPj4+IDA7XG4gICAgICBlID0gZDtcbiAgICAgIGQgPSBjO1xuICAgICAgYyA9IFJPVEwoYiwgMzApID4+PiAwO1xuICAgICAgYiA9IGE7XG4gICAgICBhID0gVDtcbiAgICB9XG5cbiAgICBIWzBdID0gSFswXSArIGEgPj4+IDA7XG4gICAgSFsxXSA9IEhbMV0gKyBiID4+PiAwO1xuICAgIEhbMl0gPSBIWzJdICsgYyA+Pj4gMDtcbiAgICBIWzNdID0gSFszXSArIGQgPj4+IDA7XG4gICAgSFs0XSA9IEhbNF0gKyBlID4+PiAwO1xuICB9XG5cbiAgcmV0dXJuIFtIWzBdID4+IDI0ICYgMHhmZiwgSFswXSA+PiAxNiAmIDB4ZmYsIEhbMF0gPj4gOCAmIDB4ZmYsIEhbMF0gJiAweGZmLCBIWzFdID4+IDI0ICYgMHhmZiwgSFsxXSA+PiAxNiAmIDB4ZmYsIEhbMV0gPj4gOCAmIDB4ZmYsIEhbMV0gJiAweGZmLCBIWzJdID4+IDI0ICYgMHhmZiwgSFsyXSA+PiAxNiAmIDB4ZmYsIEhbMl0gPj4gOCAmIDB4ZmYsIEhbMl0gJiAweGZmLCBIWzNdID4+IDI0ICYgMHhmZiwgSFszXSA+PiAxNiAmIDB4ZmYsIEhbM10gPj4gOCAmIDB4ZmYsIEhbM10gJiAweGZmLCBIWzRdID4+IDI0ICYgMHhmZiwgSFs0XSA+PiAxNiAmIDB4ZmYsIEhbNF0gPj4gOCAmIDB4ZmYsIEhbNF0gJiAweGZmXTtcbn1cblxudmFyIF9kZWZhdWx0ID0gc2hhMTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0OyIsIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuZXhwb3J0cy51bnNhZmVTdHJpbmdpZnkgPSB1bnNhZmVTdHJpbmdpZnk7XG5cbnZhciBfdmFsaWRhdGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL3ZhbGlkYXRlLmpzXCIpKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuLyoqXG4gKiBDb252ZXJ0IGFycmF5IG9mIDE2IGJ5dGUgdmFsdWVzIHRvIFVVSUQgc3RyaW5nIGZvcm1hdCBvZiB0aGUgZm9ybTpcbiAqIFhYWFhYWFhYLVhYWFgtWFhYWC1YWFhYLVhYWFhYWFhYWFhYWFxuICovXG5jb25zdCBieXRlVG9IZXggPSBbXTtcblxuZm9yIChsZXQgaSA9IDA7IGkgPCAyNTY7ICsraSkge1xuICBieXRlVG9IZXgucHVzaCgoaSArIDB4MTAwKS50b1N0cmluZygxNikuc2xpY2UoMSkpO1xufVxuXG5mdW5jdGlvbiB1bnNhZmVTdHJpbmdpZnkoYXJyLCBvZmZzZXQgPSAwKSB7XG4gIC8vIE5vdGU6IEJlIGNhcmVmdWwgZWRpdGluZyB0aGlzIGNvZGUhICBJdCdzIGJlZW4gdHVuZWQgZm9yIHBlcmZvcm1hbmNlXG4gIC8vIGFuZCB3b3JrcyBpbiB3YXlzIHlvdSBtYXkgbm90IGV4cGVjdC4gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS91dWlkanMvdXVpZC9wdWxsLzQzNFxuICByZXR1cm4gKGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDJdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgM11dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA0XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDVdXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA3XV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDhdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgOV1dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMV1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxM11dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNV1dKS50b0xvd2VyQ2FzZSgpO1xufVxuXG5mdW5jdGlvbiBzdHJpbmdpZnkoYXJyLCBvZmZzZXQgPSAwKSB7XG4gIGNvbnN0IHV1aWQgPSB1bnNhZmVTdHJpbmdpZnkoYXJyLCBvZmZzZXQpOyAvLyBDb25zaXN0ZW5jeSBjaGVjayBmb3IgdmFsaWQgVVVJRC4gIElmIHRoaXMgdGhyb3dzLCBpdCdzIGxpa2VseSBkdWUgdG8gb25lXG4gIC8vIG9mIHRoZSBmb2xsb3dpbmc6XG4gIC8vIC0gT25lIG9yIG1vcmUgaW5wdXQgYXJyYXkgdmFsdWVzIGRvbid0IG1hcCB0byBhIGhleCBvY3RldCAobGVhZGluZyB0b1xuICAvLyBcInVuZGVmaW5lZFwiIGluIHRoZSB1dWlkKVxuICAvLyAtIEludmFsaWQgaW5wdXQgdmFsdWVzIGZvciB0aGUgUkZDIGB2ZXJzaW9uYCBvciBgdmFyaWFudGAgZmllbGRzXG5cbiAgaWYgKCEoMCwgX3ZhbGlkYXRlLmRlZmF1bHQpKHV1aWQpKSB7XG4gICAgdGhyb3cgVHlwZUVycm9yKCdTdHJpbmdpZmllZCBVVUlEIGlzIGludmFsaWQnKTtcbiAgfVxuXG4gIHJldHVybiB1dWlkO1xufVxuXG52YXIgX2RlZmF1bHQgPSBzdHJpbmdpZnk7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDsiLCJcInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9ybmcgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL3JuZy5qc1wiKSk7XG5cbnZhciBfc3RyaW5naWZ5ID0gcmVxdWlyZShcIi4vc3RyaW5naWZ5LmpzXCIpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG4vLyAqKmB2MSgpYCAtIEdlbmVyYXRlIHRpbWUtYmFzZWQgVVVJRCoqXG4vL1xuLy8gSW5zcGlyZWQgYnkgaHR0cHM6Ly9naXRodWIuY29tL0xpb3NLL1VVSUQuanNcbi8vIGFuZCBodHRwOi8vZG9jcy5weXRob24ub3JnL2xpYnJhcnkvdXVpZC5odG1sXG5sZXQgX25vZGVJZDtcblxubGV0IF9jbG9ja3NlcTsgLy8gUHJldmlvdXMgdXVpZCBjcmVhdGlvbiB0aW1lXG5cblxubGV0IF9sYXN0TVNlY3MgPSAwO1xubGV0IF9sYXN0TlNlY3MgPSAwOyAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3V1aWRqcy91dWlkIGZvciBBUEkgZGV0YWlsc1xuXG5mdW5jdGlvbiB2MShvcHRpb25zLCBidWYsIG9mZnNldCkge1xuICBsZXQgaSA9IGJ1ZiAmJiBvZmZzZXQgfHwgMDtcbiAgY29uc3QgYiA9IGJ1ZiB8fCBuZXcgQXJyYXkoMTYpO1xuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgbGV0IG5vZGUgPSBvcHRpb25zLm5vZGUgfHwgX25vZGVJZDtcbiAgbGV0IGNsb2Nrc2VxID0gb3B0aW9ucy5jbG9ja3NlcSAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5jbG9ja3NlcSA6IF9jbG9ja3NlcTsgLy8gbm9kZSBhbmQgY2xvY2tzZXEgbmVlZCB0byBiZSBpbml0aWFsaXplZCB0byByYW5kb20gdmFsdWVzIGlmIHRoZXkncmUgbm90XG4gIC8vIHNwZWNpZmllZC4gIFdlIGRvIHRoaXMgbGF6aWx5IHRvIG1pbmltaXplIGlzc3VlcyByZWxhdGVkIHRvIGluc3VmZmljaWVudFxuICAvLyBzeXN0ZW0gZW50cm9weS4gIFNlZSAjMTg5XG5cbiAgaWYgKG5vZGUgPT0gbnVsbCB8fCBjbG9ja3NlcSA9PSBudWxsKSB7XG4gICAgY29uc3Qgc2VlZEJ5dGVzID0gb3B0aW9ucy5yYW5kb20gfHwgKG9wdGlvbnMucm5nIHx8IF9ybmcuZGVmYXVsdCkoKTtcblxuICAgIGlmIChub2RlID09IG51bGwpIHtcbiAgICAgIC8vIFBlciA0LjUsIGNyZWF0ZSBhbmQgNDgtYml0IG5vZGUgaWQsICg0NyByYW5kb20gYml0cyArIG11bHRpY2FzdCBiaXQgPSAxKVxuICAgICAgbm9kZSA9IF9ub2RlSWQgPSBbc2VlZEJ5dGVzWzBdIHwgMHgwMSwgc2VlZEJ5dGVzWzFdLCBzZWVkQnl0ZXNbMl0sIHNlZWRCeXRlc1szXSwgc2VlZEJ5dGVzWzRdLCBzZWVkQnl0ZXNbNV1dO1xuICAgIH1cblxuICAgIGlmIChjbG9ja3NlcSA9PSBudWxsKSB7XG4gICAgICAvLyBQZXIgNC4yLjIsIHJhbmRvbWl6ZSAoMTQgYml0KSBjbG9ja3NlcVxuICAgICAgY2xvY2tzZXEgPSBfY2xvY2tzZXEgPSAoc2VlZEJ5dGVzWzZdIDw8IDggfCBzZWVkQnl0ZXNbN10pICYgMHgzZmZmO1xuICAgIH1cbiAgfSAvLyBVVUlEIHRpbWVzdGFtcHMgYXJlIDEwMCBuYW5vLXNlY29uZCB1bml0cyBzaW5jZSB0aGUgR3JlZ29yaWFuIGVwb2NoLFxuICAvLyAoMTU4Mi0xMC0xNSAwMDowMCkuICBKU051bWJlcnMgYXJlbid0IHByZWNpc2UgZW5vdWdoIGZvciB0aGlzLCBzb1xuICAvLyB0aW1lIGlzIGhhbmRsZWQgaW50ZXJuYWxseSBhcyAnbXNlY3MnIChpbnRlZ2VyIG1pbGxpc2Vjb25kcykgYW5kICduc2VjcydcbiAgLy8gKDEwMC1uYW5vc2Vjb25kcyBvZmZzZXQgZnJvbSBtc2Vjcykgc2luY2UgdW5peCBlcG9jaCwgMTk3MC0wMS0wMSAwMDowMC5cblxuXG4gIGxldCBtc2VjcyA9IG9wdGlvbnMubXNlY3MgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMubXNlY3MgOiBEYXRlLm5vdygpOyAvLyBQZXIgNC4yLjEuMiwgdXNlIGNvdW50IG9mIHV1aWQncyBnZW5lcmF0ZWQgZHVyaW5nIHRoZSBjdXJyZW50IGNsb2NrXG4gIC8vIGN5Y2xlIHRvIHNpbXVsYXRlIGhpZ2hlciByZXNvbHV0aW9uIGNsb2NrXG5cbiAgbGV0IG5zZWNzID0gb3B0aW9ucy5uc2VjcyAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5uc2VjcyA6IF9sYXN0TlNlY3MgKyAxOyAvLyBUaW1lIHNpbmNlIGxhc3QgdXVpZCBjcmVhdGlvbiAoaW4gbXNlY3MpXG5cbiAgY29uc3QgZHQgPSBtc2VjcyAtIF9sYXN0TVNlY3MgKyAobnNlY3MgLSBfbGFzdE5TZWNzKSAvIDEwMDAwOyAvLyBQZXIgNC4yLjEuMiwgQnVtcCBjbG9ja3NlcSBvbiBjbG9jayByZWdyZXNzaW9uXG5cbiAgaWYgKGR0IDwgMCAmJiBvcHRpb25zLmNsb2Nrc2VxID09PSB1bmRlZmluZWQpIHtcbiAgICBjbG9ja3NlcSA9IGNsb2Nrc2VxICsgMSAmIDB4M2ZmZjtcbiAgfSAvLyBSZXNldCBuc2VjcyBpZiBjbG9jayByZWdyZXNzZXMgKG5ldyBjbG9ja3NlcSkgb3Igd2UndmUgbW92ZWQgb250byBhIG5ld1xuICAvLyB0aW1lIGludGVydmFsXG5cblxuICBpZiAoKGR0IDwgMCB8fCBtc2VjcyA+IF9sYXN0TVNlY3MpICYmIG9wdGlvbnMubnNlY3MgPT09IHVuZGVmaW5lZCkge1xuICAgIG5zZWNzID0gMDtcbiAgfSAvLyBQZXIgNC4yLjEuMiBUaHJvdyBlcnJvciBpZiB0b28gbWFueSB1dWlkcyBhcmUgcmVxdWVzdGVkXG5cblxuICBpZiAobnNlY3MgPj0gMTAwMDApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJ1dWlkLnYxKCk6IENhbid0IGNyZWF0ZSBtb3JlIHRoYW4gMTBNIHV1aWRzL3NlY1wiKTtcbiAgfVxuXG4gIF9sYXN0TVNlY3MgPSBtc2VjcztcbiAgX2xhc3ROU2VjcyA9IG5zZWNzO1xuICBfY2xvY2tzZXEgPSBjbG9ja3NlcTsgLy8gUGVyIDQuMS40IC0gQ29udmVydCBmcm9tIHVuaXggZXBvY2ggdG8gR3JlZ29yaWFuIGVwb2NoXG5cbiAgbXNlY3MgKz0gMTIyMTkyOTI4MDAwMDA7IC8vIGB0aW1lX2xvd2BcblxuICBjb25zdCB0bCA9ICgobXNlY3MgJiAweGZmZmZmZmYpICogMTAwMDAgKyBuc2VjcykgJSAweDEwMDAwMDAwMDtcbiAgYltpKytdID0gdGwgPj4+IDI0ICYgMHhmZjtcbiAgYltpKytdID0gdGwgPj4+IDE2ICYgMHhmZjtcbiAgYltpKytdID0gdGwgPj4+IDggJiAweGZmO1xuICBiW2krK10gPSB0bCAmIDB4ZmY7IC8vIGB0aW1lX21pZGBcblxuICBjb25zdCB0bWggPSBtc2VjcyAvIDB4MTAwMDAwMDAwICogMTAwMDAgJiAweGZmZmZmZmY7XG4gIGJbaSsrXSA9IHRtaCA+Pj4gOCAmIDB4ZmY7XG4gIGJbaSsrXSA9IHRtaCAmIDB4ZmY7IC8vIGB0aW1lX2hpZ2hfYW5kX3ZlcnNpb25gXG5cbiAgYltpKytdID0gdG1oID4+PiAyNCAmIDB4ZiB8IDB4MTA7IC8vIGluY2x1ZGUgdmVyc2lvblxuXG4gIGJbaSsrXSA9IHRtaCA+Pj4gMTYgJiAweGZmOyAvLyBgY2xvY2tfc2VxX2hpX2FuZF9yZXNlcnZlZGAgKFBlciA0LjIuMiAtIGluY2x1ZGUgdmFyaWFudClcblxuICBiW2krK10gPSBjbG9ja3NlcSA+Pj4gOCB8IDB4ODA7IC8vIGBjbG9ja19zZXFfbG93YFxuXG4gIGJbaSsrXSA9IGNsb2Nrc2VxICYgMHhmZjsgLy8gYG5vZGVgXG5cbiAgZm9yIChsZXQgbiA9IDA7IG4gPCA2OyArK24pIHtcbiAgICBiW2kgKyBuXSA9IG5vZGVbbl07XG4gIH1cblxuICByZXR1cm4gYnVmIHx8ICgwLCBfc3RyaW5naWZ5LnVuc2FmZVN0cmluZ2lmeSkoYik7XG59XG5cbnZhciBfZGVmYXVsdCA9IHYxO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfdiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vdjM1LmpzXCIpKTtcblxudmFyIF9tZCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vbWQ1LmpzXCIpKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuY29uc3QgdjMgPSAoMCwgX3YuZGVmYXVsdCkoJ3YzJywgMHgzMCwgX21kLmRlZmF1bHQpO1xudmFyIF9kZWZhdWx0ID0gdjM7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDsiLCJcInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuVVJMID0gZXhwb3J0cy5ETlMgPSB2b2lkIDA7XG5leHBvcnRzLmRlZmF1bHQgPSB2MzU7XG5cbnZhciBfc3RyaW5naWZ5ID0gcmVxdWlyZShcIi4vc3RyaW5naWZ5LmpzXCIpO1xuXG52YXIgX3BhcnNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9wYXJzZS5qc1wiKSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIHN0cmluZ1RvQnl0ZXMoc3RyKSB7XG4gIHN0ciA9IHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChzdHIpKTsgLy8gVVRGOCBlc2NhcGVcblxuICBjb25zdCBieXRlcyA9IFtdO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKSB7XG4gICAgYnl0ZXMucHVzaChzdHIuY2hhckNvZGVBdChpKSk7XG4gIH1cblxuICByZXR1cm4gYnl0ZXM7XG59XG5cbmNvbnN0IEROUyA9ICc2YmE3YjgxMC05ZGFkLTExZDEtODBiNC0wMGMwNGZkNDMwYzgnO1xuZXhwb3J0cy5ETlMgPSBETlM7XG5jb25zdCBVUkwgPSAnNmJhN2I4MTEtOWRhZC0xMWQxLTgwYjQtMDBjMDRmZDQzMGM4JztcbmV4cG9ydHMuVVJMID0gVVJMO1xuXG5mdW5jdGlvbiB2MzUobmFtZSwgdmVyc2lvbiwgaGFzaGZ1bmMpIHtcbiAgZnVuY3Rpb24gZ2VuZXJhdGVVVUlEKHZhbHVlLCBuYW1lc3BhY2UsIGJ1Ziwgb2Zmc2V0KSB7XG4gICAgdmFyIF9uYW1lc3BhY2U7XG5cbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgdmFsdWUgPSBzdHJpbmdUb0J5dGVzKHZhbHVlKTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIG5hbWVzcGFjZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIG5hbWVzcGFjZSA9ICgwLCBfcGFyc2UuZGVmYXVsdCkobmFtZXNwYWNlKTtcbiAgICB9XG5cbiAgICBpZiAoKChfbmFtZXNwYWNlID0gbmFtZXNwYWNlKSA9PT0gbnVsbCB8fCBfbmFtZXNwYWNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbmFtZXNwYWNlLmxlbmd0aCkgIT09IDE2KSB7XG4gICAgICB0aHJvdyBUeXBlRXJyb3IoJ05hbWVzcGFjZSBtdXN0IGJlIGFycmF5LWxpa2UgKDE2IGl0ZXJhYmxlIGludGVnZXIgdmFsdWVzLCAwLTI1NSknKTtcbiAgICB9IC8vIENvbXB1dGUgaGFzaCBvZiBuYW1lc3BhY2UgYW5kIHZhbHVlLCBQZXIgNC4zXG4gICAgLy8gRnV0dXJlOiBVc2Ugc3ByZWFkIHN5bnRheCB3aGVuIHN1cHBvcnRlZCBvbiBhbGwgcGxhdGZvcm1zLCBlLmcuIGBieXRlcyA9XG4gICAgLy8gaGFzaGZ1bmMoWy4uLm5hbWVzcGFjZSwgLi4uIHZhbHVlXSlgXG5cblxuICAgIGxldCBieXRlcyA9IG5ldyBVaW50OEFycmF5KDE2ICsgdmFsdWUubGVuZ3RoKTtcbiAgICBieXRlcy5zZXQobmFtZXNwYWNlKTtcbiAgICBieXRlcy5zZXQodmFsdWUsIG5hbWVzcGFjZS5sZW5ndGgpO1xuICAgIGJ5dGVzID0gaGFzaGZ1bmMoYnl0ZXMpO1xuICAgIGJ5dGVzWzZdID0gYnl0ZXNbNl0gJiAweDBmIHwgdmVyc2lvbjtcbiAgICBieXRlc1s4XSA9IGJ5dGVzWzhdICYgMHgzZiB8IDB4ODA7XG5cbiAgICBpZiAoYnVmKSB7XG4gICAgICBvZmZzZXQgPSBvZmZzZXQgfHwgMDtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgKytpKSB7XG4gICAgICAgIGJ1ZltvZmZzZXQgKyBpXSA9IGJ5dGVzW2ldO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYnVmO1xuICAgIH1cblxuICAgIHJldHVybiAoMCwgX3N0cmluZ2lmeS51bnNhZmVTdHJpbmdpZnkpKGJ5dGVzKTtcbiAgfSAvLyBGdW5jdGlvbiNuYW1lIGlzIG5vdCBzZXR0YWJsZSBvbiBzb21lIHBsYXRmb3JtcyAoIzI3MClcblxuXG4gIHRyeSB7XG4gICAgZ2VuZXJhdGVVVUlELm5hbWUgPSBuYW1lOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZW1wdHlcbiAgfSBjYXRjaCAoZXJyKSB7fSAvLyBGb3IgQ29tbW9uSlMgZGVmYXVsdCBleHBvcnQgc3VwcG9ydFxuXG5cbiAgZ2VuZXJhdGVVVUlELkROUyA9IEROUztcbiAgZ2VuZXJhdGVVVUlELlVSTCA9IFVSTDtcbiAgcmV0dXJuIGdlbmVyYXRlVVVJRDtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9uYXRpdmUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL25hdGl2ZS5qc1wiKSk7XG5cbnZhciBfcm5nID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9ybmcuanNcIikpO1xuXG52YXIgX3N0cmluZ2lmeSA9IHJlcXVpcmUoXCIuL3N0cmluZ2lmeS5qc1wiKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gdjQob3B0aW9ucywgYnVmLCBvZmZzZXQpIHtcbiAgaWYgKF9uYXRpdmUuZGVmYXVsdC5yYW5kb21VVUlEICYmICFidWYgJiYgIW9wdGlvbnMpIHtcbiAgICByZXR1cm4gX25hdGl2ZS5kZWZhdWx0LnJhbmRvbVVVSUQoKTtcbiAgfVxuXG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG4gIGNvbnN0IHJuZHMgPSBvcHRpb25zLnJhbmRvbSB8fCAob3B0aW9ucy5ybmcgfHwgX3JuZy5kZWZhdWx0KSgpOyAvLyBQZXIgNC40LCBzZXQgYml0cyBmb3IgdmVyc2lvbiBhbmQgYGNsb2NrX3NlcV9oaV9hbmRfcmVzZXJ2ZWRgXG5cblxuICBybmRzWzZdID0gcm5kc1s2XSAmIDB4MGYgfCAweDQwO1xuICBybmRzWzhdID0gcm5kc1s4XSAmIDB4M2YgfCAweDgwOyAvLyBDb3B5IGJ5dGVzIHRvIGJ1ZmZlciwgaWYgcHJvdmlkZWRcblxuICBpZiAoYnVmKSB7XG4gICAgb2Zmc2V0ID0gb2Zmc2V0IHx8IDA7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDE2OyArK2kpIHtcbiAgICAgIGJ1ZltvZmZzZXQgKyBpXSA9IHJuZHNbaV07XG4gICAgfVxuXG4gICAgcmV0dXJuIGJ1ZjtcbiAgfVxuXG4gIHJldHVybiAoMCwgX3N0cmluZ2lmeS51bnNhZmVTdHJpbmdpZnkpKHJuZHMpO1xufVxuXG52YXIgX2RlZmF1bHQgPSB2NDtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0OyIsIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX3YgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL3YzNS5qc1wiKSk7XG5cbnZhciBfc2hhID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9zaGExLmpzXCIpKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuY29uc3QgdjUgPSAoMCwgX3YuZGVmYXVsdCkoJ3Y1JywgMHg1MCwgX3NoYS5kZWZhdWx0KTtcbnZhciBfZGVmYXVsdCA9IHY1O1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfcmVnZXggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL3JlZ2V4LmpzXCIpKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gdmFsaWRhdGUodXVpZCkge1xuICByZXR1cm4gdHlwZW9mIHV1aWQgPT09ICdzdHJpbmcnICYmIF9yZWdleC5kZWZhdWx0LnRlc3QodXVpZCk7XG59XG5cbnZhciBfZGVmYXVsdCA9IHZhbGlkYXRlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfdmFsaWRhdGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL3ZhbGlkYXRlLmpzXCIpKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gdmVyc2lvbih1dWlkKSB7XG4gIGlmICghKDAsIF92YWxpZGF0ZS5kZWZhdWx0KSh1dWlkKSkge1xuICAgIHRocm93IFR5cGVFcnJvcignSW52YWxpZCBVVUlEJyk7XG4gIH1cblxuICByZXR1cm4gcGFyc2VJbnQodXVpZC5zbGljZSgxNCwgMTUpLCAxNik7XG59XG5cbnZhciBfZGVmYXVsdCA9IHZlcnNpb247XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDsiLCJjb25zdCByYW5kb21VVUlEID0gdHlwZW9mIGNyeXB0byAhPT0gJ3VuZGVmaW5lZCcgJiYgY3J5cHRvLnJhbmRvbVVVSUQgJiYgY3J5cHRvLnJhbmRvbVVVSUQuYmluZChjcnlwdG8pO1xuZXhwb3J0IGRlZmF1bHQge1xuICByYW5kb21VVUlEXG59OyIsImV4cG9ydCBkZWZhdWx0IC9eKD86WzAtOWEtZl17OH0tWzAtOWEtZl17NH0tWzEtNV1bMC05YS1mXXszfS1bODlhYl1bMC05YS1mXXszfS1bMC05YS1mXXsxMn18MDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwKSQvaTsiLCIvLyBVbmlxdWUgSUQgY3JlYXRpb24gcmVxdWlyZXMgYSBoaWdoIHF1YWxpdHkgcmFuZG9tICMgZ2VuZXJhdG9yLiBJbiB0aGUgYnJvd3NlciB3ZSB0aGVyZWZvcmVcbi8vIHJlcXVpcmUgdGhlIGNyeXB0byBBUEkgYW5kIGRvIG5vdCBzdXBwb3J0IGJ1aWx0LWluIGZhbGxiYWNrIHRvIGxvd2VyIHF1YWxpdHkgcmFuZG9tIG51bWJlclxuLy8gZ2VuZXJhdG9ycyAobGlrZSBNYXRoLnJhbmRvbSgpKS5cbmxldCBnZXRSYW5kb21WYWx1ZXM7XG5jb25zdCBybmRzOCA9IG5ldyBVaW50OEFycmF5KDE2KTtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHJuZygpIHtcbiAgLy8gbGF6eSBsb2FkIHNvIHRoYXQgZW52aXJvbm1lbnRzIHRoYXQgbmVlZCB0byBwb2x5ZmlsbCBoYXZlIGEgY2hhbmNlIHRvIGRvIHNvXG4gIGlmICghZ2V0UmFuZG9tVmFsdWVzKSB7XG4gICAgLy8gZ2V0UmFuZG9tVmFsdWVzIG5lZWRzIHRvIGJlIGludm9rZWQgaW4gYSBjb250ZXh0IHdoZXJlIFwidGhpc1wiIGlzIGEgQ3J5cHRvIGltcGxlbWVudGF0aW9uLlxuICAgIGdldFJhbmRvbVZhbHVlcyA9IHR5cGVvZiBjcnlwdG8gIT09ICd1bmRlZmluZWQnICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMgJiYgY3J5cHRvLmdldFJhbmRvbVZhbHVlcy5iaW5kKGNyeXB0byk7XG5cbiAgICBpZiAoIWdldFJhbmRvbVZhbHVlcykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKCkgbm90IHN1cHBvcnRlZC4gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS91dWlkanMvdXVpZCNnZXRyYW5kb212YWx1ZXMtbm90LXN1cHBvcnRlZCcpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBnZXRSYW5kb21WYWx1ZXMocm5kczgpO1xufSIsImltcG9ydCB2YWxpZGF0ZSBmcm9tICcuL3ZhbGlkYXRlLmpzJztcbi8qKlxuICogQ29udmVydCBhcnJheSBvZiAxNiBieXRlIHZhbHVlcyB0byBVVUlEIHN0cmluZyBmb3JtYXQgb2YgdGhlIGZvcm06XG4gKiBYWFhYWFhYWC1YWFhYLVhYWFgtWFhYWC1YWFhYWFhYWFhYWFhcbiAqL1xuXG5jb25zdCBieXRlVG9IZXggPSBbXTtcblxuZm9yIChsZXQgaSA9IDA7IGkgPCAyNTY7ICsraSkge1xuICBieXRlVG9IZXgucHVzaCgoaSArIDB4MTAwKS50b1N0cmluZygxNikuc2xpY2UoMSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdW5zYWZlU3RyaW5naWZ5KGFyciwgb2Zmc2V0ID0gMCkge1xuICAvLyBOb3RlOiBCZSBjYXJlZnVsIGVkaXRpbmcgdGhpcyBjb2RlISAgSXQncyBiZWVuIHR1bmVkIGZvciBwZXJmb3JtYW5jZVxuICAvLyBhbmQgd29ya3MgaW4gd2F5cyB5b3UgbWF5IG5vdCBleHBlY3QuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdXVpZGpzL3V1aWQvcHVsbC80MzRcbiAgcmV0dXJuIChieXRlVG9IZXhbYXJyW29mZnNldCArIDBdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMV1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAyXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDNdXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA1XV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDZdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgN11dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA4XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDldXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTBdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTFdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTJdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTNdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTRdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTVdXSkudG9Mb3dlckNhc2UoKTtcbn1cblxuZnVuY3Rpb24gc3RyaW5naWZ5KGFyciwgb2Zmc2V0ID0gMCkge1xuICBjb25zdCB1dWlkID0gdW5zYWZlU3RyaW5naWZ5KGFyciwgb2Zmc2V0KTsgLy8gQ29uc2lzdGVuY3kgY2hlY2sgZm9yIHZhbGlkIFVVSUQuICBJZiB0aGlzIHRocm93cywgaXQncyBsaWtlbHkgZHVlIHRvIG9uZVxuICAvLyBvZiB0aGUgZm9sbG93aW5nOlxuICAvLyAtIE9uZSBvciBtb3JlIGlucHV0IGFycmF5IHZhbHVlcyBkb24ndCBtYXAgdG8gYSBoZXggb2N0ZXQgKGxlYWRpbmcgdG9cbiAgLy8gXCJ1bmRlZmluZWRcIiBpbiB0aGUgdXVpZClcbiAgLy8gLSBJbnZhbGlkIGlucHV0IHZhbHVlcyBmb3IgdGhlIFJGQyBgdmVyc2lvbmAgb3IgYHZhcmlhbnRgIGZpZWxkc1xuXG4gIGlmICghdmFsaWRhdGUodXVpZCkpIHtcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ1N0cmluZ2lmaWVkIFVVSUQgaXMgaW52YWxpZCcpO1xuICB9XG5cbiAgcmV0dXJuIHV1aWQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHN0cmluZ2lmeTsiLCJpbXBvcnQgbmF0aXZlIGZyb20gJy4vbmF0aXZlLmpzJztcbmltcG9ydCBybmcgZnJvbSAnLi9ybmcuanMnO1xuaW1wb3J0IHsgdW5zYWZlU3RyaW5naWZ5IH0gZnJvbSAnLi9zdHJpbmdpZnkuanMnO1xuXG5mdW5jdGlvbiB2NChvcHRpb25zLCBidWYsIG9mZnNldCkge1xuICBpZiAobmF0aXZlLnJhbmRvbVVVSUQgJiYgIWJ1ZiAmJiAhb3B0aW9ucykge1xuICAgIHJldHVybiBuYXRpdmUucmFuZG9tVVVJRCgpO1xuICB9XG5cbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIGNvbnN0IHJuZHMgPSBvcHRpb25zLnJhbmRvbSB8fCAob3B0aW9ucy5ybmcgfHwgcm5nKSgpOyAvLyBQZXIgNC40LCBzZXQgYml0cyBmb3IgdmVyc2lvbiBhbmQgYGNsb2NrX3NlcV9oaV9hbmRfcmVzZXJ2ZWRgXG5cbiAgcm5kc1s2XSA9IHJuZHNbNl0gJiAweDBmIHwgMHg0MDtcbiAgcm5kc1s4XSA9IHJuZHNbOF0gJiAweDNmIHwgMHg4MDsgLy8gQ29weSBieXRlcyB0byBidWZmZXIsIGlmIHByb3ZpZGVkXG5cbiAgaWYgKGJ1Zikge1xuICAgIG9mZnNldCA9IG9mZnNldCB8fCAwO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgKytpKSB7XG4gICAgICBidWZbb2Zmc2V0ICsgaV0gPSBybmRzW2ldO1xuICAgIH1cblxuICAgIHJldHVybiBidWY7XG4gIH1cblxuICByZXR1cm4gdW5zYWZlU3RyaW5naWZ5KHJuZHMpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB2NDsiLCJpbXBvcnQgUkVHRVggZnJvbSAnLi9yZWdleC5qcyc7XG5cbmZ1bmN0aW9uIHZhbGlkYXRlKHV1aWQpIHtcbiAgcmV0dXJuIHR5cGVvZiB1dWlkID09PSAnc3RyaW5nJyAmJiBSRUdFWC50ZXN0KHV1aWQpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB2YWxpZGF0ZTsiLCIoZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuICBpZiAodHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoXCJ3ZWJleHRlbnNpb24tcG9seWZpbGxcIiwgW1wibW9kdWxlXCJdLCBmYWN0b3J5KTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIGZhY3RvcnkobW9kdWxlKTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgbW9kID0ge1xuICAgICAgZXhwb3J0czoge31cbiAgICB9O1xuICAgIGZhY3RvcnkobW9kKTtcbiAgICBnbG9iYWwuYnJvd3NlciA9IG1vZC5leHBvcnRzO1xuICB9XG59KSh0eXBlb2YgZ2xvYmFsVGhpcyAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbFRoaXMgOiB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0aGlzLCBmdW5jdGlvbiAobW9kdWxlKSB7XG4gIC8qIHdlYmV4dGVuc2lvbi1wb2x5ZmlsbCAtIHYwLjEwLjAgLSBGcmkgQXVnIDEyIDIwMjIgMTk6NDI6NDQgKi9cblxuICAvKiAtKi0gTW9kZTogaW5kZW50LXRhYnMtbW9kZTogbmlsOyBqcy1pbmRlbnQtbGV2ZWw6IDIgLSotICovXG5cbiAgLyogdmltOiBzZXQgc3RzPTIgc3c9MiBldCB0dz04MDogKi9cblxuICAvKiBUaGlzIFNvdXJjZSBDb2RlIEZvcm0gaXMgc3ViamVjdCB0byB0aGUgdGVybXMgb2YgdGhlIE1vemlsbGEgUHVibGljXG4gICAqIExpY2Vuc2UsIHYuIDIuMC4gSWYgYSBjb3B5IG9mIHRoZSBNUEwgd2FzIG5vdCBkaXN0cmlidXRlZCB3aXRoIHRoaXNcbiAgICogZmlsZSwgWW91IGNhbiBvYnRhaW4gb25lIGF0IGh0dHA6Ly9tb3ppbGxhLm9yZy9NUEwvMi4wLy4gKi9cbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgaWYgKCFnbG9iYWxUaGlzLmNocm9tZT8ucnVudGltZT8uaWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGlzIHNjcmlwdCBzaG91bGQgb25seSBiZSBsb2FkZWQgaW4gYSBicm93c2VyIGV4dGVuc2lvbi5cIik7XG4gIH1cblxuICBpZiAodHlwZW9mIGdsb2JhbFRoaXMuYnJvd3NlciA9PT0gXCJ1bmRlZmluZWRcIiB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoZ2xvYmFsVGhpcy5icm93c2VyKSAhPT0gT2JqZWN0LnByb3RvdHlwZSkge1xuICAgIGNvbnN0IENIUk9NRV9TRU5EX01FU1NBR0VfQ0FMTEJBQ0tfTk9fUkVTUE9OU0VfTUVTU0FHRSA9IFwiVGhlIG1lc3NhZ2UgcG9ydCBjbG9zZWQgYmVmb3JlIGEgcmVzcG9uc2Ugd2FzIHJlY2VpdmVkLlwiOyAvLyBXcmFwcGluZyB0aGUgYnVsayBvZiB0aGlzIHBvbHlmaWxsIGluIGEgb25lLXRpbWUtdXNlIGZ1bmN0aW9uIGlzIGEgbWlub3JcbiAgICAvLyBvcHRpbWl6YXRpb24gZm9yIEZpcmVmb3guIFNpbmNlIFNwaWRlcm1vbmtleSBkb2VzIG5vdCBmdWxseSBwYXJzZSB0aGVcbiAgICAvLyBjb250ZW50cyBvZiBhIGZ1bmN0aW9uIHVudGlsIHRoZSBmaXJzdCB0aW1lIGl0J3MgY2FsbGVkLCBhbmQgc2luY2UgaXQgd2lsbFxuICAgIC8vIG5ldmVyIGFjdHVhbGx5IG5lZWQgdG8gYmUgY2FsbGVkLCB0aGlzIGFsbG93cyB0aGUgcG9seWZpbGwgdG8gYmUgaW5jbHVkZWRcbiAgICAvLyBpbiBGaXJlZm94IG5lYXJseSBmb3IgZnJlZS5cblxuICAgIGNvbnN0IHdyYXBBUElzID0gZXh0ZW5zaW9uQVBJcyA9PiB7XG4gICAgICAvLyBOT1RFOiBhcGlNZXRhZGF0YSBpcyBhc3NvY2lhdGVkIHRvIHRoZSBjb250ZW50IG9mIHRoZSBhcGktbWV0YWRhdGEuanNvbiBmaWxlXG4gICAgICAvLyBhdCBidWlsZCB0aW1lIGJ5IHJlcGxhY2luZyB0aGUgZm9sbG93aW5nIFwiaW5jbHVkZVwiIHdpdGggdGhlIGNvbnRlbnQgb2YgdGhlXG4gICAgICAvLyBKU09OIGZpbGUuXG4gICAgICBjb25zdCBhcGlNZXRhZGF0YSA9IHtcbiAgICAgICAgXCJhbGFybXNcIjoge1xuICAgICAgICAgIFwiY2xlYXJcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJjbGVhckFsbFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldEFsbFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcImJvb2ttYXJrc1wiOiB7XG4gICAgICAgICAgXCJjcmVhdGVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRDaGlsZHJlblwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldFJlY2VudFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldFN1YlRyZWVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRUcmVlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDBcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwibW92ZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMixcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAyXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInJlbW92ZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInJlbW92ZVRyZWVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZWFyY2hcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJ1cGRhdGVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDIsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMlxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJicm93c2VyQWN0aW9uXCI6IHtcbiAgICAgICAgICBcImRpc2FibGVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwiZmFsbGJhY2tUb05vQ2FsbGJhY2tcIjogdHJ1ZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJlbmFibGVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwiZmFsbGJhY2tUb05vQ2FsbGJhY2tcIjogdHJ1ZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRCYWRnZUJhY2tncm91bmRDb2xvclwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldEJhZGdlVGV4dFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldFBvcHVwXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0VGl0bGVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJvcGVuUG9wdXBcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZXRCYWRnZUJhY2tncm91bmRDb2xvclwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJmYWxsYmFja1RvTm9DYWxsYmFja1wiOiB0cnVlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInNldEJhZGdlVGV4dFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJmYWxsYmFja1RvTm9DYWxsYmFja1wiOiB0cnVlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInNldEljb25cIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZXRQb3B1cFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJmYWxsYmFja1RvTm9DYWxsYmFja1wiOiB0cnVlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInNldFRpdGxlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDEsXG4gICAgICAgICAgICBcImZhbGxiYWNrVG9Ob0NhbGxiYWNrXCI6IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwiYnJvd3NpbmdEYXRhXCI6IHtcbiAgICAgICAgICBcInJlbW92ZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMixcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAyXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInJlbW92ZUNhY2hlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicmVtb3ZlQ29va2llc1wiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInJlbW92ZURvd25sb2Fkc1wiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInJlbW92ZUZvcm1EYXRhXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicmVtb3ZlSGlzdG9yeVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInJlbW92ZUxvY2FsU3RvcmFnZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInJlbW92ZVBhc3N3b3Jkc1wiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInJlbW92ZVBsdWdpbkRhdGFcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZXR0aW5nc1wiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcImNvbW1hbmRzXCI6IHtcbiAgICAgICAgICBcImdldEFsbFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcImNvbnRleHRNZW51c1wiOiB7XG4gICAgICAgICAgXCJyZW1vdmVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVBbGxcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJ1cGRhdGVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDIsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMlxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJjb29raWVzXCI6IHtcbiAgICAgICAgICBcImdldFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldEFsbFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldEFsbENvb2tpZVN0b3Jlc1wiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInJlbW92ZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInNldFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcImRldnRvb2xzXCI6IHtcbiAgICAgICAgICBcImluc3BlY3RlZFdpbmRvd1wiOiB7XG4gICAgICAgICAgICBcImV2YWxcIjoge1xuICAgICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDIsXG4gICAgICAgICAgICAgIFwic2luZ2xlQ2FsbGJhY2tBcmdcIjogZmFsc2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicGFuZWxzXCI6IHtcbiAgICAgICAgICAgIFwiY3JlYXRlXCI6IHtcbiAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDMsXG4gICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAzLFxuICAgICAgICAgICAgICBcInNpbmdsZUNhbGxiYWNrQXJnXCI6IHRydWVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcImVsZW1lbnRzXCI6IHtcbiAgICAgICAgICAgICAgXCJjcmVhdGVTaWRlYmFyUGFuZVwiOiB7XG4gICAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJkb3dubG9hZHNcIjoge1xuICAgICAgICAgIFwiY2FuY2VsXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZG93bmxvYWRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJlcmFzZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldEZpbGVJY29uXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwib3BlblwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJmYWxsYmFja1RvTm9DYWxsYmFja1wiOiB0cnVlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInBhdXNlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicmVtb3ZlRmlsZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInJlc3VtZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInNlYXJjaFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInNob3dcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwiZmFsbGJhY2tUb05vQ2FsbGJhY2tcIjogdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJleHRlbnNpb25cIjoge1xuICAgICAgICAgIFwiaXNBbGxvd2VkRmlsZVNjaGVtZUFjY2Vzc1wiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImlzQWxsb3dlZEluY29nbml0b0FjY2Vzc1wiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcImhpc3RvcnlcIjoge1xuICAgICAgICAgIFwiYWRkVXJsXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZGVsZXRlQWxsXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDBcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZGVsZXRlUmFuZ2VcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJkZWxldGVVcmxcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRWaXNpdHNcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZWFyY2hcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJpMThuXCI6IHtcbiAgICAgICAgICBcImRldGVjdExhbmd1YWdlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0QWNjZXB0TGFuZ3VhZ2VzXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDBcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwiaWRlbnRpdHlcIjoge1xuICAgICAgICAgIFwibGF1bmNoV2ViQXV0aEZsb3dcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJpZGxlXCI6IHtcbiAgICAgICAgICBcInF1ZXJ5U3RhdGVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJtYW5hZ2VtZW50XCI6IHtcbiAgICAgICAgICBcImdldFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldEFsbFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldFNlbGZcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZXRFbmFibGVkXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAyLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwidW5pbnN0YWxsU2VsZlwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcIm5vdGlmaWNhdGlvbnNcIjoge1xuICAgICAgICAgIFwiY2xlYXJcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJjcmVhdGVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMlxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRBbGxcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRQZXJtaXNzaW9uTGV2ZWxcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJ1cGRhdGVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDIsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMlxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJwYWdlQWN0aW9uXCI6IHtcbiAgICAgICAgICBcImdldFBvcHVwXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0VGl0bGVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJoaWRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDEsXG4gICAgICAgICAgICBcImZhbGxiYWNrVG9Ob0NhbGxiYWNrXCI6IHRydWVcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2V0SWNvblwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInNldFBvcHVwXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDEsXG4gICAgICAgICAgICBcImZhbGxiYWNrVG9Ob0NhbGxiYWNrXCI6IHRydWVcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2V0VGl0bGVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwiZmFsbGJhY2tUb05vQ2FsbGJhY2tcIjogdHJ1ZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzaG93XCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDEsXG4gICAgICAgICAgICBcImZhbGxiYWNrVG9Ob0NhbGxiYWNrXCI6IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwicGVybWlzc2lvbnNcIjoge1xuICAgICAgICAgIFwiY29udGFpbnNcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRBbGxcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZXF1ZXN0XCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwicnVudGltZVwiOiB7XG4gICAgICAgICAgXCJnZXRCYWNrZ3JvdW5kUGFnZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldFBsYXRmb3JtSW5mb1wiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcIm9wZW5PcHRpb25zUGFnZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInJlcXVlc3RVcGRhdGVDaGVja1wiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInNlbmRNZXNzYWdlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDNcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2VuZE5hdGl2ZU1lc3NhZ2VcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDIsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMlxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZXRVbmluc3RhbGxVUkxcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJzZXNzaW9uc1wiOiB7XG4gICAgICAgICAgXCJnZXREZXZpY2VzXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0UmVjZW50bHlDbG9zZWRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZXN0b3JlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwic3RvcmFnZVwiOiB7XG4gICAgICAgICAgXCJsb2NhbFwiOiB7XG4gICAgICAgICAgICBcImNsZWFyXCI6IHtcbiAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJnZXRcIjoge1xuICAgICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcImdldEJ5dGVzSW5Vc2VcIjoge1xuICAgICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcInJlbW92ZVwiOiB7XG4gICAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwic2V0XCI6IHtcbiAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBcIm1hbmFnZWRcIjoge1xuICAgICAgICAgICAgXCJnZXRcIjoge1xuICAgICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcImdldEJ5dGVzSW5Vc2VcIjoge1xuICAgICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic3luY1wiOiB7XG4gICAgICAgICAgICBcImNsZWFyXCI6IHtcbiAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJnZXRcIjoge1xuICAgICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcImdldEJ5dGVzSW5Vc2VcIjoge1xuICAgICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcInJlbW92ZVwiOiB7XG4gICAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwic2V0XCI6IHtcbiAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcInRhYnNcIjoge1xuICAgICAgICAgIFwiY2FwdHVyZVZpc2libGVUYWJcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMlxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJjcmVhdGVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJkZXRlY3RMYW5ndWFnZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImRpc2NhcmRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJkdXBsaWNhdGVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJleGVjdXRlU2NyaXB0XCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0XCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0Q3VycmVudFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldFpvb21cIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRab29tU2V0dGluZ3NcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnb0JhY2tcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnb0ZvcndhcmRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJoaWdobGlnaHRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJpbnNlcnRDU1NcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMlxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJtb3ZlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAyLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicXVlcnlcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZWxvYWRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMlxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVDU1NcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMlxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZW5kTWVzc2FnZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMixcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAzXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInNldFpvb21cIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMlxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZXRab29tU2V0dGluZ3NcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMlxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJ1cGRhdGVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMlxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJ0b3BTaXRlc1wiOiB7XG4gICAgICAgICAgXCJnZXRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJ3ZWJOYXZpZ2F0aW9uXCI6IHtcbiAgICAgICAgICBcImdldEFsbEZyYW1lc1wiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldEZyYW1lXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwid2ViUmVxdWVzdFwiOiB7XG4gICAgICAgICAgXCJoYW5kbGVyQmVoYXZpb3JDaGFuZ2VkXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDBcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwid2luZG93c1wiOiB7XG4gICAgICAgICAgXCJjcmVhdGVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMlxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRBbGxcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRDdXJyZW50XCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0TGFzdEZvY3VzZWRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJ1cGRhdGVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDIsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMlxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgaWYgKE9iamVjdC5rZXlzKGFwaU1ldGFkYXRhKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYXBpLW1ldGFkYXRhLmpzb24gaGFzIG5vdCBiZWVuIGluY2x1ZGVkIGluIGJyb3dzZXItcG9seWZpbGxcIik7XG4gICAgICB9XG4gICAgICAvKipcbiAgICAgICAqIEEgV2Vha01hcCBzdWJjbGFzcyB3aGljaCBjcmVhdGVzIGFuZCBzdG9yZXMgYSB2YWx1ZSBmb3IgYW55IGtleSB3aGljaCBkb2VzXG4gICAgICAgKiBub3QgZXhpc3Qgd2hlbiBhY2Nlc3NlZCwgYnV0IGJlaGF2ZXMgZXhhY3RseSBhcyBhbiBvcmRpbmFyeSBXZWFrTWFwXG4gICAgICAgKiBvdGhlcndpc2UuXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHtmdW5jdGlvbn0gY3JlYXRlSXRlbVxuICAgICAgICogICAgICAgIEEgZnVuY3Rpb24gd2hpY2ggd2lsbCBiZSBjYWxsZWQgaW4gb3JkZXIgdG8gY3JlYXRlIHRoZSB2YWx1ZSBmb3IgYW55XG4gICAgICAgKiAgICAgICAga2V5IHdoaWNoIGRvZXMgbm90IGV4aXN0LCB0aGUgZmlyc3QgdGltZSBpdCBpcyBhY2Nlc3NlZC4gVGhlXG4gICAgICAgKiAgICAgICAgZnVuY3Rpb24gcmVjZWl2ZXMsIGFzIGl0cyBvbmx5IGFyZ3VtZW50LCB0aGUga2V5IGJlaW5nIGNyZWF0ZWQuXG4gICAgICAgKi9cblxuXG4gICAgICBjbGFzcyBEZWZhdWx0V2Vha01hcCBleHRlbmRzIFdlYWtNYXAge1xuICAgICAgICBjb25zdHJ1Y3RvcihjcmVhdGVJdGVtLCBpdGVtcyA9IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHN1cGVyKGl0ZW1zKTtcbiAgICAgICAgICB0aGlzLmNyZWF0ZUl0ZW0gPSBjcmVhdGVJdGVtO1xuICAgICAgICB9XG5cbiAgICAgICAgZ2V0KGtleSkge1xuICAgICAgICAgIGlmICghdGhpcy5oYXMoa2V5KSkge1xuICAgICAgICAgICAgdGhpcy5zZXQoa2V5LCB0aGlzLmNyZWF0ZUl0ZW0oa2V5KSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHN1cGVyLmdldChrZXkpO1xuICAgICAgICB9XG5cbiAgICAgIH1cbiAgICAgIC8qKlxuICAgICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBvYmplY3QgaXMgYW4gb2JqZWN0IHdpdGggYSBgdGhlbmAgbWV0aG9kLCBhbmQgY2FuXG4gICAgICAgKiB0aGVyZWZvcmUgYmUgYXNzdW1lZCB0byBiZWhhdmUgYXMgYSBQcm9taXNlLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHRlc3QuXG4gICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGUgdmFsdWUgaXMgdGhlbmFibGUuXG4gICAgICAgKi9cblxuXG4gICAgICBjb25zdCBpc1RoZW5hYmxlID0gdmFsdWUgPT4ge1xuICAgICAgICByZXR1cm4gdmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiB2YWx1ZS50aGVuID09PSBcImZ1bmN0aW9uXCI7XG4gICAgICB9O1xuICAgICAgLyoqXG4gICAgICAgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgZnVuY3Rpb24gd2hpY2gsIHdoZW4gY2FsbGVkLCB3aWxsIHJlc29sdmUgb3IgcmVqZWN0XG4gICAgICAgKiB0aGUgZ2l2ZW4gcHJvbWlzZSBiYXNlZCBvbiBob3cgaXQgaXMgY2FsbGVkOlxuICAgICAgICpcbiAgICAgICAqIC0gSWYsIHdoZW4gY2FsbGVkLCBgY2hyb21lLnJ1bnRpbWUubGFzdEVycm9yYCBjb250YWlucyBhIG5vbi1udWxsIG9iamVjdCxcbiAgICAgICAqICAgdGhlIHByb21pc2UgaXMgcmVqZWN0ZWQgd2l0aCB0aGF0IHZhbHVlLlxuICAgICAgICogLSBJZiB0aGUgZnVuY3Rpb24gaXMgY2FsbGVkIHdpdGggZXhhY3RseSBvbmUgYXJndW1lbnQsIHRoZSBwcm9taXNlIGlzXG4gICAgICAgKiAgIHJlc29sdmVkIHRvIHRoYXQgdmFsdWUuXG4gICAgICAgKiAtIE90aGVyd2lzZSwgdGhlIHByb21pc2UgaXMgcmVzb2x2ZWQgdG8gYW4gYXJyYXkgY29udGFpbmluZyBhbGwgb2YgdGhlXG4gICAgICAgKiAgIGZ1bmN0aW9uJ3MgYXJndW1lbnRzLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBwcm9taXNlXG4gICAgICAgKiAgICAgICAgQW4gb2JqZWN0IGNvbnRhaW5pbmcgdGhlIHJlc29sdXRpb24gYW5kIHJlamVjdGlvbiBmdW5jdGlvbnMgb2YgYVxuICAgICAgICogICAgICAgIHByb21pc2UuXG4gICAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBwcm9taXNlLnJlc29sdmVcbiAgICAgICAqICAgICAgICBUaGUgcHJvbWlzZSdzIHJlc29sdXRpb24gZnVuY3Rpb24uXG4gICAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBwcm9taXNlLnJlamVjdFxuICAgICAgICogICAgICAgIFRoZSBwcm9taXNlJ3MgcmVqZWN0aW9uIGZ1bmN0aW9uLlxuICAgICAgICogQHBhcmFtIHtvYmplY3R9IG1ldGFkYXRhXG4gICAgICAgKiAgICAgICAgTWV0YWRhdGEgYWJvdXQgdGhlIHdyYXBwZWQgbWV0aG9kIHdoaWNoIGhhcyBjcmVhdGVkIHRoZSBjYWxsYmFjay5cbiAgICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gbWV0YWRhdGEuc2luZ2xlQ2FsbGJhY2tBcmdcbiAgICAgICAqICAgICAgICBXaGV0aGVyIG9yIG5vdCB0aGUgcHJvbWlzZSBpcyByZXNvbHZlZCB3aXRoIG9ubHkgdGhlIGZpcnN0XG4gICAgICAgKiAgICAgICAgYXJndW1lbnQgb2YgdGhlIGNhbGxiYWNrLCBhbHRlcm5hdGl2ZWx5IGFuIGFycmF5IG9mIGFsbCB0aGVcbiAgICAgICAqICAgICAgICBjYWxsYmFjayBhcmd1bWVudHMgaXMgcmVzb2x2ZWQuIEJ5IGRlZmF1bHQsIGlmIHRoZSBjYWxsYmFja1xuICAgICAgICogICAgICAgIGZ1bmN0aW9uIGlzIGludm9rZWQgd2l0aCBvbmx5IGEgc2luZ2xlIGFyZ3VtZW50LCB0aGF0IHdpbGwgYmVcbiAgICAgICAqICAgICAgICByZXNvbHZlZCB0byB0aGUgcHJvbWlzZSwgd2hpbGUgYWxsIGFyZ3VtZW50cyB3aWxsIGJlIHJlc29sdmVkIGFzXG4gICAgICAgKiAgICAgICAgYW4gYXJyYXkgaWYgbXVsdGlwbGUgYXJlIGdpdmVuLlxuICAgICAgICpcbiAgICAgICAqIEByZXR1cm5zIHtmdW5jdGlvbn1cbiAgICAgICAqICAgICAgICBUaGUgZ2VuZXJhdGVkIGNhbGxiYWNrIGZ1bmN0aW9uLlxuICAgICAgICovXG5cblxuICAgICAgY29uc3QgbWFrZUNhbGxiYWNrID0gKHByb21pc2UsIG1ldGFkYXRhKSA9PiB7XG4gICAgICAgIHJldHVybiAoLi4uY2FsbGJhY2tBcmdzKSA9PiB7XG4gICAgICAgICAgaWYgKGV4dGVuc2lvbkFQSXMucnVudGltZS5sYXN0RXJyb3IpIHtcbiAgICAgICAgICAgIHByb21pc2UucmVqZWN0KG5ldyBFcnJvcihleHRlbnNpb25BUElzLnJ1bnRpbWUubGFzdEVycm9yLm1lc3NhZ2UpKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKG1ldGFkYXRhLnNpbmdsZUNhbGxiYWNrQXJnIHx8IGNhbGxiYWNrQXJncy5sZW5ndGggPD0gMSAmJiBtZXRhZGF0YS5zaW5nbGVDYWxsYmFja0FyZyAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHByb21pc2UucmVzb2x2ZShjYWxsYmFja0FyZ3NbMF0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwcm9taXNlLnJlc29sdmUoY2FsbGJhY2tBcmdzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9O1xuXG4gICAgICBjb25zdCBwbHVyYWxpemVBcmd1bWVudHMgPSBudW1BcmdzID0+IG51bUFyZ3MgPT0gMSA/IFwiYXJndW1lbnRcIiA6IFwiYXJndW1lbnRzXCI7XG4gICAgICAvKipcbiAgICAgICAqIENyZWF0ZXMgYSB3cmFwcGVyIGZ1bmN0aW9uIGZvciBhIG1ldGhvZCB3aXRoIHRoZSBnaXZlbiBuYW1lIGFuZCBtZXRhZGF0YS5cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgICAgICogICAgICAgIFRoZSBuYW1lIG9mIHRoZSBtZXRob2Qgd2hpY2ggaXMgYmVpbmcgd3JhcHBlZC5cbiAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBtZXRhZGF0YVxuICAgICAgICogICAgICAgIE1ldGFkYXRhIGFib3V0IHRoZSBtZXRob2QgYmVpbmcgd3JhcHBlZC5cbiAgICAgICAqIEBwYXJhbSB7aW50ZWdlcn0gbWV0YWRhdGEubWluQXJnc1xuICAgICAgICogICAgICAgIFRoZSBtaW5pbXVtIG51bWJlciBvZiBhcmd1bWVudHMgd2hpY2ggbXVzdCBiZSBwYXNzZWQgdG8gdGhlXG4gICAgICAgKiAgICAgICAgZnVuY3Rpb24uIElmIGNhbGxlZCB3aXRoIGZld2VyIHRoYW4gdGhpcyBudW1iZXIgb2YgYXJndW1lbnRzLCB0aGVcbiAgICAgICAqICAgICAgICB3cmFwcGVyIHdpbGwgcmFpc2UgYW4gZXhjZXB0aW9uLlxuICAgICAgICogQHBhcmFtIHtpbnRlZ2VyfSBtZXRhZGF0YS5tYXhBcmdzXG4gICAgICAgKiAgICAgICAgVGhlIG1heGltdW0gbnVtYmVyIG9mIGFyZ3VtZW50cyB3aGljaCBtYXkgYmUgcGFzc2VkIHRvIHRoZVxuICAgICAgICogICAgICAgIGZ1bmN0aW9uLiBJZiBjYWxsZWQgd2l0aCBtb3JlIHRoYW4gdGhpcyBudW1iZXIgb2YgYXJndW1lbnRzLCB0aGVcbiAgICAgICAqICAgICAgICB3cmFwcGVyIHdpbGwgcmFpc2UgYW4gZXhjZXB0aW9uLlxuICAgICAgICogQHBhcmFtIHtib29sZWFufSBtZXRhZGF0YS5zaW5nbGVDYWxsYmFja0FyZ1xuICAgICAgICogICAgICAgIFdoZXRoZXIgb3Igbm90IHRoZSBwcm9taXNlIGlzIHJlc29sdmVkIHdpdGggb25seSB0aGUgZmlyc3RcbiAgICAgICAqICAgICAgICBhcmd1bWVudCBvZiB0aGUgY2FsbGJhY2ssIGFsdGVybmF0aXZlbHkgYW4gYXJyYXkgb2YgYWxsIHRoZVxuICAgICAgICogICAgICAgIGNhbGxiYWNrIGFyZ3VtZW50cyBpcyByZXNvbHZlZC4gQnkgZGVmYXVsdCwgaWYgdGhlIGNhbGxiYWNrXG4gICAgICAgKiAgICAgICAgZnVuY3Rpb24gaXMgaW52b2tlZCB3aXRoIG9ubHkgYSBzaW5nbGUgYXJndW1lbnQsIHRoYXQgd2lsbCBiZVxuICAgICAgICogICAgICAgIHJlc29sdmVkIHRvIHRoZSBwcm9taXNlLCB3aGlsZSBhbGwgYXJndW1lbnRzIHdpbGwgYmUgcmVzb2x2ZWQgYXNcbiAgICAgICAqICAgICAgICBhbiBhcnJheSBpZiBtdWx0aXBsZSBhcmUgZ2l2ZW4uXG4gICAgICAgKlxuICAgICAgICogQHJldHVybnMge2Z1bmN0aW9uKG9iamVjdCwgLi4uKil9XG4gICAgICAgKiAgICAgICBUaGUgZ2VuZXJhdGVkIHdyYXBwZXIgZnVuY3Rpb24uXG4gICAgICAgKi9cblxuXG4gICAgICBjb25zdCB3cmFwQXN5bmNGdW5jdGlvbiA9IChuYW1lLCBtZXRhZGF0YSkgPT4ge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gYXN5bmNGdW5jdGlvbldyYXBwZXIodGFyZ2V0LCAuLi5hcmdzKSB7XG4gICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoIDwgbWV0YWRhdGEubWluQXJncykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFeHBlY3RlZCBhdCBsZWFzdCAke21ldGFkYXRhLm1pbkFyZ3N9ICR7cGx1cmFsaXplQXJndW1lbnRzKG1ldGFkYXRhLm1pbkFyZ3MpfSBmb3IgJHtuYW1lfSgpLCBnb3QgJHthcmdzLmxlbmd0aH1gKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPiBtZXRhZGF0YS5tYXhBcmdzKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEV4cGVjdGVkIGF0IG1vc3QgJHttZXRhZGF0YS5tYXhBcmdzfSAke3BsdXJhbGl6ZUFyZ3VtZW50cyhtZXRhZGF0YS5tYXhBcmdzKX0gZm9yICR7bmFtZX0oKSwgZ290ICR7YXJncy5sZW5ndGh9YCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIGlmIChtZXRhZGF0YS5mYWxsYmFja1RvTm9DYWxsYmFjaykge1xuICAgICAgICAgICAgICAvLyBUaGlzIEFQSSBtZXRob2QgaGFzIGN1cnJlbnRseSBubyBjYWxsYmFjayBvbiBDaHJvbWUsIGJ1dCBpdCByZXR1cm4gYSBwcm9taXNlIG9uIEZpcmVmb3gsXG4gICAgICAgICAgICAgIC8vIGFuZCBzbyB0aGUgcG9seWZpbGwgd2lsbCB0cnkgdG8gY2FsbCBpdCB3aXRoIGEgY2FsbGJhY2sgZmlyc3QsIGFuZCBpdCB3aWxsIGZhbGxiYWNrXG4gICAgICAgICAgICAgIC8vIHRvIG5vdCBwYXNzaW5nIHRoZSBjYWxsYmFjayBpZiB0aGUgZmlyc3QgY2FsbCBmYWlscy5cbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0YXJnZXRbbmFtZV0oLi4uYXJncywgbWFrZUNhbGxiYWNrKHtcbiAgICAgICAgICAgICAgICAgIHJlc29sdmUsXG4gICAgICAgICAgICAgICAgICByZWplY3RcbiAgICAgICAgICAgICAgICB9LCBtZXRhZGF0YSkpO1xuICAgICAgICAgICAgICB9IGNhdGNoIChjYkVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGAke25hbWV9IEFQSSBtZXRob2QgZG9lc24ndCBzZWVtIHRvIHN1cHBvcnQgdGhlIGNhbGxiYWNrIHBhcmFtZXRlciwgYCArIFwiZmFsbGluZyBiYWNrIHRvIGNhbGwgaXQgd2l0aG91dCBhIGNhbGxiYWNrOiBcIiwgY2JFcnJvcik7XG4gICAgICAgICAgICAgICAgdGFyZ2V0W25hbWVdKC4uLmFyZ3MpOyAvLyBVcGRhdGUgdGhlIEFQSSBtZXRob2QgbWV0YWRhdGEsIHNvIHRoYXQgdGhlIG5leHQgQVBJIGNhbGxzIHdpbGwgbm90IHRyeSB0b1xuICAgICAgICAgICAgICAgIC8vIHVzZSB0aGUgdW5zdXBwb3J0ZWQgY2FsbGJhY2sgYW55bW9yZS5cblxuICAgICAgICAgICAgICAgIG1ldGFkYXRhLmZhbGxiYWNrVG9Ob0NhbGxiYWNrID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbWV0YWRhdGEubm9DYWxsYmFjayA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1ldGFkYXRhLm5vQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgdGFyZ2V0W25hbWVdKC4uLmFyZ3MpO1xuICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0YXJnZXRbbmFtZV0oLi4uYXJncywgbWFrZUNhbGxiYWNrKHtcbiAgICAgICAgICAgICAgICByZXNvbHZlLFxuICAgICAgICAgICAgICAgIHJlamVjdFxuICAgICAgICAgICAgICB9LCBtZXRhZGF0YSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIC8qKlxuICAgICAgICogV3JhcHMgYW4gZXhpc3RpbmcgbWV0aG9kIG9mIHRoZSB0YXJnZXQgb2JqZWN0LCBzbyB0aGF0IGNhbGxzIHRvIGl0IGFyZVxuICAgICAgICogaW50ZXJjZXB0ZWQgYnkgdGhlIGdpdmVuIHdyYXBwZXIgZnVuY3Rpb24uIFRoZSB3cmFwcGVyIGZ1bmN0aW9uIHJlY2VpdmVzLFxuICAgICAgICogYXMgaXRzIGZpcnN0IGFyZ3VtZW50LCB0aGUgb3JpZ2luYWwgYHRhcmdldGAgb2JqZWN0LCBmb2xsb3dlZCBieSBlYWNoIG9mXG4gICAgICAgKiB0aGUgYXJndW1lbnRzIHBhc3NlZCB0byB0aGUgb3JpZ2luYWwgbWV0aG9kLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSB0YXJnZXRcbiAgICAgICAqICAgICAgICBUaGUgb3JpZ2luYWwgdGFyZ2V0IG9iamVjdCB0aGF0IHRoZSB3cmFwcGVkIG1ldGhvZCBiZWxvbmdzIHRvLlxuICAgICAgICogQHBhcmFtIHtmdW5jdGlvbn0gbWV0aG9kXG4gICAgICAgKiAgICAgICAgVGhlIG1ldGhvZCBiZWluZyB3cmFwcGVkLiBUaGlzIGlzIHVzZWQgYXMgdGhlIHRhcmdldCBvZiB0aGUgUHJveHlcbiAgICAgICAqICAgICAgICBvYmplY3Qgd2hpY2ggaXMgY3JlYXRlZCB0byB3cmFwIHRoZSBtZXRob2QuXG4gICAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSB3cmFwcGVyXG4gICAgICAgKiAgICAgICAgVGhlIHdyYXBwZXIgZnVuY3Rpb24gd2hpY2ggaXMgY2FsbGVkIGluIHBsYWNlIG9mIGEgZGlyZWN0IGludm9jYXRpb25cbiAgICAgICAqICAgICAgICBvZiB0aGUgd3JhcHBlZCBtZXRob2QuXG4gICAgICAgKlxuICAgICAgICogQHJldHVybnMge1Byb3h5PGZ1bmN0aW9uPn1cbiAgICAgICAqICAgICAgICBBIFByb3h5IG9iamVjdCBmb3IgdGhlIGdpdmVuIG1ldGhvZCwgd2hpY2ggaW52b2tlcyB0aGUgZ2l2ZW4gd3JhcHBlclxuICAgICAgICogICAgICAgIG1ldGhvZCBpbiBpdHMgcGxhY2UuXG4gICAgICAgKi9cblxuXG4gICAgICBjb25zdCB3cmFwTWV0aG9kID0gKHRhcmdldCwgbWV0aG9kLCB3cmFwcGVyKSA9PiB7XG4gICAgICAgIHJldHVybiBuZXcgUHJveHkobWV0aG9kLCB7XG4gICAgICAgICAgYXBwbHkodGFyZ2V0TWV0aG9kLCB0aGlzT2JqLCBhcmdzKSB7XG4gICAgICAgICAgICByZXR1cm4gd3JhcHBlci5jYWxsKHRoaXNPYmosIHRhcmdldCwgLi4uYXJncyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgbGV0IGhhc093blByb3BlcnR5ID0gRnVuY3Rpb24uY2FsbC5iaW5kKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkpO1xuICAgICAgLyoqXG4gICAgICAgKiBXcmFwcyBhbiBvYmplY3QgaW4gYSBQcm94eSB3aGljaCBpbnRlcmNlcHRzIGFuZCB3cmFwcyBjZXJ0YWluIG1ldGhvZHNcbiAgICAgICAqIGJhc2VkIG9uIHRoZSBnaXZlbiBgd3JhcHBlcnNgIGFuZCBgbWV0YWRhdGFgIG9iamVjdHMuXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHtvYmplY3R9IHRhcmdldFxuICAgICAgICogICAgICAgIFRoZSB0YXJnZXQgb2JqZWN0IHRvIHdyYXAuXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHtvYmplY3R9IFt3cmFwcGVycyA9IHt9XVxuICAgICAgICogICAgICAgIEFuIG9iamVjdCB0cmVlIGNvbnRhaW5pbmcgd3JhcHBlciBmdW5jdGlvbnMgZm9yIHNwZWNpYWwgY2FzZXMuIEFueVxuICAgICAgICogICAgICAgIGZ1bmN0aW9uIHByZXNlbnQgaW4gdGhpcyBvYmplY3QgdHJlZSBpcyBjYWxsZWQgaW4gcGxhY2Ugb2YgdGhlXG4gICAgICAgKiAgICAgICAgbWV0aG9kIGluIHRoZSBzYW1lIGxvY2F0aW9uIGluIHRoZSBgdGFyZ2V0YCBvYmplY3QgdHJlZS4gVGhlc2VcbiAgICAgICAqICAgICAgICB3cmFwcGVyIG1ldGhvZHMgYXJlIGludm9rZWQgYXMgZGVzY3JpYmVkIGluIHtAc2VlIHdyYXBNZXRob2R9LlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBbbWV0YWRhdGEgPSB7fV1cbiAgICAgICAqICAgICAgICBBbiBvYmplY3QgdHJlZSBjb250YWluaW5nIG1ldGFkYXRhIHVzZWQgdG8gYXV0b21hdGljYWxseSBnZW5lcmF0ZVxuICAgICAgICogICAgICAgIFByb21pc2UtYmFzZWQgd3JhcHBlciBmdW5jdGlvbnMgZm9yIGFzeW5jaHJvbm91cy4gQW55IGZ1bmN0aW9uIGluXG4gICAgICAgKiAgICAgICAgdGhlIGB0YXJnZXRgIG9iamVjdCB0cmVlIHdoaWNoIGhhcyBhIGNvcnJlc3BvbmRpbmcgbWV0YWRhdGEgb2JqZWN0XG4gICAgICAgKiAgICAgICAgaW4gdGhlIHNhbWUgbG9jYXRpb24gaW4gdGhlIGBtZXRhZGF0YWAgdHJlZSBpcyByZXBsYWNlZCB3aXRoIGFuXG4gICAgICAgKiAgICAgICAgYXV0b21hdGljYWxseS1nZW5lcmF0ZWQgd3JhcHBlciBmdW5jdGlvbiwgYXMgZGVzY3JpYmVkIGluXG4gICAgICAgKiAgICAgICAge0BzZWUgd3JhcEFzeW5jRnVuY3Rpb259XG4gICAgICAgKlxuICAgICAgICogQHJldHVybnMge1Byb3h5PG9iamVjdD59XG4gICAgICAgKi9cblxuICAgICAgY29uc3Qgd3JhcE9iamVjdCA9ICh0YXJnZXQsIHdyYXBwZXJzID0ge30sIG1ldGFkYXRhID0ge30pID0+IHtcbiAgICAgICAgbGV0IGNhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgbGV0IGhhbmRsZXJzID0ge1xuICAgICAgICAgIGhhcyhwcm94eVRhcmdldCwgcHJvcCkge1xuICAgICAgICAgICAgcmV0dXJuIHByb3AgaW4gdGFyZ2V0IHx8IHByb3AgaW4gY2FjaGU7XG4gICAgICAgICAgfSxcblxuICAgICAgICAgIGdldChwcm94eVRhcmdldCwgcHJvcCwgcmVjZWl2ZXIpIHtcbiAgICAgICAgICAgIGlmIChwcm9wIGluIGNhY2hlKSB7XG4gICAgICAgICAgICAgIHJldHVybiBjYWNoZVtwcm9wXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCEocHJvcCBpbiB0YXJnZXQpKSB7XG4gICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCB2YWx1ZSA9IHRhcmdldFtwcm9wXTtcblxuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBtZXRob2Qgb24gdGhlIHVuZGVybHlpbmcgb2JqZWN0LiBDaGVjayBpZiB3ZSBuZWVkIHRvIGRvXG4gICAgICAgICAgICAgIC8vIGFueSB3cmFwcGluZy5cbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiB3cmFwcGVyc1twcm9wXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgLy8gV2UgaGF2ZSBhIHNwZWNpYWwtY2FzZSB3cmFwcGVyIGZvciB0aGlzIG1ldGhvZC5cbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHdyYXBNZXRob2QodGFyZ2V0LCB0YXJnZXRbcHJvcF0sIHdyYXBwZXJzW3Byb3BdKTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChoYXNPd25Qcm9wZXJ0eShtZXRhZGF0YSwgcHJvcCkpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIGFuIGFzeW5jIG1ldGhvZCB0aGF0IHdlIGhhdmUgbWV0YWRhdGEgZm9yLiBDcmVhdGUgYVxuICAgICAgICAgICAgICAgIC8vIFByb21pc2Ugd3JhcHBlciBmb3IgaXQuXG4gICAgICAgICAgICAgICAgbGV0IHdyYXBwZXIgPSB3cmFwQXN5bmNGdW5jdGlvbihwcm9wLCBtZXRhZGF0YVtwcm9wXSk7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB3cmFwTWV0aG9kKHRhcmdldCwgdGFyZ2V0W3Byb3BdLCB3cmFwcGVyKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIGEgbWV0aG9kIHRoYXQgd2UgZG9uJ3Qga25vdyBvciBjYXJlIGFib3V0LiBSZXR1cm4gdGhlXG4gICAgICAgICAgICAgICAgLy8gb3JpZ2luYWwgbWV0aG9kLCBib3VuZCB0byB0aGUgdW5kZXJseWluZyBvYmplY3QuXG4gICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5iaW5kKHRhcmdldCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiICYmIHZhbHVlICE9PSBudWxsICYmIChoYXNPd25Qcm9wZXJ0eSh3cmFwcGVycywgcHJvcCkgfHwgaGFzT3duUHJvcGVydHkobWV0YWRhdGEsIHByb3ApKSkge1xuICAgICAgICAgICAgICAvLyBUaGlzIGlzIGFuIG9iamVjdCB0aGF0IHdlIG5lZWQgdG8gZG8gc29tZSB3cmFwcGluZyBmb3IgdGhlIGNoaWxkcmVuXG4gICAgICAgICAgICAgIC8vIG9mLiBDcmVhdGUgYSBzdWItb2JqZWN0IHdyYXBwZXIgZm9yIGl0IHdpdGggdGhlIGFwcHJvcHJpYXRlIGNoaWxkXG4gICAgICAgICAgICAgIC8vIG1ldGFkYXRhLlxuICAgICAgICAgICAgICB2YWx1ZSA9IHdyYXBPYmplY3QodmFsdWUsIHdyYXBwZXJzW3Byb3BdLCBtZXRhZGF0YVtwcm9wXSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGhhc093blByb3BlcnR5KG1ldGFkYXRhLCBcIipcIikpIHtcbiAgICAgICAgICAgICAgLy8gV3JhcCBhbGwgcHJvcGVydGllcyBpbiAqIG5hbWVzcGFjZS5cbiAgICAgICAgICAgICAgdmFsdWUgPSB3cmFwT2JqZWN0KHZhbHVlLCB3cmFwcGVyc1twcm9wXSwgbWV0YWRhdGFbXCIqXCJdKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIC8vIFdlIGRvbid0IG5lZWQgdG8gZG8gYW55IHdyYXBwaW5nIGZvciB0aGlzIHByb3BlcnR5LFxuICAgICAgICAgICAgICAvLyBzbyBqdXN0IGZvcndhcmQgYWxsIGFjY2VzcyB0byB0aGUgdW5kZXJseWluZyBvYmplY3QuXG4gICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjYWNoZSwgcHJvcCwge1xuICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuXG4gICAgICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldFtwcm9wXTtcbiAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICB0YXJnZXRbcHJvcF0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FjaGVbcHJvcF0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICB9LFxuXG4gICAgICAgICAgc2V0KHByb3h5VGFyZ2V0LCBwcm9wLCB2YWx1ZSwgcmVjZWl2ZXIpIHtcbiAgICAgICAgICAgIGlmIChwcm9wIGluIGNhY2hlKSB7XG4gICAgICAgICAgICAgIGNhY2hlW3Byb3BdID0gdmFsdWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0YXJnZXRbcHJvcF0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfSxcblxuICAgICAgICAgIGRlZmluZVByb3BlcnR5KHByb3h5VGFyZ2V0LCBwcm9wLCBkZXNjKSB7XG4gICAgICAgICAgICByZXR1cm4gUmVmbGVjdC5kZWZpbmVQcm9wZXJ0eShjYWNoZSwgcHJvcCwgZGVzYyk7XG4gICAgICAgICAgfSxcblxuICAgICAgICAgIGRlbGV0ZVByb3BlcnR5KHByb3h5VGFyZ2V0LCBwcm9wKSB7XG4gICAgICAgICAgICByZXR1cm4gUmVmbGVjdC5kZWxldGVQcm9wZXJ0eShjYWNoZSwgcHJvcCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgIH07IC8vIFBlciBjb250cmFjdCBvZiB0aGUgUHJveHkgQVBJLCB0aGUgXCJnZXRcIiBwcm94eSBoYW5kbGVyIG11c3QgcmV0dXJuIHRoZVxuICAgICAgICAvLyBvcmlnaW5hbCB2YWx1ZSBvZiB0aGUgdGFyZ2V0IGlmIHRoYXQgdmFsdWUgaXMgZGVjbGFyZWQgcmVhZC1vbmx5IGFuZFxuICAgICAgICAvLyBub24tY29uZmlndXJhYmxlLiBGb3IgdGhpcyByZWFzb24sIHdlIGNyZWF0ZSBhbiBvYmplY3Qgd2l0aCB0aGVcbiAgICAgICAgLy8gcHJvdG90eXBlIHNldCB0byBgdGFyZ2V0YCBpbnN0ZWFkIG9mIHVzaW5nIGB0YXJnZXRgIGRpcmVjdGx5LlxuICAgICAgICAvLyBPdGhlcndpc2Ugd2UgY2Fubm90IHJldHVybiBhIGN1c3RvbSBvYmplY3QgZm9yIEFQSXMgdGhhdFxuICAgICAgICAvLyBhcmUgZGVjbGFyZWQgcmVhZC1vbmx5IGFuZCBub24tY29uZmlndXJhYmxlLCBzdWNoIGFzIGBjaHJvbWUuZGV2dG9vbHNgLlxuICAgICAgICAvL1xuICAgICAgICAvLyBUaGUgcHJveHkgaGFuZGxlcnMgdGhlbXNlbHZlcyB3aWxsIHN0aWxsIHVzZSB0aGUgb3JpZ2luYWwgYHRhcmdldGBcbiAgICAgICAgLy8gaW5zdGVhZCBvZiB0aGUgYHByb3h5VGFyZ2V0YCwgc28gdGhhdCB0aGUgbWV0aG9kcyBhbmQgcHJvcGVydGllcyBhcmVcbiAgICAgICAgLy8gZGVyZWZlcmVuY2VkIHZpYSB0aGUgb3JpZ2luYWwgdGFyZ2V0cy5cblxuICAgICAgICBsZXQgcHJveHlUYXJnZXQgPSBPYmplY3QuY3JlYXRlKHRhcmdldCk7XG4gICAgICAgIHJldHVybiBuZXcgUHJveHkocHJveHlUYXJnZXQsIGhhbmRsZXJzKTtcbiAgICAgIH07XG4gICAgICAvKipcbiAgICAgICAqIENyZWF0ZXMgYSBzZXQgb2Ygd3JhcHBlciBmdW5jdGlvbnMgZm9yIGFuIGV2ZW50IG9iamVjdCwgd2hpY2ggaGFuZGxlc1xuICAgICAgICogd3JhcHBpbmcgb2YgbGlzdGVuZXIgZnVuY3Rpb25zIHRoYXQgdGhvc2UgbWVzc2FnZXMgYXJlIHBhc3NlZC5cbiAgICAgICAqXG4gICAgICAgKiBBIHNpbmdsZSB3cmFwcGVyIGlzIGNyZWF0ZWQgZm9yIGVhY2ggbGlzdGVuZXIgZnVuY3Rpb24sIGFuZCBzdG9yZWQgaW4gYVxuICAgICAgICogbWFwLiBTdWJzZXF1ZW50IGNhbGxzIHRvIGBhZGRMaXN0ZW5lcmAsIGBoYXNMaXN0ZW5lcmAsIG9yIGByZW1vdmVMaXN0ZW5lcmBcbiAgICAgICAqIHJldHJpZXZlIHRoZSBvcmlnaW5hbCB3cmFwcGVyLCBzbyB0aGF0ICBhdHRlbXB0cyB0byByZW1vdmUgYVxuICAgICAgICogcHJldmlvdXNseS1hZGRlZCBsaXN0ZW5lciB3b3JrIGFzIGV4cGVjdGVkLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7RGVmYXVsdFdlYWtNYXA8ZnVuY3Rpb24sIGZ1bmN0aW9uPn0gd3JhcHBlck1hcFxuICAgICAgICogICAgICAgIEEgRGVmYXVsdFdlYWtNYXAgb2JqZWN0IHdoaWNoIHdpbGwgY3JlYXRlIHRoZSBhcHByb3ByaWF0ZSB3cmFwcGVyXG4gICAgICAgKiAgICAgICAgZm9yIGEgZ2l2ZW4gbGlzdGVuZXIgZnVuY3Rpb24gd2hlbiBvbmUgZG9lcyBub3QgZXhpc3QsIGFuZCByZXRyaWV2ZVxuICAgICAgICogICAgICAgIGFuIGV4aXN0aW5nIG9uZSB3aGVuIGl0IGRvZXMuXG4gICAgICAgKlxuICAgICAgICogQHJldHVybnMge29iamVjdH1cbiAgICAgICAqL1xuXG5cbiAgICAgIGNvbnN0IHdyYXBFdmVudCA9IHdyYXBwZXJNYXAgPT4gKHtcbiAgICAgICAgYWRkTGlzdGVuZXIodGFyZ2V0LCBsaXN0ZW5lciwgLi4uYXJncykge1xuICAgICAgICAgIHRhcmdldC5hZGRMaXN0ZW5lcih3cmFwcGVyTWFwLmdldChsaXN0ZW5lciksIC4uLmFyZ3MpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGhhc0xpc3RlbmVyKHRhcmdldCwgbGlzdGVuZXIpIHtcbiAgICAgICAgICByZXR1cm4gdGFyZ2V0Lmhhc0xpc3RlbmVyKHdyYXBwZXJNYXAuZ2V0KGxpc3RlbmVyKSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVtb3ZlTGlzdGVuZXIodGFyZ2V0LCBsaXN0ZW5lcikge1xuICAgICAgICAgIHRhcmdldC5yZW1vdmVMaXN0ZW5lcih3cmFwcGVyTWFwLmdldChsaXN0ZW5lcikpO1xuICAgICAgICB9XG5cbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBvblJlcXVlc3RGaW5pc2hlZFdyYXBwZXJzID0gbmV3IERlZmF1bHRXZWFrTWFwKGxpc3RlbmVyID0+IHtcbiAgICAgICAgaWYgKHR5cGVvZiBsaXN0ZW5lciAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgcmV0dXJuIGxpc3RlbmVyO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXcmFwcyBhbiBvblJlcXVlc3RGaW5pc2hlZCBsaXN0ZW5lciBmdW5jdGlvbiBzbyB0aGF0IGl0IHdpbGwgcmV0dXJuIGFcbiAgICAgICAgICogYGdldENvbnRlbnQoKWAgcHJvcGVydHkgd2hpY2ggcmV0dXJucyBhIGBQcm9taXNlYCByYXRoZXIgdGhhbiB1c2luZyBhXG4gICAgICAgICAqIGNhbGxiYWNrIEFQSS5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHJlcVxuICAgICAgICAgKiAgICAgICAgVGhlIEhBUiBlbnRyeSBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBuZXR3b3JrIHJlcXVlc3QuXG4gICAgICAgICAqL1xuXG5cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIG9uUmVxdWVzdEZpbmlzaGVkKHJlcSkge1xuICAgICAgICAgIGNvbnN0IHdyYXBwZWRSZXEgPSB3cmFwT2JqZWN0KHJlcSwge31cbiAgICAgICAgICAvKiB3cmFwcGVycyAqL1xuICAgICAgICAgICwge1xuICAgICAgICAgICAgZ2V0Q29udGVudDoge1xuICAgICAgICAgICAgICBtaW5BcmdzOiAwLFxuICAgICAgICAgICAgICBtYXhBcmdzOiAwXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgbGlzdGVuZXIod3JhcHBlZFJlcSk7XG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICAgIGNvbnN0IG9uTWVzc2FnZVdyYXBwZXJzID0gbmV3IERlZmF1bHRXZWFrTWFwKGxpc3RlbmVyID0+IHtcbiAgICAgICAgaWYgKHR5cGVvZiBsaXN0ZW5lciAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgcmV0dXJuIGxpc3RlbmVyO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXcmFwcyBhIG1lc3NhZ2UgbGlzdGVuZXIgZnVuY3Rpb24gc28gdGhhdCBpdCBtYXkgc2VuZCByZXNwb25zZXMgYmFzZWQgb25cbiAgICAgICAgICogaXRzIHJldHVybiB2YWx1ZSwgcmF0aGVyIHRoYW4gYnkgcmV0dXJuaW5nIGEgc2VudGluZWwgdmFsdWUgYW5kIGNhbGxpbmcgYVxuICAgICAgICAgKiBjYWxsYmFjay4gSWYgdGhlIGxpc3RlbmVyIGZ1bmN0aW9uIHJldHVybnMgYSBQcm9taXNlLCB0aGUgcmVzcG9uc2UgaXNcbiAgICAgICAgICogc2VudCB3aGVuIHRoZSBwcm9taXNlIGVpdGhlciByZXNvbHZlcyBvciByZWplY3RzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0geyp9IG1lc3NhZ2VcbiAgICAgICAgICogICAgICAgIFRoZSBtZXNzYWdlIHNlbnQgYnkgdGhlIG90aGVyIGVuZCBvZiB0aGUgY2hhbm5lbC5cbiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHNlbmRlclxuICAgICAgICAgKiAgICAgICAgRGV0YWlscyBhYm91dCB0aGUgc2VuZGVyIG9mIHRoZSBtZXNzYWdlLlxuICAgICAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCopfSBzZW5kUmVzcG9uc2VcbiAgICAgICAgICogICAgICAgIEEgY2FsbGJhY2sgd2hpY2gsIHdoZW4gY2FsbGVkIHdpdGggYW4gYXJiaXRyYXJ5IGFyZ3VtZW50LCBzZW5kc1xuICAgICAgICAgKiAgICAgICAgdGhhdCB2YWx1ZSBhcyBhIHJlc3BvbnNlLlxuICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgICAgICogICAgICAgIFRydWUgaWYgdGhlIHdyYXBwZWQgbGlzdGVuZXIgcmV0dXJuZWQgYSBQcm9taXNlLCB3aGljaCB3aWxsIGxhdGVyXG4gICAgICAgICAqICAgICAgICB5aWVsZCBhIHJlc3BvbnNlLiBGYWxzZSBvdGhlcndpc2UuXG4gICAgICAgICAqL1xuXG5cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIG9uTWVzc2FnZShtZXNzYWdlLCBzZW5kZXIsIHNlbmRSZXNwb25zZSkge1xuICAgICAgICAgIGxldCBkaWRDYWxsU2VuZFJlc3BvbnNlID0gZmFsc2U7XG4gICAgICAgICAgbGV0IHdyYXBwZWRTZW5kUmVzcG9uc2U7XG4gICAgICAgICAgbGV0IHNlbmRSZXNwb25zZVByb21pc2UgPSBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgICAgIHdyYXBwZWRTZW5kUmVzcG9uc2UgPSBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgZGlkQ2FsbFNlbmRSZXNwb25zZSA9IHRydWU7XG4gICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBsZXQgcmVzdWx0O1xuXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJlc3VsdCA9IGxpc3RlbmVyKG1lc3NhZ2UsIHNlbmRlciwgd3JhcHBlZFNlbmRSZXNwb25zZSk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBQcm9taXNlLnJlamVjdChlcnIpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IGlzUmVzdWx0VGhlbmFibGUgPSByZXN1bHQgIT09IHRydWUgJiYgaXNUaGVuYWJsZShyZXN1bHQpOyAvLyBJZiB0aGUgbGlzdGVuZXIgZGlkbid0IHJldHVybmVkIHRydWUgb3IgYSBQcm9taXNlLCBvciBjYWxsZWRcbiAgICAgICAgICAvLyB3cmFwcGVkU2VuZFJlc3BvbnNlIHN5bmNocm9ub3VzbHksIHdlIGNhbiBleGl0IGVhcmxpZXJcbiAgICAgICAgICAvLyBiZWNhdXNlIHRoZXJlIHdpbGwgYmUgbm8gcmVzcG9uc2Ugc2VudCBmcm9tIHRoaXMgbGlzdGVuZXIuXG5cbiAgICAgICAgICBpZiAocmVzdWx0ICE9PSB0cnVlICYmICFpc1Jlc3VsdFRoZW5hYmxlICYmICFkaWRDYWxsU2VuZFJlc3BvbnNlKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfSAvLyBBIHNtYWxsIGhlbHBlciB0byBzZW5kIHRoZSBtZXNzYWdlIGlmIHRoZSBwcm9taXNlIHJlc29sdmVzXG4gICAgICAgICAgLy8gYW5kIGFuIGVycm9yIGlmIHRoZSBwcm9taXNlIHJlamVjdHMgKGEgd3JhcHBlZCBzZW5kTWVzc2FnZSBoYXNcbiAgICAgICAgICAvLyB0byB0cmFuc2xhdGUgdGhlIG1lc3NhZ2UgaW50byBhIHJlc29sdmVkIHByb21pc2Ugb3IgYSByZWplY3RlZFxuICAgICAgICAgIC8vIHByb21pc2UpLlxuXG5cbiAgICAgICAgICBjb25zdCBzZW5kUHJvbWlzZWRSZXN1bHQgPSBwcm9taXNlID0+IHtcbiAgICAgICAgICAgIHByb21pc2UudGhlbihtc2cgPT4ge1xuICAgICAgICAgICAgICAvLyBzZW5kIHRoZSBtZXNzYWdlIHZhbHVlLlxuICAgICAgICAgICAgICBzZW5kUmVzcG9uc2UobXNnKTtcbiAgICAgICAgICAgIH0sIGVycm9yID0+IHtcbiAgICAgICAgICAgICAgLy8gU2VuZCBhIEpTT04gcmVwcmVzZW50YXRpb24gb2YgdGhlIGVycm9yIGlmIHRoZSByZWplY3RlZCB2YWx1ZVxuICAgICAgICAgICAgICAvLyBpcyBhbiBpbnN0YW5jZSBvZiBlcnJvciwgb3IgdGhlIG9iamVjdCBpdHNlbGYgb3RoZXJ3aXNlLlxuICAgICAgICAgICAgICBsZXQgbWVzc2FnZTtcblxuICAgICAgICAgICAgICBpZiAoZXJyb3IgJiYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgfHwgdHlwZW9mIGVycm9yLm1lc3NhZ2UgPT09IFwic3RyaW5nXCIpKSB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IGVycm9yLm1lc3NhZ2U7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IFwiQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZFwiO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgc2VuZFJlc3BvbnNlKHtcbiAgICAgICAgICAgICAgICBfX21veldlYkV4dGVuc2lvblBvbHlmaWxsUmVqZWN0X186IHRydWUsXG4gICAgICAgICAgICAgICAgbWVzc2FnZVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgICAgIC8vIFByaW50IGFuIGVycm9yIG9uIHRoZSBjb25zb2xlIGlmIHVuYWJsZSB0byBzZW5kIHRoZSByZXNwb25zZS5cbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBzZW5kIG9uTWVzc2FnZSByZWplY3RlZCByZXBseVwiLCBlcnIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfTsgLy8gSWYgdGhlIGxpc3RlbmVyIHJldHVybmVkIGEgUHJvbWlzZSwgc2VuZCB0aGUgcmVzb2x2ZWQgdmFsdWUgYXMgYVxuICAgICAgICAgIC8vIHJlc3VsdCwgb3RoZXJ3aXNlIHdhaXQgdGhlIHByb21pc2UgcmVsYXRlZCB0byB0aGUgd3JhcHBlZFNlbmRSZXNwb25zZVxuICAgICAgICAgIC8vIGNhbGxiYWNrIHRvIHJlc29sdmUgYW5kIHNlbmQgaXQgYXMgYSByZXNwb25zZS5cblxuXG4gICAgICAgICAgaWYgKGlzUmVzdWx0VGhlbmFibGUpIHtcbiAgICAgICAgICAgIHNlbmRQcm9taXNlZFJlc3VsdChyZXN1bHQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZW5kUHJvbWlzZWRSZXN1bHQoc2VuZFJlc3BvbnNlUHJvbWlzZSk7XG4gICAgICAgICAgfSAvLyBMZXQgQ2hyb21lIGtub3cgdGhhdCB0aGUgbGlzdGVuZXIgaXMgcmVwbHlpbmcuXG5cblxuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9O1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHdyYXBwZWRTZW5kTWVzc2FnZUNhbGxiYWNrID0gKHtcbiAgICAgICAgcmVqZWN0LFxuICAgICAgICByZXNvbHZlXG4gICAgICB9LCByZXBseSkgPT4ge1xuICAgICAgICBpZiAoZXh0ZW5zaW9uQVBJcy5ydW50aW1lLmxhc3RFcnJvcikge1xuICAgICAgICAgIC8vIERldGVjdCB3aGVuIG5vbmUgb2YgdGhlIGxpc3RlbmVycyByZXBsaWVkIHRvIHRoZSBzZW5kTWVzc2FnZSBjYWxsIGFuZCByZXNvbHZlXG4gICAgICAgICAgLy8gdGhlIHByb21pc2UgdG8gdW5kZWZpbmVkIGFzIGluIEZpcmVmb3guXG4gICAgICAgICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9tb3ppbGxhL3dlYmV4dGVuc2lvbi1wb2x5ZmlsbC9pc3N1ZXMvMTMwXG4gICAgICAgICAgaWYgKGV4dGVuc2lvbkFQSXMucnVudGltZS5sYXN0RXJyb3IubWVzc2FnZSA9PT0gQ0hST01FX1NFTkRfTUVTU0FHRV9DQUxMQkFDS19OT19SRVNQT05TRV9NRVNTQUdFKSB7XG4gICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoZXh0ZW5zaW9uQVBJcy5ydW50aW1lLmxhc3RFcnJvci5tZXNzYWdlKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHJlcGx5ICYmIHJlcGx5Ll9fbW96V2ViRXh0ZW5zaW9uUG9seWZpbGxSZWplY3RfXykge1xuICAgICAgICAgIC8vIENvbnZlcnQgYmFjayB0aGUgSlNPTiByZXByZXNlbnRhdGlvbiBvZiB0aGUgZXJyb3IgaW50b1xuICAgICAgICAgIC8vIGFuIEVycm9yIGluc3RhbmNlLlxuICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IocmVwbHkubWVzc2FnZSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc29sdmUocmVwbHkpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBjb25zdCB3cmFwcGVkU2VuZE1lc3NhZ2UgPSAobmFtZSwgbWV0YWRhdGEsIGFwaU5hbWVzcGFjZU9iaiwgLi4uYXJncykgPT4ge1xuICAgICAgICBpZiAoYXJncy5sZW5ndGggPCBtZXRhZGF0YS5taW5BcmdzKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFeHBlY3RlZCBhdCBsZWFzdCAke21ldGFkYXRhLm1pbkFyZ3N9ICR7cGx1cmFsaXplQXJndW1lbnRzKG1ldGFkYXRhLm1pbkFyZ3MpfSBmb3IgJHtuYW1lfSgpLCBnb3QgJHthcmdzLmxlbmd0aH1gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhcmdzLmxlbmd0aCA+IG1ldGFkYXRhLm1heEFyZ3MpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEV4cGVjdGVkIGF0IG1vc3QgJHttZXRhZGF0YS5tYXhBcmdzfSAke3BsdXJhbGl6ZUFyZ3VtZW50cyhtZXRhZGF0YS5tYXhBcmdzKX0gZm9yICR7bmFtZX0oKSwgZ290ICR7YXJncy5sZW5ndGh9YCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHdyYXBwZWRDYiA9IHdyYXBwZWRTZW5kTWVzc2FnZUNhbGxiYWNrLmJpbmQobnVsbCwge1xuICAgICAgICAgICAgcmVzb2x2ZSxcbiAgICAgICAgICAgIHJlamVjdFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGFyZ3MucHVzaCh3cmFwcGVkQ2IpO1xuICAgICAgICAgIGFwaU5hbWVzcGFjZU9iai5zZW5kTWVzc2FnZSguLi5hcmdzKTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuXG4gICAgICBjb25zdCBzdGF0aWNXcmFwcGVycyA9IHtcbiAgICAgICAgZGV2dG9vbHM6IHtcbiAgICAgICAgICBuZXR3b3JrOiB7XG4gICAgICAgICAgICBvblJlcXVlc3RGaW5pc2hlZDogd3JhcEV2ZW50KG9uUmVxdWVzdEZpbmlzaGVkV3JhcHBlcnMpXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBydW50aW1lOiB7XG4gICAgICAgICAgb25NZXNzYWdlOiB3cmFwRXZlbnQob25NZXNzYWdlV3JhcHBlcnMpLFxuICAgICAgICAgIG9uTWVzc2FnZUV4dGVybmFsOiB3cmFwRXZlbnQob25NZXNzYWdlV3JhcHBlcnMpLFxuICAgICAgICAgIHNlbmRNZXNzYWdlOiB3cmFwcGVkU2VuZE1lc3NhZ2UuYmluZChudWxsLCBcInNlbmRNZXNzYWdlXCIsIHtcbiAgICAgICAgICAgIG1pbkFyZ3M6IDEsXG4gICAgICAgICAgICBtYXhBcmdzOiAzXG4gICAgICAgICAgfSlcbiAgICAgICAgfSxcbiAgICAgICAgdGFiczoge1xuICAgICAgICAgIHNlbmRNZXNzYWdlOiB3cmFwcGVkU2VuZE1lc3NhZ2UuYmluZChudWxsLCBcInNlbmRNZXNzYWdlXCIsIHtcbiAgICAgICAgICAgIG1pbkFyZ3M6IDIsXG4gICAgICAgICAgICBtYXhBcmdzOiAzXG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIGNvbnN0IHNldHRpbmdNZXRhZGF0YSA9IHtcbiAgICAgICAgY2xlYXI6IHtcbiAgICAgICAgICBtaW5BcmdzOiAxLFxuICAgICAgICAgIG1heEFyZ3M6IDFcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0OiB7XG4gICAgICAgICAgbWluQXJnczogMSxcbiAgICAgICAgICBtYXhBcmdzOiAxXG4gICAgICAgIH0sXG4gICAgICAgIHNldDoge1xuICAgICAgICAgIG1pbkFyZ3M6IDEsXG4gICAgICAgICAgbWF4QXJnczogMVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgYXBpTWV0YWRhdGEucHJpdmFjeSA9IHtcbiAgICAgICAgbmV0d29yazoge1xuICAgICAgICAgIFwiKlwiOiBzZXR0aW5nTWV0YWRhdGFcbiAgICAgICAgfSxcbiAgICAgICAgc2VydmljZXM6IHtcbiAgICAgICAgICBcIipcIjogc2V0dGluZ01ldGFkYXRhXG4gICAgICAgIH0sXG4gICAgICAgIHdlYnNpdGVzOiB7XG4gICAgICAgICAgXCIqXCI6IHNldHRpbmdNZXRhZGF0YVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgcmV0dXJuIHdyYXBPYmplY3QoZXh0ZW5zaW9uQVBJcywgc3RhdGljV3JhcHBlcnMsIGFwaU1ldGFkYXRhKTtcbiAgICB9OyAvLyBUaGUgYnVpbGQgcHJvY2VzcyBhZGRzIGEgVU1EIHdyYXBwZXIgYXJvdW5kIHRoaXMgZmlsZSwgd2hpY2ggbWFrZXMgdGhlXG4gICAgLy8gYG1vZHVsZWAgdmFyaWFibGUgYXZhaWxhYmxlLlxuXG5cbiAgICBtb2R1bGUuZXhwb3J0cyA9IHdyYXBBUElzKGNocm9tZSk7XG4gIH0gZWxzZSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBnbG9iYWxUaGlzLmJyb3dzZXI7XG4gIH1cbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YnJvd3Nlci1wb2x5ZmlsbC5qcy5tYXBcbiIsIi8qIChpZ25vcmVkKSAqLyIsIi8qIChpZ25vcmVkKSAqLyIsIi8qIChpZ25vcmVkKSAqLyIsIi8qIChpZ25vcmVkKSAqLyIsIi8qIChpZ25vcmVkKSAqLyIsIi8qIChpZ25vcmVkKSAqLyIsIi8qIChpZ25vcmVkKSAqLyIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gKG1vZHVsZSkgPT4ge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHQoKSA9PiAobW9kdWxlWydkZWZhdWx0J10pIDpcblx0XHQoKSA9PiAobW9kdWxlKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCIiLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oXCIuL3NyYy9iYWNrZ3JvdW5kLnRzXCIpO1xuIiwiIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9