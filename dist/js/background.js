/*! For license information please see background.js.LICENSE.txt */
(()=>{var e={51719:(e,t,i)=>{"use strict";const r=i(16561);class n extends Error{constructor(e,...t){let i;super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,n),this.name="StatusError",this.message=e.statusMessage,this.statusCode=e.status,this.res=e,this.json=e.json.bind(e),this.text=e.text.bind(e),this.arrayBuffer=e.arrayBuffer.bind(e),Object.defineProperty(this,"responseBody",{get:()=>(i||(i=this.arrayBuffer()),i)}),this.headers={};for(const[t,i]of e.headers.entries())this.headers[t.toLowerCase()]=i}}e.exports=r(((e,t,i,r,s)=>async(o,a,c={})=>{o=s+(o||"");let p=new URL(o);if(r||(r={}),p.username&&(r.Authorization="Basic "+btoa(p.username+":"+p.password),p=new URL(p.protocol+"//"+p.host+p.pathname+p.search)),"https:"!==p.protocol&&"http:"!==p.protocol)throw new Error(`Unknown protocol, ${p.protocol}`);if(a)if(a instanceof ArrayBuffer||ArrayBuffer.isView(a)||"string"==typeof a);else{if("object"!=typeof a)throw new Error("Unknown body type.");a=JSON.stringify(a),r["Content-Type"]="application/json"}c=new Headers({...r||{},...c});const h=await fetch(p,{method:t,headers:c,body:a});if(h.statusCode=h.status,!e.has(h.status))throw new n(h);return"json"===i?h.json():"buffer"===i?h.arrayBuffer():"string"===i?h.text():h}))},16561:e=>{"use strict";const t=new Set(["json","buffer","string"]);e.exports=e=>(...i)=>{const r=new Set;let n,s,o,a="";return i.forEach((e=>{if("string"==typeof e)if(e.toUpperCase()===e){if(n)throw new Error(`Can't set method to ${e}, already set to ${n}.`);n=e}else if(e.startsWith("http:")||e.startsWith("https:"))a=e;else{if(!t.has(e))throw new Error(`Unknown encoding, ${e}`);s=e}else if("number"==typeof e)r.add(e);else{if("object"!=typeof e)throw new Error("Unknown type: "+typeof e);if(Array.isArray(e)||e instanceof Set)e.forEach((e=>r.add(e)));else{if(o)throw new Error("Cannot set headers twice.");o=e}}})),n||(n="GET"),0===r.size&&r.add(200),e(r,n,s,o,a)}},37811:(e,t)=>{"use strict";var i=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,r=/\\([\u000b\u0020-\u00ff])/g,n=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;function s(e){this.parameters=Object.create(null),this.type=e}t.Q=function(e){if(!e)throw new TypeError("argument string is required");var t="object"==typeof e?function(e){var t;if("function"==typeof e.getHeader?t=e.getHeader("content-type"):"object"==typeof e.headers&&(t=e.headers&&e.headers["content-type"]),"string"!=typeof t)throw new TypeError("content-type header is missing from object");return t}(e):e;if("string"!=typeof t)throw new TypeError("argument string is required to be a string");var o=t.indexOf(";"),a=-1!==o?t.slice(0,o).trim():t.trim();if(!n.test(a))throw new TypeError("invalid media type");var c=new s(a.toLowerCase());if(-1!==o){var p,h,u;for(i.lastIndex=o;h=i.exec(t);){if(h.index!==o)throw new TypeError("invalid parameter format");o+=h[0].length,p=h[1].toLowerCase(),34===(u=h[2]).charCodeAt(0)&&-1!==(u=u.slice(1,-1)).indexOf("\\")&&(u=u.replace(r,"$1")),c.parameters[p]=u}if(o!==t.length)throw new TypeError("invalid parameter format")}return c}},97574:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=[239,187,191];t.createParser=function(e){let t,r,n,s,o,a,c;return p(),{feed:function(e){r=r?r+e:e,t&&function(e){return i.every(((t,i)=>e.charCodeAt(i)===t))}(r)&&(r=r.slice(i.length)),t=!1;const o=r.length;let a=0,c=!1;for(;a<o;){c&&("\n"===r[a]&&++a,c=!1);let e,t=-1,i=s;for(let s=n;t<0&&s<o;++s)e=r[s],":"===e&&i<0?i=s-a:"\r"===e?(c=!0,t=s-a):"\n"===e&&(t=s-a);if(t<0){n=o-a,s=i;break}n=0,s=-1,h(r,a,i,t),a+=t+1}a===o?r="":a>0&&(r=r.slice(a))},reset:p};function p(){t=!0,r="",n=0,s=-1,o=void 0,a=void 0,c=""}function h(t,i,r,n){if(0===n)return c.length>0&&(e({type:"event",id:o,event:a||void 0,data:c.slice(0,-1)}),c="",o=void 0),void(a=void 0);const s=r<0,p=t.slice(i,i+(s?n:r));let h=0;h=s?n:" "===t[i+r+1]?r+2:r+1;const u=i+h,d=n-h,l=t.slice(u,u+d).toString();if("data"===p)c+=l?"".concat(l,"\n"):"\n";else if("event"===p)a=l;else if("id"!==p||l.includes("\0")){if("retry"===p){const t=parseInt(l,10);Number.isNaN(t)||e({type:"reconnect-interval",value:t})}}else o=l}}},32325:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ActivityReceivedEventArgs:()=>s.vV,AudioConfig:()=>s.rU,AudioFormatTag:()=>s.WY,AudioInputStream:()=>s.yk,AudioOutputStream:()=>s.J4,AudioStreamFormat:()=>s.HT,AutoDetectSourceLanguageConfig:()=>s.G3,AutoDetectSourceLanguageResult:()=>s.$y,BaseAudioPlayer:()=>s.Iq,BotFrameworkConfig:()=>s.OT,CancellationDetails:()=>s.EG,CancellationDetailsBase:()=>s.vs,CancellationErrorCode:()=>s.E1,CancellationReason:()=>s._B,Connection:()=>s.ew,ConnectionEventArgs:()=>s.RE,ConnectionMessage:()=>s.Hg,ConnectionMessageEventArgs:()=>s.bK,Conversation:()=>s.ri,ConversationExpirationEventArgs:()=>s.iB,ConversationParticipantsChangedEventArgs:()=>s.TJ,ConversationTranscriber:()=>s.bi,ConversationTranscriptionCanceledEventArgs:()=>s.np,ConversationTranscriptionEventArgs:()=>s.dz,ConversationTranslationCanceledEventArgs:()=>s.Oq,ConversationTranslationEventArgs:()=>s.D1,ConversationTranslationResult:()=>s.MO,ConversationTranslator:()=>s._m,CustomCommandsConfig:()=>s.XY,Diagnostics:()=>s.gd,DialogServiceConfig:()=>s.IX,DialogServiceConnector:()=>s.Ud,IntentRecognitionCanceledEventArgs:()=>s.v4,IntentRecognitionEventArgs:()=>s.h0,IntentRecognitionResult:()=>s.iy,IntentRecognizer:()=>s.p_,KeywordRecognitionModel:()=>s.On,LanguageIdMode:()=>s.bT,LanguageUnderstandingModel:()=>s.Pg,LogLevel:()=>s.in,NoMatchDetails:()=>s.Bv,NoMatchReason:()=>s.pe,OutputFormat:()=>s.WJ,Participant:()=>s.Qc,ParticipantChangedReason:()=>s.To,PhraseListGrammar:()=>s.Yw,ProfanityOption:()=>s.PH,PronunciationAssessmentConfig:()=>s.fQ,PronunciationAssessmentGradingSystem:()=>s.f7,PronunciationAssessmentGranularity:()=>s.Ai,PronunciationAssessmentResult:()=>s.VM,PropertyCollection:()=>s.Oo,PropertyId:()=>s.oX,PullAudioInputStream:()=>s.kv,PullAudioInputStreamCallback:()=>s.W0,PullAudioOutputStream:()=>s.Ao,PushAudioInputStream:()=>s.ZT,PushAudioOutputStream:()=>s.XO,PushAudioOutputStreamCallback:()=>s.y9,RecognitionEventArgs:()=>s.Ji,RecognitionResult:()=>s.pN,Recognizer:()=>s.cG,ResultReason:()=>s.sL,ServiceEventArgs:()=>s.$9,ServicePropertyChannel:()=>s.a7,SessionEventArgs:()=>s.$u,SourceLanguageConfig:()=>s.Mf,SpeakerAudioDestination:()=>s.Kc,SpeakerIdentificationModel:()=>s.gH,SpeakerRecognitionCancellationDetails:()=>s.r2,SpeakerRecognitionResult:()=>s.uH,SpeakerRecognitionResultType:()=>s.l5,SpeakerRecognizer:()=>s.hY,SpeakerVerificationModel:()=>s.Vi,SpeechConfig:()=>s.c_,SpeechConfigImpl:()=>s.zE,SpeechRecognitionCanceledEventArgs:()=>s.nn,SpeechRecognitionEventArgs:()=>s.mr,SpeechRecognitionResult:()=>s.by,SpeechRecognizer:()=>s.Fu,SpeechSynthesisBookmarkEventArgs:()=>s.iT,SpeechSynthesisBoundaryType:()=>s.Im,SpeechSynthesisEventArgs:()=>s.c2,SpeechSynthesisOutputFormat:()=>s.Yo,SpeechSynthesisResult:()=>s.P6,SpeechSynthesisVisemeEventArgs:()=>s.wY,SpeechSynthesisWordBoundaryEventArgs:()=>s.G7,SpeechSynthesizer:()=>s.an,SpeechTranslationConfig:()=>s.f$,SpeechTranslationConfigImpl:()=>s.m5,SynthesisResult:()=>s.AR,SynthesisVoicesResult:()=>s.kq,TranslationRecognitionCanceledEventArgs:()=>s.j9,TranslationRecognitionEventArgs:()=>s.so,TranslationRecognitionResult:()=>s.r_,TranslationRecognizer:()=>s.Mt,TranslationSynthesisEventArgs:()=>s.vK,TranslationSynthesisResult:()=>s.Sb,Translations:()=>s.jA,TurnStatusReceivedEventArgs:()=>s.Qt,User:()=>s.n5,VoiceInfo:()=>s.R$,VoiceProfile:()=>s.LA,VoiceProfileCancellationDetails:()=>s.Om,VoiceProfileClient:()=>s.Gd,VoiceProfileEnrollmentCancellationDetails:()=>s.sk,VoiceProfileEnrollmentResult:()=>s.fR,VoiceProfilePhraseResult:()=>s.UO,VoiceProfileResult:()=>s.AE,VoiceProfileType:()=>s.fw});var r=i(27845),n=i(3625),s=i(31223);n.z.instance.attachConsoleListener(new r.x)},27845:(e,t,i)=>{"use strict";i.d(t,{x:()=>o});var r=i(83034),n=i(14300),s=i(89513);class o{constructor(e=n.t.None){this.privLogPath=void 0,this.privEnableConsoleOutput=!0,this.privLogLevelFilter=e}set logPath(e){s.a.throwIfNullOrUndefined(r.openSync,"\nFile System access not available"),this.privLogPath=e}set enableConsoleOutput(e){this.privEnableConsoleOutput=e}onEvent(e){if(e.eventType>=this.privLogLevelFilter){const t=this.toString(e);if(this.privLogPath&&r.writeFileSync(this.privLogPath,t+"\n",{flag:"a+"}),this.privEnableConsoleOutput)switch(e.eventType){case n.t.Debug:console.debug(t);break;case n.t.Info:console.info(t);break;case n.t.Warning:console.warn(t);break;case n.t.Error:console.error(t);break;default:console.log(t)}}}toString(e){const t=[`${e.eventTime}`,`${e.name}`],i=e;for(const r in i)if(r&&e.hasOwnProperty(r)&&"eventTime"!==r&&"eventType"!==r&&"eventId"!==r&&"name"!==r&&"constructor"!==r){const e=i[r];let n="<NULL>";null!=e&&(n="number"==typeof e||"string"==typeof e?e.toString():JSON.stringify(e)),t.push(`${r}: ${n}`)}return t.join(" | ")}}},85706:(e,t,i)=>{"use strict";i.d(t,{z:()=>d});var r=i(62029),n=i(25487),s=i(48232),o=i(86582),a=i(33182),c=i(25038),p=i(3625),h=i(83895),u=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class d{constructor(e,t,i){this.privStreams={},this.privHeaderEnd=44,this.privId=i||(0,n.Q)(),this.privEvents=new s.n,this.privSource=e,"undefined"!=typeof window&&"undefined"!=typeof Blob&&this.privSource instanceof Blob?this.privFilename=e.name:this.privFilename=t||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}turnOn(){if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){const e=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new o.n0(e,"")),Promise.reject(e)}this.onEvent(new o.QZ(this.privId)),this.onEvent(new o.Jl(this.privId))}id(){return this.privId}attach(e){return u(this,void 0,void 0,(function*(){this.onEvent(new o.i5(this.privId,e));const t=yield this.upload(e);return this.onEvent(new o.sQ(this.privId,e)),Promise.resolve({detach:()=>u(this,void 0,void 0,(function*(){t.readEnded(),delete this.privStreams[e],this.onEvent(new o.He(this.privId,e)),yield this.turnOff()})),id:()=>e,read:()=>t.read()})}))}detach(e){e&&this.privStreams[e]&&(this.privStreams[e].close(),delete this.privStreams[e],this.onEvent(new o.He(this.privId,e)))}turnOff(){for(const e in this.privStreams)if(e){const t=this.privStreams[e];t&&!t.isClosed&&t.close()}return this.onEvent(new o.ls(this.privId)),Promise.resolve()}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then((e=>Promise.resolve({bitspersample:e.bitsPerSample,channelcount:e.channels,connectivity:r.wF.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:e.samplesPerSec,type:r.dt.File})))}readHeader(){const e=this.privSource.slice(0,4296),t=new a.BH,i=e=>{const i=new DataView(e),r=e=>String.fromCharCode(i.getUint8(e),i.getUint8(e+1),i.getUint8(e+2),i.getUint8(e+3));if("RIFF"!==r(0))return void t.reject("Invalid WAV header in file, RIFF was not found");if("WAVE"!==r(8)||"fmt "!==r(12))return void t.reject("Invalid WAV header in file, WAVEfmt was not found");const n=i.getInt32(16,!0),s=i.getUint16(22,!0),o=i.getUint32(24,!0),a=i.getUint16(34,!0);let c=36+Math.max(n-16,0);for(;"data"!==r(c);c+=2)if(c>4288)return void t.reject("Invalid WAV header in file, data block was not found");this.privHeaderEnd=c+8,t.resolve(h.HT.getWaveFormatPCM(o,a,s))};if("undefined"!=typeof window&&"undefined"!=typeof Blob&&e instanceof Blob){const t=new FileReader;t.onload=e=>{const t=e.target.result;i(t)},t.readAsArrayBuffer(e)}else{const t=e;i(t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength))}return t.promise}upload(e){return u(this,void 0,void 0,(function*(){const t=t=>{const i=`Error occurred while processing '${this.privFilename}'. ${t}`;throw this.onEvent(new o.hA(this.privId,e,i)),new Error(i)};try{yield this.turnOn();const i=yield this.privAudioFormatPromise,r=new c.L(i.avgBytesPerSec/10,e);this.privStreams[e]=r;const n=this.privSource.slice(this.privHeaderEnd),s=e=>{r.isClosed||(r.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()}),r.close())};if("undefined"!=typeof window&&"undefined"!=typeof Blob&&n instanceof Blob){const e=new FileReader;e.onerror=e=>t(e.toString()),e.onload=e=>{const t=e.target.result;s(t)},e.readAsArrayBuffer(n)}else{const e=n;s(e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength))}return r}catch(e){t(e)}}))}onEvent(e){this.privEvents.onEvent(e),p.z.instance.onEvent(e)}}},15599:(e,t,i)=>{"use strict";i.d(t,{I:()=>d});var r=i(62029),n=i(25487),s=i(48232),o=i(33182),a=i(86582),c=i(25038),p=i(3625),h=i(83895),u=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class d{constructor(e,t,i,r){this.privRecorder=e,this.deviceId=t,this.privStreams={},this.privOutputChunkSize=d.AUDIOFORMAT.avgBytesPerSec/10,this.privId=i||(0,n.Q)(),this.privEvents=new s.n,this.privMediaStream=r||null,this.privIsClosing=!1}get format(){return Promise.resolve(d.AUDIOFORMAT)}turnOn(){if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new o.BH;try{this.createAudioContext()}catch(e){if(e instanceof Error){const t=e;this.privInitializeDeferral.reject(t.name+": "+t.message)}else this.privInitializeDeferral.reject(e);return this.privInitializeDeferral.promise}const e=window.navigator;let t=e.getUserMedia||e.webkitGetUserMedia||e.mozGetUserMedia||e.msGetUserMedia;if(e.mediaDevices&&(t=(t,i,r)=>{e.mediaDevices.getUserMedia(t).then(i).catch(r)}),t){const e=()=>{this.onEvent(new a.QZ(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new a.Jl(this.privId)),this.privInitializeDeferral.resolve()):t({audio:!this.deviceId||{deviceId:this.deviceId},video:!1},(e=>{this.privMediaStream=e,this.onEvent(new a.Jl(this.privId)),this.privInitializeDeferral.resolve()}),(e=>{const t=`Error occurred during microphone initialization: ${e}`;this.privInitializeDeferral.reject(t),this.onEvent(new a.n0(this.privId,t))}))};"suspended"===this.privContext.state?this.privContext.resume().then(e).catch((e=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${e}`)})):e()}else{const e="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(e),this.onEvent(new a.n0(e,""))}return this.privInitializeDeferral.promise}id(){return this.privId}attach(e){return this.onEvent(new a.i5(this.privId,e)),this.listen(e).then((t=>(this.onEvent(new a.sQ(this.privId,e)),{detach:()=>u(this,void 0,void 0,(function*(){return t.readEnded(),delete this.privStreams[e],this.onEvent(new a.He(this.privId,e)),this.turnOff()})),id:()=>e,read:()=>t.read()})))}detach(e){e&&this.privStreams[e]&&(this.privStreams[e].close(),delete this.privStreams[e],this.onEvent(new a.He(this.privId,e)))}turnOff(){return u(this,void 0,void 0,(function*(){for(const e in this.privStreams)if(e){const t=this.privStreams[e];t&&t.close()}this.onEvent(new a.ls(this.privId)),this.privInitializeDeferral&&(yield this.privInitializeDeferral,this.privInitializeDeferral=null),yield this.destroyAudioContext()}))}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then((e=>({bitspersample:d.AUDIOFORMAT.bitsPerSample,channelcount:d.AUDIOFORMAT.channels,connectivity:r.wF.Unknown,manufacturer:"Speech SDK",model:e,samplerate:d.AUDIOFORMAT.samplesPerSec,type:r.dt.Microphones})))}setProperty(e,t){if("MICROPHONE-WorkletSourceUrl"!==e)throw new Error("Property '"+e+"' is not supported on Microphone.");this.privRecorder.setWorkletUrl(t)}getMicrophoneLabel(){const e="microphone";if(void 0!==this.privMicrophoneLabel)return Promise.resolve(this.privMicrophoneLabel);if(void 0===this.privMediaStream||!this.privMediaStream.active)return Promise.resolve(e);this.privMicrophoneLabel=e;const t=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(void 0===t)return Promise.resolve(this.privMicrophoneLabel);const i=new o.BH;return navigator.mediaDevices.enumerateDevices().then((e=>{for(const i of e)if(i.deviceId===t){this.privMicrophoneLabel=i.label;break}i.resolve(this.privMicrophoneLabel)}),(()=>i.resolve(this.privMicrophoneLabel))),i.promise}listen(e){return u(this,void 0,void 0,(function*(){yield this.turnOn();const t=new c.L(this.privOutputChunkSize,e);this.privStreams[e]=t;try{this.privRecorder.record(this.privContext,this.privMediaStream,t)}catch(t){throw this.onEvent(new a.hA(this.privId,e,t)),t}return t}))}onEvent(e){this.privEvents.onEvent(e),p.z.instance.onEvent(e)}createAudioContext(){this.privContext||(this.privContext=h.Bm.getAudioContext(d.AUDIOFORMAT.samplesPerSec))}destroyAudioContext(){return u(this,void 0,void 0,(function*(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let e=!1;"close"in this.privContext&&(e=!0),e?this.privIsClosing||(this.privIsClosing=!0,yield this.privContext.close(),this.privContext=null,this.privIsClosing=!1):null!==this.privContext&&"running"===this.privContext.state&&(yield this.privContext.suspend())}))}}d.AUDIOFORMAT=h.HT.getDefaultInputFormat()},19300:(e,t,i)=>{"use strict";i.d(t,{s:()=>n});var r=i(68426);class n{constructor(e){this.privStopInputOnRelease=e}record(e,t,i){const n=new r.S(e.sampleRate,16e3),s=e.createMediaStreamSource(t),o=()=>{const r=(()=>{let t=0;try{return e.createScriptProcessor(t,1,1)}catch(i){t=2048;let r=e.sampleRate;for(;t<16384&&r>=32e3;)t<<=1,r>>=1;return e.createScriptProcessor(t,1,1)}})();r.onaudioprocess=e=>{const t=e.inputBuffer.getChannelData(0);if(i&&!i.isClosed){const e=n.encode(t);e&&i.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}},s.connect(r),r.connect(e.destination),this.privMediaResources={scriptProcessorNode:r,source:s,stream:t}};if(e.audioWorklet){if(!this.privSpeechProcessorScript){const e=new Blob(["class SP extends AudioWorkletProcessor {\n                    constructor(options) {\n                      super(options);\n                    }\n                    process(inputs, outputs) {\n                      const input = inputs[0];\n                      const output = [];\n                      for (let channel = 0; channel < input.length; channel += 1) {\n                        output[channel] = input[channel];\n                      }\n                      this.port.postMessage(output[0]);\n                      return true;\n                    }\n                  }\n                  registerProcessor('speech-processor', SP);"],{type:"application/javascript; charset=utf-8"});this.privSpeechProcessorScript=URL.createObjectURL(e)}e.audioWorklet.addModule(this.privSpeechProcessorScript).then((()=>{const r=new AudioWorkletNode(e,"speech-processor");r.port.onmessage=e=>{const t=e.data;if(i&&!i.isClosed){const e=n.encode(t);e&&i.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}},s.connect(r),r.connect(e.destination),this.privMediaResources={scriptProcessorNode:r,source:s,stream:t}})).catch((()=>{o()}))}else try{o()}catch(e){throw new Error(`Unable to start audio worklet node for PCMRecorder: ${e}`)}}releaseMediaResources(e){this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(e.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privStopInputOnRelease&&this.privMediaResources.stream.getTracks().forEach((e=>e.stop())),this.privMediaResources.source=null))}setWorkletUrl(e){this.privSpeechProcessorScript=e}}},38717:(e,t,i)=>{"use strict";i.d(t,{i:()=>n});var r=i(65453);class n{constructor(e,t,i,r){this.privProxyHostName=e,this.privProxyPort=t,this.privProxyUserName=i,this.privProxyPassword=r}static fromParameters(e){return new n(e.getProperty(r.o.SpeechServiceConnection_ProxyHostName),parseInt(e.getProperty(r.o.SpeechServiceConnection_ProxyPort),10),e.getProperty(r.o.SpeechServiceConnection_ProxyUserName),e.getProperty(r.o.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(e){return this.fromParameters(e.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}}},78673:(e,t,i)=>{"use strict";i.d(t,{C:()=>r});class r{constructor(e,t){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.privAudioNode=e,this.privBytesPerSecond=t}id(){return this.privAudioNode.id()}read(){if(this.privReplay&&0!==this.privBuffers.length){const e=this.privReplayOffset-this.privBufferStartOffset;let t=Math.round(e*this.privBytesPerSecond*1e-7);0!=t%2&&t++;let i=0;for(;i<this.privBuffers.length&&t>=this.privBuffers[i].chunk.buffer.byteLength;)t-=this.privBuffers[i++].chunk.buffer.byteLength;if(i<this.privBuffers.length){const e=this.privBuffers[i].chunk.buffer.slice(t);return this.privReplayOffset+=e.byteLength/this.privBytesPerSecond*1e7,i===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:e,isEnd:!1,timeReceived:this.privBuffers[i].chunk.timeReceived})}}return this.privAudioNode.read().then((e=>(e&&e.buffer&&(this.privBuffers.push(new n(e,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=e.buffer.byteLength),e)))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&0!==this.privBuffers.length&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(e){if(void 0===this.privBuffers||0===this.privBuffers.length)return;this.privLastShrinkOffset=e;const t=e-this.privBufferStartOffset;let i=Math.round(t*this.privBytesPerSecond*1e-7),r=0;for(;r<this.privBuffers.length&&i>=this.privBuffers[r].chunk.buffer.byteLength;)i-=this.privBuffers[r++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(e-i/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(r)}findTimeAtOffset(e){if(e<this.privBufferStartOffset||void 0===this.privBuffers)return 0;for(const t of this.privBuffers){const i=t.byteOffset/this.privBytesPerSecond*1e7,r=i+t.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(e>=i&&e<=r)return t.chunk.timeReceived}return 0}}class n{constructor(e,t,i){this.chunk=e,this.serial=t,this.byteOffset=i}}},15840:(e,t,i)=>{"use strict";i.d(t,{o:()=>r});class r{static get requestOptions(){return r.privDefaultRequestOptions}static get configParams(){return r.privDefaultParams}static get restErrors(){return r.privRestErrors}}r.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4},r.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."},r.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"}},83565:(e,t,i)=>{"use strict";i.d(t,{b:()=>r,c:()=>c});var r,n=i(51719),s=i.n(n),o=i(80491),a=i(33182);!function(e){e.Get="GET",e.Post="POST",e.Delete="DELETE",e.File="file"}(r||(r={}));class c{constructor(e){if(!e)throw new o.Do("configParams");this.privHeaders=e.headers,this.privIgnoreCache=e.ignoreCache}static extractHeaderValue(e,t){let i="";try{const r=t.trim().split(/[\r\n]+/),n={};r.forEach((e=>{const t=e.split(": "),i=t.shift().toLowerCase(),r=t.join(": ");n[i]=r})),i=n[e.toLowerCase()]}catch(e){}return i}set options(e){this.privHeaders=e.headers,this.privIgnoreCache=e.ignoreCache}setHeaders(e,t){this.privHeaders[e]=t}request(e,t,i={},n=null){const o=new a.BH,c=e===r.File?"POST":e,p=(e,t={})=>{const i=e;return{data:JSON.stringify(t),headers:JSON.stringify(e.headers),json:t,ok:e.statusCode>=200&&e.statusCode<300,status:e.statusCode,statusText:t.error?t.error.message:i.statusText?i.statusText:i.statusMessage}};return this.privIgnoreCache&&(this.privHeaders["Cache-Control"]="no-cache"),e===r.Post&&n&&(this.privHeaders["content-type"]="application/json",this.privHeaders["Content-Type"]="application/json"),(n=>{s()(t,c,this.privHeaders,200,201,202,204,400,401,402,403,404)(""===this.queryParams(i)?"":`?${this.queryParams(i)}`,n).then((t=>{return i=this,n=void 0,a=function*(){if(e===r.Delete||204===t.statusCode)o.resolve(p(t));else try{const e=yield t.json();o.resolve(p(t,e))}catch(e){o.resolve(p(t))}},new((s=void 0)||(s=Promise))((function(e,t){function r(e){try{c(a.next(e))}catch(e){t(e)}}function o(e){try{c(a.throw(e))}catch(e){t(e)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s((function(e){e(i)}))).then(r,o)}c((a=a.apply(i,n||[])).next())}));var i,n,s,a})).catch((e=>{o.reject(e)}))})(n),o.promise}queryParams(e={}){return Object.keys(e).map((t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t]))).join("&")}}},99949:(e,t,i)=>{"use strict";i.d(t,{i:()=>o});var r=i(80491),n=i(25487),s=i(99903);class o{constructor(e,t,i,o,a,c=!1,p){if(this.privIsDisposed=!1,!e)throw new r.Do("uri");if(!o)throw new r.Do("messageFormatter");this.privMessageFormatter=o;let h="",u=0;if(t)for(const i in t)if(i){h+=0===u&&-1===e.indexOf("?")?"?":"&",h+=encodeURIComponent(i);let r=t[i];r&&(r=encodeURIComponent(r),h+=`=${r}`),u++}if(i)for(const t in i)t&&(h+=0===u&&-1===e.indexOf("?")?"?":"&",h+=`${t}=${encodeURIComponent(i[t])}`,u++);this.privUri=e+h,this.privId=p||(0,n.Q)(),this.privConnectionMessageAdapter=new s.I(this.privUri,this.id,this.privMessageFormatter,a,i,c)}dispose(){return e=this,t=void 0,r=function*(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&(yield this.privConnectionMessageAdapter.close())},new((i=void 0)||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}));var e,t,i,r}isDisposed(){return this.privIsDisposed}get id(){return this.privId}get uri(){return this.privUri}state(){return this.privConnectionMessageAdapter.state}open(){return this.privConnectionMessageAdapter.open()}send(e){return this.privConnectionMessageAdapter.send(e)}read(){return this.privConnectionMessageAdapter.read()}get events(){return this.privConnectionMessageAdapter.events}}},99903:(e,t,i)=>{"use strict";i.d(t,{I:()=>I});var r=i(10146),n=i(30173),s=i(43108),o=i.n(s),a=i(92505),c=i.n(a),p=i(41137),h=i.n(p),u=i(84257),d=i(80491),l=i(48232),v=i(43842),g=i(33182),m=i(68887),f=i(3625),S=i(59187);class y{constructor(e,t){this.privStatusCode=e,this.privReason=t}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}}var C=i(71945),w=i(36259),R=i(66645),P=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class I{constructor(e,t,i,r,n,s){if(!e)throw new d.Do("uri");if(!i)throw new d.Do("messageFormatter");this.proxyInfo=r,this.privConnectionEvents=new l.n,this.privConnectionId=t,this.privMessageFormatter=i,this.privConnectionState=v.e.None,this.privUri=e,this.privHeaders=n,this.privEnableCompression=s,this.privHeaders[u.S.ConnectionId]=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}open(){if(this.privConnectionState===v.e.Disconnected)return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new g.BH,this.privCertificateValidatedDeferral=new g.BH,this.privConnectionState=v.e.Connecting;try{if("undefined"==typeof WebSocket||I.forceNpmWebSocket){const e={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression};this.privCertificateValidatedDeferral.resolve(),e.agent=this.getAgent();let t=new URL(this.privUri).protocol;"wss:"===(null==t?void 0:t.toLocaleLowerCase())?t="https:":"ws:"===(null==t?void 0:t.toLocaleLowerCase())&&(t="http:"),e.agent.protocol=t,this.privWebsocketClient=new(h())(this.privUri,e)}else this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new m.c,this.privDisconnectDeferral=new g.BH,this.privSendMessageQueue=new m.c,this.processSendQueue().catch((e=>{f.z.instance.onEvent(new S.u(e))}))}catch(e){return this.privConnectionEstablishDeferral.resolve(new y(500,e)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new C.YF(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=()=>{this.privCertificateValidatedDeferral.promise.then((()=>{this.privConnectionState=v.e.Connected,this.onEvent(new C.Zk(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new y(200,""))}),(e=>{this.privConnectionEstablishDeferral.reject(e)}))},this.privWebsocketClient.onerror=e=>{this.onEvent(new C.K4(this.privConnectionId,e.message,e.type)),this.privLastErrorReceived=e.message},this.privWebsocketClient.onclose=e=>{this.privConnectionState===v.e.Connecting?(this.privConnectionState=v.e.Disconnected,this.privConnectionEstablishDeferral.resolve(new y(e.code,e.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=v.e.Disconnected,this.privWebsocketClient=null,this.onEvent(new C.PE(this.privConnectionId,e.code,e.reason))),this.onClose(e.code,e.reason).catch((e=>{f.z.instance.onEvent(new S.u(e))}))},this.privWebsocketClient.onmessage=e=>{const t=(new Date).toISOString();if(this.privConnectionState===v.e.Connected){const i=new g.BH;if(this.privReceivingMessageQueue.enqueueFromPromise(i.promise),e.data instanceof ArrayBuffer){const r=new w.S(R.C.Binary,e.data);this.privMessageFormatter.toConnectionMessage(r).then((e=>{this.onEvent(new C.Qz(this.privConnectionId,t,e)),i.resolve(e)}),(e=>{i.reject(`Invalid binary message format. Error: ${e}`)}))}else{const r=new w.S(R.C.Text,e.data);this.privMessageFormatter.toConnectionMessage(r).then((e=>{this.onEvent(new C.Qz(this.privConnectionId,t,e)),i.resolve(e)}),(e=>{i.reject(`Invalid text message format. Error: ${e}`)}))}}},this.privConnectionEstablishDeferral.promise}send(e){if(this.privConnectionState!==v.e.Connected)return Promise.reject(`Cannot send on connection that is in ${v.e[this.privConnectionState]} state`);const t=new g.BH,i=new g.BH;return this.privSendMessageQueue.enqueueFromPromise(i.promise),this.privMessageFormatter.fromConnectionMessage(e).then((r=>{i.resolve({Message:e,RawWebsocketMessage:r,sendStatusDeferral:t})}),(e=>{i.reject(`Error formatting the message. ${e}`)})),t.promise}read(){return this.privConnectionState!==v.e.Connected?Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue()}close(e){return this.privWebsocketClient?(this.privConnectionState!==v.e.Disconnected&&this.privWebsocketClient.close(1e3,e||"Normal closure by client"),this.privDisconnectDeferral.promise):Promise.resolve()}get events(){return this.privConnectionEvents}sendRawMessage(e){try{return e?(this.onEvent(new C.w2(this.privConnectionId,(new Date).toISOString(),e.Message)),this.isWebsocketOpen?(this.privWebsocketClient.send(e.RawWebsocketMessage.payload),Promise.resolve()):Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+e.Message.id+" "+(new Error).stack)):Promise.resolve()}catch(e){return Promise.reject(`websocket send error: ${e}`)}}onClose(e,t){return P(this,void 0,void 0,(function*(){const i=`Connection closed. ${e}: ${t}`;this.privConnectionState=v.e.Disconnected,this.privDisconnectDeferral.resolve(),yield this.privReceivingMessageQueue.drainAndDispose((()=>{}),i),yield this.privSendMessageQueue.drainAndDispose((e=>{e.sendStatusDeferral.reject(i)}),i)}))}processSendQueue(){return P(this,void 0,void 0,(function*(){for(;;){const e=this.privSendMessageQueue.dequeue(),t=yield e;if(!t)return;try{yield this.sendRawMessage(t),t.sendStatusDeferral.resolve()}catch(e){t.sendStatusDeferral.reject(e)}}}))}onEvent(e){this.privConnectionEvents.onEvent(e),f.z.instance.onEvent(e)}getAgent(){const e=new(o().Agent)(this.createConnection);return void 0!==this.proxyInfo&&void 0!==this.proxyInfo.HostName&&this.proxyInfo.Port>0&&(e.proxyInfo=this.proxyInfo),e}static GetProxyAgent(e){const t={host:e.HostName,port:e.Port};return e.UserName?t.headers={"Proxy-Authentication":"Basic "+new Buffer(`${e.UserName}:${void 0===e.Password?"":e.Password}`).toString("base64")}:t.headers={},t.headers.requestOCSP="true",new(c())(t)}createConnection(e,t){let i;if(t=Object.assign(Object.assign({},t),{requestOCSP:!0,servername:t.host}),this.proxyInfo){const r=I.GetProxyAgent(this.proxyInfo);i=new Promise(((i,n)=>{r.callback(e,t,((e,t)=>{e?n(e):i(t)}))}))}else i=t.secureEndpoint?Promise.resolve(n.connect(t)):Promise.resolve(r.connect(t));return i}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}}I.forceNpmWebSocket=!1},20358:(e,t,i)=>{"use strict";i.d(t,{w:()=>r});class r{constructor(e,t){this.modelImpl=e,this.intentName=t}}},42802:(e,t,i)=>{"use strict";i.d(t,{H:()=>r});class r{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(e){this.iPrivConfig=e}}},10512:(e,t,i)=>{"use strict";i.d(t,{U:()=>o});var r=i(80491),n=i(84257),s=i(77410);class o{constructor(e){if(!e)throw new r.Do("subscriptionKey");this.privAuthInfo=new s.G(n.S.AuthKey,e)}fetch(e){return Promise.resolve(this.privAuthInfo)}fetchOnExpiry(e){return Promise.resolve(this.privAuthInfo)}}},54825:(e,t,i)=>{"use strict";i.d(t,{w:()=>o});var r=i(80491),n=i(77410),s=i(84257);class o{constructor(e,t){if(!e)throw new r.Do("fetchCallback");if(!t)throw new r.Do("fetchOnExpiryCallback");this.privFetchCallback=e,this.privFetchOnExpiryCallback=t}fetch(e){return this.privFetchCallback(e).then((e=>new n.G(s.S.Authorization,void 0===e?void 0:o.privTokenPrefix+e)))}fetchOnExpiry(e){return this.privFetchOnExpiryCallback(e).then((e=>new n.G(s.S.Authorization,void 0===e?void 0:o.privTokenPrefix+e)))}}o.privTokenPrefix="bearer "},70092:(e,t,i)=>{"use strict";i.d(t,{_:()=>o});var r=i(62389),n=i(65453),s=i(89906);class o{static getHostSuffix(e){if(e){if(e.toLowerCase().startsWith("china"))return".azure.cn";if(e.toLowerCase().startsWith("usgov"))return".azure.us"}return".microsoft.com"}setCommonUrlParams(e,t,i){new Map([[n.o.Speech_SegmentationSilenceTimeoutMs,s.o.SegmentationSilenceTimeoutMs],[n.o.SpeechServiceConnection_EnableAudioLogging,s.o.EnableAudioLogging],[n.o.SpeechServiceConnection_EndSilenceTimeoutMs,s.o.EndSilenceTimeoutMs],[n.o.SpeechServiceConnection_InitialSilenceTimeoutMs,s.o.InitialSilenceTimeoutMs],[n.o.SpeechServiceResponse_PostProcessingOption,s.o.Postprocessing],[n.o.SpeechServiceResponse_ProfanityOption,s.o.Profanity],[n.o.SpeechServiceResponse_RequestWordLevelTimestamps,s.o.EnableWordLevelTimestamps],[n.o.SpeechServiceResponse_StablePartialResultThreshold,s.o.StableIntermediateThreshold]]).forEach(((r,n)=>{this.setUrlParameter(n,r,e,t,i)}));const o=JSON.parse(e.parameters.getProperty(r.ServicePropertiesPropertyName,"{}"));Object.keys(o).forEach((e=>{t[e]=o[e]}))}setUrlParameter(e,t,i,r,n){const s=i.parameters.getProperty(e,void 0);!s||n&&-1!==n.search(t)||(r[t]=s.toLocaleLowerCase())}}},96978:(e,t,i)=>{"use strict";i.d(t,{S:()=>m});var r=i(22874),n=i(65453),s=i(91048),o=i(88530),a=i(98670),c=i(47916),p=i(22436),h=i(51054),u=i(47297),d=i(62389),l=i(35984),v=i(60556),g=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class m extends c.q{constructor(e,t,i,r,n){super(e,t,i,r,n),this.handleSpeechPhraseMessage=e=>g(this,void 0,void 0,(function*(){return this.handleSpeechPhrase(e)})),this.handleSpeechHypothesisMessage=e=>this.handleSpeechHypothesis(e)}processTypeSpecificMessages(e){}handleRecognizedCallback(e,t,i){}handleRecognizingCallback(e,t,i){}processSpeechMessages(e){return g(this,void 0,void 0,(function*(){let t=!1;switch(e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":this.handleSpeechHypothesisMessage&&this.handleSpeechHypothesisMessage(e.textBody),t=!0;break;case"speech.phrase":this.handleSpeechPhraseMessage&&(yield this.handleSpeechPhraseMessage(e.textBody)),t=!0}return t}))}cancelRecognition(e,t,i,r,n){}handleSpeechPhrase(e){return g(this,void 0,void 0,(function*(){const t=p.n.fromJSON(e),i=h.o.implTranslateRecognitionResult(t.RecognitionStatus);let c;const v=new r.O;v.setProperty(n.o.SpeechServiceResponse_JsonResult,e);const g=t.Offset+this.privRequestSession.currentTurnAudioOffset;let m=g;if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+t.Offset+t.Duration),s.s.Canceled===i){const e=h.o.implTranslateCancelResult(t.RecognitionStatus),i=h.o.implTranslateCancelErrorCode(t.RecognitionStatus);yield this.cancelRecognitionLocal(e,i,h.o.implTranslateErrorDetails(i))}else if(!this.privRequestSession.isSpeechEnded||i!==s.s.NoMatch||t.RecognitionStatus===u.T.InitialSilenceTimeout){if(this.privRecognizerConfig.parameters.getProperty(d.OutputFormatPropertyName)===o.W[o.W.Simple])c=new a.b(this.privRequestSession.requestId,i,t.DisplayText,t.Duration,g,t.Language,t.LanguageDetectionConfidence,t.SpeakerId,void 0,e,v);else{const t=l.u.fromJSON(e),r=t.Offset+this.privRequestSession.currentTurnAudioOffset,n=t.getJsonWithCorrectedOffsets(r);c=new a.b(this.privRequestSession.requestId,i,t.Text,t.Duration,r,t.Language,t.LanguageDetectionConfidence,t.SpeakerId,void 0,n,v),m=c.offset}this.handleRecognizedCallback(c,m,this.privRequestSession.sessionId)}}))}handleSpeechHypothesis(e){const t=v.r.fromJSON(e),i=t.Offset+this.privRequestSession.currentTurnAudioOffset,o=new r.O;o.setProperty(n.o.SpeechServiceResponse_JsonResult,e);const c=new a.b(this.privRequestSession.requestId,s.s.RecognizingSpeech,t.Text,t.Duration,i,t.Language,t.LanguageDetectionConfidence,t.SpeakerId,void 0,e,o);this.privRequestSession.onHypothesis(i),this.handleRecognizingCallback(c,t.Duration,this.privRequestSession.sessionId)}}},30467:(e,t,i)=>{"use strict";i.d(t,{H:()=>l});var r=i(99949),n=i(38717),s=i(62389),o=i(65453),a=i(88530),c=i(34751),p=i(70092),h=i(65610),u=i(84257),d=i(89906);class l extends p._{create(e,t,i){const v=e.parameters.getProperty(o.o.Conversation_ApplicationId,""),g=e.parameters.getProperty(o.o.Conversation_DialogType),m=e.parameters.getProperty(o.o.SpeechServiceConnection_Region),f=e.parameters.getProperty(o.o.SpeechServiceConnection_RecoLanguage,"en-US"),S=e.parameters.getProperty(o.o.Conversation_Request_Bot_Status_Messages,"true"),y={};y[u.S.ConnectionId]=i,y[d.o.Format]=e.parameters.getProperty(s.OutputFormatPropertyName,a.W[a.W.Simple]).toLowerCase(),y[d.o.Language]=f,y[d.o.RequestBotStatusMessages]=S,v&&(y[d.o.BotId]=v,g===c.E.DialogTypes.CustomCommands&&(y[u.S.CustomCommandsAppId]=v));const C=g===c.E.DialogTypes.CustomCommands?"commands/":"",w=g===c.E.DialogTypes.CustomCommands?"v1":g===c.E.DialogTypes.BotFramework?"v3":"v0",R={};null!=t.token&&""!==t.token&&(R[t.headerName]=t.token);let P=e.parameters.getProperty(o.o.SpeechServiceConnection_Endpoint,"");if(!P){const t=p._.getHostSuffix(m),i=e.parameters.getProperty(o.o.SpeechServiceConnection_Host,`wss://${m}.${l.BaseUrl}${t}`);P=`${i.endsWith("/")?i:i+"/"}${C}${l.ApiKey}/${w}`}this.setCommonUrlParams(e,y,P);const I="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new r.i(P,y,R,new h.D,n.i.fromRecognizerConfig(e),I,i)}}l.ApiKey="api",l.BaseUrl="convai.speech"},40267:(e,t,i)=>{"use strict";i.d(t,{C:()=>B});var r=i(78673),n=i(46935),s=i(48232),o=i(25487),a=i(66645),c=i(33182),p=i(71945),h=i(3625),u=i(59187),d=i(85904),l=i(6550),v=i(98563),g=i(22874),m=i(65453),f=i(98670),S=i(91048),y=i(53383),C=i(52438),w=i(7841),R=i(99801),P=i(34751),I=i(33428),A=i(27040),T=i(55115),b=i(47916),E=i(22436),k=i(47297),N=i(60556),x=i(11297),D=i(62389),O=i(42559),M=i(51054),z=i(96443),L=i(53504),_=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class B extends b.q{constructor(e,t,i,r,n){super(e,t,i,r,n),this.privEvents=new s.n,this.privDialogServiceConnector=n,this.receiveMessageOverride=()=>this.receiveDialogMessageOverride(),this.privTurnStateManager=new T.r,this.recognizeOverride=(e,t,i)=>this.listenOnce(e,t,i),this.postConnectImplOverride=e=>this.dialogConnectImpl(e),this.configConnectionOverride=e=>this.configConnection(e),this.disconnectOverride=()=>this.privDisconnect(),this.privDialogAudioSource=i,this.agentConfigSent=!1,this.privLastResult=null,this.connectionEvents.attach((e=>{"ConnectionClosedEvent"===e.name&&(this.terminateMessageLoop=!0)}))}sendMessage(e){return _(this,void 0,void 0,(function*(){const t=(0,o.c)(),i=(0,o.Q)(),r={context:{interactionId:t},messagePayload:JSON.parse(e),version:.5},n=JSON.stringify(r),s=yield this.fetchConnection();yield s.send(new L.r(a.C.Text,"agent",i,"application/json",n))}))}privDisconnect(){return _(this,void 0,void 0,(function*(){yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,l._.Error,v.E.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1}))}processTypeSpecificMessages(e){const t=new g.O;let i,r;switch(e.messageType===a.C.Text&&t.setProperty(m.o.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speech.phrase":const n=E.n.fromJSON(e.textBody);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+n.Offset+n.Duration),n.RecognitionStatus!==k.T.TooManyRequests&&n.RecognitionStatus!==k.T.Error){const e=this.fireEventForResult(n,t);if(this.privLastResult=e.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,e)}catch(e){}}r=!0;break;case"speech.hypothesis":const s=N.r.fromJSON(e.textBody),o=s.Offset+this.privRequestSession.currentTurnAudioOffset;i=new f.b(this.privRequestSession.requestId,S.s.RecognizingSpeech,s.Text,s.Duration,o,s.Language,s.LanguageDetectionConfidence,void 0,void 0,e.textBody,t),this.privRequestSession.onHypothesis(o);const a=new y.m(i,s.Duration,this.privRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,a)}catch(e){}r=!0;break;case"speech.keyword":const c=x.y.fromJSON(e.textBody);i=new f.b(this.privRequestSession.requestId,"Accepted"===c.Status?S.s.RecognizedKeyword:S.s.NoMatch,c.Text,c.Duration,c.Offset,void 0,void 0,void 0,void 0,e.textBody,t),"Accepted"!==c.Status&&(this.privLastResult=i);const p=new y.m(i,i.duration,i.resultId);if(this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,p)}catch(e){}r=!0;break;case"audio":{const t=e.requestId.toUpperCase(),i=this.privTurnStateManager.GetTurn(t);try{e.binaryBody?i.audioStream.write(e.binaryBody):i.endAudioStream()}catch(e){}}r=!0;break;case"response":this.handleResponseMessage(e),r=!0}const n=new c.BH;return n.resolve(r),n.promise}cancelRecognition(e,t,i,r,n){return _(this,void 0,void 0,(function*(){if(this.terminateMessageLoop=!0,this.privRequestSession.isRecognizing&&(yield this.privRequestSession.onStopRecognizing()),this.privDialogServiceConnector.canceled){const t=new g.O;t.setProperty(D.CancellationErrorCodePropertyName,v.E[r]);const s=new C.n(i,n,r,void 0,e);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,s)}catch(e){}if(this.privSuccessCallback){const e=new f.b(void 0,S.s.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,n,void 0,t);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(e){}}}}))}listenOnce(e,t,i){return _(this,void 0,void 0,(function*(){this.privRecognizerConfig.recognitionMode=e,this.privSuccessCallback=t,this.privErrorCallback=i,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.privRecognizerConfig.parameters.setProperty(m.o.Speech_SessionId,this.privRequestSession.sessionId);const n=this.connectImpl(),s=this.sendPreAudioMessages(),o=yield this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId),a=yield this.privDialogAudioSource.format,c=yield this.privDialogAudioSource.deviceInfo,p=new r.C(o,a.avgBytesPerSec);yield this.privRequestSession.onAudioSourceAttachCompleted(p,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:c};try{yield n,yield s}catch(e){return yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,l._.Error,v.E.ConnectionFailure,e),Promise.resolve()}const h=new w.$(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,h),this.sendAudio(p).then((()=>{}),(e=>_(this,void 0,void 0,(function*(){yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,l._.Error,v.E.RuntimeError,e)}))))}))}dialogConnectImpl(e){return this.privConnectionLoop=this.startMessageLoop(),e}receiveDialogMessageOverride(){const e=new c.BH,t=()=>_(this,void 0,void 0,(function*(){try{const i=this.isDisposed(),r=!this.isDisposed()&&this.terminateMessageLoop;if(i||r)return void e.resolve(void 0);const n=yield this.fetchConnection(),s=yield n.read();if(!s)return t();const o=L.r.fromConnectionMessage(s);switch(o.path.toLowerCase()){case"turn.start":{const e=o.requestId.toUpperCase();e!==this.privRequestSession.requestId.toUpperCase()?this.privTurnStateManager.StartTurn(e):this.privRequestSession.onServiceTurnStartResponse()}break;case"speech.startdetected":const e=O.s.fromJSON(o.textBody),t=new R.J(e.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,t);break;case"speech.enddetected":let i;i=o.textBody.length>0?o.textBody:"{ Offset: 0 }";const r=O.s.fromJSON(i);this.privRequestSession.onServiceRecognized(r.Offset+this.privRequestSession.currentTurnAudioOffset);const n=new R.J(r.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,n);break;case"turn.end":{const e=o.requestId.toUpperCase();if(e!==this.privRequestSession.requestId.toUpperCase())this.privTurnStateManager.CompleteTurn(e);else{const e=new w.$(this.privRequestSession.sessionId);if(yield this.privRequestSession.onServiceTurnEndResponse(!1),this.privRecognizerConfig.isContinuousRecognition&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing||this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,e),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}break;default:try{(yield this.processTypeSpecificMessages(o))||this.serviceEvents&&this.serviceEvents.onEvent(new p.e2(o.path.toLowerCase(),o.textBody))}catch(e){}}return t()}catch(t){this.terminateMessageLoop=!0,e.resolve()}}));return t().catch((e=>{h.z.instance.onEvent(new u.u(e))})),e.promise}startMessageLoop(){return _(this,void 0,void 0,(function*(){this.terminateMessageLoop=!1;try{yield this.receiveDialogMessageOverride()}catch(e){yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,l._.Error,v.E.RuntimeError,e)}return Promise.resolve()}))}configConnection(e){return _(this,void 0,void 0,(function*(){return this.terminateMessageLoop?(this.terminateMessageLoop=!1,Promise.reject("Connection to service terminated.")):(yield this.sendSpeechServiceConfig(e,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),yield this.sendAgentConfig(e),e)}))}sendPreAudioMessages(){return _(this,void 0,void 0,(function*(){const e=yield this.fetchConnection();this.addKeywordContextData(),yield this.sendSpeechContext(e,!0),yield this.sendAgentContext(e),yield this.sendWaveHeader(e)}))}sendAgentConfig(e){if(this.agentConfig&&!this.agentConfigSent){if(this.privRecognizerConfig.parameters.getProperty(m.o.Conversation_DialogType)===P.E.DialogTypes.CustomCommands){const e=this.agentConfig.get();e.botInfo.commandsCulture=this.privRecognizerConfig.parameters.getProperty(m.o.SpeechServiceConnection_RecoLanguage,"en-us"),this.agentConfig.set(e)}this.onEvent(new n.K(this.agentConfig));const t=this.agentConfig.toJsonString();return this.agentConfigSent=!0,e.send(new L.r(a.C.Text,"agent.config",this.privRequestSession.requestId,"application/json",t))}}sendAgentContext(e){const t=(0,o.c)(),i=this.privDialogServiceConnector.properties.getProperty(m.o.Conversation_Speech_Activity_Template),r={channelData:"",context:{interactionId:t},messagePayload:void 0===typeof i?void 0:i,version:.5},n=JSON.stringify(r);return e.send(new L.r(a.C.Text,"speech.agent.context",this.privRequestSession.requestId,"application/json",n))}fireEventForResult(e,t){const i=M.o.implTranslateRecognitionResult(e.RecognitionStatus),r=e.Offset+this.privRequestSession.currentTurnAudioOffset,n=new f.b(this.privRequestSession.requestId,i,e.DisplayText,e.Duration,r,e.Language,e.LanguageDetectionConfidence,void 0,void 0,JSON.stringify(e),t);return new y.m(n,r,this.privRequestSession.sessionId)}handleResponseMessage(e){const t=JSON.parse(e.textBody);switch(t.messageType.toLowerCase()){case"message":const i=e.requestId.toUpperCase(),r=z.Z.fromJSON(e.textBody),n=this.privTurnStateManager.GetTurn(i);if(r.conversationId){const e=this.agentConfig.get();e.botInfo.conversationId=r.conversationId,this.agentConfig.set(e)}const s=n.processActivityPayload(r,d.d.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(m.o.SpeechServiceConnection_SynthOutputFormat,void 0))),o=new I.v(r.messagePayload,s);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,o)}catch(e){}break;case"messagestatus":if(this.privDialogServiceConnector.turnStatusReceived)try{this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector,new A.Q(e.textBody))}catch(e){}break;default:h.z.instance.onEvent(new u.u(`Unexpected response of type ${t.messageType}. Ignoring.`))}}onEvent(e){this.privEvents.onEvent(e),h.z.instance.onEvent(e)}addKeywordContextData(){const e=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");if(void 0===e)return;const t=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Offsets"),i=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Durations"),r=e.split(";"),n=void 0===t?[]:t.split(";"),s=void 0===i?[]:i.split(";"),o=[];for(let e=0;e<r.length;e++){const t={};t.text=r[e],e<n.length&&(t.offset=Number(n[e])),e<s.length&&(t.duration=Number(s[e])),o.push(t)}this.speechContext.setSection("invocationSource","VoiceActivationWithKeyword"),this.speechContext.setSection("keywordDetection",[{clientDetectedKeywords:o,onReject:{action:"EndOfTurn"},type:"startTrigger"}])}}},94077:(e,t,i)=>{"use strict";i.d(t,{w:()=>o});var r=i(85904),n=i(1912),s=i(96443);class o{constructor(e,t){this.privRequestId=t,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=e,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(e,t){return e.messageDataStreamType===s.Y.TextToSpeechAudio&&(this.privAudioStream=n.J4.createPullStream(),this.privAudioStream.format=void 0!==t?t:r.d.getDefaultOutputFormat()),this.privAudioStream}endAudioStream(){null===this.privAudioStream||this.privAudioStream.isClosed||this.privAudioStream.close()}complete(){void 0!==this.privTimeoutToken&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){void 0!==this.privTimeoutToken&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout((()=>{this.privTurnManager.CompleteTurn(this.privRequestId)}),2e3)}}},55115:(e,t,i)=>{"use strict";i.d(t,{r:()=>s});var r=i(80491),n=i(94077);class s{constructor(){this.privTurnMap=new Map}StartTurn(e){if(this.privTurnMap.has(e))throw new r.$2("Service error: There is already a turn with id:"+e);const t=new n.w(this,e);return this.privTurnMap.set(e,t),this.privTurnMap.get(e)}GetTurn(e){return this.privTurnMap.get(e)}CompleteTurn(e){if(!this.privTurnMap.has(e))throw new r.$2("Service error: Received turn end for an unknown turn id:"+e);const t=this.privTurnMap.get(e);return t.complete(),this.privTurnMap.delete(e),t}}},51054:(e,t,i)=>{"use strict";i.d(t,{o:()=>a});var r=i(91048),n=i(6550),s=i(98563),o=i(47297);class a{static implTranslateRecognitionResult(e){let t=r.s.Canceled;switch(e){case o.T.Success:t=r.s.RecognizedSpeech;break;case o.T.NoMatch:case o.T.InitialSilenceTimeout:case o.T.BabbleTimeout:case o.T.EndOfDictation:t=r.s.NoMatch;break;case o.T.Error:case o.T.BadRequest:case o.T.Forbidden:default:t=r.s.Canceled}return t}static implTranslateCancelResult(e){let t=n._.EndOfStream;switch(e){case o.T.Success:case o.T.EndOfDictation:case o.T.NoMatch:t=n._.EndOfStream;break;case o.T.InitialSilenceTimeout:case o.T.BabbleTimeout:case o.T.Error:case o.T.BadRequest:case o.T.Forbidden:default:t=n._.Error}return t}static implTranslateCancelErrorCode(e){let t=s.E.NoError;switch(e){case o.T.Error:t=s.E.ServiceError;break;case o.T.TooManyRequests:t=s.E.TooManyRequests;break;case o.T.BadRequest:t=s.E.BadRequestParameters;break;case o.T.Forbidden:t=s.E.Forbidden;break;default:t=s.E.NoError}return t}static implTranslateErrorDetails(e){let t="The speech service encountered an internal error and could not continue.";switch(e){case s.E.Forbidden:t="The recognizer is using a free subscription that ran out of quota.";break;case s.E.BadRequestParameters:t="Invalid parameter or unsupported audio format in the request.";break;case s.E.TooManyRequests:t="The number of parallel requests exceeded the number of allowed concurrent transcriptions."}return t}}},62389:(e,t,i)=>{"use strict";i.d(t,{AutoDetectSourceLanguagesOpenRangeOptionName:()=>a,CancellationErrorCodePropertyName:()=>n,ForceDictationPropertyName:()=>o,OutputFormatPropertyName:()=>r,ServicePropertiesPropertyName:()=>s});const r="OutputFormat",n="CancellationErrorCode",s="ServiceProperties",o="ForceDictation",a="OpenRange"},84257:(e,t,i)=>{"use strict";i.d(t,{S:()=>r});class r{}r.AuthKey="Ocp-Apim-Subscription-Key",r.Authorization="Authorization",r.SpIDAuthKey="Apim-Subscription-Id",r.ConnectionId="X-ConnectionId",r.ContentType="Content-Type",r.CustomCommandsAppId="X-CommandsAppId",r.Path="Path",r.RequestId="X-RequestId",r.RequestStreamId="X-StreamId",r.RequestTimestamp="X-Timestamp"},77410:(e,t,i)=>{"use strict";i.d(t,{G:()=>r});class r{constructor(e,t){this.privHeaderName=e,this.privToken=t}get headerName(){return this.privHeaderName}get token(){return this.privToken}}},69638:(e,t,i)=>{"use strict";i.d(t,{b:()=>p});var r=i(99949),n=i(38717),s=i(65453),o=i(70092),a=i(65610),c=i(84257);class p extends o._{create(e,t,i){let p=e.parameters.getProperty(s.o.SpeechServiceConnection_Endpoint);if(!p){const t=e.parameters.getProperty(s.o.SpeechServiceConnection_IntentRegion),i=o._.getHostSuffix(t);p=e.parameters.getProperty(s.o.SpeechServiceConnection_Host,"wss://"+t+".sr.speech"+i)+"/speech/recognition/interactive/cognitiveservices/v1"}const h={format:"simple",language:e.parameters.getProperty(s.o.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(e,h,p);const u={};void 0!==t.token&&""!==t.token&&(u[t.headerName]=t.token),u[c.S.ConnectionId]=i,e.parameters.setProperty(s.o.SpeechServiceConnection_Url,p);const d="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new r.i(p,h,u,new a.D,n.i.fromRecognizerConfig(e),d,i)}getSpeechRegionFromIntentRegion(e){switch(e){case"West US":case"US West":case"westus":return"uswest";case"West US 2":case"US West 2":case"westus2":return"uswest2";case"South Central US":case"US South Central":case"southcentralus":return"ussouthcentral";case"West Central US":case"US West Central":case"westcentralus":return"uswestcentral";case"East US":case"US East":case"eastus":return"useast";case"East US 2":case"US East 2":case"eastus2":return"useast2";case"West Europe":case"Europe West":case"westeurope":return"europewest";case"North Europe":case"Europe North":case"northeurope":return"europenorth";case"Brazil South":case"South Brazil":case"southbrazil":return"brazilsouth";case"Australia East":case"East Australia":case"eastaustralia":return"australiaeast";case"Southeast Asia":case"Asia Southeast":case"southeastasia":return"asiasoutheast";case"East Asia":case"Asia East":case"eastasia":return"asiaeast";default:return e}}}},41687:(e,t,i)=>{"use strict";i.d(t,{O:()=>S});var r=i(66645),n=i(33182),s=i(22874),o=i(65453),a=i(30794),c=i(91048),p=i(32209),h=i(98563),u=i(42821),d=i(47916),l=i(60556),v=i(22436),g=i(51054),m=i(29340),f=i(62389);class S extends d.q{constructor(e,t,i,r,n){super(e,t,i,r,n),this.privIntentRecognizer=n,this.privIntentDataSent=!1}setIntents(e,t){this.privAddedLmIntents=e,this.privUmbrellaIntent=t,this.privIntentDataSent=!0}processTypeSpecificMessages(e){let t,i,h=!1;const u=new s.O;switch(e.messageType===r.C.Text&&u.setProperty(o.o.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speech.hypothesis":const r=l.r.fromJSON(e.textBody);if(t=new a.i(void 0,this.privRequestSession.requestId,c.s.RecognizingIntent,r.Text,r.Duration,r.Offset+this.privRequestSession.currentTurnAudioOffset,r.Language,r.LanguageDetectionConfidence,void 0,e.textBody,u),this.privRequestSession.onHypothesis(t.offset),i=new p.h(t,r.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId),this.privIntentRecognizer.recognizing)try{this.privIntentRecognizer.recognizing(this.privIntentRecognizer,i)}catch(e){}h=!0;break;case"speech.phrase":const n=v.n.fromJSON(e.textBody);t=new a.i(void 0,this.privRequestSession.requestId,g.o.implTranslateRecognitionResult(n.RecognitionStatus),n.DisplayText,n.Duration,n.Offset+this.privRequestSession.currentTurnAudioOffset,n.Language,n.LanguageDetectionConfidence,void 0,e.textBody,u),i=new p.h(t,t.offset,this.privRequestSession.sessionId);const d=()=>{if(this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,i)}catch(e){}if(this.privSuccessCallback){try{this.privSuccessCallback(t)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}};!1===this.privIntentDataSent||c.s.NoMatch===i.result.reason?(this.privRequestSession.onPhraseRecognized(i.offset+i.result.duration),d()):this.privPendingIntentArgs=i,h=!0;break;case"response":if(i=this.privPendingIntentArgs,this.privPendingIntentArgs=void 0,void 0===i){if(""===e.textBody)return;i=new p.h(new a.i,0,this.privRequestSession.sessionId)}const f=m.T.fromJSON(e.textBody);if(null!==f&&f.topScoringIntent&&f.topScoringIntent.intent){let t=this.privAddedLmIntents[f.topScoringIntent.intent];if(void 0!==this.privUmbrellaIntent&&(t=this.privUmbrellaIntent),t){const r=void 0===t||void 0===t.intentName?f.topScoringIntent.intent:t.intentName;let n=i.result.reason;void 0!==r&&(n=c.s.RecognizedIntent);const h=void 0!==i.result.properties?i.result.properties:new s.O;h.setProperty(o.o.LanguageUnderstandingServiceResponse_JsonResult,e.textBody),i=new p.h(new a.i(r,i.result.resultId,n,i.result.text,i.result.duration,i.result.offset,void 0,void 0,i.result.errorDetails,i.result.json,h),i.offset,i.sessionId)}}if(this.privRequestSession.onPhraseRecognized(i.offset+i.result.duration),this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,i)}catch(e){}if(this.privSuccessCallback){try{this.privSuccessCallback(i.result)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}h=!0}const d=new n.BH;return d.resolve(h),d.promise}cancelRecognition(e,t,i,r,n){const o=new s.O;if(o.setProperty(f.CancellationErrorCodePropertyName,h.E[r]),this.privIntentRecognizer.canceled){const t=new u.v(i,n,r,void 0,void 0,e);try{this.privIntentRecognizer.canceled(this.privIntentRecognizer,t)}catch(e){}}if(this.privSuccessCallback){const e=new a.i(void 0,t,c.s.Canceled,void 0,void 0,void 0,void 0,void 0,n,void 0,o);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(e){}}}}},89906:(e,t,i)=>{"use strict";i.d(t,{o:()=>r});class r{}r.BotId="botid",r.CustomSpeechDeploymentId="cid",r.CustomVoiceDeploymentId="deploymentId",r.EnableAudioLogging="storeAudio",r.EnableLanguageId="lidEnabled",r.EnableWordLevelTimestamps="wordLevelTimestamps",r.EndSilenceTimeoutMs="endSilenceTimeoutMs",r.SegmentationSilenceTimeoutMs="segmentationSilenceTimeoutMs",r.Format="format",r.InitialSilenceTimeoutMs="initialSilenceTimeoutMs",r.Language="language",r.Profanity="profanity",r.RequestBotStatusMessages="enableBotMessageStatus",r.StableIntermediateThreshold="stableIntermediateThreshold",r.StableTranslation="stableTranslation",r.TestHooks="testhooks",r.Postprocessing="postprocessing",r.CtsMeetingId="meetingId",r.CtsDeviceId="deviceId",r.CtsIsParticipant="isParticipant"},41774:(e,t,i)=>{"use strict";i.d(t,{$j:()=>o,Ke:()=>c,M6:()=>a,cK:()=>p});var r,n=i(14300);class s extends n.A{constructor(e,t,i,r=n.t.Info){super(e,r),this.privRequestId=t,this.privSessionId=i}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}}class o extends s{constructor(e,t,i,r){super("RecognitionTriggeredEvent",e,t),this.privAudioSourceId=i,this.privAudioNodeId=r}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}class a extends s{constructor(e,t,i,r){super("ListeningStartedEvent",e,t),this.privAudioSourceId=i,this.privAudioNodeId=r}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}class c extends s{constructor(e,t,i){super("ConnectingToServiceEvent",e,i),this.privAuthFetchEventid=t}get authFetchEventid(){return this.privAuthFetchEventid}}class p extends s{constructor(e,t,i,r,n){super("RecognitionStartedEvent",e,n),this.privAudioSourceId=t,this.privAudioNodeId=i,this.privAuthFetchEventId=r}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}}!function(e){e[e.Success=0]="Success",e[e.AudioSourceError=1]="AudioSourceError",e[e.AudioSourceTimeout=2]="AudioSourceTimeout",e[e.AuthTokenFetchError=3]="AuthTokenFetchError",e[e.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",e[e.UnAuthorized=5]="UnAuthorized",e[e.ConnectTimeout=6]="ConnectTimeout",e[e.ConnectError=7]="ConnectError",e[e.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",e[e.UnknownError=9]="UnknownError"}(r||(r={}))},62029:(e,t,i)=>{"use strict";i.d(t,{OS:()=>d,Xj:()=>c,_y:()=>h,dt:()=>o,jf:()=>r,pu:()=>p,wF:()=>s});var r,n,s,o,a=i(65453);!function(e){e[e.Interactive=0]="Interactive",e[e.Conversation=1]="Conversation",e[e.Dictation=2]="Dictation"}(r||(r={})),function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"}(n||(n={}));class c{constructor(e,t){this.privSpeechServiceConfig=e||new p(new h(null)),this.privParameters=t,this.privMaxRetryCount=parseInt(t.getProperty("SPEECH-Error-MaxRetryCount","4"),10),this.privLanguageIdMode=t.getProperty(a.o.SpeechServiceConnection_LanguageIdMode,void 0)}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(e){this.privRecognitionMode=e,this.privRecognitionActivityTimeout=e===r.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=r[e]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==r.Interactive}get languageIdMode(){return this.privLanguageIdMode}get autoDetectSourceLanguages(){return this.parameters.getProperty(a.o.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get recognitionEndpointVersion(){return this.parameters.getProperty(a.o.SpeechServiceConnection_RecognitionEndpointVersion,void 0)}get sourceLanguageModels(){const e=[];let t=!1;if(void 0!==this.autoDetectSourceLanguages)for(const i of this.autoDetectSourceLanguages.split(",")){const r=i+a.o.SpeechServiceConnection_EndpointId.toString(),n=this.parameters.getProperty(r,void 0);void 0!==n?(e.push({language:i,endpoint:n}),t=!0):e.push({language:i,endpoint:""})}return t?e:void 0}get maxRetryCount(){return this.privMaxRetryCount}}class p{constructor(e){this.context=e}serialize(){return JSON.stringify(this,((e,t)=>{if(t&&"object"==typeof t){const e={};for(const i in t)Object.hasOwnProperty.call(t,i)&&(e[i&&i.charAt(0).toLowerCase()+i.substring(1)]=t[i]);return e}return t}))}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(e){this.recognition=e.toLowerCase()}}class h{constructor(e){this.system=new u,this.os=e}}class u{constructor(){this.name="SpeechSDK",this.version="1.30.1",this.build="JavaScript",this.lang="JavaScript"}}class d{constructor(e,t,i){this.platform=e,this.name=t,this.version=i}}!function(e){e.Bluetooth="Bluetooth",e.Wired="Wired",e.WiFi="WiFi",e.Cellular="Cellular",e.InBuilt="InBuilt",e.Unknown="Unknown"}(s||(s={})),function(e){e.Phone="Phone",e.Speaker="Speaker",e.Car="Car",e.Headset="Headset",e.Thermostat="Thermostat",e.Microphones="Microphones",e.Deskphone="Deskphone",e.RemoteControl="RemoteControl",e.Unknown="Unknown",e.File="File",e.Stream="Stream"}(o||(o={}))},96443:(e,t,i)=>{"use strict";i.d(t,{Y:()=>n,Z:()=>r});class r{constructor(e){this.privActivityResponse=JSON.parse(e)}static fromJSON(e){return new r(e)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}}var n;!function(e){e[e.None=0]="None",e[e.TextToSpeechAudio=1]="TextToSpeechAudio"}(n||(n={}))},35984:(e,t,i)=>{"use strict";i.d(t,{u:()=>n});var r=i(47297);class n{constructor(e){this.privDetailedSpeechPhrase=JSON.parse(e),this.privDetailedSpeechPhrase.RecognitionStatus=r.T[this.privDetailedSpeechPhrase.RecognitionStatus]}static fromJSON(e){return new n(e)}getJsonWithCorrectedOffsets(e){if(this.privDetailedSpeechPhrase.NBest){let t;for(const e of this.privDetailedSpeechPhrase.NBest)if(e.Words&&e.Words[0]){t=e.Words[0].Offset;break}if(t&&t<e){const i=e-t;for(const e of this.privDetailedSpeechPhrase.NBest){if(e.Words)for(const t of e.Words)t.Offset+=i;if(e.DisplayWords)for(const t of e.DisplayWords)t.Offset+=i}}}return JSON.stringify(this.privDetailedSpeechPhrase)}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return void 0===this.privDetailedSpeechPhrase.PrimaryLanguage?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return void 0===this.privDetailedSpeechPhrase.PrimaryLanguage?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}get Text(){return this.privDetailedSpeechPhrase.NBest&&this.privDetailedSpeechPhrase.NBest[0]?this.privDetailedSpeechPhrase.NBest[0].Display||this.privDetailedSpeechPhrase.NBest[0].DisplayText:this.privDetailedSpeechPhrase.DisplayText}get SpeakerId(){return this.privDetailedSpeechPhrase.SpeakerId}}},47297:(e,t,i)=>{"use strict";var r,n;i.d(t,{T:()=>n,g:()=>r}),function(e){e[e.Success=0]="Success",e[e.SynthesisEnd=1]="SynthesisEnd",e[e.Error=2]="Error"}(r||(r={})),function(e){e[e.Success=0]="Success",e[e.NoMatch=1]="NoMatch",e[e.InitialSilenceTimeout=2]="InitialSilenceTimeout",e[e.BabbleTimeout=3]="BabbleTimeout",e[e.Error=4]="Error",e[e.EndOfDictation=5]="EndOfDictation",e[e.TooManyRequests=6]="TooManyRequests",e[e.BadRequest=7]="BadRequest",e[e.Forbidden=8]="Forbidden"}(n||(n={}))},29340:(e,t,i)=>{"use strict";i.d(t,{T:()=>r});class r{constructor(e){this.privIntentResponse=""===e?{}:JSON.parse(e)}static fromJSON(e){return new r(e)}get query(){return this.privIntentResponse.query}get topScoringIntent(){return this.privIntentResponse.topScoringIntent}get entities(){return this.privIntentResponse.entities}}},22436:(e,t,i)=>{"use strict";i.d(t,{n:()=>n});var r=i(47297);class n{constructor(e){this.privSimpleSpeechPhrase=JSON.parse(e),this.privSimpleSpeechPhrase.RecognitionStatus=r.T[this.privSimpleSpeechPhrase.RecognitionStatus]}static fromJSON(e){return new n(e)}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return void 0===this.privSimpleSpeechPhrase.PrimaryLanguage?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return void 0===this.privSimpleSpeechPhrase.PrimaryLanguage?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}}},42559:(e,t,i)=>{"use strict";i.d(t,{s:()=>r});class r{constructor(e){this.privSpeechStartDetected=JSON.parse(e)}static fromJSON(e){return new r(e)}get Offset(){return this.privSpeechStartDetected.Offset}}},60556:(e,t,i)=>{"use strict";i.d(t,{r:()=>r});class r{constructor(e){this.privSpeechHypothesis=JSON.parse(e)}static fromJSON(e){return new r(e)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return void 0===this.privSpeechHypothesis.PrimaryLanguage?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return void 0===this.privSpeechHypothesis.PrimaryLanguage?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}}},11297:(e,t,i)=>{"use strict";i.d(t,{y:()=>r});class r{constructor(e){this.privSpeechKeyword=JSON.parse(e)}static fromJSON(e){return new r(e)}get Status(){return this.privSpeechKeyword.Status}get Text(){return this.privSpeechKeyword.Text}get Offset(){return this.privSpeechKeyword.Offset}get Duration(){return this.privSpeechKeyword.Duration}}},63500:(e,t,i)=>{"use strict";var r;i.d(t,{W:()=>n,p:()=>r}),function(e){e.WordBoundary="WordBoundary",e.Bookmark="Bookmark",e.Viseme="Viseme",e.SentenceBoundary="SentenceBoundary",e.SessionEnd="SessionEnd"}(r||(r={}));class n{constructor(e){this.privSynthesisAudioMetadata=JSON.parse(e)}static fromJSON(e){return new n(e)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}}},41346:(e,t,i)=>{"use strict";i.d(t,{v:()=>n});var r=i(53133);class n{constructor(e){this.privTranslationHypothesis=JSON.parse(e),this.privTranslationHypothesis.Translation.TranslationStatus=r.Y[this.privTranslationHypothesis.Translation.TranslationStatus]}static fromJSON(e){return new n(e)}get Duration(){return this.privTranslationHypothesis.Duration}get Offset(){return this.privTranslationHypothesis.Offset}get Text(){return this.privTranslationHypothesis.Text}get Translation(){return this.privTranslationHypothesis.Translation}}},75163:(e,t,i)=>{"use strict";i.d(t,{Y:()=>o});var r=i(89513),n=i(47297),s=i(53133);class o{constructor(e){this.privTranslationPhrase=e,this.privTranslationPhrase.RecognitionStatus=n.T[this.privTranslationPhrase.RecognitionStatus],void 0!==this.privTranslationPhrase.Translation&&(this.privTranslationPhrase.Translation.TranslationStatus=s.Y[this.privTranslationPhrase.Translation.TranslationStatus])}static fromJSON(e){return new o(JSON.parse(e))}static fromTranslationResponse(e){r.a.throwIfNullOrUndefined(e,"translationResponse");const t=e.SpeechPhrase;return e.SpeechPhrase=void 0,t.Translation=e,t.Text=t.DisplayText,new o(t)}get RecognitionStatus(){return this.privTranslationPhrase.RecognitionStatus}get Offset(){return this.privTranslationPhrase.Offset}get Duration(){return this.privTranslationPhrase.Duration}get Text(){return this.privTranslationPhrase.Text}get Language(){var e;return null===(e=this.privTranslationPhrase.PrimaryLanguage)||void 0===e?void 0:e.Language}get Confidence(){var e;return null===(e=this.privTranslationPhrase.PrimaryLanguage)||void 0===e?void 0:e.Confidence}get Translation(){return this.privTranslationPhrase.Translation}}},18436:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});var r=i(47297);class n{constructor(e){this.privSynthesisEnd=JSON.parse(e),this.privSynthesisEnd.SynthesisStatus&&(this.privSynthesisEnd.SynthesisStatus=r.g[this.privSynthesisEnd.SynthesisStatus]),this.privSynthesisEnd.Status&&(this.privSynthesisEnd.SynthesisStatus=r.g[this.privSynthesisEnd.Status])}static fromJSON(e){return new n(e)}get SynthesisStatus(){return this.privSynthesisEnd.SynthesisStatus}get FailureReason(){return this.privSynthesisEnd.FailureReason}}},73795:(e,t,i)=>{"use strict";i.d(t,{n:()=>r});class r{constructor(e){this.privMessageStatusResponse=JSON.parse(e)}static fromJSON(e){return new r(e)}get interactionId(){return this.privMessageStatusResponse.interactionId}get conversationId(){return this.privMessageStatusResponse.conversationId}get statusCode(){switch(this.privMessageStatusResponse.statusCode){case"Success":return 200;case"Failed":return 400;case"TimedOut":return 429;default:return this.privMessageStatusResponse.statusCode}}}},47916:(e,t,i)=>{"use strict";i.d(t,{q:()=>k});var r=i(78673),n=i(80491),s=i(48232),o=i(42309),a=i(66645),c=i(71945),p=i(43842),h=i(25487),u=i(6550),d=i(98563),l=i(65453),v=i(7841),g=i(99801),m=i(33182),f=i(3625),S=i(41774),y=i(23810),C=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class w{constructor(e){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.privAudioSourceId=e,this.privRequestId=(0,h.Q)(),this.privAudioNodeId=(0,h.Q)(),this.privTurnDeferral=new m.BH,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}listenForServiceTelemetry(e){this.privServiceTelemetryListener&&this.privDetachables.push(e.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRecogNumber++,this.privServiceTelemetryListener=new y.o(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new S.$j(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onAudioSourceAttachCompleted(e,t){return C(this,void 0,void 0,(function*(){this.privAudioNode=e,this.privIsAudioNodeDetached=!1,t?yield this.onComplete():this.onEvent(new S.M6(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}))}onPreConnectionStart(e,t){this.privAuthFetchEventId=e,this.privSessionId=t,this.onEvent(new S.Ke(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))}onAuthCompleted(e){return C(this,void 0,void 0,(function*(){e&&(yield this.onComplete())}))}onConnectionEstablishCompleted(e,t){return C(this,void 0,void 0,(function*(){if(200===e)return this.onEvent(new S.cK(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,void(this.privBytesSent=0);403===e&&(yield this.onComplete())}))}onServiceTurnEndResponse(e){return C(this,void 0,void 0,(function*(){this.privTurnDeferral.resolve(),!e||this.isSpeechEnded?(yield this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privAudioNode.replay())}))}onSpeechContext(){this.privRequestId=(0,h.Q)()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch((()=>{}))),this.privInTurn=!0,this.privTurnDeferral=new m.BH}onHypothesis(e){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(e)))}onPhraseRecognized(e){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(e)),this.onServiceRecognized(e)}onServiceRecognized(e){this.privLastRecoOffset=e,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(e),this.privConnectionAttempts=0}onAudioSent(e){this.privBytesSent+=e}onRetryConnection(){this.privConnectionAttempts++}dispose(){return C(this,void 0,void 0,(function*(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const e of this.privDetachables)yield e.detach();this.privServiceTelemetryListener&&this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}}))}getTelemetry(){return this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null}onStopRecognizing(){return C(this,void 0,void 0,(function*(){yield this.onComplete()}))}onSpeechEnded(){this.privIsSpeechEnded=!0}onEvent(e){this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(e),f.z.instance.onEvent(e)}onComplete(){return C(this,void 0,void 0,(function*(){this.privIsRecognizing&&(this.privIsRecognizing=!1,yield this.detachAudioNode())}))}detachAudioNode(){return C(this,void 0,void 0,(function*(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&(yield this.privAudioNode.detach()))}))}}class R{addPhrase(e){this.privPhrases||(this.privPhrases=[]),e instanceof Array?this.privPhrases=this.privPhrases.concat(e):this.privPhrases.push(e)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(e){this.privGrammars||(this.privGrammars=[]),e instanceof Array?this.privGrammars=this.privGrammars.concat(e):this.privGrammars.push(e)}clearGrammars(){this.privGrammars=void 0}generateGrammarObject(){if(void 0===this.privGrammars&&void 0===this.privPhrases)return;const e={};if(e.ReferenceGrammars=this.privGrammars,void 0!==this.privPhrases&&0!==this.privPhrases.length){const t=[];this.privPhrases.forEach((e=>{t.push({Text:e})})),e.Groups=[{Type:"Generic",Items:t}]}return e}}class P{constructor(e){this.privContext={},this.privDynamicGrammar=e}getSection(e){return this.privContext[e]||{}}setSection(e,t){this.privContext[e]=t}setPronunciationAssessmentParams(e){void 0===this.privContext.phraseDetection&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(e),this.setWordLevelTimings(),this.privContext.phraseOutput.detailed.options.push("PronunciationAssessment"),-1===this.privContext.phraseOutput.detailed.options.indexOf("SNR")&&this.privContext.phraseOutput.detailed.options.push("SNR")}setWordLevelTimings(){void 0===this.privContext.phraseOutput&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),void 0===this.privContext.phraseOutput.detailed&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format="Detailed",-1===this.privContext.phraseOutput.detailed.options.indexOf("WordTimings")&&this.privContext.phraseOutput.detailed.options.push("WordTimings")}toJSON(){const e=this.privDynamicGrammar.generateGrammarObject();return this.setSection("dgi",e),JSON.stringify(this.privContext)}}var I=i(42802),A=i(62029),T=i(42559),b=i(53504),E=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class k{constructor(e,t,i,r,a){if(this.privConnectionConfigurationPromise=void 0,this.privConnectionPromise=void 0,this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.recognizeOverride=void 0,this.recognizeSpeaker=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.handleSpeechPhraseMessage=void 0,this.handleSpeechHypothesisMessage=void 0,!e)throw new n.Do("authentication");if(!t)throw new n.Do("connectionFactory");if(!i)throw new n.Do("audioSource");if(!r)throw new n.Do("recognizerConfig");this.privMustReportEndOfStream=!1,this.privAuthentication=e,this.privConnectionFactory=t,this.privAudioSource=i,this.privRecognizerConfig=r,this.privIsDisposed=!1,this.privRecognizer=a,this.privRequestSession=new w(this.privAudioSource.id()),this.privConnectionEvents=new s.n,this.privServiceEvents=new s.n,this.privDynamicGrammar=new R,this.privSpeechContext=new P(this.privDynamicGrammar),this.privAgentConfig=new I.H,"undefined"!=typeof Blob&&"undefined"!=typeof Worker&&(this.privSetTimeout=o.V.setTimeout),this.connectionEvents.attach((e=>{if("ConnectionClosedEvent"===e.name){const t=e;(1003===t.statusCode||1007===t.statusCode||1002===t.statusCode||4e3===t.statusCode||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&this.cancelRecognitionLocal(u._.Error,1007===t.statusCode?d.E.BadRequestParameters:d.E.ConnectionFailure,`${t.reason} websocket error code: ${t.statusCode}`)}}));const c={};if(void 0!==r.autoDetectSourceLanguages){const e=r.autoDetectSourceLanguages.split(",");let t;t="Continuous"===r.languageIdMode?"DetectContinuous":"DetectAtAudioStart",this.privSpeechContext.setSection("languageId",{Priority:"PrioritizeLatency",languages:e,mode:t,onSuccess:{action:"Recognize"},onUnknown:{action:"None"}}),this.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"Auto"},phraseResults:{resultType:"Always"}});const i=r.sourceLanguageModels;void 0!==i&&(c.customModels=i,c.onInterim={action:"None"},c.onSuccess={action:"None"})}(e=>{for(const t in e)return!1;return!0})(c)||this.privSpeechContext.setSection("phraseDetection",c)}setSpeechSegmentationTimeout(){const e=this.privRecognizerConfig.parameters.getProperty(l.o.Speech_SegmentationSilenceTimeoutMs,void 0);if(void 0!==e){const t=this.recognitionMode===A.jf.Conversation?"CONVERSATION":this.recognitionMode===A.jf.Dictation?"DICTATION":"INTERACTIVE",i=parseInt(e,10),r=this.privSpeechContext.getSection("phraseDetection");r.mode=t,r[t]={segmentation:{mode:"Custom",segmentationSilenceTimeoutMs:i}},this.privSpeechContext.setSection("phraseDetection",r)}}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(e){this.privRecognizerConfig.parameters.setProperty(l.o.ConversationTranslator_Token,e)}set voiceProfileType(e){this.privRecognizerConfig.parameters.setProperty(l.o.SpeechServiceConnection_SpeakerIdMode,e)}set authentication(e){this.privAuthentication=this.authentication}isDisposed(){return this.privIsDisposed}dispose(e){return E(this,void 0,void 0,(function*(){if(this.privIsDisposed=!0,void 0!==this.privConnectionConfigurationPromise)try{const t=yield this.privConnectionConfigurationPromise;yield t.dispose(e)}catch(e){return}}))}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}recognize(e,t,i){return E(this,void 0,void 0,(function*(){if(void 0!==this.recognizeOverride)return void(yield this.recognizeOverride(e,t,i));this.privConnectionConfigurationPromise=void 0,this.privRecognizerConfig.recognitionMode=e,this.setSpeechSegmentationTimeout(),this.privSuccessCallback=t,this.privErrorCallback=i,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);const n=this.connectImpl();let s;try{const e=yield this.audioSource.attach(this.privRequestSession.audioNodeId),t=yield this.audioSource.format,i=yield this.audioSource.deviceInfo;this.privIsLiveAudio=i.type&&i.type===A.dt.Microphones,s=new r.C(e,t.avgBytesPerSec),yield this.privRequestSession.onAudioSourceAttachCompleted(s,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:i}}catch(e){throw yield this.privRequestSession.onStopRecognizing(),e}try{yield n}catch(e){return void(yield this.cancelRecognitionLocal(u._.Error,d.E.ConnectionFailure,e))}const o=new v.$(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,o),this.receiveMessage(),this.sendAudio(s).catch((e=>E(this,void 0,void 0,(function*(){yield this.cancelRecognitionLocal(u._.Error,d.E.RuntimeError,e)}))))}))}stopRecognizing(){return E(this,void 0,void 0,(function*(){if(this.privRequestSession.isRecognizing)try{yield this.audioSource.turnOff(),yield this.sendFinalAudio(),yield this.privRequestSession.onStopRecognizing(),yield this.privRequestSession.turnCompletionPromise}finally{yield this.privRequestSession.dispose()}}))}connect(){return E(this,void 0,void 0,(function*(){return yield this.connectImpl(),Promise.resolve()}))}connectAsync(e,t){this.connectImpl().then((()=>{try{e&&e()}catch(e){t&&t(e)}}),(e=>{try{t&&t(e)}catch(e){}}))}disconnect(){return E(this,void 0,void 0,(function*(){if(yield this.cancelRecognitionLocal(u._.Error,d.E.NoError,"Disconnecting"),void 0!==this.disconnectOverride&&(yield this.disconnectOverride()),void 0!==this.privConnectionPromise)try{yield(yield this.privConnectionPromise).dispose()}catch(e){}this.privConnectionPromise=void 0}))}sendMessage(e){}sendNetworkMessage(e,t){return E(this,void 0,void 0,(function*(){const i="string"==typeof t?a.C.Text:a.C.Binary,r="string"==typeof t?"application/json":"";return(yield this.fetchConnection()).send(new b.r(i,e,this.privRequestSession.requestId,r,t))}))}set activityTemplate(e){this.privActivityTemplate=e}get activityTemplate(){return this.privActivityTemplate}sendTelemetryData(){return E(this,void 0,void 0,(function*(){const e=this.privRequestSession.getTelemetry();if(!0!==k.telemetryDataEnabled||this.privIsDisposed||null===e)return;if(k.telemetryData)try{k.telemetryData(e)}catch(e){}const t=yield this.fetchConnection();yield t.send(new b.r(a.C.Text,"telemetry",this.privRequestSession.requestId,"application/json",e))}))}cancelRecognitionLocal(e,t,i){return E(this,void 0,void 0,(function*(){this.privRequestSession.isRecognizing&&(yield this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,e,t,i))}))}receiveMessage(){return E(this,void 0,void 0,(function*(){try{if(this.privIsDisposed)return;let e=yield this.fetchConnection();const t=yield e.read();if(void 0!==this.receiveMessageOverride)return this.receiveMessageOverride();if(!t)return this.privRequestSession.isRecognizing?this.receiveMessage():void 0;this.privServiceHasSentMessage=!0;const i=b.r.fromConnectionMessage(t);if(i.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(i.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":const t=T.s.fromJSON(i.textBody),r=new g.J(t.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,r);break;case"speech.enddetected":let n;n=i.textBody.length>0?i.textBody:"{ Offset: 0 }";const s=T.s.fromJSON(n),o=new g.J(s.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,o);break;case"turn.end":yield this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,yield this.cancelRecognitionLocal(u._.EndOfStream,d.E.NoError,void 0));const a=new v.$(this.privRequestSession.sessionId);if(yield this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)return void(this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,a));e=yield this.fetchConnection(),yield this.sendPrePayloadJSON(e);break;default:(yield this.processTypeSpecificMessages(i))||this.privServiceEvents&&this.serviceEvents.onEvent(new c.e2(i.path.toLowerCase(),i.textBody))}return this.receiveMessage()}catch(e){return null}}))}sendSpeechContext(e,t){const i=this.speechContext.toJSON();if(t&&this.privRequestSession.onSpeechContext(),i)return e.send(new b.r(a.C.Text,"speech.context",this.privRequestSession.requestId,"application/json",i))}noOp(){}sendPrePayloadJSON(e,t=!0){return E(this,void 0,void 0,(function*(){if(void 0!==this.sendPrePayloadJSONOverride)return this.sendPrePayloadJSONOverride(e);yield this.sendSpeechContext(e,t),yield this.sendWaveHeader(e)}))}sendWaveHeader(e){return E(this,void 0,void 0,(function*(){const t=yield this.audioSource.format;return e.send(new b.r(a.C.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",t.header))}))}connectImpl(){return void 0!==this.privConnectionPromise?this.privConnectionPromise.then((e=>e.state()===p.e.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise),(()=>(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()))):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch((()=>{})),void 0!==this.postConnectImplOverride?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}sendSpeechServiceConfig(e,t,i){if(t.onSpeechContext(),!0!==k.telemetryDataEnabled){const e={context:{system:JSON.parse(i).context.system}};i=JSON.stringify(e)}if("true"===this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()){const e=JSON.parse(i);e.context.DisableReferenceChannel="True",e.context.MicSpec="1_0_0",i=JSON.stringify(e)}if(i)return e.send(new b.r(a.C.Text,"speech.config",t.requestId,"application/json",i))}fetchConnection(){return E(this,void 0,void 0,(function*(){return void 0!==this.privConnectionConfigurationPromise?this.privConnectionConfigurationPromise.then((e=>e.state()===p.e.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise),(()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()))):(this.privConnectionConfigurationPromise=this.configureConnection(),yield this.privConnectionConfigurationPromise)}))}sendAudio(e){return E(this,void 0,void 0,(function*(){const t=yield this.audioSource.format;let i=Date.now();const r=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),n=t.avgBytesPerSec/1e3*parseInt(r,10),s=this.privRequestSession.recogNumber,o=()=>E(this,void 0,void 0,(function*(){if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===s){const r=yield this.fetchConnection(),c=yield e.read();if(this.privRequestSession.isSpeechEnded)return;let p,h;if(!c||c.isEnd?(p=null,h=0):(p=c.buffer,this.privRequestSession.onAudioSent(p.byteLength),h=n>=this.privRequestSession.bytesSent?0:Math.max(0,i-Date.now())),0!==h&&(yield this.delay(h)),null!==p&&(i=Date.now()+1e3*p.byteLength/(2*t.avgBytesPerSec)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===s){if(r.send(new b.r(a.C.Binary,"audio",this.privRequestSession.requestId,null,p)).catch((()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch((()=>{}))})),!(null==c?void 0:c.isEnd))return o();this.privIsLiveAudio||this.privRequestSession.onSpeechEnded()}}}));return o()}))}retryableConnect(){return E(this,void 0,void 0,(function*(){let e=!1;this.privAuthFetchEventId=(0,h.Q)();const t=this.privRequestSession.sessionId;this.privConnectionId=void 0!==t?t:(0,h.Q)(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let i=0,r="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){const t=e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId),n=yield t;yield this.privRequestSession.onAuthCompleted(!1);const s=this.privConnectionFactory.create(this.privRecognizerConfig,n,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(s.events),s.events.attach((e=>{this.connectionEvents.onEvent(e)}));const o=yield s.open();if(200===o.statusCode)return yield this.privRequestSession.onConnectionEstablishCompleted(o.statusCode),Promise.resolve(s);1006===o.statusCode&&(e=!0),i=o.statusCode,r=o.reason,this.privRequestSession.onRetryConnection()}return yield this.privRequestSession.onConnectionEstablishCompleted(i,r),Promise.reject(`Unable to contact server. StatusCode: ${i}, ${this.privRecognizerConfig.parameters.getProperty(l.o.SpeechServiceConnection_Endpoint)} Reason: ${r}`)}))}delay(e){return new Promise((t=>this.privSetTimeout(t,e)))}writeBufferToConsole(e){let t="Buffer Size: ";if(null===e)t+="null";else{const i=new Uint8Array(e);t+=`${e.byteLength}\r\n`;for(let r=0;r<e.byteLength;r++)t+=i[r].toString(16).padStart(2,"0")+" ",(r+1)%16==0&&(console.info(t),t="")}console.info(t)}sendFinalAudio(){return E(this,void 0,void 0,(function*(){const e=yield this.fetchConnection();yield e.send(new b.r(a.C.Binary,"audio",this.privRequestSession.requestId,null,null))}))}configureConnection(){return E(this,void 0,void 0,(function*(){const e=yield this.connectImpl();return void 0!==this.configConnectionOverride?this.configConnectionOverride(e):(yield this.sendSpeechServiceConfig(e,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),yield this.sendPrePayloadJSON(e,!1),e)}))}}k.telemetryDataEnabled=!0},23810:(e,t,i)=>{"use strict";i.d(t,{o:()=>o});var r=i(86582),n=i(71945),s=i(41774);class o{constructor(e,t,i){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privRequestId=e,this.privAudioSourceId=t,this.privAudioNodeId=i,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(e){e>0&&this.privPhraseLatencies.push(Date.now()-e)}hypothesisReceived(e){e>0&&this.privHypothesisLatencies.push(Date.now()-e)}onEvent(e){if(!this.privIsDisposed&&(e instanceof s.$j&&e.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:e.eventTime,Name:"ListeningTrigger",Start:e.eventTime}),e instanceof r.i5&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof r.sQ&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof r.n0&&e.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof r.hA&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof r.He&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Name:"Microphone",Start:this.privMicStartTime})),e instanceof s.Ke&&e.requestId===this.privRequestId&&(this.privConnectionId=e.sessionId),e instanceof n.YF&&e.connectionId===this.privConnectionId&&(this.privConnectionStartTime=e.eventTime),e instanceof n.Zk&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof n.xz&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Error:this.getConnectionError(e.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof n.Qz&&e.connectionId===this.privConnectionId&&e.message&&e.message.headers&&e.message.headers.path)){this.privReceivedMessages[e.message.headers.path]||(this.privReceivedMessages[e.message.headers.path]=new Array);const t=50;this.privReceivedMessages[e.message.headers.path].length<t&&this.privReceivedMessages[e.message.headers.path].push(e.networkReceivedTime)}}getTelemetry(){const e=new Array;this.privListeningTriggerMetric&&e.push(this.privListeningTriggerMetric),this.privMicMetric&&e.push(this.privMicMetric),this.privConnectionEstablishMetric&&e.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&e.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&e.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});const t={Metrics:e,ReceivedMessages:this.privReceivedMessages},i=JSON.stringify(t);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],i}get hasTelemetry(){return 0!==Object.keys(this.privReceivedMessages).length||null!==this.privListeningTriggerMetric||null!==this.privMicMetric||null!==this.privConnectionEstablishMetric||0!==this.privPhraseLatencies.length||0!==this.privHypothesisLatencies.length}dispose(){this.privIsDisposed=!0}getConnectionError(e){switch(e){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+e.toString()}}}},81667:(e,t,i)=>{"use strict";i.d(t,{$:()=>h,m:()=>u});var r=i(99949),n=i(38717),s=i(65453),o=i(70092),a=i(65610),c=i(84257);class p extends o._{create(e,t,i,p){let h=e.parameters.getProperty(s.o.SpeechServiceConnection_Endpoint);if(!h){const t=e.parameters.getProperty(s.o.SpeechServiceConnection_Region),r=o._.getHostSuffix(t),n=e.parameters.getProperty(s.o.SpeechServiceConnection_Host,`wss://${t}.spr-frontend.speech${r}`),a=e.parameters.getProperty(s.o.SpeechServiceConnection_SpeakerIdMode,"TextIndependentIdentification");h=`${n}/speaker/ws/${this.scenarioToPath(a)}/${i}`}const u={format:"simple",language:e.parameters.getProperty(s.o.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(e,u,h);const d={};void 0!==t.token&&""!==t.token&&(d[t.headerName]=t.token),d[c.S.ConnectionId]=p,d[c.S.SpIDAuthKey]=e.parameters.getProperty(s.o.SpeechServiceConnection_Key),e.parameters.setProperty(s.o.SpeechServiceConnection_Url,h);const l="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new r.i(h,u,d,new a.D,n.i.fromRecognizerConfig(e),l,p)}scenarioToPath(e){switch(e){case"TextIndependentVerification":case"2":return"verification/text-independent";case"TextDependentVerification":case"1":return"verification/text-dependent";default:return"identification/text-independent"}}}class h extends p{create(e,t,i){return super.create(e,t,"recognition",i)}}class u extends p{create(e,t,i){return super.create(e,t,"profile",i)}}},94589:(e,t,i)=>{"use strict";i.d(t,{w:()=>f});var r=i(78673),n=i(66645),s=i(33182),o=i(22874),a=i(65453),c=i(20888),p=i(91048),h=i(98563),u=i(6550),d=i(7841),l=i(47916),v=i(62389),g=i(53504),m=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class f extends l.q{constructor(e,t,i,r,n){super(e,t,i,r,n),this.privSpeakerRecognizer=n,this.privSpeakerAudioSource=i,this.recognizeSpeaker=e=>this.recognizeSpeakerOnce(e),this.sendPrePayloadJSONOverride=()=>this.noOp()}processTypeSpecificMessages(e){let t=!1;const i=new o.O;if(e.messageType===n.C.Text&&i.setProperty(a.o.SpeechServiceResponse_JsonResult,e.textBody),"speaker.response"===e.path.toLowerCase()){const i=JSON.parse(e.textBody);let r;r="success"!==i.status.statusCode.toLowerCase()?new c.uH(i,p.s.Canceled,h.E.ServiceError,i.status.reason):new c.uH(i,p.s.RecognizedSpeaker),this.privResultDeferral&&this.privResultDeferral.resolve(r),t=!0}const r=new s.BH;return r.resolve(t),r.promise}cancelRecognition(e,t,i,r,n){if((new o.O).setProperty(v.CancellationErrorCodePropertyName,h.E[r]),this.privResultDeferral){const e=new c.uH({scenario:this.privSpeakerModel.scenario,status:{statusCode:n,reason:n}},p.s.Canceled,r,n);try{this.privResultDeferral.resolve(e)}catch(n){this.privResultDeferral.reject(n)}}}recognizeSpeakerOnce(e){return m(this,void 0,void 0,(function*(){this.privSpeakerModel=e,this.voiceProfileType=e.scenario,this.privResultDeferral||(this.privResultDeferral=new s.BH),this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(a.o.Speech_SessionId,this.privRequestSession.sessionId);const t=this.connectImpl(),i=this.sendPreAudioMessages(this.extractSpeakerContext(e)),n=yield this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),o=yield this.privSpeakerAudioSource.format,c=yield this.privSpeakerAudioSource.deviceInfo,p=new r.C(n,o.avgBytesPerSec);yield this.privRequestSession.onAudioSourceAttachCompleted(p,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:c};try{yield t,yield i}catch(e){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,u._.Error,h.E.ConnectionFailure,e)}const l=new d.$(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,l),this.receiveMessage(),this.sendAudio(p).then((()=>{}),(e=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,u._.Error,h.E.RuntimeError,e)})),this.privResultDeferral.promise}))}sendPreAudioMessages(e){return m(this,void 0,void 0,(function*(){const t=yield this.fetchConnection();yield this.sendSpeakerRecognition(t,e)}))}sendSpeakerRecognition(e,t){return m(this,void 0,void 0,(function*(){const i=JSON.stringify(t);return e.send(new g.r(n.C.Text,"speaker.context",this.privRequestSession.requestId,"application/json; charset=utf-8",i))}))}extractSpeakerContext(e){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:e.profileIds,scenario:e.scenario}}}},23955:(e,t,i)=>{"use strict";i.d(t,{i:()=>l});var r=i(99949),n=i(38717),s=i(62389),o=i(65453),a=i(88530),c=i(70092),p=i(62029),h=i(65610),u=i(84257),d=i(89906);class l extends c._{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.universalUri="/speech/universal/v"}create(e,t,i){let l=e.parameters.getProperty(o.o.SpeechServiceConnection_Endpoint,void 0);const v=e.parameters.getProperty(o.o.SpeechServiceConnection_Region,void 0),g=c._.getHostSuffix(v),m=e.parameters.getProperty(o.o.SpeechServiceConnection_Host,"wss://"+v+".stt.speech"+g),f={},S=e.parameters.getProperty(o.o.SpeechServiceConnection_EndpointId,void 0),y=e.parameters.getProperty(o.o.SpeechServiceConnection_RecoLanguage,void 0);if(S?l&&-1!==l.search(d.o.CustomSpeechDeploymentId)||(f[d.o.CustomSpeechDeploymentId]=S):y&&(l&&-1!==l.search(d.o.Language)||(f[d.o.Language]=y)),l&&-1!==l.search(d.o.Format)||(f[d.o.Format]=e.parameters.getProperty(s.OutputFormatPropertyName,a.W[a.W.Simple]).toLowerCase()),void 0!==e.autoDetectSourceLanguages&&(f[d.o.EnableLanguageId]="true"),this.setCommonUrlParams(e,f,l),!l)switch(e.recognitionMode){case p.jf.Conversation:l="true"===e.parameters.getProperty(s.ForceDictationPropertyName,"false")?m+this.dictationRelativeUri:void 0!==e.recognitionEndpointVersion&&parseInt(e.recognitionEndpointVersion,10)>1?`${m}${this.universalUri}${e.recognitionEndpointVersion}`:m+this.conversationRelativeUri;break;case p.jf.Dictation:l=m+this.dictationRelativeUri;break;default:l=void 0!==e.recognitionEndpointVersion&&parseInt(e.recognitionEndpointVersion,10)>1?`${m}${this.universalUri}${e.recognitionEndpointVersion}`:m+this.interactiveRelativeUri}const C={};void 0!==t.token&&""!==t.token&&(C[t.headerName]=t.token),C[u.S.ConnectionId]=i;const w="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false"),R=new r.i(l,f,C,new h.D,n.i.fromRecognizerConfig(e),w,i),P=R.uri;return e.parameters.setProperty(o.o.SpeechServiceConnection_Url,P),R}}},53504:(e,t,i)=>{"use strict";i.d(t,{r:()=>o});var r=i(66645),n=i(80491),s=i(84257);class o extends r.H{constructor(e,t,i,r,o,a,c,p){if(!t)throw new n.Do("path");if(!i)throw new n.Do("requestId");const h={};if(h[s.S.Path]=t,h[s.S.RequestId]=i,h[s.S.RequestTimestamp]=(new Date).toISOString(),r&&(h[s.S.ContentType]=r),a&&(h[s.S.RequestStreamId]=a),c)for(const e in c)e&&(h[e]=c[e]);p?super(e,o,h,p):super(e,o,h),this.privPath=t,this.privRequestId=i,this.privContentType=r,this.privStreamId=a,this.privAdditionalHeaders=c}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}static fromConnectionMessage(e){let t=null,i=null,r=null,n=null;const a={};if(e.headers)for(const o in e.headers)o&&(o.toLowerCase()===s.S.Path.toLowerCase()?t=e.headers[o]:o.toLowerCase()===s.S.RequestId.toLowerCase()?i=e.headers[o]:o.toLowerCase()===s.S.ContentType.toLowerCase()?r=e.headers[o]:o.toLowerCase()===s.S.RequestStreamId.toLowerCase()?n=e.headers[o]:a[o]=e.headers[o]);return new o(e.messageType,t,i,r,e.body,n,a,e.id)}}},35091:(e,t,i)=>{"use strict";i.d(t,{h:()=>S});var r=i(22874),n=i(65453),s=i(98670),o=i(91048),a=i(53383),c=i(88530),p=i(98563),h=i(52438),u=i(47916),d=i(60556),l=i(22436),v=i(51054),g=i(47297),m=i(62389),f=i(35984);class S extends u.q{constructor(e,t,i,r,n){super(e,t,i,r,n),this.privSpeechRecognizer=n}processTypeSpecificMessages(e){return t=this,i=void 0,h=function*(){let t;const i=new r.O;i.setProperty(n.o.SpeechServiceResponse_JsonResult,e.textBody);let p=!1;switch(e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const r=d.r.fromJSON(e.textBody),n=r.Offset+this.privRequestSession.currentTurnAudioOffset;t=new s.b(this.privRequestSession.requestId,o.s.RecognizingSpeech,r.Text,r.Duration,n,r.Language,r.LanguageDetectionConfidence,void 0,void 0,e.textBody,i),this.privRequestSession.onHypothesis(n);const h=new a.m(t,r.Duration,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,h)}catch(e){}p=!0;break;case"speech.phrase":const u=l.n.fromJSON(e.textBody),S=v.o.implTranslateRecognitionResult(u.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+u.Offset+u.Duration),o.s.Canceled===S){const e=v.o.implTranslateCancelResult(u.RecognitionStatus),t=v.o.implTranslateCancelErrorCode(u.RecognitionStatus);yield this.cancelRecognitionLocal(e,t,v.o.implTranslateErrorDetails(t))}else{if(!this.privRequestSession.isSpeechEnded||S!==o.s.NoMatch||u.RecognitionStatus===g.T.InitialSilenceTimeout){if(this.privRecognizerConfig.parameters.getProperty(m.OutputFormatPropertyName)===c.W[c.W.Simple])t=new s.b(this.privRequestSession.requestId,S,u.DisplayText,u.Duration,u.Offset+this.privRequestSession.currentTurnAudioOffset,u.Language,u.LanguageDetectionConfidence,void 0,void 0,e.textBody,i);else{const r=f.u.fromJSON(e.textBody),n=r.Offset+this.privRequestSession.currentTurnAudioOffset,o=r.getJsonWithCorrectedOffsets(n);t=new s.b(this.privRequestSession.requestId,S,r.RecognitionStatus===g.T.Success?r.NBest[0].Display:void 0,r.Duration,n,r.Language,r.LanguageDetectionConfidence,void 0,void 0,o,i)}const r=new a.m(t,t.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,r)}catch(e){}}if(this.privSuccessCallback){try{this.privSuccessCallback(t)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}p=!0}return p},new((p=void 0)||(p=Promise))((function(e,r){function n(e){try{o(h.next(e))}catch(e){r(e)}}function s(e){try{o(h.throw(e))}catch(e){r(e)}}function o(t){var i;t.done?e(t.value):(i=t.value,i instanceof p?i:new p((function(e){e(i)}))).then(n,s)}o((h=h.apply(t,i||[])).next())}));var t,i,p,h}cancelRecognition(e,t,i,n,a){const c=new r.O;if(c.setProperty(m.CancellationErrorCodePropertyName,p.E[n]),this.privSpeechRecognizer.canceled){const t=new h.n(i,a,n,void 0,e);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,t)}catch(e){}}if(this.privSuccessCallback){const e=new s.b(t,o.s.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,a,void 0,c);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(e){}}}}},83697:(e,t,i)=>{"use strict";i.d(t,{i:()=>h});var r=i(99949),n=i(38717),s=i(65453),o=i(70092),a=i(65610),c=i(84257),p=i(89906);class h{constructor(){this.synthesisUri="/cognitiveservices/websocket/v1"}create(e,t,i){let h=e.parameters.getProperty(s.o.SpeechServiceConnection_Endpoint,void 0);const u=e.parameters.getProperty(s.o.SpeechServiceConnection_Region,void 0),d=o._.getHostSuffix(u),l=e.parameters.getProperty(s.o.SpeechServiceConnection_EndpointId,void 0),v=void 0===l?"tts":"voice",g=e.parameters.getProperty(s.o.SpeechServiceConnection_Host,"wss://"+u+"."+v+".speech"+d);h||(h=g+this.synthesisUri);const m={};void 0!==t.token&&""!==t.token&&(m[t.headerName]=t.token),m[c.S.ConnectionId]=i,void 0!==l&&(m[p.o.CustomVoiceDeploymentId]=l),e.parameters.setProperty(s.o.SpeechServiceConnection_Url,h);const f="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new r.i(h,{},m,new a.D,n.i.fromParameters(e.parameters),f,i)}}},57895:(e,t,i)=>{"use strict";i.d(t,{E:()=>x});var r=i(80491),n=i(48232),s=i(66645),o=i(71945),a=i(43842),c=i(25487),p=i(6550),h=i(98563),u=i(24974),d=i(71211),l=i(91048),v=i(22874),g=i(93491),m=i(93733),f=i(20002),S=i(65453),y=i(33182),C=i(3625),w=i(1912),R=i(63500),P=i(61923),I=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class A{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privRequestId=(0,c.Q)(),this.privTurnDeferral=new y.BH,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(e){this.privStreamId=e}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(e){this.privAudioOutputFormat=e}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get currentSentenceOffset(){return this.privSentenceOffset}get bytesReceived(){return this.privBytesReceived}get audioDuration(){return this.privAudioDuration}getAllReceivedAudio(){return I(this,void 0,void 0,(function*(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(yield this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null}))}getAllReceivedAudioWithHeader(){return I(this,void 0,void 0,(function*(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){const e=yield this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=x.addHeader(e,this.audioOutputFormat),this.privReceivedAudioWithHeader}return this.getAllReceivedAudio()}))}startNewSynthesis(e,t,i,r){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=e,this.privRawText=t,this.privIsSSML=i,this.privAudioOutputStream=new w.NO,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privPartialVisemeAnimation="",void 0!==r&&(this.privTurnAudioDestination=r,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new P.Nx(this.requestId,void 0,void 0===r?void 0:r.id()))}onPreConnectionStart(e){this.privAuthFetchEventId=e,this.onEvent(new P.xZ(this.privRequestId,this.privAuthFetchEventId))}onAuthCompleted(e){e&&this.onComplete()}onConnectionEstablishCompleted(e){if(200===e)return this.onEvent(new P.Bz(this.requestId,this.privAuthFetchEventId)),void(this.privBytesReceived=0);403===e&&this.onComplete()}onServiceResponseMessage(e){const t=JSON.parse(e);this.streamId=t.audio.streamId}onServiceTurnEndResponse(){this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch((()=>{}))),this.privInTurn=!0,this.privTurnDeferral=new y.BH}onAudioChunkReceived(e){this.isSynthesizing&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength,void 0!==this.privTurnAudioDestination&&this.privTurnAudioDestination.write(e))}onTextBoundaryEvent(e){this.updateTextOffset(e.Data.text.Text,e.Type)}onVisemeMetadataReceived(e){void 0!==e.Data.AnimationChunk&&(this.privPartialVisemeAnimation+=e.Data.AnimationChunk)}onSessionEnd(e){this.privAudioDuration=e.Data.Offset}dispose(){this.privIsDisposed||(this.privIsDisposed=!0)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){const e=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",e}onEvent(e){C.z.instance.onEvent(e)}static isXmlTag(e){return e.length>=2&&"<"===e[0]&&">"===e[e.length-1]}updateTextOffset(e,t){t===R.p.WordBoundary?(this.privTextOffset=this.privRawText.indexOf(e,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+e.length,this.privIsSSML&&this.withinXmlTag(this.privTextOffset)&&!A.isXmlTag(e)&&this.updateTextOffset(e,t))):(this.privSentenceOffset=this.privRawText.indexOf(e,this.privNextSearchSentenceIndex),this.privSentenceOffset>=0&&(this.privNextSearchSentenceIndex=this.privSentenceOffset+e.length,this.privIsSSML&&this.withinXmlTag(this.privSentenceOffset)&&!A.isXmlTag(e)&&this.updateTextOffset(e,t)))}onComplete(){this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,void 0!==this.privTurnAudioDestination&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))}readAllAudioFromStream(){return I(this,void 0,void 0,(function*(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{yield this.privAudioOutputStream.read(this.privReceivedAudio)}catch(e){this.privReceivedAudio=new ArrayBuffer(0)}}}))}withinXmlTag(e){return this.privRawText.indexOf("<",e+1)>this.privRawText.indexOf(">",e+1)}}class T{constructor(e){this.privContext={},this.privSpeechSynthesizer=e}setSection(e,t){this.privContext[e]=t}set audioOutputFormat(e){this.privAudioOutputFormat=e}toJSON(){const e=this.buildSynthesisContext();return this.setSection("synthesis",e),JSON.stringify(this.privContext)}buildSynthesisContext(){return{audio:{metadataOptions:{bookmarkEnabled:!!this.privSpeechSynthesizer.bookmarkReached,punctuationBoundaryEnabled:this.privSpeechSynthesizer.properties.getProperty(S.o.SpeechServiceResponse_RequestPunctuationBoundary,!!this.privSpeechSynthesizer.wordBoundary),sentenceBoundaryEnabled:this.privSpeechSynthesizer.properties.getProperty(S.o.SpeechServiceResponse_RequestSentenceBoundary,!1),sessionEndEnabled:!0,visemeEnabled:!!this.privSpeechSynthesizer.visemeReceived,wordBoundaryEnabled:this.privSpeechSynthesizer.properties.getProperty(S.o.SpeechServiceResponse_RequestWordBoundary,!!this.privSpeechSynthesizer.wordBoundary)},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:this.privSpeechSynthesizer.autoDetectSourceLanguage}}}}var b=i(42802),E=i(62389),k=i(53504),N=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class x{constructor(e,t,i,s,o){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.privConnectionConfigurationPromise=void 0,!e)throw new r.Do("authentication");if(!t)throw new r.Do("connectionFactory");if(!i)throw new r.Do("synthesizerConfig");this.privAuthentication=e,this.privConnectionFactory=t,this.privSynthesizerConfig=i,this.privIsDisposed=!1,this.privSpeechSynthesizer=s,this.privSessionAudioDestination=o,this.privSynthesisTurn=new A,this.privConnectionEvents=new n.n,this.privServiceEvents=new n.n,this.privSynthesisContext=new T(this.privSpeechSynthesizer),this.privAgentConfig=new b.H,this.connectionEvents.attach((e=>{if("ConnectionClosedEvent"===e.name){const t=e;1e3!==t.statusCode&&this.cancelSynthesisLocal(p._.Error,1007===t.statusCode?h.E.BadRequestParameters:h.E.ConnectionFailure,`${t.reason} websocket error code: ${t.statusCode}`)}}))}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(e){this.privActivityTemplate=e}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(e){this.privAudioOutputFormat=e,this.privSynthesisTurn.audioOutputFormat=e,void 0!==this.privSessionAudioDestination&&(this.privSessionAudioDestination.format=e),void 0!==this.synthesisContext&&(this.synthesisContext.audioOutputFormat=e)}static addHeader(e,t){if(!t.hasHeader)return e;t.updateHeader(e.byteLength);const i=new Uint8Array(e.byteLength+t.header.byteLength);return i.set(new Uint8Array(t.header),0),i.set(new Uint8Array(e),t.header.byteLength),i.buffer}isDisposed(){return this.privIsDisposed}dispose(e){return N(this,void 0,void 0,(function*(){if(this.privIsDisposed=!0,void 0!==this.privSessionAudioDestination&&this.privSessionAudioDestination.close(),void 0!==this.privConnectionConfigurationPromise){const t=yield this.privConnectionConfigurationPromise;yield t.dispose(e)}}))}connect(){return N(this,void 0,void 0,(function*(){yield this.connectImpl()}))}sendNetworkMessage(e,t){return N(this,void 0,void 0,(function*(){const i="string"==typeof t?s.C.Text:s.C.Binary,r="string"==typeof t?"application/json":"";return(yield this.fetchConnection()).send(new k.r(i,e,this.privSynthesisTurn.requestId,r,t))}))}Speak(e,t,i,r,n,s){return N(this,void 0,void 0,(function*(){let o;if(o=t?e:this.privSpeechSynthesizer.buildSsml(e),void 0!==this.speakOverride)return this.speakOverride(o,i,r,n);this.privSuccessCallback=r,this.privErrorCallback=n,this.privSynthesisTurn.startNewSynthesis(i,e,t,s);try{yield this.connectImpl();const e=yield this.fetchConnection();yield this.sendSynthesisContext(e),yield this.sendSsmlMessage(e,o,i);const t=new u.c(new d.P(i,l.s.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,t),this.receiveMessage()}catch(e){return this.cancelSynthesisLocal(p._.Error,h.E.ConnectionFailure,e),Promise.reject(e)}}))}cancelSynthesis(e,t,i,r){const n=new v.O;n.setProperty(E.CancellationErrorCodePropertyName,h.E[i]);const s=new d.P(e,l.s.Canceled,void 0,r,n);if(this.privSpeechSynthesizer.SynthesisCanceled){const e=new u.c(s);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,e)}catch(e){}}if(this.privSuccessCallback)try{this.privSuccessCallback(s)}catch(e){}}cancelSynthesisLocal(e,t,i){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,e,t,i))}processTypeSpecificMessages(e){return!0}receiveMessage(){return N(this,void 0,void 0,(function*(){try{const e=yield this.fetchConnection(),t=yield e.read();if(void 0!==this.receiveMessageOverride)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!t)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;const i=k.r.fromConnectionMessage(t);if(i.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(i.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse();break;case"response":this.privSynthesisTurn.onServiceResponseMessage(i.textBody);break;case"audio":if(this.privSynthesisTurn.streamId.toLowerCase()===i.streamId.toLowerCase()&&i.binaryBody){if(this.privSynthesisTurn.onAudioChunkReceived(i.binaryBody),this.privSpeechSynthesizer.synthesizing)try{const e=x.addHeader(i.binaryBody,this.privSynthesisTurn.audioOutputFormat),t=new u.c(new d.P(this.privSynthesisTurn.requestId,l.s.SynthesizingAudio,e));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,t)}catch(e){}void 0!==this.privSessionAudioDestination&&this.privSessionAudioDestination.write(i.binaryBody)}break;case"audio.metadata":const e=R.W.fromJSON(i.textBody).Metadata;for(const t of e)switch(t.Type){case R.p.WordBoundary:case R.p.SentenceBoundary:this.privSynthesisTurn.onTextBoundaryEvent(t);const e=new g.G(t.Data.Offset,t.Data.Duration,t.Data.text.Text,t.Data.text.Length,t.Type===R.p.WordBoundary?this.privSynthesisTurn.currentTextOffset:this.privSynthesisTurn.currentSentenceOffset,t.Data.text.BoundaryType);if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,e)}catch(e){}break;case R.p.Bookmark:const i=new m.i(t.Data.Offset,t.Data.Bookmark);if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,i)}catch(e){}break;case R.p.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(t),t.Data.IsLastAnimation){const e=new f.w(t.Data.Offset,t.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,e)}catch(e){}}break;case R.p.SessionEnd:this.privSynthesisTurn.onSessionEnd(t)}break;case"turn.end":let t;this.privSynthesisTurn.onServiceTurnEndResponse();try{const e=yield this.privSynthesisTurn.getAllReceivedAudioWithHeader();t=new d.P(this.privSynthesisTurn.requestId,l.s.SynthesizingAudioCompleted,e,void 0,void 0,this.privSynthesisTurn.audioDuration),this.privSuccessCallback&&this.privSuccessCallback(t)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new u.c(t))}catch(e){}break;default:this.processTypeSpecificMessages(i)||this.privServiceEvents&&this.serviceEvents.onEvent(new o.e2(i.path.toLowerCase(),i.textBody))}return this.receiveMessage()}catch(e){}}))}sendSynthesisContext(e){const t=this.synthesisContext.toJSON();if(t)return e.send(new k.r(s.C.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",t))}connectImpl(e=!1){if(null!=this.privConnectionPromise)return this.privConnectionPromise.then((e=>e.state()===a.e.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise),(()=>(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl())));this.privAuthFetchEventId=(0,c.Q)(),this.privConnectionId=(0,c.Q)(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);const t=e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=t.then((t=>N(this,void 0,void 0,(function*(){this.privSynthesisTurn.onAuthCompleted(!1);const i=this.privConnectionFactory.create(this.privSynthesizerConfig,t,this.privConnectionId);i.events.attach((e=>{this.connectionEvents.onEvent(e)}));const r=yield i.open();return 200===r.statusCode?(this.privSynthesisTurn.onConnectionEstablishCompleted(r.statusCode),Promise.resolve(i)):403!==r.statusCode||e?(this.privSynthesisTurn.onConnectionEstablishCompleted(r.statusCode),Promise.reject(`Unable to contact server. StatusCode: ${r.statusCode}, ${this.privSynthesizerConfig.parameters.getProperty(S.o.SpeechServiceConnection_Endpoint)} Reason: ${r.reason}`)):this.connectImpl(!0)}))),(e=>{throw this.privSynthesisTurn.onAuthCompleted(!0),new Error(e)})),this.privConnectionPromise.catch((()=>{})),this.privConnectionPromise}sendSpeechServiceConfig(e,t){if(t)return e.send(new k.r(s.C.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",t))}sendSsmlMessage(e,t,i){return e.send(new k.r(s.C.Text,"ssml",i,"application/ssml+xml",t))}fetchConnection(){return N(this,void 0,void 0,(function*(){return void 0!==this.privConnectionConfigurationPromise?this.privConnectionConfigurationPromise.then((e=>e.state()===a.e.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()):this.privConnectionConfigurationPromise),(()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()))):(this.privConnectionConfigurationPromise=this.configureConnection(),yield this.privConnectionConfigurationPromise)}))}configureConnection(){return N(this,void 0,void 0,(function*(){const e=yield this.connectImpl();return void 0!==this.configConnectionOverride?this.configConnectionOverride(e):(yield this.sendSpeechServiceConfig(e,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),e)}))}}x.telemetryDataEnabled=!0},61923:(e,t,i)=>{"use strict";i.d(t,{Bz:()=>a,Nx:()=>s,xZ:()=>o});var r=i(14300);class n extends r.A{constructor(e,t,i=r.t.Info){super(e,i),this.privRequestId=t}get requestId(){return this.privRequestId}}class s extends n{constructor(e,t,i){super("SynthesisTriggeredEvent",e),this.privSessionAudioDestinationId=t,this.privTurnAudioDestinationId=i}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}}class o extends n{constructor(e,t){super("ConnectingToSynthesisServiceEvent",e),this.privAuthFetchEventId=t}get authFetchEventId(){return this.privAuthFetchEventId}}class a extends n{constructor(e,t){super("SynthesisStartedEvent",e),this.privAuthFetchEventId=t}get authFetchEventId(){return this.privAuthFetchEventId}}},56893:(e,t,i)=>{"use strict";i.d(t,{q:()=>c});var r=i(15840),n=i(83565),s=i(65453),o=i(70092),a=i(84257);class c{constructor(e,t){let i=e.parameters.getProperty(s.o.SpeechServiceConnection_Endpoint,void 0);if(!i){const t=e.parameters.getProperty(s.o.SpeechServiceConnection_Region,"westus"),r=o._.getHostSuffix(t);i=e.parameters.getProperty(s.o.SpeechServiceConnection_Host,`https://${t}.tts.speech${r}`)}this.privUri=`${i}/cognitiveservices/voices/list`;const a=r.o.requestOptions;this.privRestAdapter=new n.c(a),this.privAuthentication=t}getVoicesList(e){return this.privRestAdapter.setHeaders(a.S.ConnectionId,e),this.privAuthentication.fetch(e).then((e=>(this.privRestAdapter.setHeaders(e.headerName,e.token),this.privRestAdapter.request(n.b.Get,this.privUri))))}}},61190:(e,t,i)=>{"use strict";i.d(t,{E:()=>s});var r,n=i(62029);!function(e){e[e.Standard=0]="Standard",e[e.Custom=1]="Custom"}(r||(r={}));class s{constructor(e,t){this.privSynthesisServiceType=r.Standard,this.privSpeechServiceConfig=e||new n.pu(new n._y(null)),this.privParameters=t}get parameters(){return this.privParameters}get synthesisServiceType(){return this.privSynthesisServiceType}set synthesisServiceType(e){this.privSynthesisServiceType=e}get SpeechServiceConfig(){return this.privSpeechServiceConfig}}},98430:(e,t,i)=>{"use strict";i.d(t,{l:()=>d});var r=i(99949),n=i(38717),s=i(65453),o=i(88530),a=i(70092),c=i(65610),p=i(62389),h=i(84257),u=i(89906);class d extends a._{constructor(){super(...arguments),this.multiaudioRelativeUri="/speech/recognition/multiaudio"}create(e,t,i){let o=e.parameters.getProperty(s.o.SpeechServiceConnection_Endpoint,void 0);const p=e.parameters.getProperty(s.o.SpeechServiceConnection_Region,"centralus"),u="wss://transcribe."+p+".cts.speech"+a._.getHostSuffix(p)+this.multiaudioRelativeUri,d=e.parameters.getProperty(s.o.SpeechServiceConnection_Host,u),l={};this.setQueryParams(l,e,o),o||(o=d);const v={};void 0!==t.token&&""!==t.token&&(v[t.headerName]=t.token),v[h.S.ConnectionId]=i,e.parameters.setProperty(s.o.SpeechServiceConnection_Url,o);const g="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new r.i(o,l,v,new c.D,n.i.fromRecognizerConfig(e),g,i)}setQueryParams(e,t,i){const r=t.parameters.getProperty(s.o.SpeechServiceConnection_EndpointId,void 0),n=t.parameters.getProperty(s.o.SpeechServiceConnection_RecoLanguage,void 0);r&&!(u.o.CustomSpeechDeploymentId in e)&&(e[u.o.CustomSpeechDeploymentId]=r),n&&!(u.o.Language in e)&&(e[u.o.Language]=n);const a="true"===t.parameters.getProperty(s.o.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase(),c=t.parameters.getProperty(p.OutputFormatPropertyName,o.W[o.W.Simple])!==o.W[o.W.Simple];(a||c)&&(e[u.o.Format]=o.W[o.W.Detailed].toLowerCase()),this.setCommonUrlParams(t,e,i)}}},33691:(e,t,i)=>{"use strict";i.d(t,{m:()=>n});var r=i(15840);class n extends r.o{static get host(){return n.privHost}static get apiVersion(){return n.privApiVersion}static get clientAppId(){return n.privClientAppId}static get defaultLanguageCode(){return n.privDefaultLanguageCode}static get restPath(){return n.privRestPath}static get webSocketPath(){return n.privWebSocketPath}static get transcriptionEventKeys(){return n.privTranscriptionEventKeys}}n.privHost="dev.microsofttranslator.com",n.privRestPath="/capito/room",n.privApiVersion="2.0",n.privDefaultLanguageCode="en-US",n.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15",n.privWebSocketPath="/capito/translate",n.privTranscriptionEventKeys=["iCalUid","callId","organizer","FLAC","MTUri","DifferentiateGuestSpeakers","audiorecording","Threadid","OrganizerMri","OrganizerTenantId","UserToken"]},80730:(e,t,i)=>{"use strict";i.d(t,{y:()=>u});var r=i(99949),n=i(38717),s=i(25487),o=i(89513),a=i(65453),c=i(70092),p=i(33691),h=i(29555);class u extends c._{create(e,t,i){const c=e.parameters.getProperty(a.o.ConversationTranslator_Host,p.m.host),u=e.parameters.getProperty(a.o.ConversationTranslator_CorrelationId,(0,s.c)()),d=`wss://${c}${p.m.webSocketPath}`,l=e.parameters.getProperty(a.o.ConversationTranslator_Token,void 0);o.a.throwIfNullOrUndefined(l,"token");const v={};v[p.m.configParams.apiVersion]=p.m.apiVersion,v[p.m.configParams.token]=l,v[p.m.configParams.correlationId]=u;const g="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new r.i(d,v,{},new h.q,n.i.fromRecognizerConfig(e),g,i)}}},83794:(e,t,i)=>{"use strict";i.d(t,{Q:()=>n});var r=i(66645);class n extends r.H{constructor(e,t,i,r){super(e,t,i,r);const n=JSON.parse(this.textBody);void 0!==n.type&&(this.privConversationMessageType=n.type)}get conversationMessageType(){return this.privConversationMessageType}}},77339:(e,t,i)=>{"use strict";i.d(t,{N:()=>a});var r=i(83565),n=i(89513),s=i(65453),o=i(33691);class a{constructor(){this.privRequestParams=o.m.configParams,this.privErrors=o.m.restErrors,this.privHost=o.m.host,this.privApiVersion=o.m.apiVersion,this.privRestPath=o.m.restPath,this.privRestAdapter=new r.c({})}createOrJoin(e,t,i,a){try{n.a.throwIfNullOrUndefined(e,"args");const c=e.getProperty(s.o.SpeechServiceConnection_RecoLanguage,o.m.defaultLanguageCode),p=e.getProperty(s.o.ConversationTranslator_Name,"conversation_host"),h=e.getProperty(s.o.ConversationTranslator_Host,this.privHost),u=e.getProperty(s.o.ConversationTranslator_CorrelationId),d=e.getProperty(s.o.SpeechServiceConnection_Key),l=e.getProperty(s.o.SpeechServiceConnection_Region),v=e.getProperty(s.o.SpeechServiceAuthorization_Token);n.a.throwIfNullOrWhitespace(c,"languageCode"),n.a.throwIfNullOrWhitespace(p,"nickname"),n.a.throwIfNullOrWhitespace(h,"endpointHost");const g={};g[this.privRequestParams.apiVersion]=this.privApiVersion,g[this.privRequestParams.languageCode]=c,g[this.privRequestParams.nickname]=p;const m={};u&&(m[this.privRequestParams.correlationId]=u),m[this.privRequestParams.clientAppId]=o.m.clientAppId,void 0!==t?g[this.privRequestParams.roomId]=t:(n.a.throwIfNullOrUndefined(l,this.privErrors.authInvalidSubscriptionRegion),m[this.privRequestParams.subscriptionRegion]=l,d?m[this.privRequestParams.subscriptionKey]=d:v?m[this.privRequestParams.authorization]=`Bearer ${v}`:n.a.throwIfNullOrUndefined(d,this.privErrors.authInvalidSubscriptionKey));const f={};f.headers=m,this.privRestAdapter.options=f;const S=`https://${h}${this.privRestPath}`;this.privRestAdapter.request(r.b.Post,S,g,null).then((e=>{const t=r.c.extractHeaderValue(this.privRequestParams.requestId,e.headers);if(!e.ok){if(a){let i,r=this.privErrors.invalidCreateJoinConversationResponse.replace("{status}",e.status.toString());try{i=JSON.parse(e.data),r+=` [${i.error.code}: ${i.error.message}]`}catch(t){r+=` [${e.data}]`}t&&(r+=` ${t}`),a(r)}return}const n=JSON.parse(e.data);if(n&&(n.requestId=t),i){try{i(n)}catch(e){a&&a(e)}i=void 0}})).catch((()=>{}))}catch(e){if(a)if(e instanceof Error){const t=e;a(t.name+": "+t.message)}else a(e)}}leave(e,t){return new Promise(((i,o)=>{try{n.a.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","config")),n.a.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","token"));const o=e.getProperty(s.o.ConversationTranslator_Host,this.privHost),a=e.getProperty(s.o.ConversationTranslator_CorrelationId),c={};c[this.privRequestParams.apiVersion]=this.privApiVersion,c[this.privRequestParams.sessionToken]=t;const p={};a&&(p[this.privRequestParams.correlationId]=a);const h={};h.headers=p,this.privRestAdapter.options=h;const u=`https://${o}${this.privRestPath}`;this.privRestAdapter.request(r.b.Delete,u,c,null).then((e=>{e.ok,i()})).catch((()=>{}))}catch(e){if(e instanceof Error){const t=e;o(t.name+": "+t.message)}else o(e)}}))}}},840:(e,t,i)=>{"use strict";i.d(t,{u:()=>s});var r=i(25487),n=i(33182);class s{constructor(e){this.privIsDisposed=!1,this.privDetachables=new Array,this.privSessionId=e,this.privRequestId=(0,r.Q)(),this.privRequestCompletionDeferral=new n.BH}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get completionPromise(){return this.privRequestCompletionDeferral.promise}onPreConnectionStart(e,t){this.privSessionId=t}onAuthCompleted(e){e&&this.onComplete()}onConnectionEstablishCompleted(e){200!==e&&403===e&&this.onComplete()}onServiceTurnEndResponse(e){e?this.privRequestId=(0,r.Q)():this.onComplete()}dispose(){return e=this,t=void 0,r=function*(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const e of this.privDetachables)yield e.detach()}},new((i=void 0)||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}));var e,t,i,r}onComplete(){}}},701:(e,t,i)=>{"use strict";i.d(t,{f:()=>I});var r=i(25487),n=i(66645),s=i(33182),o=i(43842),a=i(6550),c=i(98563),p=i(17469),h=i(454),u=i(91048),d=i(56523),l=i(40649),v=i(47916),g=i(54825),m=i(83794),f=i(840),S=i(51107),y=i(84883),C=i(82535),w=i(44162),R=i(93628),P=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class I extends v.q{constructor(e,t,i,n,s){super(e,t,i,n,s),this.privConnectionConfigPromise=void 0,this.privLastPartialUtteranceId="",this.privConversationServiceConnector=s,this.privConversationAuthentication=e,this.receiveMessageOverride=()=>this.receiveConversationMessageOverride(),this.recognizeOverride=()=>this.noOp(),this.postConnectImplOverride=e=>this.conversationConnectImpl(e),this.configConnectionOverride=()=>this.configConnection(),this.disconnectOverride=()=>this.privDisconnect(),this.privConversationRequestSession=new f.u((0,r.Q)()),this.privConversationConnectionFactory=t,this.privConversationIsDisposed=!1}isDisposed(){return super.isDisposed()||this.privConversationIsDisposed}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return P(this,void 0,void 0,(function*(){if(this.privConversationIsDisposed=!0,void 0!==this.privConnectionConfigPromise){const t=yield this.privConnectionConfigPromise;yield t.dispose(e)}yield t.dispose.call(this,e)}))}sendMessage(e){return P(this,void 0,void 0,(function*(){return(yield this.fetchConnection()).send(new m.Q(n.C.Text,e))}))}sendMessageAsync(e){return P(this,void 0,void 0,(function*(){const t=yield this.fetchConnection();yield t.send(new m.Q(n.C.Text,e))}))}privDisconnect(){if(!this.terminateMessageLoop)return this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,a._.Error,c.E.NoError,"Disconnecting"),this.terminateMessageLoop=!0,Promise.resolve()}processTypeSpecificMessages(){return P(this,void 0,void 0,(function*(){return!0}))}cancelRecognition(e,t,i,r,n){this.terminateMessageLoop=!0;const s=new p.O(i,n,r,void 0,e);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,s)}catch(e){}}conversationConnectImpl(e){return P(this,void 0,void 0,(function*(){return this.privConnectionLoop=this.startMessageLoop(),e}))}receiveConversationMessageOverride(){return P(this,void 0,void 0,(function*(){if(this.isDisposed()||this.terminateMessageLoop)return Promise.resolve();const e=new s.BH;try{const t=yield this.fetchConnection(),i=yield t.read();if(this.isDisposed()||this.terminateMessageLoop)return e.resolve(),Promise.resolve();if(!i)return this.receiveConversationMessageOverride();const r=this.privConversationRequestSession.sessionId,n=i.conversationMessageType.toLowerCase();let s=!1;try{switch(n){case"info":case"participant_command":case"command":const e=C.h.fromJSON(i.textBody);switch(e.command.toLowerCase()){case"participantlist":const t=w.T.fromJSON(i.textBody),n=t.participants.map((e=>({avatar:e.avatar,displayName:e.nickname,id:e.participantId,isHost:e.ishost,isMuted:e.ismuted,isUsingTts:e.usetts,preferredLanguage:e.locale})));this.privConversationServiceConnector.participantsListReceived&&this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector,new S.G3(t.roomid,t.token,t.translateTo,t.profanityFilter,t.roomProfanityFilter,t.roomLocked,t.muteAll,n,r));break;case"settranslatetolanguages":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new S.mL(e.participantId,y.L7.setTranslateToLanguages,e.value,r));break;case"setprofanityfiltering":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new S.mL(e.participantId,y.L7.setProfanityFiltering,e.value,r));break;case"setmute":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new S.mL(e.participantId,y.L7.setMute,e.value,r));break;case"setmuteall":this.privConversationServiceConnector.muteAllCommandReceived&&this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector,new S.NF(e.value,r));break;case"roomexpirationwarning":this.privConversationServiceConnector.conversationExpiration&&this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector,new h.i(e.value,this.privConversationRequestSession.sessionId));break;case"setusetts":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new S.mL(e.participantId,y.L7.setUseTTS,e.value,r));break;case"setlockstate":this.privConversationServiceConnector.lockRoomCommandReceived&&this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector,new S.Sc(e.value,r));break;case"changenickname":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new S.mL(e.participantId,y.L7.changeNickname,e.nickname,r));break;case"joinsession":const s=w.E.fromJSON(i.textBody),o={avatar:s.avatar,displayName:s.nickname,id:s.participantId,isHost:s.ishost,isMuted:s.ismuted,isUsingTts:s.usetts,preferredLanguage:s.locale};this.privConversationServiceConnector.participantJoinCommandReceived&&this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector,new S.ZG(o,r));break;case"leavesession":const a={id:e.participantId};this.privConversationServiceConnector.participantLeaveCommandReceived&&this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector,new S.ZG(a,r));break;case"disconnectsession":e.participantId;break;case"token":const c=new g.w((()=>{const t=e.token;return Promise.resolve(t)}),(()=>{const t=e.token;return Promise.resolve(t)}));this.authentication=c}break;case"partial":case"final":const t=R._.fromJSON(i.textBody),o="final"===n?u.s.TranslatedParticipantSpeech:u.s.TranslatingParticipantSpeech,a=new d.M(t.participantId,this.getTranslations(t.translations),t.language,t.id,o,t.recognition,void 0,void 0,i.textBody,void 0);t.isFinal?((void 0!==a.text&&a.text.length>0||t.id===this.privLastPartialUtteranceId)&&(s=!0),s&&this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new S.g5(y.li.final,a,r))):void 0!==a.text&&(this.privLastPartialUtteranceId=t.id,this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new S.g5(y.li.partial,a,r)));break;case"translated_message":const c=R.B.fromJSON(i.textBody),p=new d.M(c.participantId,this.getTranslations(c.translations),c.language,void 0,void 0,c.originalText,void 0,void 0,void 0,i.textBody,void 0);this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new S.g5(y.li.instantMessage,p,r))}}catch(e){}return this.receiveConversationMessageOverride()}catch(e){this.terminateMessageLoop=!0}return e.promise}))}startMessageLoop(){return P(this,void 0,void 0,(function*(){if(this.isDisposed())return Promise.resolve();this.terminateMessageLoop=!1;const e=this.receiveConversationMessageOverride();try{return yield e}catch(e){return this.cancelRecognition(this.privRequestSession?this.privRequestSession.sessionId:"",this.privRequestSession?this.privRequestSession.requestId:"",a._.Error,c.E.RuntimeError,e),null}}))}configConnection(){return this.isDisposed()?Promise.resolve(void 0):void 0!==this.privConnectionConfigPromise?this.privConnectionConfigPromise.then((e=>e.state()===o.e.Disconnected?(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()):this.privConnectionConfigPromise),(()=>(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()))):this.terminateMessageLoop?Promise.resolve(void 0):(this.privConnectionConfigPromise=this.connectImpl().then((e=>e)),this.privConnectionConfigPromise)}getTranslations(e){let t;if(void 0!==e){t=new l.Z;for(const i of e)t.set(i.lang,i.translation)}return t}}},85204:(e,t,i)=>{"use strict";i.d(t,{R:()=>g});var r=i(15840),n=i(99949),s=i(38717),o=i(70263),a=i(89513),c=i(65453),p=i(84257),h=i(89906),u=i(70092),d=i(98430),l=i(56477),v=i(65610);class g extends u._{constructor(e){super(),a.a.throwIfNullOrUndefined(e,"convGetter"),this.privConvGetter=e}create(e,t,i){const a="TRUE"===e.parameters.getProperty("ConversationTranslator_MultiChannelAudio","").toUpperCase(),m=this.privConvGetter().room,f=m.cognitiveSpeechRegion||e.parameters.getProperty(c.o.SpeechServiceConnection_Region,""),S={hostSuffix:u._.getHostSuffix(f),path:g.CTS_VIRT_MIC_PATH,region:encodeURIComponent(f)};S[h.o.Language]=encodeURIComponent(e.parameters.getProperty(c.o.SpeechServiceConnection_RecoLanguage,"")),S[h.o.CtsMeetingId]=encodeURIComponent(m.roomId),S[h.o.CtsDeviceId]=encodeURIComponent(m.participantId),S[h.o.CtsIsParticipant]=m.isHost?"":"&"+h.o.CtsIsParticipant;let y="";const C={},w={};if(a){y=e.parameters.getProperty(c.o.SpeechServiceConnection_Endpoint),y||(y="wss://"+e.parameters.getProperty(c.o.SpeechServiceConnection_Host,"transcribe.{region}.cts.speech{hostSuffix}")+"{path}"),y=o.x.formatString(y,S);const t=new URL(y);t.searchParams.forEach(((e,t)=>{C[t]=e})),(new d.l).setQueryParams(C,e,y),C[h.o.CtsMeetingId]=S[h.o.CtsMeetingId],C[h.o.CtsDeviceId]=S[h.o.CtsDeviceId],m.isHost||(C[h.o.CtsIsParticipant]=""),h.o.Format in C||(C[h.o.Format]="simple"),t.searchParams.forEach(((e,i)=>{t.searchParams.set(i,C[i]),delete C[i]})),y=t.toString()}else{const t=new l.x;y=t.getEndpointUrl(e,!0),y=o.x.formatString(y,S),t.setQueryParams(C,e,y)}w[p.S.ConnectionId]=i,w[r.o.configParams.token]=m.token,t.token&&(w[t.headerName]=t.token);const R="TRUE"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","").toUpperCase();return new n.i(y,C,w,new v.D,s.i.fromRecognizerConfig(e),R,i)}}g.CTS_VIRT_MIC_PATH="/speech/recognition/dynamicaudio"},51107:(e,t,i)=>{"use strict";i.d(t,{G3:()=>c,NF:()=>n,Sc:()=>s,ZG:()=>o,g5:()=>p,mL:()=>a});var r=i(7841);class n extends r.${constructor(e,t){super(t),this.privIsMuted=e}get isMuted(){return this.privIsMuted}}class s extends r.${constructor(e,t){super(t),this.privIsLocked=e}get isMuted(){return this.privIsLocked}}class o extends r.${constructor(e,t){super(t),this.privParticipant=e}get participant(){return this.privParticipant}}class a extends r.${constructor(e,t,i,r){super(r),this.privKey=t,this.privValue=i,this.privParticipantId=e}get value(){return this.privValue}get key(){return this.privKey}get id(){return this.privParticipantId}}class c extends r.${constructor(e,t,i,r,n,s,o,a,c){super(c),this.privRoomId=e,this.privSessionToken=t,this.privTranslateTo=i,this.privProfanityFilter=r,this.privRoomProfanityFilter=n,this.privIsRoomLocked=s,this.privIsRoomLocked=o,this.privParticipants=a}get sessionToken(){return this.privSessionToken}get conversationId(){return this.privRoomId}get translateTo(){return this.privTranslateTo}get profanityFilter(){return this.privProfanityFilter}get roomProfanityFilter(){return this.privRoomProfanityFilter}get isRoomLocked(){return this.privIsRoomLocked}get isMuteAll(){return this.privIsMuteAll}get participants(){return this.privParticipants}}class p{constructor(e,t,i){this.privPayload=t,this.privCommand=e,this.privSessionId=i}get payload(){return this.privPayload}get command(){return this.privCommand}get sessionId(){return this.privSessionId}}},84883:(e,t,i)=>{"use strict";i.d(t,{L7:()=>s,h$:()=>r,li:()=>n});class r{constructor(e=[],t){this.participants=e,this.meId=t}addOrUpdateParticipant(e){if(void 0===e)return;const t=this.getParticipantIndex(e.id);return t>-1?this.participants.splice(t,1,e):this.participants.push(e),this.getParticipant(e.id)}getParticipantIndex(e){return this.participants.findIndex((t=>t.id===e))}getParticipant(e){return this.participants.find((t=>t.id===e))}deleteParticipant(e){this.participants=this.participants.filter((t=>t.id!==e))}get host(){return this.participants.find((e=>!0===e.isHost))}get me(){return this.getParticipant(this.meId)}}const n={command:"command",final:"final",info:"info",instantMessage:"instant_message",keepAlive:"keep_alive",partial:"partial",participantCommand:"participant_command",translatedMessage:"translated_message"},s={changeNickname:"ChangeNickname",disconnectSession:"DisconnectSession",ejectParticipant:"EjectParticipant",instant_message:"instant_message",joinSession:"JoinSession",leaveSession:"LeaveSession",participantList:"ParticipantList",roomExpirationWarning:"RoomExpirationWarning",setLockState:"SetLockState",setMute:"SetMute",setMuteAll:"SetMuteAll",setProfanityFiltering:"SetProfanityFiltering",setTranslateToLanguages:"SetTranslateToLanguages",setUseTTS:"SetUseTTS"}},82383:(e,t,i)=>{"use strict";i.d(t,{a:()=>l});var r=i(62029),n=i(42309),s=i(3625),o=i(59187),a=i(89513),c=i(44571),p=i(53333),h=i(80730),u=i(701),d=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class l{static fromConfig(e,t,i){return new v(e,t,i)}}class v extends c.c{constructor(e,t,i){const r=t;a.a.throwIfNull(r,"speechConfig");const s=e;a.a.throwIfNull(s,"conversationImpl"),super(i,r.properties,new h.y),this.privConversation=s,this.privIsDisposed=!1,this.privProperties=r.properties.clone(),this.privConnection=p.e.fromRecognizer(this),this.privSetTimeout="undefined"!=typeof Blob&&"undefined"!=typeof Worker?n.V.setTimeout:setTimeout,this.privClearTimeout="undefined"!=typeof Blob&&"undefined"!=typeof Worker?n.V.clearTimeout:clearTimeout}set connected(e){this.privConnection.connected=e}set disconnected(e){this.privConnection.disconnected=e}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get properties(){return this.privProperties}isDisposed(){return this.privIsDisposed}connect(e,t,i){try{a.a.throwIfDisposed(this.privIsDisposed),a.a.throwIfNullOrWhitespace(e,"token"),this.privReco.conversationTranslatorToken=e,this.resetConversationTimeout(),this.privReco.connectAsync(t,i)}catch(e){if(i)if(e instanceof Error){const t=e;i(t.name+": "+t.message)}else i(e)}}disconnect(e,t){try{a.a.throwIfDisposed(this.privIsDisposed),void 0!==this.privTimeoutToken&&this.privClearTimeout(this.privTimeoutToken),this.privReco.disconnect().then((()=>{e&&e()}),(e=>{t&&t(e)}))}catch(e){if(t)if(e instanceof Error){const i=e;t(i.name+": "+i.message)}else t(e);this.dispose(!0).catch((e=>{s.z.instance.onEvent(new o.u(e))}))}}sendRequest(e,t,i){try{a.a.throwIfDisposed(this.privIsDisposed),this.sendMessage(e,t,i)}catch(e){if(i)if(e instanceof Error){const t=e;i(t.name+": "+t.message)}else i(e);this.dispose(!0).catch((e=>{s.z.instance.onEvent(new o.u(e))}))}}close(){return d(this,void 0,void 0,(function*(){this.privIsDisposed||(this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close()),this.privConnection=void 0,yield this.dispose(!0))}))}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return d(this,void 0,void 0,(function*(){this.privIsDisposed||e&&(void 0!==this.privTimeoutToken&&this.privClearTimeout(this.privTimeoutToken),this.privIsDisposed=!0,this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close(),this.privConnection=void 0),yield t.dispose.call(this,e))}))}createRecognizerConfig(e){return new r.Xj(e,this.privProperties)}createServiceRecognizer(e,t,i,r){const n=i;return new u.f(e,t,n,r,this)}sendMessage(e,t,i){((e,t,i)=>{void 0!==e?e.then((()=>{try{t&&t()}catch(e){i&&i(`'Unhandled error on promise callback: ${e}'`)}}),(e=>{try{i&&i(e)}catch(e){}})):i&&i("Null promise")})(this.privReco.sendMessageAsync(e),t,i),this.resetConversationTimeout()}resetConversationTimeout(){void 0!==this.privTimeoutToken&&this.privClearTimeout(this.privTimeoutToken),this.privTimeoutToken=this.privSetTimeout((()=>{this.sendRequest(this.privConversation.getKeepAlive())}),6e4)}}},29555:(e,t,i)=>{"use strict";i.d(t,{q:()=>a});var r=i(33182),n=i(66645),s=i(36259),o=i(83794);class a{toConnectionMessage(e){const t=new r.BH;try{if(e.messageType===n.C.Text){const i=new o.Q(e.messageType,e.textContent,{},e.id);t.resolve(i)}else e.messageType===n.C.Binary&&t.resolve(new o.Q(e.messageType,e.binaryContent,void 0,e.id))}catch(e){t.reject(`Error formatting the message. Error: ${e}`)}return t.promise}fromConnectionMessage(e){const t=new r.BH;try{if(e.messageType===n.C.Text){const i=`${e.textBody?e.textBody:""}`;t.resolve(new s.S(n.C.Text,i,e.id))}}catch(e){t.reject(`Error formatting the message. ${e}`)}return t.promise}}},82535:(e,t,i)=>{"use strict";i.d(t,{h:()=>r});class r{constructor(e){this.privCommandResponse=(e=>JSON.parse(e))(e)}get type(){return this.privCommandResponse.type}get command(){return this.privCommandResponse.command}get id(){return this.privCommandResponse.id}get nickname(){return this.privCommandResponse.nickname}get participantId(){return this.privCommandResponse.participantId}get roomid(){return this.privCommandResponse.roomid}get value(){return this.privCommandResponse.value}get token(){return this.privCommandResponse.token}static fromJSON(e){return new r(e)}}},44162:(e,t,i)=>{"use strict";i.d(t,{E:()=>n,T:()=>r});class r{constructor(e){this.privParticipantsPayloadResponse=(e=>JSON.parse(e))(e)}get roomid(){return this.privParticipantsPayloadResponse.roomid}get id(){return this.privParticipantsPayloadResponse.id}get command(){return this.privParticipantsPayloadResponse.command}get participants(){return this.privParticipantsPayloadResponse.participants}get token(){return this.privParticipantsPayloadResponse.token}get translateTo(){return this.privParticipantsPayloadResponse.translateTo}get profanityFilter(){return this.privParticipantsPayloadResponse.profanityFilter}get roomProfanityFilter(){return this.privParticipantsPayloadResponse.roomProfanityFilter}get roomLocked(){return this.privParticipantsPayloadResponse.roomLocked}get muteAll(){return this.privParticipantsPayloadResponse.muteAll}get type(){return this.privParticipantsPayloadResponse.type}static fromJSON(e){return new r(e)}}class n{constructor(e){this.privParticipantPayloadResponse=(e=>JSON.parse(e))(e)}get nickname(){return this.privParticipantPayloadResponse.nickname}get locale(){return this.privParticipantPayloadResponse.locale}get usetts(){return this.privParticipantPayloadResponse.usetts}get ismuted(){return this.privParticipantPayloadResponse.ismuted}get ishost(){return this.privParticipantPayloadResponse.ishost}get participantId(){return this.privParticipantPayloadResponse.participantId}get avatar(){return this.privParticipantPayloadResponse.avatar}static fromJSON(e){return new n(e)}}},93628:(e,t,i)=>{"use strict";i.d(t,{B:()=>n,_:()=>r});class r{constructor(e){this.privSpeechResponse=(e=>JSON.parse(e))(e)}get recognition(){return this.privSpeechResponse.recognition}get translations(){return this.privSpeechResponse.translations}get id(){return this.privSpeechResponse.id}get language(){return this.privSpeechResponse.language}get nickname(){return this.privSpeechResponse.nickname}get participantId(){return this.privSpeechResponse.participantId}get roomid(){return this.privSpeechResponse.roomid}get timestamp(){return this.privSpeechResponse.timestamp}get type(){return this.privSpeechResponse.type}get isFinal(){return"final"===this.privSpeechResponse.type}static fromJSON(e){return new r(e)}}class n{constructor(e){this.privTextResponse=(e=>JSON.parse(e))(e)}get originalText(){return this.privTextResponse.originalText}get translations(){return this.privTextResponse.translations}get id(){return this.privTextResponse.id}get language(){return this.privTextResponse.language}get nickname(){return this.privTextResponse.nickname}get participantId(){return this.privTextResponse.participantId}get roomid(){return this.privTextResponse.roomid}get timestamp(){return this.privTextResponse.timestamp}get type(){return this.privTextResponse.type}static fromJSON(e){return new n(e)}}},81909:(e,t,i)=>{"use strict";i.d(t,{S:()=>u});var r=i(33182),n=i(89513),s=i(44571),o=i(65453),a=i(98430),c=i(62029),p=i(47070),h=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class u extends s.c{constructor(e,t){const i=e;n.a.throwIfNull(i,"speechTranslationConfig");const r=t;n.a.throwIfNull(r,"audioConfigImpl"),n.a.throwIfNullOrWhitespace(i.speechRecognitionLanguage,o.o[o.o.SpeechServiceConnection_RecoLanguage]),super(t,i.properties,new a.l),this.privDisposedRecognizer=!1}get speechRecognitionLanguage(){return n.a.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(o.o.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(o.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){n.a.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(o.o.SpeechServiceAuthorization_Token,e)}set conversation(e){n.a.throwIfNullOrUndefined(e,"Conversation"),this.privConversation=e}getConversationInfo(){return n.a.throwIfNullOrUndefined(this.privConversation,"Conversation"),this.privConversation.conversationInfo}startContinuousRecognitionAsync(e,t){(0,r.Kb)(this.startContinuousRecognitionAsyncImpl(c.jf.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){(0,r.Kb)(this.stopContinuousRecognitionAsyncImpl(),e,t)}close(){return h(this,void 0,void 0,(function*(){this.privDisposedRecognizer||(yield this.dispose(!0))}))}pushConversationEvent(e,t){return h(this,void 0,void 0,(function*(){const i=this.privReco;n.a.throwIfNullOrUndefined(i,"serviceRecognizer"),yield i.sendSpeechEventAsync(e,t)}))}enforceAudioGating(){return h(this,void 0,void 0,(function*(){const e=this.audioConfig,t=(yield e.format).channels;if(1===t){if("true"!==this.properties.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase())throw new Error("Single channel audio configuration for ConversationTranscriber is currently under private preview, please contact diarizationrequest@microsoft.com for more details")}else if(8!==t)throw new Error(`Unsupported audio configuration: Detected ${t}-channel audio`)}))}connectCallbacks(e){this.canceled=(t,i)=>{e.canceled&&e.canceled(e,i)},this.recognizing=(t,i)=>{e.transcribing&&e.transcribing(e,i)},this.recognized=(t,i)=>{e.transcribed&&e.transcribed(e,i)},this.sessionStarted=(t,i)=>{e.sessionStarted&&e.sessionStarted(e,i)},this.sessionStopped=(t,i)=>{e.sessionStopped&&e.sessionStopped(e,i)}}disconnectCallbacks(){this.canceled=void 0,this.recognizing=void 0,this.recognized=void 0,this.sessionStarted=void 0,this.sessionStopped=void 0}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return h(this,void 0,void 0,(function*(){this.privDisposedRecognizer||(e&&(this.privDisposedRecognizer=!0,yield this.implRecognizerStop()),yield t.dispose.call(this,e))}))}createRecognizerConfig(e){return new c.Xj(e,this.properties)}createServiceRecognizer(e,t,i,r){const n=i;return new p.X(e,t,n,r,this)}}},47070:(e,t,i)=>{"use strict";i.d(t,{X:()=>g});var r=i(66645),n=i(65453),s=i(53383),o=i(22874),a=i(98563),c=i(66362),p=i(98670),h=i(91048),u=i(96978),d=i(62389),l=i(53504),v=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class g extends u.S{constructor(e,t,i,r,s){super(e,t,i,r,s),this.privTranscriberRecognizer=s,this.sendPrePayloadJSONOverride=e=>this.sendTranscriptionStartJSON(e),"true"===this.privRecognizerConfig.parameters.getProperty(n.o.SpeechServiceResponse_RequestWordLevelTimestamps)&&this.privSpeechContext.setWordLevelTimings()}sendSpeechEventAsync(e,t){return v(this,void 0,void 0,(function*(){if(this.privRequestSession.isRecognizing){const i=yield this.fetchConnection();yield this.sendSpeechEvent(i,this.createSpeechEventPayload(e,t))}}))}processTypeSpecificMessages(e){return this.processSpeechMessages(e)}handleRecognizedCallback(e,t,i){try{const r=new s.m(e,t,i);if(this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer,r),this.privSuccessCallback){try{this.privSuccessCallback(e)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}catch(e){}}handleRecognizingCallback(e,t,i){try{const r=new s.m(e,t,i);this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer,r)}catch(e){}}cancelRecognition(e,t,i,r,n){const s=new o.O;if(s.setProperty(d.CancellationErrorCodePropertyName,a.E[r]),this.privTranscriberRecognizer.canceled){const t=new c.n(i,n,r,void 0,e);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,t)}catch(e){}}if(this.privSuccessCallback){const e=new p.b(t,h.s.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,n,void 0,s);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(e){}}}sendTranscriptionStartJSON(e){return v(this,void 0,void 0,(function*(){yield this.sendSpeechContext(e,!0);const t=this.privTranscriberRecognizer.getConversationInfo(),i=this.createSpeechEventPayload(t,"start");yield this.sendSpeechEvent(e,i),yield this.sendWaveHeader(e)}))}sendSpeechEvent(e,t){const i=JSON.stringify(t);if(i)return e.send(new l.r(r.C.Text,"speech.event",this.privRequestSession.requestId,"application/json",i))}createSpeechEventPayload(e,t){const i={id:"meeting",name:t,meeting:e.conversationProperties};return i.meeting.id=e.id,i.meeting.attendees=e.participants,i.meeting.record="on"===e.conversationProperties.audiorecording?"true":"false",i}}},56477:(e,t,i)=>{"use strict";i.d(t,{x:()=>u});var r=i(99949),n=i(38717),s=i(70263),o=i(65453),a=i(70092),c=i(65610),p=i(84257),h=i(89906);class u extends a._{create(e,t,i){const s=this.getEndpointUrl(e),a={};void 0!==e.autoDetectSourceLanguages&&(a[h.o.EnableLanguageId]="true"),this.setQueryParams(a,e,s);const u={};void 0!==t.token&&""!==t.token&&(u[t.headerName]=t.token),u[p.S.ConnectionId]=i,e.parameters.setProperty(o.o.SpeechServiceConnection_Url,s);const d="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new r.i(s,a,u,new c.D,n.i.fromRecognizerConfig(e),d,i)}getEndpointUrl(e,t){const i=e.parameters.getProperty(o.o.SpeechServiceConnection_Region),r=a._.getHostSuffix(i);let n=e.parameters.getProperty(o.o.SpeechServiceConnection_Endpoint,void 0);return n||(n=void 0!==e.autoDetectSourceLanguages?e.parameters.getProperty(o.o.SpeechServiceConnection_Host,"wss://{region}.stt.speech"+r)+"/speech/universal/v2":e.parameters.getProperty(o.o.SpeechServiceConnection_Host,"wss://{region}.s2s.speech"+r)+"/speech/translation/cognitiveservices/v1"),!0===t?n:s.x.formatString(n,{region:i})}setQueryParams(e,t,i){e.from=t.parameters.getProperty(o.o.SpeechServiceConnection_RecoLanguage),e.to=t.parameters.getProperty(o.o.SpeechServiceConnection_TranslationToLanguages),this.setCommonUrlParams(t,e,i),this.setUrlParameter(o.o.SpeechServiceResponse_TranslationRequestStablePartialResult,h.o.StableTranslation,t,e,i);const r=t.parameters.getProperty(o.o.SpeechServiceConnection_TranslationVoice,void 0);void 0!==r&&(e.voice=r,e.features="texttospeech")}}},33326:(e,t,i)=>{"use strict";i.d(t,{h:()=>I});var r=i(66645),n=i(53133),s=i(22874),o=i(43465),a=i(91048),c=i(93062),p=i(65453),h=i(35890),u=i(65250),d=i(67762),l=i(6550),v=i(98563),g=i(40649),m=i(96978),f=i(47297),S=i(51054),y=i(41346),C=i(75163),w=i(18436),R=i(62389),P=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class I extends m.S{constructor(e,t,i,r,n){super(e,t,i,r,n),this.privTranslationRecognizer=n,this.connectionEvents.attach((e=>{"ConnectionEstablishedEvent"===e.name?this.privTranslationRecognizer.onConnection():"ConnectionClosedEvent"===e.name&&this.privTranslationRecognizer.onDisconnection()}))}processTypeSpecificMessages(e){return P(this,void 0,void 0,(function*(){const t=new s.O;let i=yield this.processSpeechMessages(e);if(i)return!0;const n=r=>P(this,void 0,void 0,(function*(){if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+r.Offset+r.Duration),r.RecognitionStatus===f.T.Success){const e=this.fireEventForResult(r,t);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,e)}catch(e){}if(this.privSuccessCallback){try{this.privSuccessCallback(e.result)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}else{const n=S.o.implTranslateRecognitionResult(r.RecognitionStatus),s=new o.r(void 0,this.privRequestSession.requestId,n,r.Text,r.Duration,this.privRequestSession.currentTurnAudioOffset+r.Offset,r.Language,r.Confidence,void 0,e.textBody,t);if(n===a.s.Canceled){const e=S.o.implTranslateCancelResult(r.RecognitionStatus),t=S.o.implTranslateCancelErrorCode(r.RecognitionStatus);yield this.cancelRecognitionLocal(e,t,S.o.implTranslateErrorDetails(t))}else{if(!this.privRequestSession.isSpeechEnded||n!==a.s.NoMatch||r.RecognitionStatus===f.T.InitialSilenceTimeout){const e=new c.s(s,s.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,e)}catch(e){}}if(this.privSuccessCallback){try{this.privSuccessCallback(s)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}i=!0}}));switch(e.messageType===r.C.Text&&t.setProperty(p.o.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"translation.hypothesis":const r=this.fireEventForResult(y.v.fromJSON(e.textBody),t);if(this.privRequestSession.onHypothesis(this.privRequestSession.currentTurnAudioOffset+r.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,r)}catch(e){}i=!0;break;case"translation.response":const s=JSON.parse(e.textBody);s.SpeechPhrase&&(yield n(C.Y.fromTranslationResponse(s)));break;case"translation.phrase":yield n(C.Y.fromJSON(e.textBody));break;case"translation.synthesis":this.sendSynthesisAudio(e.binaryBody,this.privRequestSession.sessionId),i=!0;break;case"audio.end":case"translation.synthesis.end":const o=w.Z.fromJSON(e.textBody);switch(o.SynthesisStatus){case f.g.Error:if(this.privTranslationRecognizer.synthesizing){const e=new h.S(a.s.Canceled,void 0),t=new u.v(e,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,t)}catch(e){}}if(this.privTranslationRecognizer.canceled){const e=new d.j(this.privRequestSession.sessionId,l._.Error,o.FailureReason,v.E.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,e)}catch(e){}}break;case f.g.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId)}i=!0}return i}))}cancelRecognition(e,t,i,r,n){const c=new s.O;if(c.setProperty(R.CancellationErrorCodePropertyName,v.E[r]),this.privTranslationRecognizer.canceled){const t=new d.j(e,i,n,r,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,t)}catch(e){}}if(this.privSuccessCallback){const e=new o.r(void 0,t,a.s.Canceled,void 0,void 0,void 0,void 0,void 0,n,void 0,c);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(e){}}}handleRecognizingCallback(e,t,i){try{const r=new c.s(o.r.fromSpeechRecognitionResult(e),t,i);this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,r)}catch(e){}}handleRecognizedCallback(e,t,i){try{const r=new c.s(o.r.fromSpeechRecognitionResult(e),t,i);this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,r)}catch(e){}}fireEventForResult(e,t){let i,r,s,p;if(void 0!==e.Translation.Translations){i=new g.Z;for(const t of e.Translation.Translations)i.set(t.Language,t.Text||t.DisplayText)}e instanceof C.Y?(r=e.Translation&&e.Translation.TranslationStatus===n.Y.Success?a.s.TranslatedSpeech:a.s.RecognizedSpeech,s=e.Language,p=e.Confidence):r=a.s.TranslatingSpeech;const h=e.Offset+this.privRequestSession.currentTurnAudioOffset,u=new o.r(i,this.privRequestSession.requestId,r,e.Text,e.Duration,h,s,p,e.Translation.FailureReason,JSON.stringify(e),t);return new c.s(u,h,this.privRequestSession.sessionId)}sendSynthesisAudio(e,t){const i=void 0===e?a.s.SynthesizingAudioCompleted:a.s.SynthesizingAudio,r=new h.S(i,e),n=new u.v(r,t);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,n)}catch(e){}}}},53133:(e,t,i)=>{"use strict";var r;i.d(t,{Y:()=>r}),function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"}(r||(r={}))},84983:(e,t,i)=>{"use strict";i.d(t,{E:()=>w});var r=i(78673),n=i(22525),s=i(66645),o=i(33182),a=i(22874),c=i(65453),p=i(93341),h=i(98563),u=i(91048),d=i(6550),l=i(7841),v=i(38345),g=i(97562),m=i(62437),f=i(47916),S=i(62389),y=i(53504),C=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class w extends f.q{constructor(e,t,i,r,s){super(e,t,i,r,s),this.privDeferralMap=new n.u,this.privSpeakerAudioSource=i,this.sendPrePayloadJSONOverride=()=>this.noOp()}set SpeakerAudioSource(e){this.privSpeakerAudioSource=e}processTypeSpecificMessages(e){let t=!1;const i=new a.O;switch(e.messageType===s.C.Text&&i.setProperty(c.o.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speaker.profiles":const i=JSON.parse(e.textBody);switch(i.operation.toLowerCase()){case"create":this.handleCreateResponse(i,e.requestId);break;case"delete":case"reset":this.handleResultResponse(i,e.requestId);break;case"fetch":const t=JSON.parse(e.textBody);this.handleFetchResponse(t,e.requestId)}t=!0;break;case"speaker.phrases":const r=JSON.parse(e.textBody);this.handlePhrasesResponse(r,e.requestId),t=!0;break;case"speaker.profile.enrollment":const n=JSON.parse(e.textBody),s=new p.f(this.enrollmentReasonFrom(n.enrollment?n.enrollment.enrollmentStatus:n.status.statusCode),n.enrollment?JSON.stringify(n.enrollment):void 0,n.status.reason);this.privDeferralMap.getId(e.requestId)&&this.privDeferralMap.complete(e.requestId,s),this.privRequestSession.onSpeechEnded(),t=!0}const r=new o.BH;return r.resolve(t),r.promise}cancelRecognition(e,t,i,r,n){(new a.O).setProperty(S.CancellationErrorCodePropertyName,h.E[r]);const s=new p.f(u.s.Canceled,n,n);this.privDeferralMap.getId(t)&&this.privDeferralMap.complete(t,s)}createProfile(e,t){return C(this,void 0,void 0,(function*(){this.voiceProfileType=e.toString();const i=this.connectImpl();try{const r=new o.BH;return yield i,yield this.sendCreateProfile(r,e,t),this.receiveMessage(),r.promise}catch(e){throw e}}))}resetProfile(e){return C(this,void 0,void 0,(function*(){return this.voiceProfileType=e.profileType.toString(),this.sendCommonRequest("reset",e.profileType,e)}))}deleteProfile(e){return C(this,void 0,void 0,(function*(){return this.voiceProfileType=e.profileType.toString(),this.sendCommonRequest("delete",e.profileType,e)}))}retrieveEnrollmentResult(e){return C(this,void 0,void 0,(function*(){return this.voiceProfileType=e.profileType.toString(),this.privExpectedProfileId=e.profileId,this.sendCommonRequest("fetch",e.profileType,e)}))}getAllProfiles(e){return C(this,void 0,void 0,(function*(){return this.voiceProfileType=e.toString(),this.sendCommonRequest("fetch",e)}))}getActivationPhrases(e,t){return C(this,void 0,void 0,(function*(){this.voiceProfileType=e.toString();const i=this.connectImpl();try{const r=new o.BH;return yield i,yield this.sendPhrasesRequest(r,e,t),this.receiveMessage(),r.promise}catch(e){throw e}}))}enrollProfile(e){return C(this,void 0,void 0,(function*(){this.voiceProfileType=e.profileType.toString();const t=new o.BH;this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(c.o.Speech_SessionId,this.privRequestSession.sessionId);const i=this.connectImpl(),n=this.sendPreAudioMessages(e,t),s=yield this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),a=yield this.privSpeakerAudioSource.format,p=yield this.privSpeakerAudioSource.deviceInfo,u=new r.C(s,a.avgBytesPerSec);yield this.privRequestSession.onAudioSourceAttachCompleted(u,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:p};try{yield i,yield n}catch(e){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,d._.Error,h.E.ConnectionFailure,e)}const v=new l.$(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,v),this.receiveMessage(),this.sendAudio(u).then((()=>{}),(e=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,d._.Error,h.E.RuntimeError,e)})),t.promise}))}sendPreAudioMessages(e,t){return C(this,void 0,void 0,(function*(){const i=yield this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,t),yield this.sendBaseRequest(i,"enroll",this.scenarioFrom(e.profileType),e)}))}sendPhrasesRequest(e,t,i){return C(this,void 0,void 0,(function*(){const r=yield this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,e);const n=this.scenarioFrom(t),o={locale:i,scenario:n};return r.send(new y.r(s.C.Text,"speaker.profile.phrases",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(o)))}))}sendCreateProfile(e,t,i){return C(this,void 0,void 0,(function*(){const r=yield this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,e);const n=t===v.f.TextIndependentIdentification?"TextIndependentIdentification":t===v.f.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification",o={locale:i,number:"1",scenario:n};return r.send(new y.r(s.C.Text,"speaker.profile.create",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(o)))}))}sendCommonRequest(e,t,i=undefined){return C(this,void 0,void 0,(function*(){const r=this.connectImpl();try{const n=new o.BH;this.privRequestSession.onSpeechContext(),yield r;const s=yield this.fetchConnection();return this.privDeferralMap.add(this.privRequestSession.requestId,n),yield this.sendBaseRequest(s,e,this.scenarioFrom(t),i),this.receiveMessage(),n.promise}catch(e){throw e}}))}sendBaseRequest(e,t,i,r){return C(this,void 0,void 0,(function*(){const n={scenario:i};return r?n.profileIds=[r.profileId]:n.maxPageSize=-1,e.send(new y.r(s.C.Text,`speaker.profile.${t}`,this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(n)))}))}extractSpeakerContext(e){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:e.profileIds,scenario:e.scenario}}handlePhrasesResponse(e,t){if(!this.privDeferralMap.getId(t))throw new Error(`Voice Profile get activation phrases request for requestID ${t} not found`);if("success"!==e.status.statusCode.toLowerCase()){const i=u.s.Canceled,r=new g.U(i,e.status.statusCode,e.passPhraseType,[]);this.privDeferralMap.complete(t,r)}else{if(!(e.phrases&&e.phrases.length>0))throw new Error("Voice Profile get activation phrases failed, no phrases received");{const i=u.s.EnrollingVoiceProfile,r=new g.U(i,e.status.statusCode,e.passPhraseType,e.phrases);this.privDeferralMap.complete(t,r)}}}handleCreateResponse(e,t){if(!(e.profiles&&e.profiles.length>0))throw new Error("Voice Profile create failed, no profile id received");if(!this.privDeferralMap.getId(t))throw new Error(`Voice Profile create request for requestID ${t} not found`);{const i=e.profiles.map((e=>e.profileId));this.privDeferralMap.complete(t,i)}}handleResultResponse(e,t){if(!this.privDeferralMap.getId(t))throw new Error(`Voice Profile create request for requestID ${t} not found`);{const i="delete"===e.operation.toLowerCase()?u.s.DeletedVoiceProfile:u.s.ResetVoiceProfile,r="success"===e.status.statusCode.toLowerCase()?i:u.s.Canceled,n=new m.A(r,`statusCode: ${e.status.statusCode}, errorDetails: ${e.status.reason}`);this.privDeferralMap.complete(t,n)}}handleFetchResponse(e,t){if(!this.privDeferralMap.getId(t)||!e.profiles[0])throw new Error(`Voice Profile fetch request for requestID ${t} not found`);if(this.privExpectedProfileId&&1===e.profiles.length&&e.profiles[0].profileId===this.privExpectedProfileId){this.privExpectedProfileId=void 0;const i=e.profiles[0],r=new p.f(this.enrollmentReasonFrom(i.enrollmentStatus),JSON.stringify(i),e.status.reason);this.privDeferralMap.complete(t,r)}else if(e.profiles.length>0){const i=e.profiles,r=[];for(const t of i)r.push(new p.f(this.enrollmentReasonFrom(t.enrollmentStatus),JSON.stringify(t),e.status.reason));this.privDeferralMap.complete(t,r)}}enrollmentReasonFrom(e){switch(e.toLowerCase()){case"enrolled":return u.s.EnrolledVoiceProfile;case"invalidlocale":case"invalidphrase":case"invalidaudioformat":case"invalidscenario":case"invalidprofilecount":case"invalidoperation":case"audiotooshort":case"audiotoolong":case"toomanyenrollments":case"storageconflict":case"profilenotfound":case"incompatibleprofiles":case"incompleteenrollment":return u.s.Canceled;default:return u.s.EnrollingVoiceProfile}}scenarioFrom(e){return e===v.f.TextIndependentIdentification?"TextIndependentIdentification":e===v.f.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification"}}},65610:(e,t,i)=>{"use strict";i.d(t,{D:()=>o});var r=i(33182),n=i(66645),s=i(36259);class o{toConnectionMessage(e){const t=new r.BH;try{if(e.messageType===n.C.Text){const i=e.textContent;let r={},s=null;if(i){const e=i.split("\r\n\r\n");e&&e.length>0&&(r=this.parseHeaders(e[0]),e.length>1&&(s=e[1]))}t.resolve(new n.H(e.messageType,s,r,e.id))}else if(e.messageType===n.C.Binary){const i=e.binaryContent;let r={},s=null;if(!i||i.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");const o=new DataView(i),a=o.getInt16(0);if(i.byteLength<a+2)throw new Error("Invalid binary message format. Header content missing.");let c="";for(let e=0;e<a;e++)c+=String.fromCharCode(o.getInt8(e+2));r=this.parseHeaders(c),i.byteLength>a+2&&(s=i.slice(2+a)),t.resolve(new n.H(e.messageType,s,r,e.id))}}catch(e){t.reject(`Error formatting the message. Error: ${e}`)}return t.promise}fromConnectionMessage(e){const t=new r.BH;try{if(e.messageType===n.C.Text){const i=`${this.makeHeaders(e)}\r\n${e.textBody?e.textBody:""}`;t.resolve(new s.S(n.C.Text,i,e.id))}else if(e.messageType===n.C.Binary){const i=this.makeHeaders(e),r=e.binaryBody,o=this.stringToArrayBuffer(i),a=new Int8Array(o),c=a.byteLength,p=new Int8Array(2+c+(r?r.byteLength:0));if(p[0]=c>>8&255,p[1]=255&c,p.set(a,2),r){const e=new Int8Array(r);p.set(e,2+c)}const h=p.buffer;t.resolve(new s.S(n.C.Binary,h,e.id))}}catch(e){t.reject(`Error formatting the message. ${e}`)}return t.promise}makeHeaders(e){let t="";if(e.headers)for(const i in e.headers)i&&(t+=`${i}: ${e.headers[i]}\r\n`);return t}parseHeaders(e){const t={};if(e){const i=e.match(/[^\r\n]+/g);if(t)for(const e of i)if(e){const i=e.indexOf(":"),r=i>0?e.substr(0,i).trim().toLowerCase():e,n=i>0&&e.length>i+1?e.substr(i+1).trim():"";t[r]=n}}return t}stringToArrayBuffer(e){const t=new ArrayBuffer(e.length),i=new DataView(t);for(let t=0;t<e.length;t++)i.setUint8(t,e.charCodeAt(t));return t}}},86582:(e,t,i)=>{"use strict";i.d(t,{He:()=>d,Jl:()=>o,QZ:()=>s,hA:()=>l,i5:()=>h,ls:()=>a,n0:()=>c,sQ:()=>u});var r=i(14300);class n extends r.A{constructor(e,t,i=r.t.Info){super(e,i),this.privAudioSourceId=t}get audioSourceId(){return this.privAudioSourceId}}class s extends n{constructor(e){super("AudioSourceInitializingEvent",e)}}class o extends n{constructor(e){super("AudioSourceReadyEvent",e)}}class a extends n{constructor(e){super("AudioSourceOffEvent",e)}}class c extends n{constructor(e,t){super("AudioSourceErrorEvent",e,r.t.Error),this.privError=t}get error(){return this.privError}}class p extends n{constructor(e,t,i){super(e,t),this.privAudioNodeId=i}get audioNodeId(){return this.privAudioNodeId}}class h extends p{constructor(e,t){super("AudioStreamNodeAttachingEvent",e,t)}}class u extends p{constructor(e,t){super("AudioStreamNodeAttachedEvent",e,t)}}class d extends p{constructor(e,t){super("AudioStreamNodeDetachedEvent",e,t)}}class l extends p{constructor(e,t,i){super("AudioStreamNodeErrorEvent",e,t),this.privError=i}get error(){return this.privError}}},59187:(e,t,i)=>{"use strict";i.d(t,{u:()=>n});var r=i(14300);class n extends r.A{constructor(e){super("BackgroundEvent",r.t.Error),this.privError=e}get error(){return this.privError}}},25038:(e,t,i)=>{"use strict";i.d(t,{L:()=>n});var r=i(59595);class n extends r.F{constructor(e,t){super(t),this.privTargetChunkSize=e,this.privNextBufferReadyBytes=0}writeStreamChunk(e){if(e.isEnd||0===this.privNextBufferReadyBytes&&e.buffer.byteLength===this.privTargetChunkSize)return void super.writeStreamChunk(e);let t=0;for(;t<e.buffer.byteLength;){void 0===this.privNextBufferToWrite&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=e.timeReceived);const i=Math.min(e.buffer.byteLength-t,this.privTargetChunkSize-this.privNextBufferReadyBytes),r=new Uint8Array(this.privNextBufferToWrite),n=new Uint8Array(e.buffer.slice(t,i+t));r.set(n,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=i,t+=i,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){0===this.privNextBufferReadyBytes||this.isClosed||super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}}},71945:(e,t,i)=>{"use strict";i.d(t,{K4:()=>p,PE:()=>c,Qz:()=>u,YF:()=>o,Zk:()=>a,e2:()=>n,w2:()=>d,xz:()=>h});var r=i(14300);class n extends r.A{constructor(e,t,i=r.t.Info){super(e,i),this.privJsonResult=t}get jsonString(){return this.privJsonResult}}class s extends r.A{constructor(e,t,i=r.t.Info){super(e,i),this.privConnectionId=t}get connectionId(){return this.privConnectionId}}class o extends s{constructor(e,t,i){super("ConnectionStartEvent",e),this.privUri=t,this.privHeaders=i}get uri(){return this.privUri}get headers(){return this.privHeaders}}class a extends s{constructor(e){super("ConnectionEstablishedEvent",e)}}class c extends s{constructor(e,t,i){super("ConnectionClosedEvent",e,r.t.Debug),this.privReason=i,this.privStatusCode=t}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}class p extends s{constructor(e,t,i){super("ConnectionErrorEvent",e,r.t.Debug),this.privMessage=t,this.privType=i}get message(){return this.privMessage}get type(){return this.privType}}class h extends s{constructor(e,t,i){super("ConnectionEstablishErrorEvent",e,r.t.Error),this.privStatusCode=t,this.privReason=i}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}class u extends s{constructor(e,t,i){super("ConnectionMessageReceivedEvent",e),this.privNetworkReceivedTime=t,this.privMessage=i}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}}class d extends s{constructor(e,t,i){super("ConnectionMessageSentEvent",e),this.privNetworkSentTime=t,this.privMessage=i}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}}},66645:(e,t,i)=>{"use strict";i.d(t,{C:()=>r,H:()=>o});var r,n=i(80491),s=i(25487);!function(e){e[e.Text=0]="Text",e[e.Binary=1]="Binary"}(r||(r={}));class o{constructor(e,t,i,o){if(this.privBody=null,e===r.Text&&t&&"string"!=typeof t)throw new n.$2("Payload must be a string");if(e===r.Binary&&t&&!(t instanceof ArrayBuffer))throw new n.$2("Payload must be ArrayBuffer");switch(this.privMessageType=e,this.privBody=t,this.privHeaders=i||{},this.privId=o||(0,s.Q)(),this.messageType){case r.Binary:this.privSize=null!==this.binaryBody?this.binaryBody.byteLength:0;break;case r.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===r.Binary)throw new n.$2("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===r.Text)throw new n.$2("Not supported for text message");return this.privBody}get id(){return this.privId}}},22525:(e,t,i)=>{"use strict";i.d(t,{u:()=>r});class r{constructor(){this.privMap={}}add(e,t){this.privMap[e]=t}getId(e){return this.privMap[e]}complete(e,t){try{this.privMap[e].resolve(t)}catch(t){this.privMap[e].reject(t)}finally{this.privMap[e]=void 0}}}},46935:(e,t,i)=>{"use strict";i.d(t,{K:()=>s});var r=i(14300);class n extends r.A{constructor(e,t=r.t.Info){super(e,t)}}class s extends n{constructor(e){super("SendingAgentContextMessageEvent"),this.privAgentConfig=e}get agentConfig(){return this.privAgentConfig}}},80491:(e,t,i)=>{"use strict";i.d(t,{$2:()=>n,Do:()=>r,IV:()=>s});class r extends Error{constructor(e){super(e),this.name="ArgumentNull",this.message=e}}class n extends Error{constructor(e){super(e),this.name="InvalidOperation",this.message=e}}class s extends Error{constructor(e,t){super(t),this.name=e+"ObjectDisposed",this.message=t}}},48232:(e,t,i)=>{"use strict";i.d(t,{n:()=>s});var r=i(80491),n=i(25487);class s{constructor(e){this.privEventListeners={},this.privIsDisposed=!1,this.privConsoleListener=void 0,this.privMetadata=e}onEvent(e){if(this.isDisposed())throw new r.IV("EventSource");if(this.metadata)for(const t in this.metadata)t&&e.metadata&&(e.metadata[t]||(e.metadata[t]=this.metadata[t]));for(const t in this.privEventListeners)t&&this.privEventListeners[t]&&this.privEventListeners[t](e)}attach(e){const t=(0,n.Q)();return this.privEventListeners[t]=e,{detach:()=>(delete this.privEventListeners[t],Promise.resolve())}}attachListener(e){return this.attach((t=>e.onEvent(t)))}attachConsoleListener(e){return this.privConsoleListener&&this.privConsoleListener.detach(),this.privConsoleListener=this.attach((t=>e.onEvent(t))),this.privConsoleListener}isDisposed(){return this.privIsDisposed}dispose(){this.privEventListeners=null,this.privIsDisposed=!0}get metadata(){return this.privMetadata}}},3625:(e,t,i)=>{"use strict";i.d(t,{z:()=>s});var r=i(80491),n=i(48232);class s{static setEventSource(e){if(!e)throw new r.Do("eventSource");s.privInstance=e}static get instance(){return s.privInstance}}s.privInstance=new n.n},25487:(e,t,i)=>{"use strict";i.d(t,{Q:()=>s,c:()=>n});var r=i(72045);const n=()=>(0,r.Z)(),s=()=>n().replace(new RegExp("-","g"),"").toUpperCase()},43842:(e,t,i)=>{"use strict";var r;i.d(t,{e:()=>r}),function(e){e[e.None=0]="None",e[e.Connected=1]="Connected",e[e.Connecting=2]="Connecting",e[e.Disconnected=3]="Disconnected"}(r||(r={}))},5234:(e,t,i)=>{"use strict";i.d(t,{a:()=>n});var r=i(80491);class n{constructor(e){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.privList=[],e)for(const t of e)this.privList.push(t)}get(e){return this.throwIfDisposed(),this.privList[e]}first(){return this.get(0)}last(){return this.get(this.length()-1)}add(e){this.throwIfDisposed(),this.insertAt(this.privList.length,e)}insertAt(e,t){this.throwIfDisposed(),0===e?this.privList.unshift(t):e===this.privList.length?this.privList.push(t):this.privList.splice(e,0,t),this.triggerSubscriptions(this.privAddSubscriptions)}removeFirst(){return this.throwIfDisposed(),this.removeAt(0)}removeLast(){return this.throwIfDisposed(),this.removeAt(this.length()-1)}removeAt(e){return this.throwIfDisposed(),this.remove(e,1)[0]}remove(e,t){this.throwIfDisposed();const i=this.privList.splice(e,t);return this.triggerSubscriptions(this.privRemoveSubscriptions),i}clear(){this.throwIfDisposed(),this.remove(0,this.length())}length(){return this.throwIfDisposed(),this.privList.length}onAdded(e){this.throwIfDisposed();const t=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[t]=e,{detach:()=>(delete this.privAddSubscriptions[t],Promise.resolve())}}onRemoved(e){this.throwIfDisposed();const t=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[t]=e,{detach:()=>(delete this.privRemoveSubscriptions[t],Promise.resolve())}}onDisposed(e){this.throwIfDisposed();const t=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[t]=e,{detach:()=>(delete this.privDisposedSubscriptions[t],Promise.resolve())}}join(e){return this.throwIfDisposed(),this.privList.join(e)}toArray(){const e=Array();return this.privList.forEach((t=>{e.push(t)})),e}any(e){return this.throwIfDisposed(),e?this.where(e).length()>0:this.length()>0}all(e){return this.throwIfDisposed(),this.where(e).length()===this.length()}forEach(e){this.throwIfDisposed();for(let t=0;t<this.length();t++)e(this.privList[t],t)}select(e){this.throwIfDisposed();const t=[];for(let i=0;i<this.privList.length;i++)t.push(e(this.privList[i],i));return new n(t)}where(e){this.throwIfDisposed();const t=new n;for(let i=0;i<this.privList.length;i++)e(this.privList[i],i)&&t.add(this.privList[i]);return t}orderBy(e){this.throwIfDisposed();const t=this.toArray().sort(e);return new n(t)}orderByDesc(e){return this.throwIfDisposed(),this.orderBy(((t,i)=>e(i,t)))}clone(){return this.throwIfDisposed(),new n(this.toArray())}concat(e){return this.throwIfDisposed(),new n(this.privList.concat(e.toArray()))}concatArray(e){return this.throwIfDisposed(),new n(this.privList.concat(e))}isDisposed(){return null==this.privList}dispose(e){this.isDisposed()||(this.privDisposeReason=e,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))}throwIfDisposed(){if(this.isDisposed())throw new r.IV("List",this.privDisposeReason)}triggerSubscriptions(e){if(e)for(const t in e)t&&e[t]()}}},14300:(e,t,i)=>{"use strict";i.d(t,{A:()=>s,t:()=>r});var r,n=i(25487);!function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.None=4]="None"}(r||(r={}));class s{constructor(e,t){this.privName=e,this.privEventId=(0,n.Q)(),this.privEventTime=(new Date).toISOString(),this.privEventType=t,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}}},33182:(e,t,i)=>{"use strict";var r;i.d(t,{BH:()=>n,Kb:()=>s}),function(e){e[e.None=0]="None",e[e.Resolved=1]="Resolved",e[e.Rejected=2]="Rejected"}(r||(r={}));class n{constructor(){this.resolve=e=>(this.privResolve(e),this),this.reject=e=>(this.privReject(e),this),this.privPromise=new Promise(((e,t)=>{this.privResolve=e,this.privReject=t}))}get promise(){return this.privPromise}}function s(e,t,i){e.then((e=>{try{t&&t(e)}catch(e){if(i)try{if(e instanceof Error){const t=e;i(t.name+": "+t.message)}else i(e)}catch(e){}}}),(e=>{if(i)try{if(e instanceof Error){const t=e;i(t.name+": "+t.message)}else i(e)}catch(e){}}))}},68887:(e,t,i)=>{"use strict";i.d(t,{c:()=>c});var r,n=i(80491),s=i(5234),o=i(33182),a=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};!function(e){e[e.Dequeue=0]="Dequeue",e[e.Peek=1]="Peek"}(r||(r={}));class c{constructor(e){this.privPromiseStore=new s.a,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.privList=e||new s.a,this.privDetachables=[],this.privSubscribers=new s.a,this.privDetachables.push(this.privList.onAdded((()=>this.drain())))}enqueue(e){this.throwIfDispose(),this.enqueueFromPromise(new Promise((t=>t(e))))}enqueueFromPromise(e){this.throwIfDispose(),e.then((e=>{this.privList.add(e)}),(()=>{}))}dequeue(){this.throwIfDispose();const e=new o.BH;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:r.Dequeue}),this.drain()),e.promise}peek(){this.throwIfDispose();const e=new o.BH;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:r.Peek}),this.drain()),e.promise}length(){return this.throwIfDispose(),this.privList.length()}isDisposed(){return null==this.privSubscribers}drainAndDispose(e,t){return a(this,void 0,void 0,(function*(){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=t,this.privIsDisposing=!0;const i=this.privSubscribers;if(i){for(;i.length()>0;)i.removeFirst().deferral.resolve(void 0);this.privSubscribers===i&&(this.privSubscribers=i)}for(const e of this.privDetachables)yield e.detach();if(this.privPromiseStore.length()>0&&e){const t=[];return this.privPromiseStore.toArray().forEach((e=>{t.push(e)})),Promise.all(t).finally((()=>{this.privSubscribers=null,this.privList.forEach((t=>{e(t)})),this.privList=null})).then()}this.privSubscribers=null,this.privList=null}}))}dispose(e){return a(this,void 0,void 0,(function*(){yield this.drainAndDispose(null,e)}))}drain(){if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;const e=this.privSubscribers,t=this.privList;if(e&&t){for(;t.length()>0&&e.length()>0&&!this.privIsDisposing;){const i=e.removeFirst();if(i.type===r.Peek)i.deferral.resolve(t.first());else{const e=t.removeFirst();i.deferral.resolve(e)}}this.privSubscribers===e&&(this.privSubscribers=e),this.privList===t&&(this.privList=t)}this.privIsDrainInProgress=!1}}throwIfDispose(){if(this.isDisposed()){if(this.privDisposeReason)throw new n.$2(this.privDisposeReason);throw new n.IV("Queue")}if(this.privIsDisposing)throw new n.$2("Queue disposing")}}},36259:(e,t,i)=>{"use strict";i.d(t,{S:()=>o});var r=i(66645),n=i(80491),s=i(25487);class o{constructor(e,t,i){if(this.privPayload=null,!t)throw new n.Do("payload");if(e===r.C.Binary&&"ArrayBuffer"!==t.__proto__.constructor.name)throw new n.$2("Payload must be ArrayBuffer");if(e===r.C.Text&&"string"!=typeof t)throw new n.$2("Payload must be a string");this.privMessageType=e,this.privPayload=t,this.privId=i||(0,s.Q)()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===r.C.Binary)throw new n.$2("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===r.C.Text)throw new n.$2("Not supported for text message");return this.privPayload}get id(){return this.privId}}},68426:(e,t,i)=>{"use strict";i.d(t,{S:()=>r});class r{constructor(e,t){this.privActualSampleRate=e,this.privDesiredSampleRate=t}encode(e){const t=this.downSampleAudioFrame(e,this.privActualSampleRate,this.privDesiredSampleRate);if(!t)return null;const i=2*t.length,r=new ArrayBuffer(i),n=new DataView(r);return this.floatTo16BitPCM(n,0,t),r}setString(e,t,i){for(let r=0;r<i.length;r++)e.setUint8(t+r,i.charCodeAt(r))}floatTo16BitPCM(e,t,i){for(let r=0;r<i.length;r++,t+=2){const n=Math.max(-1,Math.min(1,i[r]));e.setInt16(t,n<0?32768*n:32767*n,!0)}}downSampleAudioFrame(e,t,i){if(!e)return null;if(i===t||i>t)return e;const r=t/i,n=Math.round(e.length/r),s=new Float32Array(n);let o=0,a=0;for(;a<n;){const t=Math.round((a+1)*r);let i=0,n=0;for(;o<t&&o<e.length;)i+=e[o++],n++;s[a++]=i/n}return s}}},59595:(e,t,i)=>{"use strict";i.d(t,{F:()=>o});var r=i(80491),n=i(25487),s=i(68887);class o{constructor(e){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.privId=e||(0,n.Q)(),this.privReaderQueue=new s.c}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(e){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(e)}catch(e){}}read(){if(this.privIsReadEnded)throw new r.$2("Stream read has already finished");return this.privReaderQueue.dequeue().then((e=>{return t=this,i=void 0,n=function*(){return(void 0===e||e.isEnd)&&(yield this.privReaderQueue.dispose("End of stream reached")),e},new((r=void 0)||(r=Promise))((function(e,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof r?i:new r((function(e){e(i)}))).then(o,a)}c((n=n.apply(t,i||[])).next())}));var t,i,r,n}))}readEnded(){this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new s.c)}throwIfClosed(){if(this.privIsWriteEnded)throw new r.$2("Stream closed")}}},70263:(e,t,i)=>{"use strict";i.d(t,{x:()=>r});class r{static formatString(e,t){if(!e)return"";if(!t)return e;let i="",r="";const n=e=>{i+=e},s=e=>{r+=e};let o=n;for(let a=0;a<e.length;a++){const c=e[a],p=a+1<e.length?e[a+1]:"";switch(c){case"{":"{"===p?(o("{"),a++):o=s;break;case"}":"}"===p?(o("}"),a++):(t.hasOwnProperty(r)&&(i+=t[r]),o=n,r="");break;default:o(c)}}return i}}},42309:(e,t,i)=>{"use strict";i.d(t,{V:()=>r});class r{static load(){const e=new Map([[0,()=>{}]]),t=new Map,i="data:text/javascript;base64,"+btoa('!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error(\'There is no interval scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error(\'The given method "\'.concat(e.method,\'" is not supported\'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);'),n=new Worker(i);return n.addEventListener("message",(({data:i})=>{if(r.isCallNotification(i)){const{params:{timerId:r}}=i,n=e.get(r);if("number"==typeof n){const e=t.get(n);if(void 0===e||e!==r)throw new Error("The timer is in an undefined state.")}else{if(void 0===n)throw new Error("The timer is in an undefined state.");n(),e.delete(r)}}else{if(!r.isClearResponse(i)){const{error:{message:e}}=i;throw new Error(e)}{const{id:r}=i,n=t.get(r);if(void 0===n)throw new Error("The timer is in an undefined state.");t.delete(r),e.delete(n)}}})),{clearTimeout:i=>{const r=Math.random();t.set(r,i),e.set(i,r),n.postMessage({id:r,method:"clear",params:{timerId:i}})},setTimeout:(t,i)=>{const r=Math.random();return e.set(r,t),n.postMessage({id:null,method:"set",params:{delay:i,now:performance.now(),timerId:r}}),r}}}static loadWorkerTimers(){return()=>(null!==r.workerTimers||(r.workerTimers=r.load()),r.workerTimers)}static isCallNotification(e){return void 0!==e.method&&"call"===e.method}static isClearResponse(e){return null===e.error&&"number"==typeof e.id}}r.workerTimers=null,r.clearTimeout=e=>r.timers().clearTimeout(e),r.setTimeout=(e,t)=>r.timers().setTimeout(e,t),r.timers=r.loadWorkerTimers()},33428:(e,t,i)=>{"use strict";i.d(t,{v:()=>r});class r{constructor(e,t){this.privActivity=e,this.privAudioStream=t}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}}},66e3:(e,t,i)=>{"use strict";i.d(t,{rU:()=>l});var r=i(19300),n=i(15599),s=i(85706),o=i(89513),a=i(44692),c=i(80309),p=i(59576),h=i(63946),u=i(1912),d=i(31298);class l{static fromDefaultMicrophoneInput(){const e=new r.s(!0);return new v(new n.I(e))}static fromMicrophoneInput(e){const t=new r.s(!0);return new v(new n.I(t,e))}static fromWavFileInput(e,t="unnamedBuffer.wav"){return new v(new s.z(e,t))}static fromStreamInput(e){if(e instanceof a.W)return new v(new c.fB(e));if(e instanceof c.yk)return new v(e);if("undefined"!=typeof MediaStream&&e instanceof MediaStream){const t=new r.s(!1);return new v(new n.I(t,null,null,e))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new g(new p.K)}static fromSpeakerOutput(e){if(void 0===e)return l.fromDefaultSpeakerOutput();if(e instanceof p.K)return new g(e);throw new Error("Not Supported Type")}static fromAudioFileOutput(e){return new g(new d.O(e))}static fromStreamOutput(e){if(e instanceof h.y)return new g(new u.KS(e));if(e instanceof u.XO)return new g(e);if(e instanceof u.Ao)return new g(e);throw new Error("Not Supported Type")}}class v extends l{constructor(e){super(),this.privSource=e}get format(){return this.privSource.format}close(e,t){this.privSource.turnOff().then((()=>{e&&e()}),(e=>{t&&t(e)}))}id(){return this.privSource.id()}turnOn(){return this.privSource.turnOn()}attach(e){return this.privSource.attach(e)}detach(e){return this.privSource.detach(e)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(e,t){if(o.a.throwIfNull(t,"value"),void 0===this.privSource.setProperty)throw new Error("This AudioConfig instance does not support setting properties.");this.privSource.setProperty(e,t)}getProperty(e,t){if(void 0!==this.privSource.getProperty)return this.privSource.getProperty(e,t);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}}class g extends l{constructor(e){super(),this.privDestination=e}set format(e){this.privDestination.format=e}write(e){this.privDestination.write(e)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(){throw new Error("This AudioConfig instance does not support getting properties.")}}},31298:(e,t,i)=>{"use strict";i.d(t,{O:()=>s});var r=i(10592),n=i(89513);class s{constructor(e){n.a.throwIfNullOrUndefined(r.openSync,"\nFile System access not available, please use Push or PullAudioOutputStream"),this.privFd=r.openSync(e,"w")}set format(e){n.a.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=e;let t=0;this.privAudioFormat.hasHeader&&(t=this.privAudioFormat.header.byteLength),void 0!==this.privFd&&(this.privWriteStream=r.createWriteStream("",{fd:this.privFd,start:t,autoClose:!1}))}write(e){n.a.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),void 0!==this.privWriteStream&&this.privWriteStream.write(new Uint8Array(e.slice(0)))}close(){void 0!==this.privFd&&(this.privWriteStream.on("finish",(()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),r.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),r.closeSync(this.privFd),this.privFd=void 0})),this.privWriteStream.end())}id(){return this.privId}}},80309:(e,t,i)=>{"use strict";i.d(t,{ZT:()=>d,fB:()=>g,kv:()=>v,yk:()=>u});var r=i(62029),n=i(48232),s=i(25038),o=i(86582),a=i(3625),c=i(25487),p=i(83895),h=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class u{constructor(){}static createPushStream(e){return d.create(e)}static createPullStream(e,t){return v.create(e,t)}}class d extends u{static create(e){return new l(e)}}class l extends d{constructor(e){super(),this.privFormat=void 0===e?p.Bm.getDefaultInputFormat():e,this.privEvents=new n.n,this.privId=(0,c.Q)(),this.privStream=new s.L(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(e){this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}turnOn(){this.onEvent(new o.QZ(this.privId)),this.onEvent(new o.Jl(this.privId))}attach(e){return h(this,void 0,void 0,(function*(){this.onEvent(new o.i5(this.privId,e)),yield this.turnOn();const t=this.privStream;return this.onEvent(new o.sQ(this.privId,e)),{detach:()=>h(this,void 0,void 0,(function*(){return this.onEvent(new o.He(this.privId,e)),this.turnOff()})),id:()=>e,read:()=>t.read()}}))}detach(e){this.onEvent(new o.He(this.privId,e))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:r.wF.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:r.dt.Stream})}onEvent(e){this.privEvents.onEvent(e),a.z.instance.onEvent(e)}toBuffer(e){const t=Buffer.alloc(e.byteLength),i=new Uint8Array(e);for(let e=0;e<t.length;++e)t[e]=i[e];return t}}class v extends u{constructor(){super()}static create(e,t){return new g(e,t)}}class g extends v{constructor(e,t){super(),this.privFormat=void 0===t?p.HT.getDefaultInputFormat():t,this.privEvents=new n.n,this.privId=(0,c.Q)(),this.privCallback=e,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}turnOn(){this.onEvent(new o.QZ(this.privId)),this.onEvent(new o.Jl(this.privId))}attach(e){return h(this,void 0,void 0,(function*(){return this.onEvent(new o.i5(this.privId,e)),yield this.turnOn(),this.onEvent(new o.sQ(this.privId,e)),{detach:()=>(this.privCallback.close(),this.onEvent(new o.He(this.privId,e)),this.turnOff()),id:()=>e,read:()=>{let e,t=0;for(;t<this.privBufferSize;){const i=new ArrayBuffer(this.privBufferSize-t),r=this.privCallback.read(i);if(void 0===e?e=i:new Int8Array(e).set(new Int8Array(i),t),0===r)break;t+=r}return Promise.resolve({buffer:e.slice(0,t),isEnd:this.privIsClosed||0===t,timeReceived:Date.now()})}}}))}detach(e){this.onEvent(new o.He(this.privId,e))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:r.wF.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:r.dt.Stream})}onEvent(e){this.privEvents.onEvent(e),a.z.instance.onEvent(e)}}},85904:(e,t,i)=>{"use strict";i.d(t,{d:()=>s});var r=i(92356),n=i(83895);class s extends n.Bm{constructor(e,t,i,r,n,s,o,a,c){super(i,s,t,e),this.formatTag=e,this.avgBytesPerSec=r,this.blockAlign=n,this.priAudioFormatString=o,this.priRequestAudioFormatString=a,this.priHasHeader=c}static fromSpeechSynthesisOutputFormat(e){return void 0===e?s.getDefaultOutputFormat():s.fromSpeechSynthesisOutputFormatString(s.SpeechSynthesisOutputFormatToString[e])}static fromSpeechSynthesisOutputFormatString(e){switch(e){case"raw-8khz-8bit-mono-mulaw":return new s(n.WY.MuLaw,1,8e3,8e3,1,8,e,e,!1);case"riff-16khz-16kbps-mono-siren":return new s(n.WY.Siren,1,16e3,2e3,40,0,e,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new s(n.WY.Siren,1,16e3,2e3,40,0,e,e,!1);case"audio-16khz-32kbitrate-mono-mp3":return new s(n.WY.MP3,1,16e3,4096,2,16,e,e,!1);case"audio-16khz-128kbitrate-mono-mp3":return new s(n.WY.MP3,1,16e3,16384,2,16,e,e,!1);case"audio-16khz-64kbitrate-mono-mp3":return new s(n.WY.MP3,1,16e3,8192,2,16,e,e,!1);case"audio-24khz-48kbitrate-mono-mp3":return new s(n.WY.MP3,1,24e3,6144,2,16,e,e,!1);case"audio-24khz-96kbitrate-mono-mp3":return new s(n.WY.MP3,1,24e3,12288,2,16,e,e,!1);case"audio-24khz-160kbitrate-mono-mp3":return new s(n.WY.MP3,1,24e3,20480,2,16,e,e,!1);case"raw-16khz-16bit-mono-truesilk":return new s(n.WY.SILKSkype,1,16e3,32e3,2,16,e,e,!1);case"riff-8khz-16bit-mono-pcm":return new s(n.WY.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new s(n.WY.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new s(n.WY.MuLaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new s(n.WY.PCM,1,16e3,32e3,2,16,e,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new s(n.WY.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new s(n.WY.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new s(n.WY.OGG_OPUS,1,16e3,8192,2,16,e,e,!1);case"ogg-24khz-16bit-mono-opus":return new s(n.WY.OGG_OPUS,1,24e3,8192,2,16,e,e,!1);case"raw-48khz-16bit-mono-pcm":return new s(n.WY.PCM,1,48e3,96e3,2,16,e,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new s(n.WY.PCM,1,48e3,96e3,2,16,e,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new s(n.WY.MP3,1,48e3,12288,2,16,e,e,!1);case"audio-48khz-192kbitrate-mono-mp3":return new s(n.WY.MP3,1,48e3,24576,2,16,e,e,!1);case"ogg-48khz-16bit-mono-opus":return new s(n.WY.OGG_OPUS,1,48e3,12e3,2,16,e,e,!1);case"webm-16khz-16bit-mono-opus":return new s(n.WY.WEBM_OPUS,1,16e3,4e3,2,16,e,e,!1);case"webm-24khz-16bit-mono-opus":return new s(n.WY.WEBM_OPUS,1,24e3,6e3,2,16,e,e,!1);case"webm-24khz-16bit-24kbps-mono-opus":return new s(n.WY.WEBM_OPUS,1,24e3,3e3,2,16,e,e,!1);case"audio-16khz-16bit-32kbps-mono-opus":return new s(n.WY.OPUS,1,16e3,4e3,2,16,e,e,!1);case"audio-24khz-16bit-48kbps-mono-opus":return new s(n.WY.OPUS,1,24e3,6e3,2,16,e,e,!1);case"audio-24khz-16bit-24kbps-mono-opus":return new s(n.WY.OPUS,1,24e3,3e3,2,16,e,e,!1);case"audio-24khz-16bit-mono-flac":return new s(n.WY.FLAC,1,24e3,24e3,2,16,e,e,!1);case"audio-48khz-16bit-mono-flac":return new s(n.WY.FLAC,1,48e3,3e4,2,16,e,e,!1);case"raw-24khz-16bit-mono-truesilk":return new s(n.WY.SILKSkype,1,24e3,48e3,2,16,e,e,!1);case"raw-8khz-8bit-mono-alaw":return new s(n.WY.ALaw,1,8e3,8e3,1,8,e,e,!1);case"riff-8khz-8bit-mono-alaw":return new s(n.WY.ALaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-alaw",!0);case"raw-22050hz-16bit-mono-pcm":return new s(n.WY.PCM,1,22050,44100,2,16,e,e,!1);case"riff-22050hz-16bit-mono-pcm":return new s(n.WY.PCM,1,22050,44100,2,16,e,"raw-22050hz-16bit-mono-pcm",!0);case"raw-44100hz-16bit-mono-pcm":return new s(n.WY.PCM,1,44100,88200,2,16,e,e,!1);case"riff-44100hz-16bit-mono-pcm":return new s(n.WY.PCM,1,44100,88200,2,16,e,"raw-44100hz-16bit-mono-pcm",!0);default:return new s(n.WY.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return s.fromSpeechSynthesisOutputFormatString("undefined"!=typeof window?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(e){if(this.priHasHeader){const t=new DataView(this.privHeader);t.setUint32(4,e+this.privHeader.byteLength-8,!0),t.setUint32(40,e,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}}s.SpeechSynthesisOutputFormatToString={[r.Y.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[r.Y.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[r.Y.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[r.Y.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[r.Y.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[r.Y.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[r.Y.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[r.Y.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[r.Y.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[r.Y.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[r.Y.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[r.Y.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[r.Y.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[r.Y.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[r.Y.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[r.Y.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[r.Y.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[r.Y.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[r.Y.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[r.Y.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[r.Y.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[r.Y.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[r.Y.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[r.Y.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[r.Y.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[r.Y.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[r.Y.Webm24Khz16Bit24KbpsMonoOpus]:"webm-24khz-16bit-24kbps-mono-opus",[r.Y.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[r.Y.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[r.Y.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw",[r.Y.Audio16Khz16Bit32KbpsMonoOpus]:"audio-16khz-16bit-32kbps-mono-opus",[r.Y.Audio24Khz16Bit48KbpsMonoOpus]:"audio-24khz-16bit-48kbps-mono-opus",[r.Y.Audio24Khz16Bit24KbpsMonoOpus]:"audio-24khz-16bit-24kbps-mono-opus",[r.Y.Raw22050Hz16BitMonoPcm]:"raw-22050hz-16bit-mono-pcm",[r.Y.Riff22050Hz16BitMonoPcm]:"riff-22050hz-16bit-mono-pcm",[r.Y.Raw44100Hz16BitMonoPcm]:"raw-44100hz-16bit-mono-pcm",[r.Y.Riff44100Hz16BitMonoPcm]:"riff-44100hz-16bit-mono-pcm"}},1912:(e,t,i)=>{"use strict";i.d(t,{Ao:()=>c,J4:()=>a,KS:()=>u,NO:()=>p,XO:()=>h});var r=i(25487),n=i(59595),s=i(89513),o=i(85904);class a{constructor(){}static createPullStream(){return c.create()}}class c extends a{static create(){return new p}}class p extends c{constructor(){super(),this.privId=(0,r.Q)(),this.privStream=new n.F}set format(e){null==e&&(this.privFormat=o.d.getDefaultOutputFormat()),this.privFormat=e}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}read(e){return t=this,i=void 0,n=function*(){const t=new Int8Array(e);let i=0;if(void 0!==this.privLastChunkView){if(this.privLastChunkView.length>e.byteLength)return t.set(this.privLastChunkView.slice(0,e.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(e.byteLength),Promise.resolve(e.byteLength);t.set(this.privLastChunkView),i=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;i<e.byteLength&&!this.privStream.isReadEnded;){const r=yield this.privStream.read();if(void 0===r||r.isEnd)this.privStream.readEnded();else{let n;r.buffer.byteLength>e.byteLength-i?(n=r.buffer.slice(0,e.byteLength-i),this.privLastChunkView=new Int8Array(r.buffer.slice(e.byteLength-i))):n=r.buffer,t.set(new Int8Array(n),i),i+=n.byteLength}}return i},new((r=void 0)||(r=Promise))((function(e,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof r?i:new r((function(e){e(i)}))).then(o,a)}c((n=n.apply(t,i||[])).next())}));var t,i,r,n}write(e){s.a.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}}class h extends a{constructor(){super()}static create(e){return new u(e)}}class u extends h{constructor(e){super(),this.privId=(0,r.Q)(),this.privCallback=e}set format(e){}write(e){this.privCallback.write&&this.privCallback.write(e)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}}},83895:(e,t,i)=>{"use strict";var r;i.d(t,{Bm:()=>s,HT:()=>n,WY:()=>r}),function(e){e[e.PCM=1]="PCM",e[e.MuLaw=2]="MuLaw",e[e.Siren=3]="Siren",e[e.MP3=4]="MP3",e[e.SILKSkype=5]="SILKSkype",e[e.OGG_OPUS=6]="OGG_OPUS",e[e.WEBM_OPUS=7]="WEBM_OPUS",e[e.ALaw=8]="ALaw",e[e.FLAC=9]="FLAC",e[e.OPUS=10]="OPUS"}(r||(r={}));class n{static getDefaultInputFormat(){return s.getDefaultInputFormat()}static getWaveFormat(e,t,i,r){return new s(e,t,i,r)}static getWaveFormatPCM(e,t,i){return new s(e,t,i)}}class s extends n{constructor(e=16e3,t=16,i=1,n=r.PCM){super();let s=!0;switch(n){case r.PCM:this.formatTag=1;break;case r.ALaw:this.formatTag=6;break;case r.MuLaw:this.formatTag=7;break;default:s=!1}if(this.bitsPerSample=t,this.samplesPerSec=e,this.channels=i,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),s){this.privHeader=new ArrayBuffer(44);const e=new DataView(this.privHeader);this.setString(e,0,"RIFF"),e.setUint32(4,0,!0),this.setString(e,8,"WAVEfmt "),e.setUint32(16,16,!0),e.setUint16(20,this.formatTag,!0),e.setUint16(22,this.channels,!0),e.setUint32(24,this.samplesPerSec,!0),e.setUint32(28,this.avgBytesPerSec,!0),e.setUint16(32,this.channels*(this.bitsPerSample/8),!0),e.setUint16(34,this.bitsPerSample,!0),this.setString(e,36,"data"),e.setUint32(40,0,!0)}}static getDefaultInputFormat(){return new s}static getAudioContext(e){const t=window.AudioContext||window.webkitAudioContext||!1;if(t)return void 0!==e&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new t({sampleRate:e}):new t;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}setString(e,t,i){for(let r=0;r<i.length;r++)e.setUint8(t+r,i.charCodeAt(r))}}},259:(e,t,i)=>{"use strict";i.d(t,{I:()=>s});var r=i(80491),n=i(83895);class s{constructor(e){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,void 0===e&&(e=n.HT.getDefaultInputFormat()),this.init(e)}playAudioSample(e,t,i){try{this.ensureInitializedContext();const i=this.formatAudioData(e),r=new Float32Array(this.samples.length+i.length);r.set(this.samples,0),r.set(i,this.samples.length),this.samples=r,t&&t()}catch(e){i&&i(e)}}stopAudio(e,t){null!==this.audioContext&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close().then((()=>{e&&e()}),(e=>{t&&t(e)})),this.audioContext=null)}init(e){this.audioFormat=e,this.samples=new Float32Array}ensureInitializedContext(){if(null===this.audioContext){this.createAudioContext();const e=200;this.autoUpdateBufferTimer=setInterval((()=>{this.updateAudioBuffer()}),e)}}createAudioContext(){this.audioContext=n.Bm.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime}formatAudioData(e){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(e),128);case 16:return this.formatArrayBuffer(new Int16Array(e),32768);case 32:return this.formatArrayBuffer(new Int32Array(e),2147483648);default:throw new r.$2("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}formatArrayBuffer(e,t){const i=new Float32Array(e.length);for(let r=0;r<e.length;r++)i[r]=e[r]/t;return i}updateAudioBuffer(){if(0===this.samples.length)return;const e=this.audioFormat.channels,t=this.audioContext.createBufferSource(),i=this.samples.length/e,r=this.audioContext.createBuffer(e,i,this.audioFormat.samplesPerSec);for(let t=0;t<e;t++){let i=t;const n=r.getChannelData(t);for(let t=0;t<this.samples.length;t++,i+=e)n[t]=this.samples[i]}this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),t.buffer=r,t.connect(this.gainNode),t.start(this.startTime),this.startTime+=r.duration,this.samples=new Float32Array}playAudio(e){return t=this,i=void 0,n=function*(){null===this.audioContext&&this.createAudioContext();const t=this.audioContext.createBufferSource(),i=this.audioContext.destination;yield this.audioContext.decodeAudioData(e,(e=>{t.buffer=e,t.connect(i),t.start(0)}))},new((r=void 0)||(r=Promise))((function(e,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof r?i:new r((function(e){e(i)}))).then(o,a)}c((n=n.apply(t,i||[])).next())}));var t,i,r,n}}},44692:(e,t,i)=>{"use strict";i.d(t,{W:()=>r});class r{}},63946:(e,t,i)=>{"use strict";i.d(t,{y:()=>r});class r{}},59576:(e,t,i)=>{"use strict";i.d(t,{K:()=>u});var r=i(57895),n=i(25487),s=i(3625),o=i(59187),a=i(1912),c=i(83895),p=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};const h={[c.WY.PCM]:"audio/wav",[c.WY.MuLaw]:"audio/x-wav",[c.WY.MP3]:"audio/mpeg",[c.WY.OGG_OPUS]:"audio/ogg",[c.WY.WEBM_OPUS]:"audio/webm; codecs=opus",[c.WY.ALaw]:"audio/x-wav",[c.WY.FLAC]:"audio/flac"};class u{constructor(e){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=e||(0,n.Q)(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(e,t,i){void 0!==this.privAudioBuffer?(this.privAudioBuffer.push(e),this.updateSourceBuffer().then((()=>{t&&t()}),(e=>{i&&i(e)}))):void 0!==this.privAudioOutputStream&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength)}close(e,t){if(this.privIsClosed=!0,void 0!==this.privSourceBuffer)this.handleSourceBufferUpdateEnd().then((()=>{e&&e()}),(e=>{t&&t(e)}));else if(void 0!==this.privAudioOutputStream&&"undefined"!=typeof window)if(this.privFormat.formatTag!==c.WY.PCM&&this.privFormat.formatTag!==c.WY.MuLaw&&this.privFormat.formatTag!==c.WY.ALaw||!1!==this.privFormat.hasHeader){let i=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(i).then((()=>{i=r.E.addHeader(i,this.privFormat);const n=new Blob([i],{type:h[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(n),this.notifyPlayback().then((()=>{e&&e()}),(e=>{t&&t(e)}))}),(e=>{t&&t(e)}))}else console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else this.onAudioEnd&&this.onAudioEnd(this)}set format(e){if("undefined"!=typeof AudioContext||"undefined"!=typeof window&&void 0!==window.webkitAudioContext){this.privFormat=e;const t=h[this.privFormat.formatTag];void 0===t?console.warn(`Unknown mimeType for format ${c.WY[this.privFormat.formatTag]}; playback is not supported.`):"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported(t)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=()=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=1800,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(t),this.privSourceBuffer.onupdate=()=>{this.updateSourceBuffer().catch((e=>{s.z.instance.onEvent(new o.u(e))}))},this.privSourceBuffer.onupdateend=()=>{this.handleSourceBufferUpdateEnd().catch((e=>{s.z.instance.onEvent(new o.u(e))}))},this.privSourceBuffer.onupdatestart=()=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch((e=>{s.z.instance.onEvent(new o.u(e))}))):(console.warn(`Format ${c.WY[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new a.NO,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get volume(){var e,t;return null!==(t=null===(e=this.privAudio)||void 0===e?void 0:e.volume)&&void 0!==t?t:-1}set volume(e){this.privAudio&&(this.privAudio.volume=e)}mute(){this.privAudio&&(this.privAudio.muted=!0)}unmute(){this.privAudio&&(this.privAudio.muted=!1)}get isClosed(){return this.privIsClosed}get currentTime(){return void 0!==this.privAudio?this.privAudio.currentTime:-1}pause(){this.privIsPaused||void 0===this.privAudio||(this.privAudio.pause(),this.privIsPaused=!0)}resume(e,t){this.privIsPaused&&void 0!==this.privAudio&&(this.privAudio.play().then((()=>{e&&e()}),(e=>{t&&t(e)})),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}updateSourceBuffer(){return p(this,void 0,void 0,(function*(){if(void 0!==this.privAudioBuffer&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;const e=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(e)}catch(t){return this.privAudioBuffer.unshift(e),void console.log("buffer filled, pausing addition of binaries until space is made")}yield this.notifyPlayback()}else this.canEndStream()&&(yield this.handleSourceBufferUpdateEnd())}))}handleSourceBufferUpdateEnd(){return p(this,void 0,void 0,(function*(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),yield this.notifyPlayback())}))}notifyPlayback(){return p(this,void 0,void 0,(function*(){this.privPlaybackStarted||void 0===this.privAudio||(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||(yield this.privAudio.play()))}))}canEndStream(){return this.isClosed&&void 0!==this.privSourceBuffer&&0===this.privAudioBuffer.length&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&"open"===this.privMediaSource.readyState}sourceBufferAvailable(){return void 0!==this.privSourceBuffer&&!this.privSourceBuffer.updating}}},26217:(e,t,i)=>{"use strict";i.d(t,{G:()=>c});var r=i(62389),n=i(89513),s=i(22874),o=i(65453),a=i(39828);class c{constructor(){this.privProperties=new s.O,this.privProperties.setProperty(o.o.SpeechServiceConnection_LanguageIdMode,"AtStart"),this.privLanguageIdMode=a.b.AtStart}static fromOpenRange(){const e=new c;return e.properties.setProperty(o.o.SpeechServiceConnection_AutoDetectSourceLanguages,r.AutoDetectSourceLanguagesOpenRangeOptionName),e}static fromLanguages(e){n.a.throwIfArrayEmptyOrWhitespace(e,"languages");const t=new c;return t.properties.setProperty(o.o.SpeechServiceConnection_AutoDetectSourceLanguages,e.join()),t}static fromSourceLanguageConfigs(e){if(e.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");const t=new c,i=[];return e.forEach((e=>{if(i.push(e.language),void 0!==e.endpointId&&""!==e.endpointId){const i=e.language+o.o.SpeechServiceConnection_EndpointId.toString();t.properties.setProperty(i,e.endpointId)}})),t.properties.setProperty(o.o.SpeechServiceConnection_AutoDetectSourceLanguages,i.join()),t}get properties(){return this.privProperties}set mode(e){e===a.b.Continuous?(this.privProperties.setProperty(o.o.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privProperties.setProperty(o.o.SpeechServiceConnection_LanguageIdMode,"Continuous")):(this.privProperties.setProperty(o.o.SpeechServiceConnection_RecognitionEndpointVersion,"1"),this.privProperties.setProperty(o.o.SpeechServiceConnection_LanguageIdMode,"AtStart")),this.privLanguageIdMode=e}}},47087:(e,t,i)=>{"use strict";i.d(t,{$:()=>n});var r=i(89513);class n{constructor(e,t){r.a.throwIfNullOrUndefined(e,"language"),r.a.throwIfNullOrUndefined(t,"languageDetectionConfidence"),this.privLanguage=e,this.privLanguageDetectionConfidence=t}static fromResult(e){return new n(e.language,e.languageDetectionConfidence)}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}}},95314:(e,t,i)=>{"use strict";i.d(t,{O:()=>o});var r=i(89513),n=i(34751),s=i(65453);class o extends n.I{constructor(){super()}static fromSubscription(e,t,i){r.a.throwIfNullOrWhitespace(e,"subscription"),r.a.throwIfNullOrWhitespace(t,"region");const o=new n.I;return o.setProperty(s.o.Conversation_DialogType,n.E.DialogTypes.BotFramework),o.setProperty(s.o.SpeechServiceConnection_Key,e),o.setProperty(s.o.SpeechServiceConnection_Region,t),i&&o.setProperty(s.o.Conversation_ApplicationId,i),o}static fromAuthorizationToken(e,t,i){r.a.throwIfNullOrWhitespace(e,"authorizationToken"),r.a.throwIfNullOrWhitespace(t,"region");const o=new n.I;return o.setProperty(s.o.Conversation_DialogType,n.E.DialogTypes.BotFramework),o.setProperty(s.o.SpeechServiceAuthorization_Token,e),o.setProperty(s.o.SpeechServiceConnection_Region,t),i&&o.setProperty(s.o.Conversation_ApplicationId,i),o}static fromHost(e,t,i){r.a.throwIfNullOrUndefined(e,"host");const o=e instanceof URL?e:new URL(`wss://${e}.convai.speech.azure.us`);r.a.throwIfNullOrUndefined(o,"resolvedHost");const a=new n.I;return a.setProperty(s.o.Conversation_DialogType,n.E.DialogTypes.BotFramework),a.setProperty(s.o.SpeechServiceConnection_Host,o.toString()),void 0!==t&&a.setProperty(s.o.SpeechServiceConnection_Key,t),a}static fromEndpoint(e,t){r.a.throwIfNull(e,"endpoint");const i=new n.I;return i.setProperty(s.o.Conversation_DialogType,n.E.DialogTypes.BotFramework),i.setProperty(s.o.SpeechServiceConnection_Endpoint,e.toString()),void 0!==t&&i.setProperty(s.o.SpeechServiceConnection_Key,t),i}}},45777:(e,t,i)=>{"use strict";i.d(t,{E:()=>h});var r=i(22436),n=i(51054),s=i(62389),o=i(59654),a=i(6550),c=i(98563),p=i(93260);class h extends o.v{constructor(e,t,i){super(e,t,i)}static fromResult(e){let t=a._.Error,i=c.E.NoError;if(e instanceof p.p&&e.json){const i=r.n.fromJSON(e.json);t=n.o.implTranslateCancelResult(i.RecognitionStatus)}return e.properties&&(i=c.E[e.properties.getProperty(s.CancellationErrorCodePropertyName,c.E[c.E.NoError])]),new h(t,e.errorDetails||n.o.implTranslateErrorDetails(i),i)}}},59654:(e,t,i)=>{"use strict";i.d(t,{v:()=>r});class r{constructor(e,t,i){this.privReason=e,this.privErrorDetails=t,this.privErrorCode=i}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}}},98563:(e,t,i)=>{"use strict";var r;i.d(t,{E:()=>r}),function(e){e[e.NoError=0]="NoError",e[e.AuthenticationFailure=1]="AuthenticationFailure",e[e.BadRequestParameters=2]="BadRequestParameters",e[e.TooManyRequests=3]="TooManyRequests",e[e.ConnectionFailure=4]="ConnectionFailure",e[e.ServiceTimeout=5]="ServiceTimeout",e[e.ServiceError=6]="ServiceError",e[e.RuntimeError=7]="RuntimeError",e[e.Forbidden=8]="Forbidden"}(r||(r={}))},18106:(e,t,i)=>{"use strict";i.d(t,{w:()=>n});var r=i(99801);class n extends r.J{constructor(e,t,i,r,n){super(r,n),this.privReason=e,this.privErrorDetails=t,this.privErrorCode=i}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}},6550:(e,t,i)=>{"use strict";var r;i.d(t,{_:()=>r}),function(e){e[e.Error=0]="Error",e[e.EndOfStream=1]="EndOfStream"}(r||(r={}))},53333:(e,t,i)=>{"use strict";i.d(t,{e:()=>u});var r=i(57895),n=i(47916),s=i(33182),o=i(38433),a=i(89513),c=i(69338),p=i(9342),h=i(60576);class u{static fromRecognizer(e){const t=e.internalData,i=new u;return i.privInternalData=t,i.setupEvents(),i}static fromSynthesizer(e){const t=e.internalData,i=new u;return i.privInternalData=t,i.setupEvents(),i}openConnection(e,t){(0,s.Kb)(this.privInternalData.connect(),e,t)}closeConnection(e,t){if(this.privInternalData instanceof r.E)throw new Error("Disconnecting a synthesizer's connection is currently not supported");(0,s.Kb)(this.privInternalData.disconnect(),e,t)}setMessageProperty(e,t,i){if(a.a.throwIfNullOrWhitespace(t,"propertyName"),this.privInternalData instanceof n.q){if("speech.context"!==e.toLowerCase())throw new Error("Only speech.context message property sets are currently supported for recognizer");this.privInternalData.speechContext.setSection(t,i)}else if(this.privInternalData instanceof r.E){if("synthesis.context"!==e.toLowerCase())throw new Error("Only synthesis.context message property sets are currently supported for synthesizer");this.privInternalData.synthesisContext.setSection(t,i)}}sendMessageAsync(e,t,i,r){(0,s.Kb)(this.privInternalData.sendNetworkMessage(e,t),i,r)}close(){}setupEvents(){this.privEventListener=this.privInternalData.connectionEvents.attach((e=>{"ConnectionEstablishedEvent"===e.name?this.connected&&this.connected(new c.R(e.connectionId)):"ConnectionClosedEvent"===e.name?this.disconnected&&this.disconnected(new c.R(e.connectionId)):"ConnectionMessageSentEvent"===e.name?this.messageSent&&this.messageSent(new p.b(new o.k(e.message))):"ConnectionMessageReceivedEvent"===e.name&&this.messageReceived&&this.messageReceived(new p.b(new o.k(e.message)))})),this.privServiceEventListener=this.privInternalData.serviceEvents.attach((e=>{this.receivedServiceMessage&&this.receivedServiceMessage(new h.$(e.jsonString,e.name))}))}}},69338:(e,t,i)=>{"use strict";i.d(t,{R:()=>n});var r=i(7841);class n extends r.${}},38433:(e,t,i)=>{"use strict";i.d(t,{H:()=>a,k:()=>c});var r=i(84257),n=i(66645),s=i(22874),o=i(65453);class a{}class c{constructor(e){this.privConnectionMessage=e,this.privProperties=new s.O,this.privConnectionMessage.headers[r.S.ConnectionId]&&this.privProperties.setProperty(o.o.Speech_SessionId,this.privConnectionMessage.headers[r.S.ConnectionId]),Object.keys(this.privConnectionMessage.headers).forEach((e=>{this.privProperties.setProperty(e,this.privConnectionMessage.headers[e])}))}get path(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find((e=>e.toLowerCase()==="path".toLowerCase()))]}get isTextMessage(){return this.privConnectionMessage.messageType===n.C.Text}get isBinaryMessage(){return this.privConnectionMessage.messageType===n.C.Binary}get TextMessage(){return this.privConnectionMessage.textBody}get binaryMessage(){return this.privConnectionMessage.binaryBody}get properties(){return this.privProperties}toString(){return""}}},9342:(e,t,i)=>{"use strict";i.d(t,{b:()=>r});class r{constructor(e){this.privConnectionMessage=e}get message(){return this.privConnectionMessage}toString(){return"Message: "+this.privConnectionMessage.toString()}}},89513:(e,t,i)=>{"use strict";i.d(t,{a:()=>r});class r{static throwIfNullOrUndefined(e,t){if(null==e)throw new Error("throwIfNullOrUndefined:"+t)}static throwIfNull(e,t){if(null===e)throw new Error("throwIfNull:"+t)}static throwIfNullOrWhitespace(e,t){if(r.throwIfNullOrUndefined(e,t),(""+e).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+t)}static throwIfNullOrTooLong(e,t,i){if(r.throwIfNullOrUndefined(e,t),(""+e).length>i)throw new Error("throwIfNullOrTooLong:"+t+" (more than "+i.toString()+" characters)")}static throwIfNullOrTooShort(e,t,i){if(r.throwIfNullOrUndefined(e,t),(""+e).length<i)throw new Error("throwIfNullOrTooShort:"+t+" (less than "+i.toString()+" characters)")}static throwIfDisposed(e){if(e)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(e,t){if(r.throwIfNullOrUndefined(e,t),0===e.length)throw new Error("throwIfArrayEmptyOrWhitespace:"+t);for(const i of e)r.throwIfNullOrWhitespace(i,t)}static throwIfFileDoesNotExist(e,t){r.throwIfNullOrWhitespace(e,t)}static throwIfNotUndefined(e,t){if(void 0!==e)throw new Error("throwIfNotUndefined:"+t)}}},66362:(e,t,i)=>{"use strict";i.d(t,{n:()=>n});var r=i(18106);class n extends r.w{}},13676:(e,t,i)=>{"use strict";i.d(t,{X:()=>o});var r=i(89513),n=i(34751),s=i(65453);class o extends n.I{constructor(){super()}static fromSubscription(e,t,i){r.a.throwIfNullOrWhitespace(e,"applicationId"),r.a.throwIfNullOrWhitespace(t,"subscription"),r.a.throwIfNullOrWhitespace(i,"region");const o=new n.I;return o.setProperty(s.o.Conversation_DialogType,n.E.DialogTypes.CustomCommands),o.setProperty(s.o.Conversation_ApplicationId,e),o.setProperty(s.o.SpeechServiceConnection_Key,t),o.setProperty(s.o.SpeechServiceConnection_Region,i),o}static fromAuthorizationToken(e,t,i){r.a.throwIfNullOrWhitespace(e,"applicationId"),r.a.throwIfNullOrWhitespace(t,"authorizationToken"),r.a.throwIfNullOrWhitespace(i,"region");const o=new n.I;return o.setProperty(s.o.Conversation_DialogType,n.E.DialogTypes.CustomCommands),o.setProperty(s.o.Conversation_ApplicationId,e),o.setProperty(s.o.SpeechServiceAuthorization_Token,t),o.setProperty(s.o.SpeechServiceConnection_Region,i),o}set applicationId(e){r.a.throwIfNullOrWhitespace(e,"value"),this.setProperty(s.o.Conversation_ApplicationId,e)}get applicationId(){return this.getProperty(s.o.Conversation_ApplicationId)}}},47494:(e,t,i)=>{"use strict";i.d(t,{g:()=>s});var r=i(27845),n=i(3625);class s{static SetLoggingLevel(e){this.privListener=new r.x(e),n.z.instance.attachConsoleListener(this.privListener)}static StartConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!0)}static StopConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!1)}static SetLogOutputPath(e){if("undefined"!=typeof window)throw new Error("File system logging not available in browser.");this.privListener&&(this.privListener.logPath=e)}}s.privListener=void 0},34751:(e,t,i)=>{"use strict";i.d(t,{E:()=>o,I:()=>a});var r=i(89513),n=i(60843),s=i(65453);class o{constructor(){}set applicationId(e){}static get DialogTypes(){return{BotFramework:"bot_framework",CustomCommands:"custom_commands"}}}class a extends o{constructor(){super(),this.privSpeechConfig=new n.z}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(e){r.a.throwIfNullOrWhitespace(e,"value"),this.privSpeechConfig.speechRecognitionLanguage=e}get outputFormat(){return this.privSpeechConfig.outputFormat}set outputFormat(e){this.privSpeechConfig.outputFormat=e}setProperty(e,t){this.privSpeechConfig.setProperty(e,t)}getProperty(e,t){return this.privSpeechConfig.getProperty(e)}setProxy(e,t,i,r){this.setProperty(s.o.SpeechServiceConnection_ProxyHostName,e),this.setProperty(s.o.SpeechServiceConnection_ProxyPort,`${t}`),i&&this.setProperty(s.o.SpeechServiceConnection_ProxyUserName,i),r&&this.setProperty(s.o.SpeechServiceConnection_ProxyPassword,r)}setServiceProperty(e,t,i){this.privSpeechConfig.setServiceProperty(e,t)}close(){}}},26227:(e,t,i)=>{"use strict";i.d(t,{U:()=>u});var r=i(30467),n=i(62029),s=i(40267),o=i(33182),a=i(89513),c=i(44571),p=i(65453),h=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class u extends c.c{constructor(e,t){const i=e;a.a.throwIfNull(e,"dialogConfig"),super(t,i.properties,new r.H),this.isTurnComplete=!0,this.privIsDisposed=!1,this.privProperties=i.properties.clone();const n=this.buildAgentConfig();this.privReco.agentConfig.set(n)}connect(e,t){(0,o.Kb)(this.privReco.connect(),e,t)}disconnect(e,t){(0,o.Kb)(this.privReco.disconnect(),e,t)}get authorizationToken(){return this.properties.getProperty(p.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){a.a.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(p.o.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}get speechActivityTemplate(){return this.properties.getProperty(p.o.Conversation_Speech_Activity_Template)}set speechActivityTemplate(e){this.properties.setProperty(p.o.Conversation_Speech_Activity_Template,e)}listenOnceAsync(e,t){if(this.isTurnComplete){a.a.throwIfDisposed(this.privIsDisposed);const i=(()=>h(this,void 0,void 0,(function*(){yield this.privReco.connect(),yield this.implRecognizerStop(),this.isTurnComplete=!1;const e=new o.BH;yield this.privReco.recognize(n.jf.Conversation,e.resolve,e.reject);const t=yield e.promise;return yield this.implRecognizerStop(),t})))();i.catch((()=>{this.dispose(!0).catch((()=>{}))})),(0,o.Kb)(i.finally((()=>{this.isTurnComplete=!0})),e,t)}}sendActivityAsync(e,t,i){(0,o.Kb)(this.privReco.sendMessage(e),t,i)}close(e,t){a.a.throwIfDisposed(this.privIsDisposed),(0,o.Kb)(this.dispose(!0),e,t)}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return h(this,void 0,void 0,(function*(){this.privIsDisposed||e&&(this.privIsDisposed=!0,yield this.implRecognizerStop(),yield t.dispose.call(this,e))}))}createRecognizerConfig(e){return new n.Xj(e,this.privProperties)}createServiceRecognizer(e,t,i,r){const n=i;return new s.C(e,t,n,r,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(p.o.Conversation_Agent_Connection_Id),conversationId:this.properties.getProperty(p.o.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(p.o.Conversation_From_Id,void 0),ttsAudioFormat:this.properties.getProperty(p.o.SpeechServiceConnection_SynthOutputFormat,void 0)},version:.2}}}},31223:(e,t,i)=>{"use strict";i.d(t,{$9:()=>H.$,$u:()=>u.$,$y:()=>le.$,AE:()=>oe.A,AR:()=>Ee.A,Ai:()=>Ue.A,Ao:()=>o.Ao,Bv:()=>_.B,D1:()=>Ce.D,E1:()=>K.E,EG:()=>F.E,Fu:()=>x.F,G3:()=>de.G,G7:()=>xe.G,Gd:()=>ce.G,HT:()=>n.HT,Hg:()=>re.H,IX:()=>V.E,Im:()=>Me.I,Iq:()=>te.I,J4:()=>o.J4,Ji:()=>d.J,Kc:()=>_e.K,LA:()=>ne.L,MO:()=>we.M,Mf:()=>ve.M,Mt:()=>M.M,OT:()=>G.O,Om:()=>oe.O,On:()=>h.O,Oo:()=>E.O,Oq:()=>ye.O,P6:()=>ke.P,PH:()=>ee.P,Pg:()=>S.P,Qc:()=>Ie.Q,Qt:()=>Z.Q,R$:()=>Le.R$,RE:()=>W.R,Sb:()=>I.S,TJ:()=>Se.T,To:()=>Ae.T,UO:()=>ae.U,Ud:()=>Y.U,VM:()=>Ke.V,Vi:()=>ue.V,W0:()=>c.W,WJ:()=>l.W,WY:()=>n.WY,XO:()=>o.XO,XY:()=>$.X,Yo:()=>Te.Y,Yw:()=>J.Y,ZT:()=>s.ZT,_B:()=>a._,_m:()=>Re._,a7:()=>X.a,an:()=>be.a,bK:()=>ie.b,bT:()=>We.b,bi:()=>Pe.b,by:()=>m.b,c2:()=>Ne.c,cG:()=>N.c,c_:()=>T.c,dz:()=>y.d,ew:()=>j.e,f$:()=>b.f,f7:()=>qe.f,fQ:()=>Fe.f,fR:()=>se.f,fw:()=>O.f,gH:()=>he.g,gd:()=>He.g,h0:()=>v.h,hY:()=>pe.h,iB:()=>fe.i,iT:()=>De.i,in:()=>je.t,iy:()=>f.i,j9:()=>B.j,jA:()=>z.Z,kq:()=>ze.k,kv:()=>s.kv,l5:()=>ge.l5,m5:()=>b.m,mr:()=>y.m,n5:()=>Ie.n,nn:()=>C.n,np:()=>Be.n,oX:()=>k.o,pN:()=>g.p,p_:()=>D.p,pe:()=>L.p,r2:()=>ge.r2,rU:()=>r.rU,r_:()=>P.r,ri:()=>me.C,sL:()=>A.s,sk:()=>se.s,so:()=>w.s,uH:()=>ge.uH,v4:()=>q.v,vK:()=>R.v,vV:()=>Q.v,vs:()=>U.v,wY:()=>Oe.w,y9:()=>p.y,yk:()=>s.yk,zE:()=>T.z});var r=i(66e3),n=i(83895),s=i(80309),o=i(1912),a=i(6550),c=i(44692),p=i(63946),h=i(40302),u=i(7841),d=i(99801),l=i(88530),v=i(32209),g=i(93260),m=i(98670),f=i(30794),S=i(66086),y=i(53383),C=i(52438),w=i(93062),R=i(65250),P=i(43465),I=i(35890),A=i(91048),T=i(60843),b=i(77931),E=i(22874),k=i(65453),N=i(44571),x=i(84713),D=i(52149),O=i(38345),M=i(43078),z=i(40649),L=i(26201),_=i(19981),B=i(67762),q=i(42821),U=i(59654),F=i(45777),K=i(98563),W=i(69338),H=i(60576),j=i(53333),J=i(25523),V=i(34751),G=i(95314),$=i(13676),Y=i(26227),Q=i(33428),Z=i(27040),X=i(84466),ee=i(40731),te=i(259),ie=i(9342),re=i(38433),ne=i(725),se=i(93341),oe=i(62437),ae=i(97562),ce=i(50328),pe=i(91481),he=i(27954),ue=i(61044),de=i(26217),le=i(47087),ve=i(39017),ge=i(20888),me=i(15203),fe=i(454),Se=i(4225),ye=i(17469),Ce=i(52228),we=i(56523),Re=i(63897),Pe=i(52974),Ie=i(13250),Ae=i(97378),Te=i(92356),be=i(70635),Ee=i(73725),ke=i(71211),Ne=i(24974),xe=i(93491),De=i(93733),Oe=i(20002),Me=i(55325),ze=i(54079),Le=i(71520),_e=i(59576),Be=i(66362),qe=i(74943),Ue=i(81762),Fe=i(55266),Ke=i(381),We=i(39828),He=i(47494),je=i(14300)},42821:(e,t,i)=>{"use strict";i.d(t,{v:()=>n});var r=i(32209);class n extends r.h{constructor(e,t,i,r,n,s){super(r,n,s),this.privReason=e,this.privErrorDetails=t,this.privErrorCode=i}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}},32209:(e,t,i)=>{"use strict";i.d(t,{h:()=>n});var r=i(99801);class n extends r.J{constructor(e,t,i){super(t,i),this.privResult=e}get result(){return this.privResult}}},30794:(e,t,i)=>{"use strict";i.d(t,{i:()=>n});var r=i(98670);class n extends r.b{constructor(e,t,i,r,n,s,o,a,c,p,h){super(t,i,r,n,s,o,a,void 0,c,p,h),this.privIntentId=e}get intentId(){return this.privIntentId}}},52149:(e,t,i)=>{"use strict";i.d(t,{p:()=>u});var r=i(69638),n=i(62029),s=i(20358),o=i(41687),a=i(33182),c=i(89513),p=i(44571),h=i(65453);class u extends p.c{constructor(e,t){c.a.throwIfNullOrUndefined(e,"speechConfig");const i=e;c.a.throwIfNullOrUndefined(i,"speechConfig"),super(t,i.properties,new r.b),this.privAddedIntents=[],this.privAddedLmIntents={},this.privDisposedIntentRecognizer=!1,this.privProperties=i.properties,c.a.throwIfNullOrWhitespace(this.properties.getProperty(h.o.SpeechServiceConnection_RecoLanguage),h.o[h.o.SpeechServiceConnection_RecoLanguage])}get speechRecognitionLanguage(){return c.a.throwIfDisposed(this.privDisposedIntentRecognizer),this.properties.getProperty(h.o.SpeechServiceConnection_RecoLanguage)}get authorizationToken(){return this.properties.getProperty(h.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.properties.setProperty(h.o.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}recognizeOnceAsync(e,t){if(c.a.throwIfDisposed(this.privDisposedIntentRecognizer),0!==Object.keys(this.privAddedLmIntents).length||void 0!==this.privUmbrellaIntent){const e=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",e.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(e.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}(0,a.Kb)(this.recognizeOnceAsyncImpl(n.jf.Interactive),e,t)}startContinuousRecognitionAsync(e,t){if(0!==Object.keys(this.privAddedLmIntents).length||void 0!==this.privUmbrellaIntent){const e=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",e.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(e.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}(0,a.Kb)(this.startContinuousRecognitionAsyncImpl(n.jf.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){(0,a.Kb)(this.stopContinuousRecognitionAsyncImpl(),e,t)}startKeywordRecognitionAsync(e,t,i){c.a.throwIfNull(e,"model"),i&&i("Not yet implemented.")}stopKeywordRecognitionAsync(e,t){if(e)try{e()}catch(e){t&&t(e)}}addIntent(e,t){c.a.throwIfDisposed(this.privDisposedIntentRecognizer),c.a.throwIfNullOrWhitespace(t,"intentId"),c.a.throwIfNullOrWhitespace(e,"simplePhrase"),this.privAddedIntents.push([t,e])}addIntentWithLanguageModel(e,t,i){c.a.throwIfDisposed(this.privDisposedIntentRecognizer),c.a.throwIfNullOrWhitespace(e,"intentId"),c.a.throwIfNull(t,"model");const r=t;c.a.throwIfNullOrWhitespace(r.appId,"model.appId"),this.privAddedLmIntents[e]=new s.w(r,i)}addAllIntents(e,t){c.a.throwIfNull(e,"model");const i=e;c.a.throwIfNullOrWhitespace(i.appId,"model.appId"),this.privUmbrellaIntent=new s.w(i,t)}close(e,t){c.a.throwIfDisposed(this.privDisposedIntentRecognizer),(0,a.Kb)(this.dispose(!0),e,t)}createRecognizerConfig(e){return new n.Xj(e,this.privProperties)}createServiceRecognizer(e,t,i,r){const n=i;return new o.O(e,t,n,r,this)}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return i=this,r=void 0,s=function*(){this.privDisposedIntentRecognizer||e&&(this.privDisposedIntentRecognizer=!0,yield t.dispose.call(this,e))},new((n=void 0)||(n=Promise))((function(e,t){function o(e){try{c(s.next(e))}catch(e){t(e)}}function a(e){try{c(s.throw(e))}catch(e){t(e)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(o,a)}c((s=s.apply(i,r||[])).next())}));var i,r,n,s}buildSpeechContext(){let e,t,i;const r=[];void 0!==this.privUmbrellaIntent&&(e=this.privUmbrellaIntent.modelImpl.appId,t=this.privUmbrellaIntent.modelImpl.region,i=this.privUmbrellaIntent.modelImpl.subscriptionKey);for(const n of Object.keys(this.privAddedLmIntents)){const s=this.privAddedLmIntents[n];if(void 0===e)e=s.modelImpl.appId;else if(e!==s.modelImpl.appId)throw new Error("Intents must all be from the same LUIS model");if(void 0===t)t=s.modelImpl.region;else if(t!==s.modelImpl.region)throw new Error("Intents must all be from the same LUIS model in a single region");if(void 0===i)i=s.modelImpl.subscriptionKey;else if(i!==s.modelImpl.subscriptionKey)throw new Error("Intents must all use the same subscription key");const o="luis/"+e+"-PRODUCTION#"+n;r.push(o)}return{Intent:{id:e,key:void 0===i?this.privProperties.getProperty(h.o[h.o.SpeechServiceConnection_Key]):i,provider:"LUIS"},ReferenceGrammars:void 0===this.privUmbrellaIntent?r:["luis/"+e+"-PRODUCTION"]}}}},40302:(e,t,i)=>{"use strict";i.d(t,{O:()=>n});var r=i(89513);class n{constructor(){this.privDisposed=!1}static fromFile(e){throw r.a.throwIfFileDoesNotExist(e,"fileName"),new Error("Not yet implemented.")}static fromStream(e){throw r.a.throwIfNull(e,"file"),new Error("Not yet implemented.")}close(){this.privDisposed||(this.privDisposed=!0)}}},39828:(e,t,i)=>{"use strict";var r;i.d(t,{b:()=>r}),function(e){e[e.AtStart=0]="AtStart",e[e.Continuous=1]="Continuous"}(r||(r={}))},66086:(e,t,i)=>{"use strict";i.d(t,{P:()=>n});var r=i(89513);class n{constructor(){}static fromEndpoint(e){r.a.throwIfNull(e,"uri"),r.a.throwIfNullOrWhitespace(e.hostname,"uri");const t=new s,i=e.host.indexOf(".");if(-1===i)throw new Error("Could not determine region from endpoint");t.region=e.host.substr(0,i);const n=e.pathname.lastIndexOf("/")+1;if(-1===n)throw new Error("Could not determine appId from endpoint");if(t.appId=e.pathname.substr(n),t.subscriptionKey=e.searchParams.get("subscription-key"),void 0===t.subscriptionKey)throw new Error("Could not determine subscription key from endpoint");return t}static fromAppId(e){r.a.throwIfNullOrWhitespace(e,"appId");const t=new s;return t.appId=e,t}static fromSubscription(e,t,i){r.a.throwIfNullOrWhitespace(e,"subscriptionKey"),r.a.throwIfNullOrWhitespace(t,"appId"),r.a.throwIfNullOrWhitespace(i,"region");const n=new s;return n.appId=t,n.region=i,n.subscriptionKey=e,n}}class s extends n{}},19981:(e,t,i)=>{"use strict";i.d(t,{B:()=>o});var r=i(22436),n=i(47297),s=i(26201);class o{constructor(e){this.privReason=e}static fromResult(e){const t=r.n.fromJSON(e.json);let i=s.p.NotRecognized;switch(t.RecognitionStatus){case n.T.BabbleTimeout:i=s.p.InitialBabbleTimeout;break;case n.T.InitialSilenceTimeout:i=s.p.InitialSilenceTimeout;break;default:i=s.p.NotRecognized}return new o(i)}get reason(){return this.privReason}}},26201:(e,t,i)=>{"use strict";var r;i.d(t,{p:()=>r}),function(e){e[e.NotRecognized=0]="NotRecognized",e[e.InitialSilenceTimeout=1]="InitialSilenceTimeout",e[e.InitialBabbleTimeout=2]="InitialBabbleTimeout"}(r||(r={}))},88530:(e,t,i)=>{"use strict";var r;i.d(t,{W:()=>r}),function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"}(r||(r={}))},25523:(e,t,i)=>{"use strict";i.d(t,{Y:()=>r});class r{constructor(e){this.privGrammerBuilder=e.dynamicGrammar}static fromRecognizer(e){const t=e.internalData;return new r(t)}addPhrase(e){this.privGrammerBuilder.addPhrase(e)}addPhrases(e){this.privGrammerBuilder.addPhrase(e)}clear(){this.privGrammerBuilder.clearPhrases()}}},40731:(e,t,i)=>{"use strict";var r;i.d(t,{P:()=>r}),function(e){e[e.Masked=0]="Masked",e[e.Removed=1]="Removed",e[e.Raw=2]="Raw"}(r||(r={}))},55266:(e,t,i)=>{"use strict";i.d(t,{f:()=>c});var r=i(89513),n=i(74943),s=i(81762),o=i(22874),a=i(65453);class c{constructor(e,t=n.f.FivePoint,i=s.A.Phoneme,c=!1){r.a.throwIfNullOrUndefined(e,"referenceText"),this.privProperties=new o.O,this.privProperties.setProperty(a.o.PronunciationAssessment_ReferenceText,e),this.privProperties.setProperty(a.o.PronunciationAssessment_GradingSystem,n.f[t]),this.privProperties.setProperty(a.o.PronunciationAssessment_Granularity,s.A[i]),this.privProperties.setProperty(a.o.PronunciationAssessment_EnableMiscue,String(c))}static fromJSON(e){r.a.throwIfNullOrUndefined(e,"json");const t=new c("");return t.privProperties=new o.O,t.properties.setProperty(a.o.PronunciationAssessment_Json,e),t}toJSON(){return this.updateJson(),this.privProperties.getProperty(a.o.PronunciationAssessment_Params)}applyTo(e){this.updateJson(),e.internalData.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(a.o.PronunciationAssessment_Params))}get referenceText(){return this.properties.getProperty(a.o.PronunciationAssessment_ReferenceText)}set referenceText(e){r.a.throwIfNullOrWhitespace(e,"referenceText"),this.properties.setProperty(a.o.PronunciationAssessment_ReferenceText,e)}set phonemeAlphabet(e){r.a.throwIfNullOrWhitespace(e,"phonemeAlphabet"),this.privPhonemeAlphabet=e}set enableMiscue(e){const t=e?"true":"false";this.properties.setProperty(a.o.PronunciationAssessment_EnableMiscue,t)}get enableMiscue(){return"true"===this.properties.getProperty(a.o.PronunciationAssessment_EnableMiscue,"false").toLowerCase()}set nbestPhonemeCount(e){this.privNBestPhonemeCount=e}get properties(){return this.privProperties}updateJson(){const e=this.privProperties.getProperty(a.o.PronunciationAssessment_Json,"{}"),t=JSON.parse(e),i=this.privProperties.getProperty(a.o.PronunciationAssessment_ReferenceText);i&&(t.referenceText=i);const r=this.privProperties.getProperty(a.o.PronunciationAssessment_GradingSystem);r&&(t.gradingSystem=r);const n=this.privProperties.getProperty(a.o.PronunciationAssessment_Granularity);n&&(t.granularity=n),this.privPhonemeAlphabet&&(t.phonemeAlphabet=this.privPhonemeAlphabet),this.privNBestPhonemeCount&&(t.nbestPhonemeCount=this.privNBestPhonemeCount),t.dimension="Comprehensive",t.enableMiscue=this.enableMiscue,this.privProperties.setProperty(a.o.PronunciationAssessment_Params,JSON.stringify(t))}}},74943:(e,t,i)=>{"use strict";var r;i.d(t,{f:()=>r}),function(e){e[e.FivePoint=1]="FivePoint",e[e.HundredMark=2]="HundredMark"}(r||(r={}))},81762:(e,t,i)=>{"use strict";var r;i.d(t,{A:()=>r}),function(e){e[e.Phoneme=1]="Phoneme",e[e.Word=2]="Word",e[e.FullText=3]="FullText"}(r||(r={}))},381:(e,t,i)=>{"use strict";i.d(t,{V:()=>s});var r=i(89513),n=i(65453);class s{constructor(e){const t=JSON.parse(e);r.a.throwIfNullOrUndefined(t.NBest[0],"NBest"),this.privPronJson=t.NBest[0]}static fromResult(e){r.a.throwIfNullOrUndefined(e,"result");const t=e.properties.getProperty(n.o.SpeechServiceResponse_JsonResult);return r.a.throwIfNullOrUndefined(t,"json"),new s(t)}get detailResult(){return this.privPronJson}get accuracyScore(){return this.detailResult.PronunciationAssessment.AccuracyScore}get pronunciationScore(){return this.detailResult.PronunciationAssessment.PronScore}get completenessScore(){return this.detailResult.PronunciationAssessment.CompletenessScore}get fluencyScore(){return this.detailResult.PronunciationAssessment.FluencyScore}}},22874:(e,t,i)=>{"use strict";i.d(t,{O:()=>n});var r=i(65453);class n{constructor(){this.privKeys=[],this.privValues=[]}getProperty(e,t){let i;i="string"==typeof e?e:r.o[e];for(let e=0;e<this.privKeys.length;e++)if(this.privKeys[e]===i)return this.privValues[e];if(void 0!==t)return String(t)}setProperty(e,t){let i;i="string"==typeof e?e:r.o[e];for(let e=0;e<this.privKeys.length;e++)if(this.privKeys[e]===i)return void(this.privValues[e]=t);this.privKeys.push(i),this.privValues.push(t)}clone(){const e=new n;for(let t=0;t<this.privKeys.length;t++)e.privKeys.push(this.privKeys[t]),e.privValues.push(this.privValues[t]);return e}mergeTo(e){this.privKeys.forEach((t=>{if(void 0===e.getProperty(t,void 0)){const i=this.getProperty(t);e.setProperty(t,i)}}))}get keys(){return this.privKeys}}},65453:(e,t,i)=>{"use strict";var r;i.d(t,{o:()=>r}),function(e){e[e.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",e[e.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",e[e.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",e[e.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",e[e.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",e[e.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",e[e.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",e[e.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",e[e.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",e[e.SpeechServiceConnection_IntentRegion=9]="SpeechServiceConnection_IntentRegion",e[e.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",e[e.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",e[e.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",e[e.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",e[e.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",e[e.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",e[e.Speech_SessionId=16]="Speech_SessionId",e[e.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",e[e.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",e[e.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",e[e.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",e[e.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",e[e.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",e[e.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",e[e.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",e[e.CancellationDetails_Reason=25]="CancellationDetails_Reason",e[e.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",e[e.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",e[e.LanguageUnderstandingServiceResponse_JsonResult=28]="LanguageUnderstandingServiceResponse_JsonResult",e[e.SpeechServiceConnection_Url=29]="SpeechServiceConnection_Url",e[e.SpeechServiceConnection_InitialSilenceTimeoutMs=30]="SpeechServiceConnection_InitialSilenceTimeoutMs",e[e.SpeechServiceConnection_EndSilenceTimeoutMs=31]="SpeechServiceConnection_EndSilenceTimeoutMs",e[e.Speech_SegmentationSilenceTimeoutMs=32]="Speech_SegmentationSilenceTimeoutMs",e[e.SpeechServiceConnection_EnableAudioLogging=33]="SpeechServiceConnection_EnableAudioLogging",e[e.SpeechServiceConnection_LanguageIdMode=34]="SpeechServiceConnection_LanguageIdMode",e[e.SpeechServiceConnection_RecognitionEndpointVersion=35]="SpeechServiceConnection_RecognitionEndpointVersion",e[e.SpeechServiceConnection_SpeakerIdMode=36]="SpeechServiceConnection_SpeakerIdMode",e[e.SpeechServiceResponse_ProfanityOption=37]="SpeechServiceResponse_ProfanityOption",e[e.SpeechServiceResponse_PostProcessingOption=38]="SpeechServiceResponse_PostProcessingOption",e[e.SpeechServiceResponse_RequestWordLevelTimestamps=39]="SpeechServiceResponse_RequestWordLevelTimestamps",e[e.SpeechServiceResponse_StablePartialResultThreshold=40]="SpeechServiceResponse_StablePartialResultThreshold",e[e.SpeechServiceResponse_OutputFormatOption=41]="SpeechServiceResponse_OutputFormatOption",e[e.SpeechServiceResponse_TranslationRequestStablePartialResult=42]="SpeechServiceResponse_TranslationRequestStablePartialResult",e[e.SpeechServiceResponse_RequestWordBoundary=43]="SpeechServiceResponse_RequestWordBoundary",e[e.SpeechServiceResponse_RequestPunctuationBoundary=44]="SpeechServiceResponse_RequestPunctuationBoundary",e[e.SpeechServiceResponse_RequestSentenceBoundary=45]="SpeechServiceResponse_RequestSentenceBoundary",e[e.Conversation_ApplicationId=46]="Conversation_ApplicationId",e[e.Conversation_DialogType=47]="Conversation_DialogType",e[e.Conversation_Initial_Silence_Timeout=48]="Conversation_Initial_Silence_Timeout",e[e.Conversation_From_Id=49]="Conversation_From_Id",e[e.Conversation_Conversation_Id=50]="Conversation_Conversation_Id",e[e.Conversation_Custom_Voice_Deployment_Ids=51]="Conversation_Custom_Voice_Deployment_Ids",e[e.Conversation_Speech_Activity_Template=52]="Conversation_Speech_Activity_Template",e[e.Conversation_Request_Bot_Status_Messages=53]="Conversation_Request_Bot_Status_Messages",e[e.Conversation_Agent_Connection_Id=54]="Conversation_Agent_Connection_Id",e[e.SpeechServiceConnection_Host=55]="SpeechServiceConnection_Host",e[e.ConversationTranslator_Host=56]="ConversationTranslator_Host",e[e.ConversationTranslator_Name=57]="ConversationTranslator_Name",e[e.ConversationTranslator_CorrelationId=58]="ConversationTranslator_CorrelationId",e[e.ConversationTranslator_Token=59]="ConversationTranslator_Token",e[e.PronunciationAssessment_ReferenceText=60]="PronunciationAssessment_ReferenceText",e[e.PronunciationAssessment_GradingSystem=61]="PronunciationAssessment_GradingSystem",e[e.PronunciationAssessment_Granularity=62]="PronunciationAssessment_Granularity",e[e.PronunciationAssessment_EnableMiscue=63]="PronunciationAssessment_EnableMiscue",e[e.PronunciationAssessment_Json=64]="PronunciationAssessment_Json",e[e.PronunciationAssessment_Params=65]="PronunciationAssessment_Params",e[e.SpeakerRecognition_Api_Version=66]="SpeakerRecognition_Api_Version"}(r||(r={}))},99801:(e,t,i)=>{"use strict";i.d(t,{J:()=>n});var r=i(7841);class n extends r.${constructor(e,t){super(t),this.privOffset=e}get offset(){return this.privOffset}}},93260:(e,t,i)=>{"use strict";i.d(t,{p:()=>r});class r{constructor(e,t,i,r,n,s,o,a,c,p){this.privResultId=e,this.privReason=t,this.privText=i,this.privDuration=r,this.privOffset=n,this.privLanguage=s,this.privLanguageDetectionConfidence=o,this.privErrorDetails=a,this.privJson=c,this.privProperties=p}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}}},44571:(e,t,i)=>{"use strict";i.d(t,{c:()=>d});var r=i(47916),n=i(62029),s=i(10512),o=i(54825),a=i(33182),c=i(89513),p=i(66e3),h=i(65453),u=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class d{constructor(e,t,i){this.audioConfig=void 0!==e?e:p.rU.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=t.clone(),this.privConnectionFactory=i,this.implCommonRecognizerSetup()}close(e,t){c.a.throwIfDisposed(this.privDisposed),(0,a.Kb)(this.dispose(!0),e,t)}get internalData(){return this.privReco}dispose(e){return u(this,void 0,void 0,(function*(){this.privDisposed||(this.privDisposed=!0,e&&this.privReco&&(yield this.privReco.audioSource.turnOff(),yield this.privReco.dispose()))}))}static get telemetryEnabled(){return r.q.telemetryDataEnabled}static enableTelemetry(e){r.q.telemetryDataEnabled=e}implCommonRecognizerSetup(){let e="undefined"!=typeof window?"Browser":"Node",t="unknown",i="unknown";"undefined"!=typeof navigator&&(e=e+"/"+navigator.platform,t=navigator.userAgent,i=navigator.appVersion);const r=this.createRecognizerConfig(new n.pu(new n._y(new n.OS(e,t,i))));this.privReco=this.createServiceRecognizer(d.getAuthFromProperties(this.privProperties),this.privConnectionFactory,this.audioConfig,r)}recognizeOnceAsyncImpl(e){return u(this,void 0,void 0,(function*(){c.a.throwIfDisposed(this.privDisposed);const t=new a.BH;yield this.implRecognizerStop(),yield this.privReco.recognize(e,t.resolve,t.reject);const i=yield t.promise;return yield this.implRecognizerStop(),i}))}startContinuousRecognitionAsyncImpl(e){return u(this,void 0,void 0,(function*(){c.a.throwIfDisposed(this.privDisposed),yield this.implRecognizerStop(),yield this.privReco.recognize(e,void 0,void 0)}))}stopContinuousRecognitionAsyncImpl(){return u(this,void 0,void 0,(function*(){c.a.throwIfDisposed(this.privDisposed),yield this.implRecognizerStop()}))}implRecognizerStop(){return u(this,void 0,void 0,(function*(){this.privReco&&(yield this.privReco.stopRecognizing())}))}static getAuthFromProperties(e){const t=e.getProperty(h.o.SpeechServiceConnection_Key,void 0);return t&&""!==t?new s.U(t):new o.w((()=>{const t=e.getProperty(h.o.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(t)}),(()=>{const t=e.getProperty(h.o.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(t)}))}}},91048:(e,t,i)=>{"use strict";var r;i.d(t,{s:()=>r}),function(e){e[e.NoMatch=0]="NoMatch",e[e.Canceled=1]="Canceled",e[e.RecognizingSpeech=2]="RecognizingSpeech",e[e.RecognizedSpeech=3]="RecognizedSpeech",e[e.RecognizedKeyword=4]="RecognizedKeyword",e[e.RecognizingIntent=5]="RecognizingIntent",e[e.RecognizedIntent=6]="RecognizedIntent",e[e.TranslatingSpeech=7]="TranslatingSpeech",e[e.TranslatedSpeech=8]="TranslatedSpeech",e[e.SynthesizingAudio=9]="SynthesizingAudio",e[e.SynthesizingAudioCompleted=10]="SynthesizingAudioCompleted",e[e.SynthesizingAudioStarted=11]="SynthesizingAudioStarted",e[e.EnrollingVoiceProfile=12]="EnrollingVoiceProfile",e[e.EnrolledVoiceProfile=13]="EnrolledVoiceProfile",e[e.RecognizedSpeakers=14]="RecognizedSpeakers",e[e.RecognizedSpeaker=15]="RecognizedSpeaker",e[e.ResetVoiceProfile=16]="ResetVoiceProfile",e[e.DeletedVoiceProfile=17]="DeletedVoiceProfile",e[e.VoicesListRetrieved=18]="VoicesListRetrieved",e[e.TranslatingParticipantSpeech=19]="TranslatingParticipantSpeech",e[e.TranslatedParticipantSpeech=20]="TranslatedParticipantSpeech",e[e.TranslatedInstantMessage=21]="TranslatedInstantMessage",e[e.TranslatedParticipantInstantMessage=22]="TranslatedParticipantInstantMessage"}(r||(r={}))},60576:(e,t,i)=>{"use strict";i.d(t,{$:()=>n});var r=i(7841);class n extends r.${constructor(e,t,i){super(i),this.privJsonResult=e,this.privEventName=t}get jsonString(){return this.privJsonResult}get eventName(){return this.privEventName}}},84466:(e,t,i)=>{"use strict";var r;i.d(t,{a:()=>r}),function(e){e[e.UriQueryParameter=0]="UriQueryParameter"}(r||(r={}))},7841:(e,t,i)=>{"use strict";i.d(t,{$:()=>r});class r{constructor(e){this.privSessionId=e}get sessionId(){return this.privSessionId}}},39017:(e,t,i)=>{"use strict";i.d(t,{M:()=>n});var r=i(89513);class n{constructor(e,t){r.a.throwIfNullOrUndefined(e,"language"),this.privLanguage=e,this.privEndpointId=t}static fromLanguage(e,t){return new n(e,t)}get language(){return this.privLanguage}get endpointId(){return this.privEndpointId}}},27954:(e,t,i)=>{"use strict";i.d(t,{g:()=>s});var r=i(89513),n=i(38345);class s{constructor(e){if(this.privVoiceProfiles=[],this.privProfileIds=[],r.a.throwIfNullOrUndefined(e,"VoiceProfiles"),0===e.length)throw new Error("Empty Voice Profiles array");for(const t of e){if(t.profileType!==n.f.TextIndependentIdentification)throw new Error("Identification model can only be created from Identification profile: "+t.profileId);this.privVoiceProfiles.push(t),this.privProfileIds.push(t.profileId)}}static fromProfiles(e){return new s(e)}get voiceProfileIds(){return this.privProfileIds.join(",")}get profileIds(){return this.privProfileIds}get scenario(){return"TextIndependentIdentification"}}},20888:(e,t,i)=>{"use strict";i.d(t,{l5:()=>r,r2:()=>d,uH:()=>u});var r,n=i(62389),s=i(91048),o=i(98563),a=i(22874),c=i(65453),p=i(59654),h=i(6550);!function(e){e[e.Verify=0]="Verify",e[e.Identify=1]="Identify"}(r||(r={}));class u{constructor(e,t=s.s.RecognizedSpeaker,i=o.E.NoError,p=""){this.privProperties=new a.O;const h="TextIndependentIdentification"===e.scenario?r.Identify:r.Verify;this.privReason=t,this.privReason!==s.s.Canceled?h===r.Identify?(this.privProfileId=e.identificationResult.identifiedProfile.profileId,this.privScore=e.identificationResult.identifiedProfile.score,this.privReason=s.s.RecognizedSpeakers):(this.privScore=e.verificationResult.score,"accept"!==e.verificationResult.recognitionResult.toLowerCase()&&(this.privReason=s.s.NoMatch),void 0!==e.verificationResult.profileId&&""!==e.verificationResult.profileId&&(this.privProfileId=e.verificationResult.profileId)):(this.privErrorDetails=p,this.privProperties.setProperty(n.CancellationErrorCodePropertyName,o.E[i])),this.privProperties.setProperty(c.o.SpeechServiceResponse_JsonResult,JSON.stringify(e))}get properties(){return this.privProperties}get reason(){return this.privReason}get profileId(){return this.privProfileId}get errorDetails(){return this.privErrorDetails}get score(){return this.privScore}}class d extends p.v{constructor(e,t,i){super(e,t,i)}static fromResult(e){const t=h._.Error;let i=o.E.NoError;return e.properties&&(i=o.E[e.properties.getProperty(n.CancellationErrorCodePropertyName,o.E[o.E.NoError])]),new d(t,e.errorDetails,i)}}},91481:(e,t,i)=>{"use strict";i.d(t,{h:()=>h});var r=i(81667),n=i(62029),s=i(94589),o=i(89513),a=i(44571),c=i(65453),p=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class h extends a.c{constructor(e,t){o.a.throwIfNullOrUndefined(e,"speechConfig");const i=e;o.a.throwIfNullOrUndefined(i,"speechConfig"),super(t,i.properties,new r.$),this.privAudioConfigImpl=t,o.a.throwIfNull(this.privAudioConfigImpl,"audioConfig"),this.privDisposedSpeakerRecognizer=!1,this.privProperties=i.properties}get authorizationToken(){return this.properties.getProperty(c.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){o.a.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(c.o.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}recognizeOnceAsync(e){return p(this,void 0,void 0,(function*(){return o.a.throwIfDisposed(this.privDisposedSpeakerRecognizer),this.recognizeSpeakerOnceAsyncImpl(e)}))}close(){return p(this,void 0,void 0,(function*(){o.a.throwIfDisposed(this.privDisposedSpeakerRecognizer),yield this.dispose(!0)}))}recognizeSpeakerOnceAsyncImpl(e){return p(this,void 0,void 0,(function*(){o.a.throwIfDisposed(this.privDisposedSpeakerRecognizer),yield this.implRecognizerStop();const t=yield this.privReco.recognizeSpeaker(e);return yield this.implRecognizerStop(),t}))}implRecognizerStop(){return p(this,void 0,void 0,(function*(){this.privReco&&(yield this.privReco.stopRecognizing())}))}createRecognizerConfig(e){return new n.Xj(e,this.privProperties)}createServiceRecognizer(e,t,i,r){const n=i;return new s.w(e,t,n,r,this)}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return p(this,void 0,void 0,(function*(){this.privDisposedSpeakerRecognizer||e&&(this.privDisposedSpeakerRecognizer=!0,yield t.dispose.call(this,e))}))}}},61044:(e,t,i)=>{"use strict";i.d(t,{V:()=>s});var r=i(89513),n=i(38345);class s{constructor(e){if(r.a.throwIfNullOrUndefined(e,"VoiceProfile"),e.profileType===n.f.TextIndependentIdentification)throw new Error("Verification model cannot be created from Identification profile");this.privVoiceProfile=e}static fromProfile(e){return new s(e)}get voiceProfile(){return this.privVoiceProfile}get profileIds(){return[this.voiceProfile.profileId]}get scenario(){return this.voiceProfile.profileType===n.f.TextDependentVerification?"TextDependentVerification":"TextIndependentVerification"}}},60843:(e,t,i)=>{"use strict";i.d(t,{c:()=>h,z:()=>u});var r=i(62389),n=i(89513),s=i(65453),o=i(22874),a=i(88530),c=i(40731),p=i(92356);class h{constructor(){}static fromSubscription(e,t){n.a.throwIfNullOrWhitespace(e,"subscriptionKey"),n.a.throwIfNullOrWhitespace(t,"region");const i=new u;return i.setProperty(s.o.SpeechServiceConnection_Region,t),i.setProperty(s.o.SpeechServiceConnection_IntentRegion,t),i.setProperty(s.o.SpeechServiceConnection_Key,e),i}static fromEndpoint(e,t){n.a.throwIfNull(e,"endpoint");const i=new u;return i.setProperty(s.o.SpeechServiceConnection_Endpoint,e.href),void 0!==t&&i.setProperty(s.o.SpeechServiceConnection_Key,t),i}static fromHost(e,t){n.a.throwIfNull(e,"hostName");const i=new u;return i.setProperty(s.o.SpeechServiceConnection_Host,e.protocol+"//"+e.hostname+(""===e.port?"":":"+e.port)),void 0!==t&&i.setProperty(s.o.SpeechServiceConnection_Key,t),i}static fromAuthorizationToken(e,t){n.a.throwIfNull(e,"authorizationToken"),n.a.throwIfNullOrWhitespace(t,"region");const i=new u;return i.setProperty(s.o.SpeechServiceConnection_Region,t),i.setProperty(s.o.SpeechServiceConnection_IntentRegion,t),i.authorizationToken=e,i}close(){}}class u extends h{constructor(){super(),this.privProperties=new o.O,this.speechRecognitionLanguage="en-US",this.outputFormat=a.W.Simple}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(s.o.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(s.o.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(s.o.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(s.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.privProperties.setProperty(s.o.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return this.privProperties.getProperty(s.o.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(e){this.privProperties.setProperty(s.o.SpeechServiceConnection_RecoLanguage,e)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(s.o.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(e){this.privProperties.setProperty(s.o.SpeechServiceConnection_AutoDetectSourceLanguages,e)}get outputFormat(){return a.W[this.privProperties.getProperty(r.OutputFormatPropertyName,void 0)]}set outputFormat(e){this.privProperties.setProperty(r.OutputFormatPropertyName,a.W[e])}get endpointId(){return this.privProperties.getProperty(s.o.SpeechServiceConnection_EndpointId)}set endpointId(e){this.privProperties.setProperty(s.o.SpeechServiceConnection_EndpointId,e)}setProperty(e,t){n.a.throwIfNull(t,"value"),this.privProperties.setProperty(e,t)}getProperty(e,t){return this.privProperties.getProperty(e,t)}setProxy(e,t,i,r){this.setProperty(s.o[s.o.SpeechServiceConnection_ProxyHostName],e),this.setProperty(s.o[s.o.SpeechServiceConnection_ProxyPort],t),this.setProperty(s.o[s.o.SpeechServiceConnection_ProxyUserName],i),this.setProperty(s.o[s.o.SpeechServiceConnection_ProxyPassword],r)}setServiceProperty(e,t){const i=JSON.parse(this.privProperties.getProperty(r.ServicePropertiesPropertyName,"{}"));i[e]=t,this.privProperties.setProperty(r.ServicePropertiesPropertyName,JSON.stringify(i))}setProfanity(e){this.privProperties.setProperty(s.o.SpeechServiceResponse_ProfanityOption,c.P[e])}enableAudioLogging(){this.privProperties.setProperty(s.o.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(s.o.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privProperties.setProperty(r.ForceDictationPropertyName,"true")}clone(){const e=new u;return e.privProperties=this.privProperties.clone(),e}get speechSynthesisLanguage(){return this.privProperties.getProperty(s.o.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(e){this.privProperties.setProperty(s.o.SpeechServiceConnection_SynthLanguage,e)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(s.o.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(e){this.privProperties.setProperty(s.o.SpeechServiceConnection_SynthVoice,e)}get speechSynthesisOutputFormat(){return p.Y[this.privProperties.getProperty(s.o.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(e){this.privProperties.setProperty(s.o.SpeechServiceConnection_SynthOutputFormat,p.Y[e])}}},52438:(e,t,i)=>{"use strict";i.d(t,{n:()=>n});var r=i(18106);class n extends r.w{}},53383:(e,t,i)=>{"use strict";i.d(t,{d:()=>s,m:()=>n});var r=i(99801);class n extends r.J{constructor(e,t,i){super(t,i),this.privResult=e}get result(){return this.privResult}}class s extends n{}},98670:(e,t,i)=>{"use strict";i.d(t,{b:()=>n});var r=i(93260);class n extends r.p{constructor(e,t,i,r,n,s,o,a,c,p,h){super(e,t,i,r,n,s,o,c,p,h),this.privSpeakerId=a}get speakerId(){return this.privSpeakerId}}},84713:(e,t,i)=>{"use strict";i.d(t,{F:()=>d});var r=i(23955),n=i(62389),s=i(62029),o=i(35091),a=i(33182),c=i(89513),p=i(44571),h=i(65453),u=i(88530);class d extends p.c{constructor(e,t){const i=e;c.a.throwIfNull(i,"speechConfig"),c.a.throwIfNullOrWhitespace(i.properties.getProperty(h.o.SpeechServiceConnection_RecoLanguage),h.o[h.o.SpeechServiceConnection_RecoLanguage]),super(t,i.properties,new r.i),this.privDisposedRecognizer=!1}static FromConfig(e,t,i){const r=e;return t.properties.mergeTo(r.properties),new d(e,i)}get endpointId(){return c.a.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(h.o.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(h.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){c.a.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(h.o.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return c.a.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(h.o.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return c.a.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(n.OutputFormatPropertyName,u.W[u.W.Simple])===u.W[u.W.Simple]?u.W.Simple:u.W.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(e,t){(0,a.Kb)(this.recognizeOnceAsyncImpl(s.jf.Interactive),e,t)}startContinuousRecognitionAsync(e,t){(0,a.Kb)(this.startContinuousRecognitionAsyncImpl(s.jf.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){(0,a.Kb)(this.stopContinuousRecognitionAsyncImpl(),e,t)}startKeywordRecognitionAsync(e,t,i){c.a.throwIfNull(e,"model"),i&&i("Not yet implemented.")}stopKeywordRecognitionAsync(e){e&&e()}close(e,t){c.a.throwIfDisposed(this.privDisposedRecognizer),(0,a.Kb)(this.dispose(!0),e,t)}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return i=this,r=void 0,s=function*(){this.privDisposedRecognizer||(e&&(this.privDisposedRecognizer=!0,yield this.implRecognizerStop()),yield t.dispose.call(this,e))},new((n=void 0)||(n=Promise))((function(e,t){function o(e){try{c(s.next(e))}catch(e){t(e)}}function a(e){try{c(s.throw(e))}catch(e){t(e)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(o,a)}c((s=s.apply(i,r||[])).next())}));var i,r,n,s}createRecognizerConfig(e){return new s.Xj(e,this.privProperties)}createServiceRecognizer(e,t,i,r){const n=i;return new o.h(e,t,n,r,this)}}},93733:(e,t,i)=>{"use strict";i.d(t,{i:()=>r});class r{constructor(e,t){this.privAudioOffset=e,this.privText=t}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}}},55325:(e,t,i)=>{"use strict";var r;i.d(t,{I:()=>r}),function(e){e.Word="WordBoundary",e.Punctuation="PunctuationBoundary",e.Sentence="SentenceBoundary"}(r||(r={}))},24974:(e,t,i)=>{"use strict";i.d(t,{c:()=>r});class r{constructor(e){this.privResult=e}get result(){return this.privResult}}},92356:(e,t,i)=>{"use strict";var r;i.d(t,{Y:()=>r}),function(e){e[e.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",e[e.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",e[e.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",e[e.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",e[e.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",e[e.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",e[e.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",e[e.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",e[e.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",e[e.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",e[e.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",e[e.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",e[e.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",e[e.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",e[e.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",e[e.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",e[e.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",e[e.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",e[e.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",e[e.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",e[e.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",e[e.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",e[e.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",e[e.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",e[e.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",e[e.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",e[e.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",e[e.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",e[e.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw",e[e.Webm24Khz16Bit24KbpsMonoOpus=29]="Webm24Khz16Bit24KbpsMonoOpus",e[e.Audio16Khz16Bit32KbpsMonoOpus=30]="Audio16Khz16Bit32KbpsMonoOpus",e[e.Audio24Khz16Bit48KbpsMonoOpus=31]="Audio24Khz16Bit48KbpsMonoOpus",e[e.Audio24Khz16Bit24KbpsMonoOpus=32]="Audio24Khz16Bit24KbpsMonoOpus",e[e.Raw22050Hz16BitMonoPcm=33]="Raw22050Hz16BitMonoPcm",e[e.Riff22050Hz16BitMonoPcm=34]="Riff22050Hz16BitMonoPcm",e[e.Raw44100Hz16BitMonoPcm=35]="Raw44100Hz16BitMonoPcm",e[e.Riff44100Hz16BitMonoPcm=36]="Riff44100Hz16BitMonoPcm"}(r||(r={}))},71211:(e,t,i)=>{"use strict";i.d(t,{P:()=>n});var r=i(73725);class n extends r.A{constructor(e,t,i,r,n,s){super(e,t,r,n),this.privAudioData=i,this.privAudioDuration=s}get audioData(){return this.privAudioData}get audioDuration(){return this.privAudioDuration}}},20002:(e,t,i)=>{"use strict";i.d(t,{w:()=>r});class r{constructor(e,t,i){this.privAudioOffset=e,this.privVisemeId=t,this.privAnimation=i}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}}},93491:(e,t,i)=>{"use strict";i.d(t,{G:()=>r});class r{constructor(e,t,i,r,n,s){this.privAudioOffset=e,this.privDuration=t,this.privText=i,this.privWordLength=r,this.privTextOffset=n,this.privBoundaryType=s}get audioOffset(){return this.privAudioOffset}get duration(){return this.privDuration}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}get boundaryType(){return this.privBoundaryType}}},70635:(e,t,i)=>{"use strict";i.d(t,{a:()=>I});var r=i(83697),n=i(62389),s=i(61190),o=i(57895),a=i(62029),c=i(10512),p=i(54825),h=i(56893),u=i(68887),d=i(33182),l=i(25487),v=i(31298),g=i(85904),m=i(1912),f=i(89513),S=i(66e3),y=i(65453),C=i(92356),w=i(63946),R=i(54079),P=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class I{constructor(e,t){const i=e;f.a.throwIfNull(i,"speechConfig"),null!==t&&(this.audioConfig=void 0===t?"undefined"==typeof window?void 0:S.rU.fromDefaultSpeakerOutput():t),this.privProperties=i.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.privConnectionFactory=new r.i,this.synthesisRequestQueue=new u.c,this.implCommonSynthesizeSetup()}get authorizationToken(){return this.properties.getProperty(y.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){f.a.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(y.o.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}get autoDetectSourceLanguage(){return this.properties.getProperty(y.o.SpeechServiceConnection_AutoDetectSourceLanguages)===n.AutoDetectSourceLanguagesOpenRangeOptionName}static FromConfig(e,t,i){const r=e;return t.properties.mergeTo(r.properties),new I(e,i)}buildSsml(e){let t=this.properties.getProperty(y.o.SpeechServiceConnection_SynthLanguage,"en-US"),i=this.properties.getProperty(y.o.SpeechServiceConnection_SynthVoice,""),r=I.XMLEncode(e);return this.autoDetectSourceLanguage?t="en-US":i=i||{"af-ZA":"af-ZA-AdriNeural","am-ET":"am-ET-AmehaNeural","ar-AE":"ar-AE-FatimaNeural","ar-BH":"ar-BH-AliNeural","ar-DZ":"ar-DZ-AminaNeural","ar-EG":"ar-EG-SalmaNeural","ar-IQ":"ar-IQ-BasselNeural","ar-JO":"ar-JO-SanaNeural","ar-KW":"ar-KW-FahedNeural","ar-LY":"ar-LY-ImanNeural","ar-MA":"ar-MA-JamalNeural","ar-QA":"ar-QA-AmalNeural","ar-SA":"ar-SA-HamedNeural","ar-SY":"ar-SY-AmanyNeural","ar-TN":"ar-TN-HediNeural","ar-YE":"ar-YE-MaryamNeural","bg-BG":"bg-BG-BorislavNeural","bn-BD":"bn-BD-NabanitaNeural","bn-IN":"bn-IN-BashkarNeural","ca-ES":"ca-ES-JoanaNeural","cs-CZ":"cs-CZ-AntoninNeural","cy-GB":"cy-GB-AledNeural","da-DK":"da-DK-ChristelNeural","de-AT":"de-AT-IngridNeural","de-CH":"de-CH-JanNeural","de-DE":"de-DE-KatjaNeural","el-GR":"el-GR-AthinaNeural","en-AU":"en-AU-NatashaNeural","en-CA":"en-CA-ClaraNeural","en-GB":"en-GB-LibbyNeural","en-HK":"en-HK-SamNeural","en-IE":"en-IE-ConnorNeural","en-IN":"en-IN-NeerjaNeural","en-KE":"en-KE-AsiliaNeural","en-NG":"en-NG-AbeoNeural","en-NZ":"en-NZ-MitchellNeural","en-PH":"en-PH-JamesNeural","en-SG":"en-SG-LunaNeural","en-TZ":"en-TZ-ElimuNeural","en-US":"en-US-JennyNeural","en-ZA":"en-ZA-LeahNeural","es-AR":"es-AR-ElenaNeural","es-BO":"es-BO-MarceloNeural","es-CL":"es-CL-CatalinaNeural","es-CO":"es-CO-GonzaloNeural","es-CR":"es-CR-JuanNeural","es-CU":"es-CU-BelkysNeural","es-DO":"es-DO-EmilioNeural","es-EC":"es-EC-AndreaNeural","es-ES":"es-ES-AlvaroNeural","es-GQ":"es-GQ-JavierNeural","es-GT":"es-GT-AndresNeural","es-HN":"es-HN-CarlosNeural","es-MX":"es-MX-DaliaNeural","es-NI":"es-NI-FedericoNeural","es-PA":"es-PA-MargaritaNeural","es-PE":"es-PE-AlexNeural","es-PR":"es-PR-KarinaNeural","es-PY":"es-PY-MarioNeural","es-SV":"es-SV-LorenaNeural","es-US":"es-US-AlonsoNeural","es-UY":"es-UY-MateoNeural","es-VE":"es-VE-PaolaNeural","et-EE":"et-EE-AnuNeural","fa-IR":"fa-IR-DilaraNeural","fi-FI":"fi-FI-SelmaNeural","fil-PH":"fil-PH-AngeloNeural","fr-BE":"fr-BE-CharlineNeural","fr-CA":"fr-CA-SylvieNeural","fr-CH":"fr-CH-ArianeNeural","fr-FR":"fr-FR-DeniseNeural","ga-IE":"ga-IE-ColmNeural","gl-ES":"gl-ES-RoiNeural","gu-IN":"gu-IN-DhwaniNeural","he-IL":"he-IL-AvriNeural","hi-IN":"hi-IN-MadhurNeural","hr-HR":"hr-HR-GabrijelaNeural","hu-HU":"hu-HU-NoemiNeural","id-ID":"id-ID-ArdiNeural","is-IS":"is-IS-GudrunNeural","it-IT":"it-IT-IsabellaNeural","ja-JP":"ja-JP-NanamiNeural","jv-ID":"jv-ID-DimasNeural","kk-KZ":"kk-KZ-AigulNeural","km-KH":"km-KH-PisethNeural","kn-IN":"kn-IN-GaganNeural","ko-KR":"ko-KR-SunHiNeural","lo-LA":"lo-LA-ChanthavongNeural","lt-LT":"lt-LT-LeonasNeural","lv-LV":"lv-LV-EveritaNeural","mk-MK":"mk-MK-AleksandarNeural","ml-IN":"ml-IN-MidhunNeural","mr-IN":"mr-IN-AarohiNeural","ms-MY":"ms-MY-OsmanNeural","mt-MT":"mt-MT-GraceNeural","my-MM":"my-MM-NilarNeural","nb-NO":"nb-NO-PernilleNeural","nl-BE":"nl-BE-ArnaudNeural","nl-NL":"nl-NL-ColetteNeural","pl-PL":"pl-PL-AgnieszkaNeural","ps-AF":"ps-AF-GulNawazNeural","pt-BR":"pt-BR-FranciscaNeural","pt-PT":"pt-PT-DuarteNeural","ro-RO":"ro-RO-AlinaNeural","ru-RU":"ru-RU-SvetlanaNeural","si-LK":"si-LK-SameeraNeural","sk-SK":"sk-SK-LukasNeural","sl-SI":"sl-SI-PetraNeural","so-SO":"so-SO-MuuseNeural","sr-RS":"sr-RS-NicholasNeural","su-ID":"su-ID-JajangNeural","sv-SE":"sv-SE-SofieNeural","sw-KE":"sw-KE-RafikiNeural","sw-TZ":"sw-TZ-DaudiNeural","ta-IN":"ta-IN-PallaviNeural","ta-LK":"ta-LK-KumarNeural","ta-SG":"ta-SG-AnbuNeural","te-IN":"te-IN-MohanNeural","th-TH":"th-TH-PremwadeeNeural","tr-TR":"tr-TR-AhmetNeural","uk-UA":"uk-UA-OstapNeural","ur-IN":"ur-IN-GulNeural","ur-PK":"ur-PK-AsadNeural","uz-UZ":"uz-UZ-MadinaNeural","vi-VN":"vi-VN-HoaiMyNeural","zh-CN":"zh-CN-XiaoxiaoNeural","zh-HK":"zh-HK-HiuMaanNeural","zh-TW":"zh-TW-HsiaoChenNeural","zu-ZA":"zu-ZA-ThandoNeural"}[t],i&&(r=`<voice name='${i}'>${r}</voice>`),r=`<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${t}'>${r}</speak>`,r}speakTextAsync(e,t,i,r){this.speakImpl(e,!1,t,i,r)}speakSsmlAsync(e,t,i,r){this.speakImpl(e,!0,t,i,r)}getVoicesAsync(e=""){return P(this,void 0,void 0,(function*(){return this.getVoices(e)}))}close(e,t){f.a.throwIfDisposed(this.privDisposed),(0,d.Kb)(this.dispose(!0),e,t)}get internalData(){return this.privAdapter}dispose(e){return P(this,void 0,void 0,(function*(){this.privDisposed||(e&&this.privAdapter&&(yield this.privAdapter.dispose()),this.privDisposed=!0)}))}createSynthesizerConfig(e){return new s.E(e,this.privProperties)}createSynthesisAdapter(e,t,i,r){return new o.E(e,t,r,this,this.audioConfig)}implCommonSynthesizeSetup(){let e="undefined"!=typeof window?"Browser":"Node",t="unknown",i="unknown";"undefined"!=typeof navigator&&(e=e+"/"+navigator.platform,t=navigator.userAgent,i=navigator.appVersion);const r=this.createSynthesizerConfig(new a.pu(new a._y(new a.OS(e,t,i)))),n=this.privProperties.getProperty(y.o.SpeechServiceConnection_Key,void 0),s=n&&""!==n?new c.U(n):new p.w((()=>{const e=this.privProperties.getProperty(y.o.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(e)}),(()=>{const e=this.privProperties.getProperty(y.o.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(e)}));this.privAdapter=this.createSynthesisAdapter(s,this.privConnectionFactory,this.audioConfig,r),this.privAdapter.audioOutputFormat=g.d.fromSpeechSynthesisOutputFormat(C.Y[this.properties.getProperty(y.o.SpeechServiceConnection_SynthOutputFormat,void 0)]),this.privRestAdapter=new h.q(r,s)}speakImpl(e,t,i,r,n){try{f.a.throwIfDisposed(this.privDisposed);const s=(0,l.Q)();let o;o=n instanceof w.y?new m.KS(n):n instanceof m.Ao?n:void 0!==n?new v.O(n):void 0,this.synthesisRequestQueue.enqueue(new A(s,e,t,(e=>{if(this.privSynthesizing=!1,i)try{i(e)}catch(e){r&&r(e)}i=void 0,this.adapterSpeak().catch((()=>{}))}),(e=>{r&&r(e)}),o)),this.adapterSpeak().catch((()=>{}))}catch(e){if(r)if(e instanceof Error){const t=e;r(t.name+": "+t.message)}else r(e);this.dispose(!0).catch((()=>{}))}}getVoices(e){return P(this,void 0,void 0,(function*(){const t=(0,l.Q)(),i=yield this.privRestAdapter.getVoicesList(t);if(i.ok&&Array.isArray(i.json)){let r=i.json;return e&&e.length>0&&(r=r.filter((t=>!!t.Locale&&t.Locale.toLowerCase()===e.toLowerCase()))),new R.k(t,r,void 0)}return new R.k(t,void 0,`Error: ${i.status}: ${i.statusText}`)}))}adapterSpeak(){return P(this,void 0,void 0,(function*(){if(!this.privDisposed&&!this.privSynthesizing){this.privSynthesizing=!0;const e=yield this.synthesisRequestQueue.dequeue();return this.privAdapter.Speak(e.text,e.isSSML,e.requestId,e.cb,e.err,e.dataStream)}}))}static XMLEncode(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}}class A{constructor(e,t,i,r,n,s){this.requestId=e,this.text=t,this.isSSML=i,this.cb=r,this.err=n,this.dataStream=s}}},77931:(e,t,i)=>{"use strict";i.d(t,{f:()=>u,m:()=>d});var r=i(62389),n=i(89513),s=i(60843),o=i(65453),a=i(22874),c=i(88530),p=i(40731),h=i(92356);class u extends s.c{constructor(){super()}static fromSubscription(e,t){n.a.throwIfNullOrWhitespace(e,"subscriptionKey"),n.a.throwIfNullOrWhitespace(t,"region");const i=new d;return i.properties.setProperty(o.o.SpeechServiceConnection_Key,e),i.properties.setProperty(o.o.SpeechServiceConnection_Region,t),i}static fromAuthorizationToken(e,t){n.a.throwIfNullOrWhitespace(e,"authorizationToken"),n.a.throwIfNullOrWhitespace(t,"region");const i=new d;return i.properties.setProperty(o.o.SpeechServiceAuthorization_Token,e),i.properties.setProperty(o.o.SpeechServiceConnection_Region,t),i}static fromHost(e,t){n.a.throwIfNull(e,"hostName");const i=new d;return i.setProperty(o.o.SpeechServiceConnection_Host,e.protocol+"//"+e.hostname+(""===e.port?"":":"+e.port)),void 0!==t&&i.setProperty(o.o.SpeechServiceConnection_Key,t),i}static fromEndpoint(e,t){n.a.throwIfNull(e,"endpoint"),n.a.throwIfNull(t,"subscriptionKey");const i=new d;return i.properties.setProperty(o.o.SpeechServiceConnection_Endpoint,e.href),i.properties.setProperty(o.o.SpeechServiceConnection_Key,t),i}}class d extends u{constructor(){super(),this.privSpeechProperties=new a.O,this.outputFormat=c.W.Simple}set authorizationToken(e){n.a.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(o.o.SpeechServiceAuthorization_Token,e)}set speechRecognitionLanguage(e){n.a.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(o.o.SpeechServiceConnection_RecoLanguage,e)}get speechRecognitionLanguage(){return this.privSpeechProperties.getProperty(o.o[o.o.SpeechServiceConnection_RecoLanguage])}get subscriptionKey(){return this.privSpeechProperties.getProperty(o.o[o.o.SpeechServiceConnection_Key])}get outputFormat(){return c.W[this.privSpeechProperties.getProperty(r.OutputFormatPropertyName,void 0)]}set outputFormat(e){this.privSpeechProperties.setProperty(r.OutputFormatPropertyName,c.W[e])}get endpointId(){return this.privSpeechProperties.getProperty(o.o.SpeechServiceConnection_EndpointId)}set endpointId(e){this.privSpeechProperties.setProperty(o.o.SpeechServiceConnection_EndpointId,e)}addTargetLanguage(e){n.a.throwIfNullOrWhitespace(e,"value");const t=this.targetLanguages;t.push(e),this.privSpeechProperties.setProperty(o.o.SpeechServiceConnection_TranslationToLanguages,t.join(","))}get targetLanguages(){return void 0!==this.privSpeechProperties.getProperty(o.o.SpeechServiceConnection_TranslationToLanguages,void 0)?this.privSpeechProperties.getProperty(o.o.SpeechServiceConnection_TranslationToLanguages).split(","):[]}get voiceName(){return this.getProperty(o.o[o.o.SpeechServiceConnection_TranslationVoice])}set voiceName(e){n.a.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(o.o.SpeechServiceConnection_TranslationVoice,e)}get region(){return this.privSpeechProperties.getProperty(o.o.SpeechServiceConnection_Region)}setProxy(e,t,i,r){this.setProperty(o.o[o.o.SpeechServiceConnection_ProxyHostName],e),this.setProperty(o.o[o.o.SpeechServiceConnection_ProxyPort],t),this.setProperty(o.o[o.o.SpeechServiceConnection_ProxyUserName],i),this.setProperty(o.o[o.o.SpeechServiceConnection_ProxyPassword],r)}getProperty(e,t){return this.privSpeechProperties.getProperty(e,t)}setProperty(e,t){this.privSpeechProperties.setProperty(e,t)}get properties(){return this.privSpeechProperties}close(){}setServiceProperty(e,t){const i=JSON.parse(this.privSpeechProperties.getProperty(r.ServicePropertiesPropertyName,"{}"));i[e]=t,this.privSpeechProperties.setProperty(r.ServicePropertiesPropertyName,JSON.stringify(i))}setProfanity(e){this.privSpeechProperties.setProperty(o.o.SpeechServiceResponse_ProfanityOption,p.P[e])}enableAudioLogging(){this.privSpeechProperties.setProperty(o.o.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privSpeechProperties.setProperty(o.o.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privSpeechProperties.setProperty(r.ForceDictationPropertyName,"true")}get speechSynthesisLanguage(){return this.privSpeechProperties.getProperty(o.o.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(e){this.privSpeechProperties.setProperty(o.o.SpeechServiceConnection_SynthLanguage,e)}get speechSynthesisVoiceName(){return this.privSpeechProperties.getProperty(o.o.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(e){this.privSpeechProperties.setProperty(o.o.SpeechServiceConnection_SynthVoice,e)}get speechSynthesisOutputFormat(){return h.Y[this.privSpeechProperties.getProperty(o.o.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(e){this.privSpeechProperties.setProperty(o.o.SpeechServiceConnection_SynthOutputFormat,h.Y[e])}}},73725:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});class r{constructor(e,t,i,r){this.privResultId=e,this.privReason=t,this.privErrorDetails=i,this.privProperties=r}get resultId(){return this.privResultId}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}}},54079:(e,t,i)=>{"use strict";i.d(t,{k:()=>a});var r=i(73725),n=i(91048),s=i(22874),o=i(71520);class a extends r.A{constructor(e,t,i){if(Array.isArray(t)){super(e,n.s.VoicesListRetrieved,void 0,new s.O),this.privVoices=[];for(const e of t)this.privVoices.push(new o.R$(e))}else super(e,n.s.Canceled,i||"Error information unavailable",new s.O)}get voices(){return this.privVoices}}},15203:(e,t,i)=>{"use strict";i.d(t,{C:()=>f,r:()=>S});var r=i(33691),n=i(84883),s=i(77339),o=i(82383),a=i(33182),c=i(89513),p=i(65453),h=i(4225),u=i(97378),d=i(52228),l=i(22874),v=i(40731),g=i(13250),m=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class f{constructor(){}static createConversationAsync(e,t,i,n){let s,o,h;return c.a.throwIfNullOrUndefined(e,r.m.restErrors.invalidArgs.replace("{arg}","config")),c.a.throwIfNullOrUndefined(e.region,r.m.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),e.subscriptionKey||e.getProperty(p.o[p.o.SpeechServiceAuthorization_Token])||c.a.throwIfNullOrUndefined(e.subscriptionKey,r.m.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key")),"string"==typeof t?(s=new S(e,t),(0,a.Kb)((()=>m(this,void 0,void 0,(function*(){})))(),i,n)):(s=new S(e),o=t,h=i,s.createConversationAsync((()=>{o&&o()}),(e=>{h&&h(e)}))),s}}class S extends f{constructor(e,t){if(super(),this.privErrors=r.m.restErrors,this.onConnected=e=>{var t;this.privIsConnected=!0;try{(null===(t=this.privConversationTranslator)||void 0===t?void 0:t.sessionStarted)&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,e)}catch(e){}},this.onDisconnected=e=>{var t;try{(null===(t=this.privConversationTranslator)||void 0===t?void 0:t.sessionStopped)&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,e)}catch(e){}finally{this.close(!1)}},this.onCanceled=(e,t)=>{var i;try{(null===(i=this.privConversationTranslator)||void 0===i?void 0:i.canceled)&&this.privConversationTranslator.canceled(this.privConversationTranslator,t)}catch(t){}},this.onParticipantUpdateCommandReceived=(e,t)=>{try{const e=this.privParticipants.getParticipant(t.id);if(void 0!==e){switch(t.key){case n.L7.changeNickname:e.displayName=t.value;break;case n.L7.setUseTTS:e.isUsingTts=t.value;break;case n.L7.setProfanityFiltering:e.profanity=t.value;break;case n.L7.setMute:e.isMuted=t.value;break;case n.L7.setTranslateToLanguages:e.translateToLanguages=t.value}this.privParticipants.addOrUpdateParticipant(e),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new h.T(u.T.Updated,[this.toParticipant(e)],t.sessionId))}}catch(t){}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(e,t)=>{try{this.privParticipants.participants.forEach((e=>e.isMuted=!e.isHost&&t.isMuted)),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new h.T(u.T.Updated,this.toParticipants(!1),t.sessionId))}catch(t){}},this.onParticipantJoinCommandReceived=(e,t)=>{try{const e=this.privParticipants.addOrUpdateParticipant(t.participant);void 0!==e&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new h.T(u.T.JoinedConversation,[this.toParticipant(e)],t.sessionId))}catch(t){}},this.onParticipantLeaveCommandReceived=(e,t)=>{try{const e=this.privParticipants.getParticipant(t.participant.id);void 0!==e&&(this.privParticipants.deleteParticipant(t.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new h.T(u.T.LeftConversation,[this.toParticipant(e)],t.sessionId)))}catch(t){}},this.onTranslationReceived=(e,t)=>{try{switch(t.command){case n.li.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new d.D(t.payload,void 0,t.sessionId));break;case n.li.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new d.D(t.payload,void 0,t.sessionId));break;case n.li.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new d.D(t.payload,void 0,t.sessionId))}}catch(t){}},this.onParticipantsListReceived=(e,t)=>{var i;try{if(void 0!==t.sessionToken&&null!==t.sessionToken&&(this.privRoom.token=t.sessionToken),this.privParticipants.participants=[...t.participants],void 0!==this.privParticipants.me&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new h.T(u.T.JoinedConversation,this.toParticipants(!0),t.sessionId)),this.me.isHost){const e=null===(i=this.privConversationTranslator)||void 0===i?void 0:i.properties.getProperty(p.o.ConversationTranslator_Name);void 0!==e&&e.length>0&&e!==this.me.displayName&&this.changeNicknameAsync(e)}}catch(t){}},this.onConversationExpiration=(e,t)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,t)}catch(t){}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new l.O,this.privManager=new s.N,e.getProperty(p.o[p.o.SpeechServiceConnection_RecoLanguage])||e.setProperty(p.o[p.o.SpeechServiceConnection_RecoLanguage],r.m.defaultLanguageCode),this.privLanguage=e.getProperty(p.o[p.o.SpeechServiceConnection_RecoLanguage]),t)this.privConversationId=t;else{0===e.targetLanguages.length&&e.addTargetLanguage(this.privLanguage),e.getProperty(p.o[p.o.SpeechServiceResponse_ProfanityOption])||e.setProfanity(v.P.Masked);let t=e.getProperty(p.o[p.o.ConversationTranslator_Name]);null==t&&(t="Host"),c.a.throwIfNullOrTooLong(t,"nickname",50),c.a.throwIfNullOrTooShort(t,"nickname",2),e.setProperty(p.o[p.o.ConversationTranslator_Name],t)}this.privConfig=e;const i=e;c.a.throwIfNull(i,"speechConfig"),this.privProperties=i.properties.clone(),this.privIsConnected=!1,this.privParticipants=new n.h$,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get conversationId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){var e,t;return!(null===(e=this.privParticipants.me)||void 0===e?void 0:e.isHost)&&(null===(t=this.privParticipants.me)||void 0===t?void 0:t.isMuted)}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get conversationInfo(){const e=this.conversationId,t=this.participants.map((e=>({id:e.id,preferredLanguage:e.preferredLanguage,voice:e.voice}))),i={};for(const e of r.m.transcriptionEventKeys){const t=this.properties.getProperty(e,"");""!==t&&(i[e]=t)}return{id:e,participants:t,conversationProperties:i}}get canSend(){var e;return this.privIsConnected&&!(null===(e=this.privParticipants.me)||void 0===e?void 0:e.isMuted)}get canSendAsHost(){var e;return this.privIsConnected&&(null===(e=this.privParticipants.me)||void 0===e?void 0:e.isHost)}get authorizationToken(){return this.privToken}set authorizationToken(e){c.a.throwIfNullOrWhitespace(e,"authorizationToken"),this.privToken=e}set conversationTranslator(e){this.privConversationTranslator=e}createConversationAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),this.privManager.createOrJoin(this.privProperties,void 0,(i=>{i||this.handleError(new Error(this.privErrors.permissionDeniedConnect),t),this.privRoom=i,this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(e){this.handleError(e,t)}}startConversationAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),c.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=o.a.fromConfig(this,this.privConfig),this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(e){this.handleError(e,t)}}addParticipantAsync(e,t,i){c.a.throwIfNullOrUndefined(e,"Participant"),(0,a.Kb)(this.addParticipantImplAsync(e),t,i)}joinConversationAsync(e,t,i,r,n){try{c.a.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","conversationId")),c.a.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),c.a.throwIfNullOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,e,(e=>{c.a.throwIfNullOrUndefined(e,this.privErrors.permissionDeniedConnect),this.privRoom=e,this.privConfig.authorizationToken=e.cognitiveSpeechAuthToken,r&&r(e.cognitiveSpeechAuthToken)}),(e=>{this.handleError(e,n)}))}catch(e){this.handleError(e,n)}}deleteConversationAsync(e,t){(0,a.Kb)(this.deleteConversationImplAsync(),e,t)}deleteConversationImplAsync(){return m(this,void 0,void 0,(function*(){c.a.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),c.a.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),yield this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}))}endConversationAsync(e,t){(0,a.Kb)(this.endConversationImplAsync(),e,t)}endConversationImplAsync(){return this.close(!0)}lockConversationAsync(e,t){try{c.a.throwIfDisposed(this.privIsDisposed),c.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),c.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(e){this.handleError(e,t)}}muteAllParticipantsAsync(e,t){try{c.a.throwIfDisposed(this.privIsDisposed),c.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),c.a.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),c.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(e){this.handleError(e,t)}}muteParticipantAsync(e,t,i){try{c.a.throwIfDisposed(this.privIsDisposed),c.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),c.a.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),c.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),this.me.isHost||this.me.id===e||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),i),-1===this.privParticipants.getParticipantIndex(e)&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!0),(()=>{this.handleCallback(t,i)}),(e=>{this.handleError(e,i)}))}catch(e){this.handleError(e,i)}}removeParticipantAsync(e,t,i){try{if(c.a.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&e.hasOwnProperty("id"))(0,a.Kb)(this.removeParticipantImplAsync(e),t,i);else{c.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),c.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),i);let r="";"string"==typeof e?r=e:e.hasOwnProperty("id")?r=e.id:e.hasOwnProperty("userId")&&(r=e.userId),c.a.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","userId")),-1===this.participants.findIndex((e=>e.id===r))&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(r),(()=>{this.handleCallback(t,i)}),(e=>{this.handleError(e,i)}))}}catch(e){this.handleError(e,i)}}unlockConversationAsync(e,t){try{c.a.throwIfDisposed(this.privIsDisposed),c.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),c.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(e){this.handleError(e,t)}}unmuteAllParticipantsAsync(e,t){try{c.a.throwIfDisposed(this.privIsDisposed),c.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),c.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(e){this.handleError(e,t)}}unmuteParticipantAsync(e,t,i){try{c.a.throwIfDisposed(this.privIsDisposed),c.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),c.a.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),c.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),this.me.isHost||this.me.id===e||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),i),-1===this.privParticipants.getParticipantIndex(e)&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!1),(()=>{this.handleCallback(t,i)}),(e=>{this.handleError(e,i)}))}catch(e){this.handleError(e,i)}}sendTextMessageAsync(e,t,i){try{c.a.throwIfDisposed(this.privIsDisposed),c.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),c.a.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","message")),c.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),e.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(e),(()=>{this.handleCallback(t,i)}),(e=>{this.handleError(e,i)}))}catch(e){this.handleError(e,i)}}setTranslatedLanguagesAsync(e,t,i){try{c.a.throwIfDisposed(this.privIsDisposed),c.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),c.a.throwIfArrayEmptyOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","languages")),c.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(e),(()=>{this.handleCallback(t,i)}),(e=>{this.handleError(e,i)}))}catch(e){this.handleError(e,i)}}changeNicknameAsync(e,t,i){try{c.a.throwIfDisposed(this.privIsDisposed),c.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),c.a.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","nickname")),c.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),i),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(e),(()=>{this.handleCallback(t,i)}),(e=>{this.handleError(e,i)}))}catch(e){this.handleError(e,i)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}connectTranscriberRecognizer(e){return m(this,void 0,void 0,(function*(){this.privTranscriberRecognizer&&(yield this.privTranscriberRecognizer.close()),yield e.enforceAudioGating(),this.privTranscriberRecognizer=e,this.privTranscriberRecognizer.conversation=this}))}getKeepAlive(){const e=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:e,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:n.li.keepAlive})}addParticipantImplAsync(e){if(void 0!==this.privParticipants.addOrUpdateParticipant(e)&&this.privTranscriberRecognizer){const t=this.conversationInfo;return t.participants=[e],this.privTranscriberRecognizer.pushConversationEvent(t,"join")}}removeParticipantImplAsync(e){this.privParticipants.deleteParticipant(e.id);const t=this.conversationInfo;return t.participants=[e],this.privTranscriberRecognizer.pushConversationEvent(t,"leave")}close(e){var t;return m(this,void 0,void 0,(function*(){try{this.privIsConnected=!1,yield null===(t=this.privConversationRecognizer)||void 0===t?void 0:t.close(),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(e){throw e}e&&this.dispose()}))}handleCallback(e,t){if(e){try{e()}catch(e){t&&t(e)}e=void 0}}handleError(e,t){if(t)if(e instanceof Error){const i=e;t(i.name+": "+i.message)}else t(e)}toParticipants(e){const t=this.privParticipants.participants.map((e=>this.toParticipant(e)));return e?t:t.filter((e=>!1===e.isHost))}toParticipant(e){return new g.Q(e.id,e.avatar,e.displayName,e.isHost,e.isMuted,e.isUsingTts,e.preferredLanguage,e.voice)}getMuteAllCommand(e){return c.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),c.a.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.L7.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.li.participantCommand,value:e})}getMuteCommand(e,t){return c.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),c.a.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:n.L7.setMute,participantId:e,roomid:this.privRoom.roomId,type:n.li.participantCommand,value:t})}getLockCommand(e){return c.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),c.a.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.L7.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.li.participantCommand,value:e})}getEjectCommand(e){return c.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),c.a.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:n.L7.ejectParticipant,participantId:e,roomid:this.privRoom.roomId,type:n.li.participantCommand})}getSetTranslateToLanguagesCommand(e){return c.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),c.a.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.L7.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.li.participantCommand,value:e})}getChangeNicknameCommand(e){return c.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),c.a.throwIfNullOrWhitespace(e,"nickname"),c.a.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:n.L7.changeNickname,nickname:e,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:n.li.participantCommand,value:e})}getMessageCommand(e){return c.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),c.a.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),c.a.throwIfNullOrWhitespace(e,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:e,type:n.li.instantMessage})}}},16208:(e,t,i)=>{"use strict";i.d(t,{p:()=>r});class r{constructor(e){this.privAudioConfig=e}handleCallback(e,t){if(e){try{e()}catch(e){t&&t(e)}e=void 0}}handleError(e,t){if(t)if(e instanceof Error){const i=e;t(i.name+": "+i.message)}else t(e)}}},454:(e,t,i)=>{"use strict";i.d(t,{i:()=>n});var r=i(7841);class n extends r.${constructor(e,t){super(t),this.privExpirationTime=e}get expirationTime(){return this.privExpirationTime}}},4225:(e,t,i)=>{"use strict";i.d(t,{T:()=>n});var r=i(7841);class n extends r.${constructor(e,t,i){super(i),this.privReason=e,this.privParticipant=t}get reason(){return this.privReason}get participants(){return this.privParticipant}}},52974:(e,t,i)=>{"use strict";i.d(t,{b:()=>h});var r=i(81909),n=i(33182),s=i(89513),o=i(22874),a=i(65453),c=i(53333),p=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class h{constructor(e){this.privAudioConfig=e,this.privProperties=new o.O,this.privRecognizer=void 0,this.privDisposedRecognizer=!1}get speechRecognitionLanguage(){return s.a.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(a.o.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get internalData(){return this.privRecognizer.internalData}get connection(){return c.e.fromRecognizer(this.privRecognizer)}get authorizationToken(){return this.properties.getProperty(a.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){s.a.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(a.o.SpeechServiceAuthorization_Token,e)}joinConversationAsync(e,t,i){const o=e;s.a.throwIfNullOrUndefined(o,"Conversation"),this.privRecognizer=new r.S(e.config,this.privAudioConfig),s.a.throwIfNullOrUndefined(this.privRecognizer,"Recognizer"),this.privRecognizer.connectCallbacks(this),(0,n.Kb)(o.connectTranscriberRecognizer(this.privRecognizer),t,i)}startTranscribingAsync(e,t){this.privRecognizer.startContinuousRecognitionAsync(e,t)}stopTranscribingAsync(e,t){this.privRecognizer.stopContinuousRecognitionAsync(e,t)}leaveConversationAsync(e,t){this.privRecognizer.disconnectCallbacks(),(0,n.Kb)((()=>p(this,void 0,void 0,(function*(){})))(),e,t)}close(e,t){s.a.throwIfDisposed(this.privDisposedRecognizer),(0,n.Kb)(this.dispose(!0),e,t)}dispose(e){return p(this,void 0,void 0,(function*(){this.privDisposedRecognizer||(this.privRecognizer&&(yield this.privRecognizer.close(),this.privRecognizer=void 0),e&&(this.privDisposedRecognizer=!0))}))}}},17469:(e,t,i)=>{"use strict";i.d(t,{O:()=>n});var r=i(18106);class n extends r.w{}},52228:(e,t,i)=>{"use strict";i.d(t,{D:()=>n});var r=i(99801);class n extends r.J{constructor(e,t,i){super(t,i),this.privResult=e}get result(){return this.privResult}}},56523:(e,t,i)=>{"use strict";i.d(t,{M:()=>n});var r=i(43465);class n extends r.r{constructor(e,t,i,r,n,s,o,a,c,p,h){super(t,r,n,s,o,a,void 0,void 0,c,p,h),this.privId=e,this.privOrigLang=i}get participantId(){return this.privId}get originalLang(){return this.privOrigLang}}},63897:(e,t,i)=>{"use strict";i.d(t,{_:()=>P});var r,n=i(33691),s=i(62389),o=i(85204),a=i(33182),c=i(89513),p=i(43078),h=i(6550),u=i(98563),d=i(22874),l=i(77931),v=i(40731),g=i(65453),m=i(84466),f=i(66e3),S=i(15203),y=i(17469),C=i(16208),w=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};!function(e){e[e.Inactive=0]="Inactive",e[e.Connecting=1]="Connecting",e[e.Connected=2]="Connected"}(r||(r={}));class R extends p.M{constructor(e,t,i,n){super(e,t,new o.R(n)),this.privSpeechState=r.Inactive,i&&(this.privTranslator=i,this.sessionStarted=()=>{this.privSpeechState=r.Connected},this.sessionStopped=()=>{this.privSpeechState=r.Inactive},this.recognizing=(e,t)=>{this.privTranslator.recognizing&&this.privTranslator.recognizing(this.privTranslator,t)},this.recognized=(e,t)=>w(this,void 0,void 0,(function*(){var e;(null===(e=t.result)||void 0===e?void 0:e.errorDetails)?(yield this.cancelSpeech(),this.fireCancelEvent(t.result.errorDetails)):this.privTranslator.recognized&&this.privTranslator.recognized(this.privTranslator,t)})),this.canceled=()=>w(this,void 0,void 0,(function*(){if(this.privSpeechState!==r.Inactive)try{yield this.cancelSpeech()}catch(e){this.privSpeechState=r.Inactive}})))}get state(){return this.privSpeechState}set state(e){this.privSpeechState=e}onConnection(){this.privSpeechState=r.Connected}onDisconnection(){return w(this,void 0,void 0,(function*(){this.privSpeechState=r.Inactive,yield this.cancelSpeech()}))}fireCancelEvent(e){try{if(this.privTranslator.canceled){const t=new y.O(h._.Error,e,u.E.RuntimeError);this.privTranslator.canceled(this.privTranslator,t)}}catch(e){}}cancelSpeech(){var e;return w(this,void 0,void 0,(function*(){try{this.stopContinuousRecognitionAsync(),yield null===(e=this.privReco)||void 0===e?void 0:e.disconnect(),this.privSpeechState=r.Inactive}catch(e){}}))}}class P extends C.p{constructor(e){super(e),this.privErrors=n.m.restErrors,this.privIsDisposed=!1,this.privIsSpeaking=!1,this.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",this.privPlaceholderRegion="westus",this.privProperties=new d.O}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get participants(){var e;return null===(e=this.privConversation)||void 0===e?void 0:e.participants}get canSpeak(){return!(!this.privConversation.isConnected||!this.privCTRecognizer||this.privIsSpeaking||this.privCTRecognizer.state===r.Connected||this.privCTRecognizer.state===r.Connecting||this.privConversation.isMutedByHost)}setServiceProperty(e,t){const i=JSON.parse(this.privProperties.getProperty(s.ServicePropertiesPropertyName,"{}"));i[e]=t,this.privProperties.setProperty(s.ServicePropertiesPropertyName,JSON.stringify(i))}joinConversationAsync(e,t,i,r,o){try{if("string"==typeof e){c.a.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","conversation id")),c.a.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),o);let a=i;null!=a&&""!==a||(a=n.m.defaultLanguageCode),this.privSpeechTranslationConfig=l.f.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(v.P.Masked),this.privSpeechTranslationConfig.addTargetLanguage(a),this.privSpeechTranslationConfig.setProperty(g.o[g.o.SpeechServiceConnection_RecoLanguage],a),this.privSpeechTranslationConfig.setProperty(g.o[g.o.ConversationTranslator_Name],t);const p=[g.o.SpeechServiceConnection_Host,g.o.ConversationTranslator_Host,g.o.SpeechServiceConnection_Endpoint,g.o.SpeechServiceConnection_ProxyHostName,g.o.SpeechServiceConnection_ProxyPassword,g.o.SpeechServiceConnection_ProxyPort,g.o.SpeechServiceConnection_ProxyUserName,"ConversationTranslator_MultiChannelAudio","ConversationTranslator_Region"];for(const e of p){const t=this.privProperties.getProperty(e);if(t){const i="string"==typeof e?e:g.o[e];this.privSpeechTranslationConfig.setProperty(i,t)}}const h=JSON.parse(this.privProperties.getProperty(s.ServicePropertiesPropertyName,"{}"));for(const e of Object.keys(h))this.privSpeechTranslationConfig.setServiceProperty(e,h[e],m.a.UriQueryParameter);this.privConversation=new S.r(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(e,t,a,(e=>{e||this.handleError(new Error(this.privErrors.permissionDeniedConnect),o),this.privSpeechTranslationConfig.authorizationToken=e,this.privConversation.room.isHost=!1,this.privConversation.startConversationAsync((()=>{this.handleCallback(r,o)}),(e=>{this.handleError(e,o)}))}),(e=>{this.handleError(e,o)}))}else"object"==typeof e?(c.a.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","conversation id")),c.a.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(g.o.ConversationTranslator_Name,t),this.privConversation=e,this.privConversation.conversationTranslator=this,this.privConversation.room.isHost=!0,c.a.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),c.a.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=e.config,this.handleCallback(i,r)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),r)}catch(e){this.handleError(e,"string"==typeof i?o:r)}}leaveConversationAsync(e,t){(0,a.Kb)((()=>w(this,void 0,void 0,(function*(){yield this.cancelSpeech(),yield this.privConversation.endConversationImplAsync(),yield this.privConversation.deleteConversationImplAsync(),this.dispose()})))(),e,t)}sendTextMessageAsync(e,t,i){try{c.a.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),c.a.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}",e)),this.privConversation.sendTextMessageAsync(e,t,i)}catch(e){this.handleError(e,i)}}startTranscribingAsync(e,t){(0,a.Kb)((()=>w(this,void 0,void 0,(function*(){try{c.a.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),c.a.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),void 0===this.privCTRecognizer&&(yield this.connectTranslatorRecognizer()),c.a.throwIfNullOrUndefined(this.privCTRecognizer,this.privErrors.permissionDeniedSend),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),t),yield this.startContinuousRecognition(),this.privIsSpeaking=!0}catch(e){throw this.privIsSpeaking=!1,yield this.cancelSpeech(),e}})))(),e,t)}stopTranscribingAsync(e,t){(0,a.Kb)((()=>w(this,void 0,void 0,(function*(){try{if(!this.privIsSpeaking)return void(yield this.cancelSpeech());this.privIsSpeaking=!1,yield new Promise(((e,t)=>{this.privCTRecognizer.stopContinuousRecognitionAsync(e,t)}))}catch(e){yield this.cancelSpeech()}})))(),e,t)}isDisposed(){return this.privIsDisposed}dispose(e,t,i){(0,a.Kb)((()=>w(this,void 0,void 0,(function*(){this.isDisposed&&!this.privIsSpeaking||(yield this.cancelSpeech(),this.privIsDisposed=!0,this.privSpeechTranslationConfig.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,this.privConversation.dispose(),this.privConversation=void 0)})))(),t,i)}cancelSpeech(){var e;return w(this,void 0,void 0,(function*(){try{this.privIsSpeaking=!1,yield null===(e=this.privCTRecognizer)||void 0===e?void 0:e.onDisconnection(),this.privCTRecognizer=void 0}catch(e){}}))}connectTranslatorRecognizer(){return w(this,void 0,void 0,(function*(){try{void 0===this.privAudioConfig&&(this.privAudioConfig=f.rU.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(g.o[g.o.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(g.o[g.o.SpeechServiceConnection_Key],"");const e=()=>this.privConversation;this.privCTRecognizer=new R(this.privSpeechTranslationConfig,this.privAudioConfig,this,e)}catch(e){throw yield this.cancelSpeech(),e}}))}startContinuousRecognition(){return new Promise(((e,t)=>{this.privCTRecognizer.startContinuousRecognitionAsync(e,t)}))}}},13250:(e,t,i)=>{"use strict";i.d(t,{Q:()=>s,n:()=>n});var r=i(22874);class n{constructor(e){this.privUserId=e}get userId(){return this.privUserId}}class s{constructor(e,t,i,n,s,o,a,c){this.privId=e,this.privAvatar=t,this.privDisplayName=i,this.privIsHost=n,this.privIsMuted=s,this.privIsUsingTts=o,this.privPreferredLanguage=a,this.privVoice=c,this.privProperties=new r.O}get avatar(){return this.privAvatar}get displayName(){return this.privDisplayName}get id(){return this.privId}get preferredLanguage(){return this.privPreferredLanguage}get isHost(){return this.privIsHost}get isMuted(){return this.privIsMuted}get isUsingTts(){return this.privIsUsingTts}get voice(){return this.privVoice}get properties(){return this.privProperties}static From(e,t,i){return new s(e,"",e,!1,!1,!1,t,i)}}},97378:(e,t,i)=>{"use strict";var r;i.d(t,{T:()=>r}),function(e){e[e.JoinedConversation=0]="JoinedConversation",e[e.LeftConversation=1]="LeftConversation",e[e.Updated=2]="Updated"}(r||(r={}))},67762:(e,t,i)=>{"use strict";i.d(t,{j:()=>r});class r{constructor(e,t,i,r,n){this.privCancelReason=t,this.privErrorDetails=i,this.privResult=n,this.privSessionId=e,this.privErrorCode=r}get result(){return this.privResult}get sessionId(){return this.privSessionId}get reason(){return this.privCancelReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}},93062:(e,t,i)=>{"use strict";i.d(t,{s:()=>n});var r=i(99801);class n extends r.J{constructor(e,t,i){super(t,i),this.privResult=e}get result(){return this.privResult}}},43465:(e,t,i)=>{"use strict";i.d(t,{r:()=>n});var r=i(98670);class n extends r.b{constructor(e,t,i,r,n,s,o,a,c,p,h){super(t,i,r,n,s,o,a,void 0,c,p,h),this.privTranslations=e}static fromSpeechRecognitionResult(e){return new n(void 0,e.resultId,e.reason,e.text,e.duration,e.offset,e.language,e.languageDetectionConfidence,e.errorDetails,e.json,e.properties)}get translations(){return this.privTranslations}}},43078:(e,t,i)=>{"use strict";i.d(t,{M:()=>d});var r=i(56477),n=i(62029),s=i(33326),o=i(33182),a=i(53333),c=i(89513),p=i(44571),h=i(65453),u=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class d extends p.c{constructor(e,t,i){const n=e;c.a.throwIfNull(n,"speechConfig"),super(t,n.properties,i||new r.x),this.privDisposedTranslationRecognizer=!1,void 0!==this.properties.getProperty(h.o.SpeechServiceConnection_TranslationVoice,void 0)&&c.a.throwIfNullOrWhitespace(this.properties.getProperty(h.o.SpeechServiceConnection_TranslationVoice),h.o[h.o.SpeechServiceConnection_TranslationVoice]),c.a.throwIfNullOrWhitespace(this.properties.getProperty(h.o.SpeechServiceConnection_TranslationToLanguages),h.o[h.o.SpeechServiceConnection_TranslationToLanguages]),c.a.throwIfNullOrWhitespace(this.properties.getProperty(h.o.SpeechServiceConnection_RecoLanguage),h.o[h.o.SpeechServiceConnection_RecoLanguage])}static FromConfig(e,t,i){const r=e;return t.properties.mergeTo(r.properties),new d(e,i)}get speechRecognitionLanguage(){return c.a.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(h.o.SpeechServiceConnection_RecoLanguage)}get targetLanguages(){return c.a.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(h.o.SpeechServiceConnection_TranslationToLanguages).split(",")}get voiceName(){return c.a.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(h.o.SpeechServiceConnection_TranslationVoice,void 0)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(h.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.properties.setProperty(h.o.SpeechServiceAuthorization_Token,e)}recognizeOnceAsync(e,t){c.a.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,o.Kb)(this.recognizeOnceAsyncImpl(n.jf.Conversation),e,t)}startContinuousRecognitionAsync(e,t){(0,o.Kb)(this.startContinuousRecognitionAsyncImpl(n.jf.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){(0,o.Kb)(this.stopContinuousRecognitionAsyncImpl(),e,t)}removeTargetLanguage(e){if(c.a.throwIfNullOrUndefined(e,"language to be removed"),void 0!==this.properties.getProperty(h.o.SpeechServiceConnection_TranslationToLanguages,void 0)){const t=this.properties.getProperty(h.o.SpeechServiceConnection_TranslationToLanguages).split(","),i=t.indexOf(e);i>-1&&(t.splice(i,1),this.properties.setProperty(h.o.SpeechServiceConnection_TranslationToLanguages,t.join(",")),this.updateLanguages(t))}}addTargetLanguage(e){c.a.throwIfNullOrUndefined(e,"language to be added");let t=[];void 0!==this.properties.getProperty(h.o.SpeechServiceConnection_TranslationToLanguages,void 0)?(t=this.properties.getProperty(h.o.SpeechServiceConnection_TranslationToLanguages).split(","),t.includes(e)||(t.push(e),this.properties.setProperty(h.o.SpeechServiceConnection_TranslationToLanguages,t.join(",")))):(this.properties.setProperty(h.o.SpeechServiceConnection_TranslationToLanguages,e),t=[e]),this.updateLanguages(t)}close(e,t){c.a.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,o.Kb)(this.dispose(!0),e,t)}onConnection(){}onDisconnection(){return u(this,void 0,void 0,(function*(){}))}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return u(this,void 0,void 0,(function*(){this.privDisposedTranslationRecognizer||(this.privDisposedTranslationRecognizer=!0,e&&(yield this.implRecognizerStop(),yield t.dispose.call(this,e)))}))}createRecognizerConfig(e){return new n.Xj(e,this.privProperties)}createServiceRecognizer(e,t,i,r){const n=i;return new s.h(e,t,n,r,this)}updateLanguages(e){const t=a.e.fromRecognizer(this);t&&(t.setMessageProperty("speech.context","translationcontext",{to:e}),t.sendMessageAsync("event",JSON.stringify({id:"translation",name:"updateLanguage",to:e})))}}},65250:(e,t,i)=>{"use strict";i.d(t,{v:()=>n});var r=i(7841);class n extends r.${constructor(e,t){super(t),this.privResult=e}get result(){return this.privResult}}},35890:(e,t,i)=>{"use strict";i.d(t,{S:()=>r});class r{constructor(e,t){this.privReason=e,this.privAudio=t}get audio(){return this.privAudio}get reason(){return this.privReason}}},40649:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});var r=i(22874);class n{constructor(){this.privMap=new r.O}get languages(){return this.privMap.keys}get(e,t){return this.privMap.getProperty(e,t)}set(e,t){this.privMap.setProperty(e,t)}}},27040:(e,t,i)=>{"use strict";i.d(t,{Q:()=>n});var r=i(73795);class n{constructor(e){this.privTurnStatus=r.n.fromJSON(e)}get interactionId(){return this.privTurnStatus.interactionId}get conversationId(){return this.privTurnStatus.conversationId}get statusCode(){return this.privTurnStatus.statusCode}}},71520:(e,t,i)=>{"use strict";var r,n;i.d(t,{R$:()=>s}),function(e){e[e.Unknown=0]="Unknown",e[e.Female=1]="Female",e[e.Male=2]="Male"}(r||(r={})),function(e){e[e.OnlineNeural=1]="OnlineNeural",e[e.OnlineStandard=2]="OnlineStandard",e[e.OfflineNeural=3]="OfflineNeural",e[e.OfflineStandard=4]="OfflineStandard"}(n||(n={}));class s{constructor(e){if(this.privStyleList=[],this.privVoicePath="",e&&(this.privName=e.Name,this.privLocale=e.Locale,this.privShortName=e.ShortName,this.privLocaleName=e.LocaleName,this.privLocalName=e.LocalName,this.privVoiceType=e.VoiceType.endsWith("Standard")?n.OnlineStandard:n.OnlineNeural,this.privGender="Male"===e.Gender?r.Male:"Female"===e.Gender?r.Female:r.Unknown,e.StyleList&&Array.isArray(e.StyleList)))for(const t of e.StyleList)this.privStyleList.push(t)}get name(){return this.privName}get locale(){return this.privLocale}get shortName(){return this.privShortName}get localName(){return this.privLocalName}get localeName(){return this.privLocaleName}get gender(){return this.privGender}get voiceType(){return this.privVoiceType}get styleList(){return this.privStyleList}get voicePath(){return this.privVoicePath}}},725:(e,t,i)=>{"use strict";i.d(t,{L:()=>r});class r{constructor(e,t){this.privId=e,this.privProfileType=t}get profileId(){return this.privId}get profileType(){return this.privProfileType}}},50328:(e,t,i)=>{"use strict";i.d(t,{G:()=>g});var r=i(81667),n=i(84983),s=i(62029),o=i(66e3),a=i(89513),c=i(44571),p=i(80309),h=i(65453),u=i(725),d=i(62437),l=i(91048),v=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class g extends c.c{constructor(e){a.a.throwIfNullOrUndefined(e,"speechConfig");const t=e;a.a.throwIfNull(t,"speechConfig"),super(o.rU.fromStreamInput(p.yk.createPushStream()),t.properties,new r.m),this.privProperties=t.properties.clone(),this.privVoiceAdapter=this.privReco,this.privDisposedVoiceAdapter=!1}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(h.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){a.a.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(h.o.SpeechServiceAuthorization_Token,e)}createProfileAsync(e,t){return v(this,void 0,void 0,(function*(){const i=yield this.privVoiceAdapter.createProfile(e,t);return new u.L(i[0],e)}))}retrieveEnrollmentResultAsync(e){return v(this,void 0,void 0,(function*(){return this.privVoiceAdapter.retrieveEnrollmentResult(e)}))}getAllProfilesAsync(e){return v(this,void 0,void 0,(function*(){return this.privVoiceAdapter.getAllProfiles(e)}))}getActivationPhrasesAsync(e,t){return v(this,void 0,void 0,(function*(){return this.privVoiceAdapter.getActivationPhrases(e,t)}))}enrollProfileAsync(e,t){return v(this,void 0,void 0,(function*(){const i=t;return a.a.throwIfNullOrUndefined(i,"audioConfig"),this.audioConfig=t,this.privVoiceAdapter.SpeakerAudioSource=i,this.privVoiceAdapter.enrollProfile(e)}))}deleteProfileAsync(e){return v(this,void 0,void 0,(function*(){return this.privVoiceAdapter.deleteProfile(e)}))}resetProfileAsync(e){return v(this,void 0,void 0,(function*(){return this.privVoiceAdapter.resetProfile(e)}))}close(){return v(this,void 0,void 0,(function*(){yield this.dispose(!0)}))}createServiceRecognizer(e,t,i,r){const s=i;return new n.E(e,t,s,r,this)}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return v(this,void 0,void 0,(function*(){this.privDisposedVoiceAdapter||(this.privDisposedVoiceAdapter=!0,e&&(yield t.dispose.call(this,e)))}))}createRecognizerConfig(e){return new s.Xj(e,this.properties)}getResult(e,t){return new d.A(e.ok?t:l.s.Canceled,e.statusText)}}},93341:(e,t,i)=>{"use strict";i.d(t,{f:()=>p,s:()=>h});var r=i(62389),n=i(22874),s=i(91048),o=i(98563),a=i(59654),c=i(6550);class p{constructor(e,t,i){this.privReason=e,this.privProperties=new n.O,this.privReason!==s.s.Canceled?t&&(this.privDetails=JSON.parse(t),"enrolling"===this.privDetails.enrollmentStatus.toLowerCase()&&(this.privReason=s.s.EnrollingVoiceProfile)):(this.privErrorDetails=i,this.privProperties.setProperty(r.CancellationErrorCodePropertyName,o.E[o.E.ServiceError]))}get reason(){return this.privReason}get enrollmentsCount(){return this.privDetails.enrollmentsCount}get enrollmentsLength(){return this.privDetails.enrollmentsLength}get properties(){return this.privProperties}get enrollmentResultDetails(){return this.privDetails}get errorDetails(){return this.privErrorDetails}static FromIdentificationProfileList(e){const t=[];for(const i of e.value){const e="enrolling"===i.enrollmentStatus.toLowerCase()?s.s.EnrollingVoiceProfile:"enrolled"===i.enrollmentStatus.toLowerCase()?s.s.EnrolledVoiceProfile:s.s.Canceled,r=new p(e,null,null);r.privDetails=this.getIdentificationDetails(i),t.push(r)}return t}static FromVerificationProfileList(e){const t=[];for(const i of e.value){const e="enrolling"===i.enrollmentStatus.toLowerCase()?s.s.EnrollingVoiceProfile:"enrolled"===i.enrollmentStatus.toLowerCase()?s.s.EnrolledVoiceProfile:s.s.Canceled,r=new p(e,null,null);r.privDetails=this.getVerificationDetails(i),t.push(r)}return t}static getIdentificationDetails(e){return{audioLength:e.audioLength?parseFloat(e.audioLength):0,audioSpeechLength:e.audioSpeechLength?parseFloat(e.audioSpeechLength):0,enrollmentStatus:e.enrollmentStatus,enrollmentsCount:e.enrollmentsCount||0,enrollmentsLength:e.enrollmentsLength?parseFloat(e.enrollmentsLength):0,enrollmentsSpeechLength:e.enrollmentsSpeechLength?parseFloat(e.enrollmentsSpeechLength):0,profileId:e.profileId||e.identificationProfileId,remainingEnrollmentsSpeechLength:e.remainingEnrollmentsSpeechLength?parseFloat(e.remainingEnrollmentsSpeechLength):0}}static getVerificationDetails(e){return{audioLength:e.audioLength?parseFloat(e.audioLength):0,audioSpeechLength:e.audioSpeechLength?parseFloat(e.audioSpeechLength):0,enrollmentStatus:e.enrollmentStatus,enrollmentsCount:e.enrollmentsCount,enrollmentsLength:e.enrollmentsLength?parseFloat(e.enrollmentsLength):0,enrollmentsSpeechLength:e.enrollmentsSpeechLength?parseFloat(e.enrollmentsSpeechLength):0,profileId:e.profileId||e.verificationProfileId,remainingEnrollmentsCount:e.remainingEnrollments||e.remainingEnrollmentsCount,remainingEnrollmentsSpeechLength:e.remainingEnrollmentsSpeechLength?parseFloat(e.remainingEnrollmentsSpeechLength):0}}}class h extends a.v{constructor(e,t,i){super(e,t,i)}static fromResult(e){const t=c._.Error;let i=o.E.NoError;return e.properties&&(i=o.E[e.properties.getProperty(r.CancellationErrorCodePropertyName,o.E[o.E.NoError])]),new h(t,e.errorDetails,i)}}},97562:(e,t,i)=>{"use strict";i.d(t,{U:()=>s});var r=i(89513),n=i(62437);class s extends n.A{constructor(e,t,i,n){super(e,t),this.privPhrases=[],r.a.throwIfNullOrUndefined(n,"phrase array"),this.privType=i,n&&n[0]&&(this.privPhrases=n)}get phrases(){return this.privPhrases}get type(){return this.privType}}},62437:(e,t,i)=>{"use strict";i.d(t,{A:()=>h,O:()=>u});var r=i(62389),n=i(89513),s=i(22874),o=i(91048),a=i(98563),c=i(59654),p=i(6550);class h{constructor(e,t){this.privReason=e,this.privProperties=new s.O,e===o.s.Canceled&&(n.a.throwIfNullOrUndefined(t,"statusText"),this.privErrorDetails=t,this.privProperties.setProperty(r.CancellationErrorCodePropertyName,a.E[a.E.ServiceError]))}get reason(){return this.privReason}get properties(){return this.privProperties}get errorDetails(){return this.privErrorDetails}}class u extends c.v{constructor(e,t,i){super(e,t,i)}static fromResult(e){const t=p._.Error;let i=a.E.NoError;return e.properties&&(i=a.E[e.properties.getProperty(r.CancellationErrorCodePropertyName,a.E[a.E.NoError])]),new u(t,e.errorDetails,i)}}},38345:(e,t,i)=>{"use strict";var r;i.d(t,{f:()=>r}),function(e){e[e.TextIndependentIdentification=0]="TextIndependentIdentification",e[e.TextDependentVerification=1]="TextDependentVerification",e[e.TextIndependentVerification=2]="TextIndependentVerification"}(r||(r={}))},60112:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.models=t.freeModels=void 0,t.freeModels=[{name:"Google: Gemini Flash Lite 2.0 Preview (free)",id:"google/gemini-2.0-flash-lite-preview-02-05:free"},{name:"Meta: Llama 3.3 70B Instruct (free)",id:"meta-llama/llama-3.3-70b-instruct:free"},{name:"Google: Gemma 2 9B (free)",id:"google/gemma-2-9b-it:free"},{name:"Meta: Llama 3.1 8B Instruct (free)",id:"meta-llama/llama-3.1-8b-instruct:free"},{name:"Phi-3 Mini 128K Instruct (free)",id:"microsoft/phi-3-mini-128k-instruct:free"},{name:"Phi-3 Medium 128K Instruct (free)",id:"microsoft/phi-3-medium-128k-instruct:free"},{name:"OpenChat 3.5 (free)",id:"openchat/openchat-7b:free"},{name:"Mistral 7B Instruct (free)",id:"mistralai/mistral-7b-instruct:free"}],t.models=[...t.freeModels,{name:"OpenAI: o3 Mini",id:"openai/o3-mini"},{name:"Anthropic: Claude 3.5 Haiku",id:"anthropic/claude-3.5-haiku"},{name:"OpenAI: o1-mini (2024-09-12)",id:"openai/o1-mini-2024-09-12"},{name:"gpt-3.5-turbo",id:"openai/gpt-3.5-turbo"},{name:"gpt-3.5-turbo-16k",id:"openai/gpt-3.5-turbo-16k"},{name:"OpenAI: GPT-4o",id:"openai/gpt-4o"},{name:"gpt-4",id:"openai/gpt-4"},{name:"gpt-4-32k",id:"openai/gpt-4-32k"},{name:"Google: Gemini Pro 1.0",id:"google/gemini-pro"},{name:"Google: PaLM 2 Chat 32k",id:"google/palm-2-chat-bison-32k"},{name:"Anthropic: Claude 3 Haiku",id:"anthropic/claude-3-haiku"},{name:"Anthropic: Claude 3 Opus",id:"anthropic/claude-3-opus"},{name:"claude-2",id:"anthropic/claude-2"},{name:"claude-instant-v1",id:"anthropic/claude-instant-v1"},{name:"PaLM 2 Bison",id:"google/palm-2-chat-bison"},{name:"Llama v2 13B Chat (beta)",id:"meta-llama/llama-2-13b-chat"}]},62569:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.saveOptions=t.getSettings=void 0;const s=n(i(93150)),o=i(60112);t.getSettings=function(){return r(this,void 0,void 0,(function*(){let e=yield s.default.storage.sync.get({openApiKey:"",openApiEndpoint:"https://api.openai.com",openApiModel:"gpt-4o-mini",unsplashApiKey:"",currentLanguage:"Chinese Simplified",targetLanguage:"United States",ankiSettings:[],ankiDeckName:"",ankiNoteName:"",ankiFields:[],licenseKey:"",showYoutubeButton:!0,model:o.models[0].id,freeModel:o.freeModels[0].id,apiKeySelection:"scouterFreeAI",newLicenseKey:"",contextMenu:!1,contextMenuBlackList:"",ollamaModel:"llama2",ollamaApiEndpoint:"http://localhost:11434",userId:"",contentEditable:!1}),t=e.ankiSettings;if(0===e.ankiSettings.length&&(t=[{ankiDeckName:"Default",ankiFields:[{Front:"The default note is not editable"},{Back:"The default note is not editable"}],ankiNoteName:"Scouter"},{ankiDeckName:"Default",ankiFields:[{Front:"The default note is not editable"},{Back:"The default note is not editable"}],ankiNoteName:"Scouter Cloze Text"}],""!==e.ankiDeckName&&""!==e.ankiNoteName)){const i={ankiDeckName:e.ankiDeckName,ankiFields:Object.entries(e.ankiFields).map((([e,t])=>({[e]:t}))),ankiNoteName:e.ankiNoteName};t.unshift(i)}return e.ankiSettings=[...t],e}))},t.saveOptions=function(e){return r(this,void 0,void 0,(function*(){const t=Object.entries(e);for(const[e,i]of t)console.log(`Key: ${e}, Value: ${i}`),yield s.default.storage.sync.set({[e]:i})}))}},64985:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(i(93150)),o=i(29882),a=i(90199),c=i(62569),p=i(29882),h=i(29882);let u;try{(0,h.getUserInfo)().then((e=>{u=e.userId}))}catch(e){console.log(e)}let d,l=new AbortController;s.default.runtime.onInstalled.addListener((function(e){"install"===e.reason&&s.default.tabs.create({url:"welcome.html"})})),s.default.runtime.setUninstallURL("https://docs.google.com/forms/d/e/1FAIpQLSdobGQN3O0Ck4fVrgfvRZMme3de-2OaEp1pFtibZkU0koc37w/viewform?usp=sf_link"),s.default.action.onClicked.addListener((function(e){console.log("点击插件按钮")})),s.default.contextMenus.create({id:"2",title:"Run last prompt",contexts:["selection"]},(()=>{s.default.runtime.lastError})),s.default.contextMenus.create({id:"1",title:"Open",contexts:["selection"]},(()=>{s.default.runtime.lastError})),s.default.contextMenus.create({id:"3",title:"Summarize",contexts:["page"]},(()=>{s.default.runtime.lastError})),s.default.contextMenus.onClicked.addListener((function(e,t){return r(this,void 0,void 0,(function*(){const t="2"===e.menuItemId;v(e.menuItemId,t)}))})),s.default.tabs.onUpdated.addListener((function(e,t,i){t.url&&t.url.indexOf("youtube.com")&&s.default.tabs.sendMessage(e,{type:"tabOnUpdated",data:{locateInYouTube:!0}})})),s.default.commands.onCommand.addListener((function(e){"RunLastPrompt"===e&&v(),"Open"===e&&v("",!1)})),s.default.runtime.onConnect.addListener((e=>{console.log("连接中------------"),console.log(e),"fromPopupCard"===e.name&&(d=e,console.log("port.name === 'fromPopupCard'")),e.onMessage.addListener((t=>r(void 0,void 0,void 0,(function*(){var i;if(console.log("接收消息：",t),"StopTheConversation"===t.type&&l.abort(),"getKnowledge"===t.type){if(t.option&&t.option.dictionary){console.log(t);const i=t.option.dictionary;for(const r of i)if("youdao"===r){const i=yield(0,o.getDictionaryData)(t.keyWord);console.log(i),e.postMessage({type:"sendGPTData",status:"process",content:`${i}\n\n---\n`})}}l.abort(),l=new AbortController,console.log("getAIParameter:");try{const r=yield(0,h.getAIParameter)(t.messages),n=null===(i=r.data)||void 0===i?void 0:i.chatCompletions.url;if(r.data&&void 0!==n){let t=r.data.chatCompletions.body;const i={method:"POST",signal:l.signal,headers:r.data.chatCompletions.headers,body:JSON.stringify(t)},s=r.apiKeySelection;console.log("ApiType:"),console.log(s),console.log("body:"),console.log(t),"chatGPTWeb"===s?e.postMessage({type:"sendGPTData",status:"done",content:"⚠️ ChatGPT Web is temporarily not supported. Please switch to another method."}):(0,p.fetchSSE)(n,i,{onMessage:t=>{if("ollama"===s)e.postMessage({type:"sendGPTData",ApiType:s,status:"process",content:t});else if(t.choices.length>0){const i=t.choices[0].finish_reason;"stop"!==i&&e.postMessage({type:"sendGPTData",ApiType:s,status:"process",content:t.choices[0].delta.content?t.choices[0].delta.content:""}),"scouterFreeAI"!==s&&"licenseKey"!==s||"error"!==i||e.postMessage({type:"sendGPTData",ApiType:s,status:"process",content:`🥲error: ${t.choices[0].error.message}`})}},onEnd:()=>{e.postMessage({type:"sendGPTData",status:"done",content:""})},onError:t=>{if(console.log(t),t.message.indexOf("aborted")>=0);else{const i="🥲Sorry, an error happened, please retry.";e.postMessage({type:"sendGPTData",status:"error",content:i+"("+t.message+")",code:t.message})}}},s)}else e.postMessage({type:"sendGPTData",status:"invalid_api_key",content:"🥲 API Key error. Please modify and try again.."})}catch(t){e.postMessage({type:"sendGPTData",status:"error",content:t?"🥲 "+t:"🥲 Something went wrong, please try again later."})}}if("getDictionaryData"===t.type){const i=yield(0,o.getDictionaryData)(t.keyWord);e.postMessage({type:"sendGPTData",status:"done",content:i})}"UPDATE_POPUP_CARD"===t.type&&d.postMessage(t)}))))})),s.default.runtime.onMessage.addListener((function(e,t,i){console.log("Message from the content script: "+e.type);const n=e=>r(this,void 0,void 0,(function*(){try{yield i(e)}catch(e){console.error(e)}}));if("getUnsplashImages"===e.type)return console.log("background getUnsplashImages:"),e.keyWord&&(0,o.unsplashSearchPhotos)("t8eOwEDwJEGJe7mYWDleFDBK_EM0SaF1hK_4KYfcD_8",e.keyWord).then((e=>{n({type:"sendImgData",status:"end",imgs:e})})).catch((e=>{console.log(e)})),!0;if("addNote"===e.type){console.log("addNote");const t=(0,a.createApi)({accessKey:"t8eOwEDwJEGJe7mYWDleFDBK_EM0SaF1hK_4KYfcD_8"});return void 0!==e.messages.unsplash_download_location&&""!==e.messages.unsplash_download_location&&t.photos.trackDownload({downloadLocation:e.messages.unsplash_download_location}).then((e=>console.log(e))),(0,o.ankiAction)(e.messages.anki_action_type,6,e.messages.anki_arguments).then((e=>{n({type:"addToAnki",result:"success",data:e.result,error:e.error})})).catch((e=>{console.error(e),n({type:"addToAnki",result:"failure",error:e.error})})),!0}if("setModel"===e.type)return(()=>{r(this,void 0,void 0,(function*(){const e=yield(0,c.getSettings)();let t;try{const e=yield(0,o.ankiAction)("deckNames",6);e.error||(t=e)}catch(e){n({type:"setModel",result:"failure",error:e.error})}if(e.ankiSettings.some((e=>"Scouter"===e.ankiNoteName||"Scouter Cloze Text"===e.ankiNoteName))){const e=yield(0,o.ankiAction)("modelNames",6);if(e.error)n({type:"setModel",result:"failure",error:e.error});else{const t=e.result.filter((e=>"Scouter"===e)),i=e.result.filter((e=>"Scouter Cloze Text"===e));t.length<1&&(0,o.ankiAction)("createModel",6,{modelName:"Scouter",inOrderFields:["Front","Back"],cardTemplates:[{name:"Card1",Front:"{{Front}}",Back:"{{Front}}\n                <hr id=answer>\n                {{Back}}"}],isCloze:!1,css:p.cardStyle}),i.length<1&&(0,o.ankiAction)("createModel",6,{modelName:"Scouter Cloze Text",inOrderFields:["Text","More"],cardTemplates:[{name:"Card2",Front:"{{cloze:Text}}",Back:"{{cloze:Text}}\n                              <br>{{More}}"}],isCloze:!1,css:p.cardStyle})}}n({type:"setModel",result:"success",data:{deckAndNoteList:e.ankiSettings,deckNames:t.result}})}))})(),!0;if("guiEditNote"===e.type)return(0,o.ankiAction)(e.messages.anki_action_type,6,e.messages.anki_arguments).then((e=>{n({type:"guiEditNote",result:"success",data:e.result,error:e.error})})).catch((e=>{console.error(e),n({type:"guiEditNote",result:"failure",error:e.error})})),!0;if("ankiAction"===e.type)return(0,o.ankiAction)(e.messages.anki_action_type,6,e.messages.anki_arguments).then((e=>{n(e)})).catch((e=>{n(e)})),!0;if("amplitudeTrack"===e.type&&fetch("https://api.amplitude.com/2/httpapi",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_key:"ed720e33b4190ef29a0718a040bbb55a",events:[{user_id:u,event_type:e.name}]})}).then((e=>e.json())).then((e=>console.log(e))).catch((e=>{console.error("Error:",e)})),"getUserStatus"===e.type&&(0,c.getSettings)().then((e=>{const t=e.licenseKey,i=(0,h.getBalance)(t);return n(i),console.log(i),!0})),"getUserInfo"===e.type)return(0,h.getUserInfo)().then((e=>{n(e)})),!0;if("generationsImages"===e.type){const t=(0,h.generationsImages)(e.data.prompt);return n(t),!0}"UPDATE_POPUP_CARD"===e.type&&(console.log("sendMessage"),d.postMessage(e))}));const v=(e,t)=>{let i=t,r=e;void 0===i&&(i=!0),void 0===r&&(r=""),"3"!==r?s.default.tabs.query({active:!0,currentWindow:!0}).then((e=>{var t;const n=e[0];let o=null!==(t=n.id)&&void 0!==t?t:-1;n&&void 0!==n.id&&s.default.tabs.sendMessage(o,{type:"open-scouter",actionId:r,runPrompt:i})})):s.default.tabs.query({active:!0,currentWindow:!0}).then((e=>{var t;const i=e[0];let r=null!==(t=i.id)&&void 0!==t?t:-1;i&&void 0!==i.id&&s.default.tabs.sendMessage(r,{type:"summarize"})}))}},71214:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.fetchcurrentLanguage=t.languageCodes=t.lang=void 0;const s=n(i(93150));t.lang={Arabic:{name:"العربية",id:"Arabic",Prompt1:{explanation:"استخدام اللغة العربية لتفسير معنى الكلمات ودورها النحوي في الجملة"},Prompt2:{translate:"ترجمة الجمل إلى العربية",explanation:"شرح المعرفة النحوية"},Prompt3:{validation:"بوصفك خبيرًا في اللغة، يرجى التحقق من الجمل التي قدمتها. إذا كانت الجملة غير صحيحة، فأشر على الخطأ باللغة العربية وقدم الجملة المصححة. الجملة:"},audioURL:"https://dict.youdao.com/dictvoice?le=ar&type=0&audio="},"Chinese Simplified":{name:"简体中文",id:"Chinese Simplified",Prompt1:{explanation:"使用中文解释单词在句子中的含义和语法作用"},Prompt2:{translate:"将句子翻译为中文",explanation:"解释语法知识"},Prompt3:{validation:"作为一个语言专家，请检查我提供的句子。如果句子不正确，那么用中文指出错误，并提供修改后的句子。句子："},audioURL:"https://dict.youdao.com/dictvoice?le=zh&type=0&audio="},"Chinese Traditional":{name:"繁體中文",id:"Chinese Traditional",Prompt1:{explanation:"使用繁體中文解釋單詞在句子中的含義和語法作用"},Prompt2:{translate:"將句子翻譯為繁體中文",explanation:"解釋語法知識"},Prompt3:{validation:"作為一個語言專家，請檢查我提供的句子。如果句子不正確，那麼用繁體中文指出錯誤，並提供修改後的句子。句子："},audioURL:"https://dict.youdao.com/dictvoice?le=zh&type=0&audio="},Dutch:{name:"Nederlands",id:"Dutch",Prompt1:{explanation:"Gebruik het Nederlands om de betekenis van woorden en hun grammaticale rol in de zin uit te leggen"},Prompt2:{translate:"Vertaal de zin naar het Nederlands",explanation:"Leg de grammaticale kennis uit"},Prompt3:{validation:"Als taalexpert, controleer de zin die ik heb gegeven. Als de zin onjuist is, wijs dan de fout aan in het Nederlands en geef de gecorrigeerde zin. Zin:"},audioURL:"https://dict.youdao.com/dictvoice?le=nl&type=0&audio="},"United States":{name:"English",id:"United States",Prompt1:{explanation:"Use English to explain the meaning and grammatical role of words in sentences"},Prompt2:{translate:"Translate sentences into English",explanation:"Explain grammatical knowledge"},Prompt3:{validation:"As a language expert, please check the sentences I provided. If the sentence is incorrect, then point out the error in English and provide the corrected sentence. Sentence:"},audioURL:"https://dict.youdao.com/dictvoice?type=0&audio="},"United Kingdom":{name:"English",id:"United Kingdom",Prompt1:{explanation:"Use English to explain the meaning and grammatical role of words in sentences"},Prompt2:{translate:"Translate sentences into English",explanation:"Explain grammatical knowledge"},Prompt3:{validation:"As a language expert, please check the sentences I provided. If the sentence is incorrect, then point out the error in English and provide the corrected sentence. Sentence:"},audioURL:"https://dict.youdao.com/dictvoice?type=1&audio="},French:{name:"Français",id:"French",Prompt1:{explanation:"Utilisez le français pour expliquer la signification des mots et leur rôle grammatical dans la phrase"},Prompt2:{translate:"Traduisez la phrase en français",explanation:"Expliquez les connaissances grammaticales"},Prompt3:{validation:"En tant qu'expert en langues, veuillez vérifier la phrase que j'ai fournie. Si la phrase est incorrecte, veuillez indiquer l'erreur en français et fournir la phrase corrigée.La phrase: "},audioURL:"https://dict.youdao.com/dictvoice?le=fr&type=0&audio="},German:{name:"Deutsch",id:"German",Prompt1:{explanation:"Verwenden Sie Deutsch, um die Bedeutung von Wörtern und ihre grammatikalische Rolle im Satz zu erklären"},Prompt2:{translate:"Übersetzen Sie den Satz ins Deutsche",explanation:"Erklären Sie grammatikalische Kenntnisse"},Prompt3:{validation:"Als Sprachexperte überprüfen Sie bitte den von mir bereitgestellten Satz. Wenn der Satz falsch ist, geben Sie bitte den Fehler auf Deutsch an und geben Sie den korrigierten Satz an. Der Satz:"},audioURL:"https://dict.youdao.com/dictvoice?le=de&type=0&audio="},Hindi:{name:"हिन्दी",id:"Hindi",Prompt1:{explanation:"शब्दों के अर्थ और वाक्य में उनकी व्याकरणिक भूमिका का विवरण देने के लिए हिंदी का उपयोग करें"},Prompt2:{translate:"वाक्य का हिंदी में अनुवाद करें",explanation:"व्याकरण ज्ञान का विवरण दें"},Prompt3:{validation:"भाषा विशेषज्ञ के रूप में, कृपया मैंने पेश किए गए वाक्यों की जांच करें। यदि वाक्य गलत है, तो कृपया हिंदी में त्रुटि बताएं और सही किए गए वाक्य प्रदान करें। वाक्य:"},audioURL:"https://dict.youdao.com/dictvoice?le=hi&type=0&audio="},Indonesian:{name:"Bahasa Indonesia",id:"Indonesian",Prompt1:{explanation:"Menggunakan bahasa Indonesia untuk menjelaskan makna kata dan peran gramatikalnya dalam kalimat"},Prompt2:{translate:"Menerjemahkan kalimat ke dalam bahasa Indonesia",explanation:"Menjelaskan pengetahuan tata bahasa"},Prompt3:{validation:"Sebagai ahli bahasa, mohon periksa kalimat yang saya berikan. Jika kalimat tidak benar, tolong tunjukkan kesalahannya dalam bahasa Indonesia dan berikan kalimat yang benar. Kalimat:"},audioURL:"https://dict.youdao.com/dictvoice?le=id&type=0&audio="},Italian:{name:"Italiano",id:"Italian",Prompt1:{explanation:"Usa l'italiano per spiegare il significato delle parole e il loro ruolo grammaticale nella frase"},Prompt2:{translate:"Tradurre la frase in italiano",explanation:"Spiegazione della conoscenza grammaticale"},Prompt3:{validation:"In quanto esperto di lingua, controlla la frase che ho fornito. Se la frase non è corretta, indica l'errore in italiano e fornisci la frase corretta. Frase:"},audioURL:"https://dict.youdao.com/dictvoice?le=it&type=0&audio="},Japanese:{name:"日本語",id:"Japanese",Prompt1:{explanation:"単語の意味と文法上の役割を説明するために日本語を使用する"},Prompt2:{translate:"文を日本語に翻訳する",explanation:"文法的な知識の説明"},Prompt3:{validation:"言語の専門家として、提供された文章を確認してください。文章が正しくない場合は、日本語でエラーを指摘し、修正後の文章を提供してください。文章："},audioURL:"https://dict.youdao.com/dictvoice?le=jap&type=0&audio="},Korean:{name:"한국어",id:"Korean",Prompt1:{explanation:"단어의 의미와 문장에서의 문법적 역할을 설명하기 위해 한국어를 사용합니다."},Prompt2:{translate:"문장을 한국어로 번역하세요.",explanation:"문법 지식 설명"},Prompt3:{validation:"언어 전문가로서 제시한 문장을 확인해 주세요. 만약 문장이 틀렸다면, 한국어로 오류를 지적하고 수정된 문장을 제시해 주세요. 문장: "},audioURL:"https://dict.youdao.com/dictvoice?le=ko&type=0&audio="},Portuguese:{name:"Português",id:"Portuguese",Prompt1:{explanation:"Usar o português para explicar o significado das palavras e o papel gramatical delas na frase"},Prompt2:{translate:"Traduza a frase para o português",explanation:"Explicação do conhecimento gramatical"},Prompt3:{validation:"Como especialista em linguagem, verifique a frase que eu forneci. Se a frase estiver incorreta, indique o erro em português e forneça a frase corrigida. Frase: "},audioURL:"https://dict.youdao.com/dictvoice?le=pt&type=0&audio="},Russian:{name:"Русский",id:"Russian",Prompt1:{explanation:"Используйте русский язык, чтобы объяснить значение слов и их грамматическую роль в предложении"},Prompt2:{translate:"Перевести предложение на русский язык",explanation:"Объяснение грамматических знаний"},Prompt3:{validation:"В качестве эксперта по языку, пожалуйста, проверьте предложение, которое я представил. Если предложение неверное, то пожалуйста, указывайте ошибку на русском языке и предоставляйте исправленное предложение. Предложение:"},audioURL:"https://dict.youdao.com/dictvoice?le=ru&type=0&audio="},Spanish:{name:"Español",id:"Spanish",Prompt1:{explanation:"Utilice el español para explicar el significado de las palabras y su función gramatical en la oración"},Prompt2:{translate:"Traducir la oración al español",explanation:"Explicación de conocimientos gramaticales"},Prompt3:{validation:"Como experto en idiomas, por favor, compruebe la oración que he proporcionado. Si la oración es incorrecta, por favor, indique el error en español y proporcione la oración corregida. Oración:"},audioURL:"https://dict.youdao.com/dictvoice?le=es&type=0&audio="},Turkish:{name:"Türkçe",id:"Turkish",Prompt1:{explanation:"Kelimelerin anlamını ve cümledeki dilbilgisel rolünü açıklamak için Türkçeyi kullanın"},Prompt2:{translate:"Cümleyi Türkçeye çevirin",explanation:"Dilbilgisi bilgisi açıklaması"},Prompt3:{validation:"Dil uzmanı olarak, lütfen sunduğum cümleyi kontrol edin. Eğer cümle yanlışsa, lütfen hatayı Türkçe olarak belirtin ve düzeltilmiş cümleyi sağlayın. Cümle:"},audioURL:"https://dict.youdao.com/dictvoice?le=tr&type=0&audio="}},t.languageCodes={Arabic:"ar-AE-FatimaNeural","Chinese Simplified":"zh-CN-XiaoxiaoNeural","Chinese Traditional":"zh-TW-HsiaoChenNeural",Dutch:"nl-NL-ColetteNeural",English:"en-US-AriaNeural","United States":"en-US-AriaNeural","United Kingdom":"en-GB-LibbyNeural",French:"fr-FR-DeniseNeural",German:"de-DE-KatjaNeural",Hindi:"hi-IN-MadhurNeural",Indonesian:"id-ID-ArdiNeural",Italian:"it-IT-ElsaNeural",Japanese:"ja-JP-NanamiNeural",Korean:"ko-KR-SunHiNeural",Portuguese:"pt-BR-FranciscaNeural",Russian:"ru-RU-SvetlanaNeural",Spanish:"es-ES-ElviraNeural",Turkish:"tr-TR-AhmetNeural"},t.fetchcurrentLanguage=()=>r(void 0,void 0,void 0,(function*(){let e=null;return yield s.default.storage.sync.get({currentLanguage:"Chinese Simplified",targetLanguage:"United States"}).then((i=>{let r=t.lang["Chinese Simplified"],n=t.lang["United States"];r=o(i.currentLanguage),n=o(i.targetLanguage),e={current:r,target:n}})),e}));const o=e=>{switch(e){case"Arabic":return t.lang.Arabic;case"Chinese Simplified":default:return t.lang["Chinese Simplified"];case"Chinese Traditional":return t.lang["Chinese Traditional"];case"Dutch":return t.lang.Dutch;case"United States":case"English":return t.lang["United States"];case"United Kingdom":return t.lang["United Kingdom"];case"French":return t.lang.French;case"German":return t.lang.German;case"Hindi":return t.lang.Hindi;case"Indonesian":return t.lang.Indonesian;case"Italian":return t.lang.Italian;case"Japanese":return t.lang.Japanese;case"Korean":return t.lang.Korean;case"Portuguese":return t.lang.Portuguese;case"Russian":return t.lang.Russian;case"Spanish":return t.lang.Spanish;case"Turkish":return t.lang.Turkish}}},29882:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t},o=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.cardStyle=t.handleAnkiDynamicVariable=t.getUserInfo=t.getBalance=t.fetchSSE=t.getChatGPTSession=t.textToSpeechDownload=t.playTextToSpeech=t.getDefaultDeckName=t.getChatGPTWebToken=t.getAIParameter=t.generationsImages=t.getDictionaryData=t.unsplashSearchPhotos=t.ankiAction=void 0;const c=a(i(93150)),p=i(90199),h=s(i(32325)),u=i(67429),d=i(62569),l=a(i(69230)),v=i(71214),g=i(97574);function m(e,t,i={}){return new Promise(((r,n)=>{fetch("http://127.0.0.1:8765",{method:"POST",body:JSON.stringify({action:e,version:t,params:i})}).then((e=>e.json())).then((e=>{r(e)})).catch((e=>{n({result:[],error:"Please open the Anki client and install the Anki-Connect plugin before trying again."})}))}))}function f(e){return new Promise(((t,i)=>{(0,d.getSettings)().then((r=>{const n=r.apiKeySelection,s=r.licenseKey;let o=r.openApiKey;r.currentLanguage,r.targetLanguage;const a=r.model,c=r.openApiModel.replace(/ /g,""),p=r.freeModel;let h=r.openApiEndpoint;h.length<5&&(h="https://api.openai.com");let d,l={},v="";switch(n){case"scouterFreeAI":h="https://openrouter.ai/api/v1/chat/completions",v="https://openrouter.ai/api/v1/images/generations",o=s,l={Authorization:"Bearer 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","Content-Type":"application/json","HTTP-Referer":"https://notes.dabing.one/","X-Title":"ScouterFreeAI"},d={model:p,messages:e,temperature:.7,max_tokens:620,top_p:1,frequency_penalty:0,presence_penalty:2,stream:!0},t({result:"success",apiKeySelection:n,data:{chatCompletions:{url:h,headers:l,body:d},imagesGenerations:{url:v,headers:l}}});break;case"licenseKey":o=s,o.length<5&&t({result:"failure",apiKeySelection:n,data:null}),h="https://openrouter.ai/api/v1/chat/completions",v="https://openrouter.ai/api/v1/images/generations",l={Authorization:"Bearer "+o,"Content-Type":"application/json","HTTP-Referer":"https://notes.dabing.one/","X-Title":"Scouter"},d={model:a,messages:e,temperature:.7,max_tokens:620,top_p:1,frequency_penalty:0,presence_penalty:2,stream:!0},t({result:"success",apiKeySelection:n,data:{chatCompletions:{url:h,headers:l,body:d},imagesGenerations:{url:v,headers:l}}});break;case"ollama":l={"Content-Type":"application/json"},h=r.ollamaApiEndpoint,"/"===h.slice(-1)&&(h=h.slice(0,-1)),v="",h+="/api/chat",d={model:r.ollamaModel,messages:e},t({result:"success",apiKeySelection:n,data:{chatCompletions:{url:h,headers:l,body:d},imagesGenerations:{url:v,headers:l}}});break;case"myOwnOpenAiKey":if(o.length<5&&t({result:"failure",apiKeySelection:n,data:null}),h.indexOf("azure.com")>-1){const t=h.split("/openai/");v=t[0]+"/openai/images/generations:submit?api-version=2023-06-01-preview",l={"api-key":o,"Content-Type":"application/json"},d={model:c,messages:e,temperature:.7,max_tokens:620,top_p:1,frequency_penalty:0,presence_penalty:2,stream:!0}}else if(h.indexOf("api.pawan.krd")>-1){let i="pai-001";const r=/\/\/[^\/]+\/([^\/]+)\//,s=h.match(r);s&&(i=s[1]),l={Authorization:"Bearer "+o,"Content-Type":"application/json"},h=h.replace("v1",""),"/"===h.slice(-1)&&(h=h.slice(0,-1)),v=h+"/v1/images/generations",h+="/v1/chat/completions",d={model:i,messages:e,temperature:.7,max_tokens:620,top_p:1,frequency_penalty:0,presence_penalty:2,stream:!0},t({result:"success",apiKeySelection:n,data:{chatCompletions:{url:h,headers:l,body:d},imagesGenerations:{url:v,headers:l}}})}else l={Authorization:"Bearer "+o,"Content-Type":"application/json"},d={model:c,messages:e,temperature:.7,max_tokens:620,top_p:1,frequency_penalty:0,presence_penalty:2,stream:!0};t({result:"success",apiKeySelection:n,data:{chatCompletions:{url:h,headers:l,body:d},imagesGenerations:{url:v,headers:l}}});break;default:S().then((i=>{const r=e.map((e=>({id:(0,u.v4)(),role:e.role,content:{content_type:"text",parts:[e.content]}})));h="https://chat.openai.com/backend-api/conversation",v="https://openrouter.ai/api/v1/images/generations",l={"Content-Type":"application/json",Authorization:"Bearer "+i},d={action:"next",messages:r,model:"text-davinci-002-render-sha",parent_message_id:(0,u.v4)(),history_and_training_disabled:!0},t({result:"success",apiKeySelection:n,data:{chatCompletions:{url:h,headers:l,body:d},imagesGenerations:{url:v,headers:l}}})})).catch((e=>{i(e+" Please Ensure that You Are Logged into [ChatGPT](https://chat.openai.com/).")}))}}))}))}function S(){return o(this,void 0,void 0,(function*(){return console.log("getChatGPTWebToken"),new Promise(((e,i)=>{c.default.storage.local.get(["authData"]).then((r=>o(this,void 0,void 0,(function*(){const n=r.authData,s=(new Date).getTime();if(n&&n.token&&n.expiry&&n.expiry>s)e(n.token);else try{(0,t.getChatGPTSession)().then((t=>{e(t)})).catch((e=>{i(e)}))}catch(e){i(e)}}))))}))}))}t.ankiAction=m,t.unsplashSearchPhotos=function(e,t){return new Promise(((i,r)=>{(0,p.createApi)({accessKey:e}).search.getPhotos({query:t}).then((e=>{var t,r;0===(null===(t=e.response)||void 0===t?void 0:t.results.length)?i([]):i(null===(r=e.response)||void 0===r?void 0:r.results)})).catch((e=>{r(e)}))}))},t.getDictionaryData=e=>o(void 0,void 0,void 0,(function*(){const t=(yield(0,d.getSettings)()).targetLanguage;let i=new URL("https://dict.youdao.com/jsonapi"),r={xmlVersion:"5.1",le:l.default.getCode(t),q:e};i.search=new URLSearchParams(r).toString();const n="🥲 Sorry, No Results Found for this Word.";return fetch(i).then((e=>e.ok?e.json():n)).then((i=>{let r="";switch(t){case"Spanish":return"multle"in i?r=e+" /"+i.multle.word[0].phone+"/\n"+i.multle.word[0].trs[0].tr[0].l.i[0]:"fanyi"in i&&(r=i.fanyi.tran),"multle"in i||"fanyi"in i?r:n;case"French":return"fc"in i?r=e+" /"+i.fc.word[0].phone+"/\n"+i.fc.word[0].trs[0].tr[0].l.i[0]:"fanyi"in i&&(r=i.fanyi.tran),"fc"in i||"fanyi"in i?r:n;case"Japanese":return"jc"in i?(r=e+" /"+i.jc.word[0]["return-phrase"].l.i+"/\n"+i.jc.word[0].trs[0].tr[0].l.i[0],r):"fanyi"in i?(r=i.fanyi.tran,r):"jaTransPjm"in i?(r=i.jaTransPjm.fanyi.tran,r):"newjc"in i?(r=i.newjc.word.sense[0].phrList[0].jmsy,r):n;default:return"ec"in i?r=e+" /"+i.ec.word[0].usphone+"/\n"+i.ec.word[0].trs[0].tr[0].l.i[0]:"fanyi"in i&&(r=i.fanyi.tran),"ec"in i||"fanyi"in i?r:n}})).catch((e=>(console.log(e),n)))})),t.generationsImages=function(e){return new Promise(((t,i)=>{f([]).then((i=>{var r;const n=null===(r=i.data)||void 0===r?void 0:r.imagesGenerations.url;if(i.data&&void 0!==n){("licenseKey"===i.apiKeySelection||(null==n?void 0:n.indexOf("api.aiproxy"))>=0)&&t({succeeded:!1,data:[]});const r={prompt:e,n:2,size:"512x512"},s=i.data.imagesGenerations.headers;fetch(n,{method:"POST",body:JSON.stringify(r),headers:s}).then((e=>o(this,void 0,void 0,(function*(){e.ok||t({succeeded:!1,data:{}}),e.json().then((e=>{if("notRunning"===e.status){const i=n.split("/openai/")[0]+"/openai/operations/images/"+e.id+"?api-version=2023-06-01-preview",r=setInterval((()=>{fetch(i,{method:"GET",headers:s}).then((e=>e.json())).then((e=>{"succeeded"===e.status&&(t({succeeded:!0,data:e.result}),clearInterval(r)),"failed"===e.status&&(t({succeeded:!1,data:e.error}),clearInterval(r))}))}),1e3)}else t("error"in e?{succeeded:!1,data:e.error}:{succeeded:!0,data:e})}))})))).catch((e=>{console.log(e),t({succeeded:!1,data:e})}))}}))}))},t.getAIParameter=f,t.getChatGPTWebToken=S,t.getDefaultDeckName=function(){return new Promise(((e,t)=>{let i="";c.default.storage.sync.get(["ankiDeckName"]).then((t=>o(this,void 0,void 0,(function*(){i=t.ankiDeckName?t.ankiDeckName:yield m("deckNames",6).then((e=>e.result[0])).catch((e=>"")),e({defaultDeckName:i})}))))}))},t.playTextToSpeech=(e,t,i)=>{if(navigator.userAgent.indexOf("Firefox")>=0){const t=v.lang[i].audioURL;let r=new Audio(t+e);r.addEventListener("loadeddata",(e=>{r.play()}))}else{const i=h.AudioConfig.fromDefaultSpeakerOutput(),r=h.SpeechConfig.fromSubscription("51675ff213a64c3896bc95141c6c54dd","eastus");r.speechSynthesisVoiceName=t,r.speechSynthesisOutputFormat=h.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3;const n=new h.SpeechSynthesizer(r,i);n.speakTextAsync(e,(function(e){e.reason===h.ResultReason.SynthesizingAudioCompleted||console.error("Speech synthesis canceled, "+e.errorDetails+"\nDid you set the speech resource key and region values?"),n.close()}),(function(e){n.close()}))}},t.textToSpeechDownload=(e,t)=>{const i=h.AudioOutputStream.createPullStream(),r=h.AudioConfig.fromStreamOutput(i),n=h.SpeechConfig.fromSubscription("51675ff213a64c3896bc95141c6c54dd","eastus");n.speechSynthesisVoiceName=t,n.speechSynthesisOutputFormat=h.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3;const s=new h.SpeechSynthesizer(n,r);s.speakTextAsync(e,(function(e){return o(this,void 0,void 0,(function*(){if(s.close(),e.reason===h.ResultReason.SynthesizingAudioCompleted){let e,t=[];do{const r=new ArrayBuffer(16e3),n=yield i.read(r);e=r.slice(0,n),n>0&&t.push(e)}while(e.byteLength>0);let r=new Blob(t,{type:"audio/mp3"}),n=window.URL.createObjectURL(r),s=document.createElement("a");document.body.appendChild(s),s.style.display="none",s.href=n,s.download=`Audio_${(new Date).getTime()}.mp3`,s.click(),window.URL.revokeObjectURL(n),document.body.removeChild(s)}else console.error(`TTS Failed: ${e.errorDetails}`);i.close()}))}),(function(e){console.error(`TTS Failed: ${e}`),s.close(),i.close()}))},t.getChatGPTSession=()=>o(void 0,void 0,void 0,(function*(){const e=yield fetch("https://chat.openai.com/api/auth/session");if(!e.ok)return"Couldn't fetch the token";const t=yield e.json();if("accessToken"in t!=1)return"Couldn't fetch the token";const i={token:t.accessToken,expiry:Date.parse(t.expires)};c.default.storage.local.set({authData:i}).then((()=>i.token))})),t.fetchSSE=(e,t,i,r)=>o(void 0,void 0,void 0,(function*(){var n;const{onMessage:s,onEnd:o,onError:a}=i;try{const i=yield fetch(e,t);if(!i.ok)return void(a&&a(new Error(`HTTP error, status = ${i.status}`)));const c=(0,g.createParser)((e=>{if("event"===e.type)try{if("[DONE]"!==e.data){const t=JSON.parse(e.data);s&&s(t)}}catch(e){a&&a(new Error("Failed to parse SSE event data"))}})),p=null===(n=i.body)||void 0===n?void 0:n.getReader();if(void 0!==p){try{for(;;){const{done:e,value:t}=yield p.read();if(e){o&&o();break}const i=(new TextDecoder).decode(t);if("ollama"===r){let e="";i.trim().split("\n").forEach((t=>{try{const i=JSON.parse(t);i.message&&i.message.content&&(e+=i.message.content)}catch(e){console.error("Parsing error:",e)}})),s&&s(e)}else c.feed(i)}}finally{p.releaseLock()}c.reset()}}catch(e){a&&a(new Error(`Fetch request failed: ${e}`))}})),t.getBalance=e=>new Promise(((t,i)=>{fetch("https://openrouter.ai/api/v1/auth/key",{headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"}}).then((e=>{e.json().then((e=>{t(e)}))}))})),t.getUserInfo=()=>(console.log("getUserInfo"),new Promise(((e,t)=>{(0,d.getSettings)().then((i=>o(void 0,void 0,void 0,(function*(){c.default.runtime.lastError&&t(chrome.runtime.lastError);let r=!1;var n;let s;i.newLicenseKey&&(console.log("result.newLicenseKey:"),console.log(!0),r=yield(n=i.newLicenseKey,o(void 0,void 0,void 0,(function*(){console.log("checkLicenseKey from lemonsqueezy:");let e=!1;const t=yield fetch("https://api.lemonsqueezy.com/v1/licenses/validate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({license_key:n})});if(e=(yield t.json()).valid,console.log(e),!e){console.log("checkLicenseKey from dabing:");const t=yield fetch("https://api.scouter.dabing.one/api/checktLicenseKey",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:n})}),i=yield t.json();if(e=i.verified,!t.ok)throw new Error(i.message)}return console.log(e),e}))),console.log("getUserInfo result:"),console.log(r)),i.userId?s=i.userId:(s=(0,u.v4)(),c.default.storage.sync.set({userId:s}).then((()=>{chrome.runtime.lastError&&t(c.default.runtime.lastError)})));const a={userId:s,verified:r,contextMenu:i.contextMenu,contextMenuBlackList:i.contextMenuBlackList,showYoutubeButton:i.showYoutubeButton,contentEditable:i.contentEditable};console.log("response:"),console.log(a),e(a)}))))}))),t.handleAnkiDynamicVariable=function(e,t){let i=[];const r=e;return console.log("f:"),console.log(r),{fields:r.reduce(((e,r)=>(Object.keys(r).forEach((n=>{r[n].indexOf("{{Audio}}")>-1&&i.push(n),e[n]=r[n].replace(/{{Selection}}/g,t.Selection).replace(/{{Sentence}}/g,`<blockquote>${t.Sentence}</blockquote>`).replace(/{{Audio}}/g,"").replace(/{{Definition}}/g,t.Content).replace(/{{Image}}/g,t.Image).replace(/{{Source}}/g,t.Source)})),e)),{}),audioFields:i}},t.cardStyle="\n\n  .card {\n    font-family: arial;\n    font-size: 18px;\n    color: rgb(0 0 0 / 84%);\n    background-color: white;\n    text-align: left;\n    line-height: 1.6;\n  }\n\n  blockquote {\n    border-left: 5px solid #ccc;\n    padding: 8px 16px;\n    margin-left:0;\n    margin-right:0;\n\t\tbackground-color: rgb(0 0 0 / 4%);\n  }\n\n  a {\n    text-decoration: underline;\n  }\n\n  img {\n    max-height: 320px;\n  }\n\n  .ankiSpace {\n    color:#F08A24;\n  }\n\n  .keyWord {\n    color:#F08A24;\n  }\n\n  table {\n    border: 1px solid #ccc;\n    border-collapse: collapse;\n    margin:0;\n    padding:0;\n    width: 100%;\n  }\n\n  table tr {\n    border: 1px solid #ddd;\n    padding: 5px;\n  }\n\n  table th, table td {\n    padding: 10px;\n    text-align: left;\n  }\n\n  table th {\n    letter-spacing: 1px;\n    text-transform: uppercase;\n  }"},90199:(e,t,i)=>{"use strict";i.r(t),i.d(t,{Language:()=>u,OrderBy:()=>d,_internals:()=>re,createApi:()=>ne});var r=i(37811);function n(){return n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},n.apply(this,arguments)}function s(e,t){if(null==e)return{};var i,r,n={},s=Object.keys(e);for(r=0;r<s.length;r++)i=s[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}var o=c((function(e){return"string"==typeof e?e:null})),a=function(e){return null!=e};function c(e){return function(t){return a(e(t))}}var p=function(e){return Object.keys(e).reduce((function(t,i){var r,s=e[i];return n({},t,a(s)?((r={})[i]=s,r):{})}),{})};function h(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=t.length-1;return function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];for(var s=t[0].apply(this,i),o=1;o<=r;o++)s=t[o].call(this,s);return s}}var u,d,l=c((function(e){return a(e)&&"object"==typeof e&&!Array.isArray(e)?e:null})),v=c((function(e){return Array.isArray(e)&&e.every(o)&&e.length>0?e:null})),g=c((function(e){return l(e)&&"errors"in e&&v(e.errors)?{errors:e.errors}:null})),m=function(e){this.message=e},f=function(e){if(function(e){var t=e.headers.get("content-type");return a(t)&&"application/json"===(0,r.Q)(t).type}(e))return e.json().catch((function(e){throw new m("unable to parse JSON response.")}));throw new m("expected JSON response from server.")},S=function(){return function(e){var t=e.response;return f(t)}},y=function(e){return function(t,i){void 0===i&&(i={});var r=e(t),o=r.headers,a=r.query;return n({},s(r,["headers","query"]),i,{query:a,headers:n({},o,i.headers)})}},C=function(e){return e},w=function(e){var t=e.accessKey,i=e.apiVersion,r=void 0===i?"v1":i,o=e.apiUrl,c=void 0===o?"https://api.unsplash.com":o,p=e.headers,u=e.fetch,d=s(e,["accessKey","apiVersion","apiUrl","headers","fetch"]);return function(e){var i=e.handleResponse;return h(e.handleRequest,(function(e){var s=e.pathname,o=e.query,h=e.method,l=void 0===h?"GET":h,v=e.headers,S=e.body,y=e.signal,C=function(e){var t=e.pathname,i=e.query;return function(e){var r=new URL(e);return function(e){return function(t){"/"===t.pathname?t.pathname=e:t.pathname+=e}}(t)(r),function(e){return function(t){Object.keys(e).forEach((function(i){return t.searchParams.set(i,e[i].toString())}))}}(i)(r),r.toString()}}({pathname:s,query:o})(c),w=n({method:l,headers:n({},p,v,{"Accept-Version":r},a(t)?{Authorization:"Client-ID "+t}:{}),body:S,signal:y},d);return(null!=u?u:fetch)(C,w).then(function(e){return function(t){return(t.ok?e({response:t}).then((function(e){return{type:"success",status:t.status,response:e,originalResponse:t}})):f(t).then((function(e){return n({type:"error",status:t.status},function(e){return g(e)?{errors:e.errors,source:"api"}:{errors:["Responded with a status code outside the 2xx range, and the response body is not recognisable."],source:"decoding"}}(e),{originalResponse:t})}))).catch((function(e){if(e instanceof m)return{type:"error",source:"decoding",status:t.status,originalResponse:t,errors:[e.message]};throw e}))}}(i))}))}},R="x-total",P=function(e){var t=e.headers.get(R);if(a(t)){var i=parseInt(t);if(Number.isInteger(i))return i;throw new m("expected "+R+" header to be valid integer.")}throw new m("expected "+R+" header to exist.")},I=function(){return function(e){var t=e.response;return S()({response:t}).then((function(e){return{results:e,total:P(t)}}))}},A=function(e){return a(e)?{collections:e.join()}:{}},T=function(e){return a(e)?{topics:e.join()}:{}},b=function(e){var t=e.page,i=e.perPage,r=e.orderBy;return p({per_page:i,order_by:r,page:t})},E="/collections",k=function(){var e=function(e){var t=e.collectionId;return E+"/"+t+"/photos"};return{getPathname:e,handleRequest:y((function(t){var i=t.collectionId,r=t.orientation,o=s(t,["collectionId","orientation"]);return{pathname:e({collectionId:i}),query:p(n({},b(o),{orientation:r}))}})),handleResponse:I()}}(),N=function(){var e=function(e){var t=e.collectionId;return E+"/"+t};return{getPathname:e,handleRequest:y((function(t){var i=t.collectionId;return{pathname:e({collectionId:i}),query:{}}})),handleResponse:S()}}(),x=function(){var e=function(){return E};return{getPathname:e,handleRequest:y((function(t){return void 0===t&&(t={}),{pathname:e(),query:b(t)}})),handleResponse:I()}}(),D=function(){var e=function(e){var t=e.collectionId;return E+"/"+t+"/related"};return{getPathname:e,handleRequest:y((function(t){var i=t.collectionId;return{pathname:e({collectionId:i}),query:{}}})),handleResponse:S()}}(),O={__proto__:null,getPhotos:k,get:N,list:x,getRelated:D},M="/photos",z=function(){return{getPathname:function(e){return M},handleRequest:y((function(e){return void 0===e&&(e={}),{pathname:M,query:p(b(e))}})),handleResponse:I()}}(),L=function(){var e=function(e){var t=e.photoId;return M+"/"+t};return{getPathname:e,handleRequest:y((function(t){var i=t.photoId;return{pathname:e({photoId:i}),query:{}}})),handleResponse:S()}}(),_=function(){var e=function(e){var t=e.photoId;return M+"/"+t+"/statistics"};return{getPathname:e,handleRequest:y((function(t){var i=t.photoId;return{pathname:e({photoId:i}),query:{}}})),handleResponse:S()}}(),B=function(){var e=function(){return M+"/random"};return{getPathname:e,handleRequest:y((function(t){var i=void 0===t?{}:t,r=i.collectionIds,o=i.contentFilter,a=i.topicIds,c=s(i,["collectionIds","contentFilter","topicIds"]);return{pathname:e(),query:p(n({},c,{content_filter:o},A(r),T(a))),headers:{"cache-control":"no-cache"}}})),handleResponse:S()}}(),q={handleRequest:y((function(e){var t=function(e){var t=new URL(e),i=t.pathname;return{query:function(e){var t={};return e.forEach((function(e,i){t[i]=e})),t}(t.searchParams),pathname:"/"===i?void 0:i}}(e.downloadLocation),i=t.pathname,r=t.query;if(!a(i))throw new Error("Could not parse pathname from url.");return{pathname:i,query:p(r)}})),handleResponse:S()},U={__proto__:null,list:z,get:L,getStats:_,getRandom:B,trackDownload:q},F="/search",K=function(){var e=function(){return F+"/photos"};return{getPathname:function(t){return e()},handleRequest:y((function(t){var i=t.query,r=t.page,o=t.perPage,a=t.orderBy,c=t.collectionIds,h=t.lang,u=t.contentFilter,d=s(t,["query","page","perPage","orderBy","collectionIds","lang","contentFilter"]);return{pathname:e(),query:p(n({query:i,content_filter:u,lang:h,order_by:a},b({page:r,perPage:o}),A(c),d))}})),handleResponse:S()}}(),W=function(){var e=function(){return F+"/collections"};return{getPathname:function(t){return e()},handleRequest:y((function(t){var i=t.query,r=s(t,["query"]);return{pathname:e(),query:n({query:i},b(r))}})),handleResponse:S()}}(),H=function(){var e=function(){return F+"/users"};return{getPathname:function(t){return e()},handleRequest:y((function(t){var i=t.query,r=s(t,["query"]);return{pathname:e(),query:n({query:i},b(r))}})),handleResponse:S()}}(),j={__proto__:null,getPhotos:K,getCollections:W,getUsers:H},J="/users",V=function(){var e=function(e){var t=e.username;return J+"/"+t};return{getPathname:e,handleRequest:y((function(t){var i=t.username;return{pathname:e({username:i}),query:{}}})),handleResponse:S()}}(),G=function(){var e=function(e){var t=e.username;return J+"/"+t+"/photos"};return{getPathname:e,handleRequest:y((function(t){var i=t.username,r=t.stats,o=t.orientation,a=s(t,["username","stats","orientation"]);return{pathname:e({username:i}),query:p(n({},b(a),{orientation:o,stats:r}))}})),handleResponse:I()}}(),$=function(){var e=function(e){var t=e.username;return J+"/"+t+"/likes"};return{getPathname:e,handleRequest:y((function(t){var i=t.username,r=t.orientation,o=s(t,["username","orientation"]);return{pathname:e({username:i}),query:p(n({},b(o),{orientation:r}))}})),handleResponse:I()}}(),Y=function(){var e=function(e){var t=e.username;return J+"/"+t+"/collections"};return{getPathname:e,handleRequest:y((function(t){var i=t.username,r=s(t,["username"]);return{pathname:e({username:i}),query:b(r)}})),handleResponse:I()}}(),Q={__proto__:null,get:V,getPhotos:G,getLikes:$,getCollections:Y},Z="/topics",X=function(e){var t=e.topicIdOrSlug;return Z+"/"+t},ee=C({getPathname:X,handleRequest:function(e){var t=e.page,i=e.perPage,r=e.orderBy,s=e.topicIdsOrSlugs;return{pathname:Z,query:p(n({},b({page:t,perPage:i}),{ids:null==s?void 0:s.join(","),order_by:r}))}},handleResponse:I()}),te=C({getPathname:X,handleRequest:function(e){var t=e.topicIdOrSlug;return{pathname:X({topicIdOrSlug:t}),query:{}}},handleResponse:S()}),ie=function(){var e=h(X,(function(e){return e+"/photos"}));return{getPathname:e,handleRequest:function(t){var i=t.topicIdOrSlug,r=t.orientation,o=s(t,["topicIdOrSlug","orientation"]);return{pathname:e({topicIdOrSlug:i}),query:p(n({},b(o),{orientation:r}))}},handleResponse:I()}}(),re={__proto__:null,collections:O,photos:U,search:j,users:Q,topics:{__proto__:null,list:ee,get:te,getPhotos:ie},trackNonHotLinkedPhotoView:function(e){var t=e.appId;return function(e){var i=e.photoId,r=Array.isArray(i)?i:[i];if(r.length>20)throw new Error("You cannot track more than 20 photos at once. Please try again with fewer photos.");return fetch("views.unsplash.com/v?photo_id="+r.join()+"&app_id="+t)}}};!function(e){e.Afrikaans="af",e.Amharic="am",e.Arabic="ar",e.Azerbaijani="az",e.Belarusian="be",e.Bulgarian="bg",e.Bengali="bn",e.Bosnian="bs",e.Catalan="ca",e.Cebuano="ceb",e.Corsican="co",e.Czech="cs",e.Welsh="cy",e.Danish="da",e.German="de",e.Greek="el",e.English="en",e.Esperanto="eo",e.Spanish="es",e.Estonian="et",e.Basque="eu",e.Persian="fa",e.Finnish="fi",e.French="fr",e.Frisian="fy",e.Irish="ga",e.ScotsGaelic="gd",e.Galician="gl",e.Gujarati="gu",e.Hausa="ha",e.Hawaiian="haw",e.Hindi="hi",e.Hmong="hmn",e.Croatian="hr",e.HaitianCreole="ht",e.Hungarian="hu",e.Armenian="hy",e.Indonesian="id",e.Igbo="ig",e.Icelandic="is",e.Italian="it",e.Hebrew="iw",e.Japanese="ja",e.Javanese="jw",e.Georgian="ka",e.Kazakh="kk",e.Khmer="km",e.Kannada="kn",e.Korean="ko",e.Kurdish="ku",e.Kyrgyz="ky",e.Latin="la",e.Luxembourgish="lb",e.Lao="lo",e.Lithuanian="lt",e.Latvian="lv",e.Malagasy="mg",e.Maori="mi",e.Macedonian="mk",e.Malayalam="ml",e.Mongolian="mn",e.Marathi="mr",e.Malay="ms",e.Maltese="mt",e.Myanmar="my",e.Nepali="ne",e.Dutch="nl",e.Norwegian="no",e.Nyanja="ny",e.Oriya="or",e.Punjabi="pa",e.Polish="pl",e.Pashto="ps",e.Portuguese="pt",e.Romanian="ro",e.Russian="ru",e.Kinyarwanda="rw",e.Sindhi="sd",e.Sinhala="si",e.Slovak="sk",e.Slovenian="sl",e.Samoan="sm",e.Shona="sn",e.Somali="so",e.Albanian="sq",e.Serbian="sr",e.Sesotho="st",e.Sundanese="su",e.Swedish="sv",e.Swahili="sw",e.Tamil="ta",e.Telugu="te",e.Tajik="tg",e.Thai="th",e.Turkmen="tk",e.Filipino="tl",e.Turkish="tr",e.Tatar="tt",e.Uighur="ug",e.Ukrainian="uk",e.Urdu="ur",e.Uzbek="uz",e.Vietnamese="vi",e.Xhosa="xh",e.Yiddish="yi",e.Yoruba="yo",e.ChineseSimplified="zh",e.ChineseTraditional="zh-TW",e.Zulu="zu"}(u||(u={})),function(e){e.LATEST="latest",e.POPULAR="popular",e.VIEWS="views",e.DOWNLOADS="downloads",e.OLDEST="oldest"}(d||(d={}));var ne=h(w,(function(e){return{photos:{get:e(L),list:e(z),getStats:e(_),getRandom:e(B),trackDownload:e(q)},users:{getPhotos:e(G),getCollections:e(Y),getLikes:e($),get:e(V)},search:{getCollections:e(W),getPhotos:e(K),getUsers:e(H)},collections:{getPhotos:e(k),get:e(N),list:e(x),getRelated:e(D)},topics:{list:e(ee),get:e(te),getPhotos:e(ie)}}}))},67429:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return c.default}});var r=d(i(63990)),n=d(i(8237)),s=d(i(75355)),o=d(i(83764)),a=d(i(86314)),c=d(i(58464)),p=d(i(46435)),h=d(i(73990)),u=d(i(18222));function d(e){return e&&e.__esModule?e:{default:e}}},94163:(e,t)=>{"use strict";function i(e){return 14+(e+64>>>9<<4)+1}function r(e,t){const i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}function n(e,t,i,n,s,o){return r((a=r(r(t,e),r(n,o)))<<(c=s)|a>>>32-c,i);var a,c}function s(e,t,i,r,s,o,a){return n(t&i|~t&r,e,t,s,o,a)}function o(e,t,i,r,s,o,a){return n(t&r|i&~r,e,t,s,o,a)}function a(e,t,i,r,s,o,a){return n(t^i^r,e,t,s,o,a)}function c(e,t,i,r,s,o,a){return n(i^(t|~r),e,t,s,o,a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let i=0;i<t.length;++i)e[i]=t.charCodeAt(i)}return function(e){const t=[],i=32*e.length,r="0123456789abcdef";for(let n=0;n<i;n+=8){const i=e[n>>5]>>>n%32&255,s=parseInt(r.charAt(i>>>4&15)+r.charAt(15&i),16);t.push(s)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[i(t)-1]=t;let n=1732584193,p=-271733879,h=-1732584194,u=271733878;for(let t=0;t<e.length;t+=16){const i=n,d=p,l=h,v=u;n=s(n,p,h,u,e[t],7,-680876936),u=s(u,n,p,h,e[t+1],12,-389564586),h=s(h,u,n,p,e[t+2],17,606105819),p=s(p,h,u,n,e[t+3],22,-1044525330),n=s(n,p,h,u,e[t+4],7,-176418897),u=s(u,n,p,h,e[t+5],12,1200080426),h=s(h,u,n,p,e[t+6],17,-1473231341),p=s(p,h,u,n,e[t+7],22,-45705983),n=s(n,p,h,u,e[t+8],7,1770035416),u=s(u,n,p,h,e[t+9],12,-1958414417),h=s(h,u,n,p,e[t+10],17,-42063),p=s(p,h,u,n,e[t+11],22,-1990404162),n=s(n,p,h,u,e[t+12],7,1804603682),u=s(u,n,p,h,e[t+13],12,-40341101),h=s(h,u,n,p,e[t+14],17,-1502002290),p=s(p,h,u,n,e[t+15],22,1236535329),n=o(n,p,h,u,e[t+1],5,-165796510),u=o(u,n,p,h,e[t+6],9,-1069501632),h=o(h,u,n,p,e[t+11],14,643717713),p=o(p,h,u,n,e[t],20,-373897302),n=o(n,p,h,u,e[t+5],5,-701558691),u=o(u,n,p,h,e[t+10],9,38016083),h=o(h,u,n,p,e[t+15],14,-660478335),p=o(p,h,u,n,e[t+4],20,-405537848),n=o(n,p,h,u,e[t+9],5,568446438),u=o(u,n,p,h,e[t+14],9,-1019803690),h=o(h,u,n,p,e[t+3],14,-187363961),p=o(p,h,u,n,e[t+8],20,1163531501),n=o(n,p,h,u,e[t+13],5,-1444681467),u=o(u,n,p,h,e[t+2],9,-51403784),h=o(h,u,n,p,e[t+7],14,1735328473),p=o(p,h,u,n,e[t+12],20,-1926607734),n=a(n,p,h,u,e[t+5],4,-378558),u=a(u,n,p,h,e[t+8],11,-2022574463),h=a(h,u,n,p,e[t+11],16,1839030562),p=a(p,h,u,n,e[t+14],23,-35309556),n=a(n,p,h,u,e[t+1],4,-1530992060),u=a(u,n,p,h,e[t+4],11,1272893353),h=a(h,u,n,p,e[t+7],16,-155497632),p=a(p,h,u,n,e[t+10],23,-1094730640),n=a(n,p,h,u,e[t+13],4,681279174),u=a(u,n,p,h,e[t],11,-358537222),h=a(h,u,n,p,e[t+3],16,-722521979),p=a(p,h,u,n,e[t+6],23,76029189),n=a(n,p,h,u,e[t+9],4,-640364487),u=a(u,n,p,h,e[t+12],11,-421815835),h=a(h,u,n,p,e[t+15],16,530742520),p=a(p,h,u,n,e[t+2],23,-995338651),n=c(n,p,h,u,e[t],6,-198630844),u=c(u,n,p,h,e[t+7],10,1126891415),h=c(h,u,n,p,e[t+14],15,-1416354905),p=c(p,h,u,n,e[t+5],21,-57434055),n=c(n,p,h,u,e[t+12],6,1700485571),u=c(u,n,p,h,e[t+3],10,-1894986606),h=c(h,u,n,p,e[t+10],15,-1051523),p=c(p,h,u,n,e[t+1],21,-2054922799),n=c(n,p,h,u,e[t+8],6,1873313359),u=c(u,n,p,h,e[t+15],10,-30611744),h=c(h,u,n,p,e[t+6],15,-1560198380),p=c(p,h,u,n,e[t+13],21,1309151649),n=c(n,p,h,u,e[t+4],6,-145523070),u=c(u,n,p,h,e[t+11],10,-1120210379),h=c(h,u,n,p,e[t+2],15,718787259),p=c(p,h,u,n,e[t+9],21,-343485551),n=r(n,i),p=r(p,d),h=r(h,l),u=r(u,v)}return[n,p,h,u]}(function(e){if(0===e.length)return[];const t=8*e.length,r=new Uint32Array(i(t));for(let i=0;i<t;i+=8)r[i>>5]|=(255&e[i/8])<<i%32;return r}(e),8*e.length))}},54790:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};t.default=i},86314:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default="00000000-0000-0000-0000-000000000000"},18222:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n=(r=i(46435))&&r.__esModule?r:{default:r};t.default=function(e){if(!(0,n.default)(e))throw TypeError("Invalid UUID");let t;const i=new Uint8Array(16);return i[0]=(t=parseInt(e.slice(0,8),16))>>>24,i[1]=t>>>16&255,i[2]=t>>>8&255,i[3]=255&t,i[4]=(t=parseInt(e.slice(9,13),16))>>>8,i[5]=255&t,i[6]=(t=parseInt(e.slice(14,18),16))>>>8,i[7]=255&t,i[8]=(t=parseInt(e.slice(19,23),16))>>>8,i[9]=255&t,i[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,i[11]=t/4294967296&255,i[12]=t>>>24&255,i[13]=t>>>16&255,i[14]=t>>>8&255,i[15]=255&t,i}},70058:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},33319:(e,t)=>{"use strict";let i;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!i&&(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!i))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(r)};const r=new Uint8Array(16)},93757:(e,t)=>{"use strict";function i(e,t,i,r){switch(e){case 0:return t&i^~t&r;case 1:case 3:return t^i^r;case 2:return t&i^t&r^i&r}}function r(e,t){return e<<t|e>>>32-t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e){const t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let i=0;i<t.length;++i)e.push(t.charCodeAt(i))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const s=e.length/4+2,o=Math.ceil(s/16),a=new Array(o);for(let t=0;t<o;++t){const i=new Uint32Array(16);for(let r=0;r<16;++r)i[r]=e[64*t+4*r]<<24|e[64*t+4*r+1]<<16|e[64*t+4*r+2]<<8|e[64*t+4*r+3];a[t]=i}a[o-1][14]=8*(e.length-1)/Math.pow(2,32),a[o-1][14]=Math.floor(a[o-1][14]),a[o-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<o;++e){const s=new Uint32Array(80);for(let t=0;t<16;++t)s[t]=a[e][t];for(let e=16;e<80;++e)s[e]=r(s[e-3]^s[e-8]^s[e-14]^s[e-16],1);let o=n[0],c=n[1],p=n[2],h=n[3],u=n[4];for(let e=0;e<80;++e){const n=Math.floor(e/20),a=r(o,5)+i(n,c,p,h)+u+t[n]+s[e]>>>0;u=h,h=p,p=r(c,30)>>>0,c=o,o=a}n[0]=n[0]+o>>>0,n[1]=n[1]+c>>>0,n[2]=n[2]+p>>>0,n[3]=n[3]+h>>>0,n[4]=n[4]+u>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]}},73990:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.unsafeStringify=o;var r,n=(r=i(46435))&&r.__esModule?r:{default:r};const s=[];for(let e=0;e<256;++e)s.push((e+256).toString(16).slice(1));function o(e,t=0){return(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase()}t.default=function(e,t=0){const i=o(e,t);if(!(0,n.default)(i))throw TypeError("Stringified UUID is invalid");return i}},63990:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n=(r=i(33319))&&r.__esModule?r:{default:r},s=i(73990);let o,a,c=0,p=0;t.default=function(e,t,i){let r=t&&i||0;const h=t||new Array(16);let u=(e=e||{}).node||o,d=void 0!==e.clockseq?e.clockseq:a;if(null==u||null==d){const t=e.random||(e.rng||n.default)();null==u&&(u=o=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==d&&(d=a=16383&(t[6]<<8|t[7]))}let l=void 0!==e.msecs?e.msecs:Date.now(),v=void 0!==e.nsecs?e.nsecs:p+1;const g=l-c+(v-p)/1e4;if(g<0&&void 0===e.clockseq&&(d=d+1&16383),(g<0||l>c)&&void 0===e.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=l,p=v,a=d,l+=122192928e5;const m=(1e4*(268435455&l)+v)%4294967296;h[r++]=m>>>24&255,h[r++]=m>>>16&255,h[r++]=m>>>8&255,h[r++]=255&m;const f=l/4294967296*1e4&268435455;h[r++]=f>>>8&255,h[r++]=255&f,h[r++]=f>>>24&15|16,h[r++]=f>>>16&255,h[r++]=d>>>8|128,h[r++]=255&d;for(let e=0;e<6;++e)h[r+e]=u[e];return t||(0,s.unsafeStringify)(h)}},8237:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(i(17925)),n=s(i(94163));function s(e){return e&&e.__esModule?e:{default:e}}var o=(0,r.default)("v3",48,n.default);t.default=o},17925:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0,t.default=function(e,t,i){function r(e,r,o,a){var c;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let i=0;i<e.length;++i)t.push(e.charCodeAt(i));return t}(e)),"string"==typeof r&&(r=(0,s.default)(r)),16!==(null===(c=r)||void 0===c?void 0:c.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let p=new Uint8Array(16+e.length);if(p.set(r),p.set(e,r.length),p=i(p),p[6]=15&p[6]|t,p[8]=63&p[8]|128,o){a=a||0;for(let e=0;e<16;++e)o[a+e]=p[e];return o}return(0,n.unsafeStringify)(p)}try{r.name=e}catch(e){}return r.DNS=o,r.URL=a,r};var r,n=i(73990),s=(r=i(18222))&&r.__esModule?r:{default:r};const o="6ba7b810-9dad-11d1-80b4-00c04fd430c8";t.DNS=o;const a="6ba7b811-9dad-11d1-80b4-00c04fd430c8";t.URL=a},75355:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(i(54790)),n=o(i(33319)),s=i(73990);function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,i){if(r.default.randomUUID&&!t&&!e)return r.default.randomUUID();const o=(e=e||{}).random||(e.rng||n.default)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){i=i||0;for(let e=0;e<16;++e)t[i+e]=o[e];return t}return(0,s.unsafeStringify)(o)}},83764:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(i(17925)),n=s(i(93757));function s(e){return e&&e.__esModule?e:{default:e}}var o=(0,r.default)("v5",80,n.default);t.default=o},46435:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n=(r=i(70058))&&r.__esModule?r:{default:r};t.default=function(e){return"string"==typeof e&&n.default.test(e)}},58464:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n=(r=i(46435))&&r.__esModule?r:{default:r};t.default=function(e){if(!(0,n.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}},93744:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});const r={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)}},13653:(e,t,i)=>{"use strict";let r;i.d(t,{Z:()=>s});const n=new Uint8Array(16);function s(){if(!r&&(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!r))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(n)}},3958:(e,t,i)=>{"use strict";i.d(t,{S:()=>n});const r=[];for(let e=0;e<256;++e)r.push((e+256).toString(16).slice(1));function n(e,t=0){return(r[e[t+0]]+r[e[t+1]]+r[e[t+2]]+r[e[t+3]]+"-"+r[e[t+4]]+r[e[t+5]]+"-"+r[e[t+6]]+r[e[t+7]]+"-"+r[e[t+8]]+r[e[t+9]]+"-"+r[e[t+10]]+r[e[t+11]]+r[e[t+12]]+r[e[t+13]]+r[e[t+14]]+r[e[t+15]]).toLowerCase()}},72045:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var r=i(93744),n=i(13653),s=i(3958);const o=function(e,t,i){if(r.Z.randomUUID&&!t&&!e)return r.Z.randomUUID();const o=(e=e||{}).random||(e.rng||n.Z)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){i=i||0;for(let e=0;e<16;++e)t[i+e]=o[e];return t}return(0,s.S)(o)}},93150:function(e,t){var i,r;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,i=function(e){"use strict";if(!globalThis.chrome?.runtime?.id)throw new Error("This script should only be loaded in a browser extension.");if(void 0===globalThis.browser||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const t="The message port closed before a response was received.",i=e=>{const i={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(i).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class r extends WeakMap{constructor(e,t=undefined){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const n=(t,i)=>(...r)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):i.singleCallbackArg||r.length<=1&&!1!==i.singleCallbackArg?t.resolve(r[0]):t.resolve(r)},s=e=>1==e?"argument":"arguments",o=(e,t,i)=>new Proxy(t,{apply:(t,r,n)=>i.call(r,e,...n)});let a=Function.call.bind(Object.prototype.hasOwnProperty);const c=(e,t={},i={})=>{let r=Object.create(null),p={has:(t,i)=>i in e||i in r,get(p,h,u){if(h in r)return r[h];if(!(h in e))return;let d=e[h];if("function"==typeof d)if("function"==typeof t[h])d=o(e,e[h],t[h]);else if(a(i,h)){let t=((e,t)=>function(i,...r){if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${s(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${s(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((s,o)=>{if(t.fallbackToNoCallback)try{i[e](...r,n({resolve:s,reject:o},t))}catch(n){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,n),i[e](...r),t.fallbackToNoCallback=!1,t.noCallback=!0,s()}else t.noCallback?(i[e](...r),s()):i[e](...r,n({resolve:s,reject:o},t))}))})(h,i[h]);d=o(e,e[h],t)}else d=d.bind(e);else if("object"==typeof d&&null!==d&&(a(t,h)||a(i,h)))d=c(d,t[h],i[h]);else{if(!a(i,"*"))return Object.defineProperty(r,h,{configurable:!0,enumerable:!0,get:()=>e[h],set(t){e[h]=t}}),d;d=c(d,t[h],i["*"])}return r[h]=d,d},set:(t,i,n,s)=>(i in r?r[i]=n:e[i]=n,!0),defineProperty:(e,t,i)=>Reflect.defineProperty(r,t,i),deleteProperty:(e,t)=>Reflect.deleteProperty(r,t)},h=Object.create(e);return new Proxy(h,p)},p=e=>({addListener(t,i,...r){t.addListener(e.get(i),...r)},hasListener:(t,i)=>t.hasListener(e.get(i)),removeListener(t,i){t.removeListener(e.get(i))}}),h=new r((e=>"function"!=typeof e?e:function(t){const i=c(t,{},{getContent:{minArgs:0,maxArgs:0}});e(i)})),u=new r((e=>"function"!=typeof e?e:function(t,i,r){let n,s,o=!1,a=new Promise((e=>{n=function(t){o=!0,e(t)}}));try{s=e(t,i,n)}catch(e){s=Promise.reject(e)}const c=!0!==s&&((p=s)&&"object"==typeof p&&"function"==typeof p.then);var p;if(!0!==s&&!c&&!o)return!1;return(c?s:a).then((e=>{r(e)}),(e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",r({__mozWebExtensionPolyfillReject__:!0,message:t})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)})),!0})),d=({reject:i,resolve:r},n)=>{e.runtime.lastError?e.runtime.lastError.message===t?r():i(new Error(e.runtime.lastError.message)):n&&n.__mozWebExtensionPolyfillReject__?i(new Error(n.message)):r(n)},l=(e,t,i,...r)=>{if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${s(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${s(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((e,t)=>{const n=d.bind(null,{resolve:e,reject:t});r.push(n),i.sendMessage(...r)}))},v={devtools:{network:{onRequestFinished:p(h)}},runtime:{onMessage:p(u),onMessageExternal:p(u),sendMessage:l.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:l.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},g={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return i.privacy={network:{"*":g},services:{"*":g},websites:{"*":g}},c(e,v,i)};e.exports=i(chrome)}else e.exports=globalThis.browser},void 0===(r=i.apply(t,[e]))||(e.exports=r)},43108:()=>{},83034:()=>{},92505:()=>{},10146:()=>{},30173:()=>{},41137:()=>{},10592:()=>{},97906:e=>{e.exports={aa:{name:"Afar",nativeName:"Afaraf"},ab:{name:"Abkhaz",nativeName:"аҧсуа бызшәа"},ae:{name:"Avestan",nativeName:"avesta"},af:{name:"Afrikaans",nativeName:"Afrikaans"},ak:{name:"Akan",nativeName:"Akan"},am:{name:"Amharic",nativeName:"አማርኛ"},an:{name:"Aragonese",nativeName:"aragonés"},ar:{name:"Arabic",nativeName:"اَلْعَرَبِيَّةُ"},as:{name:"Assamese",nativeName:"অসমীয়া"},av:{name:"Avaric",nativeName:"авар мацӀ"},ay:{name:"Aymara",nativeName:"aymar aru"},az:{name:"Azerbaijani",nativeName:"azərbaycan dili"},ba:{name:"Bashkir",nativeName:"башҡорт теле"},be:{name:"Belarusian",nativeName:"беларуская мова"},bg:{name:"Bulgarian",nativeName:"български език"},bi:{name:"Bislama",nativeName:"Bislama"},bm:{name:"Bambara",nativeName:"bamanankan"},bn:{name:"Bengali",nativeName:"বাংলা"},bo:{name:"Tibetan",nativeName:"བོད་ཡིག"},br:{name:"Breton",nativeName:"brezhoneg"},bs:{name:"Bosnian",nativeName:"bosanski jezik"},ca:{name:"Catalan",nativeName:"Català"},ce:{name:"Chechen",nativeName:"нохчийн мотт"},ch:{name:"Chamorro",nativeName:"Chamoru"},co:{name:"Corsican",nativeName:"corsu"},cr:{name:"Cree",nativeName:"ᓀᐦᐃᔭᐍᐏᐣ"},cs:{name:"Czech",nativeName:"čeština"},cu:{name:"Old Church Slavonic",nativeName:"ѩзыкъ словѣньскъ"},cv:{name:"Chuvash",nativeName:"чӑваш чӗлхи"},cy:{name:"Welsh",nativeName:"Cymraeg"},da:{name:"Danish",nativeName:"dansk"},de:{name:"German",nativeName:"Deutsch"},dv:{name:"Divehi",nativeName:"ދިވެހި"},dz:{name:"Dzongkha",nativeName:"རྫོང་ཁ"},ee:{name:"Ewe",nativeName:"Eʋegbe"},el:{name:"Greek",nativeName:"Ελληνικά"},en:{name:"English",nativeName:"English"},eo:{name:"Esperanto",nativeName:"Esperanto"},es:{name:"Spanish",nativeName:"Español"},et:{name:"Estonian",nativeName:"eesti"},eu:{name:"Basque",nativeName:"euskara"},fa:{name:"Persian",nativeName:"فارسی"},ff:{name:"Fula",nativeName:"Fulfulde"},fi:{name:"Finnish",nativeName:"suomi"},fj:{name:"Fijian",nativeName:"vosa Vakaviti"},fo:{name:"Faroese",nativeName:"føroyskt"},fr:{name:"French",nativeName:"Français"},fy:{name:"Western Frisian",nativeName:"Frysk"},ga:{name:"Irish",nativeName:"Gaeilge"},gd:{name:"Scottish Gaelic",nativeName:"Gàidhlig"},gl:{name:"Galician",nativeName:"galego"},gn:{name:"Guaraní",nativeName:"Avañe'ẽ"},gu:{name:"Gujarati",nativeName:"ગુજરાતી"},gv:{name:"Manx",nativeName:"Gaelg"},ha:{name:"Hausa",nativeName:"هَوُسَ"},he:{name:"Hebrew",nativeName:"עברית"},hi:{name:"Hindi",nativeName:"हिन्दी"},ho:{name:"Hiri Motu",nativeName:"Hiri Motu"},hr:{name:"Croatian",nativeName:"Hrvatski"},ht:{name:"Haitian",nativeName:"Kreyòl ayisyen"},hu:{name:"Hungarian",nativeName:"magyar"},hy:{name:"Armenian",nativeName:"Հայերեն"},hz:{name:"Herero",nativeName:"Otjiherero"},ia:{name:"Interlingua",nativeName:"Interlingua"},id:{name:"Indonesian",nativeName:"Bahasa Indonesia"},ie:{name:"Interlingue",nativeName:"Interlingue"},ig:{name:"Igbo",nativeName:"Asụsụ Igbo"},ii:{name:"Nuosu",nativeName:"ꆈꌠ꒿ Nuosuhxop"},ik:{name:"Inupiaq",nativeName:"Iñupiaq"},io:{name:"Ido",nativeName:"Ido"},is:{name:"Icelandic",nativeName:"Íslenska"},it:{name:"Italian",nativeName:"Italiano"},iu:{name:"Inuktitut",nativeName:"ᐃᓄᒃᑎᑐᑦ"},ja:{name:"Japanese",nativeName:"日本語"},jv:{name:"Javanese",nativeName:"basa Jawa"},ka:{name:"Georgian",nativeName:"ქართული"},kg:{name:"Kongo",nativeName:"Kikongo"},ki:{name:"Kikuyu",nativeName:"Gĩkũyũ"},kj:{name:"Kwanyama",nativeName:"Kuanyama"},kk:{name:"Kazakh",nativeName:"қазақ тілі"},kl:{name:"Kalaallisut",nativeName:"kalaallisut"},km:{name:"Khmer",nativeName:"ខេមរភាសា"},kn:{name:"Kannada",nativeName:"ಕನ್ನಡ"},ko:{name:"Korean",nativeName:"한국어"},kr:{name:"Kanuri",nativeName:"Kanuri"},ks:{name:"Kashmiri",nativeName:"कश्मीरी"},ku:{name:"Kurdish",nativeName:"Kurdî"},kv:{name:"Komi",nativeName:"коми кыв"},kw:{name:"Cornish",nativeName:"Kernewek"},ky:{name:"Kyrgyz",nativeName:"Кыргызча"},la:{name:"Latin",nativeName:"latine"},lb:{name:"Luxembourgish",nativeName:"Lëtzebuergesch"},lg:{name:"Ganda",nativeName:"Luganda"},li:{name:"Limburgish",nativeName:"Limburgs"},ln:{name:"Lingala",nativeName:"Lingála"},lo:{name:"Lao",nativeName:"ພາສາລາວ"},lt:{name:"Lithuanian",nativeName:"lietuvių kalba"},lu:{name:"Luba-Katanga",nativeName:"Kiluba"},lv:{name:"Latvian",nativeName:"latviešu valoda"},mg:{name:"Malagasy",nativeName:"fiteny malagasy"},mh:{name:"Marshallese",nativeName:"Kajin M̧ajeļ"},mi:{name:"Māori",nativeName:"te reo Māori"},mk:{name:"Macedonian",nativeName:"македонски јазик"},ml:{name:"Malayalam",nativeName:"മലയാളം"},mn:{name:"Mongolian",nativeName:"Монгол хэл"},mr:{name:"Marathi",nativeName:"मराठी"},ms:{name:"Malay",nativeName:"Bahasa Melayu"},mt:{name:"Maltese",nativeName:"Malti"},my:{name:"Burmese",nativeName:"ဗမာစာ"},na:{name:"Nauru",nativeName:"Dorerin Naoero"},nb:{name:"Norwegian Bokmål",nativeName:"Norsk bokmål"},nd:{name:"Northern Ndebele",nativeName:"isiNdebele"},ne:{name:"Nepali",nativeName:"नेपाली"},ng:{name:"Ndonga",nativeName:"Owambo"},nl:{name:"Dutch",nativeName:"Nederlands"},nn:{name:"Norwegian Nynorsk",nativeName:"Norsk nynorsk"},no:{name:"Norwegian",nativeName:"Norsk"},nr:{name:"Southern Ndebele",nativeName:"isiNdebele"},nv:{name:"Navajo",nativeName:"Diné bizaad"},ny:{name:"Chichewa",nativeName:"chiCheŵa"},oc:{name:"Occitan",nativeName:"occitan"},oj:{name:"Ojibwe",nativeName:"ᐊᓂᔑᓈᐯᒧᐎᓐ"},om:{name:"Oromo",nativeName:"Afaan Oromoo"},or:{name:"Oriya",nativeName:"ଓଡ଼ିଆ"},os:{name:"Ossetian",nativeName:"ирон æвзаг"},pa:{name:"Panjabi",nativeName:"ਪੰਜਾਬੀ"},pi:{name:"Pāli",nativeName:"पाऴि"},pl:{name:"Polish",nativeName:"Polski"},ps:{name:"Pashto",nativeName:"پښتو"},pt:{name:"Portuguese",nativeName:"Português"},qu:{name:"Quechua",nativeName:"Runa Simi"},rm:{name:"Romansh",nativeName:"rumantsch grischun"},rn:{name:"Kirundi",nativeName:"Ikirundi"},ro:{name:"Romanian",nativeName:"Română"},ru:{name:"Russian",nativeName:"Русский"},rw:{name:"Kinyarwanda",nativeName:"Ikinyarwanda"},sa:{name:"Sanskrit",nativeName:"संस्कृतम्"},sc:{name:"Sardinian",nativeName:"sardu"},sd:{name:"Sindhi",nativeName:"सिन्धी"},se:{name:"Northern Sami",nativeName:"Davvisámegiella"},sg:{name:"Sango",nativeName:"yângâ tî sängö"},si:{name:"Sinhala",nativeName:"සිංහල"},sk:{name:"Slovak",nativeName:"slovenčina"},sl:{name:"Slovenian",nativeName:"slovenščina"},sm:{name:"Samoan",nativeName:"gagana fa'a Samoa"},sn:{name:"Shona",nativeName:"chiShona"},so:{name:"Somali",nativeName:"Soomaaliga"},sq:{name:"Albanian",nativeName:"Shqip"},sr:{name:"Serbian",nativeName:"српски језик"},ss:{name:"Swati",nativeName:"SiSwati"},st:{name:"Southern Sotho",nativeName:"Sesotho"},su:{name:"Sundanese",nativeName:"Basa Sunda"},sv:{name:"Swedish",nativeName:"Svenska"},sw:{name:"Swahili",nativeName:"Kiswahili"},ta:{name:"Tamil",nativeName:"தமிழ்"},te:{name:"Telugu",nativeName:"తెలుగు"},tg:{name:"Tajik",nativeName:"тоҷикӣ"},th:{name:"Thai",nativeName:"ไทย"},ti:{name:"Tigrinya",nativeName:"ትግርኛ"},tk:{name:"Turkmen",nativeName:"Türkmençe"},tl:{name:"Tagalog",nativeName:"Wikang Tagalog"},tn:{name:"Tswana",nativeName:"Setswana"},to:{name:"Tonga",nativeName:"faka Tonga"},tr:{name:"Turkish",nativeName:"Türkçe"},ts:{name:"Tsonga",nativeName:"Xitsonga"},tt:{name:"Tatar",nativeName:"татар теле"},tw:{name:"Twi",nativeName:"Twi"},ty:{name:"Tahitian",nativeName:"Reo Tahiti"},ug:{name:"Uyghur",nativeName:"ئۇيغۇرچە‎"},uk:{name:"Ukrainian",nativeName:"Українська"},ur:{name:"Urdu",nativeName:"اردو"},uz:{name:"Uzbek",nativeName:"Ўзбек"},ve:{name:"Venda",nativeName:"Tshivenḓa"},vi:{name:"Vietnamese",nativeName:"Tiếng Việt"},vo:{name:"Volapük",nativeName:"Volapük"},wa:{name:"Walloon",nativeName:"walon"},wo:{name:"Wolof",nativeName:"Wollof"},xh:{name:"Xhosa",nativeName:"isiXhosa"},yi:{name:"Yiddish",nativeName:"ייִדיש"},yo:{name:"Yoruba",nativeName:"Yorùbá"},za:{name:"Zhuang",nativeName:"Saɯ cueŋƅ"},zh:{name:"Chinese",nativeName:"中文"},zu:{name:"Zulu",nativeName:"isiZulu"}}},69230:(e,t,i)=>{const r=i(97906),n={},s={},o=[],a=[],c=[];for(const e in r){const{name:t,nativeName:i}=r[e];n[e]=s[t.toLowerCase()]=s[i.toLowerCase()]={code:e,name:t,nativeName:i},o.push(e),a.push(t),c.push(i)}e.exports=class e{static getLanguages(t=[]){return t.map((t=>e.validate(t)?Object.assign({},n[t]):{code:t,name:"",nativeName:""}))}static getName(t){return e.validate(t)?r[t].name:""}static getAllNames(){return a.slice()}static getNativeName(t){return e.validate(t)?r[t].nativeName:""}static getAllNativeNames(){return c.slice()}static getCode(e){return e=e.toLowerCase(),s.hasOwnProperty(e)?s[e].code:""}static getAllCodes(){return o.slice()}static validate(e){return r.hasOwnProperty(e)}}}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,i),s.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i(64985)})();